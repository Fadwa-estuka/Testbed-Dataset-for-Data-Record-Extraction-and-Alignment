(function(){function A(a){return"function"===typeof a}function O(){}function P(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}function I(a){var b=a._promiseCallbacks;b||(b=a._promiseCallbacks={});return b}function Q(a,b){if("onerror"===a)e.on("error",b);else if(2===arguments.length)e[a]=b;else return e[a]}function da(){setTimeout(function(){for(var a,b=0;b<F.length;b++){a=F[b];var c=a.payload;c.guid=c.key+c.id;c.childGuid=c.key+c.childId;c.error&&(c.stack=c.error.stack);e.trigger(a.name,
a.payload)}F.length=0},50)}function r(){}function ea(a,b,c,d){try{a.call(b,c,d)}catch(f){return f}}function fa(a,b,c){e.async(function(a){var f=!1,g=ea(c,b,function(c){f||(f=!0,b!==c?p(a,c):n(a,c))},function(b){f||(f=!0,m(a,b))},"Settle: "+(a._label||" unknown promise"));!f&&g&&(f=!0,m(a,g))},a)}function ga(a,b){1===b._state?n(a,b._result):2===b._state?(b._onError=null,m(a,b._result)):G(b,void 0,function(c){b!==c?p(a,c):n(a,c)},function(b){m(a,b)})}function p(a,b){if(a===b)n(a,b);else if("function"===
typeof b||"object"===typeof b&&null!==b)if(b.constructor===a.constructor)ga(a,b);else{var c;try{c=b.then}catch(d){H.error=d,c=H}c===H?m(a,H.error):void 0===c?n(a,b):A(c)?fa(a,b,c):n(a,b)}else n(a,b)}function ha(a){a._onError&&a._onError(a._result);J(a)}function n(a,b){void 0===a._state&&(a._result=b,a._state=1,0===a._subscribers.length?e.instrument&&B("fulfilled",a):e.async(J,a))}function m(a,b){void 0===a._state&&(a._state=2,a._result=b,e.async(ha,a))}function G(a,b,c,d){var f=a._subscribers,g=f.length;
a._onError=null;f[g]=b;f[g+1]=c;f[g+2]=d;0===g&&a._state&&e.async(J,a)}function J(a){var b=a._subscribers,c=a._state;e.instrument&&B(1===c?"fulfilled":"rejected",a);if(0!==b.length){for(var d,f,g=a._result,h=0;h<b.length;h+=3)d=b[h],f=b[h+c],d?R(c,d,f,g):f(g);a._subscribers.length=0}}function S(){this.error=null}function R(a,b,c,d){var f=A(c),g,h,e,l;if(f){try{g=c(d)}catch(k){K.error=k,g=K}g===K?(l=!0,h=g.error,g=null):e=!0;if(b===g){m(b,new TypeError("A promises callback cannot return that same promise."));
return}}else g=d,e=!0;void 0===b._state&&(f&&e?p(b,g):l?m(b,h):1===a?n(b,g):2===a&&m(b,g))}function ia(a,b){var c=!1;try{b(function(b){c||(c=!0,p(a,b))},function(b){c||(c=!0,m(a,b))})}catch(d){m(a,d)}}function T(a,b,c){return 1===a?{state:"fulfilled",value:c}:{state:"rejected",reason:c}}function k(a,b,c,d){this._instanceConstructor=a;this.promise=new a(r,d);this._abortOnReject=c;this._validateInput(b)?(this._input=b,this._remaining=this.length=b.length,this._init(),0===this.length?n(this.promise,
this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&n(this.promise,this._result))):m(this.promise,this._validationError())}function q(a,b){this._id=ja++;this._label=b;this._result=this._state=void 0;this._subscribers=[];e.instrument&&B("created",this);if(r!==a){if(!A(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof q))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
ia(this,a)}}function C(a,b,c){this._superConstructor(a,b,!1,c)}function ka(){var a=process.nextTick,b=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);Array.isArray(b)&&"0"===b[1]&&"10"===b[2]&&(a=setImmediate);return function(){a(D)}}function la(){return function(){U(D)}}function ma(){var a=0,b=new V(D),c=document.createTextNode("");b.observe(c,{characterData:!0});return function(){c.data=a=++a%2}}function na(){var a=new MessageChannel;a.port1.onmessage=D;return function(){a.port2.postMessage(0)}}
function W(){return function(){setTimeout(D,1)}}function D(){for(var a=0;a<u;a+=2)(0,x[a])(x[a+1]),x[a]=void 0,x[a+1]=void 0;u=0}function oa(){try{var a=require("vertx");U=a.runOnLoop||a.runOnContext;return la()}catch(b){return W()}}function s(a,b,c){this._superConstructor(a,b,!0,c)}function E(a,b,c){this._superConstructor(a,b,!1,c)}function X(){this.value=void 0}function Y(a,b,c){try{a.apply(b,c)}catch(d){return y.value=d,y}}function pa(a,b){return{then:function(c,d){return a.call(b,c,d)}}}function qa(a,
b,c,d){b=Y(c,d,b);b===y&&m(a,b.value);return a}function ra(a,b,c,d){return l.all(b).then(function(b){b=Y(c,d,b);b===y&&m(a,b.value);return a})}function Z(){e.on.apply(e,arguments)}var L=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},$=Date.now||function(){return(new Date).getTime()},v=Object.create||function(a){if(1<arguments.length)throw Error("Second argument not supported");if("object"!==typeof a)throw new TypeError("Argument must be an object");
O.prototype=a;return new O},aa={mixin:function(a){a.on=this.on;a.off=this.off;a.trigger=this.trigger;a._promiseCallbacks=void 0;return a},on:function(a,b){if("function"!==typeof b)throw new TypeError("Callback must be a function");var c=I(this),d;(d=c[a])||(d=c[a]=[]);-1===P(d,b)&&d.push(b)},off:function(a,b){var c=I(this),d;b?(c=c[a],d=P(c,b),-1!==d&&c.splice(d,1)):c[a]=[]},trigger:function(a,b,c){var d;if(a=I(this)[a])for(var f=0;f<a.length;f++)d=a[f],d(b,c)}},e={instrument:!1};aa.mixin(e);var F=
[],B=function(a,b,c){1===F.push({name:a,payload:{key:b._guidKey,id:b._id,eventName:a,detail:b._result,childId:c&&c._id,label:b._label,timeStamp:$(),error:e["instrument-with-stack"]?Error(b._label):null}})&&da()},H=new S,K=new S;k.prototype._validateInput=function(a){return L(a)};k.prototype._validationError=function(){return Error("Array Methods must be provided an Array")};k.prototype._init=function(){this._result=Array(this.length)};k.prototype._enumerate=function(){for(var a=this.length,b=this.promise,
c=this._input,d=0;void 0===b._state&&d<a;d++)this._eachEntry(c[d],d)};k.prototype._eachEntry=function(a,b){var c=this._instanceConstructor;"object"===typeof a&&null!==a?a.constructor===c&&void 0!==a._state?(a._onError=null,this._settledAt(a._state,b,a._result)):this._willSettleAt(c.resolve(a),b):(this._remaining--,this._result[b]=this._makeResult(1,b,a))};k.prototype._settledAt=function(a,b,c){var d=this.promise;void 0===d._state&&(this._remaining--,this._abortOnReject&&2===a?m(d,c):this._result[b]=
this._makeResult(a,b,c));0===this._remaining&&n(d,this._result)};k.prototype._makeResult=function(a,b,c){return c};k.prototype._willSettleAt=function(a,b){var c=this;G(a,void 0,function(a){c._settledAt(1,b,a)},function(a){c._settledAt(2,b,a)})};var t=function(a,b){if(a&&"object"===typeof a&&a.constructor===this)return a;var c=new this(r,b);p(c,a);return c},z="rsvp_"+$()+"-",ja=0,l=q;q.cast=t;q.all=function(a,b){return(new k(this,a,!0,b)).promise};q.race=function(a,b){function c(a){p(f,a)}function d(a){m(f,
a)}var f=new this(r,b);if(!L(a))return m(f,new TypeError("You must pass an array to race.")),f;for(var g=a.length,h=0;void 0===f._state&&h<g;h++)G(this.resolve(a[h]),void 0,c,d);return f};q.resolve=t;q.reject=function(a,b){var c=new this(r,b);m(c,a);return c};q.prototype={constructor:q,_guidKey:z,_onError:function(a){var b=this;e.after(function(){b._onError&&e.trigger("error",a,b._label)})},then:function(a,b,c){var d=this._state;if(1===d&&!a||2===d&&!b)return e.instrument&&B("chained",this,this),
this;this._onError=null;var f=new this.constructor(r,c),g=this._result;e.instrument&&B("chained",this,f);if(d){var h=arguments[d-1];e.async(function(){R(d,f,h,g)})}else G(this,f,a,b);return f},"catch":function(a,b){return this.then(void 0,a,b)},"finally":function(a,b){var c=this.constructor;return this.then(function(b){return c.resolve(a()).then(function(){return b})},function(b){return c.resolve(a()).then(function(){throw b;})},b)}};C.prototype=v(k.prototype);C.prototype._superConstructor=k;C.prototype._makeResult=
T;C.prototype._validationError=function(){return Error("allSettled must be called with an array")};var u=0,U,z=(t="undefined"!==typeof window?window:void 0)||{},V=z.MutationObserver||z.WebKitMutationObserver,z="undefined"===typeof self&&"undefined"!==typeof process&&"[object process]"==={}.toString.call(process),sa="undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof importScripts&&"undefined"!==typeof MessageChannel,x=Array(1E3),ba;ba=z?ka():V?ma():sa?na():void 0===t&&"function"===typeof require?
oa():W();s.prototype=v(k.prototype);s.prototype._superConstructor=k;s.prototype._init=function(){this._result={}};s.prototype._validateInput=function(a){return a&&"object"===typeof a};s.prototype._validationError=function(){return Error("Promise.hash must be called with an object")};s.prototype._enumerate=function(){var a=this.promise,b=this._input,c=[],d;for(d in b)void 0===a._state&&Object.prototype.hasOwnProperty.call(b,d)&&c.push({position:d,entry:b[d]});this._remaining=b=c.length;for(var f=0;void 0===
a._state&&f<b;f++)d=c[f],this._eachEntry(d.entry,d.position)};E.prototype=v(s.prototype);E.prototype._superConstructor=k;E.prototype._makeResult=T;E.prototype._validationError=function(){return Error("hashSettled must be called with an object")};var y=new X,ca=new X;if("object"===typeof self)v=self;else if("object"===typeof global)v=global;else throw Error("no global: `self` or `global` found");e.async=function(a,b){x[u]=a;x[u+1]=b;u+=2;2===u&&ba()};e.after=function(a){setTimeout(a,0)};if("undefined"!==
typeof window&&"object"===typeof window.__PROMISE_INSTRUMENTATION__){t=window.__PROMISE_INSTRUMENTATION__;Q("instrument",!0);for(var M in t)t.hasOwnProperty(M)&&Z(M,t[M])}var N={race:function(a,b){return l.race(a,b)},Promise:l,allSettled:function(a,b){return(new C(l,a,b)).promise},hash:function(a,b){return(new s(l,a,b)).promise},hashSettled:function(a,b){return(new E(l,a,b)).promise},denodeify:function(a,b){var c=function(){for(var c=arguments.length,f=Array(c+1),g,h=!1,e=0;e<c;++e){g=arguments[e];
if(!h){if(g&&"object"===typeof g){var k;if(g.constructor===l)k=!0;else try{k=g.then}catch(n){y.value=n,k=y}h=k}else h=!1;if(h===ca)return c=new l(r),m(c,ca.value),c;h&&!0!==h&&(g=pa(h,g))}f[e]=g}var w=new l(r);f[c]=function(a,c){if(a)m(w,a);else if(void 0===b)p(w,c);else if(!0===b){for(var d=arguments,f=d.length,g=Array(f-1),e=1;e<f;e++)g[e-1]=d[e];p(w,g)}else if(L(b)){for(var g=arguments,d={},e=g.length,f=Array(e),h=0;h<e;h++)f[h]=g[h];for(e=0;e<b.length;e++)g=b[e],d[g]=f[e+1];p(w,d)}else p(w,c)};
return h?ra(w,f,a,this):qa(w,f,a,this)};c.__proto__=a;return c},on:Z,off:function(){e.off.apply(e,arguments)},map:function(a,b,c){return l.all(a,c).then(function(a){if(!A(b))throw new TypeError("You must pass a function as map's second argument.");for(var f=a.length,g=Array(f),e=0;e<f;e++)g[e]=b(a[e]);return l.all(g,c)})},filter:function(a,b,c){return l.all(a,c).then(function(a){if(!A(b))throw new TypeError("You must pass a function as filter's second argument.");for(var f=a.length,e=Array(f),h=0;h<
f;h++)e[h]=b(a[h]);return l.all(e,c).then(function(b){for(var c=Array(f),e=0,g=0;g<f;g++)b[g]&&(c[e]=a[g],e++);c.length=e;return c})})},resolve:function(a,b){return l.resolve(a,b)},reject:function(a,b){return l.reject(a,b)},all:function(a,b){return l.all(a,b)},rethrow:function(a){setTimeout(function(){throw a;});throw a;},defer:function(a){var b={};b.promise=new l(function(a,d){b.resolve=a;b.reject=d},a);return b},EventTarget:aa,configure:Q,async:function(a,b){e.async(a,b)}};"function"===typeof define&&
define.amd?define(function(){return N}):"undefined"!==typeof module&&module.exports?module.exports=N:"undefined"!==typeof v&&(v.RSVP=N)}).call(this);
