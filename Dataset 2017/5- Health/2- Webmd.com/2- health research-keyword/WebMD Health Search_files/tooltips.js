/*!
 * Based off of jquery.qtip. The jQuery tooltip plugin
 *
 * Copyright (c) 2009 Craig Thompson
 * http://craigsworks.com
 *
 * Licensed under MIT
 * http://www.opensource.org/licenses/mit-license.php
 *
 * Launch  : February 2009
 * Version : 1.0.0-rc3
 * Released: Tuesday 12th May, 2009 - 00:00
 * Debug: jquery.qtip.debug.js
 */
define(["css!tooltips/1/tooltips.min.css"],function(){(function(a){a.fn.webmdTooltip=function(m,d){var h,c,l,b,g,f,e,j,k=this;if(typeof m==="string"){if(m==="api"){return a(this).data("wtip").interfaces[a(this).data("wtip").current]}else{if(m==="interfaces"){return a(this).data("wtip").interfaces}}}else{if(!m){m={}}if(typeof m.content!=="object"||(m.content.jquery&&m.content.length>0)){m.content={text:m.content}}if(typeof m.position!=="object"){m.position={corner:m.position}}if(typeof m.position.corner!=="object"){m.position.corner={target:m.position.corner,tooltip:m.position.corner}}if(typeof m.show!=="object"){m.show={when:m.show}}if(typeof m.show.when!=="object"){m.show.when={event:m.show.when}}if(typeof m.show.effect!=="object"){m.show.effect={type:m.show.effect}}if(typeof m.hide!=="object"){m.hide={when:m.hide}}if(typeof m.hide.when!=="object"){m.hide.when={event:m.hide.when}}if(typeof m.hide.effect!=="object"){m.hide.effect={type:m.hide.effect}}if(typeof m.tip!=="boolean"){m.tip=true}if(typeof m.trigger==="string"){m.show.when.event=m.trigger;m.hide.when.event=m.trigger}if(typeof m.ajax!=="boolean"){m.ajax=false}b=a.extend(true,{},a.fn.webmdTooltip.toolbox.defaults,m);b.user=a.extend(true,{},m)}return a(this).each(function(){if(typeof m==="string"){f=m.toLowerCase();l=a(this).webmdTooltip("interfaces");if(typeof l==="object"){if(d===true&&f==="destroy"){while(l.length>0){l[l.length-1].destroy()}}else{if(d!==true){l=[a(this).webmdTooltip("api")]}for(h=0;h<l.length;(h++)){if(f==="destroy"){l[h].destroy()}else{if(l[h].status.rendered===true){if(f==="show"){l[h].show()}else{if(f==="hide"){l[h].hide()}else{if(f==="focus"){l[h].focus()}else{if(f==="disable"){l[h].disable(true)}else{if(f==="enable"){l[h].disable(false)}}}}}}}}}}}else{if(!a(this).data("wtip")){e=a.extend(true,{},b);e.hide.effect.length=b.hide.effect.length;e.show.effect.length=b.show.effect.length;if(e.position.container===false){e.position.container=a(document.body)}if(e.position.target===false){e.position.target=a(this)}if(e.show.when.target===false){e.show.when.target=a(this)}if(e.hide.when.target===false){e.hide.when.target=a(this)}c=a.fn.webmdTooltip.toolbox.interfaces.length;for(h=0;h<c;(h++)){if(typeof a.fn.webmdTooltip.toolbox.interfaces[h]==="undefined"){c=h;break}}g=new a.fn.webmdTooltip.toolbox.init(a(this),e,c);a.fn.webmdTooltip.toolbox.interfaces[c]=g;if(typeof a(this).data("wtip")==="object"){if(typeof a(this).attr("wtip")==="undefined"){a(this).data("wtip").current=a(this).data("wtip").interfaces.length}a(this).data("wtip").interfaces.push(g)}else{a(this).data("wtip",{current:0,interfaces:[g]})}if(e.ajax===true){a(this).removeAttr("onclick");a(this).on("click",function(i){i.preventDefault()})}if(e.content.prerender===false&&e.show.when.event!==false&&e.show.ready!==true){e.show.when.target.bind(e.show.when.event+".wtip-"+c+"-create",{wtip:c},function(i){j=a.fn.webmdTooltip.toolbox.interfaces[i.data.wtip];j.options.show.when.target.unbind(j.options.show.when.event+".wtip-"+i.data.wtip+"-create");a.fn.webmdTooltip.toolbox.construct.call(j);if(e.ajax===true){j.options.show.when.target.on("tooltipContentUpdate",function(){j.options.show.when.target.trigger(j.options.show.when.event)})}else{j.options.show.when.target.trigger(j.options.show.when.event)}})}else{a.fn.webmdTooltip.toolbox.construct.call(g)}}}})};a.fn.webmdTooltip.toolbox={init:function(d,c,e){var b=this;b.id=e;b.options=c;b.status={animated:false,rendered:false,disabled:false,focused:false};b.elements={target:d,tooltip:null,wrapper:null,content:null,button:null,tip:null};b.cache={position:{},toggle:0};b.timers={};a.extend(b,b.options.api,{show:function(h){var g,i;if(!b.status.rendered){return b}if(b.elements.tooltip.css("display")!=="none"){return b}b.elements.tooltip.stop(true,false);g=b.beforeShow.call(b,h);if(g===false){return b}function f(){if(b.options.position.type!=="static"){b.focus()}b.onShow.call(b,h);if(a.browser.msie){b.elements.tooltip.get(0).style.removeAttribute("filter")}}b.cache.toggle=1;if(b.options.position.type!=="static"){b.updatePosition(h,(b.options.show.effect.length>0))}if(typeof b.options.show.solo==="object"){i=a(b.options.show.solo)}else{if(b.options.show.solo===true){i=a("div.wtip").not(b.elements.tooltip)}}if(i){i.each(function(){if(a(this).webmdTooltip("api").status.rendered===true){a(this).webmdTooltip("api").hide()}})}if(typeof b.options.show.effect.type==="function"){b.options.show.effect.type.call(b.elements.tooltip,b.options.show.effect.length);b.elements.tooltip.queue(function(){f();a(this).dequeue()})}else{switch(b.options.show.effect.type.toLowerCase()){case"fade":b.elements.tooltip.fadeIn(b.options.show.effect.length,f);break;case"slide":b.elements.tooltip.slideDown(b.options.show.effect.length,function(){f();if(b.options.position.type!=="static"){b.updatePosition(h,true)}});break;case"grow":b.elements.tooltip.show(b.options.show.effect.length,f);break;default:b.elements.tooltip.show(null,f);break}b.elements.tooltip.addClass("wtip-active")}return b},hide:function(h){var g,f=function(){b.onHide.call(b,h)};if(!b.status.rendered){return b}else{if(b.elements.tooltip.css("display")==="none"){return b}}clearTimeout(b.timers.show);b.elements.tooltip.stop(true,false);g=b.beforeHide.call(b,h);if(g===false){return b}b.cache.toggle=0;if(typeof b.options.hide.effect.type==="function"){b.options.hide.effect.type.call(b.elements.tooltip,b.options.hide.effect.length);b.elements.tooltip.queue(function(){f();a(this).dequeue()})}else{switch(b.options.hide.effect.type.toLowerCase()){case"fade":b.elements.tooltip.fadeOut(b.options.hide.effect.length,f);break;case"slide":b.elements.tooltip.slideUp(b.options.hide.effect.length,f);break;case"grow":b.elements.tooltip.hide(b.options.hide.effect.length,f);break;default:b.elements.tooltip.hide(null,f);break}b.elements.tooltip.removeClass("wtip-active")}return b},focus:function(j){var h,g,f,i;if(!b.status.rendered||b.options.position.type==="static"){return b}if(!b.status.focused){i=b.beforeFocus.call(b,j);if(i===false){return b}a("div.wtip[wtip]").not(b.elements.tooltip).each(function(){if(a(this).webmdTooltip("api").status.rendered===true){a(this).webmdTooltip("api").status.focused=false}});b.status.focused=true;b.onFocus.call(b,j)}return b},disable:function(f){if(!b.status.rendered){return b}if(f&&!b.status.disabled){b.status.disabled=true}else{if(b.status.disabled){b.status.disabled=false}}return b},destroy:function(){var f,g,h;g=b.beforeDestroy.call(b);if(g===false){return b}if(b.status.rendered){b.options.show.when.target.unbind("mouseout.wtip",b.hide);b.options.show.when.target.unbind(b.options.show.when.event+".wtip");b.options.hide.when.target.unbind(b.options.hide.when.event+".wtip");b.elements.tooltip.unbind(b.options.hide.when.event+".wtip");b.elements.tooltip.unbind("mouseover.wtip",b.focus);b.elements.tooltip.remove()}else{b.options.show.when.target.unbind(b.options.show.when.event+".wtip-create")}if(typeof b.elements.target.data("wtip")==="object"){h=b.elements.target.data("wtip").interfaces;if(typeof h==="object"&&h.length>0){for(f=0;f<h.length-1;(f++)){if(h[f].id===b.id){h.splice(f,1)}}}}delete a.fn.webmdTooltip.toolbox.interfaces[b.id];if(typeof h==="object"&&h.length>0){b.elements.target.data("wtip").current=h.length-1}else{b.elements.target.removeData("wtip")}b.onDestroy.call(b);return b.elements.target},updatePosition:function(f,g){var l,o,r,q,p,m,h,k,n,j;if(!b.status.rendered||b.options.position.type==="static"){return b}o={position:{left:0,top:0},dimensions:{height:0,width:0},corner:b.options.position.corner.target};r={position:b.getPosition(),dimensions:b.getDimensions(),corner:b.options.position.corner.tooltip};if(b.options.position.target.add(document.body).length===1){o.position={left:a(document).scrollLeft(),top:a(document).scrollTop()};o.dimensions={height:a(window).height(),width:a(window).width()}}else{if(typeof b.options.position.target.attr("wtip")!=="undefined"){o.position=b.options.position.target.wtip("api").cache.position}else{o.position=b.options.position.target.offset()}o.dimensions={height:b.options.position.target.outerHeight(),width:b.options.position.target.outerWidth()}}h=a.extend({},o.position);if(o.corner==="bottom"){h.left+=(o.dimensions.width/2);h.top+=o.dimensions.height+10}else{if(o.corner==="left"){h.left-=r.dimensions.width+10;h.top+=(o.dimensions.height/2)}else{if(o.corner==="right"){h.left+=o.dimensions.width+10;h.top+=(o.dimensions.height/2)}else{if(o.corner!=="top"){o.corner="top";webmd.debug("TOOLTIP ERROR: '"+o.corner+"' is not a valid position for target.")}h.left+=(o.dimensions.width/2);h.top-=(r.dimensions.height+10)}}}if(o.corner==="top"||o.corner==="bottom"){if(r.corner==="left"){h.left-=21;b.elements.tooltip.addClass("wtip-tip-left")}else{if(r.corner==="right"){h.left-=(r.dimensions.width-21);b.elements.tooltip.addClass("wtip-tip-right")}else{if(r.corner!=="center"){r.corner="center";webmd.debug("TOOLTIP ERROR: '"+r.corner+"' is not a valid position for tooltip.")}h.left-=(r.dimensions.width/2)}}}if(o.corner==="left"||o.corner==="right"){if(r.corner==="top"){h.top-=21;b.elements.tooltip.addClass("wtip-tip-top")}else{if(r.corner==="bottom"){h.top-=(r.dimensions.height-21);b.elements.tooltip.addClass("wtip-tip-bottom")}else{h.top-=(r.dimensions.height/2)}}}h.left+=b.options.position.adjust.x;h.top+=b.options.position.adjust.y;n=b.getPosition();if(h.left!==n.left||h.top!==n.top){j=b.beforePositionUpdate.call(b,f);if(j===false){return b}b.cache.position=h;b.elements.tooltip.css(h);b.onPositionUpdate.call(b,f)}return b},updateWidth:function(f){var g;if(!b.status.rendered||(f&&typeof f!=="number")){return b}g=a(b.elements.tip).add(b.elements.button);if(!f){b.elements.tooltip.css({width:"auto"});g.hide();f=b.getDimensions().width+1}if(f%2!==0){f-=1}b.elements.tooltip.width(f);g.show();return b},updateContent:function(i){var h,g,f;function j(){b.updateWidth()}if(!b.status.rendered||!i){return b}h=b.beforeContentUpdate.call(b,i);if(typeof h==="string"){i=h}else{if(h===false){return}}if(i.jquery&&i.length>0){i.clone(true).appendTo(b.elements.content).show()}else{b.elements.content.html(i)}g=b.elements.content.find("img[complete=false]");if(g.length>0){f=0;g.each(function(k){a('<img src="'+a(this).attr("src")+'" />').load(function(){if(++f===g.length){j()}})})}else{j()}b.elements.target.trigger("tooltipContentUpdate");b.onContentUpdate.call(b);return b},getPosition:function(){var f,g;if(!b.status.rendered){return b}f=(b.elements.tooltip.css("display")!=="none")?false:true;if(f){b.elements.tooltip.css({visiblity:"hidden"}).show()}g=b.elements.tooltip.offset();if(f){b.elements.tooltip.css({visiblity:"visible"}).hide()}return g},getDimensions:function(){var f,g;if(!b.status.rendered){return b}f=(!b.elements.tooltip.is(":visible"))?true:false;if(f){b.elements.tooltip.css({visiblity:"hidden"}).show()}g={height:b.elements.tooltip.outerHeight(),width:b.elements.tooltip.outerWidth()};if(f){b.elements.tooltip.css({visiblity:"visible"}).hide()}return g}})},construct:function(){var b,f,d,c,e,h,g;b=this;b.beforeRender.call(b);b.status.rendered=true;b.elements.tooltip='<div wtip="'+b.id+'" class="wtip';b.elements.tooltip+=(b.options.classType)?" "+b.options.classType:"";b.elements.tooltip+=(b.options.tip)?" wtip-"+b.options.position.corner.target+'"':'"';b.elements.tooltip+='style="display:none;"><div class="wtip-content"></div></div>';b.elements.tooltip=a(b.elements.tooltip);b.elements.tooltip.appendTo(b.options.position.container);b.elements.tooltip.data("wtip",{current:0,interfaces:[b]});b.elements.target.data("wtip",{current:0,interfaces:[b]});b.elements.content=b.elements.tooltip.children("div:first");if(b.options.hide.when.event==="unfocus"){b.elements.tooltip.attr("unfocus",true)}if((typeof b.options.ajax!=="undefined"&&b.options.ajax===true)){if(!b.elements.target.data("wTipText")){a.ajax({url:b.elements.target.attr("href")}).done(function(j){var j=j.replace("<body>",'<body><div id="tooltip-wrapper">').replace("</body>","</div></body>");var i=a(j).filter("#tooltip-wrapper").html();b.updateContent(i);b.elements.target.data("wTipText",i)})}}else{if((typeof b.options.content.text==="string"&&b.options.content.text.length>0)||(b.options.content.text.jquery&&b.options.content.text.length>0)){d=b.options.content.text}else{if(typeof b.elements.target.attr("title")==="string"&&b.elements.target.attr("title").length>0){d=b.elements.target.attr("title").replace("\\n","<br />");b.elements.target.attr("title","")}else{if(typeof b.elements.target.attr("alt")==="string"&&b.elements.target.attr("alt").length>0){d=b.elements.target.attr("alt").replace("\\n","<br />");b.elements.target.attr("alt","")}else{d=" ";webmd.debug("TOOLTIP ERROR: tooltip has no content")}}}}if(b.options.content.button!==false){b.elements.button=a('<a class="wtip-close"><span class="jawsonly">Close Tool Tip</span></a>').prependTo(b.elements.tooltip).click(function(i){if(!b.status.disabled){b.hide(i)}})}b.updateContent(d);a.fn.webmdTooltip.toolbox.assignEvents.call(b);if(b.options.show.ready===true){b.show()}b.onRender.call(b)},assignEvents:function(){var c,e,d,b;c=this;function h(i){if(c.status.disabled===true){return}clearTimeout(c.timers.inactive);c.timers.inactive=setTimeout(function(){a(b).each(function(){d.unbind(this+".wtip-inactive");c.elements.content.unbind(this+".wtip-inactive")});c.hide(i)},c.options.hide.delay)}function g(i){if(c.status.disabled===true){return}if(c.options.hide.when.event==="inactive"){a(b).each(function(){d.bind(this+".wtip-inactive",h);c.elements.content.bind(this+".wtip-inactive",h)});h()}clearTimeout(c.timers.show);clearTimeout(c.timers.hide);c.timers.show=setTimeout(function(){c.show(i)},c.options.show.delay)}function f(i){if(c.status.disabled===true){return}if(c.options.hide.fixed===true&&c.options.hide.when.event.search(/mouse(out|leave)/i)!==-1&&a(i.relatedTarget).parents("div.wtip[wtip]").length>0){i.stopPropagation();i.preventDefault();clearTimeout(c.timers.hide);return false}clearTimeout(c.timers.show);clearTimeout(c.timers.hide);c.elements.tooltip.stop(true,true);c.timers.hide=setTimeout(function(){c.hide(i)},c.options.hide.delay)}e=c.options.show.when.target;d=c.options.hide.when.target;if(c.options.hide.fixed){d=d.add(c.elements.tooltip)}if(c.options.hide.when.event==="inactive"){b=["click","dblclick","mousedown","mouseup","mouseout","mouseenter","mouseleave","mouseover"]}else{if(c.options.hide.fixed===true){c.elements.tooltip.bind("mouseover.wtip",function(){if(c.status.disabled===true){return}clearTimeout(c.timers.hide)})}}if((c.options.show.when.target.add(c.options.hide.when.target).length===1&&c.options.show.when.event===c.options.hide.when.event&&c.options.hide.when.event!=="inactive")||c.options.hide.when.event==="unfocus"){c.cache.toggle=0;e.bind(c.options.show.when.event+".wtip",function(i){if(c.cache.toggle===0){g(i)}else{f(i)}})}else{e.bind(c.options.show.when.event+".wtip",g);if(c.options.hide.when.event!=="inactive"){d.bind(c.options.hide.when.event+".wtip",f)}}if(c.options.position.type.search(/(fixed|absolute)/)!==-1){c.elements.tooltip.bind("mouseover.wtip",c.focus)}},interfaces:[],defaults:{classType:"",ajax:false,content:{prerender:false,text:false,button:false},position:{target:false,corner:{target:"top",tooltip:"center"},adjust:{x:0,y:0},type:"absolute",container:false},show:{when:{target:false,event:"mouseover"},effect:{type:"fade",length:100},delay:140,solo:false,ready:false},hide:{when:{target:false,event:"mouseout"},effect:{type:"fade",length:100},delay:0,fixed:false},api:{beforeRender:function(){},onRender:function(){},beforePositionUpdate:function(){},onPositionUpdate:function(){},beforeShow:function(){},onShow:function(){},beforeHide:function(){},onHide:function(){},beforeContentUpdate:function(){},onContentUpdate:function(){},beforeDestroy:function(){},onDestroy:function(){},beforeFocus:function(){},onFocus:function(){}}}};a(document).ready(function(){a.fn.webmdTooltip.cache={screen:{scroll:{left:a(window).scrollLeft(),top:a(window).scrollTop()},width:a(window).width(),height:a(window).height()}};a(document).bind("mousedown.wtip",function(b){if(a(b.target).parents("div.wtip").length===0){a(".wtip").each(function(){var c=a(this).webmdTooltip("api");if(a(this).is(":visible")&&!c.status.disabled&&a(b.target).add(c.elements.target).length>1){c.hide(b)}})}})})}(jQuery))});