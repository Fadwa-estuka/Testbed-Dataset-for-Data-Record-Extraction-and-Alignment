/*! hover-newsletter-counter */
define([],function(){var e;return e={id:void 0,views:3,active:!0,cookieName:"nls2",viewsCap:9,viewsById:{},init:function(e){if(!e||!e.id||!e.nl)return this.debug("missing settings"),void 0;if(this.debug("settings are as follows"),webmd.debug(e),$.extend(this,e),this.newsletterOndemand===!0)this.display(this.timerOverride);else{if(this.cookieGet(),!this.active&&!this.isTestMode())return this.debug("inactive"),void 0;if(this.viewsById[this.id]!=this.views&&this.increment(),this.isPageExcluded())return this.debug("excluded on this page"),void 0;this.shouldDisplay()?(this.debug("should display"),webmd.p.pim.increment(),this.deactivate(),this.display()):(this.debug("should not display"),this.cookieSet())}},isTestMode:function(){return webmd.url.getParam("testnewsletterhover")},isPageExcluded:function(){var e;return this.isTestMode()?!1:-1!==this.excludedTopicIDs.indexOf(window.s_topic)?(this.debug("excluded because topic ID is suppressed"),!0):webmd.isDown("reg")?(this.debug("excluded because registration is down"),!0):$("html").hasClass("cookie-consent")?(this.debug("In UK"),!0):window.s_sponsor_program?(this.debug("excluded on sponsored pages"),!0):"http:"!==location.protocol?(this.debug("excluded on non-http pages"),!0):window.opener?(this.debug("excluded on pop-up window"),!0):window.top!==window.self?(this.debug("excluded within iframe"),!0):this.excludeHref&&(e=RegExp(this.excludeHref),e.test(location.href))?(this.debug("excluded due to url match"),!0):this.excludeHostname&&(e=RegExp(this.excludeHostname),e.test(location.hostname))?(this.debug("excluded due to hostname match"),!0):webmd.p.pim.isAllowed()?!1:(this.debug("excluded due to PIM"),!0)},cookieGet:function(){var e;return webmd.cookie.exists(this.cookieName)?(this.debug("cookie value = "+webmd.cookie.get(this.cookieName)),e=webmd.cookie.getJson(this.cookieName),this.active=Boolean(e.a===void 0),this.viewsById=e.i||{},void 0):(this.debug("cookie was not found."),void 0)},cookieSet:function(){var e,t;e={},this.active?e.i=this.viewsById:(e.a=0,t=7),webmd.cookie.setJson(this.cookieName,e,{domain:webmd.url.getSLD(),expires:t})},increment:function(){var e;e=this.cap((this.viewsById[this.id]||0)+1),this.viewsById[this.id]=e,this.cookieSet(),this.debug("views for id "+this.id+" = "+e),this.debug("target views = "+this.views)},shouldDisplay:function(){var e;return e=this.viewsById[this.id]||0,this.isTestMode()||e===this.views},display:function(e){var t=this,i=webmd.useragent.ua.type&&"mobile"===webmd.useragent.ua.type,s="newsletterHover",n="newsletter/1/moduleUI-daily",a='<div id="'+s+'" class="newsletter-daily hover"></div>',o="daily-hover";e=e!==void 0?e:i?5e3:3e3,i&&(n+="-mobile",a='<div id="newsletterHoverContainer"><div id="'+s+'" class="newsletter-daily"></div></div>',o="daily-mobile"),t.config=$.extend({},t.config,{nl:t.nl,selector:"#"+s,uiMode:o}),setTimeout(function(){require([n,"css!newsletter/1/newsletter-signup-daily.css"],function(e){var s=new e,n=navigator.userAgent.match(/(iPhone|iPod touch);/i);i?(1>$("#newsletterHoverContainer").length&&$("body").append(a),s.init(t.config),setTimeout(function(){s.show(),wmdPageLink("nl-hov_imp");var e=$(".nls-email");$("#newsletterHoverContainer"),n&&(e.on("mousedown focus",function(){$("body").css({overflow:"hidden",position:"fixed"})}),e.on("blur",function(){setTimeout(function(){$("body").css({overflow:"auto",position:"static"})},1e3)}))},0)):webmd.overlay.open({width:650,html:a,scrolling:!1,transition:"none",overlayClose:!1,onComplete:function(){s.init(t.config),wmdPageLink("nl-hov_imp"),$("#webmdHoverWrapper").addClass("newsletter-hover"),$("#webmdHoverOverlay").addClass("newsletter-hover"),"570px"!==$("#webmdHoverLoadedContent").css("width")&&$("#webmdHoverLoadedContent").css({width:"570px"})}})})},e)},deactivate:function(){this.active=!1,this.cookieSet()},cap:function(e){return e>this.viewsCap&&(e=this.viewsCap),e},debug:function(e){webmd.debug("Newsletter hover: "+e)}}});