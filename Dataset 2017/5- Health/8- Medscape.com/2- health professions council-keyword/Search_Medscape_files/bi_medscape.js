/* repo: omniture-beacon/feature/PPE-67820_Responsive_Vars@2.0.1-19-g03e95ba-dirty - Package Version: 2.0.1 - 2016-09-08 05:23 pm - User: Mike Lebedev */
/*
 ============== DO NOT ALTER ANYTHING BELOW THIS LINE ! ============

 Adobe Visitor API for JavaScript version: 1.5.3
 Copyright 1996-2015 Adobe, Inc. All Rights Reserved
 More info available at http://www.omniture.com
*/
function Visitor(m,s){if(!m)throw"Visitor requires Adobe Marketing Cloud Org ID";var a=this;a.version="1.5.3";var l=window,j=l.Visitor;j.version=a.version;l.s_c_in||(l.s_c_il=[],l.s_c_in=0);a._c="Visitor";a._il=l.s_c_il;a._in=l.s_c_in;a._il[a._in]=a;l.s_c_in++;a.pa={Ka:[]};var n=l.document,h=j.Ma;h||(h=null);var x=j.Na;x||(x=void 0);var i=j.ja;i||(i=!0);var k=j.La;k||(k=!1);a.S=function(a){var c=0,b,e;if(a)for(b=0;b<a.length;b++)e=a.charCodeAt(b),c=(c<<5)-c+e,c&=c;return c};a.q=function(a){var c=
"0123456789",b="",e="",f,g=8,i=10,h=10;if(1==a){c+="ABCDEF";for(a=0;16>a;a++)f=Math.floor(Math.random()*g),b+=c.substring(f,f+1),f=Math.floor(Math.random()*g),e+=c.substring(f,f+1),g=16;return b+"-"+e}for(a=0;19>a;a++)f=Math.floor(Math.random()*i),b+=c.substring(f,f+1),0==a&&9==f?i=3:(1==a||2==a)&&10!=i&&2>f?i=10:2<a&&(i=10),f=Math.floor(Math.random()*h),e+=c.substring(f,f+1),0==a&&9==f?h=3:(1==a||2==a)&&10!=h&&2>f?h=10:2<a&&(h=10);return b+e};a.ma=function(){var a;!a&&l.location&&(a=l.location.hostname);
if(a)if(/^[0-9.]+$/.test(a))a="";else{var c=a.split("."),b=c.length-1,e=b-1;1<b&&2>=c[b].length&&(2==c[b-1].length||0>",ac,ad,ae,af,ag,ai,al,am,an,ao,aq,ar,as,at,au,aw,ax,az,ba,bb,be,bf,bg,bh,bi,bj,bm,bo,br,bs,bt,bv,bw,by,bz,ca,cc,cd,cf,cg,ch,ci,cl,cm,cn,co,cr,cu,cv,cw,cx,cz,de,dj,dk,dm,do,dz,ec,ee,eg,es,et,eu,fi,fm,fo,fr,ga,gb,gd,ge,gf,gg,gh,gi,gl,gm,gn,gp,gq,gr,gs,gt,gw,gy,hk,hm,hn,hr,ht,hu,id,ie,im,in,io,iq,ir,is,it,je,jo,jp,kg,ki,km,kn,kp,kr,ky,kz,la,lb,lc,li,lk,lr,ls,lt,lu,lv,ly,ma,mc,md,me,mg,mh,mk,ml,mn,mo,mp,mq,mr,ms,mt,mu,mv,mw,mx,my,na,nc,ne,nf,ng,nl,no,nr,nu,nz,om,pa,pe,pf,ph,pk,pl,pm,pn,pr,ps,pt,pw,py,qa,re,ro,rs,ru,rw,sa,sb,sc,sd,se,sg,sh,si,sj,sk,sl,sm,sn,so,sr,st,su,sv,sx,sy,sz,tc,td,tf,tg,th,tj,tk,tl,tm,tn,to,tp,tr,tt,tv,tw,tz,ua,ug,uk,us,uy,uz,va,vc,ve,vg,vi,vn,vu,wf,ws,yt,".indexOf(","+
c[b]+","))&&e--;if(0<e)for(a="";b>=e;)a=c[b]+(a?".":"")+a,b--}return a};a.cookieRead=function(a){var a=encodeURIComponent(a),c=(";"+n.cookie).split(" ").join(";"),b=c.indexOf(";"+a+"="),e=0>b?b:c.indexOf(";",b+1);return 0>b?"":decodeURIComponent(c.substring(b+2+a.length,0>e?c.length:e))};a.cookieWrite=function(d,c,b){var e=a.cookieLifetime,f,c=""+c,e=e?(""+e).toUpperCase():"";b&&"SESSION"!=e&&"NONE"!=e?(f=""!=c?parseInt(e?e:0,10):-60)?(b=new Date,b.setTime(b.getTime()+1E3*f)):1==b&&(b=new Date,f=
b.getYear(),b.setYear(f+2+(1900>f?1900:0))):b=0;return d&&"NONE"!=e?(n.cookie=encodeURIComponent(d)+"="+encodeURIComponent(c)+"; path=/;"+(b?" expires="+b.toGMTString()+";":"")+(a.cookieDomain?" domain="+a.cookieDomain+";":""),a.cookieRead(d)==c):0};a.g=h;a.O=function(a,c){try{"function"==typeof a?a.apply(l,c):a[1].apply(a[0],c)}catch(b){}};a.ra=function(d,c){c&&(a.g==h&&(a.g={}),a.g[d]==x&&(a.g[d]=[]),a.g[d].push(c))};a.o=function(d,c){if(a.g!=h){var b=a.g[d];if(b)for(;0<b.length;)a.O(b.shift(),
c)}};a.j=h;a.oa=function(d,c,b){var e=0,f=0,g;if(c&&n){for(g=0;!e&&2>g;){try{e=(e=n.getElementsByTagName(0<g?"HEAD":"head"))&&0<e.length?e[0]:0}catch(i){e=0}g++}if(!e)try{n.body&&(e=n.body)}catch(j){e=0}if(e)for(g=0;!f&&2>g;){try{f=n.createElement(0<g?"SCRIPT":"script")}catch(k){f=0}g++}}!c||!e||!f?b&&b():(f.type="text/javascript",f.setAttribute("async","async"),f.src=c,e.firstChild?e.insertBefore(f,e.firstChild):e.appendChild(f),a.pa.Ka.push(c),b&&(a.j==h&&(a.j={}),a.j[d]=setTimeout(b,a.loadTimeout)))};
a.ka=function(d){a.j!=h&&a.j[d]&&(clearTimeout(a.j[d]),a.j[d]=0)};a.T=k;a.U=k;a.isAllowed=function(){if(!a.T&&(a.T=i,a.cookieRead(a.cookieName)||a.cookieWrite(a.cookieName,"T",1)))a.U=i;return a.U};a.a=h;a.d=h;var z=j.$a;z||(z="MC");var q=j.eb;q||(q="MCMID");var A=j.ab;A||(A="MCCIDH");var B=j.cb;B||(B="MCSYNCS");var D=j.bb;D||(D="MCIDTS");var y=j.Ya;y||(y="A");var o=j.Va;o||(o="MCAID");var w=j.Za;w||(w="AAM");var v=j.Xa;v||(v="MCAAMLH");var p=j.Wa;p||(p="MCAAMB");var r=j.fb;r||(r="NONE");a.B=0;a.R=
function(){if(!a.B){var d=a.version;a.audienceManagerServer&&(d+="|"+a.audienceManagerServer);a.audienceManagerServerSecure&&(d+="|"+a.audienceManagerServerSecure);a.B=a.S(d)}return a.B};a.V=k;a.f=function(){if(!a.V){a.V=i;var d=a.R(),c=k,b=a.cookieRead(a.cookieName),e,f,g,j=new Date;a.a==h&&(a.a={});if(b&&"T"!=b){b=b.split("|");b[0].match(/^[\-0-9]+$/)&&(parseInt(b[0],10)!=d&&(c=i),b.shift());1==b.length%2&&b.pop();for(d=0;d<b.length;d+=2)e=b[d].split("-"),f=e[0],g=b[d+1],e=1<e.length?parseInt(e[1],
10):0,c&&(f==A&&(g=""),0<e&&(e=j.getTime()/1E3-60)),f&&g&&(a.c(f,g,1),0<e&&(a.a["expire"+f]=e,j.getTime()>=1E3*e&&(a.d||(a.d={}),a.d[f]=i)))}if(!a.b(o)&&(b=a.cookieRead("s_vi")))b=b.split("|"),1<b.length&&0<=b[0].indexOf("v1")&&(g=b[1],d=g.indexOf("["),0<=d&&(g=g.substring(0,d)),g&&g.match(/^[0-9a-fA-F\-]+$/)&&a.c(o,g))}};a.ta=function(){var d=a.R(),c,b;for(c in a.a)!Object.prototype[c]&&a.a[c]&&"expire"!=c.substring(0,6)&&(b=a.a[c],d+=(d?"|":"")+c+(a.a["expire"+c]?"-"+a.a["expire"+c]:"")+"|"+b);
a.cookieWrite(a.cookieName,d,1)};a.b=function(d,c){return a.a!=h&&(c||!a.d||!a.d[d])?a.a[d]:h};a.c=function(d,c,b){a.a==h&&(a.a={});a.a[d]=c;b||a.ta()};a.na=function(d,c){var b=a.b(d,c);return b?b.split("*"):h};a.sa=function(d,c,b){a.c(d,c?c.join("*"):"",b)};a.Sa=function(d,c){var b=a.na(d,c);if(b){var e={},f;for(f=0;f<b.length;f+=2)e[b[f]]=b[f+1];return e}return h};a.Ua=function(d,c,b){var e=h,f;if(c)for(f in e=[],c)Object.prototype[f]||(e.push(f),e.push(c[f]));a.sa(d,e,b)};a.l=function(d,c){var b=
new Date;b.setTime(b.getTime()+1E3*c);a.a==h&&(a.a={});a.a["expire"+d]=Math.floor(b.getTime()/1E3);0>c?(a.d||(a.d={}),a.d[d]=i):a.d&&(a.d[d]=k)};a.Q=function(a){if(a&&("object"==typeof a&&(a=a.d_mid?a.d_mid:a.visitorID?a.visitorID:a.id?a.id:a.uuid?a.uuid:""+a),a&&(a=a.toUpperCase(),"NOTARGET"==a&&(a=r)),!a||a!=r&&!a.match(/^[0-9a-fA-F\-]+$/)))a="";return a};a.i=function(d,c){a.ka(d);a.h!=h&&(a.h[d]=k);if(d==z){var b=a.b(q);if(!b){b="object"==typeof c&&c.mid?c.mid:a.Q(c);if(!b){if(a.u){a.getAnalyticsVisitorID(h,
k,i);return}b=a.q()}a.c(q,b)}if(!b||b==r)b="";"object"==typeof c&&((c.d_region||c.dcs_region||c.d_blob||c.blob)&&a.i(w,c),a.u&&c.mid&&a.i(y,{id:c.id}));a.o(q,[b])}if(d==w&&"object"==typeof c){b=604800;c.id_sync_ttl!=x&&c.id_sync_ttl&&(b=parseInt(c.id_sync_ttl,10));var e=a.b(v);e||((e=c.d_region)||(e=c.dcs_region),e&&(a.l(v,b),a.c(v,e)));e||(e="");a.o(v,[e]);e=a.b(p);if(c.d_blob||c.blob)(e=c.d_blob)||(e=c.blob),a.l(p,b),a.c(p,e);e||(e="");a.o(p,[e]);!c.error_msg&&a.s&&a.c(A,a.s);a.idSyncDisableSyncs?
t.ba=i:(t.ba=k,b={},b.ibs=c.ibs,b.subdomain=c.subdomain,t.Ia(b))}if(d==y){b=a.b(o);b||((b=a.Q(c))?a.l(p,-1):b=r,a.c(o,b));if(!b||b==r)b="";a.o(o,[b])}};a.h=h;a.r=function(d,c,b,e){var f="",g;if(a.isAllowed()&&(a.f(),f=a.b(d),!f&&(d==q?g=z:d==v||d==p?g=w:d==o&&(g=y),g))){if(c&&(a.h==h||!a.h[g]))a.h==h&&(a.h={}),a.h[g]=i,a.oa(g,c,function(){if(!a.b(d)){var b="";d==q?b=a.q():g==w&&(b={error_msg:"timeout"});a.i(g,b)}});a.ra(d,b);c||a.i(g,{id:r});return""}if((d==q||d==o)&&f==r)f="",e=i;b&&e&&a.O(b,[f]);
return f};a._setMarketingCloudFields=function(d){a.f();a.i(z,d)};a.setMarketingCloudVisitorID=function(d){a._setMarketingCloudFields(d)};a.u=k;a.getMarketingCloudVisitorID=function(d,c){if(a.isAllowed()){a.marketingCloudServer&&0>a.marketingCloudServer.indexOf(".demdex.net")&&(a.u=i);var b=a.A("_setMarketingCloudFields");return a.r(q,b,d,c)}return""};a.qa=function(){a.getAudienceManagerBlob()};j.AuthState={UNKNOWN:0,AUTHENTICATED:1,LOGGED_OUT:2};a.p={};a.P=k;a.s="";a.setCustomerIDs=function(d){if(a.isAllowed()&&
d){a.f();var c,b;for(c in d)if(!Object.prototype[c]&&(b=d[c]))if("object"==typeof b){var e={};b.id&&(e.id=b.id);b.authState!=x&&(e.authState=b.authState);a.p[c]=e}else a.p[c]={id:b};var d=a.getCustomerIDs(),e=a.b(A),f="";e||(e=0);for(c in d)Object.prototype[c]||(b=d[c],f+=(f?"|":"")+c+"|"+(b.id?b.id:"")+(b.authState?b.authState:""));a.s=a.S(f);a.s!=e&&(a.P=i,a.qa())}};a.getCustomerIDs=function(){a.f();var d={},c,b;for(c in a.p)Object.prototype[c]||(b=a.p[c],d[c]||(d[c]={}),b.id&&(d[c].id=b.id),d[c].authState=
b.authState!=x?b.authState:j.AuthState.UNKNOWN);return d};a._setAnalyticsFields=function(d){a.f();a.i(y,d)};a.setAnalyticsVisitorID=function(d){a._setAnalyticsFields(d)};a.getAnalyticsVisitorID=function(d,c,b){if(a.isAllowed()){var e="";b||(e=a.getMarketingCloudVisitorID(function(){a.getAnalyticsVisitorID(d,i)}));if(e||b){var f=b?a.marketingCloudServer:a.trackingServer,g="";a.loadSSL&&(b?a.marketingCloudServerSecure&&(f=a.marketingCloudServerSecure):a.trackingServerSecure&&(f=a.trackingServerSecure));
f&&(g="http"+(a.loadSSL?"s":"")+"://"+f+"/id?d_visid_ver="+a.version+"&callback=s_c_il%5B"+a._in+"%5D._set"+(b?"MarketingCloud":"Analytics")+"Fields&mcorgid="+encodeURIComponent(a.marketingCloudOrgID)+(e?"&mid="+e:"")+(a.idSyncDisable3rdPartySyncing?"&d_coppa=true":""));return a.r(b?q:o,g,d,c)}}return""};a._setAudienceManagerFields=function(d){a.f();a.i(w,d)};a.A=function(d){var c=a.audienceManagerServer,b="",e=a.b(q),f=a.b(p,i),g=a.b(o),g=g&&g!=r?"&d_cid_ic=AVID%01"+encodeURIComponent(g):"";a.loadSSL&&
a.audienceManagerServerSecure&&(c=a.audienceManagerServerSecure);if(c){var b=a.getCustomerIDs(),h,j;if(b)for(h in b)Object.prototype[h]||(j=b[h],g+="&d_cid_ic="+encodeURIComponent(h)+"%01"+encodeURIComponent(j.id?j.id:"")+(j.authState?"%01"+j.authState:""));d||(d="_setAudienceManagerFields");b="http"+(a.loadSSL?"s":"")+"://"+c+"/id?d_visid_ver="+a.version+"&d_rtbd=json&d_ver=2"+(!e&&a.u?"&d_verify=1":"")+"&d_orgid="+encodeURIComponent(a.marketingCloudOrgID)+"&d_nsid="+(a.idSyncContainerID||0)+(e?
"&d_mid="+e:"")+(a.idSyncDisable3rdPartySyncing?"&d_coppa=true":"")+(f?"&d_blob="+encodeURIComponent(f):"")+g+"&d_cb=s_c_il%5B"+a._in+"%5D."+d}return b};a.getAudienceManagerLocationHint=function(d,c){if(a.isAllowed()&&a.getMarketingCloudVisitorID(function(){a.getAudienceManagerLocationHint(d,i)})){var b=a.b(o);b||(b=a.getAnalyticsVisitorID(function(){a.getAudienceManagerLocationHint(d,i)}));if(b)return b=a.A(),a.r(v,b,d,c)}return""};a.getAudienceManagerBlob=function(d,c){if(a.isAllowed()&&a.getMarketingCloudVisitorID(function(){a.getAudienceManagerBlob(d,
i)})){var b=a.b(o);b||(b=a.getAnalyticsVisitorID(function(){a.getAudienceManagerBlob(d,i)}));if(b)return b=a.A(),a.P&&a.l(p,-1),a.r(p,b,d,c)}return""};a.m="";a.t={};a.C="";a.D={};a.getSupplementalDataID=function(d,c){!a.m&&!c&&(a.m=a.q(1));var b=a.m;a.C&&!a.D[d]?(b=a.C,a.D[d]=i):b&&(a.t[d]&&(a.C=a.m,a.D=a.t,a.m=b=!c?a.q(1):"",a.t={}),b&&(a.t[d]=i));return b};var u={k:!!l.postMessage,ha:1,N:864E5};a.Oa=u;a.X={postMessage:function(a,c,b){var e=1;c&&(u.k?b.postMessage(a,c.replace(/([^:]+:\/\/[^\/]+).*/,
"$1")):c&&(b.location=c.replace(/#.*$/,"")+"#"+ +new Date+e++ +"&"+a))},J:function(a,c){var b;try{if(u.k)if(a&&(b=function(b){if("string"===typeof c&&b.origin!==c||"[object Function]"===Object.prototype.toString.call(c)&&!1===c(b.origin))return!1;a(b)}),window.addEventListener)window[a?"addEventListener":"removeEventListener"]("message",b,!1);else window[a?"attachEvent":"detachEvent"]("onmessage",b)}catch(e){}}};var E={Y:function(){if(n.addEventListener)return function(a,c,b){a.addEventListener(c,
function(a){"function"===typeof b&&b(a)},k)};if(n.attachEvent)return function(a,c,b){a.attachEvent("on"+c,function(a){"function"===typeof b&&b(a)})}}(),map:function(a,c){if(Array.prototype.map)return a.map(c);if(void 0===a||a===h)throw new TypeError;var b=Object(a),e=b.length>>>0;if("function"!==typeof c)throw new TypeError;for(var f=Array(e),g=0;g<e;g++)g in b&&(f[g]=c.call(c,b[g],g,b));return f},za:function(a,c){return this.map(a,function(a){return encodeURIComponent(a)}).join(c)}};a.Ta=E;var t=
{ia:3E4,M:649,fa:k,id:h,H:h,aa:function(a){if("string"===typeof a)return a=a.split("/"),a[0]+"//"+a[2]},e:h,url:h,Aa:function(){var d="http://fast.",c="?d_nsid="+a.idSyncContainerID+"#"+encodeURIComponent(n.location.href);this.e||(this.e="nosubdomainreturned");a.loadSSL&&(d=a.idSyncSSLUseAkamai?"https://fast.":"https://");d=d+this.e+".demdex.net/dest5.html"+c;this.H=this.aa(d);this.id="destination_publishing_iframe_"+this.e+"_"+a.idSyncContainerID;return d},va:function(){var d="?d_nsid="+a.idSyncContainerID+
"#"+encodeURIComponent(n.location.href);"string"===typeof a.z&&a.z.length&&(this.id="destination_publishing_iframe_"+(new Date).getTime()+"_"+a.idSyncContainerID,this.H=this.aa(a.z),this.url=a.z+d)},ba:h,G:k,L:k,v:h,gb:h,Ga:h,hb:h,K:k,w:[],Ea:[],Fa:[],ca:u.k?15:100,I:[],Ca:[],$:i,da:k,Z:function(){function a(){e=document.createElement("iframe");e.id=b.id;e.style.cssText="display: none; width: 0; height: 0;";e.src=b.url;b.Ga=i;c();document.body.appendChild(e)}function c(){E.Y(e,"load",function(){e.className=
"aamIframeLoaded";b.v=i;b.n()})}this.L=i;var b=this,e=document.getElementById(this.id);e?"IFRAME"!==e.nodeName?(this.id+="_2",a()):"aamIframeLoaded"!==e.className?c():(this.v=i,this.n()):a();this.Ba=e},n:function(d){var c=this;d===Object(d)&&this.I.push(d);if((this.da||!u.k||this.v)&&this.I.length)this.Ha(this.I.shift()),this.n();!a.idSyncDisableSyncs&&this.v&&this.w.length&&!this.K&&(this.fa||(this.fa=i,setTimeout(function(){c.ca=u.k?15:150},this.ia)),this.K=i,this.ea())},Ha:function(a){var c=encodeURIComponent,
b,e,f,g,h;if((b=a.ibs)&&b instanceof Array&&(e=b.length))for(f=0;f<e;f++)g=b[f],h=[c("ibs"),c(g.id||""),c(g.tag||""),E.za(g.url||[],","),c(g.ttl||""),"","",g.fireURLSync?"true":"false"],this.$?this.F(h.join("|")):g.fireURLSync&&this.wa(g,h.join("|"));this.Ca.push(a)},wa:function(d,c){a.f();var b=a.b(B),e=k,f=k,g=Math.ceil((new Date).getTime()/u.N);if(b){if(b=b.split("*"),f=this.Ja(b,d.id,g),e=f.xa,f=f.ya,!e||!f)this.F(c),b.push(d.id+"-"+(g+Math.ceil(d.ttl/60/24))),this.Da(b),a.c(B,b.join("*"))}else this.F(c),
a.c(B,d.id+"-"+(g+Math.ceil(d.ttl/60/24)))},Ja:function(a,c,b){var e=k,f=k,g,h,j;for(h=0;h<a.length;h++)g=a[h],j=parseInt(g.split("-")[1],10),g.match("^"+c+"-")?(e=i,b<j?f=i:(a.splice(h,1),h--)):b>=j&&(a.splice(h,1),h--);return{xa:e,ya:f}},Da:function(a){if(a.join("*").length>this.M)for(a.sort(function(a,b){return parseInt(a.split("-")[1],10)-parseInt(b.split("-")[1],10)});a.join("*").length>this.M;)a.shift()},F:function(d){var c=encodeURIComponent;this.w.push((a.Qa?c("---destpub-debug---"):c("---destpub---"))+
d)},ea:function(){var d=this,c;this.w.length?(c=this.w.shift(),a.X.postMessage(c,this.url,this.Ba.contentWindow),this.Ea.push(c),setTimeout(function(){d.ea()},this.ca)):this.K=k},J:function(a){var c=/^---destpub-to-parent---/;"string"===typeof a&&c.test(a)&&(c=a.replace(c,"").split("|"),"canSetThirdPartyCookies"===c[0]&&(this.$="true"===c[1]?i:k,this.da=i,this.n()),this.Fa.push(a))},Ia:function(d){this.url===h&&(this.e="string"===typeof a.W&&a.W.length?a.W:d.subdomain||"",this.url=this.Aa());d.ibs instanceof
Array&&d.ibs.length&&(this.G=i);if(!a.idSyncDisable3rdPartySyncing&&(this.G||a.la)&&this.e&&"nosubdomainreturned"!==this.e&&!this.L)(j.ga||"complete"===n.readyState||"loaded"===n.readyState)&&this.Z();"function"===typeof a.idSyncIDCallResult?a.idSyncIDCallResult(d):this.n(d);"function"===typeof a.idSyncAfterIDCallResult&&a.idSyncAfterIDCallResult(d)},ua:function(d,c){return a.Ra||!d||c-d>u.ha}};a.Pa=t;0>m.indexOf("@")&&(m+="@AdobeOrg");a.marketingCloudOrgID=m;a.cookieName="AMCV_"+m;a.cookieDomain=
a.ma();a.cookieDomain==l.location.hostname&&(a.cookieDomain="");a.loadSSL=0<=l.location.protocol.toLowerCase().indexOf("https");a.loadTimeout=500;a.marketingCloudServer=a.audienceManagerServer="dpm.demdex.net";if(s&&"object"==typeof s){for(var C in s)!Object.prototype[C]&&(a[C]=s[C]);a.idSyncContainerID=a.idSyncContainerID||0;a.f();C=a.b(D);var F=Math.ceil((new Date).getTime()/u.N);!a.idSyncDisableSyncs&&t.ua(C,F)&&(a.l(p,-1),a.c(D,F));a.getMarketingCloudVisitorID();a.getAudienceManagerLocationHint();
a.getAudienceManagerBlob()}if(!a.idSyncDisableSyncs){t.va();E.Y(window,"load",function(){var d=t;j.ga=i;!a.idSyncDisable3rdPartySyncing&&(d.G||a.la)&&d.e&&"nosubdomainreturned"!==d.e&&d.url&&!d.L&&d.Z()});try{a.X.J(function(a){t.J(a.data)},t.H)}catch(G){}}}Visitor.getInstance=function(m,s){var a,l=window.s_c_il,j;0>m.indexOf("@")&&(m+="@AdobeOrg");if(l)for(j=0;j<l.length;j++)if((a=l[j])&&"Visitor"==a._c&&a.marketingCloudOrgID==m)return a;return new Visitor(m,s)};
(function(){function m(){s.ga=a}var s=window.Visitor,a=s.ja;a||(a=!0);window.addEventListener?window.addEventListener("load",m):window.attachEvent&&window.attachEvent("onload",m)})();

/**
 * WARNING: Changing any of the below variables will cause drastic
 * changes to how your visitor data is collected. Chanegs should only be
 * made when instructed to do so by your account manager
 *
 * Set-up the VisitorAPI component
 */
var visitor = Visitor.getInstance("16AD4362526701720A490D45@AdobeOrg", {
	trackingServer:"std.o.webmd.com",
	trackingServerSecure:"ssl.o.webmd.com",
	marketingCloudServer:"std.o.webmd.com",
	marketingCloudServerSecure:"ssl.o.webmd.com"
});

visitor.loadTimeout = 750;
/*
 ============== DO NOT ALTER ANYTHING BELOW THIS LINE ! ===============

AppMeasurement for JavaScript version: 1.5.2
Copyright 1996-2015 Adobe, Inc. All Rights Reserved
More info available at http://www.omniture.com
*/
function AppMeasurement(){var a=this;a.version="1.5.2";var k=window;k.s_c_in||(k.s_c_il=[],k.s_c_in=0);a._il=k.s_c_il;a._in=k.s_c_in;a._il[a._in]=a;k.s_c_in++;a._c="s_c";var q=k.AppMeasurement.zb;q||(q=null);var r=k,n,t;try{for(n=r.parent,t=r.location;n&&n.location&&t&&""+n.location!=""+t&&r.location&&""+n.location!=""+r.location&&n.location.host==t.host;)r=n,n=r.parent}catch(u){}a.ob=function(a){try{console.log(a)}catch(b){}};a.za=function(a){return""+parseInt(a)==""+a};a.replace=function(a,b,d){return!a||
0>a.indexOf(b)?a:a.split(b).join(d)};a.escape=function(c){var b,d;if(!c)return c;c=encodeURIComponent(c);for(b=0;7>b;b++)d="+~!*()'".substring(b,b+1),0<=c.indexOf(d)&&(c=a.replace(c,d,"%"+d.charCodeAt(0).toString(16).toUpperCase()));return c};a.unescape=function(c){if(!c)return c;c=0<=c.indexOf("+")?a.replace(c,"+"," "):c;try{return decodeURIComponent(c)}catch(b){}return unescape(c)};a.gb=function(){var c=k.location.hostname,b=a.fpCookieDomainPeriods,d;b||(b=a.cookieDomainPeriods);if(c&&!a.cookieDomain&&
!/^[0-9.]+$/.test(c)&&(b=b?parseInt(b):2,b=2<b?b:2,d=c.lastIndexOf("."),0<=d)){for(;0<=d&&1<b;)d=c.lastIndexOf(".",d-1),b--;a.cookieDomain=0<d?c.substring(d):c}return a.cookieDomain};a.c_r=a.cookieRead=function(c){c=a.escape(c);var b=" "+a.d.cookie,d=b.indexOf(" "+c+"="),f=0>d?d:b.indexOf(";",d);c=0>d?"":a.unescape(b.substring(d+2+c.length,0>f?b.length:f));return"[[B]]"!=c?c:""};a.c_w=a.cookieWrite=function(c,b,d){var f=a.gb(),e=a.cookieLifetime,g;b=""+b;e=e?(""+e).toUpperCase():"";d&&"SESSION"!=
e&&"NONE"!=e&&((g=""!=b?parseInt(e?e:0):-60)?(d=new Date,d.setTime(d.getTime()+1E3*g)):1==d&&(d=new Date,g=d.getYear(),d.setYear(g+5+(1900>g?1900:0))));return c&&"NONE"!=e?(a.d.cookie=c+"="+a.escape(""!=b?b:"[[B]]")+"; path=/;"+(d&&"SESSION"!=e?" expires="+d.toGMTString()+";":"")+(f?" domain="+f+";":""),a.cookieRead(c)==b):0};a.G=[];a.ba=function(c,b,d){if(a.ta)return 0;a.maxDelay||(a.maxDelay=250);var f=0,e=(new Date).getTime()+a.maxDelay,g=a.d.visibilityState,m=["webkitvisibilitychange","visibilitychange"];
g||(g=a.d.webkitVisibilityState);if(g&&"prerender"==g){if(!a.ca)for(a.ca=1,d=0;d<m.length;d++)a.d.addEventListener(m[d],function(){var c=a.d.visibilityState;c||(c=a.d.webkitVisibilityState);"visible"==c&&(a.ca=0,a.delayReady())});f=1;e=0}else d||a.l("_d")&&(f=1);f&&(a.G.push({m:c,a:b,t:e}),a.ca||setTimeout(a.delayReady,a.maxDelay));return f};a.delayReady=function(){var c=(new Date).getTime(),b=0,d;for(a.l("_d")?b=1:a.na();0<a.G.length;){d=a.G.shift();if(b&&!d.t&&d.t>c){a.G.unshift(d);setTimeout(a.delayReady,
parseInt(a.maxDelay/2));break}a.ta=1;a[d.m].apply(a,d.a);a.ta=0}};a.setAccount=a.sa=function(c){var b,d;if(!a.ba("setAccount",arguments))if(a.account=c,a.allAccounts)for(b=a.allAccounts.concat(c.split(",")),a.allAccounts=[],b.sort(),d=0;d<b.length;d++)0!=d&&b[d-1]==b[d]||a.allAccounts.push(b[d]);else a.allAccounts=c.split(",")};a.foreachVar=function(c,b){var d,f,e,g,m="";e=f="";if(a.lightProfileID)d=a.K,(m=a.lightTrackVars)&&(m=","+m+","+a.ga.join(",")+",");else{d=a.c;if(a.pe||a.linkType)m=a.linkTrackVars,
f=a.linkTrackEvents,a.pe&&(e=a.pe.substring(0,1).toUpperCase()+a.pe.substring(1),a[e]&&(m=a[e].yb,f=a[e].xb));m&&(m=","+m+","+a.A.join(",")+",");f&&m&&(m+=",events,")}b&&(b=","+b+",");for(f=0;f<d.length;f++)e=d[f],(g=a[e])&&(!m||0<=m.indexOf(","+e+","))&&(!b||0<=b.indexOf(","+e+","))&&c(e,g)};a.B=function(c,b,d,f,e){var g="",m,p,k,w,n=0;"contextData"==c&&(c="c");if(b){for(m in b)if(!(Object.prototype[m]||e&&m.substring(0,e.length)!=e)&&b[m]&&(!d||0<=d.indexOf(","+(f?f+".":"")+m+","))){k=!1;if(n)for(p=
0;p<n.length;p++)m.substring(0,n[p].length)==n[p]&&(k=!0);if(!k&&(""==g&&(g+="&"+c+"."),p=b[m],e&&(m=m.substring(e.length)),0<m.length))if(k=m.indexOf("."),0<k)p=m.substring(0,k),k=(e?e:"")+p+".",n||(n=[]),n.push(k),g+=a.B(p,b,d,f,k);else if("boolean"==typeof p&&(p=p?"true":"false"),p){if("retrieveLightData"==f&&0>e.indexOf(".contextData."))switch(k=m.substring(0,4),w=m.substring(4),m){case "transactionID":m="xact";break;case "channel":m="ch";break;case "campaign":m="v0";break;default:a.za(w)&&("prop"==
k?m="c"+w:"eVar"==k?m="v"+w:"list"==k?m="l"+w:"hier"==k&&(m="h"+w,p=p.substring(0,255)))}g+="&"+a.escape(m)+"="+a.escape(p)}}""!=g&&(g+="&."+c)}return g};a.ib=function(){var c="",b,d,f,e,g,m,p,k,n="",r="",s=e="";if(a.lightProfileID)b=a.K,(n=a.lightTrackVars)&&(n=","+n+","+a.ga.join(",")+",");else{b=a.c;if(a.pe||a.linkType)n=a.linkTrackVars,r=a.linkTrackEvents,a.pe&&(e=a.pe.substring(0,1).toUpperCase()+a.pe.substring(1),a[e]&&(n=a[e].yb,r=a[e].xb));n&&(n=","+n+","+a.A.join(",")+",");r&&(r=","+r+",",
n&&(n+=",events,"));a.events2&&(s+=(""!=s?",":"")+a.events2)}if(a.visitor&&1.5<=parseFloat(a.visitor.version)&&a.visitor.getCustomerIDs){e=q;if(g=a.visitor.getCustomerIDs())for(d in g)Object.prototype[d]||(f=g[d],e||(e={}),f.id&&(e[d+".id"]=f.id),f.authState&&(e[d+".as"]=f.authState));e&&(c+=a.B("cid",e))}a.AudienceManagement&&a.AudienceManagement.isReady()&&(c+=a.B("d",a.AudienceManagement.getEventCallConfigParams()));for(d=0;d<b.length;d++){e=b[d];g=a[e];f=e.substring(0,4);m=e.substring(4);!g&&
"events"==e&&s&&(g=s,s="");if(g&&(!n||0<=n.indexOf(","+e+","))){switch(e){case "supplementalDataID":e="sdid";break;case "timestamp":e="ts";break;case "dynamicVariablePrefix":e="D";break;case "visitorID":e="vid";break;case "marketingCloudVisitorID":e="mid";break;case "analyticsVisitorID":e="aid";break;case "audienceManagerLocationHint":e="aamlh";break;case "audienceManagerBlob":e="aamb";break;case "authState":e="as";break;case "pageURL":e="g";255<g.length&&(a.pageURLRest=g.substring(255),g=g.substring(0,
255));break;case "pageURLRest":e="-g";break;case "referrer":e="r";break;case "vmk":case "visitorMigrationKey":e="vmt";break;case "visitorMigrationServer":e="vmf";a.ssl&&a.visitorMigrationServerSecure&&(g="");break;case "visitorMigrationServerSecure":e="vmf";!a.ssl&&a.visitorMigrationServer&&(g="");break;case "charSet":e="ce";break;case "visitorNamespace":e="ns";break;case "cookieDomainPeriods":e="cdp";break;case "cookieLifetime":e="cl";break;case "variableProvider":e="vvp";break;case "currencyCode":e=
"cc";break;case "channel":e="ch";break;case "transactionID":e="xact";break;case "campaign":e="v0";break;case "latitude":e="lat";break;case "longitude":e="lon";break;case "resolution":e="s";break;case "colorDepth":e="c";break;case "javascriptVersion":e="j";break;case "javaEnabled":e="v";break;case "cookiesEnabled":e="k";break;case "browserWidth":e="bw";break;case "browserHeight":e="bh";break;case "connectionType":e="ct";break;case "homepage":e="hp";break;case "events":s&&(g+=(""!=g?",":"")+s);if(r)for(m=
g.split(","),g="",f=0;f<m.length;f++)p=m[f],k=p.indexOf("="),0<=k&&(p=p.substring(0,k)),k=p.indexOf(":"),0<=k&&(p=p.substring(0,k)),0<=r.indexOf(","+p+",")&&(g+=(g?",":"")+m[f]);break;case "events2":g="";break;case "contextData":c+=a.B("c",a[e],n,e);g="";break;case "lightProfileID":e="mtp";break;case "lightStoreForSeconds":e="mtss";a.lightProfileID||(g="");break;case "lightIncrementBy":e="mti";a.lightProfileID||(g="");break;case "retrieveLightProfiles":e="mtsr";break;case "deleteLightProfiles":e=
"mtsd";break;case "retrieveLightData":a.retrieveLightProfiles&&(c+=a.B("mts",a[e],n,e));g="";break;default:a.za(m)&&("prop"==f?e="c"+m:"eVar"==f?e="v"+m:"list"==f?e="l"+m:"hier"==f&&(e="h"+m,g=g.substring(0,255)))}g&&(c+="&"+e+"="+("pev"!=e.substring(0,3)?a.escape(g):g))}"pev3"==e&&a.e&&(c+=a.e)}return c};a.u=function(a){var b=a.tagName;if("undefined"!=""+a.Cb||"undefined"!=""+a.sb&&"HTML"!=(""+a.sb).toUpperCase())return"";b=b&&b.toUpperCase?b.toUpperCase():"";"SHAPE"==b&&(b="");b&&(("INPUT"==b||
"BUTTON"==b)&&a.type&&a.type.toUpperCase?b=a.type.toUpperCase():!b&&a.href&&(b="A"));return b};a.va=function(a){var b=a.href?a.href:"",d,f,e;d=b.indexOf(":");f=b.indexOf("?");e=b.indexOf("/");b&&(0>d||0<=f&&d>f||0<=e&&d>e)&&(f=a.protocol&&1<a.protocol.length?a.protocol:l.protocol?l.protocol:"",d=l.pathname.lastIndexOf("/"),b=(f?f+"//":"")+(a.host?a.host:l.host?l.host:"")+("/"!=h.substring(0,1)?l.pathname.substring(0,0>d?0:d)+"/":"")+b);return b};a.H=function(c){var b=a.u(c),d,f,e="",g=0;return b&&
(d=c.protocol,f=c.onclick,!c.href||"A"!=b&&"AREA"!=b||f&&d&&!(0>d.toLowerCase().indexOf("javascript"))?f?(e=a.replace(a.replace(a.replace(a.replace(""+f,"\r",""),"\n",""),"\t","")," ",""),g=2):"INPUT"==b||"SUBMIT"==b?(c.value?e=c.value:c.innerText?e=c.innerText:c.textContent&&(e=c.textContent),g=3):c.src&&"IMAGE"==b&&(e=c.src):e=a.va(c),e)?{id:e.substring(0,100),type:g}:0};a.Ab=function(c){for(var b=a.u(c),d=a.H(c);c&&!d&&"BODY"!=b;)if(c=c.parentElement?c.parentElement:c.parentNode)b=a.u(c),d=a.H(c);
d&&"BODY"!=b||(c=0);c&&(b=c.onclick?""+c.onclick:"",0<=b.indexOf(".tl(")||0<=b.indexOf(".trackLink("))&&(c=0);return c};a.rb=function(){var c,b,d=a.linkObject,f=a.linkType,e=a.linkURL,g,m;a.ha=1;d||(a.ha=0,d=a.clickObject);if(d){c=a.u(d);for(b=a.H(d);d&&!b&&"BODY"!=c;)if(d=d.parentElement?d.parentElement:d.parentNode)c=a.u(d),b=a.H(d);b&&"BODY"!=c||(d=0);if(d){var p=d.onclick?""+d.onclick:"";if(0<=p.indexOf(".tl(")||0<=p.indexOf(".trackLink("))d=0}}else a.ha=1;!e&&d&&(e=a.va(d));e&&!a.linkLeaveQueryString&&
(g=e.indexOf("?"),0<=g&&(e=e.substring(0,g)));if(!f&&e){var n=0,r=0,q;if(a.trackDownloadLinks&&a.linkDownloadFileTypes)for(p=e.toLowerCase(),g=p.indexOf("?"),m=p.indexOf("#"),0<=g?0<=m&&m<g&&(g=m):g=m,0<=g&&(p=p.substring(0,g)),g=a.linkDownloadFileTypes.toLowerCase().split(","),m=0;m<g.length;m++)(q=g[m])&&p.substring(p.length-(q.length+1))=="."+q&&(f="d");if(a.trackExternalLinks&&!f&&(p=e.toLowerCase(),a.ya(p)&&(a.linkInternalFilters||(a.linkInternalFilters=k.location.hostname),g=0,a.linkExternalFilters?
(g=a.linkExternalFilters.toLowerCase().split(","),n=1):a.linkInternalFilters&&(g=a.linkInternalFilters.toLowerCase().split(",")),g))){for(m=0;m<g.length;m++)q=g[m],0<=p.indexOf(q)&&(r=1);r?n&&(f="e"):n||(f="e")}}a.linkObject=d;a.linkURL=e;a.linkType=f;if(a.trackClickMap||a.trackInlineStats)a.e="",d&&(f=a.pageName,e=1,d=d.sourceIndex,f||(f=a.pageURL,e=0),k.s_objectID&&(b.id=k.s_objectID,d=b.type=1),f&&b&&b.id&&c&&(a.e="&pid="+a.escape(f.substring(0,255))+(e?"&pidt="+e:"")+"&oid="+a.escape(b.id.substring(0,
100))+(b.type?"&oidt="+b.type:"")+"&ot="+c+(d?"&oi="+d:"")))};a.jb=function(){var c=a.ha,b=a.linkType,d=a.linkURL,f=a.linkName;b&&(d||f)&&(b=b.toLowerCase(),"d"!=b&&"e"!=b&&(b="o"),a.pe="lnk_"+b,a.pev1=d?a.escape(d):"",a.pev2=f?a.escape(f):"",c=1);a.abort&&(c=0);if(a.trackClickMap||a.trackInlineStats){var b={},d=0,e=a.cookieRead("s_sq"),g=e?e.split("&"):0,m,p,k,e=0;if(g)for(m=0;m<g.length;m++)p=g[m].split("="),f=a.unescape(p[0]).split(","),p=a.unescape(p[1]),b[p]=f;f=a.account.split(",");if(c||a.e){c&&
!a.e&&(e=1);for(p in b)if(!Object.prototype[p])for(m=0;m<f.length;m++)for(e&&(k=b[p].join(","),k==a.account&&(a.e+=("&"!=p.charAt(0)?"&":"")+p,b[p]=[],d=1)),g=0;g<b[p].length;g++)k=b[p][g],k==f[m]&&(e&&(a.e+="&u="+a.escape(k)+("&"!=p.charAt(0)?"&":"")+p+"&u=0"),b[p].splice(g,1),d=1);c||(d=1);if(d){e="";m=2;!c&&a.e&&(e=a.escape(f.join(","))+"="+a.escape(a.e),m=1);for(p in b)!Object.prototype[p]&&0<m&&0<b[p].length&&(e+=(e?"&":"")+a.escape(b[p].join(","))+"="+a.escape(p),m--);a.cookieWrite("s_sq",e)}}}return c};
a.kb=function(){if(!a.wb){var c=new Date,b=r.location,d,f,e=f=d="",g="",m="",k="1.2",n=a.cookieWrite("s_cc","true",0)?"Y":"N",q="",s="";if(c.setUTCDate&&(k="1.3",(0).toPrecision&&(k="1.5",c=[],c.forEach))){k="1.6";f=0;d={};try{f=new Iterator(d),f.next&&(k="1.7",c.reduce&&(k="1.8",k.trim&&(k="1.8.1",Date.parse&&(k="1.8.2",Object.create&&(k="1.8.5")))))}catch(t){}}d=screen.width+"x"+screen.height;e=navigator.javaEnabled()?"Y":"N";f=screen.pixelDepth?screen.pixelDepth:screen.colorDepth;g=a.w.innerWidth?
a.w.innerWidth:a.d.documentElement.offsetWidth;m=a.w.innerHeight?a.w.innerHeight:a.d.documentElement.offsetHeight;try{a.b.addBehavior("#default#homePage"),q=a.b.Bb(b)?"Y":"N"}catch(u){}try{a.b.addBehavior("#default#clientCaps"),s=a.b.connectionType}catch(x){}a.resolution=d;a.colorDepth=f;a.javascriptVersion=k;a.javaEnabled=e;a.cookiesEnabled=n;a.browserWidth=g;a.browserHeight=m;a.connectionType=s;a.homepage=q;a.wb=1}};a.L={};a.loadModule=function(c,b){var d=a.L[c];if(!d){d=k["AppMeasurement_Module_"+
c]?new k["AppMeasurement_Module_"+c](a):{};a.L[c]=a[c]=d;d.Oa=function(){return d.Sa};d.Ta=function(b){if(d.Sa=b)a[c+"_onLoad"]=b,a.ba(c+"_onLoad",[a,d],1)||b(a,d)};try{Object.defineProperty?Object.defineProperty(d,"onLoad",{get:d.Oa,set:d.Ta}):d._olc=1}catch(f){d._olc=1}}b&&(a[c+"_onLoad"]=b,a.ba(c+"_onLoad",[a,d],1)||b(a,d))};a.l=function(c){var b,d;for(b in a.L)if(!Object.prototype[b]&&(d=a.L[b])&&(d._olc&&d.onLoad&&(d._olc=0,d.onLoad(a,d)),d[c]&&d[c]()))return 1;return 0};a.mb=function(){var c=
Math.floor(1E13*Math.random()),b=a.visitorSampling,d=a.visitorSamplingGroup,d="s_vsn_"+(a.visitorNamespace?a.visitorNamespace:a.account)+(d?"_"+d:""),f=a.cookieRead(d);if(b){f&&(f=parseInt(f));if(!f){if(!a.cookieWrite(d,c))return 0;f=c}if(f%1E4>v)return 0}return 1};a.M=function(c,b){var d,f,e,g,m,k;for(d=0;2>d;d++)for(f=0<d?a.oa:a.c,e=0;e<f.length;e++)if(g=f[e],(m=c[g])||c["!"+g]){if(!b&&("contextData"==g||"retrieveLightData"==g)&&a[g])for(k in a[g])m[k]||(m[k]=a[g][k]);a[g]=m}};a.Ha=function(c,b){var d,
f,e,g;for(d=0;2>d;d++)for(f=0<d?a.oa:a.c,e=0;e<f.length;e++)g=f[e],c[g]=a[g],b||c[g]||(c["!"+g]=1)};a.eb=function(a){var b,d,f,e,g,m=0,k,n="",q="";if(a&&255<a.length&&(b=""+a,d=b.indexOf("?"),0<d&&(k=b.substring(d+1),b=b.substring(0,d),e=b.toLowerCase(),f=0,"http://"==e.substring(0,7)?f+=7:"https://"==e.substring(0,8)&&(f+=8),d=e.indexOf("/",f),0<d&&(e=e.substring(f,d),g=b.substring(d),b=b.substring(0,d),0<=e.indexOf("google")?m=",q,ie,start,search_key,word,kw,cd,":0<=e.indexOf("yahoo.co")&&(m=",p,ei,"),
m&&k)))){if((a=k.split("&"))&&1<a.length){for(f=0;f<a.length;f++)e=a[f],d=e.indexOf("="),0<d&&0<=m.indexOf(","+e.substring(0,d)+",")?n+=(n?"&":"")+e:q+=(q?"&":"")+e;n&&q?k=n+"&"+q:q=""}d=253-(k.length-q.length)-b.length;a=b+(0<d?g.substring(0,d):"")+"?"+k}return a};a.Na=function(c){var b=a.d.visibilityState,d=["webkitvisibilitychange","visibilitychange"];b||(b=a.d.webkitVisibilityState);if(b&&"prerender"==b){if(c)for(b=0;b<d.length;b++)a.d.addEventListener(d[b],function(){var b=a.d.visibilityState;
b||(b=a.d.webkitVisibilityState);"visible"==b&&c()});return!1}return!0};a.Y=!1;a.D=!1;a.Ua=function(){a.D=!0;a.i()};a.W=!1;a.Q=!1;a.Ra=function(c){a.marketingCloudVisitorID=c;a.Q=!0;a.i()};a.T=!1;a.N=!1;a.Ja=function(c){a.analyticsVisitorID=c;a.N=!0;a.i()};a.V=!1;a.P=!1;a.La=function(c){a.audienceManagerLocationHint=c;a.P=!0;a.i()};a.U=!1;a.O=!1;a.Ka=function(c){a.audienceManagerBlob=c;a.O=!0;a.i()};a.Ma=function(c){a.maxDelay||(a.maxDelay=250);return a.l("_d")?(c&&setTimeout(function(){c()},a.maxDelay),
!1):!0};a.X=!1;a.C=!1;a.na=function(){a.C=!0;a.i()};a.isReadyToTrack=function(){var c=!0,b=a.visitor;a.Y||a.D||(a.Na(a.Ua)?a.D=!0:a.Y=!0);if(a.Y&&!a.D)return!1;b&&b.isAllowed()&&(a.W||a.marketingCloudVisitorID||!b.getMarketingCloudVisitorID||(a.W=!0,a.marketingCloudVisitorID=b.getMarketingCloudVisitorID([a,a.Ra]),a.marketingCloudVisitorID&&(a.Q=!0)),a.T||a.analyticsVisitorID||!b.getAnalyticsVisitorID||(a.T=!0,a.analyticsVisitorID=b.getAnalyticsVisitorID([a,a.Ja]),a.analyticsVisitorID&&(a.N=!0)),a.V||
a.audienceManagerLocationHint||!b.getAudienceManagerLocationHint||(a.V=!0,a.audienceManagerLocationHint=b.getAudienceManagerLocationHint([a,a.La]),a.audienceManagerLocationHint&&(a.P=!0)),a.U||a.audienceManagerBlob||!b.getAudienceManagerBlob||(a.U=!0,a.audienceManagerBlob=b.getAudienceManagerBlob([a,a.Ka]),a.audienceManagerBlob&&(a.O=!0)),a.W&&!a.Q&&!a.marketingCloudVisitorID||a.T&&!a.N&&!a.analyticsVisitorID||a.V&&!a.P&&!a.audienceManagerLocationHint||a.U&&!a.O&&!a.audienceManagerBlob)&&(c=!1);a.X||
a.C||(a.Ma(a.na)?a.C=!0:a.X=!0);a.X&&!a.C&&(c=!1);return c};a.k=q;a.o=0;a.callbackWhenReadyToTrack=function(c,b,d){var f;f={};f.Ya=c;f.Xa=b;f.Va=d;a.k==q&&(a.k=[]);a.k.push(f);0==a.o&&(a.o=setInterval(a.i,100))};a.i=function(){var c;if(a.isReadyToTrack()&&(a.o&&(clearInterval(a.o),a.o=0),a.k!=q))for(;0<a.k.length;)c=a.k.shift(),c.Xa.apply(c.Ya,c.Va)};a.Pa=function(c){var b,d,f=q,e=q;if(!a.isReadyToTrack()){b=[];if(c!=q)for(d in f={},c)f[d]=c[d];e={};a.Ha(e,!0);b.push(f);b.push(e);a.callbackWhenReadyToTrack(a,
a.track,b);return!0}return!1};a.hb=function(){var c=a.cookieRead("s_fid"),b="",d="",f;f=8;var e=4;if(!c||0>c.indexOf("-")){for(c=0;16>c;c++)f=Math.floor(Math.random()*f),b+="0123456789ABCDEF".substring(f,f+1),f=Math.floor(Math.random()*e),d+="0123456789ABCDEF".substring(f,f+1),f=e=16;c=b+"-"+d}a.cookieWrite("s_fid",c,1)||(c=0);return c};a.t=a.track=function(c,b){var d,f=new Date,e="s"+Math.floor(f.getTime()/108E5)%10+Math.floor(1E13*Math.random()),g=f.getYear(),g="t="+a.escape(f.getDate()+"/"+f.getMonth()+
"/"+(1900>g?g+1900:g)+" "+f.getHours()+":"+f.getMinutes()+":"+f.getSeconds()+" "+f.getDay()+" "+f.getTimezoneOffset());a.visitor&&(a.visitor.fb&&(a.authState=a.visitor.fb()),!a.supplementalDataID&&a.visitor.getSupplementalDataID&&(a.supplementalDataID=a.visitor.getSupplementalDataID("AppMeasurement:"+a._in,a.expectSupplementalData?!1:!0)));a.l("_s");a.Pa(c)||(b&&a.M(b),c&&(d={},a.Ha(d,0),a.M(c)),a.mb()&&(a.analyticsVisitorID||a.marketingCloudVisitorID||(a.fid=a.hb()),a.rb(),a.usePlugins&&a.doPlugins&&
a.doPlugins(a),a.account&&(a.abort||(a.trackOffline&&!a.timestamp&&(a.timestamp=Math.floor(f.getTime()/1E3)),f=k.location,a.pageURL||(a.pageURL=f.href?f.href:f),a.referrer||a.Ia||(a.referrer=r.document.referrer),a.Ia=1,a.referrer=a.eb(a.referrer),a.l("_g")),a.jb()&&!a.abort&&(a.kb(),g+=a.ib(),a.qb(e,g),a.l("_t"),a.referrer=""))),c&&a.M(d,1));a.abort=a.supplementalDataID=a.timestamp=a.pageURLRest=a.linkObject=a.clickObject=a.linkURL=a.linkName=a.linkType=k.s_objectID=a.pe=a.pev1=a.pev2=a.pev3=a.e=
a.lightProfileID=0};a.tl=a.trackLink=function(c,b,d,f,e){a.linkObject=c;a.linkType=b;a.linkName=d;e&&(a.j=c,a.q=e);return a.track(f)};a.trackLight=function(c,b,d,f){a.lightProfileID=c;a.lightStoreForSeconds=b;a.lightIncrementBy=d;return a.track(f)};a.clearVars=function(){var c,b;for(c=0;c<a.c.length;c++)if(b=a.c[c],"prop"==b.substring(0,4)||"eVar"==b.substring(0,4)||"hier"==b.substring(0,4)||"list"==b.substring(0,4)||"channel"==b||"events"==b||"eventList"==b||"products"==b||"productList"==b||"purchaseID"==
b||"transactionID"==b||"state"==b||"zip"==b||"campaign"==b)a[b]=void 0};a.tagContainerMarker="";a.qb=function(c,b){var d,f=a.trackingServer;d="";var e=a.dc,g="sc.",k=a.visitorNamespace;f?a.trackingServerSecure&&a.ssl&&(f=a.trackingServerSecure):(k||(k=a.account,f=k.indexOf(","),0<=f&&(k=k.substring(0,f)),k=k.replace(/[^A-Za-z0-9]/g,"")),d||(d="2o7.net"),e=e?(""+e).toLowerCase():"d1","2o7.net"==d&&("d1"==e?e="112":"d2"==e&&(e="122"),g=""),f=k+"."+e+"."+g+d);d=a.ssl?"https://":"http://";e=a.AudienceManagement&&
a.AudienceManagement.isReady();d+=f+"/b/ss/"+a.account+"/"+(a.mobile?"5.":"")+(e?"10":"1")+"/JS-"+a.version+(a.vb?"T":"")+(a.tagContainerMarker?"-"+a.tagContainerMarker:"")+"/"+c+"?AQB=1&ndh=1&pf=1&"+(e?"callback=s_c_il["+a._in+"].AudienceManagement.passData&":"")+b+"&AQE=1";a.bb(d);a.da()};a.bb=function(c){a.g||a.lb();a.g.push(c);a.fa=a.r();a.Fa()};a.lb=function(){a.g=a.nb();a.g||(a.g=[])};a.nb=function(){var c,b;if(a.ka()){try{(b=k.localStorage.getItem(a.ia()))&&(c=k.JSON.parse(b))}catch(d){}return c}};
a.ka=function(){var c=!0;a.trackOffline&&a.offlineFilename&&k.localStorage&&k.JSON||(c=!1);return c};a.wa=function(){var c=0;a.g&&(c=a.g.length);a.v&&c++;return c};a.da=function(){if(!a.v)if(a.xa=q,a.ja)a.fa>a.J&&a.Da(a.g),a.ma(500);else{var c=a.Wa();if(0<c)a.ma(c);else if(c=a.ua())a.v=1,a.pb(c),a.tb(c)}};a.ma=function(c){a.xa||(c||(c=0),a.xa=setTimeout(a.da,c))};a.Wa=function(){var c;if(!a.trackOffline||0>=a.offlineThrottleDelay)return 0;c=a.r()-a.Ca;return a.offlineThrottleDelay<c?0:a.offlineThrottleDelay-
c};a.ua=function(){if(0<a.g.length)return a.g.shift()};a.pb=function(c){if(a.debugTracking){var b="AppMeasurement Debug: "+c;c=c.split("&");var d;for(d=0;d<c.length;d++)b+="\n\t"+a.unescape(c[d]);a.ob(b)}};a.Qa=function(){return a.marketingCloudVisitorID||a.analyticsVisitorID};a.S=!1;var s;try{s=JSON.parse('{"x":"y"}')}catch(x){s=null}s&&"y"==s.x?(a.S=!0,a.R=function(a){return JSON.parse(a)}):k.$&&k.$.parseJSON?(a.R=function(a){return k.$.parseJSON(a)},a.S=!0):a.R=function(){return null};a.tb=function(c){var b,
d,f;a.Qa()&&2047<c.length&&("undefined"!=typeof XMLHttpRequest&&(b=new XMLHttpRequest,"withCredentials"in b?d=1:b=0),b||"undefined"==typeof XDomainRequest||(b=new XDomainRequest,d=2),b&&a.AudienceManagement&&a.AudienceManagement.isReady()&&(a.S?b.pa=!0:b=0));!b&&a.Ga&&(c=c.substring(0,2047));!b&&a.d.createElement&&a.AudienceManagement&&a.AudienceManagement.isReady()&&(b=a.d.createElement("SCRIPT"))&&"async"in b&&((f=(f=a.d.getElementsByTagName("HEAD"))&&f[0]?f[0]:a.d.body)?(b.type="text/javascript",
b.setAttribute("async","async"),d=3):b=0);b||(b=new Image,b.alt="");b.ra=function(){try{a.la&&(clearTimeout(a.la),a.la=0),b.timeout&&(clearTimeout(b.timeout),b.timeout=0)}catch(c){}};b.onload=b.ub=function(){b.ra();a.ab();a.Z();a.v=0;a.da();if(b.pa){b.pa=!1;try{var c=a.R(b.responseText);AudienceManagement.passData(c)}catch(d){}}};b.onabort=b.onerror=b.cb=function(){b.ra();(a.trackOffline||a.ja)&&a.v&&a.g.unshift(a.$a);a.v=0;a.fa>a.J&&a.Da(a.g);a.Z();a.ma(500)};b.onreadystatechange=function(){4==b.readyState&&
(200==b.status?b.ub():b.cb())};a.Ca=a.r();if(1==d||2==d){var e=c.indexOf("?");f=c.substring(0,e);e=c.substring(e+1);e=e.replace(/&callback=[a-zA-Z0-9_.\[\]]+/,"");1==d?(b.open("POST",f,!0),b.send(e)):2==d&&(b.open("POST",f),b.send(e))}else if(b.src=c,3==d){if(a.Aa)try{f.removeChild(a.Aa)}catch(g){}f.firstChild?f.insertBefore(b,f.firstChild):f.appendChild(b);a.Aa=a.Za}b.abort&&(a.la=setTimeout(b.abort,5E3));a.$a=c;a.Za=k["s_i_"+a.replace(a.account,",","_")]=b;if(a.useForcedLinkTracking&&a.F||a.q)a.forcedLinkTrackingTimeout||
(a.forcedLinkTrackingTimeout=250),a.aa=setTimeout(a.Z,a.forcedLinkTrackingTimeout)};a.ab=function(){if(a.ka()&&!(a.Ba>a.J))try{k.localStorage.removeItem(a.ia()),a.Ba=a.r()}catch(c){}};a.Da=function(c){if(a.ka()){a.Fa();try{k.localStorage.setItem(a.ia(),k.JSON.stringify(c)),a.J=a.r()}catch(b){}}};a.Fa=function(){if(a.trackOffline){if(!a.offlineLimit||0>=a.offlineLimit)a.offlineLimit=10;for(;a.g.length>a.offlineLimit;)a.ua()}};a.forceOffline=function(){a.ja=!0};a.forceOnline=function(){a.ja=!1};a.ia=
function(){return a.offlineFilename+"-"+a.visitorNamespace+a.account};a.r=function(){return(new Date).getTime()};a.ya=function(a){a=a.toLowerCase();return 0!=a.indexOf("#")&&0!=a.indexOf("about:")&&0!=a.indexOf("opera:")&&0!=a.indexOf("javascript:")?!0:!1};a.setTagContainer=function(c){var b,d,f;a.vb=c;for(b=0;b<a._il.length;b++)if((d=a._il[b])&&"s_l"==d._c&&d.tagContainerName==c){a.M(d);if(d.lmq)for(b=0;b<d.lmq.length;b++)f=d.lmq[b],a.loadModule(f.n);if(d.ml)for(f in d.ml)if(a[f])for(b in c=a[f],
f=d.ml[f],f)!Object.prototype[b]&&("function"!=typeof f[b]||0>(""+f[b]).indexOf("s_c_il"))&&(c[b]=f[b]);if(d.mmq)for(b=0;b<d.mmq.length;b++)f=d.mmq[b],a[f.m]&&(c=a[f.m],c[f.f]&&"function"==typeof c[f.f]&&(f.a?c[f.f].apply(c,f.a):c[f.f].apply(c)));if(d.tq)for(b=0;b<d.tq.length;b++)a.track(d.tq[b]);d.s=a;break}};a.Util={urlEncode:a.escape,urlDecode:a.unescape,cookieRead:a.cookieRead,cookieWrite:a.cookieWrite,getQueryParam:function(c,b,d){var f;b||(b=a.pageURL?a.pageURL:k.location);d||(d="&");return c&&
b&&(b=""+b,f=b.indexOf("?"),0<=f&&(b=d+b.substring(f+1)+d,f=b.indexOf(d+c+"="),0<=f&&(b=b.substring(f+d.length+c.length+1),f=b.indexOf(d),0<=f&&(b=b.substring(0,f)),0<b.length)))?a.unescape(b):""}};a.A="supplementalDataID timestamp dynamicVariablePrefix visitorID marketingCloudVisitorID analyticsVisitorID audienceManagerLocationHint authState fid vmk visitorMigrationKey visitorMigrationServer visitorMigrationServerSecure charSet visitorNamespace cookieDomainPeriods fpCookieDomainPeriods cookieLifetime pageName pageURL referrer contextData currencyCode lightProfileID lightStoreForSeconds lightIncrementBy retrieveLightProfiles deleteLightProfiles retrieveLightData pe pev1 pev2 pev3 pageURLRest".split(" ");
a.c=a.A.concat("purchaseID variableProvider channel server pageType transactionID campaign state zip events events2 products audienceManagerBlob tnt".split(" "));a.ga="timestamp charSet visitorNamespace cookieDomainPeriods cookieLifetime contextData lightProfileID lightStoreForSeconds lightIncrementBy".split(" ");a.K=a.ga.slice(0);a.oa="account allAccounts debugTracking visitor trackOffline offlineLimit offlineThrottleDelay offlineFilename usePlugins doPlugins configURL visitorSampling visitorSamplingGroup linkObject clickObject linkURL linkName linkType trackDownloadLinks trackExternalLinks trackClickMap trackInlineStats linkLeaveQueryString linkTrackVars linkTrackEvents linkDownloadFileTypes linkExternalFilters linkInternalFilters useForcedLinkTracking forcedLinkTrackingTimeout trackingServer trackingServerSecure ssl abort mobile dc lightTrackVars maxDelay expectSupplementalData AudienceManagement".split(" ");
for(n=0;250>=n;n++)76>n&&(a.c.push("prop"+n),a.K.push("prop"+n)),a.c.push("eVar"+n),a.K.push("eVar"+n),6>n&&a.c.push("hier"+n),4>n&&a.c.push("list"+n);n="latitude longitude resolution colorDepth javascriptVersion javaEnabled cookiesEnabled browserWidth browserHeight connectionType homepage".split(" ");a.c=a.c.concat(n);a.A=a.A.concat(n);a.ssl=0<=k.location.protocol.toLowerCase().indexOf("https");a.charSet="UTF-8";a.contextData={};a.offlineThrottleDelay=0;a.offlineFilename="AppMeasurement.offline";
a.Ca=0;a.fa=0;a.J=0;a.Ba=0;a.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx";a.w=k;a.d=k.document;try{if(a.Ga=!1,navigator){var y=navigator.userAgent;if("Microsoft Internet Explorer"==navigator.appName||0<=y.indexOf("MSIE ")||0<=y.indexOf("Trident/")&&0<=y.indexOf("Windows NT 6"))a.Ga=!0}}catch(z){}a.Z=function(){a.aa&&(k.clearTimeout(a.aa),a.aa=q);a.j&&a.F&&a.j.dispatchEvent(a.F);a.q&&("function"==typeof a.q?a.q():a.j&&a.j.href&&(a.d.location=a.j.href));a.j=
a.F=a.q=0};a.Ea=function(){a.b=a.d.body;a.b?(a.p=function(c){var b,d,f,e,g;if(!(a.d&&a.d.getElementById("cppXYctnr")||c&&c["s_fe_"+a._in])){if(a.qa)if(a.useForcedLinkTracking)a.b.removeEventListener("click",a.p,!1);else{a.b.removeEventListener("click",a.p,!0);a.qa=a.useForcedLinkTracking=0;return}else a.useForcedLinkTracking=0;a.clickObject=c.srcElement?c.srcElement:c.target;try{if(!a.clickObject||a.I&&a.I==a.clickObject||!(a.clickObject.tagName||a.clickObject.parentElement||a.clickObject.parentNode))a.clickObject=
0;else{var m=a.I=a.clickObject;a.ea&&(clearTimeout(a.ea),a.ea=0);a.ea=setTimeout(function(){a.I==m&&(a.I=0)},1E4);f=a.wa();a.track();if(f<a.wa()&&a.useForcedLinkTracking&&c.target){for(e=c.target;e&&e!=a.b&&"A"!=e.tagName.toUpperCase()&&"AREA"!=e.tagName.toUpperCase();)e=e.parentNode;if(e&&(g=e.href,a.ya(g)||(g=0),d=e.target,c.target.dispatchEvent&&g&&(!d||"_self"==d||"_top"==d||"_parent"==d||k.name&&d==k.name))){try{b=a.d.createEvent("MouseEvents")}catch(n){b=new k.MouseEvent}if(b){try{b.initMouseEvent("click",
c.bubbles,c.cancelable,c.view,c.detail,c.screenX,c.screenY,c.clientX,c.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,c.relatedTarget)}catch(q){b=0}b&&(b["s_fe_"+a._in]=b.s_fe=1,c.stopPropagation(),c.stopImmediatePropagation&&c.stopImmediatePropagation(),c.preventDefault(),a.j=c.target,a.F=b)}}}}}catch(r){a.clickObject=0}}},a.b&&a.b.attachEvent?a.b.attachEvent("onclick",a.p):a.b&&a.b.addEventListener&&(navigator&&(0<=navigator.userAgent.indexOf("WebKit")&&a.d.createEvent||0<=navigator.userAgent.indexOf("Firefox/2")&&
k.MouseEvent)&&(a.qa=1,a.useForcedLinkTracking=1,a.b.addEventListener("click",a.p,!0)),a.b.addEventListener("click",a.p,!1))):setTimeout(a.Ea,30)};a.Ea()}
function s_gi(a){var k,q=window.s_c_il,r,n,t=a.split(","),u,s,x=0;if(q)for(r=0;!x&&r<q.length;){k=q[r];if("s_c"==k._c&&(k.account||k.oun))if(k.account&&k.account==a)x=1;else for(n=k.account?k.account:k.oun,n=k.allAccounts?k.allAccounts:n.split(","),u=0;u<t.length;u++)for(s=0;s<n.length;s++)t[u]==n[s]&&(x=1);r++}x||(k=new AppMeasurement);k.setAccount?k.setAccount(a):k.sa&&k.sa(a);return k}AppMeasurement.getInstance=s_gi;window.s_objectID||(window.s_objectID=0);
function s_pgicq(){var a=window,k=a.s_giq,q,r,n;if(k)for(q=0;q<k.length;q++)r=k[q],n=s_gi(r.oun),n.setAccount(r.un),n.setTagContainer(r.tagContainerName);a.s_giq=0}s_pgicq();

/*
 * ************************************************************************
 *
 *  ADOBE CONFIDENTIAL
 *  ___________________
 *
 *   (c) Copyright 2014 Adobe Systems Incorporated
 *   All Rights Reserved.
 *
 *  NOTICE:  All information contained herein is, and remains
 *  the property of Adobe Systems Incorporated and its suppliers,
 *  if any.  The intellectual and technical concepts contained
 *  herein are proprietary to Adobe Systems Incorporated and its
 *  suppliers and may be covered by U.S. and Foreign Patents,
 *  patents in process, and are protected by trade secret or copyright law.
 *  Dissemination of this information or reproduction of this material
 *  is strictly forbidden unless prior written permission is obtained
 *  from Adobe Systems Incorporated.
 * ************************************************************************
 */

/*
 * video heartbeats - v1.4.0 - 2014-09-10
 * Copyright (c) 2014 Adobe Systems, Inc. All Rights Reserved.
 */
(function(global){if(typeof utils==="undefined"){var utils={};}if(typeof va==="undefined"){var va={};}if(typeof core==="undefined"){var core={};}core.radio||(core.radio={});core.plugin||(core.plugin={});if(typeof plugins==="undefined"){var plugins={};}if(typeof heartbeat==="undefined"){var heartbeat={};}heartbeat.event||(heartbeat.event={});heartbeat.model||(heartbeat.model={});heartbeat.context||(heartbeat.context={});heartbeat.network||(heartbeat.network={});heartbeat.clock||(heartbeat.clock={});(function(utils){function safe_add(x,y){var lsw=(x&65535)+(y&65535),msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&65535);}function bit_rol(num,cnt){return(num<<cnt)|(num>>>(32-cnt));}function md5_cmn(q,a,b,x,s,t){return safe_add(bit_rol(safe_add(safe_add(a,q),safe_add(x,t)),s),b);}function md5_ff(a,b,c,d,x,s,t){return md5_cmn((b&c)|((~b)&d),a,b,x,s,t);}function md5_gg(a,b,c,d,x,s,t){return md5_cmn((b&d)|(c&(~d)),a,b,x,s,t);}function md5_hh(a,b,c,d,x,s,t){return md5_cmn(b^c^d,a,b,x,s,t);}function md5_ii(a,b,c,d,x,s,t){return md5_cmn(c^(b|(~d)),a,b,x,s,t);}function binl_md5(x,len){x[len>>5]|=128<<(len%32);x[(((len+64)>>>9)<<4)+14]=len;var i,olda,oldb,oldc,oldd,a=1732584193,b=-271733879,c=-1732584194,d=271733878;for(i=0;i<x.length;i+=16){olda=a;oldb=b;oldc=c;oldd=d;a=md5_ff(a,b,c,d,x[i],7,-680876936);d=md5_ff(d,a,b,c,x[i+1],12,-389564586);c=md5_ff(c,d,a,b,x[i+2],17,606105819);b=md5_ff(b,c,d,a,x[i+3],22,-1044525330);a=md5_ff(a,b,c,d,x[i+4],7,-176418897);d=md5_ff(d,a,b,c,x[i+5],12,1200080426);c=md5_ff(c,d,a,b,x[i+6],17,-1473231341);b=md5_ff(b,c,d,a,x[i+7],22,-45705983);a=md5_ff(a,b,c,d,x[i+8],7,1770035416);d=md5_ff(d,a,b,c,x[i+9],12,-1958414417);c=md5_ff(c,d,a,b,x[i+10],17,-42063);b=md5_ff(b,c,d,a,x[i+11],22,-1990404162);a=md5_ff(a,b,c,d,x[i+12],7,1804603682);d=md5_ff(d,a,b,c,x[i+13],12,-40341101);c=md5_ff(c,d,a,b,x[i+14],17,-1502002290);b=md5_ff(b,c,d,a,x[i+15],22,1236535329);a=md5_gg(a,b,c,d,x[i+1],5,-165796510);d=md5_gg(d,a,b,c,x[i+6],9,-1069501632);c=md5_gg(c,d,a,b,x[i+11],14,643717713);b=md5_gg(b,c,d,a,x[i],20,-373897302);a=md5_gg(a,b,c,d,x[i+5],5,-701558691);d=md5_gg(d,a,b,c,x[i+10],9,38016083);c=md5_gg(c,d,a,b,x[i+15],14,-660478335);b=md5_gg(b,c,d,a,x[i+4],20,-405537848);a=md5_gg(a,b,c,d,x[i+9],5,568446438);d=md5_gg(d,a,b,c,x[i+14],9,-1019803690);c=md5_gg(c,d,a,b,x[i+3],14,-187363961);b=md5_gg(b,c,d,a,x[i+8],20,1163531501);a=md5_gg(a,b,c,d,x[i+13],5,-1444681467);d=md5_gg(d,a,b,c,x[i+2],9,-51403784);c=md5_gg(c,d,a,b,x[i+7],14,1735328473);b=md5_gg(b,c,d,a,x[i+12],20,-1926607734);a=md5_hh(a,b,c,d,x[i+5],4,-378558);d=md5_hh(d,a,b,c,x[i+8],11,-2022574463);c=md5_hh(c,d,a,b,x[i+11],16,1839030562);b=md5_hh(b,c,d,a,x[i+14],23,-35309556);a=md5_hh(a,b,c,d,x[i+1],4,-1530992060);d=md5_hh(d,a,b,c,x[i+4],11,1272893353);c=md5_hh(c,d,a,b,x[i+7],16,-155497632);b=md5_hh(b,c,d,a,x[i+10],23,-1094730640);a=md5_hh(a,b,c,d,x[i+13],4,681279174);d=md5_hh(d,a,b,c,x[i],11,-358537222);c=md5_hh(c,d,a,b,x[i+3],16,-722521979);b=md5_hh(b,c,d,a,x[i+6],23,76029189);a=md5_hh(a,b,c,d,x[i+9],4,-640364487);d=md5_hh(d,a,b,c,x[i+12],11,-421815835);c=md5_hh(c,d,a,b,x[i+15],16,530742520);b=md5_hh(b,c,d,a,x[i+2],23,-995338651);a=md5_ii(a,b,c,d,x[i],6,-198630844);d=md5_ii(d,a,b,c,x[i+7],10,1126891415);c=md5_ii(c,d,a,b,x[i+14],15,-1416354905);b=md5_ii(b,c,d,a,x[i+5],21,-57434055);a=md5_ii(a,b,c,d,x[i+12],6,1700485571);d=md5_ii(d,a,b,c,x[i+3],10,-1894986606);c=md5_ii(c,d,a,b,x[i+10],15,-1051523);b=md5_ii(b,c,d,a,x[i+1],21,-2054922799);a=md5_ii(a,b,c,d,x[i+8],6,1873313359);d=md5_ii(d,a,b,c,x[i+15],10,-30611744);c=md5_ii(c,d,a,b,x[i+6],15,-1560198380);b=md5_ii(b,c,d,a,x[i+13],21,1309151649);a=md5_ii(a,b,c,d,x[i+4],6,-145523070);d=md5_ii(d,a,b,c,x[i+11],10,-1120210379);c=md5_ii(c,d,a,b,x[i+2],15,718787259);b=md5_ii(b,c,d,a,x[i+9],21,-343485551);a=safe_add(a,olda);b=safe_add(b,oldb);c=safe_add(c,oldc);d=safe_add(d,oldd);}return[a,b,c,d];}function binl2rstr(input){var i,output="";for(i=0;i<input.length*32;i+=8){output+=String.fromCharCode((input[i>>5]>>>(i%32))&255);}return output;}function rstr2binl(input){var i,output=[];output[(input.length>>2)-1]=undefined;for(i=0;i<output.length;i+=1){output[i]=0;}for(i=0;i<input.length*8;i+=8){output[i>>5]|=(input.charCodeAt(i/8)&255)<<(i%32);}return output;}function rstr_md5(s){return binl2rstr(binl_md5(rstr2binl(s),s.length*8));}function rstr_hmac_md5(key,data){var i,bkey=rstr2binl(key),ipad=[],opad=[],hash;ipad[15]=opad[15]=undefined;if(bkey.length>16){bkey=binl_md5(bkey,key.length*8);}for(i=0;i<16;i+=1){ipad[i]=bkey[i]^909522486;opad[i]=bkey[i]^1549556828;}hash=binl_md5(ipad.concat(rstr2binl(data)),512+data.length*8);return binl2rstr(binl_md5(opad.concat(hash),512+128));}function rstr2hex(input){var hex_tab="0123456789abcdef",output="",x,i;for(i=0;i<input.length;i+=1){x=input.charCodeAt(i);output+=hex_tab.charAt((x>>>4)&15)+hex_tab.charAt(x&15);}return output;}function str2rstr_utf8(input){return unescape(encodeURIComponent(input));}function raw_md5(s){return rstr_md5(str2rstr_utf8(s));}function hex_md5(s){return rstr2hex(raw_md5(s));}function raw_hmac_md5(k,d){return rstr_hmac_md5(str2rstr_utf8(k),str2rstr_utf8(d));}function hex_hmac_md5(k,d){return rstr2hex(raw_hmac_md5(k,d));}function md5(string,key,raw){if(!key){if(!raw){return hex_md5(string);}return raw_md5(string);}if(!raw){return hex_hmac_md5(key,string);}return raw_hmac_md5(key,string);}utils.md5=md5;}(utils));(function(va){var PLATFORM="js";var MAJOR="1";var MINOR="4";var MICRO="0";var PATCH="0";var BUILD="0707bfa";var API_LEVEL=2;var Version={};Version.getVersion=function(){return PLATFORM+"-"+MAJOR+"."+MINOR+"."+MICRO+"."+PATCH+"-"+BUILD;};Version.getMajor=function(){return MAJOR;};Version.getMinor=function(){return MINOR;};Version.getMicro=function(){return MICRO;};Version.getPatch=function(){return PATCH;};Version.getBuild=function(){return BUILD;};Version.getApiLevel=function(){return API_LEVEL;};va.Version=Version;})(va);(function(core){function extend(child,parent){for(var key in parent){if(parent.hasOwnProperty(key)){child[key]=parent[key];}}function Constructor(){this.constructor=child;}Constructor.prototype=parent.prototype;child.prototype=new Constructor();child.__super__=parent.prototype;return child;}core.extend=extend;})(core);(function(core){function mixin(to,from){var fnNames=[];for(var key in from){if(from.hasOwnProperty(key)&&(typeof from[key]==="function")){fnNames.push(key);}}for(var i=0;i<fnNames.length;i++){var fnName=fnNames[i];to.prototype[fnName]=from[fnName];}}core.mixin=mixin;})(core);(function(core){core.LOGGING_ENABLED=false;core.logger={enableLogging:function(label){this._logEnabled=true;this._logTag=label;},disableLogging:function(){this._logEnabled=false;},log:function(msg){if(!core.LOGGING_ENABLED||!this._logEnabled){return;}if(window["console"]&&window["console"]["log"]){window["console"]["log"](this._logTag+msg);}},info:function(msg){if(!core.LOGGING_ENABLED||!this._logEnabled){return;}if(window["console"]&&window["console"]["info"]){window["console"]["info"](this._logTag+msg);}},warn:function(msg){if(!core.LOGGING_ENABLED||!this._logEnabled){return;}if(window["console"]&&window["console"]["warn"]){window["console"]["warn"](this._logTag+msg);}},error:function(msg){if(window["console"]&&window["console"]["error"]){msg=this._logTag+msg;window["console"]["error"](msg);throw new Error(msg);}}};})(core);(function(core,va){function InputDataSanitizer(onFail,ctx){this._onFail={fn:onFail,ctx:ctx};}InputDataSanitizer.prototype.sanitizeVideoInfo=function(videoInfo){if(!videoInfo){return this._fail("VideoInfo cannot be null");}var errorString=getVideoInfoErrorString(videoInfo);if(errorString){return this._fail(errorString);}return true;};InputDataSanitizer.prototype.sanitizeAdBreakInfo=function(adBreakInfo,allowNull){if(!allowNull&&!adBreakInfo){return this._fail("AdBreakInfo cannot be null");}var errorString=getAdBreakInfoErrorString(adBreakInfo);if(errorString){return this._fail(errorString);}return true;};InputDataSanitizer.prototype.sanitizeAdInfo=function(adInfo,allowNull){if(!allowNull&&!adInfo){return this._fail("AdInfo cannot be null");}var errorString=getAdInfoErrorString(adInfo);if(errorString){return this._fail(errorString);}return true;};InputDataSanitizer.prototype.sanitizeChapterInfo=function(chapterInfo,allowNull){if(!allowNull&&!chapterInfo){return this._fail("ChapterInfo cannot be null");}var errorString=getChapterInfoErrorString(chapterInfo);if(errorString){return this._fail(errorString);}return true;};InputDataSanitizer.prototype._fail=function(errorString){var errorInfo=new va.ErrorInfo("Invalid input data",errorString);if(this._onFail.fn){this._onFail.fn.call(this._onFail.ctx,errorInfo);}return false;};function getVideoInfoErrorString(videoInfo){if(videoInfo){if(videoInfo.id==null||videoInfo.id===""){return"Video ID cannot be null or empty string";}if(videoInfo.streamType!=va.ASSET_TYPE_VOD&&videoInfo.streamType!=va.ASSET_TYPE_LIVE&&videoInfo.streamType!=va.ASSET_TYPE_LINEAR){return"Stream type must be one of "+va.ASSET_TYPE_VOD+", "+va.ASSET_TYPE_LIVE+", "+va.ASSET_TYPE_LINEAR;}if(videoInfo.length==null||isNaN(videoInfo.length)){return"Video length cannot be null or NaN";}if(videoInfo.playhead==null||isNaN(videoInfo.playhead)){return"Video playhead cannot be null or NaN";}if(videoInfo.playerName==null||videoInfo.playerName===""){return"Video player-name cannot be null or empty string.";}}return null;}function getAdBreakInfoErrorString(adBreakInfo){if(adBreakInfo){if(adBreakInfo.playerName==null||adBreakInfo.playerName===""){return"Ad-break player-name cannot be null or empty string";}if(adBreakInfo.position==null||isNaN(adBreakInfo.position)){return"Ad-break position cannot be null or NaN";}}return null;}function getAdInfoErrorString(adInfo){if(adInfo){if(adInfo.id==null||adInfo.id===""){return"Ad ID cannot be null or empty string";}if(adInfo.position==null||isNaN(adInfo.position)){return"Ad position cannot be null or NaN";}if(adInfo.length==null||isNaN(adInfo.length)){return"Ad length cannot be null or NaN";}}return null;}function getChapterInfoErrorString(chapterInfo){if(chapterInfo){if(chapterInfo.position==null||isNaN(chapterInfo.position)){return"Chapter position cannot be null or NaN";}if(chapterInfo.startTime==null||isNaN(chapterInfo.startTime)){return"Chapter offset (start-time) cannot be null or NaN";}if(chapterInfo.length==null||isNaN(chapterInfo.length)){return"Chapter length cannot be null or NaN";}}return null;}core.InputDataSanitizer=InputDataSanitizer;})(core,va);(function(core){function Event(type,data){this.type=type;this.data=data;}Event.SUCCESS="success";Event.ERROR="error";core.radio.Event=Event;})(core);(function(core){function Command(fn,ctx,params){this.fn=fn;this.ctx=ctx;this.params=params;}Command.prototype.run=function(){this.fn.apply(this.ctx,this.params);};core.radio.Command=Command;})(core);(function(core){function CommandQueue(suspended,delay){this._queue=[];this._drainInProgress=false;this._isSuspended=(typeof suspended!=="undefined")?suspended:false;this._delay=(typeof delay!=="undefined")?delay:0;}CommandQueue.prototype.addCommand=function(command){this._queue.push(command);this._drain();};CommandQueue.prototype.cancelAllCommands=function(){this._queue=[];};CommandQueue.prototype.isEmpty=function(){return(this._queue.length===0);};CommandQueue.prototype.suspend=function(){this._isSuspended=true;};CommandQueue.prototype.resume=function(){this._isSuspended=false;this._drain();};CommandQueue.prototype.flush=function(){this._isSuspended=false;for(var i=0;i<this._queue.length;i++){this._queue[i].run();}this._queue=[];};CommandQueue.prototype._drain=function(){if(this._isSuspended||this._drainInProgress){return;}this._drainInProgress=true;var self=this;(function _drain(){var command=self._queue.shift();if(command){self._runCommand(command,function(){if(self._isSuspended){return;}_drain();});}else{self._drainInProgress=false;}})();};CommandQueue.prototype._runCommand=function(command,done){var self=this;window.setTimeout(function(){command.run();if(done!=null){done.call(self);}},this._delay);};core.radio.CommandQueue=CommandQueue;})(core);(function(core){var mixin=core.mixin;var logger=core.logger;mixin(Channel,logger);Channel.WILDCARD="*";Channel.SEPARATOR=":";function Channel(name){this._name=name;this._listeners={};this._requests={};this._commands={};this.enableLogging("[radio::Channel] > ");}Channel.prototype.toString=function(){return"<channel: "+this._name+">";};Channel.prototype.shutdown=function(){this.log("#shutdown > Shutting down");this.off();this._requests={};this._commands={};};Channel.prototype.on=function(eventType,listener,ctx){if(!this._listeners[eventType]){this._listeners[eventType]=[];}this._listeners[eventType].push({fn:listener,ctx:ctx});};Channel.prototype.off=function(eventType,listener,ctx){listener=(typeof listener==="function")?listener:null;if(!eventType&&listener===null&&!ctx){this._listeners={};return;}if(!eventType){for(eventType in this._listeners){if(this._listeners.hasOwnProperty(eventType)){this._removeListener(eventType,listener,ctx);}}}else{this._removeListener(eventType,listener,ctx);}};Channel.prototype.trigger=function(event){for(var eventType in this._listeners){if(this._listeners.hasOwnProperty(eventType)){if(this._matchWildcard(eventType,event.type)){var cbs=this._listeners[eventType];var copyOnWrite=cbs.slice(0);var length=copyOnWrite.length;for(var i=0;i<length;i++){var cb=copyOnWrite[i];cb.fn.call(cb.ctx,event);}}}}};Channel.prototype.comply=function(name,cmd,ctx){this._commands[name]={cmd:cmd,ctx:ctx};};Channel.prototype.command=function(name){var func=this._commands[name];if(!func){this.warn("#command > No command handler for: "+name);return;}var args=Array.prototype.slice.call(arguments,1);func.cmd.apply(func.ctx,args);};Channel.prototype.reply=function(what,response,ctx){this._requests[what]={response:response,ctx:ctx};};Channel.prototype.request=function(what){var reply=this._requests[what];if(!reply){this.warn("#request > No request handler for: "+what);return null;}return reply.response.call(reply.ctx);};Channel.prototype._removeListener=function(eventType,fn,ctx){fn=(typeof fn==="function")?fn:null;var cbs=this._listeners[eventType];if(!cbs){return;}if((!cbs.length)||(fn==null&&!ctx)){delete this._listeners[eventType];return;}for(var i=0;i<cbs.length;i++){var cb=cbs[i];if((fn===null||fn===cb.fn)&&(!ctx||ctx===cb.ctx)){this._listeners[eventType].splice(i,1);}}};Channel.prototype._matchWildcard=function(wildcard,test){if(wildcard===test){return true;}var parts=(wildcard||"").split(Channel.SEPARATOR),testParts=(test||"").split(Channel.SEPARATOR),match=true;for(var i=0;i<parts.length;i++){match=match&&(parts[i]===Channel.WILDCARD||parts[i]===testParts[i]);}return match;};core.radio.Channel=Channel;})(core);(function(core){var Channel=core.radio.Channel;function Radio(){this._channels={};}Radio.prototype.channel=function(name){if(!this._channels[name]){this._channels[name]=new Channel(name);}return this._channels[name];};Radio.prototype.shutdown=function(){for(var name in this._channels){if(this._channels.hasOwnProperty(name)){this._channels[name].shutdown();}}};core.radio.Radio=Radio;})(core);(function(core){function EventDispatcher(){this._events={};}EventDispatcher.prototype.addEventListener=function(type,listener,context){if(!type||!listener){return;}context=context||window;this._events[type]=(this._events[type]||[]);this._events[type].push({cb:listener,ctx:context});};EventDispatcher.prototype.removeEventListener=function(type,listener,context){if(!type||!listener){return;}context=context||window;var i,key,isTypeRegistered=false;for(key in this._events){if(type===key){isTypeRegistered=true;break;}}if(!isTypeRegistered){return;}for(i=this._events[key].length-1;i>=0;i--){var _listener=this._events[key][i];if(listener===_listener.cb&&context===_listener.ctx){this._events[key].splice(i,1);}}if(!this._events[key].length){delete this._events[key];}};EventDispatcher.prototype.dispatchEvent=function(event){if(!event.type){return;}var key,i;for(key in this._events){if(this._events.hasOwnProperty(key)&&(event.type===key)){var listeners=this._events[key],copyOnWrite=listeners.slice(0),length=copyOnWrite.length;for(i=0;i<length;i++){copyOnWrite[i].cb.call(copyOnWrite[i].ctx,event);}break;}}};EventDispatcher.prototype.removeAllListeners=function(target){if(!target){this._events={};}else{var i,key;for(key in this._events){if(this._events.hasOwnProperty(key)){for(i=this._events[key].length-1;i>=0;i--){var _listener=this._events[key][i];if(_listener.ctx===target){this._events[key].splice(i,1);}}if(!this._events[key].length){delete this._events[key];}}}}};core.EventDispatcher=EventDispatcher;})(core);(function(core){var Event=core.radio.Event;var EventDispatcher=core.EventDispatcher;URLRequestMethod.GET="GET";function URLRequestMethod(){}function URLRequest(url,method){this.url=url||null;this.method=method;this._xmlhttp=null;}URLLoader.RESPONSE="response";URLLoader.INSTANCE="instance";core.extend(URLLoader,EventDispatcher);function URLLoader(){URLLoader.__super__.constructor.call(this);this._connection=null;}URLLoader.prototype._createCORSRequest=function(req){var xhr=null;if(typeof window["XMLHttpRequest"]!=="undefined"){var candidateXHR=new window["XMLHttpRequest"]();if("withCredentials" in candidateXHR){xhr=candidateXHR;xhr.open(req.method,req.url,true);}}if(xhr==null){if(typeof window["XDomainRequest"]!=="undefined"){xhr=new window["XDomainRequest"]();xhr.open(req.method,req.url);}}if(xhr){var eventData={};eventData[URLLoader.INSTANCE]=this;var self=this;xhr.onload=function(){if(xhr.status&&parseInt(xhr.status,10)>=400){return this.onerror();}eventData[URLLoader.RESPONSE]=xhr.responseText;self.dispatchEvent(new Event(Event.SUCCESS,eventData));};xhr.onerror=function(){self.dispatchEvent(new Event(Event.ERROR,eventData));};}return xhr;};URLLoader.prototype._loadImage=function(req){if(!this._connection){this._connection=new Image();this._connection.alt="";}this._connection.src=req.url;var eventData={};eventData[URLLoader.RESPONSE]="";eventData[URLLoader.INSTANCE]=this;this.dispatchEvent(new Event(Event.SUCCESS,eventData));};URLLoader.prototype.close=function(){this.removeAllListeners();};URLLoader.prototype.load=function(req){if(!req||!req.method||!req.url){return;}req._xmlhttp=this._createCORSRequest(req);if(req._xmlhttp){req._xmlhttp.send();}else{this._loadImage(req);}};core.URLRequestMethod=URLRequestMethod;core.URLRequest=URLRequest;core.URLLoader=URLLoader;})(core);(function(va){function AdBreakInfo(){this.playerName=null;this.name=null;this.position=null;this.startTime=null;}va.AdBreakInfo=AdBreakInfo;})(va);(function(va){function AdInfo(){this.id=null;this.name=null;this.length=null;this.position=null;this.cpm=null;}va.AdInfo=AdInfo;})(va);(function(va){va.ASSET_TYPE_VOD="vod";va.ASSET_TYPE_LIVE="live";va.ASSET_TYPE_LINEAR="linear";})(va);(function(va){function ChapterInfo(){this.name=null;this.length=null;this.position=null;this.startTime=null;}va.ChapterInfo=ChapterInfo;})(va);(function(va){var DEFAULT_UNKNOWN="unknown";var DEFAULT_EMPTY_STRING="";function ConfigData(trackingServer,jobId,publisher){this.trackingServer=trackingServer;this.jobId=jobId;this.publisher=publisher;this.channel=DEFAULT_EMPTY_STRING;this.ovp=DEFAULT_UNKNOWN;this.sdk=DEFAULT_UNKNOWN;this.debugLogging=false;this.quietMode=false;this.__primetime=false;this.__psdkVersion=null;}va.ConfigData=ConfigData;})(va);(function(va){function ErrorInfo(message,details){this.message=message;this.details=details;}va.ErrorInfo=ErrorInfo;})(va);(function(va){function PlayerDelegate(){}PlayerDelegate.prototype.getVideoInfo=function(){throw new Error("Implementation error: Method must be overridden.");};PlayerDelegate.prototype.getAdBreakInfo=function(){return null;};PlayerDelegate.prototype.getAdInfo=function(){return null;};PlayerDelegate.prototype.getChapterInfo=function(){return null;};PlayerDelegate.prototype.getQoSInfo=function(){return null;};PlayerDelegate.prototype.onError=function(errorInfo){};PlayerDelegate.prototype.onVideoUnloaded=function(){};va.PlayerDelegate=PlayerDelegate;})(va);(function(va){function QoSInfo(){this.bitrate=null;this.fps=null;this.droppedFrames=null;}va.QoSInfo=QoSInfo;})(va);(function(va){function VideoInfo(){this.playerName=null;this.id=null;this.name=null;this.length=null;this.playhead=null;this.streamType=null;}va.VideoInfo=VideoInfo;})(va);(function(core){function IPlugin(){}IPlugin.prototype.bootstrap=function(pluginManager){throw new Error("Implementation error: Method must be overridden.");};IPlugin.prototype.setup=function(){throw new Error("Implementation error: Method must be overridden.");};IPlugin.prototype.destroy=function(){throw new Error("Implementation error: Method must be overridden.");};IPlugin.prototype.enable=function(){throw new Error("Implementation error: Method must be overridden.");};IPlugin.prototype.disable=function(){throw new Error("Implementation error: Method must be overridden.");};IPlugin.prototype.getName=function(){throw new Error("Implementation error: Method must be overridden.");};IPlugin.prototype.isInitialized=function(){throw new Error("Implementation error: Method must be overridden.");};IPlugin.prototype.getProperty=function(key){throw new Error("Implementation error: Method must be overridden.");};core.plugin.IPlugin=IPlugin;})(core);(function(core,va){var mixin=core.mixin;var logger=core.logger;var ErrorInfo=va.ErrorInfo;var Event=core.radio.Event;var Radio=core.radio.Radio;var Channel=core.radio.Channel;mixin(PluginManager,logger);PluginManager.ALL_PLUGINS=Channel.WILDCARD;PluginManager.ERROR="error";PluginManager.CHANNEL_GLOBAL="plugin_manager:global";function PluginManager(){this._plugins={};this._radio=new Radio();this._channel=this._radio.channel(PluginManager.CHANNEL_GLOBAL);this.enableLogging("[plugin::PluginManager] > ");}PluginManager.prototype.addPlugin=function(plugin){var pluginName=plugin.getName();if(this._plugins[pluginName]){this.warn("#addPlugin > Replacing plugin: "+pluginName);}this._plugins[pluginName]=plugin;plugin.bootstrap(this);};PluginManager.prototype.setupPlugins=function(){for(var pluginName in this._plugins){if(this._plugins.hasOwnProperty(pluginName)){this._plugins[pluginName].setup();}}};PluginManager.prototype.removePlugin=function(plugin){var pluginName=plugin.getName();if(!this._plugins[pluginName]){this.warn("#removePlugin > Unregistered plugin: "+pluginName);}delete this._plugins[pluginName];};PluginManager.prototype.pluginExists=function(pluginName){return(!!this._plugins[pluginName]);};PluginManager.prototype.isPluginInitialized=function(pluginName){return(this._plugins[pluginName]&&this._plugins[pluginName].isInitialized());};PluginManager.prototype.on=function(pluginName,eventType,fn,ctx){this._channel.on(pluginName+Channel.SEPARATOR+eventType,fn,ctx);};PluginManager.prototype.off=function(pluginName,eventType,fn,ctx){this._channel.off(pluginName+Channel.SEPARATOR+eventType,fn,ctx);};PluginManager.prototype.trigger=function(plugin,event){var eventMeta=event.type.split(Channel.SEPARATOR),eventNamespace=eventMeta[0];var pluginName=plugin.getName();if(pluginName!=eventNamespace){var errMsg="Invalid event namespace. (event: "+event.type+", plugin: "+pluginName+")";this._channel.trigger(new Event(PluginManager.ERROR,new ErrorInfo("Internal error",errMsg)));return;}this._channel.trigger(event);};PluginManager.prototype.request=function(pluginName,what){var targetPlugin=this._plugins[pluginName];if(!targetPlugin){return null;}return targetPlugin.getProperty(what);};PluginManager.prototype.destroy=function(){this._radio.shutdown();for(var pluginName in this._plugins){if(this._plugins.hasOwnProperty(pluginName)){this._plugins[pluginName].destroy();}}};core.plugin.PluginManager=PluginManager;})(core,va);(function(core,va){var ErrorInfo=va.ErrorInfo;var Event=core.radio.Event;var PluginManager=core.plugin.PluginManager;core.mixin(BasePlugin,core.logger);BasePlugin.INITIALIZED="initialized";BasePlugin.STATE_PLUGIN="state";BasePlugin.ERROR_INFO="error_info";function BasePlugin(name){this._name=name;this._isInitialized=false;this._isDestroyed=false;this._isEnabled=true;this._dataResolver={};this.enableLogging("[plugin::"+this.getName()+"] > ");}BasePlugin.prototype.bootstrap=function(pluginManager){this._pluginManager=pluginManager;if(this._isDestroyed){this._trigger(PluginManager.ERROR,new ErrorInfo("Invalid state.","Plugin already destroyed."));}};BasePlugin.prototype.setup=function(){this._trigger(BasePlugin.INITIALIZED);this._isInitialized=true;};BasePlugin.prototype.destroy=function(){if(this._isDestroyed){return;}this._isDestroyed=true;this._teardown();};BasePlugin.prototype.enable=function(){this._isEnabled=true;this._enabled();};BasePlugin.prototype.disable=function(){this._isEnabled=false;this._disabled();};BasePlugin.prototype.getName=function(){return this._name;};BasePlugin.prototype.isInitialized=function(){return this._isInitialized;};BasePlugin.prototype.getProperty=function(key){if(typeof this._dataResolver==="function"){return this._dataResolver.call(this,key);}if(this._dataResolver.hasOwnProperty(key)){var resolver=this._dataResolver[key];if(typeof resolver==="function"){return resolver.call(this);}else{return resolver;}}};BasePlugin.prototype.toString=function(){return"<plugin: "+this._name+">";};BasePlugin.prototype._enabled=function(){};BasePlugin.prototype._disabled=function(){};BasePlugin.prototype._teardown=function(){};BasePlugin.prototype._canProcess=function(){var errorInfo=this._pluginManager.request(BasePlugin.STATE_PLUGIN,BasePlugin.ERROR_INFO);if(errorInfo){this.warn("#_canProcess() > Unable to track: in ERROR state.");return false;}if(!this._isEnabled){this.warn("Plugin disabled.");return false;}if(this._isDestroyed){this.warn("Plugin destroyed.");return false;}return true;};BasePlugin.prototype._trigger=function(eventType,info){this._pluginManager.trigger(this,new Event(this.getName()+":"+eventType,info));};BasePlugin.prototype._onInvalidInputData=function(errorInfo){this._trigger(PluginManager.ERROR,errorInfo);};core.plugin.BasePlugin=BasePlugin;})(core,va);(function(core,heartbeat){function EventKeyName(){}EventKeyName.REPORT="report";EventKeyName.RESET="reset";EventKeyName.TRACKING_SERVER="tracking_server";EventKeyName.CHECK_STATUS_SERVER="check_status_server";EventKeyName.JOB_ID="job_id";EventKeyName.QUIET_MODE="quiet_mode";EventKeyName.VIDEO_INFO="video_info";EventKeyName.AD_INFO="ad_info";EventKeyName.AD_BREAK_INFO="ad_break_info";EventKeyName.CHAPTER_INFO="chapter_info";EventKeyName.TIMER_INTERVAL="timer_interval";EventKeyName.TRACKING_INTERVAL="tracking_interval";EventKeyName.CHECK_STATUS_INTERVAL="check_status_interval";EventKeyName.TRACK_EXTERNAL_ERRORS="track_external_errors";EventKeyName.SOURCE="source";EventKeyName.ERROR_ID="error_id";heartbeat.event.EventKeyName=EventKeyName;})(core,heartbeat);(function(core,heartbeat){var Event=core.radio.Event;core.extend(ApiEvent,Event);function ApiEvent(type,data){ApiEvent.__super__.constructor.call(this,type,data);}ApiEvent.API_CONFIG="api_config";ApiEvent.API_VIDEO_LOAD="api_video_load";ApiEvent.API_VIDEO_UNLOAD="api_video_unload";ApiEvent.API_VIDEO_START="api_video_start";ApiEvent.API_VIDEO_COMPLETE="api_video_complete";ApiEvent.API_AD_START="api_ad_start";ApiEvent.API_AD_COMPLETE="api_ad_complete";ApiEvent.API_PLAY="api_play";ApiEvent.API_PAUSE="api_pause";ApiEvent.API_BUFFER_START="api_buffer_start";ApiEvent.API_SEEK_START="api_seek_start";ApiEvent.API_SEEK_COMPLETE="api_seek_complete";ApiEvent.API_CHAPTER_START="api_chapter_start";ApiEvent.API_CHAPTER_COMPLETE="api_chapter_complete";ApiEvent.API_TRACK_ERROR="api_track_error";ApiEvent.API_TRACK_INTERNAL_ERROR="api_track_internal_error";ApiEvent.API_BITRATE_CHANGE="api_bitrate_change";heartbeat.event.ApiEvent=ApiEvent;})(core,heartbeat);(function(core,heartbeat){var Event=core.radio.Event;core.extend(ContextEvent,Event);function ContextEvent(type,data){ContextEvent.__super__.constructor.call(this,type,data);}ContextEvent.CONTEXT_DATA_AVAILABLE="context_data_available";heartbeat.event.ContextEvent=ContextEvent;})(core,heartbeat);(function(core,heartbeat){var Event=core.radio.Event;core.extend(NetworkEvent,Event);function NetworkEvent(type,data){NetworkEvent.__super__.constructor.call(this,type,data);}NetworkEvent.NETWORK_CHECK_STATUS_COMPLETE="network_check_status_complete";heartbeat.event.NetworkEvent=NetworkEvent;})(core,heartbeat);(function(core,heartbeat){var Event=core.radio.Event;core.extend(ClockEvent,Event);function ClockEvent(type,data){ClockEvent.__super__.constructor.call(this,type,data);}ClockEvent.CLOCK_TRACKING_TICK="CLOCK_TRACKING_TICK";ClockEvent.CLOCK_CHECK_STATUS_GET_SETTINGS="CLOCK_CHECK_STATUS_GET_SETTINGS";ClockEvent.CLOCK_TRACKING_ENABLE="CLOCK_TRACKING_ENABLE";ClockEvent.CLOCK_TRACKING_DISABLE="CLOCK_TRACKING_DISABLE";ClockEvent.CLOCK_CHECK_STATUS_TICK="CLOCK_CHECK_STATUS_TICK";ClockEvent.CLOCK_CHECK_STATUS_ENABLE="CLOCK_CHECK_STATUS_ENABLE";ClockEvent.CLOCK_CHECK_STATUS_DISABLE="CLOCK_CHECK_STATUS_DISABLE";heartbeat.event.ClockEvent=ClockEvent;})(core,heartbeat);(function(core,heartbeat){function DaoField(value,hint){this.value=value;this.hint=hint;}DaoField.HINT_SHORT="short";function Dao(realm){this.realm=realm;this.data={};}Dao.prototype._createAccessor=function(ivar,field,hint){var self=this;return function(){if(arguments.length){self[ivar]=arguments[0];self.setField(field,arguments[0],hint);}return self[ivar];};};Dao.prototype.setField=function(field,value,hint){this.data[field]=new DaoField(value,hint);};heartbeat.model.Dao=Dao;heartbeat.model.DaoField=DaoField;})(core,heartbeat);(function(core,heartbeat){var Dao=heartbeat.model.Dao;var DaoField=heartbeat.model.DaoField;core.extend(DateDao,Dao);function DateDao(realm,date){DateDao.__super__.constructor.call(this,realm);this.year=this._createAccessor("_year","year",DaoField.HINT_SHORT);this.month=this._createAccessor("_month","month",DaoField.HINT_SHORT);this.day=this._createAccessor("_day","day",DaoField.HINT_SHORT);this.hour=this._createAccessor("_hour","hour",DaoField.HINT_SHORT);this.minute=this._createAccessor("_minute","minute",DaoField.HINT_SHORT);this.second=this._createAccessor("_second","second",DaoField.HINT_SHORT);this.year(date.getUTCFullYear());this.month(date.getUTCMonth()+1);this.day(date.getUTCDate());this.hour(date.getUTCHours());this.minute(date.getUTCMinutes());this.second(date.getUTCSeconds());}heartbeat.model.DateDao=DateDao;})(core,heartbeat);(function(core,heartbeat){var Dao=heartbeat.model.Dao;core.extend(AdDao,Dao);function AdDao(){AdDao.__super__.constructor.call(this,"asset");this.adId=this._createAccessor("_adId","ad_id",null);this.sid=this._createAccessor("_sid","ad_sid",null);this.resolver=this._createAccessor("_resolver","resolver",null);this.podId=this._createAccessor("_podId","pod_id",null);this.podPosition=this._createAccessor("_podPosition","pod_position",null);this.podSecond=this._createAccessor("_podSecond","pod_second",null);this.length=this._createAccessor("_length","length",null);this.adId("");this.sid("");this.resolver("");this.podId("");this.podPosition("");this.podSecond(0);this.length(0);if(arguments.length&&arguments[0] instanceof AdDao){var other=arguments[0];this.adId(other.adId());this.sid(other.sid());this.resolver(other.resolver());this.podId(other.podId());this.podPosition(other.podPosition());this.podSecond(other.podSecond());this.length(other.length());}}heartbeat.model.AdDao=AdDao;})(core,heartbeat);(function(core,heartbeat){var Dao=heartbeat.model.Dao;core.extend(ChapterDao,Dao);function ChapterDao(){ChapterDao.__super__.constructor.call(this,"stream");this.id=this._createAccessor("_id","chapter_id",null);this.sid=this._createAccessor("_sid","chapter_sid",null);this.name=this._createAccessor("_name","chapter_name",null);this.position=this._createAccessor("_position","chapter_pos",null);this.length=this._createAccessor("_length","chapter_length",null);this.offset=this._createAccessor("_offset","chapter_offset",null);this.id("");this.sid("");this.name("");this.position(0);this.length(0);this.offset(0);if(arguments.length&&arguments[0] instanceof ChapterDao){var other=arguments[0];this.id(other.id());this.sid(other.sid());this.name(other.name());this.position(other.position());this.length(other.length());this.offset(other.offset());}}heartbeat.model.ChapterDao=ChapterDao;})(core,heartbeat);(function(core,heartbeat){var Dao=heartbeat.model.Dao;var AdDao=heartbeat.model.AdDao;var ChapterDao=heartbeat.model.ChapterDao;core.extend(AssetDao,Dao);function AssetDao(){AssetDao.__super__.constructor.call(this,"asset");this.type=this._createAccessor("_type","type",null);this.videoId=this._createAccessor("_videoId","video_id",null);this.publisher=this._createAccessor("_publisher","publisher",null);this.adData=this._createAccessor("_adData","ad_data",null);this.chapterData=this._createAccessor("_chapterData","chapter_data",null);this.duration=this._createAccessor("_duration","duration",null);this.type("");this.videoId("");this.publisher("");this.adData(null);this.chapterData(null);this.duration(0);if(arguments.length&&arguments[0] instanceof AssetDao){var other=arguments[0];this.type(other.type());this.videoId(other.videoId());this.publisher(other.publisher());this.duration(other.duration());var otherAdData=other.adData();if(otherAdData){this.adData(new AdDao(otherAdData));}var otherChapterData=other.chapterData();if(otherChapterData){this.chapterData(new ChapterDao(otherChapterData));}}}AssetDao.TYPE_VOD="vod";AssetDao.TYPE_LIVE="live";AssetDao.TYPE_LINEAR="linear";AssetDao.TYPE_AD="ad";heartbeat.model.AssetDao=AssetDao;})(core,heartbeat);(function(core,heartbeat){var Dao=heartbeat.model.Dao;var DateDao=heartbeat.model.DateDao;core.extend(EventDao,Dao);function EventDao(trackingInterval){EventDao.__super__.constructor.call(this,"event");this._trackingInterval=trackingInterval;this.type=this._createAccessor("_type","type",null);this.count=this._createAccessor("_count","count",null);this.totalCount=this._createAccessor("_totalCount","total_count",null);this.duration=this._createAccessor("_duration","duration",null);this.totalDuration=this._createAccessor("_totalDuration","total_duration",null);this.playhead=this._createAccessor("_playhead","playhead",null);this.id=this._createAccessor("_id","id",null);this.source=this._createAccessor("_source","source",null);this.prevTs=this._createAccessor("_prevTs","prev_ts",null);this.type("");this.count(0);this.totalCount(0);this.duration(0);this.totalDuration(0);this.playhead(0);this.id("");this.source("");this.ts(new Date().getTime());this._updateTsAsDate();this.prevTs(-1);}EventDao.prototype._updateTsAsDate=function(){var trackingIntervalMs=this._trackingInterval*1000;var truncatedMs=Math.floor(this._ts/trackingIntervalMs)*trackingIntervalMs;this.tsAsDate(new Date(truncatedMs));};EventDao.prototype.ts=function(){if(arguments.length){this._ts=arguments[0];this.setField("ts",this._ts,null);this._updateTsAsDate();}return this._ts;};EventDao.prototype.tsAsDate=function(){if(arguments.length){this._tsAsDate=arguments[0];var dateDao=new DateDao(this.realm,this._tsAsDate);this.setField("ts_as_date",dateDao,null);}return this._tsAsDate;};EventDao.EVENT_TYPE_LOAD="load";EventDao.EVENT_TYPE_UNLOAD="unload";EventDao.EVENT_TYPE_START="start";EventDao.EVENT_TYPE_CHAPTER_START="chapter_start";EventDao.EVENT_TYPE_CHAPTER_COMPLETE="chapter_complete";EventDao.EVENT_TYPE_PLAY="play";EventDao.EVENT_TYPE_PAUSE="pause";EventDao.EVENT_TYPE_BUFFER="buffer";EventDao.EVENT_TYPE_BITRATE_CHANGE="bitrate_change";EventDao.EVENT_TYPE_ERROR="error";EventDao.EVENT_TYPE_ACTIVE="active";EventDao.EVENT_TYPE_COMPLETE="complete";heartbeat.model.EventDao=EventDao;})(core,heartbeat);(function(core,heartbeat){var Dao=heartbeat.model.Dao;core.extend(QoSDao,Dao);function QoSDao(){QoSDao.__super__.constructor.call(this,"stream");this.bitrate=this._createAccessor("_bitrate","bitrate",null);this.fps=this._createAccessor("_fps","fps",null);this.droppedFrames=this._createAccessor("_droppedFrames","dropped_frames",null);this.bitrate(0);this.fps(0);this.droppedFrames(0);}heartbeat.model.QoSDao=QoSDao;})(core,heartbeat);(function(core,heartbeat){var Dao=heartbeat.model.Dao;var DaoField=heartbeat.model.DaoField;core.extend(AdobeAnalyticsDao,Dao);function AdobeAnalyticsDao(){AdobeAnalyticsDao.__super__.constructor.call(this,"sc");this.reportSuiteId=this._createAccessor("_reportSuiteId","rsid",null);this.trackingServer=this._createAccessor("_trackingServer","tracking_server",null);this.ssl=this._createAccessor("_ssl","ssl",DaoField.HINT_SHORT);this.reportSuiteId("");this.trackingServer("");this.ssl(0);}heartbeat.model.AdobeAnalyticsDao=AdobeAnalyticsDao;})(core,heartbeat);(function(core,heartbeat){var Dao=heartbeat.model.Dao;var UNKNOWN="unknown";core.extend(ServiceProviderDao,Dao);function ServiceProviderDao(){ServiceProviderDao.__super__.constructor.call(this,"sp");this.ovp=this._createAccessor("_ovp","ovp",null);this.sdk=this._createAccessor("_sdk","sdk",null);this.channel=this._createAccessor("_channel","channel",null);this.playerName=this._createAccessor("_playerName","player_name",null);this.libVersion=this._createAccessor("_libVersion","hb_version",null);this.apiLevel=this._createAccessor("_apiLevel","hb_api_lvl",null);this.ovp(UNKNOWN);this.sdk(UNKNOWN);this.channel(UNKNOWN);this.playerName("");this.libVersion("");this.apiLevel(0);}heartbeat.model.ServiceProviderDao=ServiceProviderDao;})(core,heartbeat);(function(core,heartbeat){var Dao=heartbeat.model.Dao;core.extend(SessionDao,Dao);function SessionDao(){SessionDao.__super__.constructor.call(this,"event");this.sessionId=this._createAccessor("_sessionId","sid",null);this.sessionId(null);}heartbeat.model.SessionDao=SessionDao;})(core,heartbeat);(function(core,heartbeat){var Dao=heartbeat.model.Dao;core.extend(StreamDao,Dao);function StreamDao(){StreamDao.__super__.constructor.call(this,"stream");this.cdn=this._createAccessor("_cdn","cdn",null);this.name=this._createAccessor("_name","name",null);this.cdn(null);this.name(null);if(arguments.length&&arguments[0] instanceof StreamDao){var other=arguments[0];this.cdn(other.cdn());this.name(other.name());}}heartbeat.model.StreamDao=StreamDao;})(core,heartbeat);(function(core,heartbeat){var Dao=heartbeat.model.Dao;core.extend(UserDao,Dao);function UserDao(realm){UserDao.__super__.constructor.call(this,"user");this.analyticsVisitorId=this._createAccessor("_analyticsVisitorId","aid",null);this.marketingCloudVisitorId=this._createAccessor("_marketingCloudVisitorId","mid",null);this.visitorId=this._createAccessor("_visitorId","id",null);this.analyticsVisitorId(null);this.marketingCloudVisitorId(null);this.visitorId(null);if(arguments.length&&arguments[0] instanceof UserDao){var other=arguments[0];this.analyticsVisitorId(other.analyticsVisitorId());this.marketingCloudVisitorId(other.marketingCloudVisitorId());this.visitorId(other.visitorId());}}heartbeat.model.UserDao=UserDao;})(core,heartbeat);(function(core,heartbeat){function ReportEntry(eventData,assetData,streamData,qosData){this.eventData=eventData;this.assetData=assetData;this.streamData=streamData;this.qosData=qosData;}heartbeat.model.ReportEntry=ReportEntry;})(core,heartbeat);(function(core,heartbeat){var EventDao=heartbeat.model.EventDao;function Report(adobeAnalyticsData,userData,serviceProviderData,sessionData){this.adobeAnalyticsData=adobeAnalyticsData;this.userData=userData;this.serviceProviderData=serviceProviderData;this.sessionData=sessionData;this.reportEntries=[];}Report.prototype.addEntry=function(reportEntry){this.reportEntries.push(reportEntry);};Report.prototype.discardPauseEvents=function(){if(!this.reportEntries.length){return;}for(var i=this.reportEntries.length-1;i>=0;i--){if(this.reportEntries[i].eventData.type()===EventDao.EVENT_TYPE_PAUSE){this.reportEntries.splice(i,1);}}};heartbeat.model.Report=Report;})(core,heartbeat);(function(core,heartbeat){function SerializerProtocol(){}SerializerProtocol.prototype.serializeReport=function(report){};SerializerProtocol.prototype.serializeReportEntry=function(reportEntry){};SerializerProtocol.prototype.serializeDao=function(dao){};SerializerProtocol.prototype.serializeNumber=function(key,number,realm,hint){};SerializerProtocol.prototype.serializeString=function(key,string,realm,hint){};heartbeat.model.SerializerProtocol=SerializerProtocol;})(core,heartbeat);(function(core,heartbeat){var mixin=core.mixin;var logger=core.logger;var Dao=heartbeat.model.Dao;var DaoField=heartbeat.model.DaoField;var SerializerProtocol=heartbeat.model.SerializerProtocol;var DATA_TYPE_LONG="l";var DATA_TYPE_SHORT="h";var DATA_TYPE_STRING="s";core.extend(QuerystringSerializer,SerializerProtocol);mixin(QuerystringSerializer,logger);function QuerystringSerializer(){this.enableLogging("[heartbeat::QuerystringSerializer] > ");}QuerystringSerializer.prototype._appendSerializedData=function(serializedData){return((serializedData)?(serializedData+"&"):"");};QuerystringSerializer.prototype._removeLastCharacter=function(string){if(string&&string.length>0){string=string.substring(0,string.length-1);}return string;};QuerystringSerializer.prototype._processDao=function(dao){var result=[];for(var key in dao.data){if(dao.data.hasOwnProperty(key)){var field=dao.data[key];var value=field.value;var hint=field.hint;var serializedValue=null;var realm=dao.realm;if(value===null||typeof value==="undefined"){continue;}if(typeof value==="number"){serializedValue=this.serializeNumber(key,value,realm,hint);}else{if(typeof value==="string"){serializedValue=this.serializeString(key,value,realm,hint);}else{if(value instanceof Dao){serializedValue=this.serializeDao(value);}else{this.warn("#_processDao() > Unable to serialize DAO. Field: "+key+". Value: "+value+".");}}}if(serializedValue){result.push(serializedValue);}}}return result;};QuerystringSerializer.prototype.serializeReport=function(report){var result=[];var reportEntries=report.reportEntries;for(var i=0;i<reportEntries.length;i++){var out=this.serializeReportEntry(reportEntries[i])+"&";out+=this._appendSerializedData(this.serializeDao(report.adobeAnalyticsData));out+=this._appendSerializedData(this.serializeDao(report.userData));out+=this._appendSerializedData(this.serializeDao(report.serviceProviderData));out+=this._appendSerializedData(this.serializeDao(report.sessionData));out=this._removeLastCharacter(out);result.push(out);}return result;};QuerystringSerializer.prototype.serializeReportEntry=function(reportEntry){var out=this._appendSerializedData(this.serializeDao(reportEntry.eventData));out+=this._appendSerializedData(this.serializeDao(reportEntry.assetData));out+=this._appendSerializedData(this.serializeDao(reportEntry.streamData));out+=this._appendSerializedData(this.serializeDao(reportEntry.qosData));out=this._removeLastCharacter(out);return out;};QuerystringSerializer.prototype.serializeDao=function(dao){var result=this._processDao(dao);var out="";for(var i=0;i<result.length;i++){if(i==result.length-1){out+=result[i];}else{out+=(result[i]+"&");}}return out;};QuerystringSerializer.prototype.serializeNumber=function(key,number,realm,hint){var type=DATA_TYPE_LONG;if(number!=null&&number!==undefined&&!isNaN(number)){if(hint&&(typeof hint==="string")&&hint===DaoField.HINT_SHORT){type=DATA_TYPE_SHORT;}return type+":"+realm+":"+key+"="+Math.floor(number);}return null;};QuerystringSerializer.prototype.serializeString=function(key,string,realm,hint){if(string){return DATA_TYPE_STRING+":"+realm+":"+key+"="+window["encodeURIComponent"](string);}return null;};heartbeat.model.QuerystringSerializer=QuerystringSerializer;})(core,heartbeat);(function(core,heartbeat){var logger=core.logger;var mixin=core.mixin;var Command=core.radio.Command;var ClockEvent=heartbeat.event.ClockEvent;var EventKeyName=heartbeat.event.EventKeyName;function TimerDescriptor(interval){this.tick=0;this.interval=interval;this.isActive=false;}var TIMER_BASE_INTERVAL=1;mixin(TimerManager,logger);function TimerManager(channel){this._isDestroyed=false;this._currentTick=0;this._timers={};this._channel=channel;var self=this;this._clock=window.setInterval(function(){self._onTick();},TIMER_BASE_INTERVAL*1000);this.enableLogging("[heartbeat::TimerManager] > ");}TimerManager.prototype.isTimerActive=function(name){var timer=this._timers[name];return(timer&&timer.isActive);};TimerManager.prototype.createTimer=function(name,interval){this._timers[name]=new TimerDescriptor(interval);};TimerManager.prototype.destroyTimer=function(name){delete this._timers[name];};TimerManager.prototype.startTimer=function(name,reset){this.log("#startTimer("+"name="+name+", reset="+reset+")");var timer=this._timers[name];if(timer){timer.isActive=true;if(reset){timer.tick=0;}}};TimerManager.prototype.stopTimer=function(name,reset){this.log("#stopTimer("+"name="+name+", reset="+reset+")");var timer=this._timers[name];if(timer){timer.isActive=false;if(reset){timer.tick=0;}}};TimerManager.prototype.destroy=function(){if(this._isDestroyed){return;}this._isDestroyed=true;window.clearInterval(this._clock);};TimerManager.prototype._onTick=function(){this.log("#_onTick() > ------------------- ("+this._currentTick+")");this._currentTick++;for(var name in this._timers){if(this._timers.hasOwnProperty(name)){var timer=this._timers[name];if(timer.isActive){timer.tick++;if(timer.tick%timer.interval===0){var eventData={};eventData[EventKeyName.TIMER_INTERVAL]=timer.interval;this._channel.trigger(new ClockEvent(ClockEvent[name],eventData));}}}}};heartbeat.clock.TimerManager=TimerManager;})(core,heartbeat);(function(core,heartbeat){var logger=core.logger;var mixin=core.mixin;var EventKeyName=heartbeat.event.EventKeyName;mixin(Timer,logger);function Timer(channel,timerManager,tickEventName,enableEventName,disableEventName,interval){this.enableLogging("[heartbeat::Timer] > ");this._isDestroyed=false;this._channel=channel;this._timerManager=timerManager;this._interval=interval;this._tickEventName=tickEventName;this._enableEventName=enableEventName;this._disableEventName=disableEventName;this._timerManager.createTimer(this._tickEventName,this._interval);this._installEventListeners();}Timer.prototype.start=function(reset){this.log("Starting timer: "+this._tickEventName);this._timerManager.startTimer(this._tickEventName,reset);};Timer.prototype.stop=function(reset){this.log("Stopping timer: "+this._tickEventName+")");this._timerManager.stopTimer(this._tickEventName,reset);};Timer.prototype.destroy=function(){if(this._isDestroyed){return;}this._isDestroyed=true;this._uninstallEventListeners();this._timerManager.destroyTimer(this._tickEventName);};Timer.prototype.setInterval=function(interval){var wasActive=this._timerManager.isTimerActive(this._tickEventName);this.stop(true);this._interval=interval;this._timerManager.createTimer(this._tickEventName,this._interval);if(wasActive){this.start(true);}};Timer.prototype._onTimerEnabled=function(e){var eventData=e.data;var reset=false;if(eventData&&eventData.hasOwnProperty(EventKeyName.RESET)){reset=eventData[EventKeyName.RESET];}this.start(reset);};Timer.prototype._onTimerDisabled=function(e){var eventData=e.data;var reset=false;if(eventData&&eventData.hasOwnProperty(EventKeyName.RESET)){reset=eventData[EventKeyName.RESET];}this.stop(reset);};Timer.prototype._installEventListeners=function(){this._channel.on(this._enableEventName,this._onTimerEnabled,this);this._channel.on(this._disableEventName,this._onTimerDisabled,this);};Timer.prototype._uninstallEventListeners=function(){this._channel.off(null,null,this);};heartbeat.clock.Timer=Timer;})(core,heartbeat);(function(core,heartbeat){var mixin=core.mixin;var logger=core.logger;var NetworkEvent=heartbeat.event.NetworkEvent;var ClockEvent=heartbeat.event.ClockEvent;var EventKeyName=heartbeat.event.EventKeyName;var Timer=heartbeat.clock.Timer;var DEFAULT_TRACKING_INTERVAL=10;TrackingTimer.TRACKING_TIMER_INTERVAL="tracking_timer_interval";core.extend(TrackingTimer,Timer);mixin(TrackingTimer,logger);function TrackingTimer(channel,timerManager){TrackingTimer.__super__.constructor.call(this,channel,timerManager,ClockEvent.CLOCK_TRACKING_TICK,ClockEvent.CLOCK_TRACKING_ENABLE,ClockEvent.CLOCK_TRACKING_DISABLE,DEFAULT_TRACKING_INTERVAL);this._installEventListeners();this.enableLogging("[heartbeat::TrackingTimer] > ");}TrackingTimer.prototype._onCheckStatusComplete=function(e){var newTimerInterval=e.data[EventKeyName.TRACKING_INTERVAL];this.log("#_onCheckStatusComplete(interval="+newTimerInterval+")");if(newTimerInterval){if(newTimerInterval==this._interval){this.log("#_onCheckStatusComplete() > Interval value not changed.");return;}this.log("#_onCheckStatusComplete() > Interval changed to: "+newTimerInterval);this.setInterval(newTimerInterval);}else{this.warn("#_onCheckStatusComplete() > Invalid interval value.");this.setInterval(DEFAULT_TRACKING_INTERVAL);}};TrackingTimer.prototype._installEventListeners=function(){this._channel.on(NetworkEvent.NETWORK_CHECK_STATUS_COMPLETE,this._onCheckStatusComplete,this);this._channel.reply(TrackingTimer.TRACKING_TIMER_INTERVAL,function(){return this._interval;},this);TrackingTimer.__super__._installEventListeners.call(this);};heartbeat.clock.TrackingTimer=TrackingTimer;})(core,heartbeat);(function(core,heartbeat){var MAXIMUM_CHECK_STATUS_INTERVAL=10*60;var DEFAULT_CHECK_STATUS_INTERVAL=60;var mixin=core.mixin;var logger=core.logger;var Command=core.radio.Command;var NetworkEvent=heartbeat.event.NetworkEvent;var EventKeyName=heartbeat.event.EventKeyName;var ClockEvent=heartbeat.event.ClockEvent;var Timer=heartbeat.clock.Timer;core.extend(CheckStatusTimer,Timer);mixin(CheckStatusTimer,logger);function CheckStatusTimer(channel,timerManager){CheckStatusTimer.__super__.constructor.call(this,channel,timerManager,ClockEvent.CLOCK_CHECK_STATUS_TICK,ClockEvent.CLOCK_CHECK_STATUS_ENABLE,ClockEvent.CLOCK_CHECK_STATUS_DISABLE,DEFAULT_CHECK_STATUS_INTERVAL);this._installEventListeners();this.enableLogging("[heartbeat::CheckStatusTimer] > ");this.log("#CheckStatusTimer()");this._channel.on(ClockEvent.CLOCK_CHECK_STATUS_GET_SETTINGS,this._getSettings,this);}CheckStatusTimer.prototype._onCheckStatusComplete=function(e){var newTimerInterval=e.data[EventKeyName.CHECK_STATUS_INTERVAL];this.log("#_onCheckStatusComplete(interval="+newTimerInterval+")");if(newTimerInterval){if(newTimerInterval==this._interval){this.log("#_onCheckStatusComplete() > Interval value not changed.");return;}if(newTimerInterval>MAXIMUM_CHECK_STATUS_INTERVAL){this.warn("#_onCheckStatusComplete() > Interval value too large: "+newTimerInterval);this.setInterval(MAXIMUM_CHECK_STATUS_INTERVAL);}else{this.log("#_onCheckStatusComplete() > Interval changed to: "+newTimerInterval);this.setInterval(newTimerInterval);}}else{this.warn("#_onCheckStatusComplete() > Invalid interval value.");this.setInterval(DEFAULT_CHECK_STATUS_INTERVAL);}};CheckStatusTimer.prototype._getSettings=function(){this.log("#_getSettings()");var eventData={};eventData[EventKeyName.TIMER_INTERVAL]=this._interval;this._channel.trigger(new ClockEvent(ClockEvent.CLOCK_CHECK_STATUS_TICK,eventData));};CheckStatusTimer.prototype._installEventListeners=function(){this._channel.on(NetworkEvent.NETWORK_CHECK_STATUS_COMPLETE,this._onCheckStatusComplete,this);CheckStatusTimer.__super__._installEventListeners.call(this);};heartbeat.clock.CheckStatusTimer=CheckStatusTimer;})(core,heartbeat);(function(core,heartbeat){var TimerManager=heartbeat.clock.TimerManager;var CheckStatusTimer=heartbeat.clock.CheckStatusTimer;var TrackingTimer=heartbeat.clock.TrackingTimer;function Clock(channel){this._isDestroyed=false;this._timerManager=new TimerManager(channel);this._checkStatusTimer=new CheckStatusTimer(channel,this._timerManager);this._trackingTimer=new TrackingTimer(channel,this._timerManager);}Clock.prototype.destroy=function(){if(this._isDestroyed){return;}this._isDestroyed=true;this._trackingTimer.destroy();this._checkStatusTimer.destroy();this._timerManager.destroy();};heartbeat.clock.Clock=Clock;})(core,heartbeat);(function(core,heartbeat){var mixin=core.mixin;var logger=core.logger;var EventKeyName=heartbeat.event.EventKeyName;var NetworkEvent=heartbeat.event.NetworkEvent;mixin(SettingsParser,logger);function SettingsParser(data){this._data=data;this.enableLogging("[heartbeat::SettingsParser] > ");this.log("#SettingsParser(data="+data+")");}SettingsParser.prototype.parse=function(){var trackingInterval,checkStatusInterval,trackExternalErrors;var xmlDoc;if(!this._data){this.warn("#SettingsParser() > No data available for parsing.");return;}if(window["DOMParser"]){var parser=new window["DOMParser"]();xmlDoc=parser.parseFromString(this._data,"text/xml");}else{xmlDoc=new window["ActiveXObject"]("Microsoft.XMLDOM");xmlDoc.async=false;xmlDoc.loadXML(this.data);}var temp;temp=parseInt(xmlDoc.getElementsByTagName("trackingInterval")[0].childNodes[0].nodeValue,10);temp&&(trackingInterval=temp);temp=parseInt(xmlDoc.getElementsByTagName("setupCheckInterval")[0].childNodes[0].nodeValue,10);temp&&(checkStatusInterval=temp);temp=parseInt(xmlDoc.getElementsByTagName("trackExternalErrors")[0].childNodes[0].nodeValue,10);temp&&(trackExternalErrors=(temp==1));var eventData={};eventData[EventKeyName.TRACKING_INTERVAL]=trackingInterval;eventData[EventKeyName.CHECK_STATUS_INTERVAL]=checkStatusInterval;eventData[EventKeyName.TRACK_EXTERNAL_ERRORS]=trackExternalErrors;this.log("#parse() > Obtained configuration settings: "+JSON.stringify(eventData));return eventData;};heartbeat.network.SettingsParser=SettingsParser;})(core,heartbeat);(function(core,heartbeat){var mixin=core.mixin;var logger=core.logger;var Event=core.radio.Event;var Command=core.radio.Command;var CommandQueue=core.radio.CommandQueue;var ApiEvent=heartbeat.event.ApiEvent;var URLRequestMethod=core.URLRequestMethod;var URLRequest=core.URLRequest;var URLLoader=core.URLLoader;var EventKeyName=heartbeat.event.EventKeyName;var ClockEvent=heartbeat.event.ClockEvent;var ContextEvent=heartbeat.event.ContextEvent;var NetworkEvent=heartbeat.event.NetworkEvent;var SettingsParser=heartbeat.network.SettingsParser;var EventDao=heartbeat.model.EventDao;var HeartbeatPlugin=heartbeat.HeartbeatPlugin;mixin(Network,logger);function Network(channel,serializer){HeartbeatPlugin=heartbeat.HeartbeatPlugin;this._jobId=null;this._trackingServer=null;this._checkStatusServer=null;this._quietMode=false;this._isConfigured=false;this._isDestroyed=false;this._channel=channel;this._serializer=serializer;this._netQueue=new CommandQueue();this._installEventListeners();this.enableLogging("[heartbeat::Network] > ");}Network.prototype.destroy=function(){if(this._isDestroyed){return;}this._isDestroyed=true;this.log("#destroy()");this._netQueue.cancelAllCommands();this._uninstallEventListeners();};Network.prototype._onApiConfig=function(e){var info=e.data;this.log("#_onApiConfig("+"sb_server="+info[EventKeyName.TRACKING_SERVER]+", check_status_server="+info[EventKeyName.CHECK_STATUS_SERVER]+", job_id="+info[EventKeyName.JOB_ID]+", quiet_mode="+info[EventKeyName.QUIET_MODE]+")");this._jobId=info[EventKeyName.JOB_ID];var useSSL=this._channel.request(HeartbeatPlugin.USE_SSL);this._trackingServer=this._updateRequestProtocol(info[EventKeyName.TRACKING_SERVER],useSSL);this._checkStatusServer=this._updateRequestProtocol(info[EventKeyName.CHECK_STATUS_SERVER],useSSL);this._quietMode=info[EventKeyName.QUIET_MODE];this._isConfigured=true;};Network.prototype._onContextDataAvailable=function(e){if(!this._isConfigured){this.warn("#_onContextDataAvailable() > Unable to send request: not configured.");return;}var command=new Command(function(){var report=e.data[EventKeyName.REPORT];var payloads=this._serializer.serializeReport(report);for(var i=0;i<payloads.length;i++){var payload=payloads[i];var error=null;var url=this._trackingServer+"/?__job_id="+window["encodeURIComponent"](this._jobId)+"&"+payload;var req=new URLRequest(url,URLRequestMethod.GET);this.info("_onContextDataAvailable() > Sending request: "+req.url);var loader=new URLLoader();(function(loader,self){function onSuccess(e){loader.close();}function onError(e){self.warn("#_onContextDataAvailable() > Failed to send heartbeat report: "+JSON.stringify(e));loader.close();}if(!self._quietMode){loader.addEventListener(Event.SUCCESS,onSuccess,this);loader.addEventListener(Event.ERROR,onError,this);loader.load(req);}})(loader,this);}if(report.reportEntries[0].eventData.type()==EventDao.EVENT_TYPE_UNLOAD){this._channel.trigger(new core.radio.Event(HeartbeatPlugin.VIDEO_UNLOADED));}},this);this._netQueue.addCommand(command);};Network.prototype._onClockCheckStatusTick=function(e){if(!this._isConfigured){this.warn("#_onClockCheckStatusTick() > Unable to send request: not configured.");return;}var publisher=this._channel.request(HeartbeatPlugin.PUBLISHER);if(!publisher){this.warn("#_onClockCheckStatusTick() > Publisher is NULL.");return;}var command=new Command(function(){var self=this;function onSuccess(e){if(e.data){var parser=new SettingsParser(e.data.response);var parseResult=parser.parse();if(parseResult){self._channel.trigger(new NetworkEvent(NetworkEvent.NETWORK_CHECK_STATUS_COMPLETE,parseResult));}else{self.warn("#_onClockCheckStatusTick() > Failed to parse the config. settings.");}}loader.close();}function onError(e){self.warn("#_onClockCheckStatusTick() > Failed to obtain the config. settings: "+JSON.stringify(e));loader.close();}publisher=publisher.replace(/[^a-zA-Z0-9]+/,"-").toLocaleLowerCase();var url=this._checkStatusServer+publisher+".xml?r="+new Date().getTime();var req=new URLRequest(url,URLRequestMethod.GET);var loader=new URLLoader();loader.addEventListener(Event.SUCCESS,onSuccess,this);loader.addEventListener(Event.ERROR,onError,this);this.log("#_onClockCheckStatusTick() > Get new settings from: "+url);loader.load(req);},this);this._netQueue.addCommand(command);};Network.prototype._updateRequestProtocol=function(url,useSSL){var stripped=url;if(stripped.indexOf("http://")===0){stripped=stripped.slice(7);}else{if(stripped.indexOf("https://")===0){stripped=stripped.slice(8);}}return useSSL?"https://"+stripped:"http://"+stripped;};Network.prototype._installEventListeners=function(){this._channel.on(ApiEvent.API_CONFIG,this._onApiConfig,this);this._channel.on(ContextEvent.CONTEXT_DATA_AVAILABLE,this._onContextDataAvailable,this);this._channel.on(ClockEvent.CLOCK_CHECK_STATUS_TICK,this._onClockCheckStatusTick,this);};Network.prototype._uninstallEventListeners=function(){this._channel.off(null,null,this);};heartbeat.network.Network=Network;})(core,heartbeat);(function(core,heartbeat){var mixin=core.mixin;var logger=core.logger;mixin(Counters,logger);function Counters(){this._totalCount={};this._totalDuration={};this.enableLogging("[heartbeat::Counters] > ");}Counters.prototype.getTotalCount=function(item){var key=_computeKey(item);this._totalCount[key]||(this._totalCount[key]=0);this.log("#getTotalCount(key="+key+")");return this._totalCount[key];};Counters.prototype.incrementTotalCount=function(item){var key=_computeKey(item);this._totalCount[key]||(this._totalCount[key]=0);this.log("#incrementTotalCount(key="+key+")");this._totalCount[key]++;};Counters.prototype.getTotalDuration=function(item){var key=_computeKey(item);this._totalDuration[key]||(this._totalDuration[key]=0);this.log("#getTotalDuration(key="+key+")");return this._totalDuration[key];};Counters.prototype.increaseTotalDuration=function(item){var key=_computeKey(item);this._totalDuration[key]||(this._totalDuration[key]=0);this.log("#increaseTotalDuration("+"key="+key+", amount="+item.duration+")");this._totalDuration[key]+=item.duration;};Counters.prototype.resetCounters=function(assetId,assetType){var key=assetId+"."+assetType;this.log("#resetCounters(key="+key+")");var entryKey;for(entryKey in this._totalCount){if(this._totalCount.hasOwnProperty(entryKey)&&entryKey.indexOf(key)!=-1){this._totalCount[entryKey]=0;}}for(entryKey in this._totalDuration){if(this._totalDuration.hasOwnProperty(entryKey)&&entryKey.indexOf(key)!=-1){this._totalDuration[entryKey]=0;}}};function _computeKey(item){var key=item.getAssetId()+"."+item.assetData.type()+"."+item.eventType;return key;}heartbeat.context.Counters=Counters;})(core,heartbeat);(function(core,heartbeat){var mixin=core.mixin;var logger=core.logger;mixin(History,logger);function History(){this._items={};this.enableLogging("[heartbeat::History] > ");}History.prototype.updateWith=function(timelineItem){var key=_computeItemKey(timelineItem);this.log("#updateWith(key="+key+")");this._items[key]=timelineItem;};History.prototype.getPreviousItemOfSameTypeWith=function(timelineItem){var key=_computeItemKey(timelineItem);this.log("#getPreviousItemOfSameTypeWith(key="+key+")");return this._items[key];};function _computeItemKey(timelineItem){var assetData=timelineItem.assetData;var assetId=assetData.adData()?assetData.adData().adId():assetData.videoId();return assetId+"."+assetData.type()+"."+timelineItem.eventType;}heartbeat.context.History=History;})(core,heartbeat);(function(core,heartbeat){var EventDao=heartbeat.model.EventDao;var AssetDao=heartbeat.model.AssetDao;var StreamDao=heartbeat.model.StreamDao;function TimelineItem(assetData,streamData,qosData,eventType,playhead){this.timestamp=new Date();this.assetData=new AssetDao(assetData);this.streamData=new StreamDao(streamData);this.qosData=qosData;this.eventType=eventType;this.playhead=playhead;this.duration=0;this.prevItemOfSameType=null;}TimelineItem.clone=function(other){var clonedItem=new TimelineItem(other.assetData,other.streamData,other.qosData,other.eventType,other.playhead);clonedItem.timestamp=other.timestamp;return clonedItem;};TimelineItem.prototype.getAssetId=function(){if(this.eventType===EventDao.EVENT_TYPE_ACTIVE){return this.assetData.videoId();}return(this.assetData.adData())?this.assetData.adData().adId():this.assetData.videoId();};TimelineItem.prototype.getEventCount=function(){return 1;};heartbeat.context.TimelineItem=TimelineItem;})(core,heartbeat);(function(core,heartbeat){var mixin=core.mixin;var logger=core.logger;var TimelineItem=heartbeat.context.TimelineItem;var EventDao=heartbeat.model.EventDao;var AssetDao=heartbeat.model.AssetDao;mixin(Timeline,logger);function Timeline(context){this._timeline=[];this._context=context;this.enableLogging("[heartbeat::Timeline] > ");}Timeline.prototype.getTimelineItems=function(){return this._timeline.slice();};Timeline.prototype.getLast=function(){if(this._timeline.length>0){return this._timeline[this._timeline.length-1];}return null;};Timeline.prototype.addItem=function(timelineItem){var lastItem=this.getLast();if(lastItem&&lastItem.eventType!==EventDao.EVENT_TYPE_ACTIVE){lastItem.duration=_timeSpanMs(lastItem.timestamp,timelineItem.timestamp);this._updateItemStats(lastItem);}this.log("#addItem() > "+" | "+timelineItem.assetData.type()+" | "+timelineItem.eventType+" | "+timelineItem.playhead+" | "+(timelineItem.prevItemOfSameType?timelineItem.prevItemOfSameType.timestamp.getTime():"-1")+" | "+timelineItem.timestamp.getTime());this._timeline.push(timelineItem);};Timeline.prototype.addActiveItem=function(activeItem){var lastItem=this.getLast();this.addItem(activeItem);activeItem.duration=0;for(var i=this._timeline.length-2;i>=0;i--){var currentItem=this._timeline[i];if(currentItem.eventType==EventDao.EVENT_TYPE_ACTIVE){break;}activeItem.duration+=currentItem.duration;}this._updateItemStats(activeItem);if(activeItem.eventType===EventDao.EVENT_TYPE_ACTIVE&&_shouldBeCloned(lastItem)){var pseudoItem=TimelineItem.clone(lastItem);pseudoItem.prevItemOfSameType=lastItem;pseudoItem.timestamp=activeItem.timestamp;pseudoItem.playhead=activeItem.playhead;pseudoItem.duration=0;this.addItem(pseudoItem);}};Timeline.prototype._updateItemStats=function(timelineItem){var counters=this._context._counters;counters.incrementTotalCount(timelineItem);counters.increaseTotalDuration(timelineItem);};function _shouldBeCloned(item){var et=item.eventType,at=item.assetData.type();return et===EventDao.EVENT_TYPE_PLAY||et===EventDao.EVENT_TYPE_BUFFER||(et===EventDao.EVENT_TYPE_START&&at!==AssetDao.TYPE_AD);}function _timeSpanMs(startTime,endTime){return endTime.getTime()-startTime.getTime();}heartbeat.context.Timeline=Timeline;})(core,heartbeat);(function(core,heartbeat){var mixin=core.mixin;var logger=core.logger;var Report=heartbeat.model.Report;var EventDao=heartbeat.model.EventDao;var AssetDao=heartbeat.model.AssetDao;var ReportEntry=heartbeat.model.ReportEntry;mixin(ReporterHelper,logger);function ReporterHelper(context){this._context=context;this.enableLogging("[heartbeat::ReporterHelper] > ");}ReporterHelper.prototype.createReportForItem=function(timelineItem,trackingInterval){var counters=this._context._counters;var report=new Report(this._context._adobeAnalyticsData,this._context._userData,this._context._serviceProviderData,this._context._sessionData);timelineItem.duration=0;counters.incrementTotalCount(timelineItem);counters.increaseTotalDuration(timelineItem);report.addEntry(this._buildReportEntryForItem(timelineItem,trackingInterval));return report;};ReporterHelper.prototype.createReportForQuantum=function(trackingInterval,isFinalReport){var i;var currentItem;var selectedItems=this._selectTimelineItemsForCurrentQuantum(isFinalReport);this.log("#createReportForQuantum() > -------------[ SUMMARY REPORT ]----------------");for(i=0;i<selectedItems.length;i++){currentItem=selectedItems[i];this.log("#createReportForQuantum() > "+" | "+currentItem.assetData.type()+" | "+currentItem.eventType+" | "+currentItem.playhead+" | "+currentItem.duration);}selectedItems=this._compactTimelineItems(selectedItems);this.log("#createReportForQuantum() > -----------------------------------------");for(i=0;i<selectedItems.length;i++){currentItem=selectedItems[i];this.log("#createReportForQuantum() > "+" | "+currentItem.assetData.type()+" | "+currentItem.eventType+" | "+currentItem.playhead+" | "+currentItem.duration);}this.log("#createReportForQuantum() > -----------------------------------------");var report=this._createReport(selectedItems,trackingInterval,isFinalReport);return report;};ReporterHelper.prototype._selectTimelineItemsForCurrentQuantum=function(isFinalReport){var timelineItems=this._context._timeline.getTimelineItems(),selectedItems=[],lastItemPos,i;if(isFinalReport){lastItemPos=timelineItems.length;}else{for(i=timelineItems.length-2;i<timelineItems.length;i++){var lastItem=timelineItems[i];if(lastItem.eventType===EventDao.EVENT_TYPE_ACTIVE){lastItemPos=i;selectedItems.unshift(lastItem);break;}}if(!lastItemPos){throw new Error("Expecting an ACTIVE event in the last 2 on the timeline.");}}for(i=lastItemPos-1;i>=0;i--){var currentItem=timelineItems[i];if(currentItem.eventType!=EventDao.EVENT_TYPE_ACTIVE){selectedItems.unshift(currentItem);}else{break;}}return selectedItems;};ReporterHelper.prototype._compactTimelineItems=function(items){var compactedList=[];var i;var findInCompactedItemsList=function(item){var i;for(i=0;i<compactedList.length;i++){var currentItem=compactedList[i];var matched=false;if(item.eventType==currentItem.eventType&&item.assetData.type()==currentItem.assetData.type()){if(item.assetData.type()==AssetDao.TYPE_AD){matched=((item.assetData.adData().adId()==currentItem.assetData.adData().adId())&&(item.assetData.adData().podPosition()==currentItem.assetData.adData().podPosition()));}else{matched=(item.assetData.videoId()==currentItem.assetData.videoId());}if(!matched){continue;}if(item.assetData.chapterData()){matched=(currentItem.assetData.chapterData()&&(item.assetData.chapterData().id()==currentItem.assetData.chapterData().id())&&(item.assetData.chapterData().position()==currentItem.assetData.chapterData().position()));}else{matched=(currentItem.assetData.chapterData()==null);}}if(matched){return currentItem;}}return null;};for(i=0;i<items.length;i++){var currentItem=items[i];var compactedItem=findInCompactedItemsList(currentItem);if(!compactedItem){compactedList.push(currentItem);}else{compactedItem.playhead=currentItem.playhead;compactedItem.timestamp=currentItem.timestamp;compactedItem.duration+=currentItem.duration;}}return compactedList;};ReporterHelper.prototype._createReport=function(items,trackingInterval,isFinalReport){var i;var report=new Report(this._context._adobeAnalyticsData,this._context._userData,this._context._serviceProviderData,this._context._sessionData);for(i=0;i<items.length;i++){report.addEntry(this._buildReportEntryForItem(items[i],trackingInterval));}var lastReportEntry=report.reportEntries[report.reportEntries.length-1];if(!isFinalReport&&lastReportEntry.eventData.type()!=EventDao.EVENT_TYPE_ACTIVE){throw new Error("Expecting the last report entry to represent an ACTIVE event.");}for(i=0;i<report.reportEntries.length-1;i++){var currentReportEntry=report.reportEntries[i];currentReportEntry.eventData.tsAsDate(lastReportEntry.eventData.tsAsDate());}report.discardPauseEvents();return report;};ReporterHelper.prototype._buildReportEntryForItem=function(timelineItem,trackingInterval){var counters=this._context._counters;var eventData=new EventDao(trackingInterval);eventData.type(timelineItem.eventType);eventData.count(timelineItem.getEventCount());eventData.duration(timelineItem.duration);eventData.totalCount(counters.getTotalCount(timelineItem));eventData.totalDuration(counters.getTotalDuration(timelineItem));eventData.playhead(timelineItem.playhead);eventData.ts(timelineItem.timestamp.getTime());eventData.prevTs(timelineItem.prevItemOfSameType?timelineItem.prevItemOfSameType.timestamp.getTime():-1);return new ReportEntry(eventData,timelineItem.assetData,timelineItem.streamData,timelineItem.qosData);};heartbeat.context.ReporterHelper=ReporterHelper;})(core,heartbeat);(function(core,heartbeat,va,utils){var mixin=core.mixin;var deferrable=core.deferrable;var logger=core.logger;var Event=core.radio.Event;var InputDataSanitizer=core.InputDataSanitizer;var ReporterHelper=heartbeat.context.ReporterHelper;var TrackingTimer=heartbeat.clock.TrackingTimer;var Timeline=heartbeat.context.Timeline;var TimelineItem=heartbeat.context.TimelineItem;var History=heartbeat.context.History;var SessionDao=heartbeat.model.SessionDao;var AdobeAnalyticsDao=heartbeat.model.AdobeAnalyticsDao;var AssetDao=heartbeat.model.AssetDao;var ServiceProviderDao=heartbeat.model.ServiceProviderDao;var UserDao=heartbeat.model.UserDao;var StreamDao=heartbeat.model.StreamDao;var QoSDao=heartbeat.model.QoSDao;var ChapterDao=heartbeat.model.ChapterDao;var Counters=heartbeat.context.Counters;var ClockEvent=heartbeat.event.ClockEvent;var NetworkEvent=heartbeat.event.NetworkEvent;var ApiEvent=heartbeat.event.ApiEvent;var ContextEvent=heartbeat.event.ContextEvent;var EventKeyName=heartbeat.event.EventKeyName;var EventDao=heartbeat.model.EventDao;var AdDao=heartbeat.model.AdDao;var Version=va.Version;var MD5=utils.md5;var HeartbeatPlugin;var ERROR_SOURCE_PLAYER="sourceErrorSDK";var ERROR="error";mixin(Context,deferrable);mixin(Context,logger);function Context(channel){HeartbeatPlugin=heartbeat.HeartbeatPlugin;this._assetData=null;this._streamData=null;this._qosData=null;this._sessionData=null;this._adobeAnalyticsData=new AdobeAnalyticsDao();this._serviceProviderData=new ServiceProviderDao();this._userData=new UserDao();this._videoAssetType=null;this._counters=new Counters();this._history=null;this._timeline=null;this._isTrackingSessionActive=false;this._isVideoComplete=false;this._activeAssetId=null;this._isDestroyed=false;this._reporterHelper=new ReporterHelper(this);this._channel=channel;this._stashedChapterData=null;this._stashedAdData=null;this._trackExternalErrors=true;this._inputDataSanitizer=new InputDataSanitizer(this._onInvalidInputData,this);this._installEventListeners();this.enableLogging("[heartbeat::Context] > ");}Context.prototype.destroy=function(){if(this._isDestroyed){return;}this._isDestroyed=true;this.log("#destroy()");this._uninstallEventListeners();};Context.prototype._onApiConfig=function(e){var info=e.data;this.log("#_onApiConfig("+", tracking_server="+info[EventKeyName.TRACKING_SERVER]+", check_status_server="+info[EventKeyName.CHECK_STATUS_SERVER]+", job_id="+info[EventKeyName.JOB_ID]+", quietMode: "+info[EventKeyName.QUIET_MODE]+")");this._adobeAnalyticsData.reportSuiteId(this._channel.request(HeartbeatPlugin.RSID));this._adobeAnalyticsData.trackingServer(this._channel.request(HeartbeatPlugin.TRACKING_SERVER));this._adobeAnalyticsData.ssl(this._channel.request(HeartbeatPlugin.USE_SSL)?1:0);this._userData.visitorId(this._channel.request(HeartbeatPlugin.VISITOR_ID));this._userData.analyticsVisitorId(this._channel.request(HeartbeatPlugin.ANALYTICS_VISITOR_ID));this._userData.marketingCloudVisitorId(this._channel.request(HeartbeatPlugin.MARKETING_CLOUD_VISITOR_ID));this._serviceProviderData.ovp(this._channel.request(HeartbeatPlugin.OVP));this._serviceProviderData.sdk(this._channel.request(HeartbeatPlugin.SDK));this._serviceProviderData.channel(this._channel.request(HeartbeatPlugin.CHANNEL));this._serviceProviderData.libVersion(Version.getVersion());this._serviceProviderData.apiLevel(Version.getApiLevel());this._channel.trigger(new ClockEvent(ClockEvent.CLOCK_CHECK_STATUS_ENABLE));};Context.prototype._onApiVideoLoad=function(){this._resetInternalState();var videoInfo=this._channel.request(HeartbeatPlugin.VIDEO_INFO);if(!this._inputDataSanitizer.sanitizeVideoInfo(videoInfo)){return;}this.log("#_onApiVideoLoad("+"id="+videoInfo.id+", length="+videoInfo.length+", type="+videoInfo.streamType+", player_name="+videoInfo.playerName+")");this._activeAssetId=videoInfo.id;this._serviceProviderData.playerName(videoInfo.playerName);this._assetData.videoId(this._activeAssetId);this._assetData.duration(videoInfo.length);this._assetData.type(videoInfo.streamType);this._assetData.publisher(this._channel.request(HeartbeatPlugin.PUBLISHER));this._videoAssetType=this._assetData.type();this._streamData.name(videoInfo.name||this._activeAssetId);this._sessionData.sessionId(_generateSessionId());this._counters.resetCounters(this._activeAssetId,this._videoAssetType);this._updateQoSInfo();var loadItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_LOAD,0);loadItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(loadItem);this._history.updateWith(loadItem);var trackingInterval=this._channel.request(TrackingTimer.TRACKING_TIMER_INTERVAL);var report=this._reporterHelper.createReportForItem(loadItem,trackingInterval);var eventData={};eventData[EventKeyName.REPORT]=report;this._channel.trigger(new ContextEvent(ContextEvent.CONTEXT_DATA_AVAILABLE,eventData));this._isTrackingSessionActive=true;};Context.prototype._onApiVideoUnload=function(e){if(!this._isTrackingSessionActive){this.warn("#_onApiVideoUnload() > No active tracking session.");return;}this.log("#_onApiVideoUnload()");var trackingInterval=this._channel.request(TrackingTimer.TRACKING_TIMER_INTERVAL);var unloadItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_UNLOAD,0);unloadItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(unloadItem);this._history.updateWith(unloadItem);var report=this._reporterHelper.createReportForItem(unloadItem,trackingInterval);var eventData={};eventData[EventKeyName.REPORT]=report;this._channel.trigger(new ContextEvent(ContextEvent.CONTEXT_DATA_AVAILABLE,eventData));this._isTrackingSessionActive=false;};Context.prototype._onApiVideoStart=function(e){if(!this._checkCall("_onApiVideoStart")){return;}this.log("#_onApiVideoStart()");var playhead=this._getPlayhead();if(playhead==null||isNaN(playhead)){return;}var eventData={};eventData[EventKeyName.RESET]=true;this._channel.trigger(new ClockEvent(ClockEvent.CLOCK_TRACKING_ENABLE,eventData));this._updateQoSInfo();var startItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_START,playhead);startItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(startItem);this._placeItemOnTimeline(startItem);};Context.prototype._onApiVideoComplete=function(e){if(!this._checkCall("_onApiVideoComplete")){return;}this.log("#_onApiVideoComplete()");this._updateQoSInfo();var completeItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_COMPLETE,this._assetData.duration());completeItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(completeItem);this._placeItemOnTimeline(completeItem);var trackingInterval=this._channel.request(TrackingTimer.TRACKING_TIMER_INTERVAL);var pauseItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_PAUSE,0);pauseItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(pauseItem);this._placeItemOnTimeline(pauseItem);var report=this._reporterHelper.createReportForQuantum(trackingInterval,true);var eventData={};eventData[EventKeyName.REPORT]=report;this._channel.trigger(new ContextEvent(ContextEvent.CONTEXT_DATA_AVAILABLE,eventData));eventData={};eventData[EventKeyName.RESET]=true;this._channel.trigger(new ClockEvent(ClockEvent.CLOCK_TRACKING_DISABLE,eventData));this._isVideoComplete=true;};Context.prototype._onApiPlay=function(e){if(!this._checkCall("_onApiPlay")){return;}this.log("#_onApiPlay()");var playhead=this._getPlayhead();if(playhead==null||isNaN(playhead)){return;}this._channel.trigger(new ClockEvent(ClockEvent.CLOCK_TRACKING_ENABLE));this._updateQoSInfo();var playItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_PLAY,playhead);playItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(playItem);this._placeItemOnTimeline(playItem);};Context.prototype._onApiPause=function(e){if(!this._checkCall("_onApiPause")){return;}this.log("#_onApiPause()");var playhead=this._getPlayhead();if(playhead==null||isNaN(playhead)){return;}this._updateQoSInfo();var pauseItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_PAUSE,playhead);pauseItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(pauseItem);this._placeItemOnTimeline(pauseItem);this._channel.trigger(new ClockEvent(ClockEvent.CLOCK_TRACKING_DISABLE));};Context.prototype._onApiBufferStart=function(e){if(!this._checkCall("_onApiBufferStart")){return;}this.log("#_onApiBufferStart()");var playhead=this._getPlayhead();if(playhead==null||isNaN(playhead)){return;}this._updateQoSInfo();var bufferStartItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_BUFFER,playhead);bufferStartItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(bufferStartItem);this._placeItemOnTimeline(bufferStartItem);};Context.prototype._onApiSeekStart=function(e){if(!this._checkCall("_onApiSeekStart")){return;}this.log("#_onApiSeekStart()");this._stashedAdData=this._assetData.adData();this._stashedChapterData=this._assetData.chapterData();this._assetData.adData(null);this._assetData.type(this._videoAssetType);this._activeAssetId=this._assetData.videoId();this._assetData.chapterData(null);};Context.prototype._onApiSeekComplete=function(e){if(!this._checkCall("_onApiSeekComplete")){return;}var adBreakInfo=this._channel.request(HeartbeatPlugin.AD_BREAK_INFO);if(!this._inputDataSanitizer.sanitizeAdBreakInfo(adBreakInfo,true)){return;}var adInfo=this._channel.request(HeartbeatPlugin.AD_INFO);if(!this._inputDataSanitizer.sanitizeAdInfo(adInfo,true)){return;}var chapterInfo=this._channel.request(HeartbeatPlugin.CHAPTER_INFO);if(!this._inputDataSanitizer.sanitizeChapterInfo(chapterInfo,true)){return;}if(adBreakInfo&&adInfo){var podId=MD5(this._assetData.videoId())+"_"+adBreakInfo.position;if(this._stashedAdData&&this._stashedAdData.podId()==podId&&parseInt(this._stashedAdData.podPosition(),10)==adInfo.position){this._assetData.adData(this._stashedAdData);this._activeAssetId=this._stashedAdData.adId();}else{if(!this._assetData.adData()){this._activeAssetId=adInfo.id;var adData=new AdDao();adData.adId(this._activeAssetId);adData.length(adInfo.length);adData.resolver(adBreakInfo.playerName);adData.podId(podId);adData.podSecond(adBreakInfo.startTime);adData.podPosition(adInfo.position+"");adData.sid(_generateSessionId());this._assetData.adData(adData);}}this._assetData.type(AssetDao.TYPE_AD);}else{this._assetData.adData(null);this._assetData.type(this._videoAssetType);this._activeAssetId=this._assetData.videoId();}if(chapterInfo){if(this._stashedChapterData&&chapterInfo.position==this._stashedChapterData.position()){this._assetData.chapterData(this._stashedChapterData);}else{if(!this._assetData.chapterData()){var chapterData=new ChapterDao();chapterData.id(MD5(this._assetData.videoId())+"_"+chapterInfo.position);chapterData.name(chapterInfo.name);chapterData.length(chapterInfo.length);chapterData.position(chapterInfo.position);chapterData.offset(chapterInfo.startTime);chapterData.sid(_generateSessionId());this._assetData.chapterData(chapterData);}}}else{this._assetData.chapterData(null);}this._stashedAdData=null;this._stashedChapterData=null;};Context.prototype._onApiAdStart=function(){if(!this._checkCall("_onApiAdStart")){return;}var adBreakInfo=this._channel.request(HeartbeatPlugin.AD_BREAK_INFO);if(!this._inputDataSanitizer.sanitizeAdBreakInfo(adBreakInfo,false)){return;}var videoInfo=this._channel.request(HeartbeatPlugin.VIDEO_INFO);if(!this._inputDataSanitizer.sanitizeVideoInfo(videoInfo)){return;}if(adBreakInfo.startTime==null||isNaN(adBreakInfo.startTime)){adBreakInfo.startTime=videoInfo.playhead;}var adInfo=this._channel.request(HeartbeatPlugin.AD_INFO);if(!this._inputDataSanitizer.sanitizeAdInfo(adInfo,false)){return;}this.log("#_onApiAdStart("+"id="+adInfo.id+", length="+adInfo.length+", player_name="+adBreakInfo.playerName+", parent_name="+this._assetData.videoId()+", pod_pos="+adInfo.position+", pod_offset="+adBreakInfo.startTime+")");this._activeAssetId=adInfo.id;var adData=new AdDao();adData.adId(this._activeAssetId);adData.length(adInfo.length);adData.resolver(adBreakInfo.playerName);adData.podId(MD5(this._assetData.videoId())+"_"+adBreakInfo.position);adData.podSecond(adBreakInfo.startTime);adData.podPosition(adInfo.position+"");adData.sid(_generateSessionId());this._assetData.adData(adData);this._assetData.type(AssetDao.TYPE_AD);this._counters.resetCounters(this._activeAssetId,AssetDao.TYPE_AD);this._updateQoSInfo();var startItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_START,videoInfo.playhead);startItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(startItem);this._placeItemOnTimeline(startItem);};Context.prototype._onApiAdComplete=function(e){if(!this._checkCall("_onApiAdComplete")){return;}this.log("#_onApiAdComplete()");if(this._assetData.type()!=AssetDao.TYPE_AD){this.warn("#_onApiAdComplete() > Ignoring the ad complete event, because we are no longer in an ad.");return;}var playhead=this._getPlayhead();if(playhead==null||isNaN(playhead)){return;}this._updateQoSInfo();var playItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_PLAY,playhead);playItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(playItem);this._placeItemOnTimeline(playItem);var completeItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_COMPLETE,playhead);completeItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(completeItem);this._placeItemOnTimeline(completeItem);this._assetData.adData(null);this._assetData.type(this._videoAssetType);this._activeAssetId=this._assetData.videoId();};Context.prototype._onApiChapterStart=function(e){if(!this._checkCall("_onApiChapterStart")){return;}var chapterInfo=this._channel.request(HeartbeatPlugin.CHAPTER_INFO);if(!this._inputDataSanitizer.sanitizeChapterInfo(chapterInfo,false)){return;}this.log("#_onApiChapterStart("+"name="+chapterInfo.name+", length="+chapterInfo.length+", position="+chapterInfo.position+", chapter_offset="+chapterInfo.startTime+")");var playhead=this._getPlayhead();if(playhead==null||isNaN(playhead)){return;}var chapterData=new ChapterDao();chapterData.id(MD5(this._assetData.videoId())+"_"+chapterInfo.position);chapterData.name(chapterInfo.name);chapterData.length(chapterInfo.length);chapterData.position(chapterInfo.position);chapterData.offset(chapterInfo.startTime);chapterData.sid(_generateSessionId());this._assetData.chapterData(chapterData);this._updateQoSInfo();if(this._timeline.getLast().eventType==EventDao.EVENT_TYPE_PLAY){var item=new TimelineItem(this._assetData,this._streamData,this._qosData,this._timeline.getLast().eventType,playhead);item.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(item);this._placeItemOnTimeline(item);}var trackingInterval=this._channel.request(TrackingTimer.TRACKING_TIMER_INTERVAL);var noAdInfoAssetData=new AssetDao(this._assetData);noAdInfoAssetData.adData(null);noAdInfoAssetData.type(this._videoAssetType);var startChapterItem=new TimelineItem(noAdInfoAssetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_CHAPTER_START,playhead);startChapterItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(startChapterItem);this._history.updateWith(startChapterItem);var report=this._reporterHelper.createReportForItem(startChapterItem,trackingInterval);var eventData={};eventData[EventKeyName.REPORT]=report;this._channel.trigger(new ContextEvent(ContextEvent.CONTEXT_DATA_AVAILABLE,eventData));};Context.prototype._onApiChapterComplete=function(e){if(!this._checkCall("_onApiChapterComplete")){return;}this.log("#_onApiChapterComplete()");if(!this._assetData.chapterData()){this.warn("#_onApiChapterComplete() > Ignoring the chapter complete event, because we are no longer in a chapter.");return;}var playhead=this._getPlayhead();if(playhead==null||isNaN(playhead)){return;}var trackingInterval=this._channel.request(TrackingTimer.TRACKING_TIMER_INTERVAL);var noAdInfoAssetData=new AssetDao(this._assetData);noAdInfoAssetData.adData(null);noAdInfoAssetData.type(this._videoAssetType);this._updateQoSInfo();var completeChapterItem=new TimelineItem(noAdInfoAssetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_CHAPTER_COMPLETE,playhead);completeChapterItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(completeChapterItem);this._history.updateWith(completeChapterItem);var report=this._reporterHelper.createReportForItem(completeChapterItem,trackingInterval);var eventData={};eventData[EventKeyName.REPORT]=report;this._channel.trigger(new ContextEvent(ContextEvent.CONTEXT_DATA_AVAILABLE,eventData));this._assetData.chapterData(null);if(this._timeline.getLast().eventType==EventDao.EVENT_TYPE_PLAY){var item=new TimelineItem(this._assetData,this._streamData,this._qosData,this._timeline.getLast().eventType,playhead);item.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(item);this._placeItemOnTimeline(item);}};Context.prototype._onApiBitrateChange=function(e){if(!this._checkCall("_onApiBitrateChange")){return;}this.log("#_onApiBitrateChange()");var playhead=this._getPlayhead();if(playhead==null||isNaN(playhead)){return;}var trackingInterval=this._channel.request(TrackingTimer.TRACKING_TIMER_INTERVAL);this._updateQoSInfo();var bitrateChangeItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_BITRATE_CHANGE,playhead);bitrateChangeItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(bitrateChangeItem);this._history.updateWith(bitrateChangeItem);var report=this._reporterHelper.createReportForItem(bitrateChangeItem,trackingInterval);var eventData={};eventData[EventKeyName.REPORT]=report;this._channel.trigger(new ContextEvent(ContextEvent.CONTEXT_DATA_AVAILABLE,eventData));};Context.prototype._onApiTrackError=function(e){if(!this._checkCall("_onApiTrackError")){return;}var playhead=this._getPlayhead();if(playhead==null||isNaN(playhead)){return;}var info=e.data;this.log("#_onApiTrackError("+"source="+info[EventKeyName.SOURCE]+", err_id="+info[EventKeyName.ERROR_ID]+")");if(!this._trackExternalErrors&&info[EventKeyName.SOURCE]!==ERROR_SOURCE_PLAYER){return;}var trackingInterval=this._channel.request(TrackingTimer.TRACKING_TIMER_INTERVAL);this._updateQoSInfo();var errorItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_ERROR,playhead);errorItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(errorItem);this._history.updateWith(errorItem);var report=this._reporterHelper.createReportForItem(errorItem,trackingInterval);var reportEntry=report.reportEntries[0];reportEntry.eventData.id(info[EventKeyName.ERROR_ID]);reportEntry.eventData.source(info[EventKeyName.SOURCE]);var eventData={};eventData[EventKeyName.REPORT]=report;this._channel.trigger(new ContextEvent(ContextEvent.CONTEXT_DATA_AVAILABLE,eventData));};Context.prototype._onApiTrackInternalError=function(e){var info=e.data;this.log("#_onApiTrackInternalError("+"source="+info[EventKeyName.SOURCE]+", err_id="+info[EventKeyName.ERROR_ID]+")");this._updateQoSInfo();var errorItem=new TimelineItem(this._assetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_ERROR,0);var trackingInterval=this._channel.request(TrackingTimer.TRACKING_TIMER_INTERVAL);var report=this._reporterHelper.createReportForItem(errorItem,trackingInterval);var reportEntry=report.reportEntries[0];reportEntry.eventData.id(info[EventKeyName.ERROR_ID]);reportEntry.eventData.source(info[EventKeyName.SOURCE]);var eventData={};eventData[EventKeyName.REPORT]=report;this._channel.trigger(new ContextEvent(ContextEvent.CONTEXT_DATA_AVAILABLE,eventData));};Context.prototype._onClockTrackingTick=function(e){if(!this._checkCall("_onClockTrackingTick")){return;}var trackingInterval=e.data[EventKeyName.TIMER_INTERVAL];this.log("#_onClockTrackingTick(interval="+trackingInterval+")");var playhead=this._getPlayhead();if(playhead==null||isNaN(playhead)){return;}var noAdInfoAssetData=new AssetDao(this._assetData);noAdInfoAssetData.adData(null);noAdInfoAssetData.type(this._videoAssetType);this._updateQoSInfo();var activeItem=new TimelineItem(noAdInfoAssetData,this._streamData,this._qosData,EventDao.EVENT_TYPE_ACTIVE,playhead);activeItem.prevItemOfSameType=this._history.getPreviousItemOfSameTypeWith(activeItem);this.log("#_onClockTrackingTick() > Adding the ACTIVE event on the time-line.");this._timeline.addActiveItem(activeItem);this._history.updateWith(activeItem);var report=this._reporterHelper.createReportForQuantum(trackingInterval,false);var eventData={};eventData[EventKeyName.REPORT]=report;this._channel.trigger(new ContextEvent(ContextEvent.CONTEXT_DATA_AVAILABLE,eventData));};Context.prototype._onNetworkCheckStatusComplete=function(e){this._trackExternalErrors=e.data[EventKeyName.TRACK_EXTERNAL_ERRORS];this.log("#_onNetworkCheckStatusComplete(track_ext_err="+this._trackExternalErrors+")");};Context.prototype._installEventListeners=function(){this._channel.on(ApiEvent.API_CONFIG,this._onApiConfig,this);this._channel.on(ApiEvent.API_VIDEO_LOAD,this._onApiVideoLoad,this);this._channel.on(ApiEvent.API_VIDEO_UNLOAD,this._onApiVideoUnload,this);this._channel.on(ApiEvent.API_VIDEO_START,this._onApiVideoStart,this);this._channel.on(ApiEvent.API_VIDEO_COMPLETE,this._onApiVideoComplete,this);this._channel.on(ApiEvent.API_AD_START,this._onApiAdStart,this);this._channel.on(ApiEvent.API_AD_COMPLETE,this._onApiAdComplete,this);this._channel.on(ApiEvent.API_PLAY,this._onApiPlay,this);this._channel.on(ApiEvent.API_PAUSE,this._onApiPause,this);this._channel.on(ApiEvent.API_BUFFER_START,this._onApiBufferStart,this);this._channel.on(ApiEvent.API_SEEK_START,this._onApiSeekStart,this);this._channel.on(ApiEvent.API_SEEK_COMPLETE,this._onApiSeekComplete,this);this._channel.on(ApiEvent.API_CHAPTER_START,this._onApiChapterStart,this);this._channel.on(ApiEvent.API_CHAPTER_COMPLETE,this._onApiChapterComplete,this);this._channel.on(ApiEvent.API_BITRATE_CHANGE,this._onApiBitrateChange,this);this._channel.on(ApiEvent.API_TRACK_ERROR,this._onApiTrackError,this);this._channel.on(ApiEvent.API_TRACK_INTERNAL_ERROR,this._onApiTrackInternalError,this);this._channel.on(ClockEvent.CLOCK_TRACKING_TICK,this._onClockTrackingTick,this);this._channel.on(NetworkEvent.NETWORK_CHECK_STATUS_COMPLETE,this._onNetworkCheckStatusComplete,this);};Context.prototype._uninstallEventListeners=function(){this._channel.off(null,null,this);};Context.prototype._resetInternalState=function(){this.log("#_resetInternalState()");this._isTrackingSessionActive=false;this._isVideoComplete=false;this._videoAssetType=null;this._counters=new Counters();this._history=new History();this._timeline=new Timeline(this);this._streamData=new StreamDao();this._qosData=new QoSDao();this._sessionData=new SessionDao();this._assetData=new AssetDao();this._stashedAdData=null;this._stashedChapterData=null;};function _generateSessionId(){return""+new Date().getTime()+Math.floor(Math.random()*1000000000);}Context.prototype._placeItemOnTimeline=function(timelineItem){this.log("#_placeItemOnTimeline(type="+timelineItem.eventType+")");this._timeline.addItem(timelineItem);this._history.updateWith(timelineItem);};Context.prototype._getPlayhead=function(){var playhead=null;var videoInfo=this._channel.request(HeartbeatPlugin.VIDEO_INFO);if(this._inputDataSanitizer.sanitizeVideoInfo(videoInfo)){playhead=videoInfo.playhead;}return playhead;};Context.prototype._updateQoSInfo=function(){var qosInfo=this._channel.request(HeartbeatPlugin.QOS_INFO);this._qosData.bitrate((qosInfo&&!isNaN(qosInfo.bitrate))?qosInfo.bitrate:0);this._qosData.fps((qosInfo&&!isNaN(qosInfo.fps))?qosInfo.fps:0);this._qosData.droppedFrames((qosInfo&&!isNaN(qosInfo.droppedFrames))?qosInfo.droppedFrames:0);};Context.prototype._checkCall=function(methodName){if(!this._isTrackingSessionActive){this.warn("#"+methodName+"() > No active tracking session.");return false;}if(this._isVideoComplete){this.warn("#"+methodName+"() > The video content already completed.");return false;}return true;};Context.prototype._onInvalidInputData=function(errorInfo){this._channel.trigger(new Event(ERROR,errorInfo));};heartbeat.context.Context=Context;})(core,heartbeat,va,utils);(function(heartbeat){function HeartbeatPluginConfig(trackingServer,jobId){this.quietMode=false;this.trackingServer=trackingServer;this.jobId=jobId;}heartbeat.HeartbeatPluginConfig=HeartbeatPluginConfig;})(heartbeat);(function(heartbeat,core){var EventKeyName=heartbeat.event.EventKeyName;var Radio=core.radio.Radio;var Channel=core.radio.Channel;var CommandQueue=core.radio.CommandQueue;var Command=core.radio.Command;var InputDataSanitizer=core.InputDataSanitizer;var ApiEvent=heartbeat.event.ApiEvent;var ClockEvent=heartbeat.event.ClockEvent;var Clock=heartbeat.clock.Clock;var Network=heartbeat.network.Network;var Context=heartbeat.context.Context;var QuerystringSerializer=heartbeat.model.QuerystringSerializer;var PluginManager=core.plugin.PluginManager;var BasePlugin=core.plugin.BasePlugin;core.extend(HeartbeatPlugin,BasePlugin);var NAME="heartbeat";var ERROR_SOURCE_HEARTBEAT="sourceErrorHeartbeat";var CHANNEL_HEARTBEAT="heartbeat";var PLAYER_PLUGIN="player";var CONFIG_PLUGIN="config";var AA_PLUGIN="adobe-analytics";var STATE_PLUGIN=BasePlugin.STATE_PLUGIN;HeartbeatPlugin.VIDEO_LOAD="video_load";HeartbeatPlugin.VIDEO_UNLOAD="video_unload";HeartbeatPlugin.VIDEO_UNLOADED="video_unloaded";HeartbeatPlugin.VIDEO_START="video_start";HeartbeatPlugin.VIDEO_COMPLETE="video_complete";HeartbeatPlugin.PLAY="play";HeartbeatPlugin.PAUSE="pause";HeartbeatPlugin.AD_START="ad_start";HeartbeatPlugin.AD_COMPLETE="ad_complete";HeartbeatPlugin.BUFFER_START="buffer_start";HeartbeatPlugin.BUFFER_COMPLETE="buffer_complete";HeartbeatPlugin.SEEK_START="seek_start";HeartbeatPlugin.SEEK_COMPLETE="seek_complete";HeartbeatPlugin.CHAPTER_START="chapter_start";HeartbeatPlugin.CHAPTER_COMPLETE="chapter_complete";HeartbeatPlugin.BITRATE_CHANGE="bitrate_change";HeartbeatPlugin.TRACK_ERROR="track_error";HeartbeatPlugin.VIDEO_INFO="video_info";HeartbeatPlugin.AD_BREAK_INFO="ad_break_info";HeartbeatPlugin.AD_INFO="ad_info";HeartbeatPlugin.CHAPTER_INFO="chapter_info";HeartbeatPlugin.QOS_INFO="qos_info";HeartbeatPlugin.RSID="rsid";HeartbeatPlugin.TRACKING_SERVER="tracking_server";HeartbeatPlugin.USE_SSL="use_ssl";HeartbeatPlugin.VISITOR_ID="visitor_id";HeartbeatPlugin.ANALYTICS_VISITOR_ID="analytics_visitor_id";HeartbeatPlugin.MARKETING_CLOUD_VISITOR_ID="marketing_cloud_visitor_id";HeartbeatPlugin.OVP="ovp";HeartbeatPlugin.SDK="sdk";HeartbeatPlugin.CHANNEL="channel";HeartbeatPlugin.PUBLISHER="publisher";function HeartbeatPlugin(){HeartbeatPlugin.__super__.constructor.call(this,NAME);this._radio=new Radio();var channel=this._channel=this._radio.channel(CHANNEL_HEARTBEAT);this._workQueue=new CommandQueue(true);this._inputDataSanitizer=new InputDataSanitizer(this._onInvalidInputData,this);this._clock=null;this._context=null;this._network=null;this._isConfigured=false;this._initSubmodules();channel.on(PluginManager.ERROR,this._onError,this);channel.on(HeartbeatPlugin.VIDEO_UNLOADED,this._onVideoUnloaded,this);channel.reply(HeartbeatPlugin.RSID,function(){return this._pluginManager.request(AA_PLUGIN,HeartbeatPlugin.RSID);},this);channel.reply(HeartbeatPlugin.TRACKING_SERVER,function(){return this._pluginManager.request(AA_PLUGIN,HeartbeatPlugin.TRACKING_SERVER);},this);channel.reply(HeartbeatPlugin.USE_SSL,function(){return this._pluginManager.request(AA_PLUGIN,HeartbeatPlugin.USE_SSL);},this);channel.reply(HeartbeatPlugin.VISITOR_ID,function(){return this._pluginManager.request(AA_PLUGIN,HeartbeatPlugin.VISITOR_ID);},this);channel.reply(HeartbeatPlugin.ANALYTICS_VISITOR_ID,function(){return this._pluginManager.request(AA_PLUGIN,HeartbeatPlugin.ANALYTICS_VISITOR_ID);},this);channel.reply(HeartbeatPlugin.MARKETING_CLOUD_VISITOR_ID,function(){return this._pluginManager.request(AA_PLUGIN,HeartbeatPlugin.MARKETING_CLOUD_VISITOR_ID);},this);channel.reply(HeartbeatPlugin.ERROR_INFO,function(){return this._pluginManager.request(STATE_PLUGIN,HeartbeatPlugin.ERROR_INFO);},this);channel.reply(HeartbeatPlugin.OVP,function(){return this._pluginManager.request(CONFIG_PLUGIN,HeartbeatPlugin.OVP);},this);channel.reply(HeartbeatPlugin.SDK,function(){return this._pluginManager.request(CONFIG_PLUGIN,HeartbeatPlugin.SDK);},this);channel.reply(HeartbeatPlugin.CHANNEL,function(){return this._pluginManager.request(CONFIG_PLUGIN,HeartbeatPlugin.CHANNEL);},this);channel.reply(HeartbeatPlugin.PUBLISHER,function(){return this._pluginManager.request(CONFIG_PLUGIN,HeartbeatPlugin.PUBLISHER);},this);channel.reply(HeartbeatPlugin.VIDEO_INFO,function(){return this._pluginManager.request(PLAYER_PLUGIN,HeartbeatPlugin.VIDEO_INFO);},this);channel.reply(HeartbeatPlugin.AD_BREAK_INFO,function(){return this._pluginManager.request(PLAYER_PLUGIN,HeartbeatPlugin.AD_BREAK_INFO);},this);channel.reply(HeartbeatPlugin.AD_INFO,function(){return this._pluginManager.request(PLAYER_PLUGIN,HeartbeatPlugin.AD_INFO);},this);channel.reply(HeartbeatPlugin.CHAPTER_INFO,function(){return this._pluginManager.request(PLAYER_PLUGIN,HeartbeatPlugin.CHAPTER_INFO);},this);channel.reply(HeartbeatPlugin.QOS_INFO,function(){return this._pluginManager.request(PLAYER_PLUGIN,HeartbeatPlugin.QOS_INFO);},this);}HeartbeatPlugin.prototype.configure=function(config){this.log("#configure({"+", trackingServer="+config.trackingServer+", jobId="+config.jobId+", quietMode="+config.quietMode+"})");var checkStatusServer=config.trackingServer+"/settings/";var eventData={};eventData[EventKeyName.TRACKING_SERVER]=config.trackingServer;eventData[EventKeyName.CHECK_STATUS_SERVER]=checkStatusServer;eventData[EventKeyName.JOB_ID]=config.jobId;eventData[EventKeyName.QUIET_MODE]=config.quietMode;this._enqueueEvent(new ApiEvent(ApiEvent.API_CONFIG,eventData));this._enqueueEvent(new ClockEvent(ClockEvent.CLOCK_CHECK_STATUS_GET_SETTINGS));this._isConfigured=true;};HeartbeatPlugin.prototype.bootstrap=function(pluginManager){HeartbeatPlugin.__super__.bootstrap.call(this,pluginManager);var map=this._eventMap={};map[HeartbeatPlugin.VIDEO_LOAD]=ApiEvent.API_VIDEO_LOAD;map[HeartbeatPlugin.VIDEO_UNLOAD]=ApiEvent.API_VIDEO_UNLOAD;map[HeartbeatPlugin.VIDEO_START]=ApiEvent.API_VIDEO_START;map[HeartbeatPlugin.VIDEO_COMPLETE]=ApiEvent.API_VIDEO_COMPLETE;map[HeartbeatPlugin.PLAY]=ApiEvent.API_PLAY;map[HeartbeatPlugin.PAUSE]=ApiEvent.API_PAUSE;map[HeartbeatPlugin.AD_START]=ApiEvent.API_AD_START;map[HeartbeatPlugin.AD_COMPLETE]=ApiEvent.API_AD_COMPLETE;map[HeartbeatPlugin.BUFFER_START]=ApiEvent.API_BUFFER_START;map[HeartbeatPlugin.SEEK_START]=ApiEvent.API_SEEK_START;map[HeartbeatPlugin.SEEK_COMPLETE]=ApiEvent.API_SEEK_COMPLETE;map[HeartbeatPlugin.CHAPTER_START]=ApiEvent.API_CHAPTER_START;map[HeartbeatPlugin.CHAPTER_COMPLETE]=ApiEvent.API_CHAPTER_COMPLETE;map[HeartbeatPlugin.BITRATE_CHANGE]=ApiEvent.API_BITRATE_CHANGE;map[HeartbeatPlugin.TRACK_ERROR]=ApiEvent.API_TRACK_ERROR;var actions=this._customActions={};actions[HeartbeatPlugin.VIDEO_LOAD]=this._onVideoLoad;actions[HeartbeatPlugin.VIDEO_UNLOAD]=this._onVideoUnload;actions[HeartbeatPlugin.PLAY]=this._onPlay;actions[HeartbeatPlugin.PAUSE]=this._onPause;actions[HeartbeatPlugin.AD_START]=this._onAdStart;actions[HeartbeatPlugin.AD_COMPLETE]=this._onAdComplete;actions[HeartbeatPlugin.BUFFER_START]=this._onBufferStart;actions[HeartbeatPlugin.BUFFER_COMPLETE]=this._onBufferComplete;actions[HeartbeatPlugin.SEEK_START]=this._onSeekStart;actions[HeartbeatPlugin.SEEK_COMPLETE]=this._onSeekComplete;actions[HeartbeatPlugin.TRACK_ERROR]=this._onTrackError;this._pluginManager.on(PLAYER_PLUGIN,Channel.WILDCARD,this._onPlayerEvent,this);this._resetInternalState();};HeartbeatPlugin.prototype.setup=function(){if(this._pluginManager.pluginExists(AA_PLUGIN)){if(this._pluginManager.isPluginInitialized(AA_PLUGIN)){this._completeInitialization();}else{this._pluginManager.on(AA_PLUGIN,BasePlugin.INITIALIZED,this._completeInitialization,this);}}else{this._completeInitialization();}};HeartbeatPlugin.prototype._teardown=function(){this.log("#_teardown()");this._radio.shutdown();this._context.destroy();this._clock.destroy();this._network.destroy();this._workQueue.cancelAllCommands();};HeartbeatPlugin.prototype._onPlayerEvent=function(e){if(!this._canProcess()){return;}var meta=e.type.split(":"),playerEvent=meta[1],playerData=e.data;this.log("#_onPlayerEvent() > Tracking event: "+playerEvent.toUpperCase());this._retriggerEvent(playerEvent,playerData);};HeartbeatPlugin.prototype._retriggerEvent=function(playerEvent,playerData){var apiEvent=this._eventMap[playerEvent],customAction=this._customActions[playerEvent];if(!apiEvent&&(typeof customAction!=="function")){return;}var self=this;var defaultAction=function(data){return self._enqueueEvent(new ApiEvent(apiEvent,data));};if(typeof customAction==="function"){customAction.call(this,defaultAction,playerData);}else{defaultAction(playerData);}};HeartbeatPlugin.prototype._onVideoLoad=function(defaultAction){if(this._isTrackingSessionActive){this._enqueueEvent(new ApiEvent(ApiEvent.API_VIDEO_UNLOAD));}this._resetInternalState();defaultAction();this._isTrackingSessionActive=true;};HeartbeatPlugin.prototype._onVideoUnload=function(defaultAction){defaultAction();this._isTrackingSessionActive=false;};HeartbeatPlugin.prototype._onPlay=function(defaultAction){this._isPaused=false;this._resumePlaybackIfPossible();};HeartbeatPlugin.prototype._onPause=function(defaultAction){defaultAction();this._isPaused=true;};HeartbeatPlugin.prototype._onAdStart=function(defaultAction){defaultAction();this._resumePlaybackIfPossible();};HeartbeatPlugin.prototype._onAdComplete=function(defaultAction){defaultAction();this._resumePlaybackIfPossible();};HeartbeatPlugin.prototype._onBufferStart=function(defaultAction){defaultAction();this._isBuffering=true;};HeartbeatPlugin.prototype._onBufferComplete=function(){this._isBuffering=false;this._resumePlaybackIfPossible();};HeartbeatPlugin.prototype._onSeekStart=function(defaultAction){defaultAction();this._enqueueEvent(new ApiEvent(ApiEvent.API_PAUSE));this._isSeeking=true;};HeartbeatPlugin.prototype._onSeekComplete=function(defaultAction){defaultAction();this._isSeeking=false;this._resumePlaybackIfPossible();};HeartbeatPlugin.prototype._onTrackError=function(defaultAction,info){this.log("#_onTrackError(source="+info[EventKeyName.SOURCE]+", errorId="+info[EventKeyName.ERROR_ID]+").");defaultAction(info);};HeartbeatPlugin.prototype._onError=function(e){var errorInfo=e.data;var eventData={};eventData[EventKeyName.SOURCE]=ERROR_SOURCE_HEARTBEAT;eventData[EventKeyName.ERROR_ID]=errorInfo.message+"|"+errorInfo.details;this._channel.trigger(new ApiEvent(ApiEvent.API_TRACK_INTERNAL_ERROR,eventData));this._trigger(PluginManager.ERROR,e.data);};HeartbeatPlugin.prototype._onVideoUnloaded=function(){this._trigger(HeartbeatPlugin.VIDEO_UNLOADED);};HeartbeatPlugin.prototype._initSubmodules=function(){this._context=new Context(this._channel);this._clock=new Clock(this._channel);this._network=new Network(this._channel,new QuerystringSerializer());};HeartbeatPlugin.prototype._canTrack=function(){if(!this._isConfigured){this.warn("_canTrack() > Unable to track!"+" Is configured: "+this._isConfigured);}return this._isConfigured;};HeartbeatPlugin.prototype._enqueueEvent=function(e){this.log("#_enqueueEvent() : "+e.type);this._workQueue.addCommand(new Command(function(){if(!this._canTrack()){return;}this._channel.trigger(e);},this));};HeartbeatPlugin.prototype._resetInternalState=function(){this._isTrackingSessionActive=false;this._isPaused=false;this._isSeeking=false;this._isBuffering=false;};HeartbeatPlugin.prototype._resumePlaybackIfPossible=function(){if(!this._isPaused&&!this._isSeeking&&!this._isBuffering){this._enqueueEvent(new ApiEvent(ApiEvent.API_PLAY));}};HeartbeatPlugin.prototype._completeInitialization=function(){var errorInfo=this._pluginManager.request(STATE_PLUGIN,BasePlugin.ERROR_INFO);if(errorInfo){this.warn("#_completeInitialization() > Unable to track: in ERROR state.");this._workQueue.cancelAllCommands();return;}this._workQueue.flush();HeartbeatPlugin.__super__.setup.call(this);};heartbeat.HeartbeatPlugin=HeartbeatPlugin;})(heartbeat,core);(function(plugins,core){var BasePlugin=core.plugin.BasePlugin;core.extend(ConfigPlugin,BasePlugin);var NAME="config";function ConfigPlugin(){ConfigPlugin.__super__.constructor.call(this,NAME);this._config=null;var cfgMap={};cfgMap["publisher"]="publisher";cfgMap["channel"]="channel";cfgMap["ovp"]="ovp";cfgMap["sdk"]="sdk";cfgMap["is_primetime"]="__primetime";this._dataResolver=function(key){return(this._config)?this._config[cfgMap[key]]:null;};}ConfigPlugin.prototype.configure=function(configData){this._config=configData;ConfigPlugin.__super__.setup.call(this);};ConfigPlugin.prototype.setup=function(){};plugins.ConfigPlugin=ConfigPlugin;})(plugins,core);(function(plugins,core){var BasePlugin=core.plugin.BasePlugin;var PluginManager=core.plugin.PluginManager;core.extend(StatePlugin,BasePlugin);var NAME="state";function StatePlugin(){StatePlugin.__super__.constructor.call(this,NAME);}StatePlugin.prototype.bootstrap=function(pluginManager){StatePlugin.__super__.bootstrap.call(this,pluginManager);this._pluginManager.on(PluginManager.ALL_PLUGINS,PluginManager.ERROR,this._onError,this);this._dataResolver[BasePlugin.ERROR_INFO]=function(){return(this._isEnabled)?this._errorInfo:null;};};StatePlugin.prototype._onError=function(e){this._errorInfo=e.data;this.warn("#_onError() > "+this._errorInfo.message+": "+this._errorInfo.details);};plugins.StatePlugin=StatePlugin;})(plugins,core);(function(plugins,core,heartbeat){var EventKeyName=heartbeat.event.EventKeyName;var BasePlugin=core.plugin.BasePlugin;var PluginManager=core.plugin.PluginManager;core.extend(PlayerPlugin,BasePlugin);var NAME="player";var ERROR_SOURCE_APPLICATION="sourceErrorExternal";var ERROR_SOURCE_PLAYER="sourceErrorSDK";var HEARTBEAT_PLUGIN="heartbeat";PlayerPlugin.VIDEO_LOAD="video_load";PlayerPlugin.VIDEO_UNLOAD="video_unload";PlayerPlugin.VIDEO_UNLOADED="video_unloaded";PlayerPlugin.VIDEO_START="video_start";PlayerPlugin.VIDEO_COMPLETE="video_complete";PlayerPlugin.PLAY="play";PlayerPlugin.PAUSE="pause";PlayerPlugin.AD_START="ad_start";PlayerPlugin.AD_COMPLETE="ad_complete";PlayerPlugin.BUFFER_START="buffer_start";PlayerPlugin.BUFFER_COMPLETE="buffer_complete";PlayerPlugin.SEEK_START="seek_start";PlayerPlugin.SEEK_COMPLETE="seek_complete";PlayerPlugin.CHAPTER_START="chapter_start";PlayerPlugin.CHAPTER_COMPLETE="chapter_complete";PlayerPlugin.BITRATE_CHANGE="bitrate_change";PlayerPlugin.TRACK_ERROR="track_error";var VIDEO_INFO="video_info";var AD_BREAK_INFO="ad_break_info";var AD_INFO="ad_info";var CHAPTER_INFO="chapter_info";var QOS_INFO="qos_info";function PlayerPlugin(playerDelegate){PlayerPlugin.__super__.constructor.call(this,NAME);this._playerDelegate=playerDelegate;}PlayerPlugin.prototype.setup=function(){this._pluginManager.on(HEARTBEAT_PLUGIN,PlayerPlugin.VIDEO_UNLOADED,this._onVideoUnloaded,this);this._pluginManager.on(PluginManager.ALL_PLUGINS,PluginManager.ERROR,this._onError,this);this._checkPlayerDelegate();var fnMap={};fnMap[VIDEO_INFO]=this._playerDelegate.getVideoInfo;fnMap[AD_INFO]=this._playerDelegate.getAdInfo;fnMap[AD_BREAK_INFO]=this._playerDelegate.getAdBreakInfo;fnMap[CHAPTER_INFO]=this._playerDelegate.getChapterInfo;fnMap[QOS_INFO]=this._playerDelegate.getQoSInfo;this._dataResolver=function(key){return(this._isEnabled)?fnMap[key].call(this._playerDelegate):null;};PlayerPlugin.__super__.setup.call(this);};PlayerPlugin.prototype.trackVideoLoad=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.VIDEO_LOAD);this._trigger(PlayerPlugin.VIDEO_START);};PlayerPlugin.prototype.trackVideoUnload=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.VIDEO_UNLOAD);};PlayerPlugin.prototype.trackPlay=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.PLAY);};PlayerPlugin.prototype.trackPause=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.PAUSE);};PlayerPlugin.prototype.trackBufferStart=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.BUFFER_START);};PlayerPlugin.prototype.trackBufferComplete=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.BUFFER_COMPLETE);};PlayerPlugin.prototype.trackSeekStart=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.SEEK_START);};PlayerPlugin.prototype.trackSeekComplete=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.SEEK_COMPLETE);};PlayerPlugin.prototype.trackComplete=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.VIDEO_COMPLETE);};PlayerPlugin.prototype.trackChapterStart=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.CHAPTER_START);};PlayerPlugin.prototype.trackChapterComplete=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.CHAPTER_COMPLETE);};PlayerPlugin.prototype.trackAdStart=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.AD_START);};PlayerPlugin.prototype.trackAdComplete=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.AD_COMPLETE);};PlayerPlugin.prototype.trackBitrateChange=function(){if(!this._canProcess()){return;}this._trigger(PlayerPlugin.BITRATE_CHANGE);};PlayerPlugin.prototype.trackVideoPlayerError=function(errorId){var eventData={};eventData[EventKeyName.SOURCE]=ERROR_SOURCE_PLAYER;eventData[EventKeyName.ERROR_ID]=errorId;this._trigger(PlayerPlugin.TRACK_ERROR,eventData);};PlayerPlugin.prototype.trackApplicationError=function(errorId){var eventData={};eventData[EventKeyName.SOURCE]=ERROR_SOURCE_APPLICATION;eventData[EventKeyName.ERROR_ID]=errorId;this._trigger(PlayerPlugin.TRACK_ERROR,eventData);};PlayerPlugin.prototype._onVideoUnloaded=function(e){if(!this._canProcess()){return;}this._playerDelegate.onVideoUnloaded();};PlayerPlugin.prototype._onError=function(e){if(!this._canProcess()){return;}var self=this;window.setTimeout(function(){self._playerDelegate.onError(e.data);},100);};PlayerPlugin.prototype._checkPlayerDelegate=function(){if(!this._playerDelegate){this.error("PlayerDelegate cannot be null.");}if(typeof this._playerDelegate.getVideoInfo!=="function"){this.error("PlayerDelegate must define the getVideoInfo method.");}if(typeof this._playerDelegate.getAdBreakInfo!=="function"){this.error("PlayerDelegate must define the getAdBreakInfo method.");}if(typeof this._playerDelegate.getAdInfo!=="function"){this.error("PlayerDelegate must define the getAdInfo method.");}if(typeof this._playerDelegate.getChapterInfo!=="function"){this.error("PlayerDelegate must define the getChapterInfo method.");}if(typeof this._playerDelegate.getQoSInfo!=="function"){this.error("PlayerDelegate must define the getQoSInfo method.");}};plugins.PlayerPlugin=PlayerPlugin;})(plugins,core,heartbeat);(function(core,va,heartbeat,utils,plugins){var PluginManager=core.plugin.PluginManager;var StatePlugin=plugins.StatePlugin;var ConfigPlugin=plugins.ConfigPlugin;var PlayerPlugin=plugins.PlayerPlugin;var HeartbeatPlugin=heartbeat.HeartbeatPlugin;var HeartbeatPluginConfig=heartbeat.HeartbeatPluginConfig;var PRIMETIME_OVP="primetime";core.mixin(VideoHeartbeat,core.logger);function VideoHeartbeat(playerDelegate,plugins){this.enableLogging("[video-heartbeat::VideoHeartbeat] > ");this._pluginManager=new PluginManager();this._statePlugin=new StatePlugin();this._pluginManager.addPlugin(this._statePlugin);this._configPlugin=new ConfigPlugin();this._pluginManager.addPlugin(this._configPlugin);this._playerPlugin=new PlayerPlugin(playerDelegate);this._pluginManager.addPlugin(this._playerPlugin);this._heartbeatPlugin=new HeartbeatPlugin();this._pluginManager.addPlugin(this._heartbeatPlugin);plugins=plugins||[];for(var i=0;i<plugins.length;i++){this._pluginManager.addPlugin(plugins[i]);}this._pluginManager.setupPlugins();this._isDestroyed=false;this._isConfigured=false;}VideoHeartbeat.prototype.configure=function(configData){if(!configData){this.error("Configuration object cannot be NULL");}core.LOGGING_ENABLED=!!configData.debugLogging;if(configData.__primetime){configData.ovp=PRIMETIME_OVP;}if(configData.__psdkVersion){configData.sdk=configData.__psdkVersion;}this._configPlugin.configure(configData);var heartbeatPluginConfig=new HeartbeatPluginConfig(configData.trackingServer,configData.jobId);heartbeatPluginConfig.quietMode=configData.quietMode;this._heartbeatPlugin.configure(heartbeatPluginConfig);this._isConfigured=true;};VideoHeartbeat.prototype.destroy=function(){if(this._isDestroyed){return;}this._pluginManager.destroy();this._isDestroyed=true;};VideoHeartbeat.prototype.trackVideoLoad=function(){if(!this._isConfigured){this.warn("#trackVideoLoad() > Unable to track: not configured.");return;}if(this._isDestroyed){this.warn("#trackVideoLoad() > Unable to track: instance previously destroyed.");return;}this.log("#trackVideoLoad() > Tracking a VIDEO_LOAD event.");this._playerPlugin.trackVideoLoad();};VideoHeartbeat.prototype.trackVideoUnload=function(){if(!this._checkCall("trackVideoUnload")){return;}this.log("#trackVideoUnload() > Tracking a VIDEO_UNLOAD event.");this._playerPlugin.trackVideoUnload();};VideoHeartbeat.prototype.trackPlay=function(){if(!this._checkCall("trackPlay")){return;}this.log("#trackPlay() > Tracking a PLAY event.");this._playerPlugin.trackPlay();};VideoHeartbeat.prototype.trackPause=function(){if(!this._checkCall("trackPause")){return;}this.log("#trackPause() > Tracking a PAUSE event.");this._playerPlugin.trackPause();};VideoHeartbeat.prototype.trackBufferStart=function(){if(!this._checkCall("trackBufferStart")){return;}this.log("#trackBufferStart() > Tracking a BUFFER_START event.");this._playerPlugin.trackBufferStart();};VideoHeartbeat.prototype.trackBufferComplete=function(){if(!this._checkCall("trackBufferComplete")){return;}this.log("#trackBufferComplete() > Tracking a BUFFER_COMPLETE event.");this._playerPlugin.trackBufferComplete();};VideoHeartbeat.prototype.trackSeekStart=function(){if(!this._checkCall("trackSeekStart")){return;}this.log("#trackSeekStart() > Tracking a SEEK_START event.");this._playerPlugin.trackSeekStart();};VideoHeartbeat.prototype.trackSeekComplete=function(){if(!this._checkCall("trackSeekComplete")){return;}this.log("#trackSeekComplete() > Tracking a SEEK_COMPLETE event.");this._playerPlugin.trackSeekComplete();};VideoHeartbeat.prototype.trackComplete=function(){if(!this._checkCall("trackComplete")){return;}this.log("#trackComplete() > Tracking a COMPLETE event.");this._playerPlugin.trackComplete();};VideoHeartbeat.prototype.trackAdStart=function(){if(!this._checkCall("trackAdStart")){return;}this.log("#trackAdStart() > Tracking an AD_START event.");this._playerPlugin.trackAdStart();};VideoHeartbeat.prototype.trackAdComplete=function(){if(!this._checkCall("trackAdComplete")){return;}this.log("#trackAdComplete() > Tracking an AD_COMPLETE event.");this._playerPlugin.trackAdComplete();};VideoHeartbeat.prototype.trackChapterStart=function(){if(!this._checkCall("trackChapterStart")){return;}this.log("#trackChapterStart() > Tracking a CHAPTER_START event.");this._playerPlugin.trackChapterStart();};VideoHeartbeat.prototype.trackChapterComplete=function(){if(!this._checkCall("trackChapterComplete")){return;}this.log("#trackChapterComplete() > Tracking a CHAPTER_COMPLETE event.");this._playerPlugin.trackChapterComplete();};VideoHeartbeat.prototype.trackBitrateChange=function(){if(!this._checkCall("trackBitrateChange")){return;}this._playerPlugin.trackBitrateChange();};VideoHeartbeat.prototype.trackVideoPlayerError=function(errorId){if(!this._checkCall("trackVideoPlayerError")){return;}this.log("#trackVideoPlayerError(errorId="+errorId+").");this._playerPlugin.trackVideoPlayerError(errorId);};VideoHeartbeat.prototype.trackApplicationError=function(errorId){if(!this._checkCall("trackApplicationError")){return;}this.log("#trackApplicationError(errorId="+errorId+").");this._playerPlugin.trackApplicationError(errorId);};VideoHeartbeat.prototype._checkCall=function(methodName){if(this._errorInfo){this.warn("#"+methodName+"() > Unable to track: in ERROR state. "+"Message: "+this._errorInfo.message+" | Details: "+this._errorInfo.details);return false;}if(!this._isConfigured){this.warn("#"+methodName+"() > Unable to track: not configured.");return false;}if(this._isDestroyed){this.warn("#"+methodName+"() > Unable to track: instance previously destroyed.");return false;}return true;};VideoHeartbeat.prototype._resetInternalState=function(){this.log("#_resetInternalState() : Resetting internal state variables.");this._errorInfo=null;this._isTrackingSessionActive=false;this._isPaused=false;this._isSeeking=false;this._isBuffering=false;};va.VideoHeartbeat=VideoHeartbeat;})(core,va,heartbeat,utils,plugins);global.ADB||(global.ADB={});global.ADB.core||(global.ADB.core=core);global.ADB.va=va;global.ADB.va.plugins=plugins;global.ADB.va.utils=utils;})(this);
/*
 * ************************************************************************
 *
 *  ADOBE CONFIDENTIAL
 *  ___________________
 *
 *   (c) Copyright 2014 Adobe Systems Incorporated
 *   All Rights Reserved.
 *
 *  NOTICE:  All information contained herein is, and remains
 *  the property of Adobe Systems Incorporated and its suppliers,
 *  if any.  The intellectual and technical concepts contained
 *  herein are proprietary to Adobe Systems Incorporated and its
 *  suppliers and may be covered by U.S. and Foreign Patents,
 *  patents in process, and are protected by trade secret or copyright law.
 *  Dissemination of this information or reproduction of this material
 *  is strictly forbidden unless prior written permission is obtained
 *  from Adobe Systems Incorporated.
 * ************************************************************************
 */

/*
 * video heartbeats - v1.4.0 - 2014-09-10
 * Copyright (c) 2014 Adobe Systems, Inc. All Rights Reserved.
 */
 !function(a){!function(a,b,c){"use strict";function d(a){if(d.__super__.constructor.call(this,j),!a){var b="The reference to the player delegate implementation cannot be NULL.";this.error(this+" "+b)}this._appMeasurement=a,this._workQueue=new e(!0,z),this._inputDataSanitizer=new g(this._onInvalidInputData,this)}var e=a.radio.CommandQueue,f=a.radio.Command,g=a.InputDataSanitizer,h=c.md5,i=a.plugin.BasePlugin;a.extend(d,i);var j="adobe-analytics",k="player",l="config",m="video_start",n="ad_start",o="video_info",p="ad_break_info",q="ad_info",r="channel",s="is_primetime",t="rsid",u="tracking_server",v="use_ssl",w="visitor_id",x="analytics_visitor_id",y="marketing_cloud_visitor_id",z=2e3,A="video",B="videoAd",C="ms_s",D="msp_s",E="msa_s",F="mspa_s";d.prototype.bootstrap=function(a){d.__super__.bootstrap.call(this,a),this._pluginManager.on(k,m,this._onPlayerVideoStart,this),this._pluginManager.on(k,n,this._onPlayerAdStart,this);var b={};b[t]="account",b[u]="trackingServer",b[v]="ssl",b[w]="visitorID",b[x]="analyticsVisitorID",b[y]="marketingCloudVisitorID",this._dataResolver=function(a){return this._isEnabled?this._appMeasurement[b[a]]:null},this._prepareAppMeasurement()},d.prototype.setup=function(){},d.prototype._teardown=function(){this._pluginManager.off(k,m,this._onPlayerVideoStart,this),this._pluginManager.off(k,n,this._onPlayerAdStart,this)},d.prototype._onPlayerVideoStart=function(){this._enqueueCall("aa.open",this._executeAdobeAnalyticsOpen)},d.prototype._onPlayerAdStart=function(){this._enqueueCall("aa.openAd",this._executeAdobeAnalyticsOpenAd)},d.prototype._resetAppMeasurementContextData=function(){delete this._appMeasurement.contextData["a.contentType"],delete this._appMeasurement.contextData["a.media.name"],delete this._appMeasurement.contextData["a.media.friendlyName"],delete this._appMeasurement.contextData["a.media.length"],delete this._appMeasurement.contextData["a.media.playerName"],delete this._appMeasurement.contextData["a.media.channel"],delete this._appMeasurement.contextData["a.media.view"],delete this._appMeasurement.contextData["a.media.ad.name"],delete this._appMeasurement.contextData["a.media.ad.friendlyName"],delete this._appMeasurement.contextData["a.media.ad.podFriendlyName"],delete this._appMeasurement.contextData["a.media.ad.length"],delete this._appMeasurement.contextData["a.media.ad.playerName"],delete this._appMeasurement.contextData["a.media.ad.pod"],delete this._appMeasurement.contextData["a.media.ad.podPosition"],delete this._appMeasurement.contextData["a.media.ad.podSecond"],delete this._appMeasurement.contextData["a.media.ad.CPM"],delete this._appMeasurement.contextData["a.media.ad.view"]},d.prototype._enqueueCall=function(a,b,c){this._isInitialized&&this._workQueue.isEmpty()?b.apply(this,c):(this.log("#_enqueueCall() : "+a),this._workQueue.addCommand(new f(b,this,c)))},d.prototype._executeAdobeAnalyticsOpen=function(){if(this._canProcess()){var a=this._pluginManager.request(k,o);this._inputDataSanitizer.sanitizeVideoInfo(a)&&(this.log("#_executeAdobeAnalyticsOpen(id="+a.id+", length="+a.length+", streamType="+a.streamType+", playerName="+a.playerName+")"),this._resetAppMeasurementContextData(),this._appMeasurement.contextData["a.contentType"]=A,this._appMeasurement.contextData["a.media.name"]=a.id,this._appMeasurement.contextData["a.media.friendlyName"]=a.name||"",this._appMeasurement.contextData["a.media.length"]=Math.floor(a.length)||"0.0",this._appMeasurement.contextData["a.media.playerName"]=a.playerName,this._appMeasurement.contextData["a.media.channel"]=this._pluginManager.request(l,r),this._appMeasurement.contextData["a.media.view"]=!0,this._appMeasurement.pev3=A,this._appMeasurement.pe=this._pluginManager.request(l,s)?D:C,this._appMeasurement.track())}},d.prototype._executeAdobeAnalyticsOpenAd=function(){if(this._canProcess()){var a=this._pluginManager.request(k,o);if(this._inputDataSanitizer.sanitizeVideoInfo(a)){var b=this._pluginManager.request(k,p);if(this._inputDataSanitizer.sanitizeAdBreakInfo(b)){var c=this._pluginManager.request(k,q);if(this._inputDataSanitizer.sanitizeAdInfo(c)){var d=h(a.id)+"_"+b.position;this.log("#_executeAdobeAnalyticsOpenAd(id="+c.id+", length="+c.length+", playerName="+b.playerName+", parentId="+a.id+", podId="+d+", parentPodPosition="+c.position+", podSecond="+b.startTime+", cpm="+c.cpm+")"),this._resetAppMeasurementContextData(),this._appMeasurement.contextData["a.contentType"]=B,this._appMeasurement.contextData["a.media.name"]=a.id,this._appMeasurement.contextData["a.media.channel"]=this._pluginManager.request(l,r),this._appMeasurement.contextData["a.media.ad.name"]=c.id,this._appMeasurement.contextData["a.media.ad.friendlyName"]=c.name||"",this._appMeasurement.contextData["a.media.ad.podFriendlyName"]=b.name||"",this._appMeasurement.contextData["a.media.ad.length"]=Math.floor(c.length)||"0.0",this._appMeasurement.contextData["a.media.ad.playerName"]=b.playerName,this._appMeasurement.contextData["a.media.ad.pod"]=d,this._appMeasurement.contextData["a.media.ad.podPosition"]=Math.floor(c.position)||"0.0",this._appMeasurement.contextData["a.media.ad.podSecond"]=Math.floor(b.startTime)||"0.0",this._appMeasurement.contextData["a.media.ad.CPM"]=c.cpm,this._appMeasurement.contextData["a.media.ad.view"]=!0,this._appMeasurement.pev3=B,this._appMeasurement.pe=this._pluginManager.request(l,s)?F:E,this._appMeasurement.track()}}}}},d.prototype._prepareAppMeasurement=function(){this._appMeasurement.isReadyToTrack()?this._onAppMeasurementReady():this._appMeasurement.callbackWhenReadyToTrack(this,this._onAppMeasurementReady)},d.prototype._onAppMeasurementReady=function(){return this._pluginManager.request(i.STATE_PLUGIN,i.ERROR_INFO)?(this.log("#_onAppMeasurementReady() > Unable to track: in ERROR state."),void this._workQueue.cancelAllCommands()):(this._workQueue.resume(),void d.__super__.setup.call(this))},b.AdobeAnalyticsPlugin=d}(a.ADB.core,a.ADB.va.plugins,a.ADB.va.utils)}(this);
function addLinkTrackVars(a){var b=s_linkTrackVars;if("string"!=typeof a&&"undefined"!=typeof a.length)for(x=0;x<a.length;x++)b=0===a[x].indexOf("wb.")?b+",contextData."+a[x]:b+","+a[x];else"string"==typeof a&&(b=0===a.indexOf("wb.")?b+",contextData."+a:b+","+a);s_linkTrackVars=b.replace(/^,/,""),s_md.linkTrackVars=s_linkTrackVars}function remLinkTrackVars(a){var b,c=s_linkTrackVars;if("string"!=typeof a&&"undefined"!=typeof a.length)for(x=0;x<a.length;x++)b=0===a[x].indexOf("wb.")?new RegExp("([ ]+)?contextData."+a[x]+"([ ]+)?,?([ ]+)?","g"):new RegExp("([ ]+)?"+a[x]+"([ ]+)?,?([ ]+)?","g"),c=c.replace(b,"");else"string"==typeof a&&(b=0===a.indexOf("wb.")?new RegExp("([ ]+)?contextData."+a+"([ ]+)?,?([ ]+)?","g"):new RegExp("([ ]+)?"+a+"([ ]+)?,?([ ]+)?","g"),c=c.replace(b,""));s_linkTrackVars=c.replace(/,$/,""),s_md.linkTrackVars=s_linkTrackVars}function wmdSetContext(a,b){a&&(a=a.replace(/[^A-Za-z0-9\.]/g,"").toLowerCase(),s_md.contextData[a]=b)}function wmdRemContext(a){a&&(a=a.replace(/[^A-Za-z0-9\.]/g,"").toLowerCase(),delete s_md.contextData[a])}function pushContextClr(a){contextClrArr.push(a)}function contextClr(a){for(x=0;x<contextClrArr.length;x++)delete s_md.contextData[contextClrArr[x]]}function s_md_doPlugins(a){s_md.pageName||(s_md.pageName=location.protocol+"//"+location.host+location.pathname)}function getResponsiveWidthMetric(){var a=window.innerWidth?parseInt(window.innerWidth):parseInt(document.getElementsByTagName("body")[0].parentNode.offsetWidth);switch(!0){case a<768:return"320-767";case a>767&&a<1024:return"768-1023";case a>1023&&a<1280:return"1024-1279";case a>=1280:return"1280-greater"}return null}function _clean(a){return a=a.toLowerCase()}function _urlClean(a){return a=a.toLowerCase(),a=a.split("https://www.").join(""),a=a.split("http://www.").join(""),a=a.split("https://").join(""),a=a.split("http://").join(""),a=a.split("www.").join(""),a=a.split(".html").join(""),a=a.split(".htm").join(""),a=a.split(".aspx").join(""),a=a.split(".asp").join(""),a=a.split("default").join(""),a=a.split(" ").join("-")}function wmdTrack(a,b){typeof this.innerHTML!=_ud?ctrs(a,this):ctrs(a,b)}function ctr(a){var b=new Date,c=new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds()+20),d=a;try{d=s_md.pageName.split("_").join("-")+"_"+a+"|"+s_query}catch(e){}d=d.toLowerCase(),document.cookie="ctr="+d+"; path=/; domain="+s_domain+";expires="+c.toGMTString()}function ctrs(a,b){var c=new Date,d=new Date(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds()+20),e=a;try{e=s_md.pageName.split("_").join("-")+"_"+a}catch(f){}e=e.toLowerCase(),document.cookie="ctr="+e+"; path=/; domain="+s_domain+";expires="+d.toGMTString(),typeof b!=_ud&&typeof b.innerHTML!=_ud&&""!==b.innerHTML&&(document.cookie="ltxt="+b.innerHTML.replace(/<[^>]+>/g,"").replace(/&\S+\;/g,"").replace(/[^\w\s]/g,"").replace(/\s+/g," ").toLowerCase()+"; path=/; domain="+s_domain+";expires="+d.toGMTString())}function wmdSearchTrack(a){ctr(a)}function wmdTrackerMarker(a,b){typeof a!=_ud&&""!==a&&(s_md.contextData["wb.tm"]=a,s_md.linkTrackVars="contextData.wb.tm,"+s_md.linkTrackVars),typeof b!=_ud&&""!==b&&(s_md.contextData["wb.clkurl"]=b,s_md.linkTrackVars="contextData.wb.clkurl,"+s_md.linkTrackVars),(typeof a!=_ud&&""!==a||typeof b!=_ud&&""!==b)&&void s_md.tl(!0,"o"),s_md.linkTrackVars=s_md.linkTrackVars.replace("contextData.wb.tm,","").replace("contextData.wb.clkurl,",""),delete s_md.contextData["wb.tm"],delete s_md.contextData["wb.clkurl"]}function wmdPageLink(a,b){var c;c=s_gi(s_account),c.linkTrackVars=s_linkTrackVars+",prop20,prop21",c.prop21=typeof s_query!=_ud&&""!==s_query?s_query.toLowerCase():"",typeof c.prop15!=_ud&&""!==c.prop15||(c.prop15=typeof s_sponsor_program!=_ud&&""!==s_sponsor_program&&typeof a!=_ud&&""!==a?s_sponsor_program.toLowerCase()+"_"+a:""),a=c.pageName.split("_").join("-")+"_"+a;try{c.prop20=trun20(a)}catch(d){}typeof this.innerHTML!=_ud?c.contextData["wb.lnktxt"]=this.innerHTML.replace(/<[^>]+>/g,"").replace(/&\S+\;/g,"").replace(/[^\w\s]/g,"").replace(/\s+/g," ").toLowerCase():typeof b!=_ud&&typeof b.innerHTML!=_ud&&(c.contextData["wb.lnktxt"]=b.innerHTML.replace(/<[^>]+>/g,"").replace(/&\S+\;/g,"").replace(/[^\w\s]/g,"").replace(/\s+/g," ").toLowerCase()),void c.tl(!0,"o",a.toLowerCase()),c.prop15="","undefined"!=typeof c.contextData["wb.lnktxt"]&&delete c.contextData["wb.lnktxt"],c.linkTrackVars=s_linkTrackVars}function wmdPageview(a,b){var c;c=s_gi(s_account),c.prop9=b,"y"==s_pageview_sent&&(c.prop43="",c.prop20="");try{a=_urlClean(a)}catch(d){}""!==a&&(c.pageName=a,c.eVar1=a);var e="";try{if(e=String(_readC("ctr")),prop29LastPg=String(_readC("prop29")).toLowerCase(),e&&e!=_ud){var f=new Date;document.cookie="ctr=undefined; path=/; domain="+s_domain+";expires="+f.toGMTString(),document.cookie="prop29=undefined; path=/; domain="+s_domain+";expires="+f.toGMTString();var g,h=e.split("|"),i=h[0],j=(h[1],i.indexOf("_"));j>0&&(g=i.substr(j+1)),typeof c.prop15!=_ud&&""!==c.prop15||(c.prop15=typeof prop29LastPg!=_ud&&""!==prop29LastPg&&typeof g!=_ud&&""!==g?prop29LastPg+"_"+g:"");try{c.prop20=trun20(i).toLowerCase(),c.eVar20=c.prop20}catch(d){}var k=c.prop20,l=k.split("_");l.length<2&&(k+="_"),l.length<3&&(k+="_"),l=k.split("_");try{mboxUpdate("ProfMbox","page="+a,"m13="+l[1],"m14="+l[1]+"_"+l[2],"m15="+l[0]+"_"+l[1])}catch(d){}}var m=String(_readC("ltxt"));m&&m!=_ud&&(c.contextData["wb.lnktxt"]=m)}catch(d){}try{mboxLoadSCPlugin(c)}catch(d){}try{c.prop24=s_pageview_id}catch(d){}s_pageview_sent="y",void c.t(),"undefined"!=typeof c.contextData["wb.lnktxt"]&&delete c.contextData["wb.lnktxt"]}function wmdPageLinkIframe(a){var b;b=window.parent.s_gi(window.parent.s_account),b.linkTrackVars=window.top.s_linkTrackVars;try{b.prop18=a}catch(c){}a=window.parent.s_md.pageName.split("_").join("-")+"_"+a;try{b.prop20=trun20(a)}catch(c){}typeof this.innerHTML!=_ud?b.contextData["wb.lnktxt"]=this.innerHTML.replace(/<[^>]+>/g,"").replace(/&\S+\;/g,"").replace(/[^\w\s]/g,"").replace(/\s+/g," ").toLowerCase():typeof domElem!=_ud&&typeof domElem.innerHTML!=_ud&&(b.contextData["wb.lnktxt"]=domElem.innerHTML.replace(/<[^>]+>/g,"").replace(/&\S+\;/g,"").replace(/[^\w\s]/g,"").replace(/\s+/g," ").toLowerCase()),void window.parent.s_md.tl(!0,"o",a.toLowerCase())}function wmdPageviewIframe(a,b){var c;c=window.parent.s_gi(window.parent.s_account),c.prop20="",c.prop9=b;try{a=_urlClean(a)}catch(d){}""!==a&&(c.pageName=a),void window.parent.s_md.t()}function wmdTrackLink(a){trun20(ctrs(s_md.pageName+"_"+a))}function trun20(a){try{if(typeof a==_ud||""===a)return;if(!(a.length>100))return a;var b=a.split("_");if(b.length<2)return a;var c=b[0].length>73?b[0].substring(0,72):b[0],d=b[1].length>20?b[1].substring(0,19):b[1];if(2==b.length)return c+"_"+d;if(3==b.length)return c+"_"+d+"_"+b[2];if(4==b.length)return c+"_"+d+"_"+b[2]+"_"+b[3]}catch(e){return a}}function _readC(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return""}function _writeC(a,b){date=new Date(3e3,1,1,0,0,0),document.cookie=a+"="+escape(b)+"; expires="+date.toGMTString()}function sCookie(a,b){document.cookie=a+"="+b.toLowerCase()+"; path=/; domain="+s_domain+";expires="}function _readQ(a){var b=a.toLowerCase()+"=";if(document.URL.indexOf("?")==-1)return"";for(var c=document.URL.split("?"),d=String(c[1]).toLowerCase().split("&"),e=0;e<d.length;e++){for(var f=d[e];" "==f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(b))return f.substring(b.length,f.length)}return""}function _readRefQ(a){var b=a.toLowerCase()+"=";if(document.referrer.indexOf("?")==-1)return"";for(var c=document.referrer.split("?"),d=String(c[1]).toLowerCase().split("&"),e=0;e<d.length;e++){for(var f=d[e];" "==f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(b))return f.substring(b.length,f.length)}return""}function setProp50(){var a=window.s_site,b="webmdp1medscapevista";switch(a){case"imedicine":b="webmdp1imedicinevista";break;case"connect":b="webmdconnect"}return b}var s_ver="medscape|20160908",s_live=!1,_ud="undefined",contextClrArr=[];try{"webmddev"==s_account?s_live=!1:document.domain.indexOf("staging")!==-1||document.domain.indexOf("proddev")!==-1?(s_account="webmddev",s_live=!1):(s_account="webmdp1global",s_live=!0)}catch(e){var s_account="webmdp1global";s_live=!0}var _src=_readQ("src");""!==_src&&(_src=_src.toLowerCase());var s_md=s_gi(s_account);_dom=document.domain.split(".");var s_domain=_dom[_dom.length-2]+"."+_dom[_dom.length-1];if(s_md.cookieDomainPeriods="3",s_md.jsCookieDomainPeriods="2",s_md.charSet="ISO-8859-1",s_md.currencyCode="USD",s_md.trackDownloadLinks=!0,s_md.trackExternalLinks=!0,s_md.trackInlineStats=!0,s_md.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,doc,pdf,xls",s_md.linkInternalFilters="javascript:,.medscape.com,.medscape.org",s_md.linkLeaveQueryString=!1,"string"==typeof s_linkTrackVars)var linkTrackVarsDef=s_linkTrackVars;else var linkTrackVarsDef="prop3,prop19,prop29,prop30,prop37,prop38,prop47,prop48,prop50,contextData.wb.lnktxt,contextData.wb.chn,contextData.wb.contype,contextData.wb.toolin,contextData.wb.dprofsn,contextData.wb.dcntry,contextData.wb.dspclty,contextData.wb.sact,contextData.wb.sprod,contextData.wb.site,contextData.wb.regid,contextData.wb.rs,contextData.wb.vdname,contextData.wb.audioflg,contextData.wb.rspd,contextData.wb.brkpt",s_linkTrackVars=linkTrackVarsDef;if(s_md.linkTrackVars=s_linkTrackVars,s_md.linkTrackEvents="None",s_md.visitorNamespace="webmd",s_md.usePlugins=!0,function(){var a,b;if(window.s_context)for(a in window.s_context)b=window.s_context[a],wmdSetContext(a,b)}(),s_md.doPlugins=s_md_doPlugins,s_md.c_gd=new Function("var s=this,d=s.wd.location.hostname,n=s.jsCookieDomainPeriods,n2=s.cookieDomainPeriods,p;if(d&&!s.c_d){n=n?n:n2;n=n?parseInt(n):2;n=n>2?n:2;p=d.lastIndexOf('.');while(p>=0&&n>1){p=d.lastIndexOf('.',p-1);n--}s.c_d=p>0&&s.pt(d,'.','c_gdf',0)?d.substring(p):'';}return s.c_d"),s_md.trackGAS=new Function("var s_md=this,gifa=document.getElementsByTagName('iframe'),gif;for(var i=0;i<gifa.length;i++){if(gifa[i].src.indexOf('googlesyndication.com')>-1){gif=gifa[i];if(gif.attachEvent){gif.attachEvent('onfocus',s_md.gasf);}}}"),s_md.gasf=new Function("var s_md=s_gi(s_account);s_md.prop36=s_md.pageName;s.tl(true,'o','Google Exit Link');"),s_md.trackGAS(),typeof s_site==_ud||""===s_site){var s_site="medscape",s_subdomain="";typeof _dom!=_ud&&_dom.length>=2&&("imedicine"==_dom[1]||"imedicine"==_dom[0]?(s_site="imedicine",s_subdomain="imedicine"):("emedicine"==_dom[0]||"reference"==_dom[0]?s_site="emedicine":0===window.location.pathname.indexOf("/consult")&&(s_site="mscp"),s_subdomain=_dom[0],s_domain.indexOf("medscape.org")>=0&&(s_site="cme",s_subdomain="www")))}else{var s_subdomain="";typeof _dom!=_ud&&_dom.length>=2&&(s_subdomain="imedicine"==s_site?"imedicine":"cme"==s_site?"www":_dom[0])}"cme"==s_site||("login"==s_subdomain||"profreg"==s_subdomain||"search"==s_subdomain)&&document.referrer.indexOf("medscape.org")!==-1?wmdSetContext("wb.chn","education"):"emedicine"!=s_site&&("login"!=s_subdomain&&"profreg"!=s_subdomain&&"search"!=s_subdomain||""===document.referrer||document.referrer.split("/")[2].indexOf("reference.")===-1&&document.referrer.split("/")[2].indexOf("emedicine.")===-1)?"mscp"==s_site?wmdSetContext("wb.chn","consult"):null!==document.domain.match(/(www|espanol|francais|deutsch|portugues).+medscape\.com/)||"blogs"==s_subdomain||"boards"==s_subdomain||("login"==s_subdomain||"profreg"==s_subdomain||"search"==s_subdomain)&&""!==document.referrer&&null!==document.referrer.split("/")[2].match(/(www|espanol|francais|deutsch|portugues).+medscape\.com/)?wmdSetContext("wb.chn","news"):"search"==s_subdomain&&""!==document.referrer&&document.referrer.split("/")[2].indexOf("search.")!==-1||wmdSetContext("wb.chn","other"):wmdSetContext("wb.chn","reference"),"undefined"!=typeof DFPTargetKeys&&"0"!==DFPTargetKeys.pageSegVars.pub&&wmdSetContext("wb.ppub",DFPTargetKeys.pageSegVars.pub),"undefined"!=typeof s_responsive_design&&s_responsive_design===!0&&null!==getResponsiveWidthMetric()&&(wmdSetContext("wb.rspd","rdesign-yes"),wmdSetContext("wb.brkpt",getResponsiveWidthMetric()));var _URL="";try{_URL=s_pagename}catch(e){}""===_URL&&(_URL1=String(document.location).split("?"),_URL2=_URL1[0].split(";"),_URL=_URL2[0]),_URL=_urlClean(_URL);var _asset=_URL.substr(_URL.indexOf("/")+1);if(_asset=String(_clean(_asset)),typeof s_query==_ud){var s_query="",s_filter="";if(!s_query&&(""!==_readQ("querytext")?s_query=_readQ("querytext"):null!==document.domain.match("search")&&""!==_readQ("q")&&(s_query=_readQ("q")),""!==s_query&&(s_filter=s_query),typeof s_pagenum==_ud))var s_pagenum="1"}try{_readQ("pagenumber")>1?s_pagenum=_readQ("pagenumber"):null!==document.domain.match("search")&&_readQ("page")>1&&(s_pagenum=_readQ("page"))}catch(e){}var _prop47fromPage="";if(!s_user_origin)var s_user_origin="";if("us"==s_user_origin.toLowerCase())try{_prop47fromPage="physician"==s_user_group.toLowerCase()?"us-physician":"us-other"}catch(e){}else try{_prop47fromPage="physician"==s_user_group.toLowerCase()?"non-us-physician":"non-us-other"}catch(e){}s_md.eVar4=_prop47fromPage;var s_hier1_subsite="-";if(typeof s_mobileweb!=_ud&&"yes"==s_mobileweb?(s_md.prop48="mbl-yes",s_hier1_subsite="mobile"):s_md.prop48="mbl-no","connect"==s_site?s_md.hier1="webmd,cns,ooc,"+s_site+","+s_hier1_subsite:s_md.hier1="webmd,pro,oop,"+s_site+","+s_hier1_subsite,s_md.hier2="pro,"+s_subdomain+",medscape,-","cme"==s_site&&(s_md.hier2="pro,cme,medscape,-"),s_md.prop50=setProp50(),wmdSetContext("wb.rs",s_md.prop50),"connect"==s_site){var uPermC=String(_readC("WBMD_PERM"));s_md.prop41="consumer-unregistered",wmdSetContext("wb.registered","consumer-unregistered"),typeof uPermC!=_ud&&""!==uPermC&&(s_md.prop41="consumer-full",wmdSetContext("wb.registered","consumer-full"))}var s_pageview_sent="n";try{if(s_not_pageview)"n"!=s_not_pageview&&(s_not_pageview="y");else var s_not_pageview="n"}catch(e){var s_not_pageview="n"}if(!s_print){if("true"==_readQ("prt"))var s_print=1;if(_URL.indexOf("_print")>0)var s_print=1}var s_errAs="",s_eUrl="",s_eRef="";try{s_error||(s_error="")}catch(e){s_error=""}try{s_pageType&&(s_error=s_pageType)}catch(e){s_pageType=""}try{if(""!==s_error){_rf=document.location.href;var _qrypos=_rf.indexOf("?")}if(""===s_error){_rf1=document.location.href;var _qrypos1=_rf1.indexOf("ReqURL=");_qrypos1>=0&&(_qrypos>=0&&(_qry=_rf.substring(_qrypos+1),_rf=_qry.split("ourl=").join(""),_er=_rf.split("&referer="),s_eUrl=_er[0],s_eRef=_er[1]),_qry1=_rf1.substring(_qrypos1+7),_er1=_qry1.split("&referer="),s_error="errorPage",s_eUrl="404;http://"+document.domain+_er1[0])}if(s_eUrl){s_errAs=s_eUrl.split("://").join("");var _len=s_errAs.indexOf("/");s_errAs=s_errAs.substring(_len,s_errAs.length),s_errAs=_urlClean(s_errAs).substr(1)}}catch(e){s_error=""}if("n"==s_not_pageview){var sCtrRead="";try{if(sCtrRead=String(_readC("ctr")),prop29LastPg=String(_readC("prop29")).toLowerCase(),sCtrRead&&sCtrRead!=_ud){var _dtDel=new Date;document.cookie="ctr=undefined; path=/; domain="+s_domain+";expires="+_dtDel.toGMTString(),document.cookie="prop29=undefined; path=/; domain="+s_domain+";expires="+_dtDel.toGMTString();var _CtrRead=sCtrRead.split("|"),s_ctr_loc=_CtrRead[0],s_ctr_query=_CtrRead[1],_pos=s_ctr_loc.indexOf("_");if(_pos>0)var s_ml=s_ctr_loc.substr(_pos+1)}var sLtxtRead=String(_readC("ltxt"));sLtxtRead&&sLtxtRead!=_ud&&(s_md.contextData["wb.lnktxt"]=sLtxtRead),pushContextClr("wb.lnktxt")}catch(e){}}s_md.events="event5",s_md.pageName=_URL;try{"connect"==s_site?s_md.prop1="cns":s_md.prop1="pro"}catch(e){}try{"connect"==s_site?s_md.prop2="ooc":s_md.prop2="oop"}catch(e){}try{s_md.prop3=s_site.toLowerCase(),wmdSetContext("wb.site",s_site.toLowerCase())}catch(e){}try{s_md.prop4=s_channel,s_md.channel=s_channel}catch(e){}try{s_md.prop5=s_asset_type.toLowerCase()}catch(e){}try{s_md.prop6=typeof s_asset_class!=_ud&&""!==s_asset_class?s_asset_class.toLowerCase():s_business_reference.toLowerCase()}catch(e){}try{s_md.prop7=_asset.toLowerCase()}catch(e){}try{s_md.prop8=s_pub.toLowerCase()}catch(e){s_md.prop8="-"}try{s_md.prop9=s_pagenum}catch(e){}try{s_md.eVar1=s_md.pageName}catch(e){}try{s_md.prop10=s_query.toLowerCase(),s_md.eVar10=s_md.prop10}catch(e){}try{s_md.prop11=s_filter}catch(e){}try{s_md.prop12=s_results.toLowerCase()}catch(e){}try{s_md.prop15=_src.indexOf("rss")>=0?"rss":""}catch(e){}try{s_md.prop16=s_test1.toLowerCase()}catch(e){}try{s_md.prop19=s_user_group.toLowerCase(),wmdSetContext("wb.dprofsn",s_user_group.toLowerCase())}catch(e){s_md.prop19="ntc"}try{s_md.prop20=trun20(s_ctr_loc).toLowerCase(),s_md.eVar20=s_md.prop20}catch(e){}try{null!==document.referrer.split(".")[0].match("search")&&""!==_readRefQ("q")?s_md.prop21=_readRefQ("q"):s_md.prop21=_readRefQ("queryText")}catch(e){}try{s_md.prop23=s_board.toLowerCase()}catch(e){}try{""!==s_error&&(s_md.pageType="errorPage",s_eUrl&&(s_md.pageName=s_eUrl,s_md.prop7=s_errAs,s_md.pageURL=s_eUrl))}catch(e){}try{s_md.prop25=s_test2.toLowerCase()}catch(e){}try{s_md.prop28=s_sponsor_brand.toLowerCase()}catch(e){s_md.prop28="ntc"}try{s_md.prop29=s_sponsor_program.toLowerCase()}catch(e){s_md.prop29="ntc"}try{s_md.prop30=s_package_type.toLowerCase()}catch(e){s_md.prop30="ntc"}try{s_md.prop31=s_package.toLowerCase()}catch(e){s_md.prop31="ntc"}try{s_md.prop35=s_board_group.toLowerCase()}catch(e){}try{s_md.prop36=s_board_topic.toLowerCase()}catch(e){}try{s_md.prop37=s_user_origin.toLowerCase(),wmdSetContext("wb.dcntry",s_user_origin.toLowerCase())}catch(e){}try{s_md.prop38=s_user_specialty.toLowerCase(),wmdSetContext("wb.dspclty",s_user_specialty.toLowerCase())}catch(e){}try{s_md.prop39=s_board_clinical.toLowerCase()}catch(e){}if("connect"==s_site){var qecd=_readQ("ECD");if(""===qecd&&(qecd=_readQ("ecd")),""!==qecd){var vendor=_readQ("v"),publisher=_readQ("p");""!==vendor&&(vendor=vendor.split("_").join("-"),qecd=0===qecd.lastIndexOf("_")?qecd+vendor:qecd+"_"+vendor),""!==publisher&&(publisher=publisher.split("_").join("-"),qecd+="_"+publisher),qecd=qecd.toLowerCase(),qecd=qecd.split("__").join("_").split("%20").join("-"),s_md.prop43=qecd,wmdSetContext("wb.ecd",qecd)}}""!==_src&&(_src=_src.toLowerCase(),sCookie("src",_src),s_md.prop43=_src,wmdSetContext("wb.ecd",_src),s_md.eVar43=_src,s_md.campaign=_src);try{s_md.eVar0=s_md.prop43}catch(e){}try{s_md.prop47=s_registered_user_id.toLowerCase(),wmdSetContext("wb.regid",s_registered_user_id.toLowerCase())}catch(e){s_md.prop47="000000000",wmdSetContext("wb.regid","000000000")}try{s_md.prop24=s_pageview_id}catch(e){}try{s_md.server=s_ver.toLowerCase()}catch(e){}if(typeof Visitor!=_ud&&(s_md.visitor=Visitor.getInstance("16AD4362526701720A490D45@AdobeOrg")),s_md.trackingServer="std.o.webmd.com",s_md.trackingServerSecure="ssl.o.webmd.com",s_md.dc="122","n"==s_not_pageview){try{mboxLoadSCPlugin(s_md)}catch(e){}s_pageview_sent="y";var s_code=s_md.t();s_code&&document.write(s_code)}"undefined"!=typeof contextClr&&contextClr();
//# sourceMappingURL=sourcemap/bi_medscape_sourcemap.map