/*

 Software License Agreement (BSD License)
 http://taffydb.com
 Copyright (c)
 All rights reserved.


 Redistribution and use of this software in source and binary forms,
 with or without modification, are permitted provided that the following
 condition is met:

 * Redistributions of source code must retain the above copyright notice,
 this list of conditions and the following disclaimer.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
 IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var i,n,s,a,o,r=gap,l=e[t];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(t)),"function"==typeof rep&&(l=rep.call(e,t,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(l)){for(a=l.length,i=0;a>i;i+=1)o[i]=str(i,l)||"null";return s=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+r+"]":"["+o.join(",")+"]",gap=r,s}if(rep&&"object"==typeof rep)for(a=rep.length,i=0;a>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],s=str(n,l),s&&o.push(quote(n)+(gap?": ":":")+s));else for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(s=str(n,l),s&&o.push(quote(n)+(gap?": ":":")+s));return s=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+r+"}":"{"+o.join(",")+"}",gap=r,s}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(t,e,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(t,e){var i,n,s=t[e];if(s&&"object"==typeof s)for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n=walk(s,i),void 0!==n?s[i]=n:delete s[i]);return reviver.call(t,e,s)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("json",function(){}),define("tpointutil",[],function(){"use strict";return{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",loadCss:function(t){if(t&&!(t.indexOf("undefined")>=0)){t+="?_build="+timespointsapp.version();var e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.href=t,document.getElementsByTagName("head")[0].appendChild(e)}},dayFirstTimeStamp:function(){var t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.getTime()},dayLastTimeStamp:function(){var t=new Date;return t.setHours(23),t.setMinutes(59),t.setSeconds(59),t.setMilliseconds(0),t.getTime()},loadLoadingDiv:function(t){$("#"+t).html('<div class="page_loading_indicator" style="z-index: 9999; display: block;"></div>')},openLoginPopUp:function(){var t=timespointsapp.config.getCrossDomainLoginApi()+encodeURIComponent(location.origin+location.pathname+"/secured");location.href=t},getChannelCodeByDomain:function(t){var e="";switch(t){case"localhost":case"test.timespoint.com":case"www.timespoints.com":case"timespoints.com":e=pName;break;default:e=timespointsapp.config.getCurrentChannelCodeFromDomainMapping(t)}return e},getSubChannelCodeByDomain:function(t){var e="";switch(t){case"localhost":case"test.timespoint.com":case"www.timespoints.com":case"timespoints.com":e="News";break;default:e=timespointsapp.config.getCurrentSubChannelFromDomainMapping(t)}return e},getLoginMethodByDomainName:function(t){return timespointsapp.config.getCurrentChannelLoginMethodFromDomainMapping(t)},getNextStatusLevel:function(t){var e=new Object;return 250>t?(e.points=250-t,e.status="Silver"):5e3>t?(e.points=5e3-t,e.status="Gold"):24999>t?(e.points=24999-t,e.status="Platinum"):249999>t&&(e.points=249999-t,e.status="Diamond"),e},getChannelSpecificKey:function(){return timespointsapp.channelCode+"_"+timespointsapp.siteCode},getChannelSpecificData:function(t){var e=new Object;return e.c_sc=this.getChannelSpecificKey(),e.data=t,e},sortResults:function(t,e,i){return t.sort(function(t,n){return i?t[e]>n[e]?1:t[e]<n[e]?-1:0:n[e]>t[e]?1:n[e]<t[e]?-1:0})},filterArray:function(t,e){return t?$.grep(t,function(t){var i={};for(var n in e)if(i[n]=!1,"object"==typeof e[n]){var s=e[n],a=Object.keys(s),o=a[0];"lte"===o?i[n]=parseInt(t[n])<=parseInt(s[o]):"gte"===o?i[n]=parseInt(t[n])>=parseInt(s[o]):"lt"==o?i[n]=parseInt(t[n])<parseInt(s[o]):"gt"==o?i[n]=parseInt(t[n])>parseInt(s[o]):"ne"==o&&(i[n]=t[n]!==s[o])}else i[n]=t[n]===e[n];var r=$.map(i,function(t,e){return t});return r.indexOf(!1)<0}):[]},encodeToBase64:function(t){var e,i,n,s,a,o,r,l="",c=0;for(t=this._utf8_encode(t);c<t.length;)e=t.charCodeAt(c++),i=t.charCodeAt(c++),n=t.charCodeAt(c++),s=e>>2,a=(3&e)<<4|i>>4,o=(15&i)<<2|n>>6,r=63&n,isNaN(i)?o=r=64:isNaN(n)&&(r=64),l=l+this._keyStr.charAt(s)+this._keyStr.charAt(a)+this._keyStr.charAt(o)+this._keyStr.charAt(r);return l},_utf8_encode:function(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var n=t.charCodeAt(i);128>n?e+=String.fromCharCode(n):n>127&&2048>n?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e},trunc:function(t,e,i){if(void 0==t)return"";var n=t.length>e,s=n?t.substr(0,e-1):t;return s=i&&n?s.substr(0,s.lastIndexOf(" ")):s,n?s+"&hellip;":s},slimify:function(t){return t.replace(/\s+/g," ").trim()},loadDefaultUserImage:function(t){t.removeAttribute("src"),t.setAttribute("class","default-crown"),t.onerror=null},pieChart:function(t,e,i){$(t).each(function(t){var n=(window.devicePixelRatio,"tp_canvas_09"+t+"_Id"),s=0,a=$(this).attr("data-percent");$(this).append("<canvas height='"+i+"px' id='"+n+"' width='"+i+"'></canvas>"),timespointsapp.util.draw(n,-a,s,e)})},draw:function(t,e,i,n){var s=document.getElementById(t),a=s.getContext("2d"),o=s.getContext("2d"),r=s.width/2,l=s.height/2,c=1.5*Math.PI,p=(1.5-i/50)*Math.PI,d=!0;o.clearRect(0,0,s.width,s.height),a.beginPath(),a.arc(r,l,n,c,3.5*Math.PI,!1),a.lineWidth=2,a.strokeStyle="#eee",a.stroke(),o.beginPath(),o.arc(r,l,n,c,p,d),o.lineWidth=1.5,o.strokeStyle="#4ebaff",o.stroke(),e!=i&&(i+=1,requestAnimationFrame(function(){timespointsapp.util.draw(t,e,i,n)}))},setCookie:function(t,e,i){document.cookie=t+"="+e+";expires="+i+";path=/"},getCookie:function(t){var e="; "+document.cookie,i=e.split("; "+t+"=");return 2==i.length?i.pop().split(";").shift():void 0}}});var TAFFY;!function(){"use strict";var t,e,i,n,s,a,o,r,l,c,p,d,h,g,u,m,f,v,y,b,x,C,S,A,D;if(TAFFY)return console.warn(TAFFY),TAFFY;for(o="2.8.1",r=1,l="000000",c=1e3,p={},D=function(t){var e=Array.prototype.slice.call(t);return e.sort()},d=function(t){return TAFFY.isArray(t)||TAFFY.isObject(t)?t:JSON.parse(t)},A=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},S=function(e){var i,n;if(i=t.isArray(e)?[]:t.isObject(e)?{}:null,null===e)return e;for(n in e)e.hasOwnProperty(n)&&(i[n]=A(e[n])?e[n].toString():t.isArray(e[n])||t.isObject(e[n])?S(e[n]):e[n]);return i},C=function(t){var e=JSON.stringify(t);return null===e.match(/regex/)?e:JSON.stringify(S(t))},h=function(e,i,n){var s,a,o,r;if(e&&(t.isArray(e)&&1===e.length||!t.isArray(e)))i(t.isArray(e)?e[0]:e,0);else for(o=0,e=t.isArray(e)?e:[e],r=e.length;r>o&&(a=e[o],t.isUndefined(a)&&!n||(s=i(a,o),s!==t.EXIT));o++);},g=function(e,i){var n,s,a=0;for(s in e)if(e.hasOwnProperty(s)&&(n=i(e[s],s,a++),n===t.EXIT))break},p.extend=function(t,e){p[t]=function(){var t=D(arguments);return e.apply(this,t)}},u=function(e){var i;return t.isString(e)&&/[t][0-9]*[r][0-9]*/i.test(e)?!0:t.isObject(e)&&e.___id&&e.___s?!0:t.isArray(e)?(i=!0,h(e,function(t){return u(t)?void 0:(i=!1,TAFFY.EXIT)}),i):!1},e=function(t,e,i){var n=[];return h(t,function(t,s,a){e.call(i,t,s,a)&&n.push(t)}),n},"function"!=typeof Array.prototype.filter&&(Array.prototype.filter=e),f=function(e,i){var n=!0;return h(i,function(i){switch(t.typeOf(i)){case"function":if(!i.apply(e))return n=!1,TAFFY.EXIT;break;case"array":n=1===i.length?f(e,i[0]):2===i.length?f(e,i[0])||f(e,i[1]):3===i.length?f(e,i[0])||f(e,i[1])||f(e,i[2]):4===i.length?f(e,i[0])||f(e,i[1])||f(e,i[2])||f(e,i[3]):!1,i.length>4&&h(i,function(t){f(e,t)&&(n=!0)})}}),n},m=function(e){var i=[],n=e;return t.isString(n)&&/[t][0-9]*[r][0-9]*/i.test(n)&&(n={___id:n}),t.isArray(n)?(h(n,function(t){i.push(m(t))}),n=function(){var t=this,e=!1;return h(i,function(i){f(t,i)&&(e=!0)}),e}):t.isObject(n)?(n.___id&&n.___s&&(n={___id:n.___id}),g(n,function(e,s){t.isObject(e)||(e={is:e}),g(e,function(e,a){var o,r=[];o="hasAll"===a?function(t,e){e(t)}:h,o(e,function(e){var i,o=!0;n=!1,i=function(){var i,n=this[s],r="==",l="!=",c="===",p="<",d=">",h="<=",g=">=",u="!==";return void 0===n?!1:(0===a.indexOf("!")&&a!==l&&a!==u&&(o=!1,a=a.substring(1,a.length)),i="regex"===a?e.test(n):"lt"===a||a===p?e>n:"gt"===a||a===d?n>e:"lte"===a||a===h?e>=n:"gte"===a||a===g?n>=e:"left"===a?0===n.indexOf(e):"leftnocase"===a?0===n.toLowerCase().indexOf(e.toLowerCase()):"right"===a?n.substring(n.length-e.length)===e:"rightnocase"===a?n.toLowerCase().substring(n.length-e.length)===e.toLowerCase():"like"===a?n.indexOf(e)>=0:"likenocase"===a?n.toLowerCase().indexOf(e.toLowerCase())>=0:a===c||"is"===a?n===e:a===r?n==e:a===u?n!==e:a===l?n!=e:"isnocase"===a?n.toLowerCase?n.toLowerCase()===e.toLowerCase():n===e:"has"===a?t.has(n,e):"hasall"===a?t.hasAll(n,e):"contains"===a?TAFFY.isArray(n)&&n.indexOf(e)>-1:-1!==a.indexOf("is")||TAFFY.isNull(n)||TAFFY.isUndefined(n)||TAFFY.isObject(e)||TAFFY.isArray(e)?t[a]&&t.isFunction(t[a])&&0===a.indexOf("is")?t[a](n)===e:t[a]&&t.isFunction(t[a])?t[a](n,e):!1:e===n[a],i=i&&!o?!1:i||o?i:!0)},r.push(i)}),1===r.length?i.push(r[0]):i.push(function(){var t=this,e=!1;return h(r,function(i){i.apply(t)&&(e=!0)}),e})})}),n=function(){var t=this,e=!0;return e=(1!==i.length||i[0].apply(t))&&(2!==i.length||i[0].apply(t)&&i[1].apply(t))&&(3!==i.length||i[0].apply(t)&&i[1].apply(t)&&i[2].apply(t))&&(4!==i.length||i[0].apply(t)&&i[1].apply(t)&&i[2].apply(t)&&i[3].apply(t))?!0:!1,i.length>4&&h(i,function(i){f(t,i)||(e=!1)}),e}):t.isFunction(n)?n:void 0},y=function(e,i){var n=function(e,n){var s=0;return t.each(i,function(i){var a,o,r,l=i.split(" "),c=l[0];switch(a=1===l.length?"logical":l[1]){case"logical":o=v(e[c]),r=v(n[c]),t.each(o.length<=r.length?o:r,function(t,e){return o[e]<r[e]?(s=-1,TAFFY.EXIT):o[e]>r[e]?(s=1,TAFFY.EXIT):void 0});break;case"logicaldesc":o=v(e[c]),r=v(n[c]),t.each(o.length<=r.length?o:r,function(t,e){return o[e]>r[e]?(s=-1,TAFFY.EXIT):o[e]<r[e]?(s=1,TAFFY.EXIT):void 0});break;case"asec":if(e[c]<n[c])return s=-1,t.EXIT;if(e[c]>n[c])return s=1,t.EXIT;break;case"desc":if(e[c]>n[c])return s=-1,t.EXIT;if(e[c]<n[c])return s=1,t.EXIT;break;default:throw"Unknown directive: "+a}return 0===s&&"logical"===a&&o.length<r.length?s=-1:0===s&&"logical"===a&&o.length>r.length?s=1:0===s&&"logicaldesc"===a&&o.length>r.length?s=-1:0===s&&"logicaldesc"===a&&o.length<r.length&&(s=1),0!==s?t.EXIT:void 0}),s};return e&&e.push?e.sort(n):e},function(){var t={},e=0;v=function(i){return e>c&&(t={},e=0),t["_"+i]||function(){var n,s,a,o=String(i),r=[],l="_",c="";for(n=0,s=o.length;s>n;n++)a=o.charCodeAt(n),a>=48&&57>=a||46===a?("n"!==c&&(c="n",r.push(l.toLowerCase()),l=""),l+=o.charAt(n)):("s"!==c&&(c="s",r.push(parseFloat(l)),l=""),l+=o.charAt(n));return r.push("n"===c?parseFloat(l):l.toLowerCase()),r.shift(),t["_"+i]=r,e++,r}()}}(),b=function(){this.context({results:this.getDBI().query(this.context())})},p.extend("filter",function(){var t=TAFFY.mergeObj(this.context(),{run:null}),e=D(arguments),i=[];return h(t.q,function(t){i.push(t)}),t.q=i,h(e,function(e){t.q.push(m(e)),t.filterRaw.push(e)}),this.getroot(t)}),p.extend("order",function(t){t=t.split(",");var e,i=[];return h(t,function(t){i.push(t.replace(/^\s*/,"").replace(/\s*$/,""))}),e=TAFFY.mergeObj(this.context(),{sort:null}),e.order=i,this.getroot(e)}),p.extend("limit",function(t){var e,i=TAFFY.mergeObj(this.context(),{});return i.limit=t,i.run&&i.sort&&(e=[],h(i.results,function(i,n){return n+1>t?TAFFY.EXIT:void e.push(i)}),i.results=e),this.getroot(i)}),p.extend("start",function(t){var e,i=TAFFY.mergeObj(this.context(),{});return i.start=t,i.run&&i.sort&&!i.limit?(e=[],h(i.results,function(i,n){n+1>t&&e.push(i)}),i.results=e):i=TAFFY.mergeObj(this.context(),{run:null,start:t}),this.getroot(i)}),p.extend("update",function(e,i,n){var s,a=!0,o={},r=D(arguments);return!TAFFY.isString(e)||2!==r.length&&3!==r.length?(o=e,2===r.length&&(a=i)):(o[e]=i,3===r.length&&(a=n)),s=this,b.call(this),h(this.context().results,function(e){var i=o;TAFFY.isFunction(i)?i=i.apply(TAFFY.mergeObj(e,{})):t.isFunction(i)&&(i=i(TAFFY.mergeObj(e,{}))),TAFFY.isObject(i)&&s.getDBI().update(e.___id,i,a)}),this.context().results.length&&this.context({run:null}),this}),p.extend("remove",function(t){var e=this,i=0;return b.call(this),h(this.context().results,function(t){e.getDBI().remove(t.___id),i++}),this.context().results.length&&(this.context({run:null}),e.getDBI().removeCommit(t)),i}),p.extend("count",function(){return b.call(this),this.context().results.length}),p.extend("callback",function(t,e){if(t){var i=this;setTimeout(function(){b.call(i),t.call(i.getroot(i.context()))},e||0)}return null}),p.extend("get",function(){return b.call(this),this.context().results}),p.extend("stringify",function(){return JSON.stringify(this.get())}),p.extend("first",function(){return b.call(this),this.context().results[0]||!1}),p.extend("last",function(){return b.call(this),this.context().results[this.context().results.length-1]||!1}),p.extend("sum",function(){var t=0,e=this;return b.call(e),h(arguments,function(i){h(e.context().results,function(e){t+=e[i]||0})}),t}),p.extend("min",function(t){var e=null;return b.call(this),h(this.context().results,function(i){(null===e||i[t]<e)&&(e=i[t])}),e}),x=function(){var t,e,i;return t=function(t,e,i){var n,s,a;switch(2===i.length?(n=t[i[0]],a="===",s=e[i[1]]):(n=t[i[0]],a=i[1],s=e[i[2]]),a){case"===":return n===s;case"!==":return n!==s;case"<":return s>n;case">":return n>s;case"<=":return s>=n;case">=":return n>=s;case"==":return n==s;case"!=":return n!=s;default:throw String(a)+" is not supported"}},e=function(t,e){var i,n,s={};for(i in t)t.hasOwnProperty(i)&&(s[i]=t[i]);for(i in e)e.hasOwnProperty(i)&&"___id"!==i&&"___s"!==i&&(n=TAFFY.isUndefined(s[i])?"":"right_",s[n+String(i)]=e[i]);return s},i=function(i){var n,s,a=arguments,o=a.length,r=[];if("function"!=typeof i.filter){if(!i.TAFFY)throw"TAFFY DB or result not supplied";n=i()}else n=i;return this.context({results:this.getDBI().query(this.context())}),TAFFY.each(this.context().results,function(i){n.each(function(n){var l,c=!0;t:for(s=1;o>s&&(l=a[s],c="function"==typeof l?l(i,n):"object"==typeof l&&l.length?t(i,n,l):!1,c);s++);c&&r.push(e(i,n))})}),TAFFY(r)()}}(),p.extend("join",x),p.extend("max",function(t){var e=null;return b.call(this),h(this.context().results,function(i){(null===e||i[t]>e)&&(e=i[t])}),e}),p.extend("select",function(){var t=[],e=D(arguments);return b.call(this),1===e.length?h(this.context().results,function(i){t.push(i[e[0]])}):h(this.context().results,function(i){var n=[];h(e,function(t){n.push(i[t])}),t.push(n)}),t}),p.extend("distinct",function(){var t=[],e=D(arguments);return b.call(this),1===e.length?h(this.context().results,function(i){var n=i[e[0]],s=!1;h(t,function(t){return n===t?(s=!0,TAFFY.EXIT):void 0}),s||t.push(n)}):h(this.context().results,function(i){var n=[],s=!1;h(e,function(t){n.push(i[t])}),h(t,function(t){var i=!0;return h(e,function(e,s){return n[s]!==t[s]?(i=!1,TAFFY.EXIT):void 0}),i?(s=!0,TAFFY.EXIT):void 0}),s||t.push(n)}),t}),p.extend("supplant",function(t,e){var i=[];return b.call(this),h(this.context().results,function(e){i.push(t.replace(/\{([^\{\}]*)\}/g,function(t,i){var n=e[i];return"string"==typeof n||"number"==typeof n?n:t}))}),e?i:i.join("")}),p.extend("each",function(t){return b.call(this),h(this.context().results,t),this}),p.extend("map",function(t){var e=[];return b.call(this),h(this.context().results,function(i){e.push(t(i))}),e}),t=function(e){var i,n,s,a=[],o={},c=1,v=new Date,b={},x=0,S=0,A={template:!1,onInsert:!1,onUpdate:!1,onRemove:!1,onDBChange:!1,storageName:!1,forcePropertyCase:null,cacheSize:100,name:""};return n=function(e){var i=[],s=!1;return 0===e.length?a:(h(e,function(e){t.isString(e)&&/[t][0-9]*[r][0-9]*/i.test(e)&&a[o[e]]&&(i.push(a[o[e]]),s=!0),t.isObject(e)&&e.___id&&e.___s&&a[o[e.___id]]&&(i.push(a[o[e.___id]]),s=!0),t.isArray(e)&&h(e,function(t){h(n(t),function(t){i.push(t)})})}),s&&i.length>1&&(i=[]),i)},i={dm:function(t){return t&&(v=t,b={},x=0,S=0),A.onDBChange&&setTimeout(function(){A.onDBChange.call(a)},0),A.storageName&&setTimeout(function(){localStorage.setItem("taffy_"+A.storageName,JSON.stringify(a))}),v},insert:function(e,n){var p=[],u=[],m=d(e);return h(m,function(e,s){var d,m;if(t.isArray(e)){if(0===s)return h(e,function(t){p.push("lower"===A.forcePropertyCase?t.toLowerCase():"upper"===A.forcePropertyCase?t.toUpperCase():t)}),!0;d={},h(e,function(t,e){d[p[e]]=t}),e=d}else t.isObject(e)&&A.forcePropertyCase&&(m={},g(e,function(t,i){m["lower"===A.forcePropertyCase?i.toLowerCase():"upper"===A.forcePropertyCase?i.toUpperCase():i]=e[i]}),e=m);c++,e.___id="T"+String(l+r).slice(-6)+"R"+String(l+c).slice(-6),e.___s=!0,u.push(e.___id),A.template&&(e=t.mergeObj(A.template,e)),a.push(e),o[e.___id]=a.length-1,A.onInsert&&(n||TAFFY.isUndefined(n))&&A.onInsert.call(e),i.dm(new Date)}),s(u)},sort:function(t){return a=y(a,t.split(",")),o={},h(a,function(t,e){o[t.___id]=e}),i.dm(new Date),!0},update:function(e,n,s){var r,l,c,p,d={};A.forcePropertyCase&&(g(n,function(t,e){d["lower"===A.forcePropertyCase?e.toLowerCase():"upper"===A.forcePropertyCase?e.toUpperCase():e]=t}),n=d),r=a[o[e]],l=t.mergeObj(r,n),c={},p=!1,g(l,function(t,e){(TAFFY.isUndefined(r[e])||r[e]!==t)&&(c[e]=t,p=!0)}),p&&(A.onUpdate&&(s||TAFFY.isUndefined(s))&&A.onUpdate.call(l,a[o[e]],c),a[o[e]]=l,i.dm(new Date))},remove:function(t){a[o[t]].___s=!1},removeCommit:function(t){var e;for(e=a.length-1;e>-1;e--)a[e].___s||(A.onRemove&&(t||TAFFY.isUndefined(t))&&A.onRemove.call(a[e]),o[a[e].___id]=void 0,a.splice(e,1));o={},h(a,function(t,e){o[t.___id]=e}),i.dm(new Date)},query:function(e){var s,o,r,l,c,p;if(A.cacheSize&&(o="",h(e.filterRaw,function(e){return t.isFunction(e)?(o="nocache",TAFFY.EXIT):void 0}),""===o&&(o=C(t.mergeObj(e,{q:!1,run:!1,sort:!1})))),!e.results||!e.run||e.run&&i.dm()>e.run){if(r=[],A.cacheSize&&b[o])return b[o].i=x++,b[o].results;0===e.q.length&&0===e.index.length?(h(a,function(t){r.push(t)}),s=r):(l=n(e.index),h(l,function(t){(0===e.q.length||f(t,e.q))&&r.push(t)}),s=r)}else s=e.results;return!(e.order.length>0)||e.run&&e.sort||(s=y(s,e.order)),s.length&&(e.limit&&e.limit<s.length||e.start)&&(c=[],h(s,function(t,i){if(!e.start||e.start&&i+1>=e.start)if(e.limit){if(p=e.start?i+1-e.start:i,p<e.limit)c.push(t);else if(p>e.limit)return TAFFY.EXIT}else c.push(t)}),s=c),A.cacheSize&&"nocache"!==o&&(S++,setTimeout(function(){var t,e;S>=2*A.cacheSize&&(S=0,t=x-A.cacheSize,e={},g(function(i,n){i.i>=t&&(e[n]=i)}),b=e)},0),b[o]={i:x++,results:s}),s}},s=function(){var t,e;return t=TAFFY.mergeObj(TAFFY.mergeObj(p,{insert:void 0}),{getDBI:function(){return i},getroot:function(t){return s.call(t)},context:function(t){return t&&(e=TAFFY.mergeObj(e,t.hasOwnProperty("results")?TAFFY.mergeObj(t,{run:new Date,sort:new Date}):t)),e},extend:void 0}),e=this&&this.q?this:{limit:!1,start:!1,q:[],filterRaw:[],index:[],order:[],results:!1,run:null,sort:null,settings:A},h(D(arguments),function(t){u(t)?e.index.push(t):e.q.push(m(t)),e.filterRaw.push(t)}),t},r++,e&&i.insert(e),s.insert=i.insert,s.merge=function(t,e,n){var a={},o=[],r={};return n=n||!1,e=e||"id",h(t,function(t){var r;a[e]=t[e],o.push(t[e]),r=s(a).first(),r?i.update(r.___id,t,n):i.insert(t,n)}),r[e]=o,s(r)},s.TAFFY=!0,s.sort=i.sort,s.settings=function(t){return t&&(A=TAFFY.mergeObj(A,t),t.template&&s().update(t.template)),A},s.store=function(t){var e;return localStorage&&(t&&(e=localStorage.getItem("taffy_"+t),e&&e.length>0&&s.insert(e),a.length>0&&setTimeout(function(){localStorage.setItem("taffy_"+A.storageName,JSON.stringify(a))})),s.settings({storageName:t})),s},s},TAFFY=t,t.each=h,t.eachin=g,t.extend=p.extend,TAFFY.EXIT="TAFFYEXIT",TAFFY.mergeObj=function(t,e){var i={};return g(t,function(e,n){i[n]=t[n]}),g(e,function(t,n){i[n]=e[n]}),i},TAFFY.version=o,TAFFY.has=function(e,i){var n,s=!1;if(e.TAFFY)return s=e(i),s.length>0?!0:!1;switch(t.typeOf(e)){case"object":if(t.isObject(i))g(i,function(n,a){return s!==!0||t.isUndefined(e[a])||!e.hasOwnProperty(a)?(s=!1,TAFFY.EXIT):void(s=t.has(e[a],i[a]))});else if(t.isArray(i))h(i,function(n,a){return s=t.has(e,i[a]),s?TAFFY.EXIT:void 0});else if(t.isString(i))return!TAFFY.isUndefined(e[i]);return s;case"array":if(t.isObject(i))h(e,function(n,a){return s=t.has(e[a],i),s===!0?TAFFY.EXIT:void 0});else if(t.isArray(i))h(i,function(n,a){return h(e,function(n,o){return s=t.has(e[o],i[a]),s===!0?TAFFY.EXIT:void 0}),s===!0?TAFFY.EXIT:void 0});else if(t.isString(i)||t.isNumber(i))for(s=!1,n=0;n<e.length;n++)if(s=t.has(e[n],i))return!0;return s;case"string":if(t.isString(i)&&i===e)return!0;break;default:if(t.typeOf(e)===t.typeOf(i)&&e===i)return!0}return!1},TAFFY.hasAll=function(e,i){var n;return t=TAFFY,t.isArray(i)?(n=!0,h(i,function(i){return n=t.has(e,i),n===!1?TAFFY.EXIT:void 0}),n):t.has(e,i)},TAFFY.typeOf=function(t){var e=typeof t;return"object"===e&&(t?"number"!=typeof t.length||t.propertyIsEnumerable("length")||(e="array"):e="null"),e},TAFFY.getObjectKeys=function(t){var e=[];return g(t,function(t,i){e.push(i)}),e.sort(),e},TAFFY.isSameArray=function(t,e){return TAFFY.isArray(t)&&TAFFY.isArray(e)&&t.join(",")===e.join(",")?!0:!1},TAFFY.isSameObject=function(e,i){var n=!0;return t=TAFFY,t.isObject(e)&&t.isObject(i)&&t.isSameArray(t.getObjectKeys(e),t.getObjectKeys(i))?g(e,function(s,a){return t.isObject(e[a])&&t.isObject(i[a])&&t.isSameObject(e[a],i[a])||t.isArray(e[a])&&t.isArray(i[a])&&t.isSameArray(e[a],i[a])||e[a]===i[a]?void 0:(n=!1,TAFFY.EXIT)}):n=!1,n},i=["String","Number","Object","Array","Boolean","Null","Function","Undefined"],n=function(t){return function(e){return TAFFY.typeOf(e)===t.toLowerCase()?!0:!1}},s=0;s<i.length;s++)a=i[s],TAFFY["is"+a]=n(a)}(),"object"==typeof exports&&(exports.taffy=TAFFY),define("taffy",function(){}),function(t){var e={itemWidth:65,prevclass:"amtprev",nextclass:"amtnext",infiniteloop:!1,itemstodisplay:4,nextClickCallback:null,prevClickCallback:null},i={};t.fn.amtslider=function(n){if(0==this.length)return this;if(this.length>1)return this.each(function(){t(this).amtslider(n)}),this;var s,a=0,o=0,r={},l=this;i.el=this,r.settings=t.extend({},e,n);var c=function(){l.children().length>1&&!l.hasClass("amt-slider")&&(p(l[0]),h(l[0]))},p=function(t){var e=t.parentElement,i=t.classList+" amt-slider";t.setAttribute("class",i);var n=document.createElement("div");n.setAttribute("class","slider_wrapper"),n.appendChild(t);var s=document.createElement("div"),a=document.createElement("span");a.setAttribute("class",r.settings.prevclass);var o=document.createElement("span");o.setAttribute("class",r.settings.nextclass),s.appendChild(a),s.appendChild(o),e.appendChild(n),e.appendChild(s)},d=function(t){var e=new Date,i=setInterval(function(){var n=new Date-e,s=n/t.duration;s>1&&(s=1);var a=t.delta(s);t.step(a),1==s&&(clearInterval(i),t.callback())},t.delay||17)},h=function(e){s=e.children.length,e.style.width=parseInt(r.settings.itemWidth*s)+"px";var i=t(e).closest(".slider_wrapper").parent();i.find("."+r.settings.prevclass).on("click",function(){u()}),i.find("."+r.settings.nextclass).on("click",function(){m()})},g=function(t){var e,i=Math.abs(t-o);e=o>t?1:-1,a=-1*o*r.settings.itemWidth;var n={duration:500,delta:function(t){return t},step:function(t){l[0].style.left=parseInt(a+e*t*r.settings.itemWidth*i)+"px"},callback:function(){o=t}};d(n)},u=function(){0==o?r.settings.infiniteloop&&g(s-r.settings.itemstodisplay):g(o-1),r.settings.prevClickCallback&&r.settings.prevClickCallback()},m=function(){o==s-r.settings.itemstodisplay?r.settings.infiniteloop&&g(0):g(o+1),r.settings.nextClickCallback&&r.settings.nextClickCallback()};return c(),this}}(jQuery),define("slider",function(){});var Handlebars={};!function(t,e){t.VERSION="1.0.0",t.COMPILER_REVISION=4,t.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"},t.helpers={},t.partials={};var i=Object.prototype.toString,n="[object Function]",s="[object Object]";t.registerHelper=function(e,n,a){if(i.call(e)===s){if(a||n)throw new t.Exception("Arg not supported with multiple helpers");t.Utils.extend(this.helpers,e)}else a&&(n.not=a),this.helpers[e]=n},t.registerHelper("ifCond",function(t,e,i,n){switch(e){case"==":return t==i?n.fn(this):n.inverse(this);case"===":return t===i?n.fn(this):n.inverse(this);case"<":return i>t?n.fn(this):n.inverse(this);case"<=":return i>=t?n.fn(this):n.inverse(this);case">":return t>i?n.fn(this):n.inverse(this);case">=":return t>=i?n.fn(this):n.inverse(this);case"&&":return t&&i?n.fn(this):n.inverse(this);case"||":return t||i?n.fn(this):n.inverse(this);default:return n.inverse(this)}}),t.registerPartial=function(e,n){i.call(e)===s?t.Utils.extend(this.partials,e):this.partials[e]=n},t.registerHelper("helperMissing",function(t){if(2===arguments.length)return e;throw new Error("Missing helper: '"+t+"'")}),t.registerHelper("blockHelperMissing",function(e,s){var a=s.inverse||function(){},o=s.fn,r=i.call(e);return r===n&&(e=e.call(this)),e===!0?o(this):e===!1||null==e?a(this):"[object Array]"===r?e.length>0?t.helpers.each(e,s):a(this):o(e)}),t.K=function(){},t.createFrame=Object.create||function(e){t.K.prototype=e;var i=new t.K;return t.K.prototype=null,i},t.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(e,i){if(t.logger.level<=e){var n=t.logger.methodMap[e];"undefined"!=typeof console&&console[n]&&console[n].call(console,i)}}},t.log=function(e,i){t.logger.log(e,i)},t.registerHelper("each",function(e,s){var a,o=s.fn,r=s.inverse,l=0,c="",p=i.call(e);if(p===n&&(e=e.call(this)),s.data&&(a=t.createFrame(s.data)),e&&"object"==typeof e)if(e instanceof Array)for(var d=e.length;d>l;l++)a&&(a.index=l),c+=o(e[l],{data:a});else for(var h in e)e.hasOwnProperty(h)&&(a&&(a.key=h),c+=o(e[h],{data:a}),l++);return 0===l&&(c=r(this)),c}),t.registerHelper("if",function(e,s){var a=i.call(e);return a===n&&(e=e.call(this)),!e||t.Utils.isEmpty(e)?s.inverse(this):s.fn(this)}),t.registerHelper("unless",function(e,i){return t.helpers["if"].call(this,e,{fn:i.inverse,inverse:i.fn})}),t.registerHelper("with",function(e,s){var a=i.call(e);return a===n&&(e=e.call(this)),t.Utils.isEmpty(e)?void 0:s.fn(e)}),t.registerHelper("log",function(e,i){var n=i.data&&null!=i.data.level?parseInt(i.data.level,10):1;t.log(n,e)});var a=function(){function t(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,simpleInverse:6,statements:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,params:27,hash:28,dataName:29,param:30,STRING:31,INTEGER:32,BOOLEAN:33,hashSegments:34,hashSegment:35,ID:36,EQUALS:37,DATA:38,pathSegments:39,SEP:40,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",31:"STRING",32:"INTEGER",33:"BOOLEAN",36:"ID",37:"EQUALS",38:"DATA",40:"SEP"},productions_:[0,[3,2],[4,2],[4,3],[4,2],[4,1],[4,1],[4,0],[7,1],[7,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[6,2],[17,3],[17,2],[17,2],[17,1],[17,1],[27,2],[27,1],[30,1],[30,1],[30,1],[30,1],[30,1],[28,1],[34,2],[34,1],[35,3],[35,3],[35,3],[35,3],[35,3],[26,1],[26,1],[26,1],[29,2],[21,1],[39,3],[39,1]],performAction:function(t,e,i,n,s,a,o){var r=a.length-1;switch(s){case 1:return a[r-1];case 2:this.$=new n.ProgramNode([],a[r]);break;case 3:this.$=new n.ProgramNode(a[r-2],a[r]);break;case 4:this.$=new n.ProgramNode(a[r-1],[]);break;case 5:this.$=new n.ProgramNode(a[r]);break;case 6:this.$=new n.ProgramNode([],[]);break;case 7:this.$=new n.ProgramNode([]);break;case 8:this.$=[a[r]];break;case 9:a[r-1].push(a[r]),this.$=a[r-1];break;case 10:this.$=new n.BlockNode(a[r-2],a[r-1].inverse,a[r-1],a[r]);break;case 11:this.$=new n.BlockNode(a[r-2],a[r-1],a[r-1].inverse,a[r]);break;case 12:this.$=a[r];break;case 13:this.$=a[r];break;case 14:this.$=new n.ContentNode(a[r]);break;case 15:this.$=new n.CommentNode(a[r]);break;case 16:this.$=new n.MustacheNode(a[r-1][0],a[r-1][1]);break;case 17:this.$=new n.MustacheNode(a[r-1][0],a[r-1][1]);break;case 18:this.$=a[r-1];break;case 19:this.$=new n.MustacheNode(a[r-1][0],a[r-1][1],"&"===a[r-2][2]);break;case 20:this.$=new n.MustacheNode(a[r-1][0],a[r-1][1],!0);break;case 21:this.$=new n.PartialNode(a[r-1]);break;case 22:this.$=new n.PartialNode(a[r-2],a[r-1]);break;case 23:break;case 24:this.$=[[a[r-2]].concat(a[r-1]),a[r]];break;case 25:this.$=[[a[r-1]].concat(a[r]),null];break;case 26:this.$=[[a[r-1]],a[r]];break;case 27:this.$=[[a[r]],null];break;case 28:this.$=[[a[r]],null];break;case 29:a[r-1].push(a[r]),this.$=a[r-1];break;case 30:this.$=[a[r]];break;case 31:this.$=a[r];break;case 32:this.$=new n.StringNode(a[r]);break;case 33:this.$=new n.IntegerNode(a[r]);break;case 34:this.$=new n.BooleanNode(a[r]);break;case 35:this.$=a[r];break;case 36:this.$=new n.HashNode(a[r]);break;case 37:a[r-1].push(a[r]),this.$=a[r-1];break;case 38:this.$=[a[r]];break;case 39:this.$=[a[r-2],a[r]];break;case 40:this.$=[a[r-2],new n.StringNode(a[r])];break;case 41:this.$=[a[r-2],new n.IntegerNode(a[r])];break;case 42:this.$=[a[r-2],new n.BooleanNode(a[r])];break;case 43:this.$=[a[r-2],a[r]];break;case 44:this.$=new n.PartialNameNode(a[r]);break;case 45:this.$=new n.PartialNameNode(new n.StringNode(a[r]));break;case 46:this.$=new n.PartialNameNode(new n.IntegerNode(a[r]));break;case 47:this.$=new n.DataNode(a[r]);break;case 48:this.$=new n.IdNode(a[r]);break;case 49:a[r-2].push({part:a[r],separator:a[r-1]}),this.$=a[r-2];break;case 50:this.$=[{part:a[r]}]}},table:[{3:1,4:2,5:[2,7],6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],22:[1,14],23:[1,15],25:[1,16]},{1:[3]},{5:[1,17]},{5:[2,6],7:18,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,6],22:[1,14],23:[1,15],25:[1,16]},{5:[2,5],6:20,8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,5],22:[1,14],23:[1,15],25:[1,16]},{17:23,18:[1,22],21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],25:[2,8]},{4:29,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]
},{4:30,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{17:31,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:32,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:33,21:24,29:25,36:[1,28],38:[1,27],39:26},{21:35,26:34,31:[1,36],32:[1,37],36:[1,28],39:26},{1:[2,1]},{5:[2,2],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,2],22:[1,14],23:[1,15],25:[1,16]},{17:23,21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,4],7:38,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,4],22:[1,14],23:[1,15],25:[1,16]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{5:[2,23],14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{18:[1,39]},{18:[2,27],21:44,24:[2,27],27:40,28:41,29:48,30:42,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,28],24:[2,28]},{18:[2,48],24:[2,48],31:[2,48],32:[2,48],33:[2,48],36:[2,48],38:[2,48],40:[1,51]},{21:52,36:[1,28],39:26},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],38:[2,50],40:[2,50]},{10:53,20:[1,54]},{10:55,20:[1,54]},{18:[1,56]},{18:[1,57]},{24:[1,58]},{18:[1,59],21:60,36:[1,28],39:26},{18:[2,44],36:[2,44]},{18:[2,45],36:[2,45]},{18:[2,46],36:[2,46]},{5:[2,3],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,3],22:[1,14],23:[1,15],25:[1,16]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{18:[2,25],21:44,24:[2,25],28:61,29:48,30:62,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,26],24:[2,26]},{18:[2,30],24:[2,30],31:[2,30],32:[2,30],33:[2,30],36:[2,30],38:[2,30]},{18:[2,36],24:[2,36],35:63,36:[1,64]},{18:[2,31],24:[2,31],31:[2,31],32:[2,31],33:[2,31],36:[2,31],38:[2,31]},{18:[2,32],24:[2,32],31:[2,32],32:[2,32],33:[2,32],36:[2,32],38:[2,32]},{18:[2,33],24:[2,33],31:[2,33],32:[2,33],33:[2,33],36:[2,33],38:[2,33]},{18:[2,34],24:[2,34],31:[2,34],32:[2,34],33:[2,34],36:[2,34],38:[2,34]},{18:[2,35],24:[2,35],31:[2,35],32:[2,35],33:[2,35],36:[2,35],38:[2,35]},{18:[2,38],24:[2,38],36:[2,38]},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],37:[1,65],38:[2,50],40:[2,50]},{36:[1,66]},{18:[2,47],24:[2,47],31:[2,47],32:[2,47],33:[2,47],36:[2,47],38:[2,47]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{21:67,36:[1,28],39:26},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,68]},{18:[2,24],24:[2,24]},{18:[2,29],24:[2,29],31:[2,29],32:[2,29],33:[2,29],36:[2,29],38:[2,29]},{18:[2,37],24:[2,37],36:[2,37]},{37:[1,65]},{21:69,29:73,31:[1,70],32:[1,71],33:[1,72],36:[1,28],38:[1,27],39:26},{18:[2,49],24:[2,49],31:[2,49],32:[2,49],33:[2,49],36:[2,49],38:[2,49],40:[2,49]},{18:[1,74]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{18:[2,39],24:[2,39],36:[2,39]},{18:[2,40],24:[2,40],36:[2,40]},{18:[2,41],24:[2,41],36:[2,41]},{18:[2,42],24:[2,42],36:[2,42]},{18:[2,43],24:[2,43],36:[2,43]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]}],defaultActions:{17:[2,1]},parseError:function(t,e){throw new Error(t)},parse:function(t){function e(){var t;return t=i.lexer.lex()||1,"number"!=typeof t&&(t=i.symbols_[t]||t),t}var i=this,n=[0],s=[null],a=[],o=this.table,r="",l=0,c=0,p=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var d=this.lexer.yylloc;a.push(d);var h=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var g,u,m,f,v,y,b,x,C,S={};;){if(m=n[n.length-1],this.defaultActions[m]?f=this.defaultActions[m]:((null===g||"undefined"==typeof g)&&(g=e()),f=o[m]&&o[m][g]),"undefined"==typeof f||!f.length||!f[0]){var A="";if(!p){C=[];for(y in o[m])this.terminals_[y]&&y>2&&C.push("'"+this.terminals_[y]+"'");A=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+C.join(", ")+", got '"+(this.terminals_[g]||g)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==g?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(A,{text:this.lexer.match,token:this.terminals_[g]||g,line:this.lexer.yylineno,loc:d,expected:C})}}if(f[0]instanceof Array&&f.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+g);switch(f[0]){case 1:n.push(g),s.push(this.lexer.yytext),a.push(this.lexer.yylloc),n.push(f[1]),g=null,u?(g=u,u=null):(c=this.lexer.yyleng,r=this.lexer.yytext,l=this.lexer.yylineno,d=this.lexer.yylloc,p>0&&p--);break;case 2:if(b=this.productions_[f[1]][1],S.$=s[s.length-b],S._$={first_line:a[a.length-(b||1)].first_line,last_line:a[a.length-1].last_line,first_column:a[a.length-(b||1)].first_column,last_column:a[a.length-1].last_column},h&&(S._$.range=[a[a.length-(b||1)].range[0],a[a.length-1].range[1]]),v=this.performAction.call(S,r,c,l,this.yy,f[1],s,a),"undefined"!=typeof v)return v;b&&(n=n.slice(0,-1*b*2),s=s.slice(0,-1*b),a=a.slice(0,-1*b)),n.push(this.productions_[f[1]][0]),s.push(S.$),a.push(S._$),x=o[n[n.length-2]][n[n.length-1]],n.push(x);break;case 3:return!0}}return!0}},i=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,i=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var s=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[s[0],s[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,i,n,s;this._more||(this.yytext="",this.match="");for(var a=this._currentRules(),o=0;o<a.length&&(i=this._input.match(this.rules[a[o]]),!i||e&&!(i[0].length>e[0].length)||(e=i,n=o,this.options.flex));o++);return e?(s=e[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,a[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t?t:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return"undefined"!=typeof t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,i,n){switch(i){case 0:return e.yytext="\\",14;case 1:if("\\"!==e.yytext.slice(-1)&&this.begin("mu"),"\\"===e.yytext.slice(-1)&&(e.yytext=e.yytext.substr(0,e.yyleng-1),this.begin("emu")),e.yytext)return 14;break;case 2:return 14;case 3:return"\\"!==e.yytext.slice(-1)&&this.popState(),"\\"===e.yytext.slice(-1)&&(e.yytext=e.yytext.substr(0,e.yyleng-1)),14;case 4:return e.yytext=e.yytext.substr(0,e.yyleng-4),this.popState(),15;case 5:return 25;case 6:return 16;case 7:return 20;case 8:return 19;case 9:return 19;case 10:return 23;case 11:return 22;case 12:this.popState(),this.begin("com");break;case 13:return e.yytext=e.yytext.substr(3,e.yyleng-5),this.popState(),15;case 14:return 22;case 15:return 37;case 16:return 36;case 17:return 36;case 18:return 40;case 19:break;case 20:return this.popState(),24;case 21:return this.popState(),18;case 22:return e.yytext=e.yytext.substr(1,e.yyleng-2).replace(/\\"/g,'"'),31;case 23:return e.yytext=e.yytext.substr(1,e.yyleng-2).replace(/\\'/g,"'"),31;case 24:return 38;case 25:return 33;case 26:return 33;case 27:return 32;case 28:return 36;case 29:return e.yytext=e.yytext.substr(1,e.yyleng-2),36;case 30:return"INVALID";case 31:return 5}},t.rules=[/^(?:\\\\(?=(\{\{)))/,/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\{\{>)/,/^(?:\{\{#)/,/^(?:\{\{\/)/,/^(?:\{\{\^)/,/^(?:\{\{\s*else\b)/,/^(?:\{\{\{)/,/^(?:\{\{&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{)/,/^(?:=)/,/^(?:\.(?=[}\/ ]))/,/^(?:\.\.)/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}\}\})/,/^(?:\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=[}\s]))/,/^(?:false(?=[}\s]))/,/^(?:-?[0-9]+(?=[}\s]))/,/^(?:[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.]))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],t.conditions={mu:{rules:[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],inclusive:!1},emu:{rules:[3],inclusive:!1},com:{rules:[4],inclusive:!1},INITIAL:{rules:[0,1,2,31],inclusive:!0}},t}();return e.lexer=i,t.prototype=e,e.Parser=t,new t}();t.Parser=a,t.parse=function(e){return e.constructor===t.AST.ProgramNode?e:(t.Parser.yy=t.AST,t.Parser.parse(e))},t.AST={},t.AST.ProgramNode=function(e,i){this.type="program",this.statements=e,i&&(this.inverse=new t.AST.ProgramNode(i))},t.AST.MustacheNode=function(t,e,i){this.type="mustache",this.escaped=!i,this.hash=e;var n=this.id=t[0],s=this.params=t.slice(1),a=this.eligibleHelper=n.isSimple;this.isHelper=a&&(s.length||e)},t.AST.PartialNode=function(t,e){this.type="partial",this.partialName=t,this.context=e},t.AST.BlockNode=function(e,i,n,s){var a=function(e,i){if(e.original!==i.original)throw new t.Exception(e.original+" doesn't match "+i.original)};a(e.id,s),this.type="block",this.mustache=e,this.program=i,this.inverse=n,this.inverse&&!this.program&&(this.isInverse=!0)},t.AST.ContentNode=function(t){this.type="content",this.string=t},t.AST.HashNode=function(t){this.type="hash",this.pairs=t},t.AST.IdNode=function(e){this.type="ID";for(var i="",n=[],s=0,a=0,o=e.length;o>a;a++){var r=e[a].part;if(i+=(e[a].separator||"")+r,".."===r||"."===r||"this"===r){if(n.length>0)throw new t.Exception("Invalid path: "+i);".."===r?s++:this.isScoped=!0}else n.push(r)}this.original=i,this.parts=n,this.string=n.join("."),this.depth=s,this.isSimple=1===e.length&&!this.isScoped&&0===s,this.stringModeValue=this.string},t.AST.PartialNameNode=function(t){this.type="PARTIAL_NAME",this.name=t.original},t.AST.DataNode=function(t){this.type="DATA",this.id=t},t.AST.StringNode=function(t){this.type="STRING",this.original=this.string=this.stringModeValue=t},t.AST.IntegerNode=function(t){this.type="INTEGER",this.original=this.integer=t,this.stringModeValue=Number(t)},t.AST.BooleanNode=function(t){this.type="BOOLEAN",this.bool=t,this.stringModeValue="true"===t},t.AST.CommentNode=function(t){this.type="comment",this.comment=t};var o=["description","fileName","lineNumber","message","name","number","stack"];t.Exception=function(t){for(var e=Error.prototype.constructor.apply(this,arguments),i=0;i<o.length;i++)this[o[i]]=e[o[i]]},t.Exception.prototype=new Error,t.SafeString=function(t){this.string=t},t.SafeString.prototype.toString=function(){return this.string.toString()};var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},l=/[&<>"'`]/g,c=/[&<>"'`]/,p=function(t){return r[t]||"&amp;"};t.Utils={extend:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},escapeExpression:function(e){return e instanceof t.SafeString?e.toString():null==e||e===!1?"":(e=e.toString(),c.test(e)?e.replace(l,p):e)},isEmpty:function(t){return t||0===t?"[object Array]"===i.call(t)&&0===t.length?!0:!1:!0}};var d=t.Compiler=function(){},h=t.JavaScriptCompiler=function(){};d.prototype={compiler:d,disassemble:function(){for(var t,e,i,n=this.opcodes,s=[],a=0,o=n.length;o>a;a++)if(t=n[a],"DECLARE"===t.opcode)s.push("DECLARE "+t.name+"="+t.value);else{e=[];for(var r=0;r<t.args.length;r++)i=t.args[r],"string"==typeof i&&(i='"'+i.replace("\n","\\n")+'"'),e.push(i);s.push(t.opcode+" "+e.join(" "))}return s.join("\n")},equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var i=0;e>i;i++){var n=this.opcodes[i],s=t.opcodes[i];if(n.opcode!==s.opcode||n.args.length!==s.args.length)return!1;for(var a=0;a<n.args.length;a++)if(n.args[a]!==s.args[a])return!1}if(e=this.children.length,t.children.length!==e)return!1;for(i=0;e>i;i++)if(!this.children[i].equals(t.children[i]))return!1;return!0},guid:0,compile:function(t,e){this.children=[],this.depths={list:[]},this.options=e;var i=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},i)for(var n in i)this.options.knownHelpers[n]=i[n];return this.program(t)},accept:function(t){return this[t.type](t)},program:function(t){var e,i=t.statements;this.opcodes=[];for(var n=0,s=i.length;s>n;n++)e=i[n],this[e.type](e);return this.isSimple=1===s,this.depths.list=this.depths.list.sort(function(t,e){return t-e}),this},compileProgram:function(t){var e,i=(new this.compiler).compile(t,this.options),n=this.guid++;this.usePartial=this.usePartial||i.usePartial,this.children[n]=i;for(var s=0,a=i.depths.list.length;a>s;s++)e=i.depths.list[s],2>e||this.addDepth(e-1);return n},block:function(t){var e=t.mustache,i=t.program,n=t.inverse;i&&(i=this.compileProgram(i)),n&&(n=this.compileProgram(n));var s=this.classifyMustache(e);"helper"===s?this.helperMustache(e,i,n):"simple"===s?(this.simpleMustache(e),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousMustache(e,i,n),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(t){var e,i,n=t.pairs;this.opcode("pushHash");for(var s=0,a=n.length;a>s;s++)e=n[s],i=e[1],this.options.stringParams?(i.depth&&this.addDepth(i.depth),this.opcode("getContext",i.depth||0),this.opcode("pushStringParam",i.stringModeValue,i.type)):this.accept(i),this.opcode("assignToHash",e[0]);this.opcode("popHash")},partial:function(t){var e=t.partialName;this.usePartial=!0,t.context?this.ID(t.context):this.opcode("push","depth0"),this.opcode("invokePartial",e.name),this.opcode("append")},content:function(t){this.opcode("appendContent",t.string)},mustache:function(t){var e=this.options,i=this.classifyMustache(t);"simple"===i?this.simpleMustache(t):"helper"===i?this.helperMustache(t):this.ambiguousMustache(t),t.escaped&&!e.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousMustache:function(t,e,i){var n=t.id,s=n.parts[0],a=null!=e||null!=i;this.opcode("getContext",n.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",i),this.opcode("invokeAmbiguous",s,a)},simpleMustache:function(t){var e=t.id;"DATA"===e.type?this.DATA(e):e.parts.length?this.ID(e):(this.addDepth(e.depth),this.opcode("getContext",e.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(t,e,i){var n=this.setupFullMustacheParams(t,e,i),s=t.id.parts[0];if(this.options.knownHelpers[s])this.opcode("invokeKnownHelper",n.length,s);else{if(this.options.knownHelpersOnly)throw new Error("You specified knownHelpersOnly, but used the unknown helper "+s);this.opcode("invokeHelper",n.length,s)}},ID:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0];e?this.opcode("lookupOnContext",t.parts[0]):this.opcode("pushContext");for(var i=1,n=t.parts.length;n>i;i++)this.opcode("lookup",t.parts[i])},DATA:function(e){if(this.options.data=!0,e.id.isScoped||e.id.depth)throw new t.Exception("Scoped data references are not supported: "+e.original);this.opcode("lookupData");for(var i=e.id.parts,n=0,s=i.length;s>n;n++)this.opcode("lookup",i[n])},STRING:function(t){this.opcode("pushString",t.string)},INTEGER:function(t){this.opcode("pushLiteral",t.integer)},BOOLEAN:function(t){this.opcode("pushLiteral",t.bool)},comment:function(){},opcode:function(t){this.opcodes.push({opcode:t,args:[].slice.call(arguments,1)})},declare:function(t,e){this.opcodes.push({opcode:"DECLARE",name:t,value:e})},addDepth:function(t){if(isNaN(t))throw new Error("EWOT");0!==t&&(this.depths[t]||(this.depths[t]=!0,this.depths.list.push(t)))},classifyMustache:function(t){var e=t.isHelper,i=t.eligibleHelper,n=this.options;if(i&&!e){var s=t.id.parts[0];n.knownHelpers[s]?e=!0:n.knownHelpersOnly&&(i=!1)}return e?"helper":i?"ambiguous":"simple"},pushParams:function(t){for(var e,i=t.length;i--;)e=t[i],this.options.stringParams?(e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",e.stringModeValue,e.type)):this[e.type](e)},setupMustacheParams:function(t){var e=t.params;return this.pushParams(e),t.hash?this.hash(t.hash):this.opcode("emptyHash"),e},setupFullMustacheParams:function(t,e,i){var n=t.params;return this.pushParams(n),this.opcode("pushProgram",e),this.opcode("pushProgram",i),t.hash?this.hash(t.hash):this.opcode("emptyHash"),n}};var g=function(t){this.value=t};h.prototype={nameLookup:function(t,e){return/^[0-9]+$/.test(e)?t+"["+e+"]":h.isValidJavaScriptVariableName(e)?t+"."+e:t+"['"+e+"']"},appendToBuffer:function(t){return this.environment.isSimple?"return "+t+";":{appendToBuffer:!0,content:t,toString:function(){return"buffer += "+t+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(e,i,n,s){this.environment=e,this.options=i||{},t.log(t.logger.DEBUG,this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.inlineStack=[],this.compileChildren(e,i);var a,o=e.opcodes;for(this.i=0,v=o.length;this.i<v;this.i++)a=o[this.i],"DECLARE"===a.opcode?this[a.name]=a.value:this[a.opcode].apply(this,a.args);return this.createFunctionContext(s)},nextOpcode:function(){var t=this.environment.opcodes;return t[this.i+1]},eat:function(){this.i=this.i+1},preamble:function(){var t=[];if(this.isChild)t.push("");else{var e=this.namespace,i="helpers = this.merge(helpers, "+e+".helpers);";this.environment.usePartial&&(i=i+" partials = this.merge(partials, "+e+".partials);"),this.options.data&&(i+=" data = data || {};"),t.push(i)}this.environment.isSimple?t.push(""):t.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=t},createFunctionContext:function(e){var i=this.stackVars.concat(this.registers.list);if(i.length>0&&(this.source[1]=this.source[1]+", "+i.join(", ")),!this.isChild)for(var n in this.context.aliases)this.context.aliases.hasOwnProperty(n)&&(this.source[1]=this.source[1]+", "+n+"="+this.context.aliases[n]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.source.push("return buffer;");for(var s=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],a=0,o=this.environment.depths.list.length;o>a;a++)s.push("depth"+this.environment.depths.list[a]);var r=this.mergeSource();if(!this.isChild){var l=t.COMPILER_REVISION,c=t.REVISION_CHANGES[l];r="this.compilerInfo = ["+l+",'"+c+"'];\n"+r}if(e)return s.push(r),Function.apply(this,s);var p="function "+(this.name||"")+"("+s.join(",")+") {\n  "+r+"}";return t.log(t.logger.DEBUG,p+"\n\n"),p},mergeSource:function(){for(var t,i="",n=0,s=this.source.length;s>n;n++){var a=this.source[n];a.appendToBuffer?t=t?t+"\n    + "+a.content:a.content:(t&&(i+="buffer += "+t+";\n  ",t=e),i+=a+"\n  ")}return i},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t),this.replaceStack(function(e){return t.splice(1,0,e),"blockHelperMissing.call("+t.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t);var e=this.topStack();t.splice(1,0,e),t[t.length-1]="options",this.source.push("if (!"+this.lastHelper+") { "+e+" = blockHelperMissing.call("+t.join(", ")+"); }")},appendContent:function(t){this.source.push(this.appendToBuffer(this.quotedString(t)))},append:function(){this.flushInline();var t=this.popStack();this.source.push("if("+t+" || "+t+" === 0) { "+this.appendToBuffer(t)+" }"),this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(t){this.lastContext!==t&&(this.lastContext=t)},lookupOnContext:function(t){this.push(this.nameLookup("depth"+this.lastContext,t,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(t){return"typeof "+t+" === functionType ? "+t+".apply(depth0) : "+t})},lookup:function(t){this.replaceStack(function(e){return e+" == null || "+e+" === false ? "+e+" : "+this.nameLookup(e,t,"context")})},lookupData:function(t){this.push("data")},pushStringParam:function(t,e){this.pushStackLiteral("depth"+this.lastContext),this.pushString(e),"string"==typeof t?this.pushString(t):this.pushStackLiteral(t)},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.register("hashTypes","{}"),this.register("hashContexts","{}"))},pushHash:function(){this.hash={values:[],types:[],contexts:[]}},popHash:function(){var t=this.hash;this.hash=e,this.options.stringParams&&(this.register("hashContexts","{"+t.contexts.join(",")+"}"),this.register("hashTypes","{"+t.types.join(",")+"}")),this.push("{\n    "+t.values.join(",\n    ")+"\n  }")},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},push:function(t){return this.inlineStack.push(t),t},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){null!=t?this.pushStackLiteral(this.programExpression(t)):this.pushStackLiteral(null)},invokeHelper:function(t,e){this.context.aliases.helperMissing="helpers.helperMissing";var i=this.lastHelper=this.setupHelper(t,e,!0),n=this.nameLookup("depth"+this.lastContext,e,"context");this.push(i.name+" || "+n),this.replaceStack(function(t){return t+" ? "+t+".call("+i.callParams+") : helperMissing.call("+i.helperMissingParams+")"})},invokeKnownHelper:function(t,e){var i=this.setupHelper(t,e);this.push(i.name+".call("+i.callParams+")")},invokeAmbiguous:function(t,e){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");var i=this.setupHelper(0,t,e),n=this.lastHelper=this.nameLookup("helpers",t,"helper"),s=this.nameLookup("depth"+this.lastContext,t,"context"),a=this.nextStack();this.source.push("if ("+a+" = "+n+") { "+a+" = "+a+".call("+i.callParams+"); }"),this.source.push("else { "+a+" = "+s+"; "+a+" = typeof "+a+" === functionType ? "+a+".apply(depth0) : "+a+"; }")},invokePartial:function(t){var e=[this.nameLookup("partials",t,"partial"),"'"+t+"'",this.popStack(),"helpers","partials"];this.options.data&&e.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+e.join(", ")+")")},assignToHash:function(t){var e,i,n=this.popStack();this.options.stringParams&&(i=this.popStack(),e=this.popStack());var s=this.hash;e&&s.contexts.push("'"+t+"': "+e),i&&s.types.push("'"+t+"': "+i),s.values.push("'"+t+"': ("+n+")")},compiler:h,compileChildren:function(t,e){for(var i,n,s=t.children,a=0,o=s.length;o>a;a++){i=s[a],n=new this.compiler;var r=this.matchExistingProgram(i);null==r?(this.context.programs.push(""),r=this.context.programs.length,i.index=r,i.name="program"+r,this.context.programs[r]=n.compile(i,e,this.context),this.context.environments[r]=i):(i.index=r,i.name="program"+r)}},matchExistingProgram:function(t){for(var e=0,i=this.context.environments.length;i>e;e++){var n=this.context.environments[e];if(n&&n.equals(t))return e}},programExpression:function(t){if(this.context.aliases.self="this",null==t)return"self.noop";for(var e,i=this.environment.children[t],n=i.depths.list,s=[i.index,i.name,"data"],a=0,o=n.length;o>a;a++)e=n[a],1===e?s.push("depth0"):s.push("depth"+(e-1));return(0===n.length?"self.program(":"self.programWithDepth(")+s.join(", ")+")"},register:function(t,e){this.useRegister(t),this.source.push(t+" = "+e+";")},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},pushStackLiteral:function(t){return this.push(new g(t))},pushStack:function(t){this.flushInline();var e=this.incrStack();return t&&this.source.push(e+" = "+t+";"),this.compileStack.push(e),e},replaceStack:function(t){var e,i="",n=this.isInline();if(n){var s=this.popStack(!0);if(s instanceof g)e=s.value;else{var a=this.stackSlot?this.topStackName():this.incrStack();i="("+this.push(a)+" = "+s+"),",e=this.topStack()}}else e=this.topStack();var o=t.call(this,e);return n?((this.inlineStack.length||this.compileStack.length)&&this.popStack(),this.push("("+i+o+")")):(/^stack/.test(e)||(e=this.nextStack()),this.source.push(e+" = ("+i+o+");")),e},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;if(t.length){this.inlineStack=[];for(var e=0,i=t.length;i>e;e++){var n=t[e];n instanceof g?this.compileStack.push(n):this.pushStack(n)}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),i=(e?this.inlineStack:this.compileStack).pop();return!t&&i instanceof g?i.value:(e||this.stackSlot--,i)},topStack:function(t){var e=this.isInline()?this.inlineStack:this.compileStack,i=e[e.length-1];return!t&&i instanceof g?i.value:i},quotedString:function(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(t,e,i){var n=[];this.setupParams(t,n,i);var s=this.nameLookup("helpers",e,"helper");return{params:n,name:s,callParams:["depth0"].concat(n).join(", "),helperMissingParams:i&&["depth0",this.quotedString(e)].concat(n).join(", ")}},setupParams:function(t,e,i){var n,s,a,o=[],r=[],l=[];o.push("hash:"+this.popStack()),s=this.popStack(),a=this.popStack(),(a||s)&&(a||(this.context.aliases.self="this",a="self.noop"),s||(this.context.aliases.self="this",s="self.noop"),o.push("inverse:"+s),o.push("fn:"+a));for(var c=0;t>c;c++)n=this.popStack(),e.push(n),this.options.stringParams&&(l.push(this.popStack()),r.push(this.popStack()));return this.options.stringParams&&(o.push("contexts:["+r.join(",")+"]"),o.push("types:["+l.join(",")+"]"),o.push("hashContexts:hashContexts"),o.push("hashTypes:hashTypes")),this.options.data&&o.push("data:data"),o="{"+o.join(",")+"}",i?(this.register("options",o),e.push("options")):e.push(o),e.join(", ")}};for(var u="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),m=h.RESERVED_WORDS={},f=0,v=u.length;v>f;f++)m[u[f]]=!0;h.isValidJavaScriptVariableName=function(t){return!h.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(t)?!0:!1},t.precompile=function(e,i){if(null==e||"string"!=typeof e&&e.constructor!==t.AST.ProgramNode)throw new t.Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);i=i||{},"data"in i||(i.data=!0);var n=t.parse(e),s=(new d).compile(n,i);return(new h).compile(s,i)},t.compile=function(i,n){function s(){var s=t.parse(i),a=(new d).compile(s,n),o=(new h).compile(a,n,e,!0);return t.template(o)}if(null==i||"string"!=typeof i&&i.constructor!==t.AST.ProgramNode)throw new t.Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+i);n=n||{},"data"in n||(n.data=!0);var a;return function(t,e){return a||(a=s()),a.call(this,t,e)}},t.VM={template:function(e){var i={escapeExpression:t.Utils.escapeExpression,invokePartial:t.VM.invokePartial,programs:[],program:function(e,i,n){var s=this.programs[e];return n?s=t.VM.program(e,i,n):s||(s=this.programs[e]=t.VM.program(e,i)),s},merge:function(e,i){var n=e||i;return e&&i&&(n={},t.Utils.extend(n,i),t.Utils.extend(n,e)),n},programWithDepth:t.VM.programWithDepth,noop:t.VM.noop,compilerInfo:null};return function(n,s){s=s||{};var a=e.call(i,t,n,s.helpers,s.partials,s.data),o=i.compilerInfo||[],r=o[0]||1,l=t.COMPILER_REVISION;if(r!==l){if(l>r){var c=t.REVISION_CHANGES[l],p=t.REVISION_CHANGES[r];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+c+") or downgrade your runtime to an older version ("+p+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+o[1]+")."}return a}},programWithDepth:function(t,e,i){var n=Array.prototype.slice.call(arguments,3),s=function(t,s){
return s=s||{},e.apply(this,[t,s.data||i].concat(n))};return s.program=t,s.depth=n.length,s},program:function(t,e,i){var n=function(t,n){return n=n||{},e(t,n.data||i)};return n.program=t,n.depth=0,n},noop:function(){return""},invokePartial:function(i,n,s,a,o,r){var l={helpers:a,partials:o,data:r};if(i===e)throw new t.Exception("The partial "+n+" could not be found");if(i instanceof Function)return i(s,l);if(t.compile)return o[n]=t.compile(i,{data:r!==e}),o[n](s,l);throw new t.Exception("The partial "+n+" could not be compiled when running in runtime-only mode")}},t.template=t.VM.template}(Handlebars),define("handlebar",function(){}),define("text",["module"],function(t){"use strict";var e,i,n,s,a,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,p=c&&location.protocol&&location.protocol.replace(/\:/,""),d=c&&location.hostname,h=c&&(location.port||void 0),g={},u=t.config&&t.config()||{};return e={version:"2.0.10",strip:function(t){if(t){t=t.replace(r,"");var e=t.match(l);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:u.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;3>e;e+=1){i=o[e];try{t=new ActiveXObject(i)}catch(n){}if(t){o=[i];break}}return t},parseName:function(t){var e,i,n,s=!1,a=t.indexOf("."),o=0===t.indexOf("./")||0===t.indexOf("../");return-1!==a&&(!o||a>1)?(e=t.substring(0,a),i=t.substring(a+1,t.length)):e=t,n=i||e,a=n.indexOf("!"),-1!==a&&(s="strip"===n.substring(a+1),n=n.substring(0,a),i?i=n:e=n),{moduleName:e,ext:i,strip:s}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,n,s){var a,o,r,l=e.xdRegExp.exec(t);return l?(a=l[2],o=l[3],o=o.split(":"),r=o[1],o=o[0],!(a&&a!==i||o&&o.toLowerCase()!==n.toLowerCase()||(r||o)&&r!==s)):!0},finishLoad:function(t,i,n,s){n=i?e.strip(n):n,u.isBuild&&(g[t]=n),s(n)},load:function(t,i,n,s){if(s.isBuild&&!s.inlineText)return void n();u.isBuild=s.isBuild;var a=e.parseName(t),o=a.moduleName+(a.ext?"."+a.ext:""),r=i.toUrl(o),l=u.useXhr||e.useXhr;return 0===r.indexOf("empty:")?void n():void(!c||l(r,p,d,h)?e.get(r,function(i){e.finishLoad(t,a.strip,i,n)},function(t){n.error&&n.error(t)}):i([o],function(t){e.finishLoad(a.moduleName+"."+a.ext,a.strip,t,n)}))},write:function(t,i,n,s){if(g.hasOwnProperty(i)){var a=e.jsEscape(g[i]);n.asModule(t+"!"+i,"define(function () { return '"+a+"';});\n")}},writeFile:function(t,i,n,s,a){var o=e.parseName(i),r=o.ext?"."+o.ext:"",l=o.moduleName+r,c=n.toUrl(o.moduleName+r)+".js";e.load(l,n,function(i){var n=function(t){return s(c,t)};n.asModule=function(t,e){return s.asModule(t,c,e)},e.write(t,l,n,a)},a)}},"node"===u.env||!u.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=require.nodeRequire("fs"),e.get=function(t,e,n){try{var s=i.readFileSync(t,"utf8");0===s.indexOf("\ufeff")&&(s=s.substring(1)),e(s)}catch(a){n(a)}}):"xhr"===u.env||!u.env&&e.createXhr()?e.get=function(t,i,n,s){var a,o=e.createXhr();if(o.open("GET",t,!0),s)for(a in s)s.hasOwnProperty(a)&&o.setRequestHeader(a.toLowerCase(),s[a]);u.onXhr&&u.onXhr(o,t),o.onreadystatechange=function(e){var s,a;4===o.readyState&&(s=o.status,s>399&&600>s?(a=new Error(t+" HTTP status: "+s),a.xhr=o,n(a)):i(o.responseText),u.onXhrComplete&&u.onXhrComplete(o,t))},o.send(null)}:"rhino"===u.env||!u.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var i,n,s="utf-8",a=new java.io.File(t),o=java.lang.System.getProperty("line.separator"),r=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),s)),l="";try{for(i=new java.lang.StringBuffer,n=r.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=r.readLine());)i.append(o),i.append(n);l=String(i.toString())}finally{r.close()}e(l)}:("xpconnect"===u.env||!u.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,s=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in n,e.get=function(t,e){var i,o,r,l={};a&&(t=t.replace(/\//g,"\\")),r=new FileUtils.File(t);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream),i.init(r,1,0,!1),o=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream),o.init(i,"utf-8",i.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(i.available(),l),o.close(),i.close(),e(l.value)}catch(c){throw new Error((r&&r.path||"")+": "+c)}}),e}),define("text!templates/widget.html",[],function(){return'<div class="container_tpwid01">\r\n    <!-- start widget -->\r\n    <div id="widgetbx" class="widgetbx">\r\n        <div id="single" class="panel" style="height: 145px;">\r\n            </div>\r\n\r\n        <!-- start panel -->\r\n        <div id="multiple" class="panel">\r\n            <ul class="widgetbxlistnav">\r\n                <li id="tpdaily" class="active"><a rel="today" onclick="timespointsapp.widget.setWidgetDuration(\'daily\',\'{{{channel}}}\');" href="javascript:void(0)" >Today</a></li>\r\n                <li id="tpweekly"><a rel="last7days" onclick="timespointsapp.widget.setWidgetDuration(\'weekly\',\'{{{channel}}}\');" href="javascript:void(0)">7 Days	</a></li>\r\n                <li id="tpmonthly"><a rel="last30days" onclick="timespointsapp.widget.setWidgetDuration(\'monthly\',\'{{{channel}}}\');" href="javascript:void(0)">30 Days</a></li>\r\n            </ul>\r\n            <div class="widgetbxlist">\r\n            <!--to display users leaderboard by using widget User.html-->\r\n                <div id="widgetscroll">\r\n                </div>\r\n                <div class="clear"></div>\r\n            </div>\r\n        </div>\r\n        <!-- end panel -->\r\n        <!-- start panel -->\r\n        <div id="multipleall" class="panel">\r\n            <ul class="widgetbxlistnav">\r\n                <li id="tpdailyall" class="active"><a rel="today" onclick="timespointsapp.widget.setWidgetDuration(\'daily\',\'all\');" href="javascript:void(0)" >Today</a></li>\r\n                <li id="tpweeklyall"><a rel="last7days" onclick="timespointsapp.widget.setWidgetDuration(\'weekly\',\'all\');" href="javascript:void(0)">7 Days	</a></li>\r\n                <li id="tpmonthlyall"><a rel="last30days" onclick="timespointsapp.widget.setWidgetDuration(\'monthly\',\'all\');" href="javascript:void(0)">30 Days</a></li>\r\n            </ul>\r\n            <div class="widgetbxlist">\r\n                <!--to display users leaderboard by using widget User.html-->\r\n                <div id="widgetscrollall">\r\n                </div>\r\n                <div class="clear"></div>\r\n            </div>\r\n        </div>\r\n        <!-- end panel -->\r\n        <!-- start widgetbxnav -->\r\n        <div class="widgetbxnav">\r\n            <a href="http://timespoints.com/" target="_blank" title="Times Points"><img src="{{{logo}}}" alt="Times Points" /></a>\r\n            <ul class="widgetbxtab">\r\n                <li title="{{{profileTitle}}}" id="singletab" class="single"><a href="javascript:void(0)" onclick="timespointsapp.widget.setLoginBadge();">single</a></li>\r\n                <li title="{{{channelTitle}}}" id="multipletab" class="multiple"><a onclick="timespointsapp.widget.setWidgetDuration(\'daily\',\'{{{channel}}}\');" href="javascript:void(0)">multiple</a></li>\r\n                <li title="{{{allTitle}}}" id="multipletaball" class="all"><a onclick="timespointsapp.widget.setWidgetDuration(\'daily\',\'all\');" href="javascript:void(0)">multiple</a></li>\r\n            </ul>\r\n        </div>\r\n        <!-- end widgetbxnav -->\r\n    </div>\r\n    </div>'}),define("text!templates/widgetUser.html",[],function(){return'<ul>\r\n{{#each users}}\r\n    <li>\r\n        <img src="{{{img}}}" alt="pic" />\r\n        <div class="txt">\r\n            <span><a href="{{{url}}}" target="_blank">{{{name}}}</a></span>\r\n            <a href="{{{url}}}" target="_blank" class="{{{statusclass}}}">{{{status}}}</a>\r\n        </div>\r\n        <small><b>{{{points}}}</b>Points</small>\r\n        <div class="clear"></div>\r\n    </li>\r\n{{/each}}\r\n</ul>'}),define("text!templates/widgetPrelogin.html",[],function(){return'<div class="txt2">\r\n    <img src="{{{badge.activeImage}}}" alt="img" align="left" style="width:100px;" />\r\n    <strong>{{{badge.name}}}</strong>\r\n    <span>{{{badge.desc}}}</span>\r\n\r\n    <small class="btn" style="cursor: pointer;" data-action="login" onclick="javascript:{{{loginMethod}}}$(\'body\').scrollTop(0);">{{{claimMedals}}}</small>\r\n</div>'}),define("text!templates/widgetPostlogin.html",[],function(){return'<div class="user" id="postloginuser">\r\n    <img id="postloginimage" style="height:75px;width:75px;" src="http://image.timespoints.iimg.in/static/images/homepage/hp_usergolden-default.jpg" align="left">\r\n    <strong id="postloginusername"></strong>\r\n    <small id="postloginuserstatus" class="btn"></small>\r\n    <small id="postloginuserpoints"> </small>\r\n    <div style="font-size:18px; text-align:center; margin-top:20px;" id="timeoutmsg">Oops! something went wrong</div>\r\n    <div id="timesout"></div>\r\n</div>\r\n<div class="clear"></div>\r\n<div class="slidertp" >\r\n    <ul class="sliderbx" id="postloginbadges" style="height: 52px;">\r\n        <div class="page_loading_indicator" style="z-index: 9999; display: block;"></div>\r\n    </ul>\r\n</div>\r\n<div class="clear"></div>'}),define("text!templates/widgetPostloginUser.html",[],function(){return'<img src="{{{user.img}}}" alt="{{{user.name}}}" align="left"/>\r\n<strong>{{{user.name}}}</strong>\r\n<span>{{{user.status}}}</span>\r\n<small>Points earned <b>{{{user.points}}}</b></small>\r\n'}),define("text!templates/widgetPostloginBadges.html",[],function(){return'{{#badges}}\r\n        <li class="chart" data-percent="{{{percentage}}}" data-scale-color="#ffb400">\r\n                <a href="javascript:void(0)">\r\n                        <img src="{{{img}}}" alt="{{{name}}}"/>\r\n                </a>\r\n        </li>\r\n{{/badges}}'}),define("text!templates/widgetPostlogout.html",[],function(){return'<div class="user txt2" id="postlogoutuser" style="padding:0 10px 0 0; width:288px;">\r\n    <img id="postlogoutimage" style="height:75px;width:75px; margin-top:0;" src="http://image.timespoints.iimg.in/static/images/homepage/hp_usergolden-default.jpg" align="left">\r\n    <strong id="postlogoutusername">Hi User</strong>\r\n\r\n    <small class="btn" style="font-size:12px; margin-top:10px;cursor: pointer;" data-action="login" onclick="javascript:{{{loginMethod}}}$(\'body\').scrollTop(0);">{{{claimMedals}}}</small>\r\n</div>\r\n<div class="clear"></div>\r\n<div class="slidertp" style="height: 52px;">\r\n    <ul class="sliderbx" id="postlogoutbadges">\r\n        <div class="page_loading_indicator" style="z-index: 9999; display: block;"></div>\r\n    </ul>\r\n    <div class="clear"></div>\r\n</div>\r\n<div class="clear"></div>\r\n'}),define("tpwidget",["tpointutil","jquery","taffy","slider","handlebar","text!templates/widget.html","text!templates/widgetUser.html","text!templates/widgetPrelogin.html","text!templates/widgetPostlogin.html","text!templates/widgetPostloginUser.html","text!templates/widgetPostloginBadges.html","text!templates/widgetPostlogout.html"],function(t,e,i,n,s,a,o,r,l,c,p,d){return{widgetDb:TAFFY().store("widgetDb"),init:function(){if(e("#timespointwidget").length>0){t.loadCss(timespointsapp.config.getWidgetCSSAPI());var i=Handlebars.compile(a);e("#timespointwidget").html(i({link:timespointsapp.config.getChannelUrl(),logo:timespointsapp.config.getLogo(),channel:timespointsapp.channelCode,channelTitle:timespointsapp.config.getCurrentChannelNameLang(),allTitle:timespointsapp.config.getAllTitle(),profileTitle:timespointsapp.config.getProfileTitle()})),this.setWidgetDuration("daily",timespointsapp.channelCode)}},getFeed:function(t,i){var n=timespointsapp.config.getLeaderBoradAPI()+i+"/"+t+"?version="+timespointsapp.version(),s=this.checkWidgetData(t,i);s===!1?e.ajax({url:n,type:"GET",cache:!1,dataType:"jsonp",success:function(t){timespointsapp.widget.saveWidgetData(t)}}):this.setWidgetData(s,i)},getWidgetDbSavedObject:function(t){var e=this.widgetDb({c_sc:timespointsapp.util.getChannelSpecificKey()}).first().data;return timespointsapp.util.filterArray(e,t)},saveWidgetData:function(t){var e={date:(new Date).getTime(),data:t.data,duration:t.duration,channel:t.channel},i=timespointsapp.util.getChannelSpecificData(e);this.widgetDb.insert(i),this.setWidgetData(e.data,t.channel)},checkWidgetData:function(e,i){var n=(new Date).getTime()-36e5,s=t.dayFirstTimeStamp(),a=this.getWidgetDbSavedObject({duration:e,channel:i});if(a&&0===a.length)return!1;if("daily"===a[0].duration&&a[0].date<=n){var o=this.getWidgetDbSavedObject({duration:{ne:e},channel:{ne:i}});return this.widgetDb({c_sc:timespointsapp.util.getChannelSpecificKey()}).update({data:o}),!1}if("daily"!==a[0].duration&&a[0].date<=s){var o=this.getWidgetDbSavedObject({duration:{ne:e},channel:{ne:i}});return this.widgetDb({c_sc:timespointsapp.util.getChannelSpecificKey()}).update({data:o}),!1}return a[0].data},setWidgetData:function(t,i){for(var n=Handlebars.compile(o),s=Array(),a=0;5>a;a++){var r=t[a],l=new Object;l.img=r.thumb,l.name=r.name,l.url=r.profileUrl,l.rank=r.rank,l.points=r.points,l.statusclass="clr-"+r.levelName.toLowerCase()+" btn",l.status=r.levelName,s[a]=l}"all"===i?e("#widgetscrollall").html(n({users:s})):e("#widgetscroll").html(n({users:s}))},setWidgetDuration:function(i,n){t.loadLoadingDiv("widgetscroll"),e("#single").hide(),e("#multipleall").hide(),e("#multiple").hide(),e("#singletab").removeClass("active"),e("#tpdaily").removeClass("active"),e("#tpweekly").removeClass("active"),e("#tpmonthly").removeClass("active"),e("#tpdailyall").removeClass("active"),e("#tpweeklyall").removeClass("active"),e("#tpmonthlyall").removeClass("active"),e("#multipletaball").removeClass("active"),e("#multipletab").removeClass("active"),"all"===n?(e("#multipleall").show(),e("#tp"+i+"all").addClass("active"),e("#multipletaball").addClass("active")):(e("#multiple").show(),e("#tp"+i).addClass("active"),e("#multipletab").addClass("active")),this.getFeed(i,n)},setLoginBadge:function(){e("#multipleall").hide(),e("#multiple").hide(),e("#singletab").addClass("active"),e("#multipletab").removeClass("active"),e("#multipletaball").removeClass("active"),t.loadLoadingDiv("single");var i=timespointsapp.prelogin.checkLogin();if(i.status===!1&&null===timespointsapp.transaction.checkCredit()){var n=timespointsapp.badgemaster.getPreloginBadgeForUser()[0];if(n){n.desc=timespointsapp.config.getUserYou()+" "+n.desc;var s=Handlebars.compile(r);e("#single").html(s({badge:n,currentDomain:t.getChannelCodeByDomain(timespointsapp.domain),currentSubDomain:t.getSubChannelCodeByDomain(timespointsapp.domain),claimMedals:timespointsapp.config.getClaimMedalText(),loginMethod:t.getLoginMethodByDomainName(timespointsapp.domain)}))}else console.log("Please check  __activity variable in page and set some default activities in it.");e("#single").addClass("ideapromo")}else if(i.status===!1&&null!==timespointsapp.transaction.checkCredit()){var s=Handlebars.compile(d);e("#single").html(s({badge:n,currentDomain:t.getChannelCodeByDomain(timespointsapp.domain),currentSubDomain:t.getSubChannelCodeByDomain(timespointsapp.domain),claimMedals:timespointsapp.config.getClaimMedalText(),loginMethod:t.getLoginMethodByDomainName(timespointsapp.domain)})),this.getAllInactiveBadges(),e("#single").addClass("ideapromo")}else i.status===!0&&(e("#single").html(l),e("#postloginimage").hide(),e("#timeoutmsg").hide(),this.getPostLoginWidgetDetails(i.user.userId));e("#single").show()},getPostLoginWidgetDetails:function(t){setTimeout(function(){e("#single").find(".page_loading_indicator").hide()},3e3),e("#single").find(".page_loading_indicator").show();var i=timespointsapp.config.getPostLoginWidgetDetailsAPI()+"?uid="+t+"&format=JSON&version="+timespointsapp.version();e.ajax({url:i,type:"GET",cache:!1,dataType:"jsonp",success:function(t){timespointsapp.widget.processPostLoginWidgetDatafromTimesPoints(t)},timeout:3e3,error:function(i,n,s){if("timeout"===n||"error"===n){var a=document.createElement("div");a.setAttribute("style","margin-top:10px; text-align:center; font-size:18px;");var o=document.createElement("a");o.setAttribute("id","retry"),o.setAttribute("onclick","timespointsapp.widget.getPostLoginWidgetDetails('"+t+"');"),o.setAttribute("href","javascript:void(0)");var r=document.createElement("img");r.setAttribute("src","http://image.timespoints.iimg.in/scripts/components/images/retry_icon.png"),r.setAttribute("style","width:25px; height:25px; border:0 !important;"),o.appendChild(r);var l=document.createTextNode("Retry");o.appendChild(l),a.appendChild(o),e("#timesout").replaceWith(e(a)),e("#timeoutmsg").show()}}})},processPostLoginWidgetDatafromTimesPoints:function(t){e("#timeoutmsg").hide(),e("#retry").hide(),e("#postloginimage").show(),t&&e("#loginsave").show(),e("#postloginimage").attr("src",t.thumb),e("#postloginusername").html(t.FL_N),e("#postloginuserpoints").length>0&&(e("#postloginuserpoints").html(timespointsapp.config.getPointsEarnedLang()+" <b>"+t.points+"</b>"),e("#postloginuserstatus").replaceWith('<span id="postloginuserstatus" class="btn">'+t.levelName+" Member </span>"),e("#postloginuserstatus").addClass("clr-"+t.levelName.toLowerCase())),e("#bottompostloginuserstatus").length>0&&(e("#bottompostloginuserstatus").html(t.levelName+" Member: "+t.currentPoints),e("#bottompostloginuserstatus").addClass("clr-"+t.levelName.toLowerCase())),this.processBadgesforUser(t)},getUserfromMyTimes:function(t){e.ajax({url:timespointsapp.config.getMyTimesAPI()+"?ssoId="+t.userId+"&format=JSON&version="+timespointsapp.version(),type:"GET",cache:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.widget.processUserfromMyTimes",timeout:3e3})},processUserfromMyTimes:function(t){e("#postloginimage").attr("src",t.thumb),e("#postloginusername").html(t.FL_N)},getPointsfromTimesPoints:function(t){e.ajax({url:timespointsapp.config.getUserPointsAPI()+"?uid="+t.userId+"&version="+timespointsapp.version(),type:"GET",cache:!1,dataType:"jsonp",success:function(t){timespointsapp.widget.processPointsfromTimesPoints(t)}})},processPointsfromTimesPoints:function(t){t&&e("#loginsave").show(),e("#postloginuserpoints").length>0&&(e("#postloginuserpoints").html(t.points),e("#postloginuserstatus").html(t.levelName+" Member"),e("#postloginuserstatus").addClass("clr-"+t.levelName.toLowerCase())),e("#bottompostloginuserstatus").length>0&&(e("#bottompostloginuserstatus").html(t.levelName+" Member: "+t.currentPoints),e("#bottompostloginuserstatus").addClass("clr-"+t.levelName.toLowerCase()))},getBadgesForUser:function(t){e.ajax({url:timespointsapp.config.getUserBadgeAPI()+"?pcode="+t.host+"&uid="+t.userId+"&format=JSON&version="+timespointsapp.version(),type:"GET",cache:!1,dataType:"jsonp",success:function(t){timespointsapp.widget.processBadgesforUser(t)}})},processBadgesforUser:function(t){for(var i=new Array,n=t.active,s=t.inactive,a=0;a<n.length;a++){var o=timespointsapp.badgemaster.getBadgeById(n[a]),r="";0!=o.nextLevelId&&(r=timespointsapp.badgemaster.getBadgeById(o.nextLevelId));var l=new Object;l.name=o.name,l.img=o.activeImage+"/65",""!==r?l.percentage=0-o.threshold/r.threshold*100:l.percentage=-100,i[i.length]=l}for(var a=0;a<s.length;a++){var o=timespointsapp.badgemaster.getBadgeById(s[a]),l=new Object;l.name=o.name,l.img=o.inActiveImage+"/65",l.percentage=0,i[i.length]=l}var c=Handlebars.compile(p);e("#postloginbadges").html(c({badges:i}));try{timespointsapp.util.pieChart(".chart",24,52)}catch(d){console.log(d)}this.createSlider("postloginbadges")},getAllInactiveBadges:function(){var t=new Array,i=timespointsapp.badgemaster.getPostLogoutBadgesForUser();e.each(i,function(e,i){var n=new Object;n.name=i.name,n.img=i.inActiveImage+"/65",n.percentage=0,t[t.length]=n});var n=Handlebars.compile(p);e("#postlogoutbadges").html(n({badges:t})),timespointsapp.util.pieChart(".chart",24,52),this.createSlider("postlogoutbadges")},createSlider:function(t){try{e("#"+t).amtslider({itemWidth:62,infiniteloop:!0,itemstodisplay:4})}catch(i){console.log(i)}}}}),define("text!templates/tpBottomDetail.html",[],function(){return'<div id = "TPMainDiv" class="container_tpwid02">\r\n    <div id="loginsave" class="loginbx Source_Sans" style="display:none;">\r\n        <!--Pop up Fugga start-->\r\n        <div class="loginsave" id="preloginpop">\r\n        </div>\r\n        <!--Pop up Fugga End-->\r\n        <div class="loginlogo longLength"><a href="http://www.timespoints.com" target="_blank"><img src="{{{logo}}}" alt="logo"></a></div>\r\n        <div class="logintxt"><span id = "preloginbottompoints">{{{points}}}</span></div>\r\n        <!-- Use this Class for Arrow Dawn = "arrow_down" -->\r\n        <div class="loginbell">\r\n            <a href="javascript:void(0)" onclick="timespointsapp.prelogin.openBottomPop();" id="loginsavebell">bell</a>\r\n        </div>\r\n        <div class="adsContainer" style="display: none;">\r\n            <a href="javascript:;" onclick="timespointsapp.config.openAds();"></a>\r\n        </div>\r\n\r\n    </div>\r\n</div>\r\n'}),define("text!templates/tpOpenMiniNotification.html",[],function(){return'<a href="javascript:void(0);" onclick="$(\'#loginsave\').removeClass(\'open\');timespointsapp.prelogin.hideBottomDetailDelayed();" id="loginsaveclose" class="loginsaveclose">X</a>\r\n <span class="icon_img"></span>\r\n<span class="first hinditext hfont22">{{{youhaveearned}}}</span>\r\n<div class="coinbox"><span>{{{points}}}</span></div>\r\n<span class="hinditext hfont22">{{{badgecounttext}}}</span>\r\n<div class="clear"></div>\r\n<ul id="popupBadges">\r\n    {{#badges}}\r\n    <li><img src="{{{activeImage}}}" alt="{{{name}}}" style="width: 63px;"><small>{{{name}}}</small></li>\r\n    {{/badges}}\r\n</ul>\r\n<div class="clear"></div>\r\n\r\n<p onclick="javascript:{{{loginMethod}}}$(\'body\').scrollTop(0);" style="cursor: pointer;" data-action="login" class="btn hinditext">{{{claimtext}}}</p>\r\n<div class="btnC">{{{lasttext}}}</div>\r\n<h6 onclick="javascript:timespointsapp.prelogin.openAboutTimesPoints()" class="hinditext hfont22">{{{badgetext}}}</h6>\r\n<div class="clear"></div>\r\n'}),define("text!templates/tpPostLoginBottomDetail.html",[],function(){return'<div id = "TPMainDiv" class="container_tpwid02">\r\n    <div id="loginsave" class="loginbx Source_Sans" style="display:none;">\r\n        <div class="loginsave" id="postloginpop">\r\n        </div>\r\n        <div class="loginlogo" ><a href="javascript:;"><img src="{{{logo}}}" alt="logo" /></a></div>\r\n        <div class="logintxt longLength"><small id="bottompostloginuserstatus">Member</small></div>\r\n        <!-- Use this Class for Arrow Dawn = "arrow_down" -->\r\n        <div class="loginbell" style="cursor: pointer;position: relative">\r\n            <div onclick="timespointsapp.prelogin.getAllnotifications()">\r\n                <a href="javascript:void(0)" id="loginsavebell">bell</a>\r\n            </div>\r\n        </div>\r\n        <div class="adsContainer" style="display: none;"  >\r\n            <a href="javascript:;" onclick="timespointsapp.config.openAds();"></a>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("text!templates/tpPostLoginNotification.html",[],function(){return'<!--Pop up Fugga start-->\r\n    <a href="javascript:void(0);" onclick="$(\'#loginsave\').removeClass(\'open\');timespointsapp.prelogin.hideBottomDetailDelayed();" id="loginsaveclose" class="loginsaveclose">X</a>\r\n    <div class="sliderpop2">\r\n        <ul class="sliderpop sliderbx" id="badgesNotifSlider">\r\n            {{#badges}}\r\n            <li>\r\n                <div class="headerChannelName">{{{channelDName}}}</div>\r\n                <img src="{{{img}}}" alt="img" style="height:100px;"/>\r\n                <span>{{name}}</span>\r\n                <small>{{levelName}}</small>\r\n                <div class="hinditext descDiv" id="bNotif_{{{id}}}" >\r\n                    <div style="padding:0 15px;" class="notifTrimmedDesc">{{{trimmedDesc}}}</div>\r\n                    <div style="padding:0 15px;display: none;" class="notifFullDesc" >{{{desc}}}</div>\r\n                </div>\r\n                <div class="clear"></div>\r\n            </li>\r\n            {{/badges}}\r\n        </ul>\r\n    </div>\r\n    <div class="clear"></div>\r\n    <p style="cursor: default;" class="btn hinditext">{{{newMedals}}}</p>\r\n\r\n    <div class="btnC"><a href="javascript:;" style="text-decoration: none;" onclick="javascript:timespointsapp.prelogin.openAboutTimesPoints()" >{{{showAllMedals}}}</a></div>\r\n    <div class="clear"></div>\r\n<!--Pop up Fugga End-->'}),define("prelogin",["jquery","tpointutil","taffy","handlebar","text!templates/tpBottomDetail.html","text!templates/tpOpenMiniNotification.html","text!templates/tpPostLoginBottomDetail.html","text!templates/tpPostLoginNotification.html"],function(t,e,i,n,s,a,o,r){"use strict";return{init:function(){var i=timespointsapp.prelogin.checkLogin();t("#TPMainDiv").remove();var n=[];if("undefined"!=typeof __activity?0==__activity.length?n.push("register"):n=__activity:n=[],i.status===!0&&timespointsapp.transaction.getTotalPoints()>0){t("#timespointscommon").length<=0&&(e.loadCss(timespointsapp.config.getPostLoginCSSAPI()),timespointsapp.prelogin.displayPostLoginMiniNotification(i)),timespointsapp.transaction.checkPrelogin(i.user);for(var s=0;s<n.length;s++)timespointsapp.transaction.logRemoteActivity(n[s],"",i.user)}else if(i.status===!0){t("#timespointscommon").length<=0&&(e.loadCss(timespointsapp.config.getPostLoginCSSAPI()),timespointsapp.prelogin.displayPostLoginMiniNotification(i));for(var s=0;s<n.length;s++)timespointsapp.transaction.logRemoteActivity(n[s],"",i.user)}else if(i.status===!1&&null===timespointsapp.transaction.checkCredit()){for(var s=0;s<n.length;s++)timespointsapp.transaction.addActivity(n[s]);t("#timespointscommon").length<=0&&(e.loadCss(timespointsapp.config.getPreLoginCSSAPI()),timespointsapp.prelogin.displayMiniNotification())}else i.status===!1&&null!==timespointsapp.transaction.checkCredit()&&timespointsapp.prelogin.hideMiniNotification();timespointsapp.config.getWidgetAdsData()},hideMiniNotification:function(){t("#TPMainDiv").length>0&&t("#TPMainDiv").remove()},addActivity:function(e){if(timespointsapp.transaction.addActivity(e),t("#TPMainDiv").length>0&&t("#timespointscommon").length<=0){var i=timespointsapp.transaction.getTotalPoints();i>0&&(t("#loginsave").show(),t("#preloginbottompoints").html(i))}},displayMiniNotification:function(){if(t("#TPMainDiv").length<=0&&t("#timespointscommon").length<=0){var e=Handlebars.compile(s),i={points:timespointsapp.transaction.getTotalPoints(),logo:timespointsapp.config.getLogo()};t("body").append(e(i)),t("#loginsave").show(),t("#TPMainDiv").show(),timespointsapp.prelogin.hideBottomDetailDelayed()}},hideBottomDetailDelayed:function(i){if("TOI"==e.getChannelCodeByDomain(timespointsapp.domain)){var n=setTimeout(function(){t("#TPMainDiv").remove(),t("#loginsave").remove()},i?i:4e3);timespointsapp.timeoutTimer=n}},clearBottomDetailHideTimeout:function(){clearTimeout(timespointsapp.timeoutTimer),timespointsapp.prelogin.hideBottomDetailDelayed(1e4)},displayPostLoginMiniNotification:function(e){if(t("#TPMainDiv").length<=0&&t("#timespointscommon").length<=0){var i=Handlebars.compile(o),n={logo:timespointsapp.config.getLogoIconUrl()};t("body").append(i(n)),t("#TPMainDiv").show(),timespointsapp.prelogin.hideBottomDetailDelayed()}timespointsapp.widget.getPointsfromTimesPoints(e.user)},checkNotificationCount:function(){var i=e.getChannelCodeByDomain(timespointsapp.domain),n=timespointsapp.config.getNotificationCountAPI()+i+"&version="+timespointsapp.version();t.ajax({url:n,type:"GET",cache:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.prelogin.processNotificationCount"})},processNotificationCount:function(e){if(e){var i=parseInt(e),n='<div class="newNotificationCount"><a href="javascript:void(0)" id="loginsavebell">bell</a> <div class="notificationCounter" id="notificationCounter" style="border-radius:10px;position:absolute; line-height: 20px; font-size: 14px; width:20px; height:20px; right:0; top:0; background:#fff; text-align:center;">'+i+"</div></div>";t(".loginbell").html(n),t(".loginbell .newNotificationCount").on("click",function(){timespointsapp.prelogin.clearBottomDetailHideTimeout(),timespointsapp.prelogin.checkNewBadgesNotification()})}},openBottomPop:function(){timespointsapp.prelogin.displayOpenMiniNotification()},displayOpenMiniNotification:function(){timespointsapp.prelogin.clearBottomDetailHideTimeout();var i=new Object;switch(i.badges=timespointsapp.badgemaster.getPreloginBadgeForUser(),i.points=timespointsapp.transaction.getTotalPoints(),i.badges.length){case 1:i.badgecounttext=timespointsapp.config.getOneBadge();break;case 2:i.badgecounttext=timespointsapp.config.getTwoBadge();break;case 3:i.badgecounttext=timespointsapp.config.getThreeBadge()}i.lasttext=timespointsapp.config.getLoginAndSaveDesc(),i.claimtext=timespointsapp.config.getLoginAndSave(),i.channelurl=timespointsapp.config.getChannelUrl(),i.badgetext=timespointsapp.config.getWhatAreBadges(),i.youhaveearned=timespointsapp.config.getYouHaveNotEarned(),i.currentDomain=e.getChannelCodeByDomain(timespointsapp.domain),i.currentSubDomain=e.getSubChannelCodeByDomain(timespointsapp.domain),i.loginMethod=e.getLoginMethodByDomainName(timespointsapp.domain);var n=Handlebars.compile(a);t("#preloginpop").html(n(i)),t("#loginsave").hasClass("open")||(t("#loginsave").removeClass("adsOpen"),t("#loginsave").addClass("open")),t("#preloginpop").hasClass("ads")&&(t("#preloginpop").removeClass("ads"),t("#preloginpop").addClass("notif"))},checkLogin:function(){var t=window._tp_async_data;return void 0!==t&&t.URL&&t.host&&t.channel&&t.email&&t.userId?{user:t,status:!0}:{status:!1}},checkNewBadgesNotification:function(){var i=e.getChannelCodeByDomain(timespointsapp.domain),n=timespointsapp.config.getNotificationAPI()+"&pname="+i+"&uid="+login.user.userId+"&version="+timespointsapp.version();t.ajax({url:n,type:"GET",cache:!1,dataType:"jsonp",success:timespointsapp.prelogin.processNotifications})},getAllnotifications:function(){timespointsapp.prelogin.clearBottomDetailHideTimeout();var i=e.getChannelCodeByDomain(timespointsapp.domain),n=timespointsapp.prelogin.checkLogin(),s=timespointsapp.config.getNotificationAllAPI()+"&pname="+i+"&uid="+n.user.userId+"&version="+timespointsapp.version();t.ajax({url:s,type:"GET",cache:!1,dataType:"jsonp",success:timespointsapp.prelogin.processNotifications})},processNotifications:function(e){if(e){for(var i=[],n=0;n<e.length;n++){var s=new Object;s.img=e[n].activeImage,s.trimmedDesc=timespointsapp.util.trunc(e[n].notificationText,200,!0),s.desc=e[n].notificationText,s.name=e[n].badgeName,s.levelName=e[n].badgeLevel,s.id=e[n].badgeId,s.channelDName=timespointsapp.config.getChannelNameFromAllChannels(e[n].pName),i.push(s)}if(i.length>0){var a='<div onclick="timespointsapp.prelogin.getAllnotifications()"><a href="javascript:void(0)" id="loginsavebell">bell</a></div>';t(".loginbell").html(a),timespointsapp.prelogin.openPostLoginNotifications(i)}else{var a='<div ><a href="javascript:void(0)" id="loginsavebell">bell</a></div>';t(".loginbell").html(a)}t("#postloginpop").hasClass("ads")&&(t("#postloginpop").removeClass("ads"),t("#postloginpop").addClass("notif"))}timespointsapp.prelogin.clearBottomDetailHideTimeout();
},openPostLoginNotifications:function(e){if(e.length>0){var i=Handlebars.compile(r),n=e.length>1?timespointsapp.config.getNewMedalText():timespointsapp.config.getNewMedalSingularText();t("#postloginpop").html(i({badges:e,channelurl:timespointsapp.config.getChannelUrl(),claimMedals:timespointsapp.config.getClaimMedalText(),showAllMedals:timespointsapp.config.getShowAllMedalsText(),newMedals:n})),t("#loginsave").removeClass("adsOpen"),t("#loginsave").addClass("open"),e.length>1&&t("#badgesNotifSlider").amtslider({itemWidth:255,infiniteloop:!0,itemstodisplay:1,nextClickCallback:function(){timespointsapp.prelogin.clearBottomDetailHideTimeout()},prevClickCallback:function(){timespointsapp.prelogin.clearBottomDetailHideTimeout()}}),timespointsapp.prelogin.bindHoverEffect(e)}},showNotifications:function(){},bindHoverEffect:function(e){for(var i=0;i<e.length;i++){var n=e[i];n.desc&&n.desc.length>200&&t("#bNotif_"+n.id).hover(function(){t(this).find(".notifTrimmedDesc").hide(),t(this).find(".notifFullDesc").addClass("expandEffect")},function(){t(this).find(".notifFullDesc").removeClass("expandEffect"),t(this).find(".notifTrimmedDesc").show()})}},openAboutTimesPoints:function(){var e=timespointsapp.config.getChannelUrl(),i=timespointsapp.config.getCrossDomainGetTicketApi(),n=window.open("about:blank","aboutTP");t.ajax({url:i,type:"GET",cache:!1,async:!1,dataType:"jsonp",success:function(t){if(e+="?utm_source="+timespointsapp.channelCode+"&utm_medium=prelogin_widget&utm_campaign=notifications","true"==t.status&&""!=t.ticketId){var i=timespointsapp.util.encodeToBase64(t.ticketId);e+="&et="+i}n.location.href=e}})}}}),define("badgemaster",["jquery","tpointutil","taffy"],function(t,e,i){"use strict";return{badgeDb:TAFFY().store("badgeDb"),init:function(){this.getBadgeDataFromServer()},getBadgeDataFromServer:function(){var e=this.getBadgeDbSavedObject({});if(e&&0===e.length){var i=timespointsapp.config.getAllBadgeAPI()+"?version="+timespointsapp.version();t.ajax({url:i,type:"GET",cache:!0,async:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.badgemaster.storeBadgeDataInDB"})}else{var i=timespointsapp.config.getDeltaBadgeAPI()+"?version="+timespointsapp.version()+"&deltaDate="+timespointsapp.deltaDate();t.ajax({url:i,type:"GET",cache:!0,async:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.badgemaster.storeDeltaBadgeDataInDB"})}},storeBadgeDataInDB:function(t){var e=timespointsapp.util.getChannelSpecificData(t);this.badgeDb.insert(e),timespointsapp.activitymaster.init()},storeDeltaBadgeDataInDB:function(t){var e=timespointsapp.badgemaster.getBadgeDbSavedObject({});if(t.length>0){for(var i=0;i<t.length;i++)for(var n=t[i].id,s=0;s<e.length;s++)e[s].id===n&&e.splice(s,1);for(var i=0;i<t.length;i++)e.push(t[i]);timespointsapp.badgemaster.badgeDb().remove(!0),this.storeBadgeDataInDB(e)}else timespointsapp.activitymaster.init()},getBadgeDbSavedObject:function(t){var e=this.badgeDb({c_sc:timespointsapp.util.getChannelSpecificKey()}).first(),i=e?e.data:[];return timespointsapp.util.filterArray(i,t)},getBadgeById:function(t){var e=this.getBadgeDbSavedObject({id:t});return e.length>0?e[0]:!1},getBadgeByFamilyId:function(t){var e=this.getBadgeDbSavedObject({familyId:t});return timespointsapp.util.sortResults(e,"level",!0)},getBadgeCountByFamilyId:function(t){return this.getBadgeDbSavedObject({familyId:t}).length},getBadgeByFamilyIdAndLevel:function(t,e){return this.getBadgeDbSavedObject({familyId:t,level:e})[0]},getBadgeByLevel:function(t){return this.getBadgeDbSavedObject({level:t})},getPreLoginBadges:function(){if(timespointsapp.config.isFromShare())return[];var t=this.getBadgeDbSavedObject({prelogin:!0,level:1});return timespointsapp.util.sortResults(t,"priority",!0)},getBadgeByFamilyIdAndThreshold:function(t,e){var i=this.getBadgeDbSavedObject({familyId:t,threshold:{lte:e}});if(!(i.length>0))return!1;var n=i.length-1;n=0>n?0:n;try{return timespointsapp.util.sortResults(i,"threshold",!0)[n]}catch(s){console.log("No record found for familyId "+t+" and threshost"+e)}},getPreloginBadgeForUser:function(){var e=timespointsapp.badgemaster.getPreLoginBadges(),i=new Array;return t.each(e,function(t,e){var n=timespointsapp.transaction.getBadgeActivityCountFromDB(e.activities),s=timespointsapp.badgemaster.getBadgeByFamilyIdAndThreshold(e.familyId,n);if(s!==!1){var a=new Object;a.id=s.id,a.familyId=s.familyId,a.activeImage=s.activeImage,a.name=s.name,a.desc=s.levelDescripton,i.push(a)}}),i},getPostLogoutBadgesForUser:function(){return timespointsapp.badgemaster.getBadgeByLevel(1)},getAllLevelOneBadges:function(){var t=this.getBadgeDbSavedObject({level:1});return timespointsapp.util.sortResults(t,"priority",!0)}}}),define("activitymaster",["jquery","tpointutil","taffy"],function(t,e,i){"use strict";return{activityDb:TAFFY().store("activityDb"),init:function(){this.getActivityDataFromServer()},getActivityDataFromServer:function(){var e=this.getActivityDbSavedObject({});if(e&&0===e.length){var i=timespointsapp.config.getActivityAPI()+"?version="+timespointsapp.version();t.ajax({url:i,type:"GET",cache:!0,async:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.activitymaster.storeActivityDataInDB"})}else{var i=timespointsapp.config.getDeltaActivityAPI()+"?version="+timespointsapp.version()+"&deltaDate="+timespointsapp.deltaDate();t.ajax({url:i,type:"GET",cache:!0,async:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.activitymaster.storeDeltaActivityDataInDB"}),t("#timespointscommon").length<=0?timespointsapp.prelogin.init():timespointsapp.common.init()}},storeActivityDataInDB:function(t){var e=timespointsapp.util.getChannelSpecificData(t);this.activityDb.insert(e),timespointsapp.widget.init(),timespointsapp.prelogin.init(),timespointsapp.common.init()},storeDeltaActivityDataInDB:function(e){var i=e.deltaData;localStorage.setItem("deltaDate",e.deltaDate);var n=timespointsapp.activitymaster.getActivityDbSavedObject({});if(i.length>0){for(var s=0;s<i.length;s++)for(var a=i[s].channelActivityCode,o=0;o<n.length;o++)n[o].channelActivityCode===a&&n.splice(o,1);for(var s=0;s<i.length;s++)n.push(i[s]);timespointsapp.activitymaster.activityDb().remove(!0),this.storeActivityDataInDB(n)}else timespointsapp.widget.init(),t("#timespointscommon").length<=0?timespointsapp.prelogin.init():timespointsapp.common.init()},getActivityDbSavedObject:function(t){var e=this.activityDb({c_sc:timespointsapp.util.getChannelSpecificKey()}).first(),i=e?e.data:[];return timespointsapp.util.filterArray(i,t)},getPreLoginActivityByName:function(t){return this.getActivityDbSavedObject({activityname:t,prelogin:{gt:0}})[0]},getActivityByName:function(t){return this.getActivityDbSavedObject({activityname:t})[0]},getActivityByCode:function(t){return this.getActivityDbSavedObject({channelActivityCode:t})[0]}}}),define("text!templates/ads.html",[],function(){return'<!--Pop up Fugga start-->\r\n<a href="javascript:void(0);" onclick="$(\'#loginsave\').removeClass(\'adsOpen\');" id="loginsaveclose" class="loginsaveclose">X</a>\r\n<div class="sliderpop2">\r\n    <ul class="sliderpop sliderbx" id="adsSlider">\r\n        {{#ads}}\r\n        <li>\r\n            {{{content}}}\r\n        </li>\r\n        {{/ads}}\r\n    </ul>\r\n</div>\r\n<!--Pop up Fugga End-->'}),define("tpconfig",["jquery","taffy","text!templates/ads.html"],function(t,e,i){"use strict";return{domain:"http://api.timespoints.com/common",configUrl:"/config/",configDb:TAFFY().store("configDb"),domainMappingDb:TAFFY().store("domainMappingDb"),allChannelsDb:TAFFY().store("allChannelsDb"),init:function(){timespointsapp.channelCode=timespointsapp.util.getChannelCodeByDomain(timespointsapp.domain),timespointsapp.siteCode=timespointsapp.util.getSubChannelCodeByDomain(timespointsapp.domain),this.getChannelDataFromServer(),timespointsapp.util.loadCss(this.getAmtSlideCss())},getWidgetAdsData:function(){var e=timespointsapp.config.domain+timespointsapp.config.getWidgetAdsApi()+timespointsapp.channelCode+"?version="+timespointsapp.version();t.ajax({url:e,type:"GET",cache:!0,async:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.config.displayAdsCallBack"})},displayAdsCallBack:function(t){timespointsapp.adsData=t,this.displayAds(t,"callback")},displayAds:function(e,n){if(Object.keys(e).length>0){timespointsapp.util.loadCss(timespointsapp.config.getAdsCSS());var s=e.autoHide,a=Handlebars.compile(i),o=[];if(o.push(e),t("#loginsave>.loginsave").html(a({ads:o})),t("#loginsave .longLength").attr("style","width:152px"),t("#loginsave .adsContainer").show(),t("#postloginpop,#preloginpop").removeClass("notif"),t("#postloginpop,#preloginpop").addClass("ads"),"callback"==n){if(s>0){var r=timespointsapp.util.getCookie("tpPromoClosed");parseInt(r)>0||(t("#loginsave").removeClass("open"),t("#loginsave").addClass("adsOpen"),setTimeout(function(){timespointsapp.config.closeAds()},s))}}else"onclick"==n&&(t("#loginsave").removeClass("open"),t("#loginsave").addClass("adsOpen"))}},openAds:function(){this.displayAds(timespointsapp.adsData,"onclick")},closeAds:function(){t("#loginsave").removeClass("adsOpen");var e=new Date,i=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1,0,0,0),n=timespointsapp.util.getCookie("tpPromoClosed");n=n?parseInt(n)+1:1,timespointsapp.util.setCookie("tpPromoClosed",n,i)},fetchDomainMapping:function(){if(0===this.domainMappingDb().count()){var e=timespointsapp.config.domain+timespointsapp.config.configUrl+"domain/mapping?version="+timespointsapp.version();t.ajax({url:e,type:"GET",cache:!0,async:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.config.storeDomainMappingInDb"})}else this.init()},storeDomainMappingInDb:function(t){this.domainMappingDb.insert(t),this.init()},clearAll:function(){timespointsapp.config.configDb().remove(!0),timespointsapp.config.domainMappingDb().remove(!0),timespointsapp.config.allChannelsDb().remove(!0),timespointsapp.badgemaster.badgeDb().remove(!0),timespointsapp.activitymaster.activityDb().remove(!0),timespointsapp.transaction.transactionDb().remove(!0)},clearLocalDataIfRequired:function(){var e=timespointsapp.config.domain+timespointsapp.config.configUrl+"nocache/version";t.ajax({url:e,type:"GET",cache:!1,async:!1,dataType:"jsonp",success:function(t){(null==localStorage.getItem("tpversion")||localStorage.getItem("tpversion")!=t)&&(timespointsapp.config.clearAll(),localStorage.setItem("tpversion",t)),timespointsapp.config.fetchDomainMapping()}})},getChannelDataFromServer:function(){var e=this.getConfigDbSavedObject();if(e&&0===e.length){var i=this.domain+this.configUrl+timespointsapp.channelCode+"/"+timespointsapp.siteCode+"?version="+timespointsapp.version();t.ajax({url:i,type:"GET",cache:!0,async:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.config.storeChannelDataInDB"})}else this.fetchAllChannelsData()},storeChannelDataInDB:function(t){var e=timespointsapp.util.getChannelSpecificData(t.channelData);localStorage.setItem("deltaDate",t.deltaDate),this.configDb.insert(e),this.fetchAllChannelsData()},fetchAllChannelsData:function(){if(0===this.allChannelsDb().count()){var e=this.domain+this.getAllChannelsApi()+"?version="+timespointsapp.version();t.ajax({url:e,type:"GET",cache:!0,async:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.config.storeAllChannelsDataInDB"})}else{var e=this.domain+this.getAllChannelsApi()+"?version="+timespointsapp.version()+"&time="+timespointsapp.deltaDate();t.ajax({url:e,type:"GET",cache:!0,async:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.config.storeAllChannelsDeltaDataInDB"})}},storeAllChannelsDataInDB:function(t){this.allChannelsDb.insert(t),timespointsapp.badgemaster.init()},storeAllChannelsDeltaDataInDB:function(t){var e=this.allChannelsDb().get();if(t.length>0){for(var i=0;i<t.length;i++)for(var n=t[i].id,s=0;s<e.length;s++)if(e[s].id===n){var a=e[s].___id;this.allChannelsDb(a).remove(!0)}for(var i=0;i<t.length;i++)this.allChannelsDb.insert(t[i])}timespointsapp.badgemaster.init()},getConfigDbSavedObject:function(){var t=this.configDb({c_sc:timespointsapp.util.getChannelSpecificKey()}).first();return t?t.data:[]},getChannelName:function(){return this.getConfigDbSavedObject().name},getChannelUrl:function(){return this.getConfigDbSavedObject().url},getAllBadgeAPI:function(){return this.getConfigDbSavedObject().allBadgeAPI},getUserBadgeAPI:function(){return this.getConfigDbSavedObject().userBadgeAPI},getActivityAPI:function(){return this.getConfigDbSavedObject().allActivityAPI},getActivityLog:function(){return this.getConfigDbSavedObject().activityAPI},getMyTimesAPI:function(){return this.getConfigDbSavedObject().myTimesAPI},getWidgetCSSAPI:function(){return this.getConfigDbSavedObject().widgetcss},getPreLoginCSSAPI:function(){return this.getConfigDbSavedObject().prelogincss},getPostLoginCSSAPI:function(){return this.getConfigDbSavedObject().postlogincss},getCommonPageCSSAPI:function(){return this.getConfigDbSavedObject().commonpagecss},getLeaderBoradAPI:function(){return this.getConfigDbSavedObject().leaderboard},getYouHaveNotEarned:function(){return this.getConfigDbSavedObject().youhavenowearned},getWhatAreBadges:function(){return this.getConfigDbSavedObject().whatarebadges},getOneBadge:function(){return this.getConfigDbSavedObject().onebadge},getTwoBadge:function(){return this.getConfigDbSavedObject().twobadge},getThreeBadge:function(){return this.getConfigDbSavedObject().threebadge},getLoginAndSave:function(){return this.getConfigDbSavedObject().loginandsave},getLoginAndSaveDesc:function(){return this.getConfigDbSavedObject().loginandsavedesc},getHowDoesThisWork:function(){return this.getConfigDbSavedObject().howdoesthisworks},getMyBadges:function(){return this.getConfigDbSavedObject().mybadges},getLogo:function(){return this.getConfigDbSavedObject().logourl},getBigLogo:function(){return this.getConfigDbSavedObject().biglogourl},getLogoIconUrl:function(){return this.getConfigDbSavedObject().logoiconurl},getPreloginExistAPI:function(){return this.getConfigDbSavedObject().preloginExistAPI},getPreloginPostAPI:function(){return this.getConfigDbSavedObject().preloginPostAPI},getUserPointsAPI:function(){return this.getConfigDbSavedObject().userPointsAPI},getUserYou:function(){return this.getConfigDbSavedObject().you},getProfilePic:function(){return this.getConfigDbSavedObject().profilePic},getPoints:function(){return this.getConfigDbSavedObject().points},getKLiey:function(){return this.getConfigDbSavedObject().kliey},getRedeempoints:function(){return this.getConfigDbSavedObject().redeempoints},getRedeempointsDesc:function(){return this.getConfigDbSavedObject().redeempointsDesc},getProfileTitle:function(){return this.getConfigDbSavedObject().profileTitle},getAllTitle:function(){return this.getConfigDbSavedObject().allTitle},getNextLevelStatusText:function(){return this.getConfigDbSavedObject().nextLevelStatus},getEarnExtraPoints:function(){return this.getConfigDbSavedObject().earnextrapoints},getPostLoginWidgetDetailsAPI:function(){return this.getConfigDbSavedObject().widgetDetails},getNotificationAPI:function(){return this.getConfigDbSavedObject().notificationapi},getNotificationAllAPI:function(){return this.getConfigDbSavedObject().notificationAllapi},getNotificationCountAPI:function(){return this.getConfigDbSavedObject().notificationCountapi},getClaimMedalText:function(){return this.getConfigDbSavedObject().claim_medal},getNewMedalText:function(){return this.getConfigDbSavedObject().new_medal},getNewMedalSingularText:function(){return this.getConfigDbSavedObject().new_medal_singular},getShowAllMedalsText:function(){return this.getConfigDbSavedObject().show_medal},getDomainChannelMappingByDomain:function(t){return this.domainMappingDb({domainName:t}).first()},getDomainChannelMappingByChannelName:function(t){return this.domainMappingDb({channelName:t}).first()},getDomainChannelMappingByChannelCode:function(t){return this.domainMappingDb({channelName:t}).first()},getDomainNameByChannelCode:function(t){return this.getDomainChannelMappingByChannelCode(t).domainName},getCurrentChannelCodeFromDomainMapping:function(t){return this.getDomainChannelMappingByDomain(t).channelName},getCurrentSubChannelFromDomainMapping:function(t){return this.getDomainChannelMappingByDomain(t).subChannelName},getCurrentChannelLoginMethodFromDomainMapping:function(t){return this.getDomainChannelMappingByDomain(t).loginMethodName},getShareLang:function(){return this.getConfigDbSavedObject().share_lang},getShareTitle:function(){return this.getConfigDbSavedObject().share_title},getShareDesc:function(){return this.getConfigDbSavedObject().share_desc},getPortalUrl:function(){return this.getConfigDbSavedObject().portalUrl},isFromShare:function(){try{return fromShare&&"true"===fromShare?!0:!1}catch(t){return!1}},getMyTimesAPIDomain:function(){return this.getConfigDbSavedObject().myTimesAPIDomain},getPointsEarnedLang:function(){return this.getConfigDbSavedObject().pointsearned},getCurrentChannelNameLang:function(){return this.getConfigDbSavedObject().channelTitle},getWidgetAdsApi:function(){return this.getConfigDbSavedObject().widgetAdsApi},getCrossDomainGetTicketApi:function(){return this.getConfigDbSavedObject().crossDomainGetTicketApi},getCrossDomainLoginApi:function(){return this.getConfigDbSavedObject().crossDomainLoginApi},getAmtSlideCss:function(){return this.getConfigDbSavedObject().amtslidecss},getMyBadgesShare:function(){return this.getConfigDbSavedObject().sharemybadges},getProductFeedApi:function(){return this.getConfigDbSavedObject().productFeedApi},getAllChannelsApi:function(){return this.getConfigDbSavedObject().allChannelApi},getStaticContentUrl:function(){return this.getConfigDbSavedObject().staticContentUrl},getStaticContentImageUrl:function(){return this.getStaticContentUrl()+this.getConfigDbSavedObject().staticContentImageUrl},getSSOSettingUrl:function(){return this.getConfigDbSavedObject().ssoSettingUrl},getBadgesOnLang:function(){return this.getConfigDbSavedObject().bdgon},getRecentActivityLang:function(){return this.getConfigDbSavedObject().ract},getYourActivityLang:function(){return this.getConfigDbSavedObject().yact},getNetworkActivityLang:function(){return this.getConfigDbSavedObject().nact},getOtherNetworkSiteLang:function(){return this.getConfigDbSavedObject().onet},getChannelNameFromAllChannels:function(t){return this.allChannelsDb({publisherName:t}).first().name},getAllChannels:function(){var t=timespointsapp.util.getChannelCodeByDomain(timespointsapp.domain);return this.allChannelsDb({channelInactive:!1,publisherName:{"!is":t}}).get()},getChannelColorByPName:function(t){return this.allChannelsDb({publisherName:t}).first().color},getChannelFromAllChannels:function(t){return this.allChannelsDb({publisherName:t}).first()},getAdsCSS:function(){return this.getConfigDbSavedObject().splnotifcss},getDeltaBadgeAPI:function(){return this.getConfigDbSavedObject().allDeltaBadgeAPI},getDeltaActivityAPI:function(){return this.getConfigDbSavedObject().allDeltaActivityAPI}}}),define("transaction",["jquery","tpointutil","taffy"],function(t,e,i){"use strict";return{transactionDb:TAFFY().store("transactionDb"),addActivity:function(t){var i=timespointsapp.activitymaster.getPreLoginActivityByName(t);if(i!==!1){var n=this.getDayActivityCountFromDB(i.channelActivityCode,e.dayFirstTimeStamp(),e.dayLastTimeStamp()),s=this.getLastActivityFromDB(i.channelActivityCode);if(0===this.getTotalPoints()){var a=timespointsapp.activitymaster.getPreLoginActivityByName("register");this.saveActivityIntoDB(a.channelActivityCode,a.prelogin,0)}if(s!==!1){var o=((new Date).getTime()-s.cdate)/1e3-i.creditLimit,r=!1;1!==i.activityType&&(0==i.maxCap?r=!0:n<=i.maxCap&&(r=!0)),1!==i.activityType&&1==r&&o>=0&&this.saveActivityIntoDB(i.channelActivityCode,i.prelogin,i.points)}else this.saveActivityIntoDB(i.channelActivityCode,i.prelogin,i.points)}},getTotalPoints:function(){return this.transactionDb().sum("points")},getBadgeActivityCountFromDB:function(t){return this.transactionDb({id:t}).count()},getDayActivityCountFromDB:function(t,e,i){return this.transactionDb({id:t,cdate:{gte:e,lte:i}}).count()},getLastActivityFromDB:function(t){return this.transactionDb({id:t}).last()},saveActivityIntoDB:function(t,e,i){var n={id:t,prelogin:e,cdate:(new Date).getTime(),points:i};this.transactionDb.insert(n)},getAllActivityFromDB:function(){var t="";return this.transactionDb({points:{gt:0}}).each(function(e){t=t+(""==t?"":",")+"{'spacode':"+e.prelogin+", 'cdate':"+e.cdate+"}"}),t="["+t+"]"},logRemoteActivity:function(t,e,i){var n=timespointsapp.config.getActivityLog()+"?uemail="+encodeURI(i.email);n+="&url="+encodeURI(i.URL),n+="&pcode="+encodeURI(i.host),n+="&scode="+encodeURI(i.channel),n+="&oid="+encodeURI(e),n+="&uid="+encodeURI(i.userId),n+="&ecode="+encodeURI(t);var s=new Image(1,1);s.src=n,setTimeout(function(){s.complete&&s.naturalWidth||(s.src="")},5e3)},checkPrelogin:function(e){t.ajax({url:timespointsapp.config.getPreloginExistAPI()+"?version="+timespointsapp.version(),crossDomain:!0,type:"GET",dataType:"jsonp",cache:!1,data:{uid:e.userId,uemail:e.email,pname:e.host,domain:timespointsapp.domain,pageloc:window.location.href},success:function(t){1===t.status?(null===timespointsapp.transaction.checkCredit()&&localStorage.setItem("credit",1),timespointsapp.transaction.transactionDb().remove(!0)):4===t.status&&timespointsapp.transaction.getTotalPoints()>0&&timespointsapp.transaction.sendPrelogin(e)},error:function(t){return!1}})},checkCredit:function(){return localStorage.getItem("credit")},sendPrelogin:function(e){var i=this.getAllActivityFromDB(),n={uid:e.userId,uemail:e.email,domain:timespointsapp.domain,pname:e.host,userlogs:i};try{t.ajax({url:timespointsapp.config.getPreloginPostAPI()+"?version="+timespointsapp.version(),crossDomain:!0,type:"POST",cache:!1,data:n,success:function(t){1==t&&(this.displayReward(2,this.getTotalPoints()),localStorage.setItem("credit",1),timespointsapp.transaction.transactionDb().remove(!0))},error:function(t){console.log("error. result: "+JSON.stringify(t))}})}catch(s){console.log(s)}}}}),define("text!templates/commoninit.html",[],function(){return'<!-- start main wrapper -->\r\n<div class="main-wrapper">\r\n    <!-- start navigation -->\r\n    <header>\r\n        <div class="main-container">\r\n            {{#if login}}\r\n                <div class="side-nav" onclick="$(\'#mobileleft\').toggleClass(\'active\')"></div>\r\n            {{else}}\r\n                <div id="stick-btn">\r\n                    <a href="javascript:;" onclick="javascript:{{{loginMethod}}}" class="btn-inner btn-blue">Sign In</a>\r\n                </div>\r\n            {{/if}}\r\n            <div class="fleft" id="mobile-float">\r\n                <div class="tp-logo"><a href="{{{portalUrl}}}"><img src="{{{logo}}}"></a></div>\r\n                <div class="seprator"></div>\r\n                <div class="channel-name"><a href="{{{currentChannelUrl}}}" target="_blank">{{{currentChannelName}}}</a></div>\r\n            </div>\r\n            {{#if login}}\r\n                <nav>\r\n                    <ul>\r\n                        <!--<a target="_blank" class="app-download-img ng-scope" href="{{{portalUrl}}}/app"><img alt="" src="{{{portalUrl}}}/images/download-icon-mobile-new.png"></a>-->\r\n                        <li><a href="{{{portalUrl}}}" ><span>Home</span><i><img src="{{{staticImagesPath}}}home_icon.png"></i></a></li>\r\n                        <li><a href="http://www.timespoints.com/debit/TimesPoints-Program#debit-card" target="_blank"><span>Times Points Debit Card</span><i><img src="{{{staticImagesPath}}}card.png"></i></a></li>\r\n                        <li><a href="{{{portalUrl}}}/app" target="_blank"><span>Download App</span><i><img src="{{{staticImagesPath}}}download.png"></i></a></li>\r\n                        <li><a href="{{{portalUrl}}}/#/myPoints" ><span>My Points</span><i><img src="{{{staticImagesPath}}}points_icon.png"></i></a></li>\r\n                        <li><a href="{{{portalUrl}}}/#/myBadges" ><span>My Badges</span><i><img src="{{{staticImagesPath}}}badge_icon.png"></i></a></li>\r\n                        <li><a href="{{{portalUrl}}}/#/redeem" ><span>Redeem</span><i><img src="{{{staticImagesPath}}}redeem_icon.png"></i></a></li>\r\n                        <!--<li><a href="{{{portalUrl}}}/#/redemptionHistory" ><span>Redemption History</span><i><img src="{{{staticImagesPath}}}clock.png"></i></a></li>-->\r\n                        <li id="pop-nav">\r\n                            <a href="javascript:;"><img src="{{{staticImagesPath}}}nav_icon.png"></a>\r\n                            <div class="nav-pop">\r\n                                <!--<a href="{{{portalUrl}}}/#/contest"><dfn><img src="{{{staticImagesPath}}}trophy.png"></dfn>Contests</a>-->\r\n                                <a href="{{{portalUrl}}}/#/redemptionHistory"><dfn><img src="{{{staticImagesPath}}}clock.png"></dfn>Redemption History</a>\r\n                                <a href="{{{portalUrl}}}/#/tutorials"><dfn><img src="{{{staticImagesPath}}}bulb.png"></dfn>Take a Tour</a>\r\n                                <a href="{{{ssoSettingUrl}}}" target="_blank"><dfn><img src="{{{staticImagesPath}}}settings.png"></dfn>Settings</a>\r\n                                <a href="javascript:timespointsapp.common.logout();"><dfn><img src="{{{staticImagesPath}}}signout.png"></dfn>Sign Out</a>\r\n                            </div>\r\n                        </li>\r\n                    </ul>\r\n                </nav>\r\n            {{else}}\r\n                <div class="fright">\r\n                    <a href="javascript:;" id="mobile-hide" onclick="javascript:{{{loginMethod}}}" class="btn-blue">Sign In</a>\r\n                </div>\r\n            {{/if}}\r\n\r\n        </div>\r\n        {{#if login}}\r\n        <ul id="mobileleft" class="mobileleft mobilenav" ng-Cloak>\r\n            <li><img name="commonPageProfileImage" onerror="timespointsapp.util.loadDefaultUserImage(this)" align="left">\r\n                        <span>\r\n                            <small name="commonPageProfileName">Hi, User!</small>\r\n                            <a name="commonPageStatus" class="btn cursorDefault clr-Bronze">Bronze - 0</a>\r\n                        </span>\r\n            </li>\r\n\r\n            <li><a href="{{{portalUrl}}}" ><i><img src="{{{staticImagesPath}}}home_icon.png"></i>Home</a></li>\r\n            <li><a href="{{{portalUrl}}}" ><i><img src="{{{staticImagesPath}}}card.png"></i>Times Points Debit Card</a></li>\r\n            <li><a href="{{{portalUrl}}}" ><i><img src="{{{staticImagesPath}}}download.png"></i>Download App</a></li>\r\n            <li><a href="{{{portalUrl}}}/#/myPoints" ><i><img src="{{{staticImagesPath}}}points_icon.png"></i>My Points</a></li>\r\n            <li><a href="{{{portalUrl}}}/#/myBadges" ><i><img src="{{{staticImagesPath}}}badge_icon.png"></i>My Badges</a></li>\r\n            <!--<li><a href="{{{portalUrl}}}/#/contest" ><i><img src="{{{staticImagesPath}}}trophy.png"></i>Contests</a></li>-->\r\n            <li><a href="{{{portalUrl}}}/#/redeem" ><i><img src="{{{staticImagesPath}}}redeem_icon.png"></i>Redeem</a></li>\r\n            <li><a href="{{{portalUrl}}}/#/redemptionHistory" ><i><img src="{{{staticImagesPath}}}clock.png"></i>Redemption History</a></li>\r\n            <li><a href="{{{portalUrl}}}/#/tutorials" ><i><img src="{{{staticImagesPath}}}bulb.png"></i>Take a Tour</a></li>\r\n            <li><a href="{{{ssoSettingUrl}}}" target="_blank"><i><img src="{{{staticImagesPath}}}settings.png"></i>Settings</a></li>\r\n            <li><a href="javascript:timespointsapp.common.logout();"><i><img src="{{{staticImagesPath}}}signout.png"></i>Sign Out</a></li>\r\n        </ul>\r\n        {{/if}}\r\n    </header>\r\n\r\n    <!-- end navigation -->\r\n\r\n    <!-- new section -->\r\n    <section class="body-container">\r\n        <article class="top-band theme-bg">\r\n            <div class="main-container">\r\n\r\n                {{#if fromShare}}\r\n                    <div class="user-pic" onclick="timespointsapp.common.triggerBadgeClick(\'this value will not used as is sharing page\',\'1\')">\r\n                        <img src="{{{sharedBadgeImage}}}" onerror="timespointsapp.util.loadDefaultUserImage(this)" />\r\n                    </div>\r\n                    <div class="welcome-txt">\r\n                        <span>{{{sharedBadgeTitle}}}</span>\r\n                        <dfn>{{{sharedBadgeLevelDesc}}}</dfn>\r\n                    </div>\r\n                {{else}}\r\n                    <div class="user-pic"><a target="_blank" href="{{{ssoSettingUrl}}}#pic"><img class="default-crown" id="commonPageProfileImage" onerror="timespointsapp.util.loadDefaultUserImage(this)" /></a></div>\r\n                    {{#if login}}\r\n                        <div class="welcome-txt">\r\n                            <a target="_blank" href="{{{ssoSettingUrl}}}"><span id="commonPageProfileName" onclick="">Hi, User!</span></a>\r\n                            <dfn>\r\n                                <a style="text-decoration:none;" id="commonPageStatus" class="btn cursorDefault clr-Bronze">Bronze</a>\r\n                                <div class="next-level-msg"><i style="font-style: normal;" id = "commonNextLevelPoints"></i> <i style="font-style: normal;" class="btn cursorDefault clr-Silver" id="commonPageNextLevel">Silver</i> status</div>\r\n                            </dfn>\r\n                        </div>\r\n                    {{else}}\r\n                        <div class="welcome-txt">\r\n                            <span id="commonPageProfileName">Welcome to Times Points!</span>\r\n                            <!--<dfn>{{{claimMedals}}}</dfn>-->\r\n                            <dfn><a href="javascript:;" onclick="javascript:{{{loginMethod}}}">Sign in</a> to earn points, unlock badges and redeem gifts</dfn>\r\n                        </div>\r\n                    {{/if}}\r\n                    <div class="fright">\r\n                        <a style="text-decoration: none; float:left;" href="{{{portalUrl}}}/#/myPoints">\r\n                        <div class="top-band-box">\r\n                            <div class="points-icon"></div>\r\n                            <div class="txt-div">\r\n                                <!--<span>{{{pointsEarnedLang}}}</span>-->\r\n                                <span>Points Earned</span>\r\n                                <dfn id="commonPagePoints">0</dfn>\r\n                            </div>\r\n                        </div>\r\n                        </a>\r\n                        <a style="text-decoration: none; float:left;" href="{{{portalUrl}}}/#/myBadges">\r\n                            <div class="top-band-box">\r\n                                <div class="badge-icon"></div>\r\n                                <div class="txt-div">\r\n                                    <!--<span >{{{pointsEarnedLang}}}</span>-->\r\n                                    <span>Badges Unlocked</span>\r\n                                    <dfn id="commonPageBadgeUnlockedCount">0</dfn>\r\n                                </div>\r\n                            </div>\r\n                        </a>\r\n                    </div>\r\n                {{/if}}\r\n            </div>\r\n            <div class="clearfix"></div>\r\n        </article>\r\n        <div class="wrapper">\r\n            <article class="body-div">\r\n                <div class="main-container">\r\n                    <div class="inner-div">\r\n                        <div class="lhs-div">\r\n                            <!-- badges on channel starts -->\r\n                            <div class="bttm-border">\r\n                                <h2 class="theme-txt">{{{badgesOn}}} {{{currentChannelName}}}</h2>\r\n                                <div id="commonBadgeList">\r\n                                    <div class="no-badge-msg">There are no badges on this channel.</div>\r\n                                </div>\r\n                            </div>\r\n                            <div class="clearfix"></div>\r\n                            <!-- badges on channel ends -->\r\n                            <!-- other network sites starts -->\r\n                            <div class="bttm-border">\r\n                                <h2 class="theme-txt">{{{otherNetworkSiteLang}}}</h2>\r\n                                <div id="commonChannelList">\r\n\r\n                                </div>\r\n                            </div>\r\n                            <!-- other network sites ends -->\r\n                            <div class="clearfix"></div>\r\n                            {{#if login}}\r\n                                <div >\r\n                                    <h2 class="theme-txt">{{{recActivityLang}}}</h2>\r\n                                    <h3 class="theme-txt">{{{yourActivityLang}}}</h3>\r\n                                    <div id="commonMyActivity">\r\n                                        <div class="msg-div">You have not done any activity on {{{currentChannelName}}} recently</div>\r\n                                    </div>\r\n                                    <div class="clearfix"></div>\r\n                                    <h3 class="theme-txt">{{{netActivityLang}}}</h3>\r\n                                    <div id="maincommonFriendsActivity">\r\n                                        <div class="msg-div">No one in your network has done any activity on {{{currentChannelName}}} recently</div>\r\n                                    </div>\r\n                                </div>\r\n                            {{/if}}\r\n                        </div>\r\n                        <div class="rhs-div" >\r\n                            <div id="commonBigBadge"></div>\r\n                            <div id="commonPageProductList"></div>\r\n\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </article>\r\n            </div>\r\n        <div class="clearfix"></div>\r\n    </section>\r\n    <!-- new section end -->\r\n    <div class="pos-rel right-inside">\r\n        <a href="javascript:;" onclick="timespointsapp.common.hideAllCircleBorder();$(\'.main-wrapper\').toggleClass(\'expand-badge-detail\');" class="view-badges theme-txt">&#10094; All Badges</a>\r\n        <div id="commonResponseBadge" >\r\n            <!-- end graybx -->\r\n\r\n        </div>\r\n    </div>\r\n    <div class="social-links1">\r\n        <a href="https://www.tweeter.com/timespoints" target="_blank" class="share-icon twt-icon1"></a>\r\n        <a href="https://www.facebook.com/times.points" target="_blank" class="share-icon fb-icon1"></a>\r\n        <a href="https://plus.google.com/116307685751088605909" target="_blank" class="share-icon gplus-icon1"></a>\r\n    </div>\r\n    <footer>\r\n        <div class="main-container">\r\n            <div class="quick-links">\r\n                <ul>\r\n                    <li><a href="{{{portalUrl}}}/aboutus" >About Us</a></li>\r\n                    <li><a href="{{{portalUrl}}}/termsofuse" >Terms of Use &amp; Grievance Redressal Policy</a></li>\r\n                    <li><a href="{{{portalUrl}}}/privacyPolicy" >Privacy Policy</a></li>\r\n                    <li><a href="{{{portalUrl}}}/feedback" >Feedback</a></li>\r\n                    <li><a href="{{{portalUrl}}}/faq" >FAQ\'s</a></li>\r\n                </ul>\r\n            </div>\r\n            <div class="social-links">\r\n                <a href="https://www.tweeter.com/timespoints" target="_blank" class="share-icon twt-icon"></a>\r\n                <a href="https://www.facebook.com/times.points" target="_blank" class="share-icon fb-icon"></a>\r\n                <a href="https://plus.google.com/116307685751088605909" target="_blank" class="share-icon gplus-icon"></a>\r\n            </div>\r\n            <div class="copyright">Copyright  2016 Times Internet Limited.</div>\r\n        </div>\r\n    </footer>\r\n</div>\r\n';
}),define("text!templates/commonBadge.html",[],function(){return'{{#badges}}\r\n    <a href="javascript:;" class="badge-box-outer"\r\n       onclick="timespointsapp.common.getBadgeDetail(\'{{{id}}}\',\'{{{active}}}\');$(\'.main-wrapper\').toggleClass(\'expand-badge-detail\');timespointsapp.common.smoothScroll();timespointsapp.common.showSelectionBorder(this);">\r\n        <div class="badge">\r\n            <table cellpadding="0" cellspacing="0" border="0" width="100%">\r\n                <tbody>\r\n                    <tr>\r\n                        <td><img src="{{{img}}}" alt="{{{name}}}"></td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n            <div class="badge-circle theme-border" style="display: none;"></div>\r\n        </div>\r\n        <div class="img-txt">{{{name}}}</div>\r\n        <div class="img-txt spacer"><img src="{{{staticImagesPath}}}spacer.gif"></div>\r\n    </a>\r\n{{/badges}}'}),define("text!templates/commonBigBadge.html",[],function(){return'{{#badges}}\r\n<div id="badge-specific" >\r\n    <!-- badge details box starts -->\r\n    <div class="badge-detail-box theme-bg">\r\n        {{#if share}}\r\n                <a href="javascript:;" class="share-icon1">\r\n                    <div class="share-badge">\r\n                        <span class="share-badge-col badge-share-twt" onclick="timespointsapp.common.openShare(\'{{{id}}}\',\'tw\')"></span>\r\n                        <span class="share-badge-col badge-share-fb" onclick="timespointsapp.common.openShare(\'{{{id}}}\',\'fb\')"></span>\r\n                        <span class="share-badge-col badge-share-gplus" onclick="timespointsapp.common.openShare(\'{{{id}}}\',\'gp\')"></span>\r\n                    </div>\r\n                    <div class="share-badge-arrow"></div>\r\n                </a>\r\n        {{/if}}\r\n        <div class="clearfix"></div>\r\n        <div class="marginB20">\r\n            <div class="badge-img-big"><img src="{{{img}}}"></div>\r\n            <div class="badge-detail">\r\n                <span>{{{name}}}</span>\r\n                <dfn>{{{cheatSheet}}}</dfn>\r\n            </div>\r\n            <div class="clearfix"></div>\r\n        </div>\r\n        <div class="marginB10">\r\n            <div class="badge-level-activity">Levels</div>\r\n            <div class="badge-level-count">\r\n                {{#badgeLevelArray}}\r\n                    <span class="{{{myclass}}}">\r\n                        {{{level}}}\r\n                        {{#if toBeClaimed}}\r\n                            <i class="level-overlay"></i>\r\n                        {{/if}}\r\n                    </span>\r\n                {{/badgeLevelArray}}\r\n            </div>\r\n            <div class="clearfix"></div>\r\n        </div>\r\n        <div>\r\n            <div class="badge-level-activity">Activity Counts</div>\r\n            <div class="badge-level-count">\r\n                {{#badgeLevelArray}}\r\n                    <span class="{{{myclass}}}">{{{threshold}}}</span>\r\n                {{/badgeLevelArray}}\r\n            </div>\r\n        </div>\r\n        <div class="clearfix"></div>\r\n    </div>\r\n    <!-- badge details box ends -->\r\n\r\n    <!-- activities to unlock this badge starts -->\r\n    <div>\r\n        <h2 class="theme-txt">{{{pointtext}}}</h2>\r\n        <div class="badge-activity-inner">\r\n            {{#activity}}\r\n                <div class="activities-unlock">\r\n                    <div class="points-numb"><strong>{{{points}}}</strong> {{{pointText}}}</div>\r\n                    <div class="points-txt theme-txt">{{{detail}}}</div>\r\n                    <div class="clearfix"></div>\r\n                </div>\r\n            {{/activity}}\r\n        </div>\r\n    </div>\r\n    <!-- activities to unlock this badge ends -->\r\n</div>\r\n{{/badges}}\r\n\r\n<!-- earn extra points activities starts -->\r\n{{#if showExtraDiv}}\r\n    <div id="earnExtraPointsDiv" >\r\n        <h2 class="theme-txt">{{{earnExtraPointsText}}}</h2>\r\n        {{#each extraPointsActivities}}\r\n        <div class="badge-activity-inner">\r\n            <div class="earnpoints-row theme-border">\r\n                <div class="points-numb"><strong>{{{points}}}</strong> {{{pointText}}}</div>\r\n                <div class="points-txt theme-txt">{{{description}}}</div>\r\n                <div class="clearfix"></div>\r\n            </div>\r\n        </div>\r\n        {{/each}}\r\n    </div>\r\n{{/if}}\r\n<!-- earn extra points activities starts -->'}),define("text!templates/commonProduct.html",[],function(){return'<div class="get-gifts theme-bg">\r\n    <div class="marginB10">\r\n        <div class="title">{{{redeemPointsTxt}}}</div>\r\n        <!--<div class="title">Get attrative gifts</div>-->\r\n        <a href="{{{portalUrl}}}/#/redeem" class="redeem-btn">Redeem Now</a>\r\n        <div class="clearfix"></div>\r\n    </div>\r\n    <div class="">\r\n        {{#product}}\r\n        <div class="get-gifts-box">\r\n            <div class="inner-box">\r\n                <div class="prod-pic"><img src="{{{img}}}"></div>\r\n                <a href="{{{../portalUrl}}}/#/productDetails/{{{productId}}}" class="btn theme-bg">{{{desc}}}</a>\r\n                <div class="prod-name" title="{{{text}}}">{{{textTrimmed}}}</div>\r\n            </div>\r\n        </div>\r\n        {{/product}}\r\n    </div>\r\n    <div class="clearfix"></div>\r\n</div>'}),define("text!templates/commonActivity.html",[],function(){return'{{#activities}}\r\n    <div class="user-activities-row">\r\n        <div class="pic"><img src="{{{thumbnail}}}"></div>\r\n        <div class="txt">\r\n            <dfn>{{{activityText}}}</dfn>\r\n            <i>{{{date}}}</i>\r\n            <span>{{{title}}}</span>\r\n        </div>\r\n    </div>\r\n{{/activities}}'}),define("text!templates/commonChannel.html",[],function(){return'{{#channels}}\r\n    <a href="/about/{{{idString}}}" class="badge-box-outer" >\r\n        <div class="channel">\r\n            <table cellpadding="0" cellspacing="0" border="0" width="100%">\r\n                <tbody><tr>\r\n                    <!--<td><img src="{{{logo}}}"></td>-->\r\n                    <td><img src="{{{applogourl}}}" onerror="timespointsapp.util.loadDefaultUserImage(this)"></td>\r\n                </tr>\r\n                </tbody></table>\r\n        </div>\r\n        <div class="img-txt">{{{name}}}</div>\r\n    </a>\r\n{{/channels}}\r\n'}),define("common",["jquery","tpointutil","taffy","handlebar","text!templates/commoninit.html","text!templates/commonBadge.html","text!templates/commonBigBadge.html","text!templates/commonProduct.html","text!templates/commonActivity.html","text!templates/commonChannel.html"],function($,util,taffy,handlebar,commoninit,commonbadge,commonBigBadge,commonProduct,commonActivity,commonChannel){"use strict";return{init:function(){if($("#timespointscommon").length>0){util.loadCss(timespointsapp.config.getCommonPageCSSAPI());var t=Handlebars.compile(commoninit),e=timespointsapp.prelogin.checkLogin(),i="www.timespoints.com"==window.location.hostname;$("#timespointscommon").html(t({link:timespointsapp.config.getChannelUrl(),logo:timespointsapp.config.getBigLogo(),profilepic:timespointsapp.config.getProfilePic(),login:e.status,mybadges:timespointsapp.config.getMyBadges(),mybadgesShare:timespointsapp.config.getMyBadgesShare(),redeempoints:timespointsapp.config.getRedeempoints(),nextLevelStatusText:timespointsapp.config.getNextLevelStatusText(),earnextrapoints:timespointsapp.config.getEarnExtraPoints(),currentDomain:util.getChannelCodeByDomain(timespointsapp.domain),currentSubDomain:util.getSubChannelCodeByDomain(timespointsapp.domain),isInternal:i,claimMedals:timespointsapp.config.getClaimMedalText(),loginMethod:"timespointsapp.util.openLoginPopUp()",fromShare:timespointsapp.config.isFromShare(),sharedBadgeImage:timespointsapp.common.getSharedBadgeProp("sharedBadgeImage"),sharedBadgeTitle:timespointsapp.common.getSharedBadgeProp("sharedBadgeTitle"),sharedBadgeLevelDesc:timespointsapp.common.getSharedBadgeProp("sharedBadgeLevelDesc"),channelLogo:timespointsapp.config.getChannelFromAllChannels(timespointsapp.util.getChannelCodeByDomain(timespointsapp.domain)).logo,pointsEarnedLang:timespointsapp.config.getPointsEarnedLang(),staticImagesPath:timespointsapp.config.getStaticContentImageUrl(),portalUrl:timespointsapp.config.getPortalUrl(),ssoSettingUrl:timespointsapp.config.getSSOSettingUrl(),currentChannelName:timespointsapp.config.getChannelFromAllChannels(timespointsapp.util.getChannelCodeByDomain(timespointsapp.domain)).name,badgesOn:timespointsapp.config.getBadgesOnLang(),netActivityLang:timespointsapp.config.getNetworkActivityLang(),yourActivityLang:timespointsapp.config.getYourActivityLang(),recActivityLang:timespointsapp.config.getRecentActivityLang(),currentChannelUrl:timespointsapp.config.getChannelFromAllChannels(timespointsapp.util.getChannelCodeByDomain(timespointsapp.domain)).url,otherNetworkSiteLang:timespointsapp.config.getOtherNetworkSiteLang()}));var n=Handlebars.compile(commonChannel),s=timespointsapp.config.getAllChannels();$("#commonChannelList").html(n({channels:s})),this.setPageTheme(),e.status===!1?($("#mobile-float").find(".channel-name").addClass("channel-name1"),this.processPreLoginTimesPoints(),this.processPreloginBadges(),this.getTimesPointProduct()):(this.fetchBadgeCount(),this.getUserfromMyTimes(e.user),this.getPointsfromTimesPoints(e.user),this.getBadgesForUser(e.user),this.getTimesPointProduct(),this.getMyActivity(e.user),this.getFriendsActivity(e.user))}},fetchBadgeCount:function(){var t=timespointsapp.config.getPortalUrl()+"/dashboard/badges";$.ajax({url:t,type:"GET",cache:!1,async:!1,dataType:"jsonp",success:function(t){var e=t.unlockedcount;$("#commonPageBadgeUnlockedCount").html(e)}})},setPageTheme:function(){var t=timespointsapp.config.getChannelColorByPName(util.getChannelCodeByDomain(timespointsapp.domain)),e=".theme-bg{background: {{{colorCode}}} !important;}.theme-txt{color: {{{colorCode}}} !important;}.theme-border{border-color: {{{colorCode}}} !important;}",i=Handlebars.compile(e),n=i({colorCode:t}),s=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",a.stylesheet?a.stylesheet.cssText=n:a.appendChild(document.createTextNode(n)),s.appendChild(a)},getSharedBadgeProp:function(variable){return timespointsapp.config.isFromShare()?eval(variable):""},getUserfromMyTimes:function(t){$.ajax({url:timespointsapp.config.getMyTimesAPI()+"?ssoId="+t.userId+"&format=JSON&version="+timespointsapp.version(),type:"GET",cache:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.common.proceswsUserfromMyTimes"})},proceswsUserfromMyTimes:function(t){$("#commonPageProfileImage").attr("src",t.profile),$("[name='commonPageProfileImage']").attr("src",t.profile),$("#commonPageProfileName").html(t.FL_N),$("[name='commonPageProfileName']").html(t.FL_N),$("#commonPageProfileCity").html(t.CITY)},getPointsfromTimesPoints:function(t){$.ajax({url:timespointsapp.config.getUserPointsAPI()+"?uid="+t.userId+"&version="+timespointsapp.version(),type:"GET",cache:!1,dataType:"jsonp",success:function(t){timespointsapp.common.processPointsfromTimesPoints(t)}})},processPreLoginTimesPoints:function(){$("#commonPagePoints").html(timespointsapp.transaction.getTotalPoints()),$("#commonPagePointsResponsive").html(timespointsapp.transaction.getTotalPoints()),$("#commonPageRedeemPoints").html(timespointsapp.transaction.getTotalPoints())},processPointsfromTimesPoints:function(t){$("#commonPagePoints").html(t.points),$("#commonPagePointsResponsive").html(t.points),$("#commonPageRedeemPoints").html(t.points),$("#commonPageStatus").html(t.levelName),$("#commonPageStatus").attr("class","btn cursorDefault clr-"+t.levelName),$('[name="commonPageStatus"]').attr("class","btn cursorDefault clr-"+t.levelName),$('[name="commonPageStatus"]').html(t.levelName+" - "+t.points);var e=util.getNextStatusLevel(t.points),i=timespointsapp.config.getNextLevelStatusText();i=i.replace(/\${points}/g,e.points),$("#commonNextLevelPoints").html(i),$("#commonPageNextLevel").attr("class","btn cursorDefault clr-"+e.status),$("#commonPageNextLevel").html(e.status)},getBadgesForUser:function(t){$.ajax({url:timespointsapp.config.getUserBadgeAPI()+"?uid="+t.userId+"&format=JSON&version="+timespointsapp.version(),type:"GET",cache:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.common.processBadgesforUser"})},processBadgesforUser:function(t){for(var e=new Array,i=t.active,n=t.inactive,s=0;s<i.length;s++){var a=timespointsapp.badgemaster.getBadgeById(i[s]),o="";0!=a.nextLevelId&&(o=timespointsapp.badgemaster.getBadgeById(a.nextLevelId));var r=new Object;if(r.staticImagesPath=timespointsapp.config.getStaticContentImageUrl(),r.name=a.name,r.id=a.id,r.active=1,r.levelName=a.levelName,r.img=a.activeImage+"/166",r.activities=a.activities,""!==o){if(r.tillNextLevel=o.threshold-a.threshold,void 0!==a.unlockedhover){var l=Handlebars.compile(a.unlockedhover);r.tillNextLevelText=l({tillNextLevel:r.tillNextLevel})}else r.tillNextLevelText=a.cheatSheetDescription;r.nextLevel=o.levelName,void 0!==r.nextLevel&&(r.tillNextLevelText=r.tillNextLevelText),r.percentage=0-a.threshold/o.threshold*100}else r.percentage=-100;e.push(r)}for(var s=0;s<n.length;s++){var a=timespointsapp.badgemaster.getBadgeById(n[s]),r=new Object;if(r.staticImagesPath=timespointsapp.config.getStaticContentImageUrl(),r.name=a.name,r.id=a.id,r.active=0,r.img=a.inActiveImage+"/166",r.tillNextLevel=a.threshold,r.activities=a.activities,void 0!==a.lockedhover){var l=Handlebars.compile(a.lockedhover);r.tillNextLevelText=l({tillNextLevel:r.tillNextLevel})}else r.tillNextLevelText=a.cheatSheetDescription;r.nextLevel=a.levelName,void 0!==r.nextLevel&&(r.tillNextLevelText=r.tillNextLevelText),r.percentage=0,e.push(r)}var c=this.getBadgesWithAtLeastOneActiveActivity(e),l=Handlebars.compile(commonbadge);c.length>0?($("#commonBadgeList").html(l({badges:c})),this.triggerBadgeClick(c[0].id,c[0].active)):(this.triggerBadgeClick("amt",0),$("#badge-specific").hide())},getBadgesWithAtLeastOneActiveActivity:function(t){for(var e=[],i=t.length,n=0;i>n;n++){var s=t[n],a=s.activities,o=!1;if(a)for(var r=a.length,l=0;r>l;l++){var c=timespointsapp.activitymaster.getActivityByCode(a[l]);if(c&&1==c.active){o=!0;break}}1==o&&e.push(s)}return e},processPreloginBadges:function(){for(var t=timespointsapp.badgemaster.getPreloginBadgeForUser(),e=new Array,i=timespointsapp.badgemaster.getAllLevelOneBadges(),n=0;n<t.length;n++){var s=timespointsapp.badgemaster.getBadgeById(t[n].id),a="";0!=s.nextLevelId&&(a=timespointsapp.badgemaster.getBadgeById(s.nextLevelId));var o=new Object;o.staticImagesPath=timespointsapp.config.getStaticContentImageUrl(),o.name=s.name,o.id=s.id,o.active=1,o.levelName=s.levelName,o.img=s.activeImage+"/166",o.activities=s.activities,""!==a?(o.tillNextLevel=a.threshold-s.threshold,o.nextLevel=a.levelName,o.tillNextLevelText=s.nextLevelDescription,void 0!==o.nextLevel&&(o.tillNextLevelText=o.tillNextLevelText),o.percentage=0-s.threshold/a.threshold*100):o.percentage=-100,e.push(o)}$.each(i,function(i,n){for(var s=!1,i=0;i<t.length;i++)n.familyId===t[i].familyId&&(s=!0);if(s===!1){var a=new Object;a.staticImagesPath=timespointsapp.config.getStaticContentImageUrl(),a.name=n.name,a.id=n.id,a.active=1,a.img=n.activeImage+"/166",a.tillNextLevel=n.threshold,a.activities=n.activities,a.tillNextLevelText=n.nextLevelDescription,a.nextLevel=n.levelName,void 0!==a.nextLevel&&(a.tillNextLevelText=a.tillNextLevelText),a.percentage=0,e.push(a)}});var r=this.getBadgesWithAtLeastOneActiveActivity(e),l=Handlebars.compile(commonbadge);r.length>0?($("#commonBadgeList").html(l({badges:r})),this.triggerBadgeClick(r[0].id,r[0].active)):(this.triggerBadgeClick("amt",0),$("#badge-specific").hide())},triggerBadgeClick:function(t,e){timespointsapp.config.isFromShare()?this.getBadgeDetail(sharedBadgeId,"1"):this.getBadgeDetail(t,e)},getBadgeDetail:function(t,e){e=parseInt(e);var i=timespointsapp.prelogin.checkLogin();e=i.status?e:0;var n=new Object,s=timespointsapp.badgemaster.getBadgeById(t),a=timespointsapp.badgemaster.getBadgeByFamilyId(s.familyId),o=timespointsapp.badgemaster.getBadgeCountByFamilyId(s.familyId),r=!1,l=0;0!==s.nextLevelId&&1===e&&(r=timespointsapp.badgemaster.getBadgeById(s.nextLevelId));var c=new Array,p=new Array;if(s.activities)for(var d=0;d<s.activities.length;d++){var h=new Object,g=timespointsapp.activitymaster.getActivityByCode(s.activities[d]);if(g!==!1&&1==g.active){h.points=g.points;var u=Handlebars.compile(g.activityCheatSheetDescription);h.detail=u({points:g.points}),c.push(h)}}for(var d=0;o>d;d++){var m=new Object,f=a[d];m.level=f.level,m.threshold=f.threshold,m.toBeClaimed=!1,1===e?s.level>=d+1?m.myclass="count-cirle-whte theme-txt":s.level+1==d+1?(m.myclass="count-cirle-grn-post",m.toBeClaimed=!0):m.myclass="count-cirle-grn-post":m.myclass="count-cirle-grn-post",p.push(m)}r===!1&&1===e?(n.img=s.activeImage+"/256",n.cheatSheet=s.description,n.remaining="amt"):r!==!1&&1===e?(n.img=s.activeImage+"/256",n.nextlevel=r.level,n.cheatSheet=s.description,l=s.level/o*100):(n.nextlevel=s.level,n.cheatSheet=s.description,i.status?n.img=s.inActiveImage+"/256":n.img=s.activeImage+"/256"),this.setPointsText(c),n.activity=c,n.id=s.id,n.badgeLevelArray=p,n.name=s.name,n.levelName=s.levelName,n.pointtext=timespointsapp.config.getPoints(),n.shareText=timespointsapp.config.getShareLang();var i=timespointsapp.prelogin.checkLogin();i.status===!0&&1===e&&(n.share=!0);var v=JSON.parse(timespointsapp.config.getEarnExtraPoints()),y=Object.keys(v)[0],b=v[y];this.setPointsText(b);var x=Handlebars.compile(commonBigBadge),C=Object.keys(b).length,S=x({badges:n,earnExtraPointsText:y,extraPointsActivities:b,showExtraDiv:C>0});$("#commonBigBadge").html(S),$("#commonResponseBadge").html(S),$("#badge-specific").show()},setPointsText:function(t){if(t.constructor===Array)for(var e=0;e<t.length;e++){var i=t[e];i.pointText="Points",1==i.points&&(i.pointText="Point")}else for(var n in t){var s=t[n];s.pointText="Points",1==n&&(s.pointText="Point")}},showSelectionBorder:function(t){this.hideAllCircleBorder(),$(t).find(".badge-circle.theme-border").show(),$(t).find(".img-txt").hide().parent().find(".img-txt.spacer").show()},hideAllCircleBorder:function(){$(".badge-box-outer .badge-circle.theme-border").hide(),$(".badge-box-outer .img-txt").show().parent().find(".img-txt.spacer").hide()},smoothScroll:function(){$("html,body").animate({scrollTop:$("#commonBigBadge").offset().top-54},500)},getTimesPointProduct:function(){$.ajax({url:timespointsapp.config.getProductFeedApi()+"?version="+timespointsapp.version(),data:{category:1,productLimit:3},crossDomain:!0,type:"GET",dataType:"json",cache:!1,success:function(t){for(var e=new Array,i=0;i<t.length;i++){var n=t[i].productName.length>42?t[i].productName.substr(0,42)+"...":t[i].productName;e[i]={img:t[i].smallImageURL,text:t[i].productName,desc:t[i].points+" Points",productId:t[i].productId,textTrimmed:n}}timespointsapp.common.displayProduct(e)},error:function(t){return!1}})},displayProduct:function(t){var e=Handlebars.compile(commonProduct);$("#commonPageProductList").html(e({redeemPointsTxt:timespointsapp.config.getRedeempointsDesc(),product:t,portalUrl:timespointsapp.config.getPortalUrl()}))},getMyActivity:function(t){var e=timespointsapp.config.getMyTimesAPIDomain()+"/mytimes/myActivity?activityType=all&openNetworkId=sso&appKey="+timespointsapp.channelCode+"&size=1&lastSeenId=0&after=true&contID=ln_myActivity&ssoId="+t.userId+"&version="+timespointsapp.version();$.ajax({url:e,type:"GET",cache:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.common.processMyActivity"})},processMyActivity:function(t){var e=new Array;if(t&&t.length>0){for(var i=0;i<t.length;i++)if(void 0!==t[i].A_N){var n=new Object;n.useName=t[i].A_D_N,"Reward"==t[i].A_N?n.activityText="You have earned the badge "+t[i].tn:n.activityText="You "+t[i].A_N+" an Article",n.activityName=t[i].A_N,n.date=t[i].C_D,n.title=t[i].tet,n.description=t[i].tesyn,n.thumbnail=t[i].iu,e.push(n)}var s=Handlebars.compile(commonActivity);$("#commonMyActivity").html(s({activities:e}))}},getFriendsActivity:function(t){var e=timespointsapp.config.getMyTimesAPIDomain()+"/mytimes/activity/myfriends?appKey="+timespointsapp.channelCode+"&size=2&lastSeenId=0&after=true&ssoId="+t.userId+"&version="+timespointsapp.version();$.ajax({url:e,type:"GET",cache:!1,dataType:"jsonp",jsonpCallback:"timespointsapp.common.processFriendsActivity"})},processFriendsActivity:function(t){var e=new Array;if(void 0!==t&&t.length>0){for(var i=0;i<t.length;i++)if(void 0!==t[i].A_N){var n=new Object;"Reward"==t[i].A_N?n.activityText=t[i].O_D_N+" have earned the badge "+t[i].tn:n.activityText=t[i].A_D_N+" "+t[i].A_N+" an Article",n.activityName=t[i].A_N,n.date=t[i].C_D,n.title=t[i].tet,n.description=t[i].tesyn,n.thumbnail=t[i].iu,e.push(n)}var s=Handlebars.compile(commonActivity);$("#maincommonFriendsActivity").html(s({activities:e}))}},openShare:function(t,e){var i=timespointsapp.badgemaster.getBadgeById(t),n=$("#commonPageProfileName").html(),s=timespointsapp.config.getPortalUrl()+"/about/share/"+t+"/"+util.encodeToBase64(n);i.levelName=i.levelName?i.levelName:"";var a=i.pageTitle;switch(a=a.replace(/\${username}/g,n),a=a.replace(/\${badgename}/g,i.name),a=a.replace(/\${badgedesc}/g,i.description),0!==i.nextLevelId&&0!==i.previousLevelId||i.name==i.levelName?(a=a.replace(/\${levelname}/g,i.levelName),a=a.replace(/\${level}/g,i.level)):(a=a.replace(/\${levelname}/g,""),a=a.replace(/\${level}/g,"")),a=a.replace(/\${channelname}/g,timespointsapp.config.getCurrentChannelNameLang()),a=timespointsapp.util.slimify(a),e){case"fb":s="https://www.facebook.com/sharer/sharer.php?t="+a+"&u="+s;break;case"tw":s="https://twitter.com/intent/tweet?text="+a+"&url="+s;break;case"gp":s="https://plus.google.com/share?url="+s}return window.open(s,"shareWindow","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600"),!1},logout:function(){var t=document.createElement("form");t.action=timespointsapp.config.getPortalUrl()+"/logout",t.method="post",document.body.appendChild(t),t.submit()}}}),define("timespoints-app",["jquery","json","tpwidget","prelogin","badgemaster","activitymaster","tpointutil","tpconfig","transaction","common"],function(t,e,i,n,s,a,o,r,l,c){"use strict";return{domain:"",port:"",host:"",prelogin:"",activitymaster:"",badgemaster:"",channelCode:"",siteCode:"",config:"",widget:"",transaction:"",common:"",version:function(){return localStorage.getItem("tpversion")},deltaDate:function(){return localStorage.getItem("deltaDate")},util:"",init:function(){this.util=o,this.domain=window.location.hostname,this.port=window.location.port,this.host=window.location.hostname+window.location.port,this.prelogin=n,this.config=r,this.activitymaster=a,this.badgemaster=s,this.transaction=l,this.common=c,this.widget=i,this.config.clearLocalDataIfRequired()}}});var timespointsapp;define("jquery",[],function(){return jQuery}),define("timespoints-main",["require","timespoints-app"],function(t){"use strict";timespointsapp=t("timespoints-app"),timespointsapp.init()}),require(["timespoints-main"],function(){});