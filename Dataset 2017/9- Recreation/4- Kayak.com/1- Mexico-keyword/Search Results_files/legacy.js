
window.jq = window.jq || window.jQuery || window.$;
(function(c,e){c.extend("CompareTo.Core.Config",{});c.CompareTo.Core.Config={getString:function(d,a){return c.globals&&c.globals.uiconfig&&"undefined"!==typeof c.globals.uiconfig[d]?c.globals.uiconfig[d]:a},getBoolean:function(d,a){return(d=c.CompareTo.Core.Config.getString(d,""))?"true"===d.toLowerCase():a},getInt:function(d,a){return(d=c.CompareTo.Core.Config.getString(d,""))?parseInt(d):a}};c.CompareTo.Core.BrowserConfig={getString:function(d,a){return c.globals&&c.globals.browserCapabilities&&
"undefined"!==typeof c.globals.browserCapabilities[d]?c.globals.browserCapabilities[d]:a},getBoolean:function(d,a){return(d=c.CompareTo.Core.BrowserConfig.getString(d,""))?"true"===d.toLowerCase():a},getInt:function(d,a){return(d=c.CompareTo.Core.BrowserConfig.getString(d,""))?parseInt(d):a}};c.CompareTo.Core.PDF={isInstalled:function(){var c=!1,a=!1;e.each(navigator.plugins,function(b,f){"Chrome PDF Viewer"===f.name&&"internal-pdf-viewer"===f.filename&&(c=!0);"Chrome PDF Viewer"===f.name&&"mhjfbmdgcfjbbpaeojofohoefgiehjai"===
f.filename&&(a=!0)});return c&&a}}})(window.R9,window.jq||window.jQuery);
(function(c,e,d,a){c.extend("CompareTo.Core.Storage",{});c.CompareTo.Core.Storage=function(){this.init()};c.CompareTo.Core.Storage.prototype={constructor:c.CompareTo.Core.Storage,useLocalStorage:!1,init:function(){this.useLocalStorage=c.CompareTo.Core.Config.getBoolean("ui.cmp2.useLocalStorage",!1);this.available=!1;try{var b=this.getStorage();b.setItem("vendor-support-test","success?");var a=b.getItem("vendor-support-test","success?");b.removeItem("vendor-support-test");"success?"===a&&(this.available=
!0)}catch(h){}},getStorage:function(){return this.useLocalStorage?a:d},get:function(b){if(this.isAvailable()){b=this.getStorage().getItem(b);try{return JSON.parse(b)}catch(f){return b}}},set:function(b,a){try{if(this.isAvailable()){var f=this.getStorage();null!==a&&"object"===typeof a?f.setItem(b,JSON.stringify(a)):f.setItem(b,a)}}catch(g){}},remove:function(b){try{this.isAvailable()&&this.getStorage().removeItem(b)}catch(f){}},clear:function(){this.isAvailable()&&this.getStorage().clear()},isAvailable:function(){return this.available}}})(window.R9,
window.jq||window.jQuery,window.sessionStorage,window.localStorage);
(function(c,e){c.extend("CompareTo.Core.Type.CheckBoxButtonGroup",{});c=c.CompareTo.Core.Type.CheckBoxButtonGroup=function(c){this.container=e(c);this.init()};c.prototype={constructor:c,container:null,input:".input",init:function(){this.container.on("click",this.input,function(){e(this).hasClass("checked")?(e(this).removeClass("checked"),e(this).trigger("change").trigger("deselect")):(e(this).addClass("checked"),e(this).trigger("change").trigger("select"))})}}})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.Type.RadioButtonGroup",{});var d=c.CompareTo.Core.Type.RadioButtonGroup=function(a){this.container=e(a);this.init()};d.prototype={constructor:d,container:null,input:".input",selectedItem:{},init:function(){var a=this;this.container.on("click",a.input,function(){var b=e(this).data("name");b in a.selectedItem&&this!==a.selectedItem[b]&&e(a.selectedItem[b]).removeClass("checked").trigger("change").trigger("deselect");e(this).hasClass("checked")?c.CompareTo.Core.Config.getBoolean("cmp2.radio.buttons.allow.deselect",
!1)&&(c.Analytics.api.trackEvent("cmp2/radio/click/deselect"),delete a.selectedItem[b],e(this).removeClass("checked"),e(this).trigger("change").trigger("deselect")):(a.selectedItem[b]=this,e(this).addClass("checked"),e(this).trigger("change").trigger("select"))});this.container.on("repaint",function(){a.update()})},update:function(){var a=this;this.container.find(this.input).each(function(){var b=e(this).data("name");e(this).hasClass("checked")&&!a.selectedItem.hasOwnProperty(b)?a.selectedItem[b]=
this:e(this).removeClass("checked")})}}})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.Event",{});c=c.CompareTo.Core.Event=function(c){this.object=c;this.init()};c.prototype={constructor:c,events:{},object:null,flags:"unique",init:function(){var c=this;this.object&&(this.object.on=function(){return c.on.apply(c,arguments)},this.object.off=function(){return c.off.apply(c,arguments)},this.object.publish=function(){return c.publish.apply(c,arguments)})},on:function(c,a){var b=this.events[c];b||(this.events[c]=b=e.Callbacks(this.flags));b.add(a);
return this.object||this},off:function(c,a){var b=this.events[c];if(null==b)return this.object||this;"undefined"===typeof a?delete this.events[c]:b.remove(a);return this.object||this},publish:function(c,a){c=this.events[c];if(!c)return this.object||this;c.fire.apply(this.object||this,a||[]);return this.object||this}}})(window.R9,window.jq||window.jQuery);
(function(c){c.extend("CompareTo.Core.Cookie",{});c.CompareTo.Core.Cookie.get=function(c){c+="\x3d";for(var d=document.cookie.split(";"),a=0;a<d.length;a++){for(var b=d[a];" "==b.charAt(0);)b=b.substring(1);if(0==b.indexOf(c))return b.substring(c.length,b.length)}return""};c.CompareTo.Core.Cookie.set=function(c,d,a){var b="";a&&(b=new Date,b.setTime(b.getTime()+a),b="; expires\x3d"+b.toUTCString());document.cookie=c+"\x3d"+d+b+"; path\x3d/"}})(window.R9);
(function(c){c.extend("CompareTo.Core.Inherit",{});"function"!==typeof Object.create&&(Object.create=function(c){function d(){}d.prototype=c;return new d});c.CompareTo.Core.Inherit=function(c,d){d=Object.create(d.prototype);d.constructor=c;c.prototype=d}})(window.R9);
(function(c){c.extend("CompareTo.Core.UUID",{});c.CompareTo.Core.UUID=function(){var c=(new window.Date).getTime();return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(d){var a=(c+16*Math.random())%16|0;c=Math.floor(c/16);return("x"===d?a:a&3|8).toString(16)})}})(window.R9);
(function(c){c.extend("CompareTo.Core.Queue",{});c=c.CompareTo.Core.Queue=function(c){this.autoStart=!!c};c.prototype={constructor:c,running:!1,autoStart:!0,queue:[],add:function(c){if("function"!==typeof c)return this;var d=this;this.queue.push(function(){var a=c();("undefined"===typeof a||a)&&d.next()});this.autoStart&&!this.running&&this.next();return this},next:function(){this.running=!1;var c=this.queue.shift();c&&(this.running=!0,c())}}})(window.R9);
(function(c,e){c.extend("CompareTo.Core.Window",{});c=c.CompareTo.Core.Window=function(){};var d=function(){return{y:"undefined"===typeof window.screenY?window.screenTop:window.screenY,x:"undefined"===typeof window.screenX?window.screenLeft:window.screenX,width:e(window).width(),height:e(window).height(),screenWidth:window.screen.availWidth,screenHeight:window.screen.availHeight}};c.prototype={constructor:c,tiled:function(a,b,f){return{url:this.urlForProviderCode(a),name:a.code,features:this.featuresForTiled(b,
f)}},hidden:function(a){return{url:this.urlForProviderCode(a),name:a.code,features:this.featuresForHidden()}},urlForProviderCode:function(a){if("undefined"!==typeof a.useDeepLink&&!0===a.useDeepLink&&"undefined"!==typeof a.deepLink)return a.deepLink;var b="";a.verticalName&&(b="\x26vertical\x3d"+a.verticalName);return"/s/compareresults/spinner?code\x3d"+encodeURIComponent(a.code)+b},featuresForHidden:function(a){var b=d(),f=Math.min(1024,b.height-20),c=Math.min(1280,b.width-20),g=b.y+10,l=b.x+10;
a&&(c=f=160,g=b.y+(b.height-110),l=b.x+(b.width-185));return{scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,top:g,left:l,height:f,width:c}},featuresForTiled:function(a,b){var f=d();b=Math.floor(f.screenWidth/b)-5;return{scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,top:0,height:f.screenHeight,left:(b+5)*a,width:b}},open:function(a,b,f,c){"object"===typeof f&&(f=this.objectToFeatureString(f));return open(a,this.getWindowName(b),f,c)},getWindowName:function(a){return a.replace(/[^a-z0-9]+/gi,
"")},objectToFeatureString:function(a){var b=[],f;for(f in a)a.hasOwnProperty(f)&&b.push(f+"\x3d"+a[f]);return b.join(",")},features:function(a){var b=!0===a.top||!1,f=!0===a.bottom||!1,c=!0===a.left||!1,g=!0===a.right||!1,l=a.height||150;a=a.width||250;var e=0,m=0,k=d();f&&(e+=b?0:k.height);g&&(m+=c?0:k.width);e+=b?10:-l;m+=g?-a:10;c&&g&&(a=k.width-20,m=10);b&&f&&(l=k.height+40,e=10);return{scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,top:k.y+e,left:k.x+m,height:l,width:a}},clonePosition:function(){var a=
d(),b=a.height,f=a.width,c=a.y+5,a=a.x+5;return{scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,screenX:a,screenY:c,top:c,left:a,innerHeight:b,innerWidth:f,height:b,width:f}},screenCorner:function(a,b){return{scrollbars:1,width:a,height:b,top:window.screen.availHeight+("undefined"!==typeof window.screenTop?window.screenTop:screen.top),left:window.screen.availWidth+("undefined"!==typeof window.screenLeft?window.screenLeft:screen.left)}}}})(window.R9,window.jq||window.jQuery);
(function(c,e){var d=[],a="flights trains hotels cars cruises rentals packages packagetours".split(" "),b=function g(){if(0!==d.length){var b=d[0];e.ajax({type:"POST",url:"/k/cookie",data:{action:"setmeta",metacookie:b.name,metavalue:b.value,formtoken:c.globals.formtoken},complete:function(){d.shift();g()},success:function(){b.callback()}})}},f=c.CompareTo.Core.Requests=function(){};f.prototype={constructor:f,lastRequestString:null,xhr:null,cleanUp:function(){this.lastRequestString=null},loadItems:function(b,
f){if(!c.CompareTo.Core.Config.getBoolean("ui.cmp2.reduce.request",!0)||this.lastRequestString!==e.param(b))if(this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),-1===e.inArray(b.vertical,a))"function"===typeof f&&f(null);else{var g=e.extend(!0,{},b);this.lastRequestString=e.param(b);if(c.CompareTo.Core.Config.getBoolean("ui.cmp2.reduce.request.data",!0))g=this.sanitizeParams(b);else switch(b.vertical){case "flights":case "trains":case "hotels":case "cars":case "cruises":case "rentals":case "packagetours":g.ptype=
b.vertical;break;case "packages":g.ptype="packagetours"}this.xhr=e.ajax({type:"GET",url:"/s/cmp2chk/items",dataType:"json",data:g,cache:!1}).done(function(b){if("function"===typeof f){if("string"===typeof b)try{b=e.parseJSON(b)}catch(k){b=null}f(b)}}).fail(function(){"function"===typeof f&&f(null)})}},sanitizeParams:function(b){var a={ptype:b.vertical,show_on:b.show_on,page_origin:b.page_origin};switch(b.vertical){case "flights":case "trains":this.putValues(b,a,"depart_date return_date depart_date_canon return_date_canon origin origincode destination destinationcode destcode cabin student travelers oneway".split(" "));
break;case "hotels":case "rentals":this.putValues(b,a,"checkin_date checkout_date checkin_date_canon checkout_date_canon location othercity citycode rooms guests lmid nhid".split(" "));break;case "cars":this.putValues(b,a,"pickup_date dropoff_date pickup_date_canon dropoff_date_canon location location1 citycode1 location2 citycode2 pickup_hour dropoff_hour oneway".split(" "));break;case "packages":case "packagetours":a.ptype="packagetours";this.putValues(b,a,"depart_date return_date depart_date_canon return_date_canon origincode destcode pt_geo_id".split(" "));
break;case "cruises":this.putValues(b,a,["destination","cruiseLine","sailDate","tripLength"])}return a},putValues:function(b,a,f){e.each(f,function(f,c){b.hasOwnProperty(c)&&(a[c]=b[c])})},saveItemState:function(a,f){d.push({name:c.CompareTo.Core.Config.getString("ui.cmp2.prefix","")+a.item.code,value:a.item.checked?"true":"false",callback:f||e.noop});1===d.length&&b()}}})(window.R9,window.jq||window.jQuery);
(function(c,e){var d=[];c.extend("CompareTo.Core.Items",{});var a=c.CompareTo.Core.Items=function(b,a){this.options=e.extend(!0,{},this.options,a);"string"===typeof b?this.element=e("#"+b):"object"===typeof b&&(this.element=e(b));if((b=this.element.data())&&b.compareToItems)return b.compareToItems;this.event=new c.CompareTo.Core.Event(this);b=this.element.find(this.options.itemsBlock);1===b.length&&(this.itemsElement=b);this._id=c.CompareTo.Core.UUID();this.init();this.addEventHandlers();this.element.data("compareToItems",
this);return this};a.prototype={constructor:a,event:null,element:e([]),itemsElement:e([]),_id:null,options:{limited:!0,keepCheckboxState:!0,radioButtons:!1,showCheckAllWhenItemsCount:3,workaround:"Core",template:{none:"\x3cspan class\x3d'span-button-wrapper'\x3e\x3cspan class\x3d'input' data-name\x3d'{name}'\x3e\x26nbsp;\x3c/span\x3e\x3c/span\x3e",checked:"\x3cspan class\x3d'span-button-wrapper'\x3e\x3cspan class\x3d'input checked' data-name\x3d'{name}' data-code\x3d'{code}'\x3e{label}\x3c/span\x3e\x3c/span\x3e",
unChecked:"\x3cspan class\x3d'span-button-wrapper'\x3e\x3cspan class\x3d'input' data-name\x3d'{name}' data-code\x3d'{code}'\x3e{label}\x3c/span\x3e\x3c/span\x3e"},itemsBlock:".items",source:"",pageOrigin:""},requests:null,requestData:[],showOn:"",init:function(){var b=this.id(),a=this.options,h=a.workaround;a.radioButtons=this.element.hasClass("radio");a.radioButtons&&(a.limited=!0);this.bindEvents();this.element.addClass("compareToHidden");this.requests=new c.CompareTo.Core.Requests;"undefined"!==
typeof c.CompareTo.Core.Workaround[h]?new c.CompareTo.Core.Workaround[h](b,a):new c.CompareTo.Core.Workaround.Core(b,e.extend({},{resetEvents:!0},a))},id:function(){return this._id},getPublishData:function(b){return e.extend({},{_cmp2id:this.id()},b)},addEventHandlers:function(){var b=this;this.on("cmp2.getItems",function(a){b.shouldUpdate(a)&&b.getItems(a)});this.on("cmp2.cleanUp",function(a){b.shouldUpdate(a)&&(b.displayBlock(0),b.requests.cleanUp())});this.on("cmp2.submit",function(a){if(b.shouldUpdate(a)){a.displayItems=
b.getDisplayItems();a.checkedItems=b.getCheckedItems();if(b.isVisible()){var f=b.getRequestData()||[],c=b.getDisplayItemsMap();e.each(f,function(b,a){"undefined"!==typeof c[a.code]&&(a.checked=c[a.code].checked)});b.setCookie(f)}b.event.publish("cmp2.event.submit",[b.getPublishData(a)])}})},setCookie:function(b){for(var a=b.length||0,c=this.options.pageOrigin,g=new window.Date,d=g.getTime(),e=[],m="compareTos"+c.charAt(0).toUpperCase(),c={c2s:null,origin:c,src:this.options.source,where:this.showOn},
k=0;k<a;k++){var n=b[k],q=[],r;q.push(n.id);r=this.createBinaryMask(n.prechecked,"-1"!==n.termId,n.visible,n.checked);q.push(r.toString(16));q.push(n.rank);e.push(q.join("|"))}c.c2s=e.join(";");g.setTime(d+6E4);b=encodeURIComponent(decodeURIComponent(JSON.stringify(c)));document.cookie=m+"\x3d"+b+"; expires\x3d"+g.toUTCString()+"; path\x3d/"},createBinaryMask:function(){for(var b=0,a=0,c=32<arguments.length?32:arguments.length;a<c;a++)b|=arguments[a]<<a;return b},bindEvents:function(){var b=this,
a=this.element,h=this.options.radioButtons;(function(b){return h?new c.CompareTo.Core.Type.RadioButtonGroup(b):new c.CompareTo.Core.Type.CheckBoxButtonGroup(b)})(a);a.on("change",".input",function(){b.changeItemState(this);var a=b.getPublishData({item:this,data:b.getItemData(this),checkedItems:b.getCheckedItems()});b.event.publish("cmp2.event.change",[a])}).on("click mousedown mouseup deselect select",".input",function(a){var c=b.getPublishData({item:this,data:b.getItemData(this),checkedItems:b.getCheckedItems(),
displayItems:b.getDisplayItems()});b.event.publish("cmp2.event."+a.type,[c])});a.on("click",".CompareTo-Controls .control, #compareALL .fauxlink",function(){var f=e(this).hasClass("check-all");f?c.Analytics.api.trackEvent({category:"Compare-to",action:"compare-to",label:"all"}):c.Analytics.api.trackEvent({category:"Compare-to",action:"compare-to",label:"none"});a.find(".input").each(function(){var a=b.getItemData(this);a.checked===f||a.fake||e(this).trigger("click")})})},changeItemState:function(b){b=
this.getItemData(b);this.options.keepCheckboxState&&(d[b.code]=b.checked);this.requests.saveItemState({item:b})},getItemData:function(b){e(b).data("data").checked=e(b).hasClass("checked");return e(b).data("data")},shouldUpdate:function(b){var a=this.id();return null!==a&&"undefined"!==typeof a?-1<a.indexOf(b._cmp2id):!1},getItems:function(b){var a=this;c.CompareTo.Core.BrowserConfig.getBoolean("cmp2.enabled",!0)&&c.CompareTo.Core.Config.getBoolean("ui.cmp2.enabled",!0)&&(this.setWhereToShow(b.show_on),
this.requests.loadItems(b,function(b){null!==b&&b.success?(b=a.getPublishData({items:b.compareTos}),a.event.publish("cmp2.rendering.prepare",[b]),a.setRequestData(b.items),a.printItems(b.items)):a.printItems([])}))},printItems:function(b){var a=this,h=0,g=[],d=a.itemsElement,p=a.getPublishData({items:b});a.event.publish("cmp2.rendering.start",[p]);d.empty();var m=0;e.each(b,function(b,c){c.visible&&(b=a.getItemDom(c),b=a.getPublishData({item:c,itemDom:b}),g.push(b.itemDom),a.event.publish("cmp2.rendering.item",
[b]),d.append(b.itemDom),h+=1);c.fake&&(m+=1)});0<m&&e(".buttonCompareTo").trigger("check").show();this.displayBlock(h-m);this.options.radioButtons&&(c.CompareTo.Core.Config.getBoolean("cmp2.radio.button.add.none",!0)&&d.append(a.getItemDom({name:"",code:"",visible:!1,checked:!1,none:!0})),this.element.trigger("repaint"));p.domItems=g;a.event.publish("cmp2.rendering.finished",[a.getPublishData(p)])},displayBlock:function(b){var a=this.options;0<b?(this.event.publish("cmp2.shown"),b={showControls:!1===
a.radioButtons&&a.showCheckAllWhenItemsCount<=b},b=this.getPublishData(b),this.event.publish("cmp2.rendering.controls",[b]),b.showControls?this.element.find(".CompareTo-Controls").show():this.element.find(".CompareTo-Controls").hide(),this.element.hasClass("compareToHidden")&&(this.element.removeClass("compareToHidden"),c.Analytics.api.trackEvent({category:"Compare-to",action:"compare-to",label:"on"}))):(this.event.publish("cmp2.hidden"),this.element.hasClass("compareToHidden")||(this.element.addClass("compareToHidden"),
c.Analytics.api.trackEvent({category:"Compare-to",action:"compare-to",label:"off"})))},getItemDom:function(b){var a;a=this.options;var c=a.template,g=c.unChecked,l={name:"cmp2-item",label:b.name,code:b.code,checked:b.checked};a.keepCheckboxState&&"undefined"!==typeof d[b.code]&&!0===d[b.code]&&(l.checked=d[b.code]);l.checked&&(g=c.checked);b.none&&(g=c.none||"");b.fake&&(g="\x3cspan class\x3d'span-button-wrapper type-{code}'\x3e\x3cspan class\x3d'input "+(b.checked?"checked":"")+"' data-name\x3d'{name}' data-code\x3d'{code}'\x3e{label}\x3c/span\x3e\x3c/span\x3e");
a=g.replace(/(\{label}|\{name}|\{code})/gi,function(b){b=b.substr(1,b.length-2);b=l[b];return"undefined"!==typeof b?b:""});a=e(a);a.find(".input").data("data",e.extend({},b));return a},setRequestData:function(b){this.requestData=b},getRequestData:function(){return this.requestData},isVisible:function(){return e(this.element).is(":visible")},getDisplayItems:function(){var b=this,a=[];this.isVisible()&&this.element.find(".input").each(function(){var c=b.getItemData(this);c&&c.visible&&a.push(c)});return a},
getDisplayItemsMap:function(){var b=this,a={};this.isVisible()&&this.element.find(".input").each(function(){var c=b.getItemData(this);c&&c.visible&&(a[c.code]=c)});return a},getCheckedItems:function(){var b=this,a=[];this.isVisible()&&this.element.find(".input.checked").each(function(){var c=b.getItemData(this);c&&c.visible&&a.push(c)});return a},updatePageOrigin:function(b){this.options.pageOrigin=b},setWhereToShow:function(b){this.showOn=b}}})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.ResultPage",{});var d=c.CompareTo.Core.ResultPage=function(a){this.options=e.extend({},this.options,a);this.init()};d.prototype={constructor:d,options:{items:[],workaround:"Core",pageOrigin:"",searchId:""},workaround:null,init:function(){var a=this.options,b=a.items,f=a.workaround;this.workaround="undefined"!==typeof c.CompareTo.Core.Workaround[f]?new c.CompareTo.Core.Workaround[f](null,a):new c.CompareTo.Core.Workaround.Core(null,a);this.open({compareTos:b,
pageOrigin:a.pageOrigin,searchId:a.searchId})},open:function(a){var b=this.workaround;if(b&&b instanceof c.CompareTo.Core.Workaround.Core)b.onResultPageOpen(a)},ajaxOpen:function(a){var b=this;e.ajax({type:"GET",url:"/s/cmp2chk/open",data:a,cache:!1}).done(function(a){b.open(a)})}}})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.RightRails",{});c.CompareTo.Core.RightRails=function(c){this.options=e.extend({},this.options,c);this.init()};c.CompareTo.Core.RightRails.prototype={constructor:c.CompareTo.Core.RightRails,options:{selector:e(),items:[],workaround:"Core",searchId:null},workaround:null,init:function(){var d=this.options,a=d.workaround,b;b="undefined"!==typeof c.CompareTo.Core.Workaround[a]?new c.CompareTo.Core.Workaround[a](null,d):new c.CompareTo.Core.Workaround.Core(null,d);
e(d.selector).on("click mousedown mouseup",function(a){if(b&&b instanceof c.CompareTo.Core.Workaround.Core)b.onDirectOpen(a,d.items)})}}})(window.R9,window.jq||window.jQuery);
(function(c,e){var d={};c.extend("CompareTo.Core.Workaround.Core",{});c.CompareTo.Core.Workaround.Core=function(a,b){this.options=e.extend({},this.options,b);this._id=a;this.event=new c.CompareTo.Core.Event(this);this.window=new c.CompareTo.Core.Window(a,b);this.options.ignoreEventHandlers||this.addEventHandlers()};c.CompareTo.Core.Workaround.Core.prototype={constructor:c.CompareTo.Core.Workaround.Core,event:null,options:{limited:!0,maxCheckedItems:1,maxPreCheckItems:2,usePreCheckItems:!0,radioButtons:!1,
showCheckAllWhenItemsCount:3,resetEvents:!1,ignoreEventHandlers:!1,pageOrigin:"",searchId:""},window:null,adjustPosition:{top:0,left:0},id:function(){return this._id},resetEvents:function(){this.off("cmp2.event.change");this.off("cmp2.event.click");this.off("cmp2.event.mousedown");this.off("cmp2.event.mouseup");this.off("cmp2.event.deselect");this.off("cmp2.event.select");this.off("cmp2.event.submit");this.off("cmp2.event.result.page.open");this.off("cmp2.rendering.prepare");this.off("cmp2.rendering.start");
this.off("cmp2.rendering.item");this.off("cmp2.rendering.finished")},addEventHandlers:function(){var a=this;this.options.resetEvents&&this.resetEvents();this.on("cmp2.event.change",function(b){if(a.shouldUpdate(b))a.onChange(b)});this.on("cmp2.event.click",function(b){if(a.shouldUpdate(b))a.onClick(b)});this.on("cmp2.event.mousedown",function(b){if(a.shouldUpdate(b))a.onMouseDown(b)});this.on("cmp2.event.mouseup",function(b){if(a.shouldUpdate(b))a.onMouseUp(b)});this.on("cmp2.event.deselect",function(b){a.shouldUpdate(b)&&
(a.persistItemsState(b,!1),a.onDeselect(b))});this.on("cmp2.event.select",function(b){a.shouldUpdate(b)&&(a.persistItemsState(b,!0),a.onSelect(b))});this.on("cmp2.event.submit",function(b){if(a.shouldUpdate(b))a.onSubmit(b)});this.on("cmp2.rendering.prepare",function(b){if(a.shouldUpdate(b))a.onPrepareRendering(b)});this.on("cmp2.event.result.page.open",function(b){if(a.shouldUpdate(b))this.onResultPageOpen(b)});this.on("cmp2.rendering.controls",function(b){if(a.shouldUpdate(b))a.onShowControls(b)});
this.on("cmp2.rendering.start",function(b){if(a.shouldUpdate(b))a.onRenderingStart(b)});this.on("cmp2.rendering.item",function(b){if(a.shouldUpdate(b))a.onRenderingItem(b)});this.on("cmp2.rendering.finished",function(b){if(a.shouldUpdate(b))a.onRenderingFinish(b)})},persistItemsState:function(a,b){if(c.CompareTo.Core.Config.getBoolean("ui.cmp2.superSticky",!1)){var f=new c.CompareTo.Core.Storage,d=a.checkedItems&&0===a.checkedItems.length;b&&(d=a.checkedItems&&a.displayItems&&a.checkedItems.length===
a.displayItems.length);d?f.set("cmp2.check.all",b):f.remove("cmp2.check.all")}},shouldUpdate:function(a){var b=this.id();return null!==b&&"undefined"!==typeof b?-1<b.indexOf(a._cmp2id):!1},onChange:function(a){},onClick:function(a){},onMouseDown:function(a){},onMouseUp:function(a){},onDeselect:function(a){},onSelect:function(a){},onPrepareRendering:function(a){var b=this.options,f=0,d=0,g=Math.min(b.maxCheckedItems,b.maxPreCheckItems);a=a.items;var e=null;c.CompareTo.Core.Config.getBoolean("ui.cmp2.superSticky",
!1)&&(e=(new c.CompareTo.Core.Storage).get("cmp2.check.all"));var p=!1;c.CompareTo.Core.Config.getBoolean("ui.cmp2.precheck",!1)&&(p=!0);for(var m=0;m<a.length;m+=1){var k=a[m];if(k.visible){var n=k.checked;b.limited&&!k.checked&&k.prechecked&&(d>=g&&(k.prechecked=!1),d+=1);n||(n=k.prechecked&&b.usePreCheckItems);null!==e&&(n=e);!0===p&&(n=!0);(k.checked=n)&&f++;b.limited&&f>b.maxCheckedItems&&(k.checked=!1)}}},onShowControls:function(a){this.options.limited&&(a.showControls=!1)},onRenderingStart:function(a){},
onRenderingItem:function(a){},onResultPageOpen:function(a){var b=this,c=a.compareTos||[],d=[],g=0;"function"===typeof a.preOpen&&a.preOpen.call(this,a);e.each(c,function(a,c){try{"CLOSE"===c.deepLink?b.window.open("",c.code).close():(g+=1,d.push(c))}catch(m){}});e.each(d,function(c,f){try{var d={name:f.code,url:f.deepLink,features:b.window.featuresForTiled(c,g)};"function"===typeof a.preOpenItem&&a.preOpenItem.call(this,d,a);var h=b.window.open("",d.name,d.features);b.addHandle(d.name,h);b.tilingWindow(d);
h.location.href=d.url;"function"===typeof a.postOpenItem&&a.postOpenItem.call(this,d,h,a)}catch(n){}});"function"===typeof a.postOpen&&a.postOpen.call(this,a)},onDirectOpen:function(a,b){if("click"===a.type)this.onResultPageOpen({compareTos:b})},getMultipleProvidersUrl:function(a){if(!a)return null;var b=a.compareTos||[],c=[];if(0<b.length){for(var d=0,g;g=b[d];d++)"CLOSE"!==g.deepLink&&c.push(g.code);if(0<c.length)return"/s/compareresults/multi?searchId\x3d"+a.searchId+"\x26pageOrigin\x3d"+a.pageOrigin+
"\x26forcehttp\x26providerCodes\x3d"+c.join(",")}return null},onSubmit:function(a){if("undefined"===typeof a)throw"Need specify data parameter for submit event";a.displayItems&&delete a.displayItems;a.checkedItems&&delete a.checkedItems;this.event.publish("form.submit",[a])},onRenderingFinish:function(a){},addHandle:function(a,b){d[a]=b},getHandles:function(){return d},setHandles:function(a){d=a},getHandle:function(a){try{var b=d[a];return!b||b.closed?null:b}catch(f){return null}},tilingWindow:function(a){var b=
this.getHandle(a.name);a=a.features;if("undefined"!==typeof a&&b){if(c.CompareTo.Core.BrowserConfig.getBoolean("resizeBeforeOpening",!0)&&"undefined"!==typeof a.width&&"undefined"!==typeof a.height)try{b.resizeTo(100,100)}catch(f){}if("undefined"!==typeof a.left&&"undefined"!==typeof a.top)try{0===a.top&&0===a.left&&(b.moveTo(-1E7,-1E7),this.adjustPosition.left="screenX"in b?b.screenX:b.screenLeft,this.adjustPosition.top="screenY"in b?b.screenY:b.screenTop),b.moveTo(this.adjustPosition.left+a.left,
this.adjustPosition.top+a.top)}catch(f){}if("undefined"!==typeof a.width&&"undefined"!==typeof a.height)try{b.resizeTo(parseInt(a.width),parseInt(a.height))}catch(f){}}}}})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.Workaround.BasicAuth",{});var d=c.CompareTo.Core.Workaround.Core,a=c.CompareTo.Core.Workaround.BasicAuth=function(b,a){d.prototype.constructor.call(this,b,a)};c.CompareTo.Core.Inherit(a,d);e.extend(a.prototype,{onSelect:function(b){var a=this.window;try{var d=a.hidden(b.data);d.features=a.features({bottom:!0});var g=a.open(d.url,d.name,d.features);this.addHandle(d.name,g);c.CompareTo.Core.Config.getBoolean("ui.cmp2.browser.focusOnSelect",!0)&&this.startFocusTimer(g)}catch(l){}},
onDeselect:function(b){try{var a=this.getHandle(b.data.code);a&&a.close()}catch(h){}},startFocusTimer:function(b,a){var c=e('\x3ciframe src\x3d"/cmp2/secure" width\x3d"1" height\x3d"1" style\x3d"display:none;" frameborder\x3d"0" scrolling\x3d"no" marginheight\x3d"0" marginwidth\x3d"0" /\x3e').appendTo(document.body),f=setInterval(function(){b.document.hasFocus()||setTimeout(function(){c.remove();clearInterval(f);"function"===typeof a&&a()},100)},100)},onSubmit:function(b){var a=this,c=this.window,
g=null;e.each(b.checkedItems,function(b,f){try{var d=c.hidden(f);d.features=c.features({bottom:!0});var h=c.open(d.url,d.name,d.features);a.addHandle(d.name,h);h&&(g=h)}catch(n){}});0<b.checkedItems.length?this.startFocusTimer(g,function(){d.prototype.onSubmit.call(this,b)}):d.prototype.onSubmit.call(this,b)}})})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.Workaround.ChangeWindowName",{});var d=c.CompareTo.Core.Workaround.Core,a=c.CompareTo.Core.Workaround.ChangeWindowName=function(b,a){d.prototype.constructor.call(this,b,a)};c.CompareTo.Core.Inherit(a,d);e.extend(a.prototype,{onResultPageOpen:function(b){if(b.compareTos&&0<b.compareTos.length){var a=c.CompareTo.Core.UUID(),h=this.window;window.name=a;b.postOpenItem=function(){h.open("",a,"")};b.postOpen=function(){h.open("",a,"")};d.prototype.onResultPageOpen.call(this,
b)}},onSubmit:function(b){var a=c.CompareTo.Core.UUID(),h=this.window;window.name=a;e.each(b.checkedItems,function(b,c){b=h.hidden(c);h.open(b.url,b.name,b.features);h.open("",a,"")});d.prototype.onSubmit.call(this,b)}})})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.Workaround.DocumentFocus",{});var d=c.CompareTo.Core.Workaround.Core,a=c.CompareTo.Core.Workaround.DocumentFocus=function(b,a){d.prototype.constructor.call(this,b,a)};c.CompareTo.Core.Inherit(a,d);e.extend(a.prototype,{onSelect:function(b){var a=this.window;try{var c=a.hidden(b.data);c.features=a.features({bottom:!0});var d=a.open(c.url,c.name,c.features);this.addHandle(c.name,d);this.windowFocus(d)}catch(l){}},onDeselect:function(b){try{var a=this.getHandle(b.data.code);
a&&a.close()}catch(h){}},focusInterval:null,windowFocus:function(b){this.focusInterval&&clearInterval(this.focusInterval);var a=0,c=this.focusInterval=setInterval(function(){try{b&&(b.blur(),b.opener.focus()),window.self.focus(),window.focus(),document.focus()}catch(g){}a++;10<a&&c&&clearInterval(c)},300)},onSubmit:function(b){var a=this,c=this.window,g=0;e.each(b.checkedItems,function(b,d){try{var f=c.hidden(d);f.features=c.features({bottom:!0});var e=c.open(f.url,f.name,f.features);a.addHandle(f.name,
e);a.windowFocus(e)}catch(n){}g++});d.prototype.onSubmit.call(this,b)}})})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.Workaround.SelfTarget",{});var d=c.CompareTo.Core.Workaround.Core,a=c.CompareTo.Core.Workaround.SelfTarget=function(b,a){d.prototype.constructor.call(this,b,a)};c.CompareTo.Core.Inherit(a,d);e.extend(a.prototype,{onDirectOpen:function(b,a){if("click"===b.type){var c=this.window,d=window.open("","_self");e.each(a,function(b,a){b=c.hidden(a);c.open(b.url,b.name,b.features);d.focus()});this.onResultPageOpen({compareTos:a})}},onSubmit:function(b){var a=this.window,
c=window.open("","_self");e.each(b.checkedItems,function(b,d){b=a.hidden(d);a.open(b.url,b.name,b.features);c.focus()});d.prototype.onSubmit.call(this,b)}})})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.Workaround.Simple",{});var d=c.CompareTo.Core.Workaround.Core,a=c.CompareTo.Core.Workaround.Simple=function(b,a){d.prototype.constructor.call(this,b,a)};c.CompareTo.Core.Inherit(a,d);e.extend(a.prototype,{onSubmit:function(b){var a=b.checkedItems.length,c=this.window;window.open("","_self");e.each(b.checkedItems,function(b,d){b=c.tiled(d,b,a);b=c.open(b.url,b.name,b.features);try{b.blur(),window.focus()}catch(p){}});d.prototype.onSubmit.call(this,b)}})})(window.R9,
window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.Workaround.Swapper",{});var d=c.CompareTo.Core.Workaround.Core;c.CompareTo.Core.Workaround.Swapper=function(a,b){d.prototype.constructor.call(this,a,b)};c.CompareTo.Core.Inherit(c.CompareTo.Core.Workaround.Swapper,d);e.extend(c.CompareTo.Core.Workaround.Swapper.prototype,{onDirectOpen:function(a,b){"click"===a.type&&(a=this.getMultipleProvidersUrl({searchId:this.options.searchId,pageOrigin:this.options.pageOrigin,compareTos:b}))&&this.window.open(a+"\x26position\x3dright",
"rr_compare"+this.options.pageOrigin+"rr_compare"+this.options.searchId,this.window.clonePosition())},onResultPageOpen:function(a){window.opener&&(a=this.getMultipleProvidersUrl(a))&&window.opener&&!window.opener.closed&&window.opener.location.replace(a)},onSubmit:function(a){if(0===a.checkedItems.length)d.prototype.onSubmit.call(this,a);else{var b=window.location.href,c=window.open("","_blank");if(c){try{c.history.replaceState({},"fd",b),c.history.pushState({},"fd",b)}catch(h){}setTimeout(function(){c.location.href=
"/"+a.url.replace(/(^[\/#]*|[\/#]*$)/g,"");window.location.href="/s/compareresults/spinner"},100)}}}})})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.Workaround.NewWindow",{});var d=c.CompareTo.Core.Workaround.Core,a=!1,b=!0,f=c.CompareTo.Core.Workaround.NewWindow=function(b,c){d.prototype.constructor.call(this,b,c);this.currentWindow=window.open("","_self");!1===a&&(this.bindCloseEvent(),this.bindUnloadEvent(),a=!0)};c.CompareTo.Core.Inherit(f,d);e.extend(!0,f.prototype,{currentWindow:null,timeInterval:1E3,mainWindowName:"kayak",bindCloseEvent:function(){var b=this;if(!function(a){return a?0===a.indexOf(b.mainWindowName,
0):!1}(window.name)){var a=c.CompareTo.Core.UUID();e("body").on("click",function(c){var d=window.location.href;c=e(c.target);c.is("a")&&(d=c.attr("href"));try{var f=window.open(d,b.mainWindowName+a,"toolbar\x3d0,width\x3d"+screen.width+", height\x3d"+screen.height);f&&(f.focus(),e(f).on("load",function(){f.focus()}),b.currentWindow.close())}catch(k){}})}},bindUnloadEvent:function(){var a=this;e(window).on("unload",function(){b&&e.each(a.getHandles(),function(b,c){(b=a.getHandle(b))&&b.close()})})},
onResultPageOpen:function(b){var a=this;b.postOpenItem=function(b,c,d){a.tryFocus(c)};d.prototype.onResultPageOpen.call(this,b);a.setHandles({})},onSelect:function(b){var a=this.window,c=this;try{var d=a.hidden(b.data);d.features=a.features({bottom:!0,right:!0});d.features.top=1E4;d.features.left=1E4;d.features.screenX=1E4;d.features.screenY=1E4;var f=a.open(d.url,d.name,d.features);this.addHandle(d.name,f);c.tryFocus(f);setTimeout(function(){c.tryFocus(f)},c.timeInterval)}catch(k){}},tryFocus:function(b){var a=
this;b&&!b.closed&&(e(b).on("load",function(){window.focus();setTimeout(function(){window.focus()},a.timeInterval/5)}),b.opener.focus());try{window.focus(),this.currentWindow&&this.currentWindow.focus()}catch(l){}},onDeselect:function(b){try{var a=this.getHandle(b.data.code);a&&a.close()}catch(l){}},onSubmit:function(a){var c=this,f=this.window;b=!1;var h=0,m=null;e.each(a.checkedItems,function(b,a){try{var d=f.hidden(a);d.features=f.features({bottom:!0});var e=f.open(d.url,d.name,d.features);c.addHandle(d.name,
e);c.tryFocus(e);e&&(m=e)}catch(t){}h++});c.tryFocus(m);setTimeout(function(){c.tryFocus(m)},c.timeInterval);d.prototype.onSubmit.call(this,a)}})})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.Workaround.Alert",{});var d=c.CompareTo.Core.Workaround.Core,a=!1,b=!0,f=new c.CompareTo.Core.Queue(!1),h=c.CompareTo.Core.Workaround.Alert=function(b,c){d.prototype.constructor.call(this,b,c);!1===a&&(this.bindUnloadEvent(),a=!0)};c.CompareTo.Core.Inherit(h,d);e.extend(!0,h.prototype,{bindUnloadEvent:function(){var a=this;e(window).on("unload",function(){b&&e.each(a.getHandles(),function(b){(b=a.getHandle(b))&&b.close()})})},onResultPageOpen:function(b){if(b.compareTos&&
0<b.compareTos.length){var a=e.parseJSON(decodeURIComponent(c.CompareTo.Core.Cookie.get("c2win")));c.CompareTo.Core.Cookie.set("c2win","",-1);var f=this,g=window;b.preOpenItem=function(b,c){b.name=a.shift()};b.postOpenItem=function(b,a){a&&(g=a)};b.postOpen=function(){c.CompareTo.Core.Config.getBoolean("ui.cmp2.browser.focusOnRP",!1)&&f.windowFocus(g)};d.prototype.onResultPageOpen.call(this,b);f.setHandles({})}},onSelect:function(b){var a=this,d=this.window;try{var f=[];e.each(a.getHandles(),function(b){(b=
a.getHandle(b))&&f.push(b.name)});if(f.length<b.checkedItems.length){var g=c.CompareTo.Core.UUID(),h=b.data,q=d.hidden(h);q.features=this.getSmallWindowFeatures();var r=d.open(q.url,"u"+g,q.features);this.addHandle("u"+g,r);this.addQueue(h,r);this.windowFocus(r)}}catch(t){}},getSmallWindowFeatures:function(){var b=this.window.features({bottom:!0,right:!0});b.top=1E4;b.left=1E4;b.screenX=1E4;b.screenY=1E4;return b},windowFocus:function(b){var a=this,c=new Date,d=setInterval(function(){window.document.hasFocus()?
500<new Date-c&&clearInterval(d):window.document.hasFocus()||(clearInterval(d),a.createIFrame(b))},100)},addQueue:function(b,a){var c=this;f.add(function(){c.repositionHandle(a)})},repositionHandle:function(b){var a=this.window;if(b){var c={name:b.name,features:{}};b.document.hasFocus()?c.features=this.getSmallWindowFeatures():c.features=a.features({top:!0,width:e(window).width(),height:e(window).height()});this.tilingWindow(c)}},createIFrame:function(b){if(!b||b.closed)return null;var a,c,d,g,h,
q=0;a=function(){};c=function(){e("#pdfAlert").remove();d=document.createElement("iframe");d.setAttribute("id","pdfAlert");d.style.display="none";d.src="/pa.html";document.body.appendChild(d)};g=function(){e("#pdfAlert").remove()};h=function(){g();a()};(function(){var a=!1,c=setInterval(function(){var e;try{e=b.document.hasFocus()}catch(u){return void h()}if(a&&!e){clearInterval(c);setTimeout(function(){f.next()},250);try{d.src="about:blank";var g=0,l=setInterval(function(){g++;0===g%2?d.src="about:home":
d.src="about:blank";8===g&&clearInterval(l)},250);return}catch(u){return void h()}}return q&&3E3<new Date-q?(h(),!0):void(a=e)},1)})();setTimeout(function(){q=new Date;c()},100)},getHandleNames:function(){var b=this,a=[];e.each(b.getHandles(),function(c){(c=b.getHandle(c))&&a.push(c.name)});return a},closeUnUsedWindows:function(b){var a=this,c=b;e.each(a.getHandles(),function(b){if(b=a.getHandle(b))--c,0>c&&b.close()})},onSubmit:function(a){var e=this,h=this.window;b=!1;var g=window,k=this.getHandleNames(),
n=!1;if(0<a.checkedItems.length&&a.checkedItems.length>k.length)try{var q=c.CompareTo.Core.UUID(),r=h.hidden(a.checkedItems[0]);r.features=e.getSmallWindowFeatures();var t=h.open(r.url,"u"+q,r.features);e.addHandle("u"+q,t);g=t;n=!0}catch(v){}this.closeUnUsedWindows(a.checkedItems.length);c.CompareTo.Core.Cookie.set("c2win",encodeURIComponent(decodeURIComponent(JSON.stringify(this.getHandleNames()))),6E5);n?(f.add(function(){e.repositionHandle(g);d.prototype.onSubmit.call(e,a)}),this.windowFocus(g)):
d.prototype.onSubmit.call(this,a)}})})(window.R9,window.jq||window.jQuery);
(function(c,e){function d(b){return b.charCodeAt(0)}function a(b,a,c){a=a||"";c=c||1024;b=atob(b);for(var f=[],e=0;e<b.length;e+=c){var h=b.slice(e,e+c),h=Array.prototype.map.call(h,d),h=new Uint8Array(h);f.push(h)}return new Blob(f,{type:a})}c.extend("CompareTo.Core.Workaround.SwapperPdfAlert",{});var b=c.CompareTo.Core.Workaround.Core;c.CompareTo.Core.Workaround.SwapperPdfAlert=function(a,d){b.prototype.constructor.apply(this,arguments);this.options=e.extend(!0,this.options,{timer:c.CompareTo.Core.BrowserConfig.getInt("cmp2.timer",
this.options.timer)})};c.CompareTo.Core.Inherit(c.CompareTo.Core.Workaround.SwapperPdfAlert,b);e.extend(c.CompareTo.Core.Workaround.SwapperPdfAlert.prototype,{pdfIds:[],options:{timer:1E3},createPdf:function(){var b;b=["%PDF-1.3","1 0 obj","\x3c\x3c","/Kids [ 2 0 R ]","/Type /Pages","/Count 1","\x3e\x3e","endobj","2 0 obj","\x3c\x3c","/Parent 1 0 R","/Type /Page","/Resources \x3c\x3c","\x3e\x3e","/MediaBox [ 0 0 0 0 ]","\x3e\x3e","endobj","3 0 obj","\x3c\x3c","/Type /Action","/S /JavaScript",'/JS ( var a \x3d"'+
c.CompareTo.Core.UUID()+'"; app.alert("Please wait"); )',"\x3e\x3e","endobj","4 0 obj","\x3c\x3c","/Type /Catalog","/Pages 1 0 R","/OpenAction 3 0 R","\x3e\x3e","endobj","xref","0 5","0000000000 65535 f","0000000009 00000 n","0000000068 00000 n","0000000154 00000 n","0000000277 00000 n","trailer","\x3c\x3c","/Size 5","/Root 4 0 R","\x3e\x3e","startxref","344","%%EOF"];b=URL.createObjectURL(a(btoa(b.join("\n")),"application/pdf"));var d=e('\x3cobject data\x3d"'+b+'" type\x3d"application/pdf"\x3e\x3c/object\x3e');
d.attr("style","visibility:visible;width:0;height:0;opacity:0;position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;");e("body").append(d);this.pdfIds.push({dom:d,source:b});return!0},removePdf:function(b){e.each(this.pdfIds,function(b,a){e(a.dom).remove();URL.revokeObjectURL(a.source)});this.pdfIds=[];b.apply(this)},isInstalledPDF:function(){var b=!1;try{b=c.CompareTo.Core.PDF.isInstalled()}catch(h){}return b},onDirectOpen:function(b,a){if(!this.isInstalledPDF())return c.CompareTo.Core.Workaround.Swapper.prototype.onDirectOpen.apply(this,
arguments);if("click"===b.type){var d=this.getMultipleProvidersUrl({searchId:this.options.searchId,pageOrigin:this.options.pageOrigin,compareTos:a});if(d){var f=this.window,h=f.getWindowName(this.options.pageOrigin+"rr_compare"+this.options.searchId),m=this.getHandle(h);m||(this.focusWindow(e.noop),m=f.open(d+"\x26position\x3dright",h,f.featuresForTiled(0,1)),this.addHandle(h,m))}}},onResultPageOpen:function(b){if(!this.isInstalledPDF())return c.CompareTo.Core.Workaround.Swapper.prototype.onResultPageOpen.apply(this,
arguments);var a=this.getMultipleProvidersUrl(b);if(a){a={name:window.name+"popUnderWindow",url:a,features:null};c.CompareTo.Core.Config.getBoolean("ui.cmp2.full.screen.window",!0)?a.features=this.window.featuresForTiled(0,1):a.features=this.window.clonePosition();var d=this.window.open("",a.name,a.features);this.addHandle(a.name,d);this.tilingWindow(a);d&&(d.location.href=a.url)}},focusWindow:function(b){function a(){clearInterval(c);k.removePdf(b);m=!1;e(window).off("focus.SwapperPdfAlertOnSubmit")}
var c=setInterval(function(){d++>f?a():document.hasFocus()?m&&a():m=m||k.createPdf()},1);e(window).off("focus.SwapperPdfAlertOnSubmit").on("focus.SwapperPdfAlertOnSubmit",function(){a()});var d=0,f=this.options.timer,m=!1,k=this},onSubmit:function(a){function d(){var a=f.window.clonePosition();e.each(f.getHandles(),function(b){f.tilingWindow({name:b,features:a})});b.prototype.onSubmit.apply(f,l)}var f=this,l=arguments;if(!this.isInstalledPDF())return c.CompareTo.Core.Workaround.Swapper.prototype.onSubmit.apply(this,
l);if(0===a.checkedItems.length)d();else{var p=window.name=f.id(),m=this.window.screenCorner(1,1);this.focusWindow(d);var p=p+"popUnderWindow",k=this.getHandle(p);k||(k=this.window.open("/s/compareresults/spinner",p,m),this.addHandle(p,k));k||d()}}})})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.Workaround.HandleOpen",{});var d=c.CompareTo.Core.Workaround.Core;c.CompareTo.Core.Workaround.HandleOpen=function(b,a){d.call(this,b,a)};var a=c.CompareTo.Core.Workaround.HandleOpen;c.CompareTo.Core.Inherit(a,d);e.extend(a.prototype,{onDirectOpen:function(b,a){if("click"===b.type)this.onResultPageOpen({compareTos:a,postOpenItem:function(b,a){a&&!a.closed&&a.open("about:blank").close()}})},onSubmit:function(b){for(var a=b.checkedItems.length,c=this.window,e=
0,l;l=b.checkedItems[e];e++){l=c.tiled(l,e,a);try{var p=c.open(l.url,l.name,l.features);p&&!p.closed&&p.open("about:blank").close()}catch(m){}}d.prototype.onSubmit.call(this,b)}})})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.Workaround.HandleOpenLast",{});var d=c.CompareTo.Core.Workaround.Core;c.CompareTo.Core.Workaround.HandleOpenLast=function(a,b){d.prototype.constructor.call(this,a,b)};c.CompareTo.Core.Inherit(c.CompareTo.Core.Workaround.HandleOpenLast,d);e.extend(c.CompareTo.Core.Workaround.HandleOpenLast.prototype,{onDirectOpen:function(a,b){if("click"===a.type){var c;this.onResultPageOpen({compareTos:b,postOpenItem:function(b,a){a&&!a.closed&&(c=a)},postOpen:function(){c&&
!c.closed&&handle.open("about:blank").close()}})}},onSubmit:function(a){var b=a.checkedItems.length,c=this.window,h;e.each(a.checkedItems,function(a,d){a=c.tiled(d,a,b);(a=c.open(a.url,a.name,a.features))&&(h=a)});h&&h.open("about:blank").close();d.prototype.onSubmit.call(this,a)}})})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.Core.MultiProviderWindow",{});c.CompareTo.Core.MultiProviderWindow=function(c,a){this.options=e.extend(!0,{},this.options,a);this.setItems(c);this.init()};c.CompareTo.Core.MultiProviderWindow.prototype={constructor:c.CompareTo.Core.MultiProviderWindow,element:e([]),items:[],options:{height:0,index:-1,searchId:""},Z_INDEX:{TAB_BOTTOMS:100,FRAMES:200,TAB_TOPS:300},openFrameIndex:-1,frameWidth:-1,frameHeight:-1,contentWidth:-1,contentHeight:-1,tabHeight:-1,init:function(){this.openFrameIndex=
this.options.index;var c=this.content=e("#providerContent");this.frameContainer=e("#providerFrames");this.tabTops=e("#providerTabTops");this.contentSize={topMargin:parseInt(c.css("marginTop").replace("px","")),bottomMargin:parseInt(c.css("marginBottom").replace("px","")),leftMargin:parseInt(c.css("marginLeft").replace("px","")),rightMargin:parseInt(c.css("marginRight").replace("px",""))};for(var c=0,a;a=this.items[c];c++)this.createCompareItem(c,a);this.bindEvents()},setItems:function(c){this.items=
[];for(var a=0,b;b=c[a];a++)"CLOSE"!==b.url&&(b.tab=b.frame=b.wrapper=e([]),b.loaded="true"===b.loaded,this.items.push(b));0===this.items.length&&window.close()},createCompareItem:function(c,a){var b=this.frameContainer,d=this.tabTops,h=a.code,g=e("\x3ciframe /\x3e",{src:"about:blank"});b.append(g);a.frame=g;g.wrap('\x3cdiv class\x3d"frame"/\x3e');a.wrapper=g.parent();a.wrapper.data("code",h);b=e("\x3cdiv /\x3e",{"class":"tab"});a.logoPath&&-1===a.logoPath.indexOf("ffffffffffffffffff")?(b.append(e("\x3cimg /\x3e",
{src:a.logoPath})),b.append(e('\x3cspan class\x3d"siteName" /\x3e').html(a.name))):b.append(e('\x3cspan class\x3d"siteNameSingle"/\x3e').html(a.name));a.tab=b;b.data("code",h);b.data("index",c);d.append(b)},getItemByCode:function(c){for(var a=null,b=0,d;d=this.items[b];b++)if(d.code===c){a=d;break}return a},bindEvents:function(){var c=this;this.tabTops.on("click",".tab",function(){var a=e(this).data("index");c.openFrameIndex=c.openFrameIndex===a?-1:a;c.applyLayout()});e(window).on("message",function(a){(a=
a.originalEvent.data)&&"cmp2"===a.type&&(a=c.getItemByCode(a.code),c.changeFrameSource(a))});e(window).on("resize",function(){c.applyLayout()});this.applyLayout()},adjustIFrameSizes:function(){var c=e(".frame"),a=this.items.length;if(!(1>c.length||1>a)){var b=this.tabTops.height(),f=this.contentSize,h=e(window).height(),g=e(window).width(),h=h-(f.topMargin+f.bottomMargin),c=parseInt(c.css("minWidth").replace("px","")),g=Math.max(c,Math.floor((g-(f.leftMargin+f.rightMargin))/a)),a=g*a;500>h&&(h=500);
(c=this.options.height)&&0!==c||(c=h-b);this.frameWidth=g;this.frameHeight=c;this.contentWidth=a;this.contentHeight=h;this.tabHeight=b;this.tabWidth=e(".tab",this.tabTops).width();this.content.css({margin:0,top:f.topMargin,left:f.leftMargin,height:h,width:a})}},changeFrameSource:function(c){c&&(c.frame.attr("src",c.url.replace(/['"]/g,"\\$1")),c.loaded=!0,c.frame.data("loaded",1))},displayActive:function(c,a,b){a.wrapper.hide();a.tab.removeClass("active");a.tab.css({zIndex:this.Z_INDEX.TAB_TOPS+(c===
b?50:1),left:c*this.tabWidth});c===b&&(a.wrapper.show(),a.wrapper.css({top:0,left:0,width:this.contentWidth,height:this.frameHeight}),a.frame.css({width:this.contentWidth,height:this.frameHeight}),!0!==a.loaded&&this.changeFrameSource(a),a.tab.addClass("active"))},displayTitled:function(c,a){a.tab.css({zIndex:this.Z_INDEX.TAB_TOPS+c,left:c*this.frameWidth});a.wrapper.show();a.wrapper.css({zIndex:this.Z_INDEX.FRAMES+c,left:c*this.frameWidth,width:this.frameWidth,height:this.frameHeight});a.frame.css({width:this.frameWidth,
height:this.frameHeight});!0!==a.loaded||a.frame.data("loaded")||this.changeFrameSource(a)},applyLayout:function(){this.adjustIFrameSizes();for(var c=this.openFrameIndex,a=0,b;b=this.items[a];a++)-1<c?this.displayActive(a,b,c):this.displayTitled(a,b)}}})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.SmarterTravelMedia.SmarterAds",{});var d=null,a=c.CompareTo.SmarterTravelMedia.SmarterAds=function(b){if(null!==d)return d.setConfig(b),d;d=this;e(function(){d.formatSmartTravelConfig();d.loadScript()});this.setConfig(b)};a.prototype={constructor:a,placements:{},placementsMap:{},cityCodeNames:{},verticalCounter:{},setConfig:function(b){b.vertical||(b.vertical=c.globals.analytics.vertical);b.vertical=this.getVerticalName(b.vertical);this.createPlacement(b)},getVerticalName:function(b){var a=
b.lastIndexOf("s");a>b.length-2&&(b=b.substr(0,a));"flight"===b&&(b="air");"package"===b&&(b="vacation");"flight"===b&&(b="air");if("package"===b||"packagetour"===b)b="vacation";return b},createPlacement:function(b){"undefined"===typeof this.verticalCounter[b.vertical]&&(this.verticalCounter[b.vertical]=0);this.verticalCounter[b.vertical]+=1;var a=this,d=b.vertical+this.verticalCounter[b.vertical],g=this.getContextData(b),l={locale:c.globals.locale.loc,currency:c.globals.analytics.pixelContext.site_currency};
"undefined"===typeof l.currency&&(l.currency=b.currency);if("undefined"===typeof l.currency)throw Error("currency is not defined");g.getter=function(){return e.extend(!0,{},l,a.getFieldsInput(b))};this.placements[d]={containerSelector:"#"+b.id,formSelector:"#"+b.formId,contextData:g};this.placementsMap[d]=b},getContextData:function(b){var a={};"air"===b.vertical&&(a.flightClassInputMapping={economyCoach:["e","p"],business:"b",firstClass:"f"},a.flightTypeInputMapping={roundtrip:"roundtrip",oneway:"oneway"});
if("car"===b.vertical||"air"===b.vertical)a.timeFormat="h";a.dateFormat=c.globals.apiDateFormat;b.dateFormat&&(a.dateFormat=b.dateFormat);"vacation"===b.vertical&&(a.dateFormat="YYYYMMDD");if("undefined"===typeof a.dateFormat)throw Error("date format is not defined");return a},loadScript:function(){var b=document.createElement("script");b.src="//p.smartertravel.com/ext/partner/kayak/kayak-hosted.min.js";b.async=!0;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(b,a)},getFieldsInput:function(b){var a=
{},d;if(c.ComponentManager){var g=c.ComponentManager.debugGetComponent(b.componentFormId);g&&"function"===typeof g.getCompareToFormData&&(d=g.getCompareToFormData())}else d=c.CompareTo.View.getViewFromForm(e("#"+b.formId)).getArgs();d&&("air"===b.vertical&&(a.originName=this.getAirportName(d.origin,d.origincode,b.vertical),a.destinationName=this.getAirportName(d.destination,d.destinationcode,b.vertical),a.date1=d.depart_date,a.date2=d.return_date,a.flightServiceClass=d.cabin,a.flightType=d.oneway?
"oneway":"roundtrip",a.numAdults=d.travelers),"hotel"===b.vertical&&(g=this.getCityName(d.citycode,b.vertical),a.destinationName=""===g?d.location:g,a.date1=d.checkin_date,a.date2=d.checkout_date,a.numAdults=d.guests,a.numRooms=d.rooms),"car"===b.vertical&&(g=this.getCityName(d.citycode1,b.vertical),a.destinationName=""===g?d.location1:g,a.date1=d.pickup_date,a.date2=d.dropoff_date,a.time1=d.pickup_hour,a.time2=d.dropoff_hour),"vacation"===b.vertical&&(b=this.getCityName(d.origincode,b.vertical),
a.originName=""===b?d.origin:b,b=this.getCityName(d.pt_geo_id,"packages"),a.destinationName=""===b?d.destinationName:b,a.date1=d.depart_date,a.date2=d.return_date));return a},getAirportName:function(b,a,c){c=this.getCityName(a,c);""===c?a?(a=a.substr(0,3),a.match(/^[a-z]{3}$/i)||(a=b)):a=b:a=c;return a},getCityName:function(b,a){if((b=e.trim(b))&&0<b.length){var c=this;if(!this.cityCodeNames[b]||"OK"==this.cityCodeNames[b].status&&!this.cityCodeNames[b].name)this.cityCodeNames[b]={status:"PENDING",
name:""},e.ajax({url:"/s/compareresults/cityName",data:{code:b,vertical:a},dataType:"text",success:function(a,d,f){"success"===d&&(c.cityCodeNames[b]={status:"OK",name:e.trim(f.responseText)})}});return c.cityCodeNames[b].name}return""},formatSmartTravelConfig:function(){var b=this,a=c.ComponentManager?".horizon":"",d=this.getVerticalName(c.globals.analytics.vertical),e=this.getPageId();window.SmarterTravelConfig={pageName:d+".sem"+a+"."+e,redirectPageUrl:"/s/compareresults/spinner",eventHandlers:{frontDoorAdsRendered:function(a,
d){a=b.placementsMap[a];c.ComponentManager&&"undefined"!==typeof a&&(a=a.id,c.events.publish("cmp2.rendering.finished",{id:a}),0<d?c.events.publish("cmp2.shown",{id:a}):c.events.publish("cmp2.hidden",{id:a}))}},placements:this.placements}},getPageId:function(){var a=c.globals.analytics.subPageId;if(a){var d=a.indexOf("-");0<d&&(a=a.substr(0,d));return a}return""}}})(window.R9,window.jq||window.jQuery);
(function(c,e){c.extend("CompareTo.SmarterTravelMedia.SparkleSmarterAds",{});c.CompareTo.SmarterTravelMedia.SparkleSmarterAds=function(d,a){var b=e("#"+d).closest("form");d={id:d,formId:b.attr("id"),vertical:b.find("input[name\x3dtab]").val(),pageOrigin:"",dialog:!b.is(":visible")};new c.CompareTo.SmarterTravelMedia.SmarterAds(e.extend(!0,{},d,a))}})(window.R9,window.jq||window.jQuery);(function(c){R9.extend("config",{getString:function(a,b){return window.R9&&R9.globals&&R9.globals.uiconfig&&"undefined"!=typeof R9.globals.uiconfig[a]?R9.globals.uiconfig[a]:b},getBoolean:function(a,b){return(a=R9.config.getString(a))?"true"===a.toLowerCase():b},getInt:function(a,b){return(a=R9.config.getString(a))?parseInt(a):b}})})(jq||jQuery);(function(e){var k=!1;R9.extend("Widgets",{Tooltip:function(a,b){this.element=e(a);this.element.data(this.widgetName,this);this.setOptions(b,!0)}});R9.extend("Widgets.Tooltip",{validateElement:function(a){return void 0===e(a).data(this.prototype.widgetName)},getInstance:function(a,b){return this.validateElement(a)?new R9.Widgets.Tooltip(a,b):(a=e(a).data(this.prototype.widgetName),b?a.setOptions(b):a)},removeWidget:function(a){this.validateElement(a)||this.getInstance(a).removeWidget()}});R9.extend("Widgets.Tooltip.prototype",
{element:null,widgetNamespace:"r9-tooltip",widgetBaseClass:"r9-tooltip",widgetName:"tooltip",options:{delay:200,fadeIn:200,fadeOut:200,edgeOffset:3,baseClass:null,content:null,position:"top",activation:"hover",showImmediately:!1,subNameSpace:"",onOpen:null,onClose:null,positionUpdate:!1,appendTo:"body",offsetLeft:0,keepOpenOnContentHover:!1,closeDelay:0,forceDesiredPosition:!1},_timer:null,_closeTimer:null,_originalTitle:null,_positionUpdater:null,init:function(){this._removeAllWidgetBindings();var a=
this;switch(this.options.activation){case "click":var b=!1;this.element.on("click."+this.widgetName,function(c){!1===k&&(b=!1);!1===b?a.open(c):a.close(c);k=b=!b});this.options.showImmediately&&this.element.trigger("click."+this.widgetName);break;case "focus":this.element.on("focus."+this.widgetName,function(b){a.open(b)});this.element.on("blur."+this.widgetName,function(b){a.close(b)});this.options.showImmediately&&this.element.trigger("focus."+this.widgetName);break;default:if(this.element.on("mouseenter."+
this.widgetName,function(b){clearTimeout(a._closeTimer);a.open(b)}),this.element.on("mouseleave."+this.widgetName,function(b){a.options.closeDelay?a._closeTimer=setTimeout(function(){a.close(b)},a.options.closeDelay):a.close(b)}),this.options.showImmediately&&this.element.trigger("mouseenter."+this.widgetName),this.options.keepOpenOnContentHover)this._getContainerElement().on("mouseenter."+this.widgetName,function(){clearTimeout(a._closeTimer)}).on("mouseleave."+this.widgetName,function(b){a._closeTimer=
setTimeout(function(){a.close(b)},a.options.closeDelay)})}return this},setOptions:function(a,b){a&&(this.options=e.extend({},this.options,a));(a||b)&&this.init();return this},open:function(a){var b=this.getContent(a);if(!b)return this;var c=this._getWrapperElement(),d=this._getContainerElement(),f=this._getArrowElement();d.html(b);this._resetElements(c,d,f);b=this._getPositionMap(c,f);this._updateArrowElement(b,f);this._updateWrapperElement(b,c);this._updateContainerElement(b,d);this._timer&&clearTimeout(this._timer);
this._closeTimer&&clearTimeout(this._closeTimer);if(this.options.delay){var g=this;this._timer=setTimeout(function(){g._open(c,a)},this.options.delay)}else this._open(c,a);this._positionUpdater&&clearInterval(this._positionUpdater);e(window).on("resize",e.proxy(this._updatePosition,this));return this},close:function(){this._timer&&clearTimeout(this._timer);this._closeTimer&&clearTimeout(this._closeTimer);this._positionUpdater&&clearInterval(this._positionUpdater);e(window).off("resize",this._updatePosition);
var a=this._getWrapperElement();a.stop(!0,!0);var b=this;this.options.fadeOut?a.fadeOut(this.options.fadeOut,function(){b._close()}):(a.hide(),this._close());return this},getContent:function(a){var b=this.element.attr("title");b&&(this._originalTitle=b,this.element.attr("title",""));return this.options.content?"function"==typeof this.options.content?this.options.content.call(this,a):this.options.content:this._originalTitle?this._originalTitle:null!=this.element.data("title")?this.element.data("title"):
this.element.text()},removeWidget:function(){this._removeAllWidgetBindings();this.element.removeData(this.widgetName);this.close();return this},_updatePosition:function(){var a=this._getWrapperElement(),b=this._getContainerElement(),c=this._getArrowElement(),d=this._getPositioning(a,c);this._updateArrowElement(d,c);a.css({top:d.newWrapperTop+"px",left:d.newWrapperLeft+"px"});this._updateContainerElement(d,b)},_getWrapperElement:function(){var a=e("#"+this._getIdValue("-wrapper"));a.length||(a=this._createDOMElement("-wrapper"),
e(this.options.appendTo).append(a));return a},_getContainerElement:function(){var a=e("#"+this._getIdValue("-container"));a.length||(a=this._createDOMElement("-container"),this._getWrapperElement().append(a));return a},_getArrowElement:function(){var a=e("#"+this._getIdValue("-arrow"));a.length||(a=this._createDOMElement("-arrow"),this._getWrapperElement().append(a));return a},_createDOMElement:function(a){var b=e("\x3cdiv\x3e\x3c/div\x3e").attr("id",this._getIdValue(a));this._setStyleClasses(b,a);
return b},_removeAllWidgetBindings:function(){this.element.off("click."+this.widgetName).off("focus."+this.widgetName).off("blur."+this.widgetName).off("mouseenter."+this.widgetName).off("mouseleave."+this.widgetName);return this},_getOffsetInformation:function(a,b,c){var d=this.element.outerWidth(),f=this.element.outerHeight(),g=this.element.offset().top-e(this.options.appendTo).offset().top,h=this.element.offset().left-e(this.options.appendTo).offset().left;a="width"===a?c.outerWidth():c.outerHeight();
return{arrowSize:Math.round(a/2),elementWidth:d,elementHeight:f,wrapperWidth:b.outerWidth(),wrapperHeight:b.outerHeight(),offset:{top:Math.floor(g),left:Math.floor(h)}}},_getPositionMap:function(a,b){a.attr("style","").css({top:"-1000px",left:"-5000px",display:"block"});return this._getPositioning(a,b)},_getPositioning:function(a,b){switch(this.options.position){case "bottom":return this._getBottomPositioning(a,b);case "left":return this._getLeftPositioning(a,b);case "right":return this._getRightPositioning(a,
b);default:return this._getTopPositioning(a,b)}},_getCommonPositioningMap:function(){return{newArrowTop:0,newArrowLeft:0,newWrapperTop:0,newWrapperLeft:0,wrapperClass:""}},_getTopPositioning:function(a,b){a=this._getOffsetInformation("height",a,b);b=Math.floor(a.elementWidth/2);var c="-top",d=a.wrapperHeight,f=a.offset.top-this.options.edgeOffset-a.arrowSize-a.wrapperHeight;!this.options.forceDesiredPosition&&0>=f&&(c="-bottom",f=a.offset.top+a.elementHeight+this.options.edgeOffset+a.arrowSize,d=
-1*a.arrowSize);e.support.leadingWhitespace||--d;return e.extend(this._getCommonPositioningMap(),{newArrowTop:d,newArrowLeft:Math.floor(a.wrapperWidth/2)-a.arrowSize,newWrapperTop:f,newWrapperLeft:a.offset.left+b-Math.floor(a.wrapperWidth/2)+this.options.offsetLeft,wrapperClass:c})},_getBottomPositioning:function(a,b){a=this._getOffsetInformation("height",a,b);b=Math.floor(a.elementWidth/2);var c="-bottom",d=-1*a.arrowSize,f=a.offset.top+a.elementHeight+this.options.edgeOffset+a.arrowSize;!this.options.forceDesiredPosition&&
f+a.wrapperHeight>=jq(window).scrollTop()+e(window).height()&&(c="-top",f=a.offset.top-this.options.edgeOffset-a.arrowSize-a.wrapperHeight,d=a.wrapperHeight);return e.extend(this._getCommonPositioningMap(),{newArrowTop:d,newArrowLeft:Math.floor(a.wrapperWidth/2)-a.arrowSize,newWrapperTop:f,newWrapperLeft:a.offset.left+b-Math.floor(a.wrapperWidth/2)+this.options.offsetLeft,wrapperClass:c})},_getLeftPositioning:function(a,b){a=this._getOffsetInformation("width",a,b);b=Math.floor(a.elementHeight/2);
var c=Math.floor(a.wrapperHeight/2),d="-left",f=a.wrapperWidth,g=a.offset.left-this.options.edgeOffset-a.arrowSize-a.wrapperWidth;!this.options.forceDesiredPosition&&0>=g&&(d="-right",g=a.offset.left+a.elementWidth+this.options.edgeOffset+a.arrowSize,f=-1*a.arrowSize);return e.extend(this._getCommonPositioningMap(),{newArrowTop:c-a.arrowSize,newArrowLeft:f,newWrapperTop:a.offset.top+b-c,newWrapperLeft:g,wrapperClass:d})},_getRightPositioning:function(a,b){a=this._getOffsetInformation("border-right-width",
a,b);b=Math.floor(a.elementHeight/2);var c=Math.floor(a.wrapperHeight/2),d="-right",f=-1*a.arrowSize,g=a.offset.left+a.elementWidth+this.options.edgeOffset+a.arrowSize;if(!this.options.forceDesiredPosition&&g+a.wrapperWidth>=e(window).width()){var h=a.offset.left-this.options.edgeOffset-a.arrowSize-a.wrapperWidth;0<=h&&(d="-left",g=h,f=a.wrapperWidth)}return e.extend(this._getCommonPositioningMap(),{newArrowTop:c-a.arrowSize,newArrowLeft:f,newWrapperTop:a.offset.top+b-c,newWrapperLeft:g,wrapperClass:d})},
_setStyleClasses:function(a,b,c){a.attr("class","");this._addStyleClasses(a,b,c);return this},_addStyleClasses:function(a,b,c){b&&(a.addClass(this.widgetBaseClass+b),c&&a.addClass(this.widgetBaseClass+b+c),this.options.baseClass&&(a.addClass(this.options.baseClass+b),c&&a.addClass(this.options.baseClass+b+c)));return this},_updateWrapperElement:function(a,b){this._addStyleClasses(b,"-wrapper",a.wrapperClass);b.attr("style","").css({top:a.newWrapperTop+"px",left:a.newWrapperLeft+"px"});e.browser.msie&&
"left"===this.options.position&&b.css("min-width",b.width()+"px");return this},_updateArrowElement:function(a,b){this._addStyleClasses(b,"-arrow",a.wrapperClass);b.css({top:a.newArrowTop+"px",left:a.newArrowLeft+"px"});return this},_updateContainerElement:function(a,b){this._addStyleClasses(b,"-container",a.wrapperClass);return this},_getIdValue:function(a){return this.widgetNamespace+this.options.subNameSpace+a},_open:function(a,b){var c=this;a.stop(!0,!0);var d=function(a){this.options.onOpen&&
this.options.onOpen.call(this,a);this.options.positionUpdate&&(this._positionUpdater=setInterval(e.proxy(this._updatePosition,this),1E3/60))};this.options.fadeIn?a.fadeIn(this.options.fadeIn,function(){d.call(c,b)}):(a.show(),d.call(c,b));return this},_close:function(){this._originalTitle&&(this.element.attr("title",this._originalTitle),this._originalTitle=null);this.options.onClose&&this.options.onClose.call(this,null);return this},_resetElements:function(a,b,c){this._setStyleClasses(a,"-wrapper");
this._setStyleClasses(b,"-container");this._setStyleClasses(c,"-arrow");return this}})})(jq||jQuery);(function(d){R9.extend("Widgets",{Slider:function(a,b){this.elementNode=a;this.element=d(this.elementNode);if(!this.validateElement())return this;this.options=d.extend({},this.options,b);this.init()}});R9.extend("Widgets.Slider.prototype",{elementNode:null,element:null,elementWidth:0,elementPositionLeft:0,activeRange:null,handles:[],activeHandle:null,activeHandleIndex:null,startValues:null,timelineDepPoints:null,timelineDepTimes:null,timelineArrTimes:null,timelineHours:null,timelinePrices:null,timelineLegSignatures:null,
timelineElements:null,timelineLabels:null,mouseMoveDelegate:d.noop,mouseUpDelegate:d.noop,options:{start:d.noop,stop:d.noop,slide:d.noop,min:0,max:100,step:1,values:[],range:!0,logarithmic:!1,snapToValue:!1},init:function(){var a=this.element.data("r9RangeSlider");null!=a&&(this.options.values=a.getValues());this.element.data("r9RangeSlider",this);var b=this;this.handles=this.element.children(".r9-rangeSlider-handle");this.activeRange=this.element.find(".r9-rangeSlider-activeRange");this.handles.off(".r9RangeSlider").on("mousedown.r9RangeSlider touchstart.r9RangeSlider",
function(a){b.mouseDown(a);a.preventDefault();a.stopPropagation(!0)});a=this.options.values;if(!a||1>a.length)a=this.options.range?[this.options.min,this.options.max]:[this.options.min];this.setValues(a);setTimeout(function(){b.drawActiveRange()},60)},validateElement:function(){return 0<this.element.length&&this.element.hasClass("r9-rangeSlider")},mouseDown:function(a){this.activeHandle=a.target;this.activeHandleIndex=null;this.elementWidth=this.element.outerWidth();this.elementPositionLeft=this.element.offset().left;
for(var b=0;b<this.handles.length;b++)this.activeHandle==this.handles[b]&&(this.activeHandleIndex=b);d(this.activeHandle).addClass("r9-rangeSlider-handle-active");var c=this;this.mouseMoveDelegate=function(a){c.mouseMove(a)};this.mouseUpDelegate=function(a){a.stopPropagation(!0);c.mouseUp(a)};d(document).bind("mousemove.r9RangeSlider touchmove.r9RangeSlider",this.mouseMoveDelegate).bind("mouseup.r9RangeSlider touchend.r9RangeSlider",this.mouseUpDelegate);this.startValues=[];for(b=0;b<this.options.values.length;b++)this.startValues[b]=
this.options.values[b];this.options.start(a,this.options.values)},mouseUp:function(a){d(this.activeHandle).removeClass("r9-rangeSlider-handle-active");this.activeHandleIndex=this.activeHandle=null;d(document).unbind("mousemove.r9RangeSlider touchmove.r9RangeSlider",this.mouseMoveDelegate).unbind("mouseup.r9RangeSlider touchend.r9RangeSlider",this.mouseUpDelegate);var b=!1;if(this.startValues)for(var c=0;c<this.options.values.length;c++){if(this.options.values[c]!=this.startValues[c]){b=!0;break}}else b=
!0;this.options.stop(a,this.options.values,b)},mouseMove:function(a){a.preventDefault();a.stopPropagation();var b=a.originalEvent;b.touches&&0<b.touches.length?a.pageX=b.touches[0].pageX:b.changedTouches&&0<b.changedTouches.length&&(a.pageX=b.changedTouches[0].pageX);b=this.valueForPosition(Math.min(this.elementWidth,Math.max(0,a.pageX-this.elementPositionLeft))/this.elementWidth,this.activeHandleIndex);d(this.activeHandle).css("left",100*this.positionForValue(b)+"%").css("z-index","3");for(var c=
0;c<this.handles.length;c++)this.handles[c]==this.activeHandle&&(this.options.values[c]=b);this.drawActiveRange();this.options.slide(a,this.options.values)},getValues:function(){return this.options.values.slice(0)},getValue:function(){return 0<this.options.values.length?this.options.values[0]:0},setValues:function(a){var b=this;this.options.values=[];for(var c=0;c<a.length;c++){var f=this.trimAlignValue(a[c]),e=100*this.positionForValue(f),g=2;1<a.length&&(0==c&&90<=e||c==a.length-1&&10>=e)&&(g=3);
this.options.values.push(f);d(this.handles[c]).css("left",e+"%").css("z-index",g)}setTimeout(function(){b.drawActiveRange()},60);this.drawActiveRange();this.options.slide(null,this.options.values)},setTimelinePoints:function(a,b,c,d,e,g){this.timelineDepPoints=a;this.timelineDepTimes=b;this.timelineArrTimes=c;this.timelineHours=d;this.timelinePrices=e;this.timelineLegSignatures=g;this.setTimelineValues()},setTimelineValues:function(){this.timelineElements=[];for(var a=0;a<this.timelineDepPoints.length;a++)this.setTimelinePoint(a);
this.setTimelineHours()},setTimelinePoint:function(a){var b=d("\x3cspan /\x3e").addClass("timelineValue"),c=d('\x3cdiv class\x3d"times"  /\x3e').text(this.timelineDepTimes[a]+" - "+this.timelineArrTimes[a]),f=d('\x3cdiv class\x3d"priceValue" /\x3e').text(this.timelinePrices[a]),e=d("\x3cdiv /\x3e");b.data("legSig",this.timelineLegSignatures[a]);e.append(c);e.append(f);a=100*this.positionForValue(this.timelineDepPoints[a]);this.element.append(b);b.css("left",a+"%");b.off("mouseover.r9Timeline").on("mouseover.r9Timeline",
function(){d(this).addClass("highlight")});b.off("mouseout.r9Timeline").on("mouseout.r9Timeline",function(){d(this).removeClass("highlight")});this.markFilteredOutTimeLinePoint(b);b.toolTip({delay:0,showImmediately:!1,extraClass:"timelinePoint",content:e});this.timelineElements.push(b)},markFilteredOutTimeLinePoint:function(a){if(a&&0!==a.length){var b=this.getPositionLeftValue(this.handles[0],0),c=this.getPositionLeftValue(this.handles[1],100),d=this.getPositionLeftValue(a,100);b>d||c<d?a.addClass("filteredOut"):
a.removeClass("filteredOut")}},markFilteredOutTimeLinePoints:function(){var a=this;this.timelineElements&&0!==this.timelineElements.length&&$.each(this.timelineElements,function(b,c){a.markFilteredOutTimeLinePoint(c)})},setTimelineHours:function(){for(var a=0,b=0;24>b;b++){var c=this.options.min+36E5*b;if(c>this.options.min&&c<this.options.max){var f=d("\x3cspan /\x3e").addClass("timelineHour").text(this.timelineHours[a]);this.element.append(f);c=100*this.positionForValue(c);f.css("left",c+"%");a++}}},
getPositionLeftValue:function(a,b){return a?parseFloat($(a)[0].style.left):b},formatHourLabel:function(a){var b=new Date(a);a=b.getUTCHours();10>a&&(a="0"+a);b=b.getUTCMinutes();10>b&&(b="0"+b);return a+":"+b},triggerStop:function(){this.options.stop({},this.options.values,!0)},setValue:function(a){var b=this.options.values.slice(0);b[0]=a;this.setValues(b)},getOption:function(a){return this.options[a]},setOption:function(a,b){if("object"==typeof a)for(a in b=a,b)b.hasOwnProperty(a)&&(this.options[a]=
b[a]);else this.options[a]=b;this.setValues(this.options.values)},positionForValue:function(a){if(this.options.logarithmic){var b=Math.log(this.options.min);a=(Math.log(a)-b)/((Math.log(this.options.max)-b)/1)}else a=(a-this.options.min)/(this.options.max-this.options.min);return a.toFixed(5)},valueForPosition:function(a,b){if(this.options.logarithmic&&1!==a){var c=Math.log(this.options.min);a=Math.exp(c+(Math.log(this.options.max)-c)*a)}else a=this.options.min+(this.options.max-this.options.min)*
a;a=this.trimAlignValue(a);0<b&&(a=Math.max(a,this.options.values[b-1]));b+1<this.handles.length&&(a=Math.min(a,this.options.values[b+1]));return a},drawActiveRange:function(){var a=!1,b=0,c=d(this.handles[this.handles.length-1]).css("left");this.options.range&&(b=d(this.handles[0]).css("left"));if(c&&0<=c.indexOf("%")||b&&0<=b.indexOf("%"))a=!0;c=(c=parseInt(c)-parseInt(b))||0;d(this.activeRange).css({left:b,width:c+(a?"%":"")});this.markFilteredOutTimeLinePoints()},trimAlignValue:function(a){if(a<=
this.options.min)return this.options.min;if(a>=this.options.max)return this.options.max;var b;b=this.options.snapToValue?Math.ceil(Math.pow(10,Math.floor(Math.log(a)/Math.log(10))-1)):0<this.options.step?this.options.step:1;var c=a%b;a-=c;2*Math.abs(c)>=b&&(a+=0<c?b:-b);a=parseFloat(a.toFixed(5));a=Math.min(a,this.options.max);return a=Math.max(a,this.options.min)}})})(jq||jQuery);(function(b){R9.extend("Widgets",{NumberBox:function(a,c){this.inputNode=b(a).find("input")[0];this.jqNode=b(a);if(!this.isValidElement())return this;this.options=b.extend({},this.options,c);this.init()}});R9.extend("Widgets.NumberBox.prototype",{widgetName:"r9NumberBox",inputNode:null,jqNode:null,options:{min:0,max:6,defaultValue:0,callback:b.noop,validator:null},boxValue:0,incrButton:null,decrButton:null,isValidElement:function(){return this.jqNode&&this.jqNode.children().hasClass("incrementor")&&
this.jqNode.children().hasClass("decrementor")&&this.jqNode.children().hasClass("numberHolder")},canChange:function(a){return"function"===typeof this.options.validator?this.options.validator.call(this,a,this.boxValue):!0},increment:function(){if(this.boxValue<this.options.max&&this.canChange(1))return this.boxValue+=1,this.updateView(),this.options.callback.call(this,1,this.boxValue),!0;this.incrButton.addClass("NumberBox-disabled").attr("disabled","disabled");return!1},decrement:function(){if(this.boxValue>
this.options.min&&this.canChange(-1))return--this.boxValue,this.updateView(),this.options.callback.call(this,-1,this.boxValue),!0;this.decrButton.addClass("NumberBox-disabled").attr("disabled","disabled");return!1},updateView:function(){b(this.inputNode).val(this.boxValue);b(this.inputNode).trigger("change");this.boxValue==this.options.max?this.incrButton.addClass("NumberBox-disabled").attr("disabled","disabled"):this.boxValue==this.options.min?this.decrButton.addClass("NumberBox-disabled").attr("disabled",
"disabled"):(this.incrButton.removeClass("NumberBox-disabled").removeAttr("disabled"),this.decrButton.removeClass("NumberBox-disabled").removeAttr("disabled"))},getValue:function(){return this.boxValue},setValue:function(a,b){a=parseInt(a);if(isNaN(a)||this.boxValue===a)return!1;var c=a-this.boxValue;if(!b&&!this.canChange(c))return!1;this.boxValue=a;this.updateView();this.options.callback&&this.options.callback.call(this,c);return!0},init:function(){this.boxValue=""!=this.inputNode.value?parseInt(this.inputNode.value,
10):0;this.incrButton=this.jqNode.find(".incrementor");this.decrButton=this.jqNode.find(".decrementor");this.jqNode.data(this.widgetName,this);0<this.options.defaultValue?this.setValue(this.options.defaultValue):!isNaN(this.options.max)&&this.boxValue>this.options.max&&(this.boxValue=this.options.max);b(this.inputNode).prop("readonly","readonly");this.inputNode.value=this.boxValue;var a=this;this.incrButton.unbind("click").click(function(b){a.increment();jq(a.jqNode).trigger("increment");return!1});
this.decrButton.unbind("click").click(function(b){a.decrement();jq(a.jqNode).trigger("decrement");return!1})}})})(jq||jQuery);(function(b){R9.extend("Widgets",{Checkbox:function(a,c){this.elementNode=a;this.element=b(this.elementNode);this.icon=b(R9.Widgets.Checkbox.findIconNode(this.elementNode));this.validateElement()&&(this.options=b.extend({},this.options,c),this.init())}});R9.extend("Widgets.Checkbox",{isCheckbox:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()&&"checkbox"==a.type.toLowerCase()},isWidgetControlled:function(a){return b(a).hasClass(R9.Widgets.Checkbox.prototype.widgetBaseClass+"-input")},
refresh:function(a,c){c=b(c);c[a.checked?"addClass":"removeClass"](R9.Widgets.Checkbox.prototype.widgetBaseClass+"-icon-checked");c[a.disabled?"addClass":"removeClass"](R9.Widgets.Checkbox.prototype.widgetBaseClass+"-icon-disabled")},findIconNode:function(a){return b(a).closest("[id$\x3d'-icon']")},findElementNode:function(a){return document.getElementById(a.id.substring(0,a.id.lastIndexOf("-icon")))}});R9.extend("Widgets.Checkbox.prototype",{widgetName:"checkbox",widgetBaseClass:"r9-checkbox",elementNode:null,
element:null,icon:null,options:{click:null,change:null},init:function(){this.bindInputClickEvent();this.bindInputEvent("change",this.handleElementChangeEvent);this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.element.data(this.widgetName,this)},validateElement:function(){return R9.Widgets.Checkbox.isCheckbox(this.elementNode)&&R9.Widgets.Checkbox.isWidgetControlled(this.elementNode)},bindInputEvent:function(a,c){var b=this;a+="."+
this.widgetName;this.element.unbind(a).bind(a,function(a){c.call(b,this,R9.Widgets.Checkbox.findIconNode(this),a)})},bindInputClickEvent:function(){b.support.changeBubbles||"undefined"==typeof b._data(this.elementNode,"_change_data")&&b._data(this.elementNode,"_change_data",this.elementNode.checked);this.bindInputEvent("click",this.handleElementClickEvent)},handleElementClickEvent:function(a,c,d){this.options.click&&this.options.click.apply(this,arguments);b.support.changeBubbles||b._data(a,"_change_data")==
a.checked&&b(a).trigger("change")},handleElementChangeEvent:function(a,b,d){this.handleJQueryOnChangeHookForIE(a,b,d)||(R9.Widgets.Checkbox.refresh(a,b),this.options.change&&this.options.change.apply(this,arguments))},handleElementFocusEvent:function(a,c,d){a.disabled||(b(c).addClass(this.widgetBaseClass+"-state-focus"),this.options.focus&&this.options.focus.apply(this,arguments))},handleElementBlurEvent:function(a,c,d){a.disabled||(b(c).removeClass(this.widgetBaseClass+"-state-focus"),this.options.blur&&
this.options.blur.apply(this,arguments))},handleJQueryOnChangeHookForIE:function(a,c,d){if(!b.support.changeBubbles&&"object"==typeof d){var e=d.originalEvent||null;if(e&&null!=e.type&&(e.type.match(/(^|\.)click(\.|$)/)&&e.srcElement==c||"beforeactivate"==e.type||"beforedeactivate"==e.type))return d.type=e.type,b(a).trigger(d),!0}return!1}})})(jq||jQuery);(function(d){R9.extend("Widgets",{CheckboxGroup:function(a,b){this.elementNode=a;this.element=d(this.elementNode);this.icon=null;this.validateElement()&&(this.options=d.extend({},this.options,b),this.init())}});R9.extend("Widgets.CheckboxGroup.prototype",!0,R9.Widgets.Checkbox.prototype,{widgetName:"checkboxGroup",options:{inputSelector:'input[type\x3d"checkbox"]',labelSelector:"label.r9-checkbox-label",iconSelector:"a."+R9.Widgets.Checkbox.prototype.widgetBaseClass+"-icon"},init:function(){this.bindInputEvent("click",
this.handleElementClickEvent);this.bindInputEvent("change",this.handleElementChangeEvent);this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.bindInputEvent("mousedown",this.handleElementMouseDownEvent);this.bindLabelEvent("mousedown",this.handleElementMouseDownEvent);this.element.data(this.widgetName,this)},validateElement:function(){return void 0===this.element.data(this.widgetName)},bindInputEvent:function(a,b){var c=this;a+="."+
this.widgetName+"Input";this.element.undelegate(this.options.inputSelector,a).delegate(this.options.inputSelector,a,function(a){b.call(c,this,R9.Widgets.Checkbox.findIconNode(this),a)})},bindLabelEvent:function(a,b){var c=this;a+="."+this.widgetName+"Label";this.element.undelegate(this.options.labelSelector,a).delegate(this.options.labelSelector,a,function(a){var e=d("#"+d(this).attr("for")).get(0);b.call(c,e,a)})},handleElementClickEvent:function(a,b,c){this.options.click&&this.options.click.apply(this,
arguments)},handleElementMouseDownEvent:function(a,b,c){this.options.mousedown&&this.options.mousedown.apply(this,arguments)},handleJQueryOnChangeHookForIE:function(a,b,c){d.support.changeBubbles||"object"!=typeof c||(b=c.originalEvent||null)&&null!=b.type&&(b.type.match(/(^|\.)click(\.|$)/)||"beforeactivate"==b.type||"beforedeactivate"==b.type)&&(c.type=b.type,this.trigger(a,c));return!1},trigger:function(a,b){"object"==typeof b&&(b.liveFired=void 0);d(a).trigger(b)}})})(jq||jQuery);(function(b){R9.extend("Widgets",{TextInput:function(a,c){this.elementNode=a;this.element=b(this.elementNode);this.validateElement()&&(this.options=b.extend({},this.options,c),this.init())}});R9.extend("Widgets.TextInput",{isTextInput:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()&&"text"==a.type.toLowerCase()},isWidgetControlled:function(a){return"undefined"==typeof document.createElement("input").placeholder}});R9.extend("Widgets.TextInput.prototype",{widgetName:"textinput",
widgetBaseClass:"r9-textinput",widgetPlaceholderClass:"r9-textinput-placeholder-active",elementNode:null,element:null,options:{click:null,change:null},init:function(){this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("smartyfocus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.bindFormSubmission();this.element.data(this.widgetName,this);this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode)},validateElement:function(){return R9.Widgets.TextInput.isTextInput(this.elementNode)&&
R9.Widgets.TextInput.isWidgetControlled(this.elementNode)&&void 0===this.element.data(this.widgetName)},bindInputEvent:function(a,b){var c=this;a+="."+this.widgetName;this.element.unbind(a).bind(a,function(a){b.call(c,this,a)})},bindFormSubmission:function(){var a=this,b="submit."+a.widgetName+a.element.attr("id"),d="form-pre-submit."+a.widgetName+a.element.attr("id");this.element.parents("form").off(b).on(b,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)});
this.element.parents("form").off(d).on(d,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)})},handleElementFocusEvent:function(a,c){a.disabled||(b(a).val()==b(a).attr("placeholder")&&this.clearPlaceholderText(b(a)),this.options.focus&&this.options.focus.apply(this,arguments))},handleElementBlurEvent:function(a,c){a.disabled||(0==b.trim(b(a).val()).length&&this.setPlaceholderText(a),this.options.blur&&this.options.blur.apply(this,arguments))},clearPlaceholderText:function(a){a.removeClass(this.widgetPlaceholderClass).val("")},
setPlaceholderText:function(a){b(a).addClass(this.widgetPlaceholderClass).val(b(a).attr("placeholder"))}})})(jq||jQuery);(function(b){R9.extend("Widgets",{DropdownDialog:function(a,c){this.elementNode=a;this.element=b(this.elementNode);this.options=b.extend({},this.options,c);this.init()}});R9.extend("Widgets.DropdownDialog.prototype",{element:null,elementNode:null,content:null,trigger:null,placeholder:null,label:null,icon:null,isOpen:!1,widgetName:"dropdownDialog",widgetBaseClass:"r9-dropdownDialog",options:{autoOpen:!1,iconClass:"",showIcon:!0,contentClass:"",wrapperClass:"",triggerClass:"",content:null,onInit:null,
onOpen:null,onClose:null,text:"",placeholder:""},init:function(){this.element.data(this.widgetName,this);this.createWrapper();this.createTrigger();this.createContent();this.bindEvents();this.options.autoOpen&&this.toggleContent(!0);if(this.options.onInit)this.options.onInit(this)},bindEvents:function(){var a=this;b("body").on("click",function(c){c=b(c.target).closest("."+a.widgetBaseClass+"-wrapper");a.element[0]!=c[0]&&a.isOpen&&a.close()});b(a.trigger).click(function(b){a.toggleContent()})},createWrapper:function(){this.element.addClass(this.widgetBaseClass+
"-wrapper "+this.options.wrapperClass);this.element.hasClass(this.widgetBaseClass+"-open")&&(this.isOpen=!0)},createContent:function(){var a=this.element.find("."+this.widgetBaseClass+"-content");this.content=a.length?a:b("\x3cdiv\x3e",{"class":this.widgetBaseClass+"-content"});this.options.content&&b(this.options.content).appendTo(this.content);a.length||this.element.append(this.content)},createTrigger:function(){var a=this.element.find("."+this.widgetBaseClass+"-trigger");this.trigger=a.length?
a:b("\x3ca\x3e",{"class":this.widgetBaseClass+"-trigger "+this.options.triggerClass});this.label=this.trigger.find("."+this.widgetBaseClass+"-label");this.label.length||(this.label=b("\x3cspan\x3e",{"class":this.widgetBaseClass+"-label"}),this.trigger.prepend(this.label));this.placeholder=this.trigger.find("."+this.widgetBaseClass+"-placeholder");this.placeholder.length||(this.placeholder=b("\x3cspan\x3e",{"class":this.widgetBaseClass+"-placeholder",text:this.options.placeholder}),this.trigger.append(this.placeholder));
this.options.showIcon&&(this.icon=this.trigger.find("."+this.widgetBaseClass+"-icon"),this.icon.length||(this.icon=b("\x3cspan\x3e",{"class":this.widgetBaseClass+"-icon "+this.options.iconClass}),this.trigger.append(this.icon)));this.options.text?this.updateLabel(this.options.text):this.label.text()&&this.updateLabel(this.label.text());a.length||this.element.append(this.trigger)},open:function(){this.isOpen=!0;this.element.addClass(this.widgetBaseClass+"-open");if(this.options.onOpen)this.options.onOpen(this)},
close:function(){var a=this.isOpen;this.isOpen=!1;this.element.removeClass(this.widgetBaseClass+"-open");if(this.options.onClose)this.options.onClose(a,this)},toggleContent:function(a){1==a?this.open():0==a?this.close():this.isOpen?this.close():this.open()},updateLabel:function(a){this.label.html(a);"0"==a+""||a?this.trigger.addClass(this.widgetBaseClass+"-hasValue"):this.trigger.removeClass(this.widgetBaseClass+"-hasValue")},hasValue:function(){return this.trigger.hasClass(this.widgetBaseClass+"-hasValue")}})})(jq||
jQuery);(function(a){R9.extend("Widgets",{Dialog:function(b,c){if(b.constructor===Array)for(var d=0;d<b.length;d++){if(b[d].tagName&&"DIV"===b[d].tagName){this.elementNode=b[d];break}}else this.elementNode=b;this.element=a(this.elementNode);this.options=a.extend({},this.options,c);this.init();return this}});R9.extend("Widgets.Dialog.prototype",{element:null,elementNode:null,positionUpdater:null,dialogWrapper:null,closeButton:null,buttonSetWrapper:null,buttonSet:null,viewPort:null,contentContainer:null,modalLayer:null,
widgetName:"dialog",widgetBaseClass:"r9-dialog",spinnerClass:"r9-spinner",popoverBaseClass:"r9-popover",arrow:null,offsets:{right:{x:"right",y:null,height:-36,width:24},left:{x:"left",y:null,height:-36,width:-24},top:{x:null,y:"top",height:-24,width:null},bottom:{x:null,y:"bottom",height:24,width:null}},title:null,header:null,isTouchDevice:!1,options:{id:null,title:null,defaultPadding:!1,buttons:[],modal:!0,allowMultipleDialogs:!1,modalOpacity:null,wrapperClass:"",modalBackgroundClass:"",closeButtonClass:"",
viewPortClass:"",contentClass:"",titleClass:"",minWidth:275,maxWidth:null,minHeight:100,spinner:!1,open:null,display:function(){this.viewPort.show()},opened:null,close:null,beforeClose:null,removeOnClose:!0,useMaxHeight:!1,allowUserScroll:!1,closeOnEscape:!0,closeOnModalClick:!0,position:null,direction:"right",top:null,centerModal:!0,adjustToScreenHeight:!1,referencePoint:null},init:function(){if(!this.options.allowMultipleDialogs&&a(document).data(this.widgetName)){var b=a(document).data(this.widgetName);
"function"===typeof b.close?a(document).data(this.widgetName).close():b.hide()}this.element.data(this.widgetName,this);a(document).data(this.widgetName,this);null!=this.options.referencePoint&&a(document).data(this.widgetName+"-"+this.options.referencePoint,this);this.isTouchDevice=R9.ui.isTouchDevice();this.options.modal?this.createDialogWrapper().hideDocumentScrollBar().createModalLayer():a.isNumeric(this.options.modalOpacity)&&this.createDialogWrapper().createModalLayer();this.createViewPort().createHeader().createContentContainer().createButtonWrapper().createButtons();
this.options.position&&this.createArrow();this.options.allowUserScroll&&this.scrollingDialog();this.build().calculateViewPortWidth().position().bindEvents().open()},build:function(){(this.options.modal||a.isNumeric(this.options.modalOpacity))&&this.dialogWrapper.append(this.modalLayer);this.options.position&&this.viewPort.append(this.arrow);this.header.append(this.title);this.header.append(this.closeButton);this.viewPort.append(this.header);this.contentContainer.append(this.element);this.viewPort.append(this.contentContainer);
this.options.buttons.length&&(this.buttonSetWrapper.append(this.buttonSet),this.viewPort.append(this.buttonSetWrapper));this.options.modal||a.isNumeric(this.options.modalOpacity)?a("body").append(this.dialogWrapper.append(this.viewPort.hide())):a("body").append(this.viewPort.hide());return this},bindEvents:function(){var b=this;if(this.options.modal||a.isNumeric(this.options.modalOpacity))this.modalLayer.on("click",function(){b.options.closeOnModalClick&&b.close()});this.closeButton.on("click",function(){b.close()});
this.positionUpdater=setInterval(function(){b.windowResize()},1E3/60);a(window).on("resize",a.proxy(this.eventWindowResize,b));return this},windowResize:function(a){this.calculateViewPortWidth();this.position()},open:function(){this.options.open&&this.options.open.call(this);this.options.display.call(this);if(this.options.closeOnEscape){var b=this,c=function(d){27===d.keyCode&&(a(document).unbind("keyup",c),b.close())};a(document).bind("keyup",c)}this.options.opened&&this.options.opened.call(this)},
beforeClose:function(){},close:function(){this.options.beforeClose&&this.options.beforeClose.call(this);this.options.removeOnClose?(this.dialogWrapper&&(this.dialogWrapper.remove(),this.dialogWrapper=null),this.viewPort&&(this.viewPort.remove(),this.viewPort=null)):this.reset();clearInterval(this.positionUpdater);a(window).off("resize",this.eventWindowResize);this.showDocumentScrollbar();this.options.close&&this.options.close.call(this);a(document).data(this.widgetName)&&a(document).removeData(this.widgetName)},
eventWindowResize:function(){this.windowResize()},reset:function(){var b;a(":focus").blur();this.options.modal||a.isNumeric(this.options.modalOpacity)?(b=a(this.element).closest(".r9-dialog-wrapper"),a(b).find(".r9-dialog-modalBackground").remove()):b=a(this.element).closest(".r9-dialog-viewPort");a(b).find(".r9-dialog-header").remove();a(b).find("[class^\x3d'r9-dialog-']").unwrap();a(this.element).unwrap();this.dialogWrapper&&(this.dialogWrapper=null)},createDialogWrapper:function(){this.dialogWrapper=
a(document.createElement("div")).addClass(this.widgetBaseClass+"-wrapper "+this.options.wrapperClass);this.dialogWrapper=a.extend(this.dialogWrapper,this);return this},createModalLayer:function(){this.modalLayer=a(document.createElement("div")).addClass(this.widgetBaseClass+"-modalBackground "+this.options.modalBackgroundClass);null!=this.options.modalOpacity&&(void 0!==a.browser&&a.browser.msie?this.modalLayer.css("filter","alpha(opacity\x3d"+100*this.options.modalOpacity+")"):this.modalLayer.css({background:"rgba(0,0,0,"+
(1-this.options.modalOpacity)+")"}));return this},createViewPort:function(){this.viewPort=a(document.createElement("div")).addClass(this.widgetBaseClass+"-viewPort "+(this.options.spinner?this.spinnerClass:"")+" "+(this.options.defaultPadding?this.widgetBaseClass+"-defaultPadding ":"")+this.options.viewPortClass);this.options.id&&this.viewPort.attr("id","dialog"+this.options.id);return this},removeSpinner:function(){this.viewPort&&this.viewPort.removeClass(this.spinnerClass)},createButtonWrapper:function(){this.buttonSetWrapper=
a(document.createElement("div")).addClass(this.widgetBaseClass+"-buttonwrapper");this.buttonSet=a(document.createElement("div")).addClass(this.widgetBaseClass+"-buttonset");return this},createButtons:function(){var b=this,c=this.options.buttons;this.buttonSetWrapper.remove();this.buttonSet.empty();if(a.isEmptyObject(c)||a.isArray(c)&&!c.length)this.viewPort.removeClass(this.widgetBaseClass+"-buttons");else return a.each(c,function(c,e){var d;e=a.isFunction(e)?{click:e,text:c}:e;e=a.extend({type:"button",
"class":"ui-button"},e);d=e.click;e.click=function(){d.apply(b,arguments)};c=e.text;delete e.text;a("\x3cbutton\x3e\x3c/button\x3e",e).append(a("\x3cspan\x3e\x3c/span\x3e").text(c)).appendTo(b.buttonSet)}),this.viewPort.addClass(this.widgetBaseClass+"-buttons"),this},createArrow:function(){this.arrow=a(document.createElement("div")).addClass(this.popoverBaseClass+"-arrow");this.viewPort.addClass(this.popoverBaseClass+"-viewPort "+this.popoverBaseClass+"-"+this.options.direction);return this},createHeader:function(){this.header=
a(document.createElement("div")).addClass(this.widgetBaseClass+"-header");this.closeButton=a(document.createElement("div")).addClass(this.widgetBaseClass+"-closeButton r9-icon-x").addClass(this.options.closeButtonClass);a(this.element).attr("title")&&!this.options.title&&(this.options.title=a(this.element).attr("title"));this.options.title&&this.createTitle();return this},createTitle:function(){this.title=a(document.createElement("div")).addClass(this.widgetBaseClass+"-title "+this.options.titleClass).text(this.options.title)},
createContentContainer:function(){this.contentContainer=a(document.createElement("div")).addClass(this.widgetBaseClass+"-content "+this.options.contentClass).attr("id","dialogContent"+this.options.id);return this},hideDocumentScrollBar:function(){a("body,html").addClass(0<getScrollbarSize()?"defaultScrollbar":"zeroScrollbar");return this},showDocumentScrollbar:function(){a("body,html").removeClass(0<getScrollbarSize()?"defaultScrollbar":"zeroScrollbar")},position:function(){if(!this.options.modal&&
this.options.position)this.viewPort.css(this.calculateOffsetCss(a(this.options.position)));else{var b=parseInt(this.options.width)>a(window).width(),c={};this.options.centerModal&&(c.left="50%",c.marginLeft=-(parseInt(this.options.width)/2));c.minHeight="function"===typeof this.options.minHeight?this.options.minHeight():this.options.minHeight;c.minWidth="function"===typeof this.options.minWidth?this.options.minWidth():this.options.minWidth;this.options.useMaxHeight?(c.height="100%",c.top=0):(this.options.top&&
(c.top=this.options.top),this.options.height&&this.viewPort.height(this.options.height));b&&a.extend(c,{left:"",marginLeft:"",top:""});this.viewPort.css(c)}return this},calculateViewPortWidth:function(){var b=this.element.width();this.options.width?b=parseInt(this.options.width)<=a(window).width()?this.options.width:"":(0!==b&&(b+=parseInt(this.element.css("padding-left"),10)+parseInt(this.element.css("padding-right"),10)+parseInt(this.element.css("margin-left"),10)+parseInt(this.element.css("margin-right"),
10)+parseInt(this.element.css("borderLeftWidth"),10)+parseInt(this.element.css("borderRightWidth"),10)),this.options.maxWidth&&b>this.options.maxWidth&&(b=this.options.maxWidth),this.options.minWidth&&b<this.options.minWidth&&(b=this.options.minWidth),this.options.width=b);this.viewPort.css("width",b);return this},calculateOffsetCss:function(b){var c=this.getScrollTop(),d=this.getScrollLeft(),e=b.width(),f=b.height();b=b.get(0).getBoundingClientRect();var g=this.offsets[this.options.direction],e=
(g.x?b[g.x]:b.right-e/2)+(g.width?g.width:-(this.options.minWidth/2)),f=(g.y?b[g.y]:b.bottom-f/2)+g.height;"left"===this.options.direction&&(e-=this.options.minWidth);"top"===this.options.direction&&(f-=this.options.minHeight);this.dialogWrapper||(f+=c,e+=d);this.options.adjustToScreenHeight&&(c+=a(window).height(),d=f+this.viewPort.height(),c<d&&(c=d-c+5,f-=c,this.arrow.css("top",c+18+"px")));return{left:e,top:f}},getScrollTop:function(){if("undefined"!==typeof pageYOffset)return pageYOffset;var a=
document.body,c=document.documentElement,c=c.clientHeight?c:a;return c.scrollTop},getScrollLeft:function(){if("undefined"!==typeof pageXOffset)return pageXOffset;var a=document.body,c=document.documentElement,c=c.clientWidth?c:a;return c.scrollLeft},setTitle:function(a){a&&(this.title?this.title.html(a):(this.options.title=a,this.createTitle()))},scrollingDialog:function(){this.options.modal&&this.showDocumentScrollbar();this.dialogWrapper.addClass("fixed-position");var b=this.viewPort,c=window,d=
this.options.height?this.options.height:b.outerHeight(!0),e=this.options.width?this.options.width:b.outerWidth(!0);null!==this.options.position?(d=this.calculateOffsetCss(a(this.options.position)),b.css({position:"absolute",top:d.top+a(c).scrollTop()+"px",left:d.left+a(c).scrollLeft()+"px",margin:0})):b.css({position:"absolute",top:(a(c).height()-d)/2+a(c).scrollTop()+"px",left:(a(c).width()-e)/2+a(c).scrollLeft()+"px",margin:0})}})})(jq||jQuery);(function(b){b.fn.newDialog=function(a){return(new R9.Widgets.Dialog(this.get(),a)).element};b.fn.newDropdownDialog=function(a){return(new R9.Widgets.DropdownDialog(this.get(),a)).element}})(jq||jQuery);(function(e){R9.extend("Widgets.Smarty",{Smarty:function(a,b){this.elementNode=a;this.element=e(this.elementNode);this.validateElement()&&(this.options=e.extend({},this.options,b),this.init())}});R9.extend("Widgets.Smarty.Smarty",{isInput:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()},isWidgetControlled:function(a){return e(a).hasClass(R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass+"-input")},getDropdownEl:function(a){return jq(a).find("#smartbox")},getDropdownId:function(a){return"smartbox"}});
R9.extend("Widgets.Smarty.Smarty.prototype",{widgetName:"smarty",widgetBaseClass:"r9-smarty",elementNode:null,element:null,dropdown:null,lastValue:null,lastClickOnScrollbar:!1,keyTimeout:null,isItemSet:!1,backgroundAutocomplete:null,options:{minLength:0,appendTo:"body",initialData:null,searchOnFocus:!1,showDropdownWhenEmpty:!1,dataSource:null,dataType:"text",minWidth:10,maxWidth:1024,noAutoWidth:!1,position:"left",dropdownClass:null,setItem:null,beforeStart:null,afterDone:null,dropdownListSelector:"ul li[class!\x3d'separator']",
keyDelay:200,forceSelection:!1,makeHTML:null,translateItem:null,display:"inline",showBackgroundAutocomplete:!1,backgroundAutocompleteMinLength:3,getBackgroundAutocompletePositionProps:null},init:function(){var a=this;this.initDropdown();R9.globals.browserCapabilities.scrollbarRetainsInputFocus||this.trackScrollbarClick();this.bindInputEvent("focus",this.handleInputFocusEvent);this.bindInputEvent("blur",this.handleInputBlurEvent);this.bindInputEvent("keydown",this.handleInputKeydownEvent);this.bindInputEvent("textchange",
this.handleInputChangeEvent);e(window).on("scroll.smarty",function(){a.position()});e(window).resize(this.handleWindowResize.bind(a));this.element.attr({autocomplete:"off",autocapitalize:"off",autocorrect:"off"});this.element.data(this.widgetName,this);this.element.is(":focus")&&this.element.focus();this.initBackgroundAutocomplete()},unInit:function(){this.unbindInputEvent("focus");this.unbindInputEvent("blur");this.unbindInputEvent("keydown");this.unbindInputEvent("textchange");e(window).off("scroll.smarty");
this.dropdown.off("mousedown.trackScrollbarClick");jq("body").off("click.trackScrollbarClick")},initDropdown:function(){var a=R9.Widgets.Smarty.Smarty.getDropdownEl(this.element),b=R9.Widgets.Smarty.Smarty.getDropdownId(this.element),a=jq(a)[0];if(null==a){var c=R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass;this.options.dropdownClass&&(c=c+" "+this.options.dropdownClass);a=jq("\x3cdiv\x3e\x3c/div\x3e",{id:b,css:{display:"none",position:"absolute",width:"auto",zIndex:1E4}}).appendTo(this.options.appendTo)[0];
jq(a).addClass(c)}this.dropdown=jq(a)},validateElement:function(){return R9.Widgets.Smarty.Smarty.isInput(this.elementNode)&&R9.Widgets.Smarty.Smarty.isWidgetControlled(this.element)},trackScrollbarClick:function(){var a=this;a.dropdown.on("mousedown.trackScrollbarClick",function(b){a.lastClickOnScrollbar=!0;b.stopPropagation();jq("body").trigger("event",[b])});jq("body").on("click.trackScrollbarClick",function(b){R9.Common.Utils.Browsers.isIE()&&a.lastClickOnScrollbar&&(a.lastClickOnScrollbar=!1,
a.element.blur());a.lastClickOnScrollbar=!1})},bindInputEvent:function(a,b){var c=this;a+="."+this.widgetName;this.element.off(a).on(a,function(a){return b.call(c,this,a)})},unbindInputEvent:function(a){a+="."+this.widgetName;this.element.off(a)},bindDropdownEvent:function(a,b){var c=this;this.dropdown.off(a,this.options.dropdownListSelector).on(a,this.options.dropdownListSelector,function(a){b.call(c,this,a)})},handleInputKeydownEvent:function(a,b){this.focusEventHandled=!1;var c=b.keyCode?b.keyCode:
b.which;switch(c){case 38:return this.highlitePrevItem(),!1;case 40:return this.highliteNextItem(),!1;case 27:return!this.hideDropdown();case 13:return this.selectHighlightedItemWhenSearchCompleted(c);case 9:this.selectHighlitedItem(c);break;default:this.handleKeydownBeforeAutocomplete(a,b),this.abortSearchCompletedEventListeners()}},handleInputChangeEvent:function(a,b){if(this.focusEventHandled)this.focusEventHandled=!1;else if(!R9.Common.Utils.Browsers.isIE(10)&&!R9.Common.Utils.Browsers.isIE(11)||
this.element.is(":focus")){this.abortKeyTimeout();this.abortRequest();this.onInputChange();var c=this;this.keyTimeout=setTimeout(function(){c.keyTimeout=null;c.handleInputValue()},this.options.keyDelay)}},onInputChange:function(){this.isItemSet=!1;var a=this.getHighlitedItem();a&&!this.itemMatches(a,this.element.val())&&this.removeItemHighlite();"function"===typeof this.options.clearItem&&this.options.clearItem(this);try{this.element&&(jq(this.element).removeClass("smarty-complete"),jq(this.element).removeClass("four-twenty"),
jq(this.element).addClass("smarty-incomplete"),R9.events.publish("smarty.setitem.incomplete",{id:this.element.attr("id")}))}catch(b){}},handleInputValue:function(){this.options.showDropdownWhenEmpty||this.element.length&&0<this.element.val().length?(this.abortRequest(),this.runSearch(!0)):this.hideDropdown()},handleInputFocusEvent:function(a,b){jq(a).trigger("smartyfocus");var c=this;if(!c.lastClickOnScrollbar){var d=function(){c.checkAlive()&&setTimeout(d,250)};setTimeout(d,250);this.onBeforeStart();
this.runSearchOnFocus()&&(this.focusEventHandled=!0,0!=this.element.val().length||this.runNoQuerySearch()?this.runSearch(!1):this.showInitialDropdown())}},runSearchOnFocus:function(){return this.options.searchOnFocus},runNoQuerySearch:function(){return this.options.searchNoQuery},onBeforeStart:function(){"function"===typeof this.options.beforeStart&&this.options.beforeStart(this)},handleInputBlurEvent:function(a,b){this.focusEventHandled=!1;var c=this;setTimeout(function(){if(c.lastClickOnScrollbar)R9.Common.Utils.Browsers.isIE()||
(c.element.focus(),c.lastClickOnScrollbar=!1);else{c.stopInputProcessing();if(c.hideDropdown()&&c.options.forceSelection)c.onForceSelection();c.onAfterDone()}},10)},stopInputProcessing:function(){this.isUpdateInProgress()&&(this.abortKeyTimeout(),this.abortRequest(),this.removeItemHighlite())},isUpdateInProgress:function(){return this.keyTimeout||this.request},onForceSelection:function(){if(!this.itemSet){var a=this.getHighlitedItem();a&&this.selectItem(a,null)}},onAfterDone:function(){"function"===
typeof this.options.afterDone&&this.options.afterDone(this)},handleItemMouseoverEvent:function(a,b){this.getItemList().removeClass("selected");jq(a).addClass("selected")},handleItemMouseoutEvent:function(a,b){jq(a).removeClass("selected")},handleItemMousedownEvent:function(a,b){b.stopPropagation();jq("body").trigger("event",[b]);this.selectItem(a,null);this.hideDropdown()},selectHighlitedItem:function(a){var b=this.getItemList();if(b){var c=this.getHighlitedItemIndex();0>c?13==a&&this.noItemToSelect():
(b=b[c])&&this.selectItem(b,a)}else 13==a&&this.noItemToSelect()},selectHighlightedItemWhenSearchCompleted:function(a){var b=this;if(this.isItemSet)return!0;this.selectHighlitedItem(a);this.hideDropdown(!0);this.element.one("searchCompleted",function(){b.selectHighlitedItem(a);b.hideDropdown()});return!1},noItemToSelect:function(){},selectItem:function(a,b){a=this.translateItem(a);this.setItem(a,b)},translateItem:function(a){return"function"===typeof this.options.translateItem?this.options.translateItem(a):
a},setItem:function(a,b){if(this.element)try{if(a){jq(this.element).addClass("smarty-complete");jq(this.element).removeClass("smarty-incomplete");jq(this.element).removeClass("four-twenty");if(R9.config.getBoolean("ui.four-twenty.enabled",!1)&&"string"===typeof a.str){var c=!1,d=R9.config.getString("ui.four-twenty.states","").split(";"),f=a.str.match(/^[^,]+,\s+([A-Z]{2})(\s|$)/);(f=f?f[1]:null)&&-1!==d.indexOf(f)&&(c=!0);for(var e=R9.config.getString("ui.four-twenty.cities","").split(";"),d=0;d<
e.length;d++)""!==e[d]&&-1!==a.str.indexOf(e[d])&&(c=!0);c&&jq(this.element).addClass("four-twenty")}R9.events&&R9.events.publish("smarty.setitem.complete",{id:this.element.attr("id")})}else jq(this.element).addClass("smarty-incomplete"),jq(this.element).removeClass("smarty-complete"),jq(this.element).removeClass("four-twenty"),R9.events&&R9.events.publish("smarty.setitem.incomplete",{id:this.element.attr("id")})}catch(g){}"function"===typeof this.options.setItem?(this.isItemSet=!0,this.options.setItem(this,
a,b)):a?(this.isItemSet=!0,this.element.val(jq(a).text())):(this.isItemSet=!1,this.element.val(""))},showInitialDropdown:function(){var a=this.onInitialData();a&&this.searchCompleted(a,!1)},onInitialData:function(){return"function"===typeof this.options.initialData?this.options.initialData(this):this.options.initialData},runSearch:function(a){if(!(this.element.val().length<this.options.minLength)){var b=this.element.val();if(this.lastValue!=b){var c=this.getRequestData(),c=this.preprocessRequest(c),
d=this,f=function(c){d.request=null;d.lastValue=b;c=d.postprocessResponse(c,a);d.searchCompleted(c,a)};if("function"===typeof this.options.dataSource)this.options.dataSource(c,f);else if(R9.config.getBoolean("ui.common.smarty.get.enabled",!1)){var e=R9.config.getString("ui.common.smarty.get.url",this.options.dataSource);c.cv=R9.config.getString("ui.common.smarty.get.version","1");this.request=jq.ajax({type:"GET",url:e,data:c,dataType:this.options.dataType,cache:!0,success:f})}else this.request=jq.post(this.options.dataSource,
c,f,this.options.dataType)}}},preprocessRequest:function(a){return a},getRequestData:function(){return{value:this.element.val(),formtoken:R9.globals.formtoken}},searchCompleted:function(a,b){a?this.showDropdown(a,b):this.hideDropdown();this.element.trigger("searchCompleted",!!a)},abortSearchCompletedEventListeners:function(){this.element.off("searchCompleted")},postprocessResponse:function(a,b){return a},makeHTML:function(a){return"function"===typeof this.options.makeHTML?this.options.makeHTML(a):
a},showDropdown:function(a,b){var c=this.dropdown[0].style,d=this.makeHTML(a);this.dropdown[0].innerHTML=d;d=R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass;this.options.dropdownClass&&(d=d+" "+this.options.dropdownClass);this.dropdown.attr("class",d);a.length?this.dropdown.removeClass("empty"):this.dropdown.addClass("empty");this.position();R9.config.getBoolean("ui.smarty.animate",!1)?this.dropdown.slideDown(R9.config.getInt("ui.smarty.animation.ms",250)):c.display=this.options.display;c.display=
this.options.display;jq.fn.zIndex&&(c.zIndex=jq(this.element).zIndex()+9999);this.bindDropdownEvent("mousedown",this.handleItemMousedownEvent);this.bindDropdownEvent("mouseover",this.handleItemMouseoverEvent);this.bindDropdownEvent("mouseout",this.handleItemMouseoutEvent);0!=this.getHighlitedItemIndex()&&(this.removeItemHighlite(),b&&""!=this.element.val()&&this.highlightFirstNonHistoryItem())},position:function(){var a=this.dropdown[0].style;this.dropdown.css("width","auto");var b=this.dropdown.outerWidth(!0),
c=!1;this.options.minWidth&&b<=this.options.minWidth&&(b=Math.max(this.options.minWidth,b),c=!0);this.options.maxWidth&&b>=this.options.maxWidth&&(b=Math.min(this.options.maxWidth,b),c=!0);a.width=c||this.options.noAutoWidth?b+"px":"auto";var c=this.element.offset(),d=jq(this.options.appendTo).offset(),f=c.left-d.left;"right"===this.options.position&&(f+=this.element.width()-b-2);a.left=f+"px";a.top=c.top+this.element.outerHeight()-d.top+"px"},isDropdownHidden:function(){return"none"==this.dropdown.css("display")},
hideDropdown:function(a){a||(this.abortKeyTimeout(),this.abortRequest());this.lastValue=null;if(this.isDropdownHidden())return!1;this.dropdown.hide();this.setBackgroundAutocomplete();return!0},abortRequest:function(){if(this.request){try{this.request.abort()}catch(a){}this.request=null}},abortKeyTimeout:function(){this.keyTimeout&&(clearTimeout(this.keyTimeout),this.keyTimeout=null)},highliteNextItem:function(){var a=this.getItemList(),b=nsel=this.getHighlitedItemIndex();-1==b?nsel=0:b<a.length-1&&
(nsel=b+1);b!=nsel&&(jq(a[b]).removeClass("selected"),jq(a[b]).trigger("mouseout"),jq(a[nsel]).addClass("selected"),jq(a[nsel]).trigger("mouseover"),this.setBackgroundAutocomplete(a[nsel]))},highlitePrevItem:function(){var a=this.getItemList(),b=nsel=this.getHighlitedItemIndex();-1==b?nsel=0:0<b&&(nsel=b-1);b!=nsel&&(jq(a[b]).removeClass("selected"),jq(a[b]).trigger("mouseout"),jq(a[nsel]).addClass("selected"),jq(a[nsel]).trigger("mouseover"),this.setBackgroundAutocomplete(a[nsel]))},highlightFirstNonHistoryItem:function(){for(var a=
this.getItemList(),b=0;b<a.length;b++){var c=jq(a[b]);if(!c.hasClass("hist")){c.addClass("selected");this.setBackgroundAutocomplete(a[b]);return}}jq(a[0]).addClass("selected");this.setBackgroundAutocomplete(a[0])},removeItemHighlite:function(){jq(this.getItemList()).removeClass("selected")},getHighlitedItemIndex:function(){var a=this.getItemList();for(i=0;i<a.length;i++)if(jq(a[i]).hasClass("selected"))return i;return-1},getHighlitedItem:function(){var a=this.getItemList();for(i=0;i<a.length;i++)if(jq(a[i]).hasClass("selected"))return a[i];
return null},getItemList:function(){return this.dropdown.find(this.options.dropdownListSelector)},itemMatches:function(a,b){return a?0<=jq(a).text().toLowerCase().indexOf(b.toLowerCase()):!1},checkAlive:function(){return this.element.closest("html").length?this.element.is(":visible")?!0:(this.hideDropdown(),!1):(this.hideDropdown(),this.unInit(),!1)},initBackgroundAutocomplete:function(){!this.backgroundAutocomplete&&this.options.showBackgroundAutocomplete&&(this.options.backgroundAutocompleteMinLength=
R9.config.getInt("ui.common.smarty.background.autocomplete.min.length",3),this.backgroundAutocomplete=jq("\x3cinput/\x3e",{id:this.element.attr("id")+"-bg-autocomplete","class":this.element.attr("class"),type:"text",tabindex:"-1"}).insertBefore(this.element),this.updateBackgroundAutocompletePosition(),this.backgroundAutocomplete.css("color",this.element.css("color").replace(")",", 0.27)").replace("rgb","rgba")),this.backgroundAutocomplete.addClass("smarty-bg-autocomplete"),this.element.addClass("smarty-with-bg-autocomplete"))},
updateBackgroundAutocompletePosition:function(){if(this.options.showBackgroundAutocomplete)if("function"===typeof this.options.getBackgroundAutocompletePositionProps)this.backgroundAutocomplete.css(this.options.getBackgroundAutocompletePositionProps());else{var a=this.element.is(":visible")?this.element.outerHeight():this.element.height();this.backgroundAutocomplete.css({"margin-bottom":"-"+a+"px"})}},handleKeydownBeforeAutocomplete:function(a,b){if(this.options.showBackgroundAutocomplete){var c=
this;setTimeout(function(){var a=c.backgroundAutocomplete.val(),b=c.element.val();b.length>=c.options.backgroundAutocompleteMinLength&&b.length<a.length&&!c.isDropdownHidden()?c.backgroundAutocomplete.val(b+a.substr(b.length)):c.backgroundAutocomplete.val("")},1)}},setBackgroundAutocomplete:function(a){if(this.options.showBackgroundAutocomplete){var b=this.element.val();if(a&&b.length>=this.options.backgroundAutocompleteMinLength&&(a=this.getBackgroundAutocompleteText(a),0<a.length)){var c=a.toUpperCase().indexOf(b.toUpperCase());
this.backgroundAutocomplete.val(-1===c?"":b+a.substr(c+b.length));return}this.backgroundAutocomplete.val("")}},getBackgroundAutocompleteText:function(a){a=this.translateItem(a);return"string"===typeof a.str?a.str:""},handleWindowResize:function(){this.updateBackgroundAutocompletePosition()}})})(jq||jQuery);R9.extend("Widgets.Smarty",{FlareSmarty:function(a,b){R9.Widgets.Smarty.Smarty.call(this,a,jq.extend({dataSource:"/f/smarty"},b));var c=this;jq(".mapViewOuter .filterWrapper").scroll(function(){R9.Widgets.Smarty.Smarty.prototype.handleInputBlurEvent.call(c)})}});R9.extend("Widgets.Smarty.FlareSmarty",!0,{setRunSearchNextFocus:function(a){R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus=a},runSearchNextFocus:!0});
R9.extend("Widgets.Smarty.FlareSmarty.prototype",!0,R9.Widgets.Smarty.Smarty.prototype,{translateItem:function(a){if(!a)return null;var b=a.id.split("-"),c="";1<b.length&&(c=b[1]);jq(a).find("span.airportCode, span.region-label, span.nearbyHotels, span.nearbyRentals, span.smarty-emoji, span.smarty-popular, span.smarty-city-popular, span.smarty-air-popular, span.showRank").remove();var d=jq(a).attr("data-text-to-select"),d=d&&0<jq.trim(d).length?d:jq(a).text();a={type:b[0],id:c,str:d,short_str:jq(a).attr("data-short-name")};
"isl"==a.type&&1<b.length&&(c=b[1].split("/"),a.str=c[0]);2<b.length&&(a.hc=b[2]);3<b.length&&("hotel"===a.type?a.hid=b[3]:"rest"===a.type?a.rtid=b[3]:"freereg"===a.type?a.frid=b[3]:"reg"===a.type?a.rid=b[3]:"ctry"===a.type?a.cid=b[3]:"hood"===a.type?a.nhid=b[3]:a.lmid=b[3]);return a},preprocessRequest:function(a){var b={};this.options.extendRequest&&(b="function"===typeof this.options.extendRequest?this.options.extendRequest(this,a):this.options.extendRequest);var c={};this.options.v&&(c.v=this.options.v);
c.f="h";this.options.f&&(c.f=this.options.f);c.where=a.value;c.s=this.getFlareSmartyType();c.lc_cc=R9.globals.locale.lc_cc;c.lc=R9.globals.locale.lc;return jq.extend(c,b)},runSearchOnFocus:function(){var a=R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus;R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus=!0;return R9.Widgets.Smarty.Smarty.prototype.runSearchOnFocus.call(this)&&a},onInitialData:function(){var a=R9.Widgets.Smarty.Smarty.prototype.onInitialData.call(this)||this.makeRecentList(null,!0),
b=this.generateAnywhereMarkup(),c=this.generateLoginBar(a||b);if(a)return a.replace("\x3c/ul\x3e",(b?b:"")+c+"\x3c/ul\x3e");a=[];b&&a.push(b);this.options.smartyControlGroup&&R9.globals.canLogin&&"undefined"!==typeof c&&a.push(c);return a.length?"\x3cul\x3e"+a.join("")+"\x3c/ul\x3e":""},generateAnywhereMarkup:function(a){},postprocessResponse:function(a,b){var c=a&&/<li/i.test(a),d=this.makeRecentList(b?this.element.val().toUpperCase():null,!c);b=this.generateAnywhereMarkup(c);if(!d&&!c&&!b)return null;
c?(d&&(a=a.replace("\x3cul\x3e","\x3cul\x3e"+d)),c=this.generateLoginBar(!0)):(a=d,c=this.generateLoginBar(!1));a||(a="\x3cul\x3e\x3c/ul\x3e");return a=a.replace("\x3c/ul\x3e",(b?b:"")+c+"\x3c/ul\x3e")},selectItem:function(a,b){jq(a).hasClass("hist")&&this.options.smartyControlGroup?(a=jq(a).data("history-idx"),b=this.options.smartyControlGroup.getHistory(),this.options.smartyControlGroup.setFieldsFromHistoryItem(b.history[a],!1),"undefined"!==typeof this.tempState&&delete this.tempState,R9.Analytics.api.trackEvent("smartyHistory/click/historyItem")):
jq(a).hasClass("showHistory")?(window.location.assign("/history"),R9.Analytics.api.trackEvent("smartyHistory/click/seeAllHistory")):jq(a).hasClass("signup")?(AjaxReg.ui.register({promoType:"smarty"}),R9.Analytics.api.trackEvent("smartyHistory/click/signUp")):jq(a).hasClass("signupnow")?(R9.globals.uiconfig.hasOwnProperty("ui.login.staticSignUp")&&R9.globals.uiconfig["ui.login.staticSignUp"]?R9.authentication.showDefault({promoType:"smarty"}):R9.authentication.showSignup(),R9.Analytics.api.trackEvent("smartyHistory/click/signUp")):
(a=this.translateItem(a),this.setItem(a,b))},makeRecentList:function(a,b){var c=this.options.recentList,d=null;if(c&&0<c.length){for(var d="",e=0;e<c.length;e++)if(!a||-1!=c[e].display.toUpperCase().indexOf(a)){var f=c[e].display;a&&(f=this.highliteText(f,a));d+="\x3cli id\x3d'"+c[e].code+"' class\x3d'"+c[e].className+"' data-short-name\x3d'"+c[e].shortName+"'\x3e"+f+"\x3c/li\x3e"}d=""!=d?(b?"\x3cul\x3e":"")+"\x3cli class\x3d'separator'\x3e\x3cb\x3eRecently searched:\x3c/b\x3e\x3c/li\x3e"+d+(b?"\x3c/ul\x3e":
""):null}return d},highliteText:function(a,b){b=b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$\x26");return a=a.replace(new RegExp("("+b+")","ig"),"\x3cb\x3e$1\x3c/b\x3e")},getFlareSmartyType:function(){return this.options.flareSmartyType?this.options.flareSmartyType:-1},matchAndBold:function(a,b,c,d){if(!a||!b)return b;c=c||"\x3cb\x3e";d=d||"\x3c/b\x3e";var e=0,f=0,k="",g=b,h=a.length;for(a=a.toUpperCase();;){if(0!==e||0!==(f=b.toUpperCase().indexOf(a,e)))if(-1<(f=b.toUpperCase().indexOf(" "+a,e)))f++;
else break;e=b.substring(e,f);g=b.substring(f,f+h);k+=e+c+g+d;g=b.substring(f+h,b.length);e=f+h}return k+g},handleItemMouseoverEvent:function(a,b){this.getItemList().removeClass("selected");jq(a).addClass("selected");jq(a).hasClass("hist")&&this.options.smartyControlGroup&&"undefined"===typeof this.tempState&&(this.tempState=this.options.smartyControlGroup.saveFieldsToHistoryItem(),a=jq(a).data("history-idx"),b=this.options.smartyControlGroup.getHistory(),this.options.smartyControlGroup.setFieldsFromHistoryItem(b.history[a],
!0))},handleItemMouseoutEvent:function(a,b){jq(a).removeClass("selected");"undefined"!==typeof this.tempState&&(this.options.smartyControlGroup.setFieldsFromHistoryItem(this.tempState,!0),delete this.tempState)},generateLoginBar:function(a){if(!this.options.smartyControlGroup||!R9.globals.canLogin)return"";var b="admin";a&&(b+=" addSeparation");return"undefined"!==typeof R9Anon&&R9Anon?"\x3cli class\x3d'signup "+b+"'\x3eSign up to access recent searches anywhere\x3c/li\x3e":"\x3cli class\x3d'showHistory "+
b+"'\x3e See all search history\x3c/li\x3e"},generateRecentHeader:function(){R9.Common.SmartyHistory.currentSmarty=this;R9.Common.SmartyHistory.currentSmartyHistory=this.options.smartyControlGroup.getHistory();this.hasClearRecentEvent||(this.hasClearRecentEvent=!0,this.dropdown.on("mousedown","ul li .clearRecent",function(a){a.stopPropagation();jq("body").trigger("event",[a]);R9.Common.SmartyHistory.SmartyClearHistory()}));return"\x3cli class\x3d'separator'\x3e\x3cspan class\x3d'separatorLabel'\x3eRecent\x3c/span\x3e\x3ca class\x3d'clearRecent'\x3eclear history\x3c/a\x3e\x3c/li\x3e"}});R9.extend("Widgets.Smarty",{EmailSmarty:function(a,b){R9.Widgets.Smarty.Smarty.call(this,a,b)}});R9.extend("Widgets.Smarty.EmailSmarty.prototype",!0,R9.Widgets.Smarty.Smarty.prototype,{});R9.extend("Widgets.Smarty",{HotelsSmarty:function(b,c){if(R9.config.getBoolean("ui.hotel.smarty-history",!1)){var a=" smartbox smartbox-hotel smartbox-v2";R9.config.getBoolean("ui.smarty.greyIcons",!1)&&(a+=" greyIcons");R9.Widgets.Smarty.FlareSmarty.call(this,b,jq.extend({minWidth:250,dropdownClass:a,forceSelection:!0,flareSmartyType:29,searchOnFocus:!0,extendRequest:{v:"v2"}},c))}else R9.Widgets.Smarty.FlareSmarty.call(this,b,jq.extend({minWidth:250,dropdownClass:" smartbox smartbox-hotel",forceSelection:!0,
flareSmartyType:29},c))}});
R9.extend("Widgets.Smarty.HotelsSmarty.prototype",!0,R9.Widgets.Smarty.FlareSmarty.prototype,{makeRecentList:function(b,c){if(this.options.smartyControlGroup){var a=this.options.smartyControlGroup.getHistory();b=jq.trim(b);for(var a=a.filter(b,""==b?10:5),e="",f=0;f<a.length;f++){var d=a[f],g=!1;f==a.length-1&&(g=!0);e+=this.generateSmartyItem(this.matchAndBold(b,d.location),d.checkinDate,d.checkoutDate,d.idx,d.isPast,g)}return e=""!=e?(c?"\x3cul\x3e":"")+this.generateRecentHeader()+e+(c?"\x3c/ul\x3e":
""):null}},generateSmartyItem:function(b,c,a,e,f,d){c=new moment(c);a=new moment(a);return'\x3cli class\x3d"hist '+(d?" last":"")+'" data-history-idx\x3d"'+e+'"\x3e\x3cspan class\x3d"smartyRecentHotels"\x3e'+b+'\x3c/span\x3e\x3cspan class\x3d"smartyRecentDate '+(f?"past":"")+'"\x3e'+c.format(this.options.smartyControlGroup.options.startFormat)+" - "+a.format(this.options.smartyControlGroup.options.endFormat)+"\x3c/span\x3e\x3c/li\x3e"}});R9.extend("Widgets.Smarty",{FlightsSmarty:function(d,h){if(R9.config.getBoolean("ui.flight.smarty-history",!1)){var b=" smartbox smartbox-air smartbox-v2";R9.config.getBoolean("ui.smarty.greyIcons",!1)&&(b+=" greyIcons");R9.Widgets.Smarty.Smarty.call(this,d,jq.extend({dataSource:"/mv/marvel",minWidth:250,dropdownClass:b,forceSelection:!0,flareSmartyType:1,searchOnFocus:!0,extendRequest:{v:"v2"}},h));var f=this}else R9.Widgets.Smarty.Smarty.call(this,d,jq.extend({dataSource:"/mv/marvel",minWidth:250,
dropdownClass:" smartbox smartbox-air",forceSelection:!0,flareSmartyType:1,searchOnFocus:!0},h)),f=this;jq(".mapViewOuter .filterWrapper").scroll(function(){R9.Widgets.Smarty.Smarty.prototype.handleInputBlurEvent.call(f)})}});
R9.extend("Widgets.Smarty.FlightsSmarty.prototype",!0,R9.Widgets.Smarty.FlareSmarty.prototype,{makeRecentList:function(d,h){if(this.options.smartyControlGroup){var b=this.options.smartyControlGroup.getHistory(),f="origin"==this.elementNode.name,e="destination"==this.elementNode.name,c;c=this.options.smartyControlGroup.isRoundTrip();d=jq.trim(d);var a=""==d?10:5;if(e)var g=jq(this.options.smartyControlGroup.options.originCode).val();b=b.filter(d,f,a,c,g);e="";for(c=0;c<b.length;c++)a=b[c],g=!1,c==
b.length-1&&(g=!0),e=f?e+this.generateSmartyItem(this.matchAndBold(d,a.departShortName),a.destShortName,a.startDate,a.endDate,a.idx,a.isRoundTrip,a.isPast,g):e+this.generateSmartyItem(a.departShortName,this.matchAndBold(d,a.destShortName),a.startDate,a.endDate,a.idx,a.isRoundTrip,a.isPast,g);return e=""!=e?(h?"\x3cul\x3e":"")+this.generateRecentHeader()+e+(h?"\x3c/ul\x3e":""):null}},generateSmartyItem:function(d,h,b,f,e,c,a,g){b=new moment(b);f=new moment(f);a=a?"past":"";g=g?" last":"";var k=c?"doubleArrow":
"singleArrow";c=c?" - "+f.format(this.options.smartyControlGroup.options.endFormat):"";return'\x3cli class\x3d"hist '+g+'" data-history-idx\x3d"'+e+'"\x3e\x3cspan class\x3d"smartyRecentAirports"\x3e'+d+'\x3cspan class\x3d"arrow '+k+'"\x3e\x3c/span\x3e'+h+'\x3c/span\x3e\x3cspan class\x3d"smartyRecentDate '+a+'"\x3e'+b.format(this.options.smartyControlGroup.options.startFormat)+c+"\x3c/span\x3e\x3c/li\x3e"}});R9.extend("Widgets.Smarty",{CarsSmarty:function(c,e){if(R9.config.getBoolean("ui.car.smarty-history",!1)){R9.Widgets.Smarty.Smarty.call(this,c,jq.extend({dataSource:"/mv/marvel",minWidth:250,dropdownClass:R9.config.getString("ui.cars.search.smartbox.with.history.dropdownClass.suffix","smartbox smartbox-car"),forceSelection:!0,flareSmartyType:R9.config.getInt("ui.car.smarty.flareSmartyType",37),searchOnFocus:!0,extendRequest:{v:"v2"}},e));var b=this}else R9.Widgets.Smarty.Smarty.call(this,c,jq.extend({dataSource:"/mv/marvel",
minWidth:250,dropdownClass:R9.config.getString("ui.cars.search.smartbox.without.history.dropdownClass.suffix","smartbox smartbox-car"),forceSelection:!0,flareSmartyType:R9.config.getInt("ui.car.smarty.flareSmartyType",37),extendRequest:{v:"v2"}},e)),b=this;jq(".mapViewOuter .filterWrapper").scroll(function(){R9.Widgets.Smarty.Smarty.prototype.handleInputBlurEvent.call(b)})}});
R9.extend("Widgets.Smarty.CarsSmarty.prototype",!0,R9.Widgets.Smarty.FlareSmarty.prototype,{makeRecentList:function(c,e){var b=this.options.smartyControlGroup;if(b){var d=b.getHistory(),f="location"===this.elementNode.name,b=b.isOneWay();c=jq.trim(c);for(var d=d.filter(c,f,""===c?10:5,b),g="",h=0;h<d.length;h++){var a=d[h],k=!1;h===d.length-1&&(k=!0);g=f?g+this.generateSmartyItem(this.matchAndBold(c,a.location),a.location2,this.matchAndBold(c,a.airportCode),a.airportCode2,a.cityName,a.cityName2,a.startDate,
a.endDate,a.idx,b,a.isPast,k):g+this.generateSmartyItem(a.location,this.matchAndBold(c,a.location2),a.airportCode,this.matchAndBold(c,a.airportCode2),a.cityName,a.cityName2,a.startDate,a.endDate,a.idx,b,a.isPast,k)}return g=""!==g?(e?"\x3cul\x3e":"")+this.generateRecentHeader()+g+(e?"\x3c/ul\x3e":""):null}},generateSmartyItem:function(c,e,b,d,f,g,h,a,k,n,l,m){e=new moment(h);a=new moment(a);l=l?"past":"";m=m?" last":"";return n?'\x3cli class\x3d"hist '+m+'" data-history-idx\x3d"'+k+'"\x3e\x3cspan class\x3d"smartyRecentCars"\x3e'+
(b||f)+'\x3cspan class\x3d"arrow singleArrow"\x3e\x3c/span\x3e'+(d||g)+'\x3c/span\x3e\x3cspan class\x3d"smartyRecentDate '+l+'"\x3e'+e.format(this.options.smartyControlGroup.options.startFormat)+" - "+a.format(this.options.smartyControlGroup.options.endFormat)+"\x3c/span\x3e\x3c/li\x3e":'\x3cli class\x3d"hist '+m+'" data-history-idx\x3d"'+k+'"\x3e\x3cspan class\x3d"smartyRecentCars"\x3e'+(null!==b?'\x3cspan class\x3d"airportCode"\x3e'+b+"\x3c/span\x3e"+c:c)+'\x3c/span\x3e\x3cspan class\x3d"smartyRecentDate '+
l+'"\x3e'+e.format(this.options.smartyControlGroup.options.startFormat)+" - "+a.format(this.options.smartyControlGroup.options.endFormat)+"\x3c/span\x3e\x3c/li\x3e"},highlightFirstNonHistoryItem:function(){for(var c=R9.config.getBoolean("ui.car.smarty.highlight.first.airport",!1),e=-1,b=this.getItemList(),d=0;d<b.length;d++){var f=jq(b[d]);if(!f.hasClass("hist")){if(c){if(e===d){f.addClass("selected");this.setBackgroundAutocomplete(b[d]);return}if(1===(parseInt(f.data("airports-count"),10)||0)){e=
d+1;continue}}f.addClass("selected");this.setBackgroundAutocomplete(b[d]);return}}jq(b[0]).addClass("selected");this.setBackgroundAutocomplete(b[0])}});R9.extend("Widgets.Smarty",{DealsSmarty:function(a,b){R9.Widgets.Smarty.FlareSmarty.call(this,a,jq.extend({minWidth:250,dropdownClass:" smartbox smartbox-deal",forceSelection:!0,flareSmartyType:7},b))}});R9.extend("Widgets.Smarty.DealsSmarty.prototype",!0,R9.Widgets.Smarty.FlareSmarty.prototype,{});(function(e,m){R9.extend("Widgets.Smarty",{PackageToursSmarty:function(a,b){this.ptOptions=e.extend({},this.ptOptions,b.ptOptions);R9.Widgets.Smarty.Smarty.call(this,a,jq.extend({dataSource:this.ptOptions.smartUrl,dropdownClass:" smartbox smartbox-packagetour",forceSelection:!0,searchOnFocus:!0,flareSmartyType:17},b));var c=this;jq(".mapViewOuter .filterWrapper").scroll(function(){R9.Widgets.Smarty.Smarty.prototype.handleInputBlurEvent.call(c)})}});R9.extend("Widgets.Smarty.PackageToursSmarty.prototype",
!0,R9.Widgets.Smarty.FlareSmarty.prototype,{hiddenInput:null,searchInput:null,suggestionsXml:null,setItemFromSmarty:!1,triggerSmartBoxFocusTimeout:null,hasTags:!0,tagsContainer:null,tags:{},tagsIds:[],isSubmitEnabled:!1,skipActiveSubmit:!1,skipSuggestionsShowing:!1,isPlaceHolderSupported:!1,ptOptions:{kpackMobile:!1},init:function(){R9.Widgets.Smarty.FlareSmarty.prototype.init.call(this);this.extendOptions();this.hasTags=!0;this.tags={};this.tagsIds=[];this.searchInput=e(this.element);this.hiddenInput=
e(this.ptOptions.hiddenInput);this.isPlaceHolderSupported=this.checkIsPlaceHolderSupported();this.initTags();this.bindSearchInputEvents()},extendOptions:function(){var a=this;e.extend(!0,this.options,{initialData:function(){return a.getSuggestions()},setItem:function(b,c,d){b=a.searchInput;a.hasTags&&c.isSuggestionParent?b.val("").removeClass("focus"):(a.setItemFromSmarty=!0,b=c.name,c&&c.id&&b&&(c=c.id,b=a.clearHtml(b),a.addSearchValue(c,b,!0)))}})},makeHTML:function(a){var b=this;a=a.replace("\x3c/ul\x3e\x3c/ul\x3e",
"\x3c/ul\x3e").replace('\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e',"");a=e(a);a.find("li").each(function(a){var d=e(this);if(a=b.getSmartBoxElementData(d,!1)){d.attr("data-attr",JSON.stringify(a));var d=e("\x3cdiv\x3e"),c=a.nearbyHotels;c&&0!==c.length&&d.append(e("\x3cspan\x3e").addClass("nearbyHotels").append(c));var c=e("\x3cspan\x3e",{"class":"fullNameHolder",css:{display:"block",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}}).css("oveflow","hidden"),f=a.name;f&&
0!==f.length&&c.append(e("\x3cspan\x3e").addClass("name").append(f));(f=a.parentPath)&&0!==f.length&&(f=e("\x3cspan\x3e").addClass("parentPath").append(f),a.isSuggestion?c.append(", "):c.append(a.isHotel||a.isNeighborhood?" - ":", "),c.append(f));d.append(c);this.innerHTML=d[0].innerHTML}});return'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n'+a.wrap("\x3cdiv\x3e").parent().html()},translateItem:function(a){a=e(a).attr("data-attr");return e.parseJSON(a)},initTags:function(){var a=this.ptOptions.tags;
a&&a.tagsContainerSelector?(this.tagsContainer=e(a.tagsContainerSelector),this.tagsContainer.length?(this.bindTagsContainerEvents(),this.bindTagEvents(),this.bindTagsKeyboardEvents(),this.initPlaceHolderStyles(),this.togglePlaceHolder()):this.hasTags=!1):this.hasTags=!1},bindTagsContainerEvents:function(){var a=this;this.tagsContainer.on("click",function(b){a.searchInputFocus(0<a.tagsIds.length)})},bindTagEvents:function(){var a=this,b=this.ptOptions.tags,c=b.tagSelector,d=b.selectedClass;this.ptOptions.kpackMobile||
(this.tagsContainer.off("click",c).on("click",c,function(b){b.preventDefault();b.stopPropagation();b=e(this);b.hasClass(d)?b.removeClass(d):(b.addClass(d),b.siblings(c).removeClass(d));a.searchInputFocus(!0)}),this.tagsContainer.off("click",b.tagCloseSelector).on("click",b.tagCloseSelector,function(c){c=e(this).closest(b.tagSelector);a.removeTag(c,!0);return!1}))},searchInputFocus:function(a){this.skipSuggestionsShowing=a;this.triggerSmartBoxFocusWithTimeout()},searchInputFocusOut:function(){this.searchInput.focusout()},
bindTagsKeyboardEvents:function(){var a=this,b=this.ptOptions.tags,c=b.tagSelector,d=b.selectedClass,h=this.searchInput,f=this.tagsContainer;h.on("keydown",function(b){if(!h.val())if(13===b.which)a.isSubmitEnabled&&(0<a.tagsIds.length&&a.disableSmartBox(),a.skipActiveSubmit=!1,h.closest("form").submit()),a.skipActiveSubmit=!0,a.isSubmitEnabled=!0;else if(0!==a.tagsIds.length)switch(b.which){case 8:b=e(c+"."+d,f);if(b.length)a.removeTag(b,!0);else{b=e(c,f).last();if(!b.length)break;b.addClass(d)}a.hideSmartBox();
break;case 46:b=e(c+"."+d,f);if(!b.length)break;a.removeTag(b,!0);break;case 27:e(c,f).removeClass(d);break;case 37:b=e(c+"."+d,f);if(b.length){var g=b.prev(c);if(!g.length)if(1<a.tagsIds.length)g=e(c,f).last();else break;b.removeClass(d);g.addClass(d)}else b=e(c,f).last(),b.length&&b.addClass(d);break;case 39:if(b=e(c+"."+d,f),b.length){g=b.next(c);if(!g.length)if(1<a.tagsIds.length)g=e(c,f).first();else break;b.removeClass(d);g.addClass(d)}}})},maxTagsReached:function(){var a=this.ptOptions.tags,
b=this.getCurrentHiddenData();return b&&a.maxTags<=b.length?!0:!1},removeLastTag:function(a,b){this.removeTagById(this.tagsIds[this.tagsIds.length-1],a,b)},addTag:function(a,b,c){var d=this,h=this.ptOptions.tags;if(!a||!b)return!1;var f=e('[data-id\x3d"'+a+'"]',this.tagsContainer);if(0<f.length&&(!this.tags||this.tags===[]||this.tags==={}))return!1;if(void 0!==this.tags[a])return f.fadeOut(100,function(){f.fadeIn(100);d.searchInput.val("")}),!1;this.maxTagsReached()&&this.removeLastTag(!0,!0);var k=
e(h.tagTemplate.replace("[[TEXT]]",b));k.attr("data-id",a);var g=e(h.tagSelector,this.tagsContainer).last();g.length?g.after(k):this.tagsContainer.prepend(k);this.tags[a]=b;this.tagsIds.push(a);this.tagsIds.length>=h.maxTags&&(d.disableSmartBox(),this.searchInput.addClass(h.hiddenClass));this.searchInput.val("");!0===c&&this.tagsIds.length<h.maxTags?this.searchInputFocus(!0):this.searchInputFocusOut();this.removeItemHighlite();this.addHiddenData(a,b);return!0},getItemText:function(a){var b="";e(a).each(function(a){if("name"===
this.className)return b=e(this).text(),!1});return b},removeTag:function(a,b,c){var d=this;if(a.length){this.setBackgroundAutocomplete();var h=function(){var c=d.ptOptions.tags,h=a.attr("data-id"),g=d.tagsIds.indexOf(h);delete d.tags[h];d.tagsIds.splice(g,1);a.remove();d.enableSmartBox();d.tagsContainer.removeClass(c.disabledClass);d.searchInput.removeClass(c.hiddenClass);d.removeHiddenData(h);e.isEmptyObject(d.tags)&&d.clearSearchValues();!0===b&&d.searchInputFocus(0<d.tagsIds.length)};c?h():a.fadeOut(200,
function(){h()})}},removeTagById:function(a,b,c){a=e(this.ptOptions.tags.tagSelector,this.tagsContainer).filter("[data-id\x3d"+a+"]");this.removeTag(a,b,c)},getSuggestions:function(){if(!(this.hasTags&&this.maxTagsReached()||this.skipSuggestionsShowing||e("#"+this.ptOptions.targetId).is(":visible")||!this.searchInput.is(":visible")||this.searchInput.is(":disabled"))){if(this.suggestionsXml)return this.suggestionsXml;var a=this.ptOptions.suggestions,b=a.data;if(b&&0!==b.length){var c=function(b,c,
d){var f=b.id,g=b.type,h=e.trim(b.name),k=e.trim(b.nearbyHotels);b=b.children;if(""!==h)return c=e("\x3cli\x3e").html("").attr("id",d+"-PT_"+g+f).addClass(c+" type_"+g),k&&0!==k.length&&c.append(e("\x3cspan\x3e").addClass("nearbyHotels").append(a.nearbyHotelsMsg.replace("[[NEARBY_HOTELS_COUNT]]",k))),c.append(e("\x3cdiv\x3e").append(h)),b&&0<b.length&&c.addClass("has_children"),c},d=e("\x3cdiv\x3e"),h=e("\x3cul\x3e").addClass("suggestions"),f;for(f=0;f<b.length;f++){var k=b[f],g=c(k,"pt_suggestion parent",
"pt_suggestion_parent");h.append(g);if(k.children&&0<k.children.length){var l;for(l=0;l<k.children.length;l++)g=c(k.children[l],"pt_suggestion children","pt_suggestion_child"),h.append(g)}}d.html(h);return this.suggestionsXml='\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e'+d.html()}}},isSearchInputEmpty:function(){var a=e.trim(this.searchInput.val()),b=e.trim(e("#dstEmptyPlaceHolderText").html()),c=e.trim(e("#dstNotEmptyPlaceHolderText").html());return a&&""!==a&&a!==b&&a!==c?!1:!0},initPlaceHolderStyles:function(){var a=
this.searchInput;a.siblings(".placeholdertext").css({position:"absolute",top:-9999999,left:-9999999999,width:"auto",fontSize:a.css("fontSize"),padding:a.css("padding"),fontFamily:a.css("fontFamily"),fontWeight:a.css("fontWeight"),letterSpacing:a.css("letterSpacing"),whiteSpace:"nowrap"})},checkIsPlaceHolderSupported:function(){return void 0!==document.createElement("input").placeholder},togglePlaceHolder:function(){var a=this.searchInput.siblings(".placeholdertext"),b=e("#dstEmptyPlaceHolderText").html();
this.hasHiddenData()&&(b=e("#dstNotEmptyPlaceHolderText").html());a.html(b);this.isPlaceHolderSupported&&this.searchInput.prop("placeholder",b);a=a.width();this.searchInput.css("min-width",(40>a?40:a)+10)},disableSmartBox:function(){this.searchInput.attr("disabled","disabled");this.searchInput.hide();this.hideSmartBox()},hideSmartBox:function(){e("#"+this.ptOptions.targetId).hide()},enableSmartBox:function(){this.maxTagsReached()?this.disableSmartBox():(this.searchInput.removeAttr("disabled"),this.searchInput.css("display",
"inline"))},issetHiddenValue:function(a){for(var b=this.getCurrentHiddenData(),c=b.length,d=0;d<c;d++)if(a===b[d].id)return d+1;return!1},getCurrentHiddenData:function(){var a=e.trim(this.hiddenInput.val());return a&&e.parseJSON(a)||[]},hasHiddenData:function(){var a=this.getCurrentHiddenData();return!!(a&&0<a.length)},createHiddenValue:function(a,b){return{id:a,name:b}},addHiddenData:function(a,b){this.issetHiddenValue(a)||(a=this.createHiddenValue(a,b),this.hasTags?(b=this.getCurrentHiddenData(),
b.push(a)):b=[a],this.hiddenInput.changeHiddenParam(JSON.stringify(b)),this.hasTags&&(this.maxTagsReached()?this.disableSmartBox():this.enableSmartBox()),this.togglePlaceHolder(),this.onHiddenChange())},onHiddenChange:function(){"function"===typeof this.ptOptions.onHiddenChange&&this.ptOptions.onHiddenChange.call()},removeHiddenData:function(a){a=this.issetHiddenValue(a);var b=this.getCurrentHiddenData();a&&b.splice(a-1,1);this.hiddenInput.changeHiddenParam(JSON.stringify(b));this.enableSmartBox();
this.togglePlaceHolder();this.onHiddenChange()},addSearchValue:function(a,b,c){if(this.hasTags)return this.addTag(a,b,c);!0===c?this.searchInputFocus(!0):this.searchInputFocusOut();this.removeItemHighlite();this.searchInput.val(b);this.addHiddenData(a,b);return!0},clearSearchValues:function(){this.hasTags&&(e(this.ptOptions.tags.tagSelector,this.tagsContainer).remove(),this.tags=[],this.tagsIds=[]);this.togglePlaceHolder();this.searchInput.val("").removeClass("focus");this.hiddenInput.changeHiddenParam("[]")},
bindSearchInputEvents:function(){var a=this,b=this.searchInput;if(!this.hasTags)b.on("change",function(c){if(b.is(":disabled"))return!1;c.stopPropagation();a.isSearchInputEmpty()&&(a.clearSearchValues(),a.onHiddenChange())});b.on("click",function(c){if(b.is(":disabled"))return!1;c.stopPropagation();a.searchInputFocus(!1)});b.on("focus",function(b){b.stopPropagation();a.smartBoxFocus();a.isSubmitEnabled=!1;a.skipActiveSubmit=!1});b.on("focusout",function(b){b.stopPropagation();a.setItemFromSmarty?
(a.setItemFromSmarty=!1,a.searchInputFocus(!0)):(a.smartBoxFocusOut(),"function"===typeof a.ptOptions.onFocusout&&a.ptOptions.onFocusout.call());return!1});"function"===typeof e.fn.autoGrowInput&&this.searchInput.autoGrowInput();b.on("keyup keydown blur update",function(b){a.togglePlaceHolder()});b.on("blur",function(){a.skipActiveSubmit=!1})},smartBoxFocus:function(){this.isSearchInputEmpty()&&(this.searchInput.val(""),this.searchValue="");this.searchInput.addClass("focus")},triggerSmartBoxFocusWithTimeout:function(){var a=
this;this.triggerSmartBoxFocusTimeout&&(clearTimeout(a.triggerSmartBoxFocusTimeout),this.triggerSmartBoxFocusTimeout=null);this.triggerSmartBoxFocusTimeout=setTimeout(function(){a.searchInput&&a.searchInput.is(":visible")&&(a.searchInput.focus(),a.triggerSmartBoxFocusTimeout=null)},50)},smartBoxFocusOut:function(){""===this.searchInput.val()&&this.searchInput.removeClass("focus");this.togglePlaceHolder()},autoAutocomplete:function(a,b){var c=this,d=a.split(" "),h=d.length,f=[];if(this.isSearchInputEmpty())"function"===
typeof b&&b(f);else{var k=function(){if(d.length===h&&0<f.length&&"function"===typeof b)b(f);else if(0<d.length){var a=d.splice(0,1)[0];g(a)}else"function"===typeof b&&b(f)},g=function(a){var b=c.ptOptions;0===e.trim(a).length?k():(a={f:"h",lc:b.langCode,lc_cc:b.countryCode,s:17,where:a},c.options.extendRequest&&(a.v=c.options.extendRequest.v),e.ajax({url:b.smartUrl,type:"POST",dataType:"text",data:a,success:function(a){a=e(a).find("li:first");0<a.length&&(a=c.getSmartBoxElementData(e(a),!0))&&f.push(c.createHiddenValue(a.id,
a.name))},complete:function(){k()}}))};g(a)}},getSmartBoxElementData:function(a,b){var c=a.attr("id"),d,e=!1,f=!1,k="",g=a.html();d=a.find("div");0<d.length&&(g=d.html());a=a.find("span.nearbyHotels");0<a.length&&(k=a.html());-1!==c.indexOf("pt_suggestion_parent")?(f=!0,d=g.split("\n")):-1!==g.indexOf("#####")?(e=!0,d=g.split("#####")):d=-1!==g.indexOf("##")?g.split("##"):g.split("\n");if(0===d.length)return null;c=this.extractValidId(c);g=d[0];a="";1<d.length&&(a=d[1]);g=this.fixBoldTags(g);a=this.fixBoldTags(a);
d=0===c.indexOf("H");var l=0===c.indexOf("S");!0===b&&(g=this.clearHtml(g),a=this.clearHtml(a));return{id:c,name:g,parentPath:a,nearbyHotels:k,isHotel:d,isNeighborhood:l,isSuggestion:e,isSuggestionParent:f}},extractValidId:function(a){if(0<=a.indexOf("-PT_")){var b=a.match(/PT_(?:SPT_)?([A-Z0-9]+)/);b&&1<b.length&&(a=b[1])}return a},fixBoldTags:function(a){a=e.trim(a);var b=-1!==a.toLowerCase().indexOf("\x3cb\x3e"),c=a.toLowerCase().indexOf("\x3c/b\x3e"),d=-1!==c;!d||0!==c&&b?!b||"\x3cb\x3e"!==a.substr(-3).toLowerCase()&&
d||(a+="\x3c/b\x3e"):a="\x3cb\x3e"+a;return a},clearHtml:function(a){a=a.replace(/<b>|<\/b>/gmi,"");a=a.replace(/<div>|<\/div>/gmi,"");return a=a.replace(/&amp;/gmi,"\x26")},getBackgroundAutocompleteText:function(a){a=this.translateItem(a);return"string"===typeof a.name?this.clearHtml(a.name):""}})})(jq||jQuery,window);R9.extend("Widgets.Smarty",{LandmarksSmarty:function(a,b){R9.Widgets.Smarty.Smarty.call(this,a,jq.extend({dataSource:R9.config.getString("ui.landmarks.smartUrl","/f/smarty"),minWidth:250,dropdownClass:" smartbox",featureClass:"",forceSelection:!0,flareSmartyType:21,searchOnFocus:!0,searchNoQuery:!0,showDropdownWhenEmpty:!0,f:"j",v:"v1"},b));var c=this;jq(".mapViewOuter .filterWrapper").scroll(function(){R9.Widgets.Smarty.Smarty.prototype.handleInputBlurEvent.call(c)})}});
R9.extend("Widgets.Smarty.LandmarksSmarty.prototype",!0,R9.Widgets.Smarty.FlareSmarty.prototype,{geocoder:null,translateItem:function(a){if(!a)return null;a=jq(a);return{type:a.attr("data-type"),id:a.attr("id"),str:a.text(),short_str:a.attr("data-short-name"),lat:a.attr("data-lat"),lon:a.attr("data-lon")}},onBeforeStart:function(){"function"===typeof this.options.beforeStart&&this.options.beforeStart(this)},noItemToSelect:function(){if("function"===typeof this.options.onNoItemToSelect)this.options.onNoItemToSelect(this)},
runSearch:function(a){if(!(this.element.val().length<this.options.minLength)){var b=this.element.val();if(this.lastValue!==b){this.lastValue=b;var c=this.getRequestData();a||(c.value="");var d=this.preprocessRequest(c),f=this,e={};0<b.length&&R9.Maps.Google.load(null,"landmarks-smarty");e.useGoogle=R9.Maps.Google.isLoaded()&&0<b.length;var g=function(){if(e.useGoogle||null==e.smarty)null!=e.smarty&&null!=e.google&&(b=f.postprocessResponse(e),f.searchCompleted(b,a));else{var b=f.postprocessResponse(e);
f.searchCompleted(b,a)}};this.smartyRequest=jq.post(this.options.dataSource,d,function(a){e.smarty=a;g()},this.options.dataType);e.useGoogle&&(this.geocoder||(this.geocoder=new google.maps.Geocoder),b=this.preprocessGoogleRequest(c),this.geocoder.geocode(b,function(a,b){"OK"===b&&(e.google=a,g())}))}}},isUpdateInProgress:function(){return this.keyTimeout||this.smartyRequest||this.googleRequest},abortRequest:function(){if(this.smartyRequest){try{this.smartyRequest.abort()}catch(a){}this.smartyRequest=
null}if(this.googleRequest){try{this.googleRequest.abort()}catch(a){}this.googleRequest=null}},postprocessResponse:function(a){var b,c,d;a.smarty&&(c=JSON.parse(a.smarty),d=c.landmarks);if(null!=d)b=this.makePopularContent(d,this.options.recentLandmarks);else if(c||a.google)b=this.makeRegularContent(c,a.google);b||(b=this.makeEmptyContent());return b},makeEmptyContent:function(){return this.options.emptyItemContent},makePopularContent:function(a,b){var c=[];if(a&&0<a.length){c.push("\x3cdiv\x3e\x3cdiv class\x3d'smartyheader'\x3e");
c.push(this.options.popularLandmarksHeader);c.push("\x3c/div\x3e\x3c/div\x3e");c.push("\x3cul\x3e");for(var d=0;d<a.length;d++){var f=this.makeSmartyResult(a[d]);f&&c.push(f)}c.push("\x3c/ul\x3e")}if(b&&0<b.length){c.push("\x3cdiv\x3e\x3cdiv class\x3d'smartyheader'\x3e");c.push(this.options.recentLocationsHeader);c.push("\x3c/div\x3e\x3c/div\x3e");c.push("\x3cul\x3e");for(d=0;d<b.length;d++)a=b[d],(f=this.makeResult(a.type.uiCode,a.id,a.landmarkName,a.latitude,a.longitude))&&c.push(f);c.push("\x3c/ul\x3e")}return c.join("")},
makeRegularContent:function(a,b){var c=[],d=0,f=10;if(a)for(var e=0;e<f&&e<a.length;e++,d++){var g=this.makeSmartyResult(a[e]);g&&c.push(g)}if(b)for(f-=d,e=0;e<f&&e<b.length;e++,d++)(a=this.makeGoogleResult(b[e]))&&c.push(a);return 0<c.length?"\x3cul\x3e"+c.join("")+"\x3c/ul\x3e":null},makeSmartyResult:function(a){var b=a.loctype,c=a.id,d=a.lat,f=a.lng;a=a.displayname;a=this.highliteText(a,this.lastValue);return this.makeResult(b,c,a,d,f)},makeGoogleResult:function(a){if(this.googleHasType(a.types,
["street_address","neighborhood","sublocality_level_4","sublocality_level_5"])){var b=a.geometry.location.lat(),c=a.geometry.location.lng();if(this.isInBounds(b,c))return a=a.formatted_address,a=this.highliteText(a,this.lastValue),this.makeResult("adr",null,a,b,c)}return null},makeResult:function(a,b,c,d,f){return"\x3cli data-type\x3d'"+a+"' class\x3d'"+a+"' "+(b?"id\x3d'"+b+"' ":"")+(d?" data-lat\x3d'"+d+"' ":"")+(f?" data-lon\x3d'"+f+"' ":"")+"\x3e"+c+"\x3c/li\x3e"},isInBounds:function(a,b){return this.options.swBounds&&
this.options.neBounds&&(a<this.options.swBounds.lat||a>this.options.neBounds.lat||b<this.options.swBounds.lon||b>this.options.neBounds.lon)?!1:!0},googleHasType:function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(a[c]===b[d])return!0;return!1},preprocessGoogleRequest:function(a){var b={};b.language=R9.globals.locale.lc;b.address=a.value;this.options.swBounds&&this.options.neBounds&&(b.bounds=new google.maps.LatLngBounds(new google.maps.LatLng(this.options.swBounds.lat,this.options.swBounds.lon),
new google.maps.LatLng(this.options.neBounds.lat,this.options.neBounds.lon)));return b}});R9.extend("Widgets.Smarty",{TimePickerSmarty:function(a,b){R9.Widgets.Smarty.Smarty.call(this,a,b)}});
R9.extend("Widgets.Smarty.TimePickerSmarty.prototype",!0,R9.Widgets.Smarty.Smarty.prototype,{handleInputChangeEvent:function(){this.abortKeyTimeout();this.abortRequest();this.onInputChange()},runSearch:function(){this.showInitialDropdown()},showInitialDropdown:function(){var a=this.onInitialData();if(a){this.searchCompleted(a,!1);var a=this.element.val(),b=!1===this.options.is24hour?moment(a,"hh:mm,A"):moment(a,"HH:mm");if(null!=b){var a=parseInt(b.format("HH")),c=0;30<=parseInt(b.format("mm"))&&
(c=1);var b=this.dropdown.find("li:first-child").outerHeight(),d=this.dropdown.height();this.dropdown.find("ul").scrollTop(Math.max((2*a+c)*b-(d-b)/2,0));this.getItemList().removeClass("selected")}}},hideDropdown:function(){this.abortKeyTimeout();this.abortRequest();this.lastValue=null;if("none"==this.dropdown.css("display"))return!1;this.dropdown.hide();return!0},onInputChange:function(){this.isItemSet=!1;this.removeItemHighlite()},appendTo:"#tripform"});R9.extend("Widgets.Smarty",{CustomSmarty:function(b,a){R9.Widgets.Smarty.Smarty.call(this,b,a)}});
R9.extend("Widgets.Smarty.CustomSmarty.prototype",!0,R9.Widgets.Smarty.Smarty.prototype,{runSearch:function(b){if(!(this.element.val().length<this.options.minLength)){var a=this.element.val();if(this.lastValue!=a){this.lastValue=a;var d=a.length,c=jq(this.onInitialData());c.find("li").each(function(){jq(this).html().substr(0,d).toLowerCase()!=a.toLowerCase()&&jq(this).remove()});this.searchCompleted(1>c[0].childElementCount?"":c[0].outerHTML,b)}}}});R9.extend("Widgets.Smarty",{TripAddressSmarty:function(a,b){R9.Widgets.Smarty.Smarty.call(this,a,b)}});
R9.extend("Widgets.Smarty.TripAddressSmarty.prototype",!0,R9.Widgets.Smarty.Smarty.prototype,{runSearch:function(a){if(!(this.element.val().length<this.options.minLength)){var b=this.element.val();if(this.lastValue!=b){var c=this;this.request=jq.get(this.options.dataSource,{address:b},function(d){c.request=null;c.lastValue=b;d=c.postprocessResponse(d,a);c.searchCompleted(d,a)},this.options.dataType)}}},postprocessResponse:function(a,b){return a.slice(1,a.length-1)},searchCompleted:function(a,b){9<
a.length?this.showDropdown(a,b):this.hideDropdown()}});R9.extend("Widgets.Smarty",{NearbySmarty:function(a,b){R9.Widgets.Smarty.FlareSmarty.call(this,a,jq.extend({dropdownClass:" smartbox smartbox-hotel",forceSelection:!0,searchOnFocus:!0,searchNoQuery:!0,flareSmartyType:28,f:"j",v:"v1"},b))}});
R9.extend("Widgets.Smarty.NearbySmarty.prototype",!0,R9.Widgets.Smarty.FlareSmarty.prototype,{geocoder:null,placesService:null,nearbyPlaceTypes:{airport:"ap",restaurant:"rest"},translateItem:function(a){return a?{type:jq(a).data("type"),id:a.id,str:jq(a).text(),lat:jq(a).data("lat"),lon:jq(a).data("lon"),ggpid:jq(a).data("ggpid")}:null},runSearch:function(a){if(!(this.element.val().length<this.options.minLength)){var b=this.element.val();if(this.lastValue!==b){this.lastValue=b;var d=this.getRequestData();
a||(d.value="");var c=this.preprocessRequest(d),e=this,f={};f.setRegularResponse=0<b.length;var g=function(){if(null!=f.smarty){var b=e.postprocessResponse(f,f.setRegularResponse);e.searchCompleted(b,a)}};this.smartyRequest=jq.post(this.options.dataSource,c,function(a){f.smarty=a},this.options.dataType);this.nearbyPromise=this.getGoogleSmartyPlaces(d,f);f.setRegularResponse&&(this.geocoder||(this.geocoder=new google.maps.Geocoder),b=this.preprocessGoogleRequest(d),this.geocoder.geocode(b,function(a,
b){"OK"===b&&(f.geocoder=a,g())}));jq.when(this.smartyRequest,this.nearbyPromise).done(function(){g()})}}},getGoogleSmartyPlaces:function(a,b){var d=jq.Deferred();if(!this.placesService){var c=hotelResultsMap.mapController.getMap().getGMap();this.placesService=new google.maps.places.PlacesService(c)}a=this.preprocessNearbyRequest(a);this.placesService.nearbySearch(a,function(a,c){c==google.maps.places.PlacesServiceStatus.OK&&(b.nearby=a);d.resolve()});return d.promise()},filterOutHotels:function(a){var b=
[],d;if(a)for(var c=0;c<a.length;c++)d=a[c].loctype,"hotel"!=d&&b.push(a[c]);return b},postprocessResponse:function(a,b){var d,c,e;a.smarty&&(c=JSON.parse(a.smarty));a.nearby&&0<a.nearby.length&&(e=a.nearby);if(!b&&0<this.options.popularContent.length)d=this.makePopularContent(this.options.popularContent,c,e);else if(c||a.geocoder||a.nearby)d=this.makeRegularContent(c,a.geocoder,e);d||(d=this.makeEmptyContent());return d},makeResult:function(a,b,d,c,e,f){return"\x3cli data-type\x3d'"+a+"' class\x3d'"+
a+"' "+(b?"id\x3d'"+b+"' ":"")+(c?" data-lat\x3d'"+c+"' ":"")+(e?" data-lon\x3d'"+e+"' ":"")+(f?" data-ggpid\x3d'"+f+"' ":"")+"\x3e"+d+"\x3c/li\x3e"},makeSmartyResult:function(a){var b=a.loctype,d=a.lat,c=a.lng,e=a.displayname,f;a.id?f=a.id:a.ctid&&(f=a.ctid);this.lastValue&&0<this.lastValue.length&&(e=this.highliteText(e,this.lastValue));return this.makeResult(b,f,e,d,c,null)},makeGoogleResult:function(a){if(this.googleHasType(a.types,["street_address","neighborhood","sublocality_level_4","sublocality_level_5"])){var b=
a.geometry.location.lat(),d=a.geometry.location.lng();if(this.isInBounds(b,d))return a=a.formatted_address,this.lastValue&&(a=this.highliteText(a,this.lastValue)),this.makeResult("adr",null,a,b,d,null)}return null},makeGoogleNearbyResult:function(a){var b,d;for(d in this.nearbyPlaceTypes)if(-1<jq.inArray(d,a.types)){b=this.nearbyPlaceTypes[d];break}d=a.place_id;var c=a.geometry.location.lat(),e=a.geometry.location.lng();a=a.name;this.lastValue&&0<this.lastValue.length&&(a=this.highliteText(a,this.lastValue));
return this.makeResult(b,d,a,c,e,d)},makeEmptyContent:function(){return this.options.emptyItemContent},makePopularContent:function(a,b,d){var c=[];a&&0<a.length&&c.push(a);if(a=this.filterOutHotels(b)){c.push("\x3cdiv\x3e\x3cdiv class\x3d'smartyheader'\x3e");c.push(this.options.popularLandmarksHeader);c.push("\x3c/div\x3e\x3c/div\x3e");c.push("\x3cul\x3e");b=10;for(var e=0;e<b&&e<a.length;e++){var f=this.makeSmartyResult(a[e]);f&&c.push(f)}c.push("\x3c/ul\x3e")}if(d){b=5;c.push("\x3cul\x3e");for(e=
0;e<b&&e<d.length;e++)(f=this.makeGoogleNearbyResult(d[e]))&&c.push(f);c.push("\x3c/ul\x3e")}return c.join("")},makeRegularContent:function(a,b,d){var c=[],e=0,f=15;if(a)for(var g=0;g<f&&g<a.length;g++,e++){var h=this.makeSmartyResult(a[g]);h&&c.push(h)}if(b)for(f-=e,g=0;g<f&&g<b.length;g++,e++)(a=this.makeGoogleResult(b[g]))&&c.push(a);if(d)for(f-=e,g=0;g<f&&g<d.length;g++,e++)(a=this.makeGoogleNearbyResult(d[g]))&&c.push(a);return 0<c.length?"\x3cul\x3e"+c.join("")+"\x3c/ul\x3e":null},isInBounds:function(a,
b){return this.options.swBounds&&this.options.neBounds&&(a<this.options.swBounds.lat||a>this.options.neBounds.lat||b<this.options.swBounds.lon||b>this.options.neBounds.lon)?!1:!0},googleHasType:function(a,b){for(var d=0;d<a.length;d++)for(var c=0;c<b.length;c++)if(a[d]===b[c])return!0;return!1},preprocessGoogleRequest:function(a){var b={};b.language=R9.globals.locale.lc;b.address=a.value;this.options.swBounds&&this.options.neBounds&&(b.bounds=new google.maps.LatLngBounds(new google.maps.LatLng(this.options.swBounds.lat,
this.options.swBounds.lon),new google.maps.LatLng(this.options.neBounds.lat,this.options.neBounds.lon)));return b},preprocessNearbyRequest:function(a){var b={};0<a.value.length&&(b.name=a.value);b.types=["airport","restaurant"];this.options.swBounds&&this.options.neBounds&&(b.bounds=new google.maps.LatLngBounds(new google.maps.LatLng(this.options.swBounds.lat,this.options.swBounds.lon),new google.maps.LatLng(this.options.neBounds.lat,this.options.neBounds.lon)));return b}});(function(d,e){d.extend("DatePicker.BuzzData",{});var g={},f=null,h=null,k=d.DatePicker.BuzzData=function(){if(h)return h;h=this;return this};k.prototype={constructor:k,datePicker:null,form:null,vertical:"",update:function(a,c){this.datePicker=a;this.form=c;this.vertical=c.vertical;a=d.config.getBoolean("ui.calendar.buzz.hotels.enabled",!1);c=d.config.getBoolean("ui.calendar.buzz.flights.enabled",!1);a&&"hotels"===this.vertical&&this.updatePickerAccordingData(this.form.cityId,this.updateDatePicker.bind(this));
c&&"flights"===this.vertical&&this.updatePickerAccordingData(this.getFlightUrl(),this.updateDatePicker.bind(this))},fetch:function(a,c){this.form=a;this.vertical=a.vertical;a=d.config.getBoolean("ui.calendar.buzz.hotels.enabled",!1);var b=d.config.getBoolean("ui.calendar.buzz.flights.enabled",!1);a&&"hotels"===this.vertical&&this.updatePickerAccordingData(this.form.cityId,c);b&&"flights"===this.vertical&&this.updatePickerAccordingData(this.getFlightUrl(),c)},getFlightUrl:function(){var a=this.form,
c=this.getAirportCode(a.origin),b=this.getAirportCode(a.destination),a=a.isOneWay,d="";if(this.isEmpty(c))return null;d+=c+"/";return this.isEmpty(b)?null:d+(b+"")+("?oneWay\x3d"+(a?"true":"false"))},isEmpty:function(a){return!a||0===a.length},getAirportCode:function(a){if("undefined"!==typeof a){var c=/(([A-Z]{3}))/g,b=a.substr(0,3);if(""==b||0==b.indexOf("C-"))b=a.value+"",b=b.replace(/ /g,""),-1!=b.indexOf("(")&&(a=c.exec(b),null!=a&&(b=a[0]));return e.trim(b)}return null},updatePickerAccordingData:function(a,
c){if(a){var b=this.getCacheData(a),d=this;null!==b?c(b):(f&&4!==f.readyState&&f.abort(),f=e.ajax({type:"GET",url:"/api/search/buzzCalendar/"+this.vertical+"/"+a,dataType:"json"}).done(function(b){b.success&&(d.putCacheData(a,b),c(b))}))}},getCacheData:function(a){a=this.getKey(a);return g.hasOwnProperty(a)?g[a]:null},putCacheData:function(a,c){a=this.getKey(a);g[a]=c},getKey:function(a){return this.vertical+"_"+a},updateDatePicker:function(a){e(".r9-datepicker-item",this.datePicker).each(function(){var c=
e(this);c.removeClass("buzz-date-low");var b=c.data("val");"undefined"!==typeof b&&(b=moment(b).format("YYYY-MM-DD"),a.dates.hasOwnProperty(b)&&"LOW"===a.dates[b]&&c.addClass("buzz-date-low"))})}}})(window.R9,window.jq||window.jQuery);(function(x){R9.extend("Widgets.BaseCalendarWidget",{});(R9.Widgets.BaseCalendarWidget=function(){this.updateSettings()}).prototype={advanceStyling:!0,loadBuzzData:!1,updateSettings:function(){this.advanceStyling=R9.config.getBoolean("ui.calendar.advanceStyling",!0);this.loadBuzzData=R9.config.getBoolean("ui.calendar.loadBuzzData",!1);this.wholeMonthSearch=!1;jq("body").hasClass("FlightsSearch")&&0<jq(".flexOpenflex").length&&0<jq(".Flights-Search-FlightSearchPage.vm-fd").length&&(this.wholeMonthSearch=
R9.config.getBoolean("ui.flights.whole-month-search.enabled",!1),this.daterangePickerDefaultNavTab="specificDate",this.noOfNightsValue="6-8",this.flexSelectedYear=this.flexSelectedMonth="",this.flexPlusMinusChecked=!1)},buzzGraph:jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-graph"}),buzzGraphFooter:jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-graph-footer"}),buzzGraphFooterInner1:jq("\x3cdiv\x3e",{"class":"noairports hidden"}),buzzGraphFooterInner2:jq("\x3cdiv\x3e",{"class":"duration hidden"}),
buzzGraphFooterInner3:jq("\x3cdiv\x3e",{"class":"fixedstart hidden"}),buzzGraphFooterInner4:jq("\x3cdiv\x3e",{"class":"oneway hidden"}),buzzGraphFooterDetail:jq("\x3cspan\x3e",{"class":"detail"}),buzzGraphPriceRule:jq("\x3cdiv\x3e",{id:"graphpricebar","class":"r9-datepicker-buzz-graph-price"}),buzzGraphLowestPriceRule:jq("\x3cdiv\x3e",{id:"graphlowpricebar","class":"r9-datepicker-buzz-graph-price"}),buzzGraphPriceValue:jq("\x3cdiv\x3e",{id:"graphprice","class":"r9-datepicker-buzz-graph-price-value"}),
makeCalendarHTML:function(a){var b=[];this.options.showBuzzGraph&&(this.buzzGraph.html(this.buzzGraphPriceRule.prop("outerHTML")+this.buzzGraphLowestPriceRule.prop("outerHTML")+this.buzzGraphPriceValue.prop("outerHTML")),this.buzzGraphFooterInner1.html("Select airports to see recent best prices. \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),this.buzzGraphFooterInner2.html("Best prices for \x3cspan id\x3d\"durationNumber\"\x3e\x3c/span\x3e day trips. \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),this.buzzGraphFooterInner3.html("Best prices for trips departing on \x3cspan id\x3d\"flexDepartDate\"\x3e\x3c/span\x3e. \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),
this.buzzGraphFooterInner4.html("Best prices for one-way trips \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),this.buzzGraphFooter.html(this.buzzGraphFooterInner1.prop("outerHTML")+this.buzzGraphFooterInner2.prop("outerHTML")+this.buzzGraphFooterInner3.prop("outerHTML")+this.buzzGraphFooterInner4.prop("outerHTML")));b.push("\x3cdiv class\x3d'r9-datepicker-pointer'\x3e\x3c/div\x3e");b.push(this.makeTitleHTML(this.options.title));this.wholeMonthSearch&&b.push(this.makeCalendarTabNavHTML());var c=moment().startOf("day"),
d=this.minDate,d=d?moment(d):c;a=a?moment(a):d;if(null==a||!this.isPastDateAllowed()&&a<c)a=c;c=moment(a).subtract(1,"months");d=moment(a).add(1,"months");b.push(this.makeMonthCalendarHTML(a,c,"r9-datepicker-month-first",this.options.prevTitle));a.add(1,"months");b.push(this.makeMonthCalendarHTML(a,d,"r9-datepicker-month-last",this.options.nextTitle));b.push("\x3cdiv class\x3d'r9-datepicker-month-break'\x3e\x3c/div\x3e");this.options.showBuzzGraph&&(b.push(this.buzzGraph.prop("outerHTML")),b.push(this.buzzGraphFooter.prop("outerHTML")));
this.wholeMonthSearch&&b.push(this.makeCalendarSelectMonthHTML());return b.join("")},makeTitleHTML:function(a){return'\x3cdiv class\x3d"r9-datepicker-title"\x3e\x3cspan\x3e'+a+'\x3c/span\x3e\x3ca class\x3d"r9-datepicker-title-close"\x3eX\x3c/a\x3e\x3c/div\x3e'},makeCalendarTabNavHTML:function(){var a=jq(document.createElement("div")),b=jq(document.createElement("div")).addClass("CalendarWidget-TabNav"),c=jq(document.createElement("div")).addClass("keel-grid distribute mainGrid"),d=jq(document.createElement("div")).addClass("col-auto leftNavItems"),
f=jq(document.createElement("div")).addClass("col-auto rightNavItems"),l=jq(document.createElement("div")).addClass("keel-grid leftNavItemsGrid"),m=jq(document.createElement("div")).addClass("keel-grid rightNavItemsGrid"),h=jq(document.createElement("div")).addClass("tabWrapper specificDate"),p=jq(document.createElement("div")).addClass("col-auto dateCol"),n=jq(document.createElement("span")).addClass("icon calendar").html('\x3csvg viewBox\x3d"0 0 13 14" xmlns\x3d"http://www.w3.org/2000/svg"\x3e\n    \x3ctitle\x3e\n        Select by specific date\n    \x3c/title\x3e\n    \x3cpath d\x3d"M9.75 1.647h1.247c1.106 0 2.003.888 2.003 1.999v8.356A1.999 1.999 0 0 1 10.997 14H2.003A1.997 1.997 0 0 1 0 12.002V3.646c0-1.104.894-1.999 2.003-1.999H3.25V0h.813v1.647h4.875V0h.812v1.647zm0 .824h1.428c.558 0 1.01.446 1.01 1.007v8.691c0 .557-.446 1.007-1.01 1.007H1.822c-.558 0-1.01-.446-1.01-1.007V3.478c0-.556.446-1.007 1.01-1.007H3.25v.823h.813v-.823h4.875v.823h.812v-.823zM.812 4.94h11.376v.824H.812V4.94zM2.6 6.364h2v2h-2v-2z" fill\x3d"currentColor" fill-rule\x3d"evenodd"/\x3e\n\x3c/svg\x3e\n'),
k=jq(document.createElement("div")).addClass("tabWrapper wholeMonth"),q=jq(document.createElement("div")).addClass("col-auto dateMonth"),v=jq(document.createElement("span")).addClass("icon trend").html('\x3csvg viewBox\x3d"0 0 15 12" xmlns\x3d"http://www.w3.org/2000/svg"\x3e\n    \x3ctitle\x3e\n        trend\n    \x3c/title\x3e\n    \x3cpath d\x3d"M0 12V5h3v7H0zm4 0V0h3v12H4zm4 0V5h3v7H8zm4 0V8h3v4h-3z" fill\x3d"currentColor" fill-rule\x3d"evenodd"/\x3e\n\x3c/svg\x3e\n'),e=jq(document.createElement("div")).addClass("col-auto plusMinus"),
g=jq(document.createElement("span")).addClass("input flexPlusMinus"),t=jq(document.createElement("div")).addClass("tabUnderlay no-transition");"undefined"!==typeof R9.storage&&(null!==R9.storage.get("daterangePickerDefaultNavTab")&&"wholeMonth"!==R9.storage.get("daterangePickerDefaultNavTab")||R9.storage.set("daterangePickerDefaultNavTab","specificDate"),this.daterangePickerDefaultNavTab=R9.storage.get("daterangePickerDefaultNavTab"),null===R9.storage.get("flexPlusMinusChecked")&&R9.storage.set("flexPlusMinusChecked",
!1),this.flexPlusMinusChecked=R9.storage.get("flexPlusMinusChecked"));"wholeMonthSearch"==this.daterangePickerDefaultNavTab?(k.addClass("selected"),t.addClass("wholeMonth"),e.hide()):(h.addClass("selected"),t.addClass("specificDate"));this.flexPlusMinusChecked&&g.addClass("checked");a.append(b.append(c.append(d.append(l.append(p.append(h.text("Date").addClass("v-c-p").prepend(n)),q.append(k.text("Flex Month").prepend(v).append(jq(document.createElement("span")).addClass("newTag").text("new"))))),
f.append(m.append(e.append(jq(document.createElement("div")).addClass("likeTabWrapper").append(g.text("\u00b1 3 days")))))),t));return a.html()},makeCalendarSelectMonthHTML:function(){"undefined"!==typeof R9.storage&&(null===R9.storage.get("flexNoOfNights")&&R9.storage.set("flexNoOfNights","6-8"),this.noOfNightsValue=R9.storage.get("flexNoOfNights"));var a=jq(document.createElement("div")),b=jq(document.createElement("div")).addClass("CalendarWidget-MonthSelect"),c=jq(document.createElement("div")).addClass("keel-grid mainGrid"),
d=jq(document.createElement("div")).addClass("col"),f=jq(document.createElement("div")).addClass("col"),l=jq(document.createElement("div")).addClass("keel-grid keel-form topColGrid"),m=jq(document.createElement("div")).addClass("keel-grid bottomColGrid"),h=jq(document.createElement("div")).addClass("col"),p=jq(document.createElement("div")).addClass("col noOfNightsInputCol"),n=jq(document.createElement("input")).addClass("Common-Widgets-TextInput selectTextOnFocus noOfNightsInput").attr({type:"text",
id:"noOfNightsInput",name:"noOfNightsInput",value:this.noOfNightsValue}),k=jq(document.createElement("label")).addClass("nightsAtDestination").text("nights"),q=jq(document.createElement("div")).addClass("col subTextCol"),v=jq(document.createElement("div")).addClass("col"),e=jq(document.createElement("div")).addClass("keel-grid monthSelectGrid");a.append(b.append(c.append(d.append(l.append(h.text("Number of nights:"),p.append(n,k),q.text("Not sure how long? Use a range, like 10-12 nights."))),f.append(m.append(v.append(e))))));
for(b=0;12>b;b++)"undefined"!==typeof R9.storage&&(null===R9.storage.get("flexSelectedMonth")&&R9.storage.set("flexSelectedMonth",moment().format("M")),null===R9.storage.get("flexSelectedYear")&&R9.storage.set("flexSelectedYear",moment().format("Y")),this.flexSelectedMonth=R9.storage.get("flexSelectedMonth"),this.flexSelectedYear=R9.storage.get("flexSelectedYear")),c=jq(document.createElement("div")).addClass("col-1-3 col-1-4-l centre"),d=jq(document.createElement("div")).addClass("monthWrapper"),
f=moment().add(b,"M").format("M"),l=moment().add(b,"M").daysInMonth(),m=moment().add(b,"M").format("Y"),h=jq(document.createElement("div")).addClass("monthName").text(moment().add(b,"M").format("MMMM")),p=jq(document.createElement("div")).addClass("shortMonthName").text(moment().add(b,"M").format("MMM")),n=jq(document.createElement("div")).addClass("monthYear").text(moment().add(b,"M").format("Y")),this.flexSelectedMonth==f&&this.flexSelectedYear==m&&d.addClass("selected"),e.append(c.append(d.append(h,
p,n).attr("data-month",f).attr("data-year",m).attr("data-end-of-month",l)));return a.html()},makeMonthCalendarHTML:function(a,b,c,d){var f=[];f.push("\x3cdiv class\x3d'r9-datepicker-month "+c+"'\x3e");f.push(this.makeMonthHeaderHTML(a,b,d));f.push(this.makeMonthBodyHTML(a,d));f.push("\x3c/div\x3e");return f.join("")},showMonth:function(a){var b=[];b.push("\x3cspan class\x3d'r9-datepicker-month-name'\x3e");b.push(a.format(this.options.titleMonthFormat).substring(0,1).toUpperCase()+a.format(this.options.titleMonthFormat).substring(1,
this.options.titleMonthFormatLen));b.push("\x3c/span\x3e");return b.join("")},showYearWithSpecialSymbol:function(a){var b=[],c;R9&&R9.globals&&(c=R9.globals.reverseDatePickerMonthAndYear);b.push("\x3cspan class\x3d'r9-datepicker-year'\x3e");b.push(a.format(this.options.titleYearFormat)+c+" ");b.push("\x3c/span\x3e");return b.join("")},showMonthAndYear:function(a){var b=[];b.push(this.showMonth(a));b.push(this.showYearWithSpecialSymbol(a));return b.join("")},makeMonthHeaderHTML:function(a,b,c){var d=
[],f=moment().startOf("month"),l=moment().add(11,"months"),m=moment(b).startOf("month"),h=moment(b).endOf("month"),p=this.maxDate,n=this.minDate,k=this.getStartDate&&moment(this.getStartDate()),q=this.getEndDate&&moment(this.getEndDate()),f=!(k&&h.isBefore(k))&&!(q&&h.isBefore(q))&&(n&&h.isBefore(n)||p&&m.isAfter(p)||!this.isPastDateAllowed()&&h.isBefore(f)||m.isAfter(l));d.push("\x3cspan class\x3d'r9-datepicker-month-header'\x3e");d.push("\x3ca title\x3d'"+c+"' class\x3d'r9-datepicker-switch-month "+
(f?"r9-datepicker-disabled":"r9-datepicker-enabled")+"' data-val\x3d'"+b.valueOf()+"'\x3e");d.push("\x3cspan\x3e");d.push(c);d.push("\x3c/span\x3e");d.push("\x3c/a\x3e");d.push("\x3cspan class\x3d'r9-datepicker-month-title'\x3e");d.push(this.showMonthAndYear(a));d.push("\x3c/span\x3e");d.push("\x3c/span\x3e");return d.join("")},makeMonthBodyHTML:function(a,b){var c=[];c.push("\x3cspan class\x3d'r9-datepicker-month-body'\x3e");c.push(this.makeWeekDaysHTML(a));c.push(this.makeMonthDatesHTML(a,b));c.push("\x3c/span\x3e");
return c.join("")},makeWeekDaysHTML:function(a){a=[];a.push("\x3cspan class\x3d'r9-datepicker-month-days'\x3e");for(i=0+this.getFirstWeekDay();i<7+this.getFirstWeekDay();i++)day=i%7,a.push("\x3cspan class\x3d'r9-datepicker-day'\x3e"),a.push(this.getVeryShortDayName(day)),a.push("\x3c/span\x3e");a.push("\x3c/span\x3e");return a.join("")},makeMonthDatesHTML:function(a,b){var c=[];c.push("\x3cspan class\x3d'r9-datepicker-month-dates'\x3e");var d=this.getMonthLeadDays(a),f=this.getDaysInMonth(a),l=moment().startOf("day"),
m=moment(a).subtract(1,"months").startOf("month"),h=m.daysInMonth(),p=moment(a).add(1,"months").startOf("month"),n=moment(l).add(1,"year"),k=this.maxDate,q,v,e,g,t=this.minDate,w=1;b=b.toLowerCase();this.getStartDate&&this.getStartDate();for(var r=0;42>r;r++){q=r-d+1;g=moment([a.year(),a.month(),q]);v=r%7;e=Math.ceil((r+1)/7);0==v&&c.push("\x3cspan class\x3d'r9-datepicker-month-row "+(this.loadBuzzData?"datepicker-buzz-data":"")+"' aria-label\x3d'Week "+e+"' role\x3d'week'\x3e");if(r<d&&"prev"===
b&&!this.advanceStyling){var u=moment([m.year(),m.month(),h+r-d+1]);e="r9-datepicker-item r9-datepicker-othermonth-item";e=(g.isBefore(l)||g.isAfter(n))&&!this.isPastDateAllowed()||t&&g.isBefore(t)||k&&g.isAfter(k)?e+" r9-datepicker-disabled":e+" r9-datepicker-enabled";this.addGraphBar(!1,u.valueOf());c.push("\x3cspan role\x3d'gridcell' class\x3d'"+e+"' data-val\x3d'"+u.valueOf()+"'\x3e");c.push("\x3cspan\x3e"+(h+r-d+1));this.loadBuzzData&&(c.push("\x3cspan class\x3d'buzz-message'\x3eGreat price\x3c/span\x3e"),
c.push("\x3ci\x3e\x3c/i\x3e"));c.push("\x3c/span\x3e\x3c/span\x3e")}else if(r>=d+f&&"next"===b&&!this.advanceStyling)u=moment([p.year(),p.month(),w]),e="r9-datepicker-othermonth-item r9-datepicker-item",e=(g.isBefore(l)||g.isAfter(n))&&!this.isPastDateAllowed()||t&&g.isBefore(t)||k&&g.isAfter(k)?e+" r9-datepicker-disabled":e+" r9-datepicker-enabled",c.push("\x3cspan role\x3d'gridcell' class\x3d'"+e+"' data-val\x3d'"+u.valueOf()+"'\x3e"),c.push("\x3cspan\x3e"+w++),this.loadBuzzData&&(c.push("\x3cspan class\x3d'buzz-message'\x3eGreat price\x3c/span\x3e"),
c.push("\x3ci\x3e\x3c/i\x3e")),c.push("\x3c/span\x3e\x3c/span\x3e"),this.addGraphBar(!1,u.valueOf());else if(r>=d+f&&("next"!==b||this.advanceStyling))break;else r<d&&("Prev"!==b||this.advanceStyling)?c.push("\x3cspan role\x3d'gridcell' class\x3d'r9-datepicker-item r9-datepicker-disabled'\x3e\x3cspan\x3e\x26nbsp;\x3c/span\x3e\x3c/span\x3e"):(e="r9-datepicker-item",(g.isBefore(l)||g.isAfter(n))&&!this.isPastDateAllowed()||t&&g.isBefore(t)||k&&g.isAfter(k)?(e+=" r9-datepicker-disabled",u=!1):(e+=" r9-datepicker-enabled",
u=!0),g.isSame(l)&&(e+=" r9-datepicker-today"),c.push("\x3cspan role\x3d'gridcell' class\x3d'"+e+"' "),this.addGraphBar(u,g.valueOf()),c.push("data-val\x3d'"+g.valueOf()+"'"),c.push("\x3e\x3cspan\x3e"),c.push(q),this.loadBuzzData&&(c.push("\x3cspan class\x3d'buzz-message'\x3eGreat price\x3c/span\x3e"),c.push("\x3ci\x3e\x3c/i\x3e")),c.push("\x3c/span\x3e\x3c/span\x3e"));if(6==v&&(c.push("\x3c/span\x3e"),q===f||1<w))break}c.push("\x3c/span\x3e");return c.join("")},getFirstWeekDay:function(){return moment().startOf("week").day()},
getVeryShortDayName:function(a){return moment().day(a).format("dd").substring(0,this.options.shortDayNameLen)},getMonthLeadDays:function(a){a=this.getFirstMonthDay(a)-this.getFirstWeekDay();0>a&&(a=6);return a},getFirstMonthDay:function(a){a=moment(a);a.startOf("month");return a.day()},getDaysInMonth:function(a){return a.daysInMonth()},insideLastCalendar:function(a){return!!this.dropdown.find(".r9-datepicker-item-"+a).closest(".r9-datepicker-month").hasClass("r9-datepicker-month-last")},isPastDateAllowed:function(){return"undefined"!=
this.options.allowPastDate?this.options.allowPastDate:!1},addGraphBar:function(a,b){this.options.showBuzzGraph&&(a=jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-day "+(a?"r9-datepicker-enabled":"r9-datepicker-disabled"),"data-val":b}),a.append(jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-bar"})),this.buzzGraph.append(a))}}})(jq||jQuery);(function(f){function r(a,b,c){var d,e,g,f,l,k=Date.now||function(){return(new Date).getTime()},h=function(){var n=k()-f;n<b&&0<=n?d=setTimeout(h,b-n):(d=null,c||(l=a.apply(g,e),d||(g=e=null)))};return function(){g=this;e=arguments;f=k();var n=c&&!d;d||(d=setTimeout(h,b));n&&(l=a.apply(g,e),g=e=null);return l}}R9.extend("Widgets",{DaterangePicker:function(a,b){R9.Widgets.BaseCalendarWidget.apply(this);this.elementNode=a;this.element=f(this.elementNode);this.validateElement()&&(this.startSection=f(R9.Widgets.DaterangePicker.findStartSection(this.elementNode)),
this.startDisplay=f(R9.Widgets.DaterangePicker.findStartDisplay(this.elementNode)),this.startPlaceholderDisplay=f(R9.Widgets.DaterangePicker.findStartPlaceholderDisplay(this.elementNode)),this.endSection=f(R9.Widgets.DaterangePicker.findEndSection(this.elementNode)),this.endDisplay=f(R9.Widgets.DaterangePicker.findEndDisplay(this.elementNode)),this.endPlaceholderDisplay=f(R9.Widgets.DaterangePicker.findEndPlaceholderDisplay(this.elementNode)),this.summaryDisplay=f(R9.Widgets.DaterangePicker.findSummaryDisplay(this.elementNode)),
this.clearDisplay=f(R9.Widgets.DaterangePicker.findClearDisplay(this.elementNode)),this.closeLink=f(R9.Widgets.DaterangePicker.findCloseLink(this.elementNode)),this.tabInput=f(R9.Widgets.DaterangePicker.findTabInput(this.elementNode)),this.startInput=f(R9.Widgets.DaterangePicker.findStartInput(this.elementNode)),this.endInput=f(R9.Widgets.DaterangePicker.findEndInput(this.elementNode)),this.options=f.extend({},this.options,b),this.init())}});R9.extend("Widgets.DaterangePicker",{isDatepicker:function(a){return a&&
a.nodeName&&"div"==a.nodeName.toLowerCase()},isWidgetControlled:function(a){return f(a).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+"-wrapper")},findStartSection:function(a){return f(a).closest("form").find("#"+a.id+"-start")},findStartDisplay:function(a){return f(a).closest("form").find("#"+a.id+"-start-display")},findStartPlaceholderDisplay:function(a){return f(a).closest("form").find("#"+a.id+"-start-placeholder")},findEndSection:function(a){return f(a).closest("form").find("#"+
a.id+"-end")},findEndDisplay:function(a){return f(a).closest("form").find("#"+a.id+"-end-display")},findEndPlaceholderDisplay:function(a){return f(a).closest("form").find("#"+a.id+"-end-placeholder")},findSummaryDisplay:function(a){return f(a).closest("form").find("#"+a.id+"-summary-display")},findClearDisplay:function(a){return f(a).closest("form").find("#"+a.id+"-clear")},findCloseLink:function(a){return f(a).closest("form").find("#"+a.id+" .r9-datepicker-title-close")[0]},findStartInput:function(a){return f(a).closest("form").find("#"+
a.id+" .r9-datepicker-input.r9-datepicker-start")[0]},findEndInput:function(a){return f(a).closest("form").find("#"+a.id+" .r9-datepicker-input.r9-datepicker-end")[0]},findTabInput:function(a){return f(a).closest("form").find("#"+a.id+"-tab")},getDropdownId:function(a){return"datepicker"},getDropdownEl:function(a){return jq(a).find("#datepicker")}});R9.extend("Widgets.DaterangePicker.prototype",!0,R9.Widgets.BaseCalendarWidget.prototype,{widgetName:"datepicker",widgetId:"datepicker",widgetBaseClass:"r9-datepicker",
accessibilityBreakpoint:768,elementNode:null,element:null,startSection:null,startDisplay:null,startPlaceholderDisplay:null,endSection:null,endDisplay:null,endPlaceholderDisplay:null,summaryDisplay:null,clearDisplay:null,closeLink:null,startInput:null,endInput:null,tabInput:null,clicks:[],timers:null,unitFormat:null,unitAdjustment:0,preventBlur:!1,actOnStart:!0,buzzCall:!1,options:{accessible:!0,appendTo:"body",dateItemsSelector:"span.r9-datepicker-item",shortDayNameLen:1,title:"Prev",prevTitle:"Prev",
nextTitle:"Next",offsetWidth:0,titleMonthFormat:"MMMM",titleYearFormat:"YYYY",startFormat:"ddd MMM D",startInputFormat:"YYYY/M/D",endFormat:"ddd MMM D",endInputFormat:"YYYY/M/D",nightsFormat:"0#same day|1#{0} night|2#{0} nights",daysFormat:"0#same day|1#{0} day|2#{0} days",useDaysFormat:!1,secondClickHideDelay:200,minRangeDays:0,change:null,show:null,hide:null,minDateFunc:null,focusAfterClick:!0,allowPastDate:!1,widgetId:null,useLongDisplayFormat:!1,singlePickerWithSingleField:!1,showBuzzGraph:!1,
originControl:!1,destControl:!1,isOneWay:!1,skipForceSetDefaultStartOnFocusBlur:!1,skipForceSetDefaultEndOnFocusBlur:!1,doNotFillWhenEmpty:!1,datepickerWrapperSelector:".r9-datepicker-wrapper",handleNegativeSummary:!0},getWidgetId:function(){this.options&&this.options.widgetId&&(this.widgetId=this.options.widgetId);return this.widgetId},getDropdownId:function(a){return this.options&&this.options.widgetId?this.options.widgetId:R9.Widgets.DaterangePicker.getDropdownId(a)},getDropdownEl:function(a){return this.options&&
this.options.widgetId?jq(a).find("#"+this.options.widgetId):R9.Widgets.DaterangePicker.getDropdownEl(a)},init:function(){this.options.useDaysFormat?(this.unitFormat=this.options.daysFormat,this.unitAdjustment=1):(this.unitFormat=this.options.nightsFormat,this.unitAdjustment=0);this.options.useLongDisplayFormat&&(this.options.startFormat=this.options.startInputFormat,this.options.endFormat=this.options.endInputFormat);this.advanceStyling&&(this.options.skipForceSetDefaultStartOnFocusBlur=!0,this.options.skipForceSetDefaultEndOnFocusBlur=
!0,this.options.doNotFillWhenEmpty=!0);this.options.offsetWidth=2;this.initDropdown();this.timers={};this.bindEvent(this.tabInput,"focus",this.handleInputFocusEvent);this.bindEvent(this.tabInput,"blur",this.handleInputBlurEvent);this.bindEvent(this.tabInput,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.element,"mousedown",this.handleElementClickEvent);this.endStartIsSameField()||this.bindEvent(this.endSection,"mousedown",this.handleEndClickEvent);this.bindEvent(this.startSection,"mousedown",
this.handleStartClickEvent);this.bindEvent(this.clearDisplay,"mousedown",this.handleClearClickEvent);this.bindEvent(this.closeLink,"mousedown",this.handleClearClickEvent);this.bindEvent(this.dropdown,"mousedown",this.handleDropdownClickEvent);this.bindEvent(this.overlay,"mousedown",this.handleItemClickEvent);this.element.data(this.widgetName,this);this.update();var a=this.element.find(".r9-datepicker-display");void 0!==a&&1<a.length||(this.element.off("mousedown focus").on("mousedown focus",function(a){a.preventDefault();
a.stopPropagation();jq(this).find(".r9-datepicker-display").focus();jq("body").trigger("event",[a])}),this.bindCommandUtilities(),this.start_custom_value=this.end_custom_value="",this.utils=this.options.commands.utilities,this.today=moment().startOf("day").toDate(),this.bindAccessibilityEvents(),this.updateClicks(),this.updateDOM())},validateElement:function(){return R9.Widgets.DaterangePicker.isDatepicker(this.elementNode)&&R9.Widgets.DaterangePicker.isWidgetControlled(this.elementNode)&&void 0===
this.element.data(this.widgetName)},bindEvent:function(a,b,c){var d=this;b+="."+this.getWidgetId();a.off(b).on(b,function(a){return c.call(d,this,a)})},bindCommandUtilities:function(){var a=this;this.options.commands={keys:{TAB:9,ENTER:13,UP:38,DOWN:40,LEFT:37,RIGHT:39,DOLLAR:52,CARAT:54,ESC:27},utilities:{changeCalendar:function(b,c){c=c||1;var d=a.dropdown.find(".r9-datepicker-switch-month.r9-datepicker-enabled"),d="prev"===b?d.first():d.last();for(b=Math.abs(c);0<b;b--)a.handleNextPrevClickEvent(d);
return a},isCharacterKeyPress:function(b){var c=a.options.commands.keys;return"undefined"==typeof b.which?!0:"number"==typeof b.which&&0<b.which?!b.ctrlKey&&!b.metaKey&&!b.altKey&&b.keyCode!=c.TAB&&b.keyCode!=c.ENTER&&16!=b.keyCode&&b.keyCode!=c.UP&&b.keyCode!=c.DOWN&&b.keyCode!=c.LEFT&&b.keyCode!=c.RIGHT:!1},getRowInfo:function(b){b=a.dropdown.find(".r9-datepicker-item-"+b);var c=b.parent().children().not(".r9-datepicker-disabled");return{len:c.length-1,index:c.index(b)}},isValidDateObject:function(a){return a instanceof
Date?!isNaN(a.getTime()):this.isValidDate(new Date(a))},isValidDatePair:function(a,c){return moment(a).isBefore(moment(c))},isValidDate:function(b){return this.isValidDateObject(b)&&(this.isValidDatePair(moment().subtract(1,"d"),moment(b))||a.isPastDateAllowed())},applyEndVal:function(){if(""!==a.end_custom_value&&moment(a.end_custom_value,a.options.endInputFormat).isValid()){var b=this.formatLocaleDate(a.end_custom_value,a.options.endInputFormat);if(b&&this.isValidDate(b)){var c=a.getStartDate()||
a.today;this.isValidDatePair(c,b)&&a.setEndDate(b);a.fetchBuzzData();a.options.change&&a.options.change.call(a);a.end_custom_value=""}}},applyStartVal:function(){if(""!==a.start_custom_value&&moment(a.start_custom_value,a.options.startInputFormat).isValid()){var b=this.formatLocaleDate(a.start_custom_value,a.options.startInputFormat);if(b&&this.isValidDate(b)){a.setStartDate(b);var c=a.getEndDate()||a.today;this.isValidDatePair(b,c)||a.setEndDate(b);a.start_custom_value="";a.fetchBuzzData();a.options.change&&
a.options.change.call(a)}}},validate:function(b){b=b||moment().startOf("day").toDate();return!a.isPastDateAllowed()&&b.getTime()<=a.today.getTime()?a.today:b},formatLocaleDate:function(b,c){c=c||a.options.startInputFormat;try{var d=b.split(/\D+/g)[2];4!==d.length&&(b=b.substr(0,b.length-2)+"20"+d);return moment(b,c).toDate()}catch(e){return new Date}},incrementDay:function(b,c,d){d=d||jq.noop;b=moment(b).add(c||1,"days");d.call(a,this.validate(b.toDate()));return b},decrementDay:function(b,c,d){d=
d||jq.noop;b=moment(b).subtract(c||1,"days");d.call(a,this.validate(b.toDate()));return b},dateDiff:function(a,c){return(a.getTime()-c.getTime())/864E5}}};this.utils=this.options.commands.utilities;return this},bindAccessibilityEvents:function(){var a=this;this.options.accessible="true"===jq(this.startDisplay).attr("contenteditable");jq(this.startDisplay).attr({"aria-label":this.options.startLabel||"Start Date"});jq(this.endDisplay).attr({"aria-label":this.options.endLabel||"End Date"});this.clickTarget=
this.blurTarget=null;jq(document).mousedown(function(b){a.clickTarget=jq(b.target);a.isDropdownVisible()&&jq(a.blurTarget).blur()}).mouseup(function(b){a.clickTarget=null});this.endStartIsSameField()||(this.bindEvent(this.endDisplay,"focus",this.handleEndDisplayFocusEvent),this.bindEvent(this.endDisplay,"blur",this.handleEndDisplayBlurEvent),this.bindEvent(this.endDisplay,"keydown",this.handleEndDisplayKeydownEvent),this.bindEvent(this.endDisplay,"keyup",this.handleEndDisplayKeyupEvent));this.bindEvent(this.startDisplay,
"focus",this.handleStartDisplayFocusEvent);this.bindEvent(this.startDisplay,"blur",this.handleStartDisplayBlurEvent);this.bindEvent(this.startDisplay,"keydown",this.handleStartDisplayKeydownEvent);this.bindEvent(this.startDisplay,"keyup",this.handleStartDisplayKeyupEvent)},handleClearClickEvent:function(a,b){this.clearDaterange();b.stopPropagation();this.fetchBuzzData();this.options.change&&this.options.change.apply(this,arguments);jq("body").trigger("event",[b]);return!this.element.hasClass("r9-datepicker-focus")},
handleElementClickEvent:function(a,b){return this.isDropdownVisible()?this.handleClickEvent(a,b,this.actOnStart):this.handleStartClickEvent(a,b)},handleStartClickEvent:function(a,b){return this.handleClickEvent(a,b,!0)},handleEndClickEvent:function(a,b){return this.handleClickEvent(a,b,!1)},handleClickEvent:function(a,b,c){this.actOnStart=c;var d=this.getWrapperElement(),e=this;!this.isDropdownVisible()&&this.options.focusAfterClick?setTimeout(function(){e.isDropdownVisible()||d.find(".r9-datepicker-tab").focus()},
1):(this.markDropdownElements(),this.preventBlur=!0);b.stopPropagation();jq("body").trigger("event",[b]);return!0},getWrapperElement:function(){return this.element},getStartWrapperElement:function(){return this.element},getEndWrapperElement:function(){return this.element},handleDropdownClickEvent:function(a,b){return!1},handleInputKeydownEvent:function(a,b){if(!a.disabled){var c=b.keyCode?b.keyCode:b.which,d=jq(a).parent();switch(c){case 9:return!0;case 27:this.isDropdownVisible()&&this.hideDropdown(d);
break;case 32:this.isDropdownVisible()?this.hideDropdown(d):(this.actOnStart=!0,this.showDropdown(d));break;case 8:this.clearDaterange(),this.fetchBuzzData(),this.options.change&&this.options.change.apply(this,arguments)}return!1}},handleInputFocusEvent:function(a,b){if(!a.disabled){this.preventBlur=!1;var c=jq(a).parent();jq(".r9-datepicker-focus").removeClass("r9-datepicker-focus");c.addClass("r9-datepicker-focus");this.isDropdownVisible()||this.showDropdown(c);this.options.focus&&this.options.focus.apply(this,
arguments)}},handleInputBlurEvent:function(a,b){if(this.preventBlur)return this.preventBlur=!1,setTimeout(function(){a.focus()},1),!1;if(a.disabled)return!0;this.hideDropdown(jq(a).parent());this.options.blur&&this.options.blur.apply(this,arguments);return!0},handleItemHoverEvent:function(a,b){a=jq(a);a.hasClass("r9-datepicker-enabled")&&this.updateDropdownSelection(a);jq(".r9-datepicker-buzz-day[data-val\x3d%s]".format(a.attr("data-val"))).addClass("hover");return!1},handleItemHoverEndEvent:function(a,
b){this.updateDropdownSelection(null);jq(".r9-datepicker-buzz-day[data-val\x3d%s]".format(jq(a).attr("data-val"))).removeClass("hover");return!1},handleItemClickEvent:function(a,b){if(!0===this.isBeforeStart(a)&&!1===this.actOnStart)return this.preventBlur=!0,b.preventDefault(),this;var c=this,d=jq(a),e,g;if(d.hasClass("r9-datepicker-enabled")){e=parseInt(d.attr("data-val"));var f=this.actOnStart;g=f?1:0;this.clicks[f?0:1]=e;this.clicks[0]&&this.clicks[1]&&(d=moment(this.clicks[1]).diff(this.clicks[0],
"days"),d<this.options.minRangeDays&&(this.clicks[g]=0));this.updateDropdownSelection(null);this.clicks[0]&&this.clicks[1]?setTimeout(function(){c.hideDropdown(c.element);c.options.change&&c.options.change.apply(c,[e,f]);c.options.nextFieldSelector&&jq(c.options.nextFieldSelector).focus()},this.options.secondClickHideDelay):this.switchActOn()}this.updateDOM();jq(a).trigger("daterangepicker.itemclicked");jq("body").trigger("event",[b]);return!1},switchActOn:function(){this.actOnStart=!this.actOnStart;
this.markDropdownElements()},computeHighlitedRange:function(a){var b=[this.clicks[0],this.clicks[1]];return b[0]&&b[1]?b:b=0==a?[0,0]:this.actOnStart?[a,this.clicks[1]]:this.clicks[0]?[this.clicks[0],a]:[0,0]},computeItemState:function(a,b,c,d,e){var g=!1;this.advanceStyling||(a==b?this.actOnStart?(d.hover=!0,d.start=!0):(d.hover=!0,d.end=!0,d.highlighted=e&&e.highlighted):(d.beforeStart=a<this.clicks[0]&&!this.actOnStart,a==this.clicks[0]?(d.start=!0,d.selected=!0):a==this.clicks[1]&&(d.selected=
!0,d.end=!0,d.highlighted=e&&e.highlighted,e&&e.selected&&(d.tight=!0,g=e.tight=!0)),a>c[0]&&a<c[1]&&(d.highlighted=!0,e&&e.start&&(g=e.highlighted=!0))));this.advanceStyling&&(delete d.beforeStart,delete d.hover,a>c[0]&&a<c[1]&&(d.highlighted=!0),a===this.clicks[0]&&(d.start=!0,d.selected=!0),a===this.clicks[1]&&(d.selected=!0,d.end=!0),0<b&&(c=this.getStateStartPoint(b),(this.actOnStart&&c===this.clicks[0]||!this.actOnStart&&c===this.clicks[1])&&c&&(e=Math.max(c,b),a>Math.min(c,b)&&a<e&&(d.tempHighlight=
!0))));return g},getStateStartPoint:function(a){var b=[],c=!0,d=!0,e=this.clicks[0];0<e&&(c=c&&e<a,d=d&&e>a,b.push(e));e=this.clicks[1];0<e&&(c=c&&e<a,d=d&&e>a,b.push(e));a=c?Math.max.apply(null,b):Math.min.apply(null,b);c=!(!1===d&&!1===c);return isFinite(a)?c?a:0:null},updateItem:function(a,b){var c,d;c=[];d=[];b.highlighted?c.push("r9-datepicker-item-highlighted"):d.push("r9-datepicker-item-highlighted");b.hover?c.push("r9-datepicker-item-hover"):d.push("r9-datepicker-item-hover");b.selected?(c.push("r9-datepicker-item-selected"),
a.attr("aria-selected",!0)):(d.push("r9-datepicker-item-selected"),a.attr("aria-selected",!1));b.start?c.push("r9-datepicker-item-start"):d.push("r9-datepicker-item-start");b.beforeStart?c.push("r9-datepicker-before-start"):d.push("r9-datepicker-before-start");b.end?c.push("r9-datepicker-item-end"):d.push("r9-datepicker-item-end");b.tight?c.push("r9-datepicker-item-tight"):d.push("r9-datepicker-item-tight");this.advanceStyling&&(b.tempHighlight?c.push("r9-datepicker-item-tempHighlight"):d.push("r9-datepicker-item-tempHighlight"));
a.removeClass(d.join(" "));a.addClass(c.join(" "))},updateDropdownSelection:function(a){if(!this.advanceStyling&&!0===this.isBeforeStart(a)&&!1===this.actOnStart)return this;var b=this,c=[0,0],d=null,e=null,g=this.dropdown.find(this.options.dateItemsSelector),f=0;a&&(f=parseInt(jq(a).attr("data-val")));c=this.computeHighlitedRange(f);g.each(function(a,g){g=jq(g);a=parseInt(g.attr("data-val"));var h={};b.computeItemState(a,f,c,h,e)&&b.updateItem(d,e);b.updateItem(g,h);d=g;e=h});this.updateHoverDOM(a)},
clearDaterange:function(a){"undefined"!=typeof a?this.clicks[a]=0:this.clicks=[0,0];this.isDropdownVisible()&&this.updateDropdownSelection();this.updateDOM()},updateHoverDOM:function(a){var b,c,d,e;c=this.clicks[0];d=this.clicks[1];a&&(b=parseInt(a.attr("data-val")),this.actOnStart?c=b:d=b);c?(e=moment(c),this.startDisplay.text(e.format(this.options.startFormat)),this.getStartWrapperElement().removeClass("r9-datepicker-start-empty")):this.getStartWrapperElement().addClass("r9-datepicker-start-empty");
d?(b=moment(d),this.endDisplay.text(b.format(this.options.endFormat)),this.summaryDisplay&&(e=b.diff(e,"days"),(b=this.options.handleNegativeSummary&&0>e)&&a&&this.actOnStart?(this.endDisplay.text(this.endPlaceholderDisplay.text()),this.summaryDisplay.text("")):b||this.summaryDisplay.text(R9.Common.Utils.String.formatChoice(this.unitFormat,e+this.unitAdjustment,e+this.unitAdjustment))),this.getEndWrapperElement().removeClass("r9-datepicker-end-empty")):this.getEndWrapperElement().addClass("r9-datepicker-end-empty")},
updateDOM:function(){var a,b,c;if(0!=this.clicks[0]){if(a=moment(this.clicks[0]),this.startDisplay.text(a.format(this.options.startFormat)),this.startInput.val(a.format(this.options.startInputFormat)),this.wholeMonthSearch){var d,e;"wholeMonthSearch"==("undefined"!==typeof R9.storage.get("daterangePickerDefaultNavTab")?R9.storage.get("daterangePickerDefaultNavTab"):"specificDate")&&jq(".searchform.rtow").hasClass("roundtrip")&&("undefined"!==typeof R9.storage&&(null===R9.storage.get("flexSelectedMonth")&&
R9.storage.set("flexSelectedMonth",moment(this.clicks[0]).format("M")),null===R9.storage.get("flexSelectedYear")&&R9.storage.set("flexSelectedYear",moment(this.clicks[0]).format("Y")),null===R9.storage.get("flexNoOfNights")&&R9.storage.set("flexNoOfNights","6-8"),d=R9.storage.get("flexSelectedMonth"),e=R9.storage.get("flexSelectedYear"),c=R9.storage.get("flexNoOfNights")),a=moment(new Date(e,d-1,1)),a.isBefore(moment())&&(a=moment().add(1,"d")),d="string"===typeof c?c.replace("-"," to "):c,c=1==c?
"night":"nights",this.startDisplay.text(a.format("MMMM")+" "+a.format("Y")+", "+d+" "+c),this.startInput.val(a.format(this.options.startInputFormat)))}}else this.startDisplay.text(""),this.startInput.val("");this.endStartIsSameField()||(0!=this.clicks[1]?(b=moment(this.clicks[1]),this.endDisplay.text(b.format(this.options.endFormat)),this.endInput.val(b.format(this.options.endInputFormat))):(this.endDisplay.text(""),this.endInput.val("")));this.summaryDisplay&&(null!=a&&null!=b?(c=b.diff(a,"days"),
this.summaryDisplay.text(R9.Common.Utils.String.formatChoice(this.unitFormat,c+this.unitAdjustment,c+this.unitAdjustment))):this.summaryDisplay.text(""));null==a?this.getStartWrapperElement().addClass("r9-datepicker-start-empty"):this.getStartWrapperElement().removeClass("r9-datepicker-start-empty");this.endStartIsSameField()||(null==b?this.getEndWrapperElement().addClass("r9-datepicker-end-empty"):this.getEndWrapperElement().removeClass("r9-datepicker-end-empty"))},endStartIsSameField:function(){var a=
this.getStartWrapperElement().get(0).id,b=this.getEndWrapperElement().get(0).id;return a===b&&!0===this.options.singlePickerWithSingleField},updateClicks:function(){this.clicks=[0,0];var a;this.startInput.val()&&(a=moment(this.startInput.val(),this.options.startInputFormat),null!=a&&(this.clicks[0]=a.valueOf()));this.endInput.val()&&(a=moment(this.endInput.val(),this.options.endInputFormat),null!=a&&(this.clicks[1]=a.valueOf()))},handleNextPrevClickEvent:function(a,b){a=moment(parseInt(jq(a).attr("data-val")));
this.dropdown[0].innerHTML=this.makeCalendarHTML(a);this.options.showBuzzGraph&&(this.bindBuzzGraphEvents(),this.displayBuzzGraph());this.updateDropdownSelection(null);this.loadBuzzData&&this.displayBuzzData();return!1},bindItemEvent:function(a,b){var c=this;this.dropdown.off(a,this.options.dateItemsSelector).on(a,this.options.dateItemsSelector,function(a){return b.call(c,this,a)})},bindOverlayEvent:function(a,b){var c=this;this.overlay.off(a).on(a,function(a){return b.call(c,this,a)})},bindNextPrevEvent:function(a,
b){var c=this;this.dropdown.off(a,".r9-datepicker-switch-month.r9-datepicker-enabled").on(a,".r9-datepicker-switch-month.r9-datepicker-enabled",function(a){return b.call(c,this,a)})},initDropdown:function(){var a=this.getDropdownId(this.element),b=this.getDropdownEl(this.element).get(0);if(null==b){var c=R9.Widgets.DaterangePicker.prototype.widgetBaseClass;this.options.dropdownClass&&(c=c+" "+this.options.dropdownClass);b=jq("\x3cdiv\x3e\x3c/div\x3e",{id:a,css:{display:"none",position:"absolute",
zIndex:10009}}).appendTo(this.options.appendTo)[0];jq(b).addClass(c);this.advanceStyling&&jq(b).addClass("r9-advance-styling");this.wholeMonthSearch&&jq(b).addClass("CalendarWidget-WholeMonthSearch")}this.dropdown=jq(b);this.overlay=jq("#"+this.widgetBaseClass+"-overlay");this.overlay.length||(this.overlay=jq('\x3cdiv id\x3d"'+this.widgetBaseClass+'-overlay" class\x3d"'+this.widgetBaseClass+'-overlay"\x3e\x3c/div\x3e').appendTo(this.options.appendTo))},debounceChangeFn:function(){this._debouncedChange&&
this._debouncedChange.apply(this,arguments);this._debouncedChange=r(this.options.change||function(){},20);this._debouncedChange.apply(this,arguments)},isDropdownVisible:function(){return"none"!=this.dropdown.css("display")},markDropdownElements:function(){this.unmarkDropdownElements();this.element.addClass("r9-datepicker-dropdown");this.actOnStart?this.element.addClass("r9-datepicker-dropdown-start"):this.element.addClass("r9-datepicker-dropdown-end")},unmarkDropdownElements:function(){this.element.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-start r9-datepicker-dropdown-end")},
positionDropdown:function(a){var b=a.offset(),c=jq(this.options.appendTo).offset(),d=this.dropdown[0].style;jq("#datepicker").removeClass("r9-datepicker-responsive-right-position");if(606>jq(window).width()&&jq(".fdSearchForm-hotel").length&&jq("#travel_dates-end-wrapper").hasClass("r9-datepicker-focus")){jq("#datepicker").addClass("r9-datepicker-responsive-right-position");var e=b.left-c.left-144}else{var e=b.left-c.left,g=e+this.dropdown.outerWidth();g>window.innerWidth&&(g-=window.innerWidth,e=
e-g-15,this.dropdown.find(".r9-datepicker-pointer").css("left",g+36+"px"))}d.left=e+"px";d.top=b.top+a.outerHeight()-c.top+"px"},_hideDropdown:function(a){if("none"==this.dropdown.css("display")||null!=a&&this.dropdown.prop("data-owner")!=a.attr("id"))return!1;null!=a&&a.removeClass("r9-datepicker-focus");jq(".r9-datepicker-focus").removeClass("r9-datepicker-focus");this.options.hide&&this.options.hide.apply(this,arguments);this.hideOverlay();this.preventBlur=!1;this.updateDOM();this.unmarkDropdownElements();
this.dropdown.hide();this.actOnStart=!0;jq(window).unbind("resize",this.resizeHandler);return!0},hideDropdown:function(a){var b=this;null!=a&&a.removeClass("r9-datepicker-focus");if("none"==this.dropdown.css("display")||null!=a&&this.dropdown.prop("data-owner")!=a.attr("id")||this.preventBlur)return this.preventBlur=!1;jq(".r9-datepicker-focus").removeClass("r9-datepicker-focus");this.options.hide&&this.options.hide.apply(this,arguments);this.preventBlur=!1;this.updateDOM();this.unmarkDropdownElements();
this.actOnStart=!0;this.hideTimeout=setTimeout(function(){b._hideDropdown.call(b,a)},100)},hideMultipleDropdowns:function(){this.options.datepickerWrapperSelector&&jq(this.options.datepickerWrapperSelector).not(this.getStartWrapperElement()).not(this.getEndWrapperElement()).each(function(a,b){jq(b).daterangePickerTwoFields("hideDropdown")})},showDropdown:function(a){this.hideTimeout&&clearTimeout(this.hideTimeout);this.options.show&&this.options.show.apply(this,arguments);this.hideMultipleDropdowns();
this.showOverlay();this.markDropdownElements();this.updateClicks();"function"===typeof this.options.minDateFunc&&this.options.minDateFunc(this);this.dropdown[0].innerHTML=this.makeCalendarHTML(!this.actOnStart&&this.clicks[1]?this.clicks[1]:this.clicks[0]);this.updateDropdownSelection(null);var b=R9.Widgets.DaterangePicker.prototype.widgetBaseClass;this.options.dropdownClass&&(b=b+" "+this.options.dropdownClass);jq(a).addClass("r9-datepicker-focus");this.dropdown.addClass(b);b=this.dropdown[0].style;
this.positionDropdown(a);var c=this,d=jq(window).width();this.resizeHandler=function(){var b=jq(window).width();10<Math.abs(b-d)&&(d=b,c.positionDropdown(a))};jq(window).on("resize",this.resizeHandler);this.bindItemEvent("mousedown",this.handleItemClickEvent);if(R9.globals.isTouch){var e=this;this.bindOverlayEvent("mousedown",function(){e.hideDropdown(e.element)})}else this.bindItemEvent("mouseover",this.handleItemHoverEvent),this.bindItemEvent("mouseout",this.handleItemHoverEndEvent);this.options.showBuzzGraph&&
(this.bindBuzzGraphEvents(),this.displayBuzzGraph());this.bindNextPrevEvent("mousedown",this.handleNextPrevClickEvent);this.dropdown.prop("data-owner",a.attr("id"));this.loadBuzzData&&this.displayBuzzData();b.display="inline"},showOverlay:function(){this.overlay.show()},displayBuzzData:function(){"function"===typeof this.options.getFormData&&(new R9.DatePicker.BuzzData).update(this.dropdown,this.options.getFormData())},hideOverlay:function(){this.overlay.hide()},handleJQueryOnChangeHookForIE:function(a,
b,c){if(!f.support.changeBubbles&&"object"==typeof c){var d=c.originalEvent||null;if(d&&null!=d.type&&(d.type.match(/(^|\.)click(\.|$)/)&&d.srcElement==b||"beforeactivate"==d.type||"beforedeactivate"==d.type))return c.type=d.type,f(a).trigger(c),jq("body").trigger("event",[c]),!0}return!1},getStartDate:function(){this.updateClicks();return 0!=this.clicks[0]?new Date(this.clicks[0]):null},getEndDate:function(){this.updateClicks();return 0!=this.clicks[1]?new Date(this.clicks[1]):null},parseDateString:function(a,
b){try{return moment(a,b||this.options.startInputFormat)._d}catch(c){return""}},setFocusAfterClick:function(a){this.options.focusAfterClick=a},setStartDate:function(a){a?("string"===typeof a?a=this.parseDateString(a,this.options.startInputFormat):"number"===typeof a?a=new Date(a):"object"===typeof a?moment.isMoment(a)?a.isValid()&&(a=a.toDate()):moment(a).isValid()&&(a="toDate"in a?a.toDate():a):a=new Date(0),void 0!=a.getTime&&(this.clicks[0]=a.getTime())):this.clicks[0]=0;this.updateDOM()},setEndDate:function(a){a?
("string"===typeof a?a=this.parseDateString(a,this.options.endInputFormat):"number"===typeof a?a=new Date(a):"object"===typeof a?moment.isMoment(a)?a.isValid()&&(a=a.toDate()):moment(a).isValid()&&(a="toDate"in a?a.toDate():a):a=new Date(0),void 0!=a.getTime&&(this.clicks[1]=a.getTime())):this.clicks[1]=0;this.updateDOM()},setUseDaysFormat:function(a){this.options.useDaysFormat=a;this.options.useDaysFormat?(this.unitFormat=this.options.daysFormat,this.unitAdjustment=1):(this.unitFormat=this.options.nightsFormat,
this.unitAdjustment=0)},update:function(){this.updateClicks();this.updateDOM()},isBeforeStart:function(a){a instanceof jq&&(a=jq(a).attr("data-val"));return a&&null!==this.getStartDate()&&moment(parseInt(a)).isBefore(this.getStartDate())?!0:!1},decrementEndDay:function(a){var b=this.insideLastCalendar("end"),c=this.getEndDate()||this.today,d=this.getStartDate()||this.today;a=this.utils.decrementDay(c,a);a.date()!==a.daysInMonth()||b||this.prevCalendar();d&&moment(c)>moment(d)&&this.setEndDate(a.toDate());
this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getEndDate()},decrementStartDay:function(a){var b=this.insideLastCalendar("start");a=this.utils.decrementDay(this.utils.validate(this.getStartDate()),a,this.setStartDate);a.date()!==a.daysInMonth()||b||this.prevCalendar();this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getEndDate()},incrementEndDay:function(a){var b=this.insideLastCalendar("end"),c=this.getEndDate();a=this.utils.incrementDay(c||
this.today,a,this.setEndDate);1<=a.date()&&a.month()!==c.getMonth()&&b&&this.nextCalendar();this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getEndDate()},incrementStartDay:function(a){var b=this.insideLastCalendar("start"),c=this.getStartDate()||this.today,d=this.getEndDate();1===this.utils.incrementDay(c,a,this.setStartDate).date()&&b&&this.nextCalendar();(!d||moment(c)>=moment(d))&&this.setEndDate(this.getStartDate());this.fetchBuzzData();this.debounceChangeFn();
this.updateDropdownSelection();return this.getStartDate()},handleStartDisplayFocusEvent:function(a,b){var c="",d=this.getStartWrapperElement(),e=this;this.markDropdownElements();jq(".r9-datepicker-focus").removeClass("r9-datepicker-focus");jq(d).addClass("r9-datepicker-focus");var g=jq(a);g.text()||!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today);null!==(startdate=this.getStartDate())&&(c=jq(this.startInput).val()||moment(startdate).format(this.options.startInputFormat));
this.actOnStart=!0;this.hideDropdown(this.getEndWrapperElement());this.showDropdown(d);this.options.accessible&&setTimeout(function(){g.text(c);e.selectDisplayBox(a)},1);b.stopPropagation();b.stopImmediatePropagation();jq("body").trigger("event",[b]);return this},handleStartDisplayBlurEvent:function(a,b){if(null!==this.clickTarget&&0<this.clickTarget.closest(".r9-datepicker").length)this.blurTarget=a;else{var c=this.getStartWrapperElement(),d=this.getStartDate();this.hideDropdown(c);jq(c).removeClass("r9-datepicker-focus");
a=jq(a);""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setStartDate(null),this.options.change&&this.options.change.apply(this,arguments));""===a.text()&&null===d?!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today):""!==this.start_custom_value&&this.utils.applyStartVal();this.updateDropdownSelection();this.updateClicks();return this}},callNTimes:function(a,b){for(var c=0;c<b;c++)a.call(this)},handleStartDisplayKeydownEvent:function(a,b){var c=b.keyCode||
b.which,d=this.options.commands.keys,e=jq(this.endDisplay);a=jq(a);var g=0!==e.length&&!e.is(":hidden");if((c===d.TAB&&g||c===d.ENTER)&&!b.shiftKey){!1===e.is(":hidden")&&(g=f(".gridCellFlexDepartPlusMinus").first(),0===g.length||"hidden"===g.css("visibility")?(b.preventDefault(),b.stopPropagation(),setTimeout(function(){e.focus()},1)):0<g.length&&g.find("select").focus());if(c===d.ENTER&&e.is(":hidden"))return a.closest("form").find("[type\x3dsubmit]").trigger("click"),b.preventDefault(),b.stopPropagation(),
!1;this.utils.applyStartVal();this.updateDropdownSelection();return!1}a=this.options.commands.keys;switch(c){case a.UP:this.callNTimes(this.decrementStartDay,7);b.preventDefault();b.stopPropagation();break;case a.RIGHT:this.incrementStartDay();b.preventDefault();b.stopPropagation();break;case a.LEFT:this.decrementStartDay();b.preventDefault();b.stopPropagation();break;case a.DOWN:this.callNTimes(this.incrementStartDay,7);b.preventDefault();b.stopPropagation();break;case a.ESC:this.isDropdownVisible()&&
this.hideDropdown(this.getStartWrapperElement())}this.vim(b,"start");jq("body").trigger("event",[b]);return this},handleEndDisplayFocusEvent:function(a,b){var c="",d=this.getEndWrapperElement(),e=this;e.markDropdownElements();jq(".r9-datepicker-focus").removeClass("r9-datepicker-focus");jq(d).addClass("r9-datepicker-focus");var g=jq(a),f=e.clicks[0]||e.today.getTime();(!g.text()||e.clicks[1]<=f)&&!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&e.setEndDate(moment(f).toDate());null!==(enddate=
e.getEndDate())&&(c=jq(e.endInput).val()||moment(enddate).format(e.options.endInputFormat));e.actOnStart=!1;e.showDropdown(d);e.options.accessible&&(jq(e.endDisplay).attr("contenteditable","true"),setTimeout(function(){g.text(c);e.selectDisplayBox(a)},1));b.stopPropagation();b.stopImmediatePropagation();jq("body").trigger("event",[b]);return this},handleEndDisplayBlurEvent:function(a,b){var c=this.getEndWrapperElement();this.options.accessible&&jq(this.endDisplay).attr("contenteditable","false");
if(null!==this.clickTarget&&0<this.clickTarget.closest(".r9-datepicker").length)this.blurTarget=a;else return this.hideDropdown(c),a=jq(a),""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setEndDate(null),this.options.change&&this.options.change.apply(this,arguments)),""==a.text()&&null===this.getEndDate()?!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&(null!==this.getStartDate()?this.setEndDate(moment(this.getStartDate()).add(1,"days")):this.setEndDate(moment().toDate())):this.utils.applyEndVal(),
this.updateDropdownSelection(),this},handleEndDisplayKeydownEvent:function(a,b){var c=b.keyCode||b.which;a=jq(a);a.text();var d=this.options.commands.keys;if(c===d.TAB&&!0===b.shiftKey){var e=jq(this.startDisplay);!1===e.is(":hidden")&&(b.preventDefault(),b.stopPropagation(),setTimeout(function(){e.focus()}))}else{if(c===d.ENTER)return this.utils.applyEndVal(),a.closest("form").find("[type\x3dsubmit]").trigger("click"),this.updateDropdownSelection(),b.preventDefault(),b.stopPropagation(),this.hideDropdown(this.getEndWrapperElement()),
!1;a=this.options.commands.keys||{};switch(c){case a.UP:this.callNTimes(this.decrementEndDay,7);b.preventDefault();b.stopPropagation();break;case a.RIGHT:this.incrementEndDay();b.preventDefault();b.stopPropagation();break;case a.LEFT:this.decrementEndDay();b.preventDefault();b.stopPropagation();break;case a.DOWN:this.callNTimes(this.incrementEndDay,7);b.preventDefault();b.stopPropagation();break;case a.ESC:this.isDropdownVisible()&&this.hideDropdown(this.getEndWrapperElement())}this.vim(b,"end")}jq("body").trigger("event",
[b]);return this},handleStartDisplayKeyupEvent:function(a,b){this.utils.isCharacterKeyPress(b)&&(this.start_custom_value=jq(a).text());return this},handleEndDisplayKeyupEvent:function(a,b){this.utils.isCharacterKeyPress(b)&&(this.end_custom_value=jq(a).text());return this},nextCalendar:function(a){return this.utils.changeCalendar("next",a)},prevCalendar:function(a){return this.utils.changeCalendar("prev",a)},selectDisplayBox:function(a){clearTimeout(this.timers.selectDisplayBox);this.timers.selectDisplayBox=
window.setTimeout(function(){var b,c;window.getSelection&&document.createRange?(c=document.createRange(),c.selectNodeContents(a),b=window.getSelection(),0<b.getRangeAt(0).getClientRects().length&&b.removeAllRanges(),b.addRange(c)):document.body.createTextRange&&(c=document.body.createTextRange(),c.moveToElementText(a),R9.Common.Utils.Browsers.isIE(8)||c.select())},1)},vim:function(a,b){var c=this.options.commands.keys||{};switch(a.keyCode||a.which){case c.DOLLAR:a.shiftKey&&(this.endOfLine(b),a.preventDefault());
break;case c.CARAT:a.shiftKey&&(this.startOfLine(b),a.preventDefault())}return this},startOfLine:function(a){var b=this.utils.getRowInfo(a);"start"==a?this.decrementStartDay(b.index):this.decrementEndDay(b.index)},endOfLine:function(a){var b=this.utils.getRowInfo(a),b=b.len-b.index;"start"==a?this.incrementStartDay(b):this.incrementEndDay(b)},bindBuzzGraphEvents:function(){var a=this;jq(".r9-datepicker-buzz-day").hover(function(){jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).addClass("r9-datepicker-item-hover");
jq(".r9-datepicker-buzz-graph-footer \x3e div \x3e .detail").html(jq(this).children(".r9-datepicker-buzz-bar").attr("footertitle"))},function(){jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).removeClass("r9-datepicker-item-hover");jq(".r9-datepicker-buzz-graph-footer \x3e div \x3e .detail").html("")});jq(".r9-datepicker-buzz-day").click(function(){var b=Number(jq(this).children(".r9-datepicker-buzz-bar").attr("dtstart"));if(a.actOnStart){var c=Number(jq(this).children(".r9-datepicker-buzz-bar").attr("dtend"));
a.clearDaterange();a.setStartDate(b);a.options.isOneWay||a.setEndDate(c);a.updateDropdownSelection(null);a.options.isOneWay?(a.setEndDate(b),jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).mousedown(),R9.Analytics.api.trackEvent("/flexgraph/oneway/click")):(a.endDisplay.focus(),R9.Analytics.api.trackEvent("/flexgraph/startdate/click"))}else a.setEndDate(b),jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).mousedown(),R9.Analytics.api.trackEvent("/flexgraph/enddate/click")})},
fetchBuzzGraphData:function(){var a=this;jq("#flexgraphOK").size();var b="y"==jq("#onewaytrip").filter(":checked").val()||"y"==jq("#multi").filter(":checked").val();a.options.isOneWay=b;var c=a.getStartDate()||a.today,d=a.getEndDate(),e=b?1:3;null==d||b||(e=Math.floor(a.utils.dateDiff(d,c)+1));var g=Number(jq(".r9-datepicker-month-first").find(".r9-datepicker-enabled:first").attr("data-val"));if(""==a.options.originControl.val()||""==a.options.destControl.val())jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),
jq(".r9-datepicker-buzz-graph-footer .noairports").removeClass("hidden");else if(a.actOnStart){var f=moment(g).format("YYYY-MM-DD");a.buzzCall&&a.buzzCall.abort();a.buzzCall=b?jq.ajax({type:"GET",url:"/h/run/flexgraph",data:{q:"oneway",o:a.options.originControl.val().substr(0,3),d:a.options.destControl.val().substr(0,3),depart:f,daysout:70,duration:e,json:1},dataType:"json",success:function(b){try{responseObject=b,a.graphDataReadyCallback(responseObject,e,g,!0,c.getTime())}catch(h){}a.buzzCall=!1},
error:function(b,c,d){a.buzzCall=!1},cache:!1}):jq.ajax({type:"GET",url:"/h/run/flexgraph",data:{q:"fixed",o:a.options.originControl.val().substr(0,3),d:a.options.destControl.val().substr(0,3),depart:f,daysout:70,duration:e,json:1},dataType:"json",success:function(b){try{responseObject=b,a.graphDataReadyCallback(responseObject,e,g,!1,c.getTime())}catch(h){}a.buzzCall=!1},error:function(b,c,d){a.buzzCall=!1},cache:!1})}else{var f=moment(c.getTime()).format("YYYY-MM-DD"),l=(d||a.today).getTime();a.buzzCall&&
a.buzzCall.abort();a.buzzCall=jq.ajax({type:"GET",url:"/h/run/flexgraph",data:{q:"start",o:a.options.originControl.val().substr(0,3),d:a.options.destControl.val().substr(0,3),depart:f,daysout:70,json:1},dataType:"json",success:function(b){try{responseObject=b,a.graphDataReadyCallback(responseObject,e,c.getTime(),!1,l)}catch(h){}a.buzzCall=!1},error:function(b,c,d){a.buzzCall=!1},cache:!1})}},displayBuzzGraph:function(){this.fetchBuzzData(!0)},fetchBuzzData:function(a){this.options.showBuzzGraph&&
a&&(jq(".r9-datepicker-buzz-day.r9-datepicker-enabled .r9-datepicker-buzz-bar").each(function(){jq(this).css("height","2px").attr("footertitle","")}),this.fetchBuzzGraphData())},graphDataReadyCallback:function(a,b,c,d,e){this.actOnStart?d?(jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .oneway").removeClass("hidden")):(jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .duration #durationNumber").html(b),
jq(".r9-datepicker-buzz-graph-footer .duration").removeClass("hidden")):(jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .fixedstart #flexDepartDate").html(moment(c).format(this.options.startInputFormat)),jq(".r9-datepicker-buzz-graph-footer .fixedstart").removeClass("hidden"));c=b=500;var f=0,n=0,l=0,k;for(k in a){l++;var h=Number(a[k].localPrice);h>b&&(b=h);h<c&&1<h&&(c=h,n=k);k==e&&(f=h)}if(0==l)jq(".r9-datepicker-buzz-graph").hide(),jq(".r9-datepicker-buzz-graph-footer").hide();
else{l=0;for(k in a){var h=a[k].localPrice,p=a[k].localPriceAsString,r=a[k].departMilli,q=a[k].returnMilli,t=moment(a[k].departMilli).format(this.options.startInputFormat),u=moment(a[k].returnMilli).format(this.options.startInputFormat),m=this.actOnStart?jq(".r9-datepicker-buzz-day[data-val\x3d'"+k+"']").find("div"):jq(".r9-datepicker-buzz-day[data-val\x3d'"+q+"']").find("div");1==m.size()&&(h=Math.floor(h/b*100),m.css("height",h+"%"),l++,d?m.attr("footertitle",t+" "+p):m.attr("footertitle",t+"-"+
u+" "+p),this.actOnStart?m.attr("dtstart",r):m.attr("dtstart",q),m.attr("dtend",q),this.actOnStart?k==e&&(m.addClass("selected"),jq("#graphpricebar").css("bottom",h-1+"px").show(),jq("#graphprice").html(p).css("bottom",h-7+"px").show()):q==e&&(m.addClass("selected"),jq("#graphpricebar").css("bottom",h-1+"px").show(),jq("#graphprice").html(p).css("bottom",h-7+"px").show()),k==n&&(0<f&&f>c&&c<.9*f?jq("#graphlowpricebar").css("bottom",h-1+"px").show():jq("#graphlowpricebar").hide()))}0==l?(jq(".r9-datepicker-buzz-graph").hide(),
jq(".r9-datepicker-buzz-graph-footer").hide()):jq(".r9-datepicker-buzz-graph").is(":visible")||(jq(".r9-datepicker-buzz-graph").show(),jq(".r9-datepicker-buzz-graph-footer").show())}}})})(jq||jQuery);(function(f){f.extend("Widgets.DaterangePicker.prototype.options",{prevTitle:"Prev",nextTitle:"Next",nightsFormat:"0#same day|1#1 night|2#{0} nights",daysFormat:"0#same day|1#1 day|2#{0} days",startInputFormat:"DD/MM/YYYY",endInputFormat:"DD/MM/YYYY",startFormat:"ddd D/M",endFormat:"ddd D/M"})})(window.R9);(function(c){R9.extend("Widgets",{DaterangePickerTwoFields:function(a,b){R9.Widgets.BaseCalendarWidget.apply(this);this.endNode=a;this.endElement=c(this.endNode);this.startElement=jq(this.endElement).closest("form").find('[id$\x3d"start-wrapper"]');1!=this.startElement.length&&(this.startElement=jq("#"+this.endElement.attr("id").replace("end-wrapper","start-wrapper")));this.validateElement()&&(this.startDisplay=c(R9.Widgets.DaterangePickerTwoFields.findDisplay(this.startElement[0])),this.startClearDisplay=
c(R9.Widgets.DaterangePickerTwoFields.findClearDisplay(this.startElement[0])),this.startPlaceholderDisplay=c(R9.Widgets.DaterangePickerTwoFields.findPlaceholderDisplay(this.startElement[0])),this.startInputTab=c(R9.Widgets.DaterangePickerTwoFields.findInputTab(this.startElement[0])),this.startInput=c(R9.Widgets.DaterangePickerTwoFields.findInput(this.startElement[0])),this.endDisplay=c(R9.Widgets.DaterangePickerTwoFields.findDisplay(this.endElement[0])),this.endClearDisplay=c(R9.Widgets.DaterangePickerTwoFields.findClearDisplay(this.endElement[0])),
this.endPlaceholderDisplay=c(R9.Widgets.DaterangePickerTwoFields.findPlaceholderDisplay(this.endElement[0])),this.endInputTab=c(R9.Widgets.DaterangePickerTwoFields.findInputTab(this.endElement[0])),this.endInput=c(R9.Widgets.DaterangePickerTwoFields.findInput(this.endElement[0])),this.options=c.extend({},this.options,b),this.init())}});R9.extend("Widgets.DaterangePickerTwoFields",{isDatepicker:function(a){return a&&a.nodeName&&"div"==a.nodeName.toLowerCase()},isWidgetControlled:function(a){return c(a).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+
"-wrapper")},findDisplay:function(a){var b=c(a).closest("form").find("#"+a.id.replace("wrapper","display"))[0];b||(b=document.getElementById(a.id.replace("wrapper","display")));return b},findClearDisplay:function(a){var b=c(a).closest("form").find("#"+a.id.replace("wrapper","clear"))[0];b||(b=document.getElementById(a.id.replace("wrapper","clear")));return b},findPlaceholderDisplay:function(a){var b=c(a).closest("form").find("#"+a.id.replace("wrapper","placeholder"))[0];b||(b=document.getElementById(a.id.replace("wrapper",
"placeholder")));return b},findInputTab:function(a){var b=c(a).closest("form").find("#"+a.id.replace("wrapper","tab"))[0];b||(b=document.getElementById(a.id.replace("wrapper","tab")));return b},findInput:function(a){var b=jq(a).closest("form").find("#"+a.id+" .r9-datepicker-input")[0];b||(b=jq("#"+a.id+" .r9-datepicker-input")[0]);return b},getDropdownId:function(a){return"datepicker"}});R9.extend("Widgets.DaterangePickerTwoFields.prototype",!0,R9.Widgets.DaterangePicker.prototype,{endNode:null,startElement:null,
endElement:null,startDisplay:null,startClearDisplay:null,startPlaceholderDisplay:null,startInputTab:null,startInput:null,endDisplay:null,endClearDisplay:null,endPlaceholderDisplay:null,endInputTab:null,endInput:null,singleDateMode:!1,init:function(){this.advanceStyling&&(this.options.skipForceSetDefaultStartOnFocusBlur=!0,this.options.skipForceSetDefaultEndOnFocusBlur=!0,this.options.doNotFillWhenEmpty=!0);this.initDropdown();this.timers={};this.options.useLongDisplayFormat&&(this.options.startFormat=
this.options.startInputFormat,this.options.endFormat=this.options.endInputFormat);this.endStartIsSameField()||(this.bindEvent(this.endInputTab,"focus",this.handleEndInputFocusEvent),this.bindEvent(this.endInputTab,"blur",this.handleInputBlurEvent),this.bindEvent(this.endInputTab,"keydown",this.handleInputKeydownEvent),this.bindEvent(this.endElement,"mousedown",this.handleEndClickEvent),this.bindEvent(this.endClearDisplay,"mousedown",this.handleEndClearClickEvent));this.bindEvent(this.startInputTab,
"focus",this.handleStartInputFocusEvent);this.bindEvent(this.startInputTab,"blur",this.handleInputBlurEvent);this.bindEvent(this.startInputTab,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.startElement,"mousedown",this.handleStartClickEvent);this.bindEvent(this.startClearDisplay,"mousedown",this.handleStartClearClickEvent);this.endElement.data(this.widgetName,this);jq(".r9-datepicker-wrapper").each(function(){var a=jq(this).find(".r9-datepicker-display");if(!(void 0!==a&&1<a.length))jq(this).off("mousedown focus").on("mousedown focus",
function(a){a.preventDefault();a.stopPropagation();jq("body").trigger("event",[a]);jq(this).find(".r9-datepicker-display").focus()})});this.bindCommandUtilities();this.start_custom_value=this.end_custom_value="";this.utils=this.options.commands.utilities;this.today=moment().startOf("day").toDate();this.bindAccessibilityEvents();this.updateClicks();this.updateDOM()},validateElement:function(){return R9.Widgets.DaterangePicker.isDatepicker(this.endNode)&&R9.Widgets.DaterangePicker.isWidgetControlled(this.endNode)&&
void 0===this.endElement.data(this.widgetName)},getWrapperElement:function(){return this.actOnStart?this.startElement:this.endElement},getStartWrapperElement:function(){return this.startElement},getEndWrapperElement:function(){return this.endElement},switchActOn:function(){var a=!this.actOnStart;this.hideDropdown(this.getWrapperElement());this.actOnStart=a;(this.actOnStart?this.startInputTab:this.endInputTab).focus()},markDropdownElements:function(){this.unmarkDropdownElements();this.actOnStart?this.startElement.addClass("r9-datepicker-dropdown r9-datepicker-dropdown-start"):
this.endElement.addClass("r9-datepicker-dropdown r9-datepicker-dropdown-end")},unmarkDropdownElements:function(){this.startElement.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-start");this.endElement.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-end")},setSingleDateMode:function(a,b){this.singleDateMode!=a&&(this.singleDateMode=a,b||this.updateDOM())},getSingleDateMode:function(){return this.singleDateMode},handleStartClearClickEvent:function(a,b){this.clearDaterange(0);
this.options.change&&this.options.change.apply(this,arguments);return!this.startElement.hasClass("r9-datepicker-focus")},handleEndClearClickEvent:function(a,b){this.clearDaterange(1);this.options.change&&this.options.change.apply(this,arguments);return!this.endElement.hasClass("r9-datepicker-focus")},handleStartInputFocusEvent:function(a,b){if(!a.disabled){this.preventBlur=!1;var c=this.getStartWrapperElement();c.addClass("r9-datepicker-focus");this.startDisplay.text()||this.setStartDate(this.today);
this.actOnStart=!0;this.showDropdown(c);this.options.focus&&this.options.focus.apply(this,arguments)}},handleEndInputFocusEvent:function(a,b){if(!a.disabled){this.preventBlur=!1;var c=this.getEndWrapperElement();c.addClass("r9-datepicker-focus");this.endDisplay.text()||this.setEndDate(moment(this.getStartDate()).toDate());this.actOnStart=!1;this.showDropdown(c);this.options.focus&&this.options.focus.apply(this,arguments)}},handleItemClickEvent:function(a,b){var c=this,d=jq(a);return this.singleDateMode?
(d.hasClass("r9-datepicker-enabled")&&(a=parseInt(d.attr("data-val")),this.clicks[0]=a,this.clicks[1]<this.clicks[0]&&(this.clicks[1]=this.clicks[0]),this.updateDropdownSelection(null),setTimeout(function(){c.hideDropdown(null);c.options.change&&c.options.change.apply(c,arguments);c.options.nextFieldSelector&&jq(c.options.nextFieldSelector).focus()},this.options.secondClickHideDelay)),this.updateDOM(),!1):R9.Widgets.DaterangePicker.prototype.handleItemClickEvent.call(this,a,b)},handleClickEvent:function(a,
b,c){return!0},updateItem:function(a,b){this.singleDateMode?(b.hover?a.addClass("r9-datepicker-item-hover"):a.removeClass("r9-datepicker-item-hover"),a.removeClass("r9-datepicker-item-selected"),b.selected&&!b.end?(a.addClass("r9-datepicker-item-selected"),a.attr("aria-selected",!0)):b.selected||a.attr("aria-selected",!1),b.start&&a.addClass("r9-datepicker-item-start")):R9.Widgets.DaterangePicker.prototype.updateItem.call(this,a,b)}})})(jq||jQuery);(function(b){R9.extend("Widgets",{DaterangePickerFixed:function(a,d){this.elementNode=a;this.element=b(this.elementNode);this.validateElement()&&(this.startDisplay=b(R9.Widgets.DaterangePicker.findStartDisplay(this.elementNode)),this.sepDisplay=b(R9.Widgets.DaterangePicker.findSepDisplay(this.elementNode)),this.endDisplay=b(R9.Widgets.DaterangePicker.findEndDisplay(this.elementNode)),this.clearDisplay=b(R9.Widgets.DaterangePicker.findClearDisplay(this.elementNode)),this.nightsDisplay=b(R9.Widgets.DaterangePicker.findNightsDisplay(this.elementNode)),
this.placeholderDisplay=b(R9.Widgets.DaterangePicker.findPlaceholderDisplay(this.elementNode)),this.input=b(R9.Widgets.DaterangePicker.findInputNode(this.elementNode)),this.startInput=b(R9.Widgets.DaterangePicker.findStartInput(this.elementNode)),this.endInput=b(R9.Widgets.DaterangePicker.findEndInput(this.elementNode)),this.options=b.extend({},this.options,d),this.init())}});R9.extend("Widgets.DaterangePickerFixed",{isDatepicker:function(a){return a&&a.nodeName&&"div"==a.nodeName.toLowerCase()},
isWidgetControlled:function(a){return b(a).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+"-wrapper")},findStartDisplay:function(a){return document.getElementById(a.id+"-start")},findEndDisplay:function(a){return document.getElementById(a.id+"-end")},findSepDisplay:function(a){return document.getElementById(a.id+"-sep")},findClearDisplay:function(a){return document.getElementById(a.id+"-clear")},findNightsDisplay:function(a){return document.getElementById(a.id+"-nights")},findPlaceholderDisplay:function(a){return document.getElementById(a.id+
"-placeholder")},findStartInput:function(a){return jq("#"+a.id+" .r9-datepicker-input.r9-datepicker-start")[0]},findEndInput:function(a){return jq("#"+a.id+" .r9-datepicker-input.r9-datepicker-end")[0]},findInputNode:function(a){return document.getElementById(a.id+"-tab")},getDropdownId:function(a){return"datepicker"}});R9.extend("Widgets.DaterangePickerFixed.prototype",!0,R9.Widgets.DaterangePicker.prototype,{options:{rangeDays:34},handleItemClickEvent:function(a,b){var c=this;a=jq(a);a.hasClass("r9-datepicker-enabled")&&
(a=parseInt(a.attr("data-val")),this.clicks[0]=a,this.clicks[1]=moment(a).add(this.options.rangeDays,"days").valueOf(),this.updateDropdownSelection(null),setTimeout(function(){c.hideDropdown(null);c.options.change&&c.options.change.apply(c,arguments);c.options.nextFieldSelector&&jq(c.options.nextFieldSelector).focus()},this.options.secondClickHideDelay));this.updateDOM();return!1},getHighlitedRange:function(a,b){a=[0,0];if(null==b)return a;a[0]=parseInt(b.attr("data-val"));a[1]=moment(a[0]).add(34,
"days").valueOf();return a},setStartDate:function(a){null!=a&&(this.clicks[0]=a.getTime(),this.clicks[1]=moment(this.clicks[0]).add(this.options.rangeDays,"days").valueOf(),this.updateDOM())},setEndDate:function(a){null!=a&&(this.clicks[1]=a.getTime(),this.clicks[0]=moment(this.clicks[1]).subtract(this.options.rangeDays,"days").valueOf(),this.updateDOM())}})})(jq||jQuery);(function(g){R9.extend("Widgets",{DaterangePickerOrSingleDate:function(a,b){R9.Widgets.DaterangePicker.call(this,a,b)}});R9.extend("Widgets.DaterangePickerOrSingleDate",{});R9.extend("Widgets.DaterangePickerOrSingleDate.prototype",!0,R9.Widgets.DaterangePicker.prototype,{minDate:null,singleDateMode:!1,setSingleDateMode:function(a,b){this.singleDateMode=a;b||this.updateDOM()},getSingleDateMode:function(){return this.singleDateMode},updateDOM:function(){var a;this.singleDateMode?(this.element.addClass("r9-datepicker-single-date-mode"),
this.dropdown.addClass("r9-datepicker-single-date-mode"),this.endDisplay.text(""),this.endInput.val(""),0!=this.clicks[0]?(a=moment(this.clicks[0]),this.startDisplay.text(a.format(this.options.startFormat)),this.startInput.val(a.format(this.options.startInputFormat))):(this.startDisplay.text(""),this.startInput.val("")),null==a?this.element.addClass("r9-datepicker-start-empty"):this.element.removeClass("r9-datepicker-start-empty")):(this.element.removeClass("r9-datepicker-single-date-mode"),this.dropdown.removeClass("r9-datepicker-single-date-mode"),
R9.Widgets.DaterangePicker.prototype.updateDOM.call(this))},updateHoverDOM:function(a){this.singleDateMode||R9.Widgets.DaterangePicker.prototype.updateHoverDOM.call(this,a)},computeState:function(a,b,c,d,e,f){this.singleDateMode?b==c[0]?e.start=!0:b==a&&(e.highlited=!0):R9.Widgets.DaterangePicker.prototype.computeState.call(this,a,b,c,d,e,f)},handleItemClickEvent:function(a,b){var c=this,d=jq(a);return this.singleDateMode?(d.hasClass("r9-datepicker-enabled")&&(a=parseInt(d.attr("data-val")),this.clicks[0]=
a,this.updateDropdownSelection(null),setTimeout(function(){c.hideDropdown(null);c.options.change&&c.options.change.apply(c,arguments);c.options.nextFieldSelector&&jq(c.options.nextFieldSelector).focus()},this.options.secondClickHideDelay)),this.updateDOM(),!1):R9.Widgets.DaterangePicker.prototype.handleItemClickEvent.call(this,a,b)}})})(jq||jQuery);(function(d){R9.extend("Widgets",{RadiobuttonSet:function(a,c){this.elementNode=a;this.element=d(this.elementNode);if(!c||c.dontValidate||this.validateElement())this.options=d.extend({},this.options,c),this.init()}});R9.extend("Widgets.RadiobuttonSet",{isRadiobuttonSet:function(a){return a&&a.nodeName&&"span"===a.nodeName.toLowerCase()},isWidgetControlled:function(a){return d(a).hasClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass)},findLabelNode:function(a){return document.getElementById(a.id+
"-label")},findRadiobuttonSetNode:function(a){return null!=a?a.parentNode:null},refresh:function(a){a.find("input."+R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass).each(function(){var a=d(R9.Widgets.RadiobuttonSet.findLabelNode(this)),b=d(this);b.prop("checked")?a.addClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass+"-label-checked"):a.removeClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass+"-label-checked");b.prop("disabled")?a.addClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass+
"-label-disabled"):a.removeClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass+"-label-disabled")})},applyCallback:function(a,c,b,e){a&&(d.isFunction(a)?a.apply(c,b):(a=a[e.target.value],d.isFunction(a)&&a.apply(c,b)))}});R9.extend("Widgets.RadiobuttonSet.prototype",{widgetName:"radiobuttonset",widgetBaseClass:"r9-radiobuttonset",elementNode:null,element:null,options:{change:null,click:null},init:function(){this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("blur",
this.handleElementBlurEvent);this.bindInputEvent("change",this.handleElementChangeEvent);this.bindInputEvent("click",this.handleElementClickEvent);this.element.data(this.widgetName,this);R9.Widgets.RadiobuttonSet.refresh(this.element)},bindInputEvent:function(a,c){var b="input."+this.widgetBaseClass;a+="."+this.widgetName;var d=this;this.element.undelegate(b,a).delegate(b,a,function(a){c.call(d,this,R9.Widgets.RadiobuttonSet.findLabelNode(this),a)})},validateElement:function(){return R9.Widgets.RadiobuttonSet.isRadiobuttonSet(this.elementNode)&&
R9.Widgets.RadiobuttonSet.isWidgetControlled(this.element)&&void 0===this.element.data(this.widgetName)},handleElementFocusEvent:function(a,c,b){a.disabled||d(c).addClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass+"-label-focused")},handleElementBlurEvent:function(a,c,b){a.disabled||d(c).removeClass(R9.Widgets.RadiobuttonSet.prototype.widgetBaseClass+"-label-focused")},handleElementChangeEvent:function(a,c,b){a.disabled||(d.support.changeBubbles||R9.Widgets.RadiobuttonSet.applyCallback(this.options.click,
this,arguments,b),R9.Widgets.RadiobuttonSet.applyCallback(this.options.change,this,arguments,b),R9.Widgets.RadiobuttonSet.refresh(this.element))},handleElementClickEvent:function(a,c,b){a.disabled||(R9.Widgets.RadiobuttonSet.applyCallback(this.options.click,this,arguments,b),R9.Widgets.RadiobuttonSet.refresh(this.element))}})})(jq||jQuery);R9.extend("Analytics",{API:function(b){this.initialize(b)}});R9.extend("Analytics.API",{handlers:{pageView:[],event:[],autoEvent:[]},registerPlugin:function(b,c){b=R9.Analytics.API.handlers[b];"undefined"!=typeof b&&b.push(c)}});
R9.extend("Analytics.API.prototype",{initialize:function(b){this._options=b},trackPageView:function(b,c){(R9.globals.analytics||{}).doNotTrack||(b=this._makePageData(b),this._handle(R9.Analytics.API.handlers.pageView,b,c))},trackEvent:function(b,c){(R9.globals.analytics||{}).doNotTrack||(b=this._makeEventData(b),this._handle(R9.Analytics.API.handlers.event,b,c))},trackAutoEvent:function(b,c){(R9.globals.analytics||{}).doNotTrack||(b=this._makeEventData(b),b.auto=!0,this._handle(R9.Analytics.API.handlers.autoEvent,
b,c))},setSubPageId:function(b){R9.globals.analytics.subPageId=b},setPageId:function(b){R9.globals.analytics.pageId=b},setVertical:function(b){R9.globals.analytics.vertical=b},_handle:function(b,c,e){for(var a=b.length,l=[],d,h=0;h<a;h++)d=jq.Deferred(),l.push(d),b[h](c,function(){var a=d;return function(){a.resolve()}}());e&&jq.when.apply(jq,l).done(e)},_makeEventData:function(b){"string"===typeof b&&(b={category:b});var c=this._makeCommonData(b),e=null;R9.currentSearch&&(e=R9.currentSearch.getSearchId());
e||(e=window.SearchID);e&&(c.searchid=e);b&&(c.category=b.category,c.params=b.params,c.searchid=c.searchid||b.searchid,c.action=b.action,c.label=b.label,c.value=b.value);return c},_makePageData:function(b){return this._makeCommonData(b)},_makeCommonData:function(b){var c={},e=R9.globals.analytics||{};b?(c.vertical=b.vertical||e.vertical||R9.globals.vertical,c.locale=b.locale||R9.globals.locale.loc,c.affiliate=b.affiliate||R9.globals.affiliate,c.affiliateskin=b.affiliateskin||b.brand||R9.globals.affiliateskin||
R9.globals.brand,c.experiment=b.experiment||R9.globals.experiment,c.pageId=b.pageId||e.pageId,c.subPageId=b.subPageId||e.subPageId,c.whiskyProvider=b.whiskyProvider||e.whiskyProvider,c.presentation=b.presentation||e.presentation||R9.globals.presentation,c.pixelContext=b.pixelContext||e.pixelContext||{},c.loginState=b.loginState||e.loginState,c.sessionId=b.sessionId||e.sessionId):(c.vertical=e.vertical||R9.globals.vertical,c.locale=R9.globals.locale.loc,c.affiliate=R9.globals.affiliate,c.affiliateskin=
R9.globals.affiliateskin||R9.globals.brand,c.experiment=R9.globals.experiment,c.pageId=e.pageId,c.subPageId=e.subPageId,c.whiskyProvider=e.whiskyProvider,c.presentation=e.presentation||R9.globals.presentation,c.pixelContext=e.pixelContext||{},c.loginState=e.loginState,c.sessionId=e.sessionId);return c}});
(function(){function b(a,c){var b=c.dimension1||"",e=b+"/"+(c.dimension2||"");c=e+"/"+(c.dimension3||"");a("set","contentGroup1",b);a("set","contentGroup2",e);a("set","contentGroup3",c)}function c(a){e||(a?__gaTracker("create","UA-42209185-8",{userId:a}):__gaTracker("create","UA-42209185-8","auto"),__gaTracker("require","displayfeatures"),__gaTracker("require","ecommerce"),e=!0)}var e=!1;R9.Analytics.API.registerPlugin("pageView",function(a,e){if(R9.globals.analytics&&R9.globals.analytics.google&&
"true"==R9.globals.analytics.google.trackPageView){c(R9.globals.analytics.utoken);var d={};d.dimension1=a.vertical;d.dimension2=a.pageId;d.dimension3=a.subPageId;d.dimension4=a.locale;d.dimension5=a.affiliate;d.dimension7=a.affiliateskin;d.dimension6=a.experiment;d.dimension8=a.presentation;d.dimension9=a.loginState;d.dimension29=a.whiskyProvider;d.dimension10=a.pixelContext.destination&&a.pixelContext.destination.cityId;d.dimension11=a.pixelContext.hotelId;d.dimension12=a.pixelContext.originCode;
d.dimension13=a.pixelContext.destinationCode;d.dimension28=a.sessionId;d.title=document.title;d.location=document.location.href;d.hitCallback=e;R9.globals.wlgoogle&&(a={name:R9.globals.wlgoogle.name},"true"===R9.globals.wlgoogle.autolinker&&(a.allowLinker=!0),__gaTracker("create",R9.globals.wlgoogle.id,"auto",a),__gaTracker(R9.globals.wlgoogle.name+".send","pageview"));d&&(b(__gaTracker,d),__gaTracker("send","pageview",d))}else e&&e()});R9.Analytics.API.registerPlugin("event",function(a,e){if(R9.globals.analytics&&
R9.globals.analytics.google&&"true"==R9.globals.analytics.google.trackEvent){c(R9.globals.analytics.utoken);var d={};d.dimension1=a.vertical;d.dimension2=a.pageId;d.dimension3=a.subPageId;d.dimension4=a.locale;d.dimension5=a.affiliate;d.dimension7=a.affiliateskin;d.dimension6=a.experiment;d.dimension8=a.presentation;d.dimension9=a.loginState;d.dimension29=a.whiskyProvider;d.dimension28=a.sessionId;d.eventCategory=a.category;d.eventAction=a.action||(a.auto?"auto":"click");a.auto&&(d.nonInteraction=
1);a.label&&(d.eventLabel=a.label);a.value&&(d.eventValue=a.value);d.title=document.title;d.location=document.location.href;d.hitCallback=e;R9.globals.wlgoogle&&(a=d.eventCategory,(0==a.lastIndexOf("details/inlinemultibook")||0==a.lastIndexOf("results/button/resultclick")||0==a.lastIndexOf("results/multibooklinks")||0==a.lastIndexOf("details/resultclick/button")||0==a.lastIndexOf("results/inline/click")||0==a.lastIndexOf("clickout/results/offers/cheapest_price/button")||0==a.lastIndexOf("clickout/results/offers/inline_vertical_multibook")||
0==a.lastIndexOf("clickout/listview/detailslayer/offers/cheapest_price/button")||0==a.lastIndexOf("clickout/mapview/detailslayer/offers/cheapest_price/button")||0==a.lastIndexOf("clickout/results/offers/inline_horizontal_multibook")||0==a.lastIndexOf("mapview/popup/results/button/resultclick")||0==a.lastIndexOf("clickout/mapview/detailslayer/offers/cheapest_price/button")||0==a.lastIndexOf("mapview/results/multibooklinks")||0==a.lastIndexOf("details/rates/button/resultclick")||0<=a.lastIndexOf("/multibook/buttonClicked")||
0==a.lastIndexOf("inline/hmultibook/resultclick")||0<=a.lastIndexOf("/multibook/linkClicked")||0==a.lastIndexOf("hotel/inline/rates/show")||0==a.lastIndexOf("results/inline/horizontal/click"))&&__gaTracker(R9.globals.wlgoogle.name+".send","event","kayak_"+d.dimension1+"_offerlist","ota_click"));d&&(b(__gaTracker,d),__gaTracker("send","event",d))}else e&&e()});(function(a,c,b,e,f,g,k){a.GoogleAnalyticsObject=f;a[f]=a[f]||function(){(a[f].q=a[f].q||[]).push(arguments)};a[f].l=1*new Date;var d=setInterval(function(){R9&&
R9.globals&&R9.globals.uiconfig&&R9.config&&R9.config.getBoolean&&(clearInterval(d),R9.config.getBoolean("ui.ga.forceOff",!1)?a[f]=function(){arguments&&2<arguments.length&&arguments[2]&&"function"===typeof arguments[2].hitCallback&&arguments[2].hitCallback()}:(g=c.createElement(b),k=c.getElementsByTagName(b)[0],g.async=1,g.src=e,k.parentNode.insertBefore(g,k)))},100)})(window,document,"script","//www.google-analytics.com/analytics.js","__gaTracker")})();
(function(){var b=function(c,b){if(R9.globals.analytics&&R9.globals.analytics.vslog&&"true"==R9.globals.analytics.vslog.trackEvent){var a={type:"POST"};a.url="/vs/"+c.vertical+"/"+c.pageId+(c.subPageId?"/"+c.subPageId:"")+"/"+c.category+(c.action?"/"+c.action:"")+(c.label?"/"+c.label:"")+(c.value?"/"+c.value:"")+(c.auto?"/nonInteraction":"");a.url=a.url.replace(/\/+/g,"/");a.data=c.params||{};a.data.action="vs";a.data.searchid=c.searchid;a.success=b;a&&jq.ajax(a)}else b&&b()};R9.Analytics.API.registerPlugin("pageView",
function(c,b){if(R9.globals.analytics&&R9.globals.analytics.vslog&&"true"==R9.globals.analytics.vslog.trackPageView){var a={type:"POST"};a.url="/vs/page/"+c.vertical+"/"+c.pageId+(c.subPageId?"/"+c.subPageId:"");a.data=c.params||{};a.data.action="vs";a.data.searchid=c.searchid;a.success=b;a&&jq.ajax(a)}else b&&b()});R9.Analytics.API.registerPlugin("event",b);R9.Analytics.API.registerPlugin("autoEvent",b)})();R9.Analytics.api=new R9.Analytics.API({});(function(c){var d=c(window);R9.extend("Common",{lazyLoad:function(a,b){this.nodes=a;this.options=c.extend({},this.options,b);this.init()}});R9.extend("Common.lazyLoad.prototype",{nodes:null,container:null,options:{threshold:0,event:"scroll",effect:"show",effect_speed:500,container:window,data_attribute:"original",skip_invisible:!0,appear:null,load:null,error:null},init:function(){var a=this;this.container=void 0===this.options.container||this.options.container===window?d:c(this.options.container);
0===this.options.event.indexOf("scroll")&&this.container.bind(this.options.event,function(){return a.update()});this.nodes.each(function(){var b=this,d=c(b);b.loaded=!1;b.loading=!1;b.jqImage=d.children("img[data-"+a.options.data_attribute+"]");if(b.jqImage.length)d.on("appear",function(){this.loaded||this.loading||(a.options.appear&&a.options.appear.call(b,a.nodes.length,a.options),c("\x3cimg /\x3e").on("load",function(){a.onImageLoad(b)}).on("error",function(){a.onImageLoadError(b)}).attr("src",
b.jqImage.data(a.options.data_attribute)),this.loading=!0)}),0!==a.options.event.indexOf("scroll")&&d.bind(a.options.event,function(){b.loaded||d.trigger("appear")});else a.onImageLoadError(b)});d.bind("resize",function(){a.update()});this.update()},onImageLoadError:function(a){this.options.error&&(this.options.error.call(a,this.nodes.length,this.options),a.loading=!1)},onImageLoad:function(a){a.jqImage.hide().attr("src",a.jqImage.data(this.options.data_attribute))[this.options.effect](this.options.effect_speed);
a.loaded=!0;a.loading=!1;var b=c.grep(this.nodes,function(a){return!a.loaded});this.nodes=c(b);this.options.load&&this.options.load.call(a,this.nodes.length,this.options)},update:function(){var a=this;this.nodes.each(function(){var b=c(this);if(!a.options.skip_invisible||b.is(":visible"))c.abovethetop(this,a.options)||c.leftofbegin(this,a.options)||c.belowthefold(this,a.options)||c.rightoffold(this,a.options)||b.trigger("appear")})}});c.fn.lazyLoad=function(a){return new R9.Common.lazyLoad(this,a)};
c.belowthefold=function(a,b){return(void 0===b.container||b.container===window?d.height()+d.scrollTop():c(b.container).offset().top+c(b.container).height())<=c(a).offset().top-b.threshold};c.rightoffold=function(a,b){return(void 0===b.container||b.container===window?d.width()+d.scrollLeft():c(b.container).offset().left+c(b.container).width())<=c(a).offset().left-b.threshold};c.abovethetop=function(a,b){return(void 0===b.container||b.container===window?d.scrollTop():c(b.container).offset().top)>=c(a).offset().top+
b.threshold+c(a).height()};c.leftofbegin=function(a,b){return(void 0===b.container||b.container===window?d.scrollLeft():c(b.container).offset().left)>=c(a).offset().left+b.threshold+c(a).width()};c.inviewport=function(a,b){return!c.rightoffold(a,b)&&!c.leftofbegin(a,b)&&!c.belowthefold(a,b)&&!c.abovethetop(a,b)};c.extend(c.expr[":"],{"below-the-fold":function(a){return c.belowthefold(a,{threshold:0})},"above-the-top":function(a){return!c.belowthefold(a,{threshold:0})},"right-of-screen":function(a){return c.rightoffold(a,
{threshold:0})},"left-of-screen":function(a){return!c.rightoffold(a,{threshold:0})},"in-viewport":function(a){return c.inviewport(a,{threshold:0})},"above-the-fold":function(a){return!c.belowthefold(a,{threshold:0})},"right-of-fold":function(a){return c.rightoffold(a,{threshold:0})},"left-of-fold":function(a){return!c.rightoffold(a,{threshold:0})}})})(jq||jQuery);(function(b){R9.extend("Common",{SmartyControlGroup:function(a){this.options=b.extend({},this.options,a);this.init()}});R9.extend("Common.SmartyControlGroup.prototype",{options:{form:"",smartyHistory:null,daterangePicker:"",startFormat:R9.Widgets.DaterangePicker.prototype.options.startFormat,endFormat:R9.Widgets.DaterangePicker.prototype.options.endFormat},type:"flight",getHistory:function(){return this.options.smartyHistory()},getTime:function(a){return null==a?null:a.getTime()},validateDate:function(a){return null==
a?null:this.datepicker().utils.validate(new Date(a))},datepicker:function(){return b(this.options.daterangePicker).data("datepicker")}});R9.extend("Common.SmartyControlGroup",{SmartyFlightControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)},SmartyHorizonFlightControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)},SmartyHotelControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)},SmartyHorizonHotelControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,
a)},SmartyCarControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)},SmartyHorizonCarControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)}});R9.extend("Common.SmartyControlGroup.SmartyFlightControlGroup.prototype",!0,R9.Common.SmartyControlGroup.prototype,{options:b.extend(R9.Common.SmartyControlGroup.prototype.options,{form:null,originInput:"",destInput:"",originCode:"",destCode:"",daterangePicker:"",cabin:"",travelers:"",nearbyDeparture:"",nearbyArrival:"",isRoundTrip:null}),
init:function(){this.type="flight"},setFieldsFromHistoryItem:function(a,c){this.datepicker().setStartDate(this.validateDate(a.startDate));this.datepicker().setEndDate(this.validateDate(a.endDate));b(this.options.nearbyDeparture).prop("checked",a.departureAllowNearby);b(this.options.nearbyArrival).prop("checked",a.arrivalAllowNearby);c&&(this.options.form.noCheckInfant=!0);this.setTravelersFromHistoryItem(a);c&&(this.options.form.noCheckInfant=!1);c?(b(this.options.originInput).val(a.departAirportName),
b(this.options.destInput).val(a.destAirportName),b(this.options.originCode).val(a.departCode),b(this.options.destCode).val(a.destCode)):(c={type:"ap",id:a.departCode,short_str:a.departAirportName},b(this.options.originInput).data("smarty").setItem(c),a={type:"ap",id:a.destCode,short_str:a.destAirportName},b(this.options.destInput).data("smarty").setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.departAirportName=b(this.options.originInput).val();a.destAirportName=b(this.options.destInput).val();
a.departCode=b(this.options.originCode).val();a.destCode=b(this.options.destCode).val();a.startDate=this.getTime(this.datepicker().getStartDate());a.endDate=this.getTime(this.datepicker().getEndDate());a.departureAllowNearby=b(this.options.nearbyDeparture).prop("checked");a.arrivalAllowNearby=b(this.options.nearbyArrival).prop("checked");b(this.options.travelers).each(function(c){c=b(this).data("r9NumberBox");var d=b(this).parent().data("for").toLowerCase();a[d]=c.getValue()});a.cabin=b(this.options.cabin).val();
return a},isRoundTrip:function(){return"function"===typeof this.options.isRoundTrip?this.options.isRoundTrip():"checked"===b("#roundtrip").attr("checked")?!0:0<b(".inlineSearchAgainView").length&&"y"!==b('[name\x3d"oneway"]',".inlineSearchAgainView").val()?!0:!1},setTravelersFromHistoryItem:function(a){var c=0;b(this.options.travelers).each(function(d){d=b(this).data("r9NumberBox");var e=b(this).parent().data("for").toLowerCase(),e=a[e];c+=e;void 0!=d&&d.setValue(e)});var d=b(".ptcAdults .r9NumberBox",
b(this.options.form.e)).data("r9NumberBox");0==c&&d.setValue(1);0<b(this.options.cabin).length&&b(this.options.cabin).val(a.cabin);this.setTravelerCount();d.options.callback.call(d,0)},setTravelerCount:function(){var a=0;b(".fieldInputPTCType .numberHolder",this.form).each(function(c){c=+b(this).val();isNaN(c)||(a+=c)});!a&&b("select#mobiletravelers",this.form).length&&(a=+b("#mobiletravelers",this.form).val());b("[name\x3dtravelers]",this.form).val(a);var c;1==a?(c="adults",b(".fieldInputPTCType",
this.form).each(function(){if(1==b(this).find(".numberHolder").val())return c=b(this).data("for").toLowerCase(),!1})):c="traveler_count";var d=b("#travelers, #travelers2",this.form).data("dropdownDialog");if(d){void 0===this.statusMessage[c]&&(c="traveler_count");var f=this.statusMessage[c];if(void 0!==f){var f="traveler_count"===c?R9.Common.Utils.String.formatChoice(f,a,a):R9.Common.Utils.String.formatString(f,a),e=b("#cabin option:selected",this.form).text();d.updateLabel(f+", "+e)}}},statusMessage:{adults:"{0} adult",
seniors:"{0} senior",children:"{0} child",traveler_count:"1#1 traveller|2#{0} travellers"}});R9.extend("Common.SmartyControlGroup.SmartyHotelControlGroup.prototype",!0,R9.Common.SmartyControlGroup.prototype,{options:b.extend(R9.Common.SmartyControlGroup.prototype.options,{form:null,locationInput:"",ctid:"",lmid:"",hid:"",nhid:"",daterangePicker:"",rooms:"",guests:"",minStars:"",priceRange:"",rating:""}),init:function(){this.type="hotel"},setFieldsFromHistoryItem:function(a,c){this.datepicker().setStartDate(this.validateDate(a.checkinDate));
this.datepicker().setEndDate(this.validateDate(a.checkoutDate));this.options.rooms&&b(this.options.rooms).data("r9NumberBox").setValue(a.rooms);b(this.options.guests).data("r9NumberBox").setValue(a.guests);b(this.options.minStars).val(a.minStars);b(this.options.rating).val(Math.floor(a.rating/10));c?(b(this.options.locationInput).val(a.location),b(this.options.ctid).val(a.ctid),b(this.options.lmid).val(a.lmid),b(this.options.hid).val(a.hid),b(this.options.nhid).val(a.nhid),b(this.options.frid).val(a.frid),
b(this.options.rid).val(a.rid),b(this.options.cid).val(a.cid)):(a={id:a.ctid,str:a.location,lmid:a.lmid,hid:a.hid,nhid:a.nhid,frid:a.frid,rid:a.rid,cid:a.cid},b(this.options.locationInput).data("smarty").setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.location=b(this.options.locationInput).val();a.ctid=b(this.options.ctid).val();a.lmid=b(this.options.lmid).val();a.hid=b(this.options.hid).val();a.nhid=b(this.options.nhid).val();a.frid=b(this.options.frid).val();a.rid=b(this.options.rid).val();
a.cid=b(this.options.cid).val();a.checkinDate=this.getTime(b(this.options.daterangePicker).daterangePicker("getStartDate"));a.checkoutDate=this.getTime(b(this.options.daterangePicker).daterangePicker("getEndDate"));a.rooms=b(this.options.rooms).data("r9NumberBox").getValue();a.guests=b(this.options.guests).data("r9NumberBox").getValue();a.minStars=b(this.options.minStars).val();a.rating=Math.floor(10*b(this.options.rating).val());return a}});R9.extend("Common.SmartyControlGroup.SmartyHorizonFlightControlGroup.prototype",
!0,R9.Common.SmartyControlGroup.prototype,{options:b.extend(R9.Common.SmartyControlGroup.prototype.options,{form:null,formObject:null,originInput:"",destInput:"",originCode:"",destCode:"",daterangePicker:"",cabin:null,travelers:"",nearbyDeparture:"",nearbyArrival:"",smartyObject:"",maxHistory:5,state:null,isRoundTrip:null}),init:function(){this.type="flight"},setFieldsFromHistoryItem:function(a,c){c&&!R9.config.getBoolean("ui.smarty.previewUpdatesForm.enabled",!1)||null==this.options.formObject||
this.options.formObject.updateTravelDateState(this.validateDate(a.startDate),this.validateDate(a.endDate));this.datepicker().setStartDate(this.validateDate(a.startDate));this.datepicker().setEndDate(this.validateDate(a.endDate));b(this.options.nearbyDeparture).prop("checked",a.departureAllowNearby);b(this.options.nearbyArrival).prop("checked",a.arrivalAllowNearby);this.setTravelersFromHistoryItem(a);c?(b(this.options.originInput).val(a.departAirportName),b(this.options.destInput).val(a.destAirportName),
b(this.options.originCode).val(a.departCode),b(this.options.destCode).val(a.destCode)):(c={type:"ap",id:a.departCode,short_str:a.departAirportName},this.options.originInput.getWidget().setItem(c),a={type:"ap",id:a.destCode,short_str:a.destAirportName},this.options.destInput.getWidget().setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.departAirportName=b(this.options.originInput).val();a.destAirportName=b(this.options.destInput).val();a.departCode=b(this.options.originCode).val();a.destCode=
b(this.options.destCode).val();a.startDate=this.getTime(this.datepicker().getStartDate());a.endDate=this.getTime(this.datepicker().getEndDate());a.departureAllowNearby=b(this.options.nearbyDeparture).prop("checked");a.arrivalAllowNearby=b(this.options.nearbyArrival).prop("checked");b(".Common-Widgets-NumberBox",this.options.travelers.elementNode).each(function(){var c=b(this).getWidget(),d=b(this).attr("id").split("-").pop().toLowerCase();a[d]=c.getValue()});a.cabin=this.options.cabin.getValue();
return a},isRoundTrip:function(){return"function"===typeof this.options.isRoundTrip?this.options.isRoundTrip():"checked"===b("#roundtrip").attr("checked")?!0:0<b(".inlineSearchAgainView").length&&"y"!==b('[name\x3d"oneway"]',".inlineSearchAgainView").val()?!0:!1},setTravelersFromHistoryItem:function(a){null!=this.options.cabin&&(this.options.cabin.setValue(a.cabin),this.options.state.cabinDisplayType=this.options.cabin.getSelectedElement().title,this.options.state.cabin=this.options.cabin.getSelectedElement().value);
b(".Common-Widgets-NumberBox",this.options.travelers.elementNode).each(function(){var c=b(this).getWidget(),d=b(this).attr("id").split("-").pop().toLowerCase(),d=a[d];void 0!=c&&c.setValue(d)})},datepicker:function(){return this.options.daterangePicker},setSmarty:function(a){this.options.smartyObject=a},getMaxHistory:function(){return this.options.maxHistory},statusMessage:{adults:"{0} adult",seniors:"{0} senior",children:"{0} child",traveler_count:"1#1 traveller|2#{0} travellers"}});R9.extend("Common.SmartyControlGroup.SmartyHorizonHotelControlGroup.prototype",
!0,R9.Common.SmartyControlGroup.prototype,{options:b.extend(R9.Common.SmartyControlGroup.prototype.options,{form:null,locationInput:"",ctid:"",lmid:"",hid:"",nhid:"",daterangePicker:"",rooms:"",guests:"",minStars:"",priceRange:"",rating:"",smartyObject:"",maxHistory:5}),init:function(){this.type="hotel"},setSmarty:function(a){this.options.smartyObject=a},validateDate:function(a){return null==a?null:this.options.daterangePicker.utils.validate(new Date(a))},getMaxHistory:function(){return this.options.maxHistory},
setFieldsFromHistoryItem:function(a,c){this.options.daterangePicker.setStartDate(this.validateDate(a.checkinDate));this.options.daterangePicker.setEndDate(this.validateDate(a.checkoutDate));this.options.rooms&&this.options.rooms.setValue(a.rooms);this.options.guests.setValue(a.guests);b(this.options.minStars).val(a.minStars);b(this.options.rating).val(Math.floor(a.rating/10));c?(b(this.options.locationInput).val(a.location),b(this.options.ctid).val(a.ctid),b(this.options.lmid).val(a.lmid),b(this.options.hid).val(a.hid),
b(this.options.nhid).val(a.nhid),b(this.options.frid).val(a.frid),b(this.options.rid).val(a.rid),b(this.options.cid).val(a.cid)):this.options.smartyObject.setItem({id:a.ctid,str:a.location,lmid:a.lmid,hid:a.hid,nhid:a.nhid,frid:a.frid,rid:a.rid,cid:a.cid})},saveFieldsToHistoryItem:function(){var a={};a.location=b(this.options.locationInput).val();a.ctid=b(this.options.ctid).val();a.lmid=b(this.options.lmid).val();a.hid=b(this.options.hid).val();a.nhid=b(this.options.nhid).val();a.frid=b(this.options.frid).val();
a.rid=b(this.options.rid).val();a.cid=b(this.options.cid).val();a.checkinDate=this.getTime(this.options.daterangePicker.getStartDate());a.checkoutDate=this.getTime(this.options.daterangePicker.getEndDate());this.options.rooms&&(a.rooms=this.options.rooms.getValue());a.guests=this.options.guests.getValue();a.minStars=b(this.options.minStars).val();a.rating=Math.floor(10*b(this.options.rating).val());return a}});R9.extend("Common.SmartyControlGroup.SmartyCarControlGroup.prototype",!0,R9.Common.SmartyControlGroup.prototype,
{options:{form:null,location:"",location2:"",ctid1:"",ctid2:"",daterangePicker:"",pickupHour:"",dropoffHour:""},init:function(){this.type="car"},isOneWay:function(){return"function"===typeof this.options.isOneWay?this.options.isOneWay():b("#carsearchbar").hasClass("oneway")?!0:0<b(".inlineSearchAgainView").length&&"y"===b('[name\x3d"oneway"]',".inlineSearchAgainView").val()?!0:!1},setFieldsFromHistoryItem:function(a,c){this.datepicker().setStartDate(this.validateDate(a.startDate));this.datepicker().setEndDate(this.validateDate(a.endDate));
b(this.options.pickupHour).val(a.pickupHour);b(this.options.dropoffHour).val(a.dropoffHour);c?(a.airportName?b(this.options.location).val(a.airportDisplayName):b(this.options.location).val(a.location),a.airportName2?b(this.options.location2).val(a.airportDisplayName2):b(this.options.location2).val(a.location2),b(this.options.ctid1).val(a.cityCode),b(this.options.ctid2).val(a.cityCode2)):(c={id:a.cityCode,str:a.airportDisplayName||a.location},b(this.options.location).data("smarty").setItem(c),a={id:a.cityCode2,
str:a.airportDisplayName2||a.location2},b(this.options.location2).data("smarty").setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.location=b(this.options.location).val();a.location2=b(this.options.location2).val();a.cityCode=b(this.options.ctid1).val();a.cityCode2=b(this.options.ctid2).val();a.startDate=this.getTime(this.datepicker().getStartDate());a.endDate=this.getTime(this.datepicker().getEndDate());a.pickupHour=b(this.options.pickupHour).val();a.dropoffHour=b(this.options.dropoffHour).val();
return a}});R9.extend("Common.SmartyControlGroup.SmartyHorizonCarControlGroup.prototype",!0,R9.Common.SmartyControlGroup.prototype,{options:{form:null,location:"",location2:"",ctid1:"",ctid2:"",daterangePicker:"",pickupHour:"",dropoffHour:"",locationSmarty:null,location2Smarty:null},init:function(){this.type="car"},setLocationSmarty:function(a){this.options.locationSmarty=a},setLocation2Smarty:function(a){this.options.location2Smarty=a},getMaxHistory:function(){return this.options.maxHistory},datepicker:function(){return this.options.daterangePicker},
validateDate:function(a){return null==a?null:this.options.daterangePicker.utils.validate(new Date(a))},isOneWay:function(){return"function"===typeof this.options.isOneWay?this.options.isOneWay():"true"==b(".formType.active").attr("data-oneway")?!0:0<b(".inlineSearchAgainView").length&&"y"===b('[name\x3d"oneway"]',".inlineSearchAgainView").val()?!0:!1},setFieldsFromHistoryItem:function(a,c){this.datepicker().setStartDate(this.validateDate(a.startDate));this.datepicker().setEndDate(this.validateDate(a.endDate));
this.options.pickupHour.setValue(a.pickupHour);this.options.dropoffHour.setValue(a.dropoffHour);c?(a.airportName?b(this.options.location).val(a.airportDisplayName):b(this.options.location).val(a.location),a.airportName2?b(this.options.location2).val(a.airportDisplayName2):b(this.options.location2).val(a.location2),b(this.options.ctid1).val(a.cityCode),b(this.options.ctid2).val(a.cityCode2)):(this.options.locationSmarty.setItem({id:a.cityCode,str:a.airportDisplayName||a.location}),a={id:a.cityCode2,
str:a.airportDisplayName2||a.location2},null!=this.options.location2Smarty&&null!=a&&null!=a.str&&this.options.location2Smarty.setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.location=b(this.options.location).val();a.location2=b(this.options.location2).val();a.cityCode=b(this.options.ctid1).val();a.cityCode2=b(this.options.ctid2).val();a.startDate=this.getTime(this.datepicker().getStartDate());a.endDate=this.getTime(this.datepicker().getEndDate());a.pickupHour=this.options.pickupHour.getValue();
a.dropoffHour=this.options.dropoffHour.getValue();return a}})})(jq||jQuery);(function(l){R9.extend("Common",{SmartyHistory:function(a){var c=a.historyType;c||(c="flight");var b=R9.Common.SmartyHistory.prototype["_"+c+"Instance"];if(b)return b.init(),R9.Common.SmartyHistory.prototype["_"+c+"Instance"];this.options=l.extend({},this.options,a);this.init();R9.Common.SmartyHistory.prototype["_"+c+"Instance"]=this}});R9.extend("Common.SmartyHistory",{SmartyFlightHistory:function(a){return R9.Common.SmartyHistory.call(this,l.extend({historyType:"flight"},a))},SmartyHotelHistory:function(a){return R9.Common.SmartyHistory.call(this,
l.extend({historyType:"hotel"},a))},SmartyCarHistory:function(a){return R9.Common.SmartyHistory.call(this,l.extend({historyType:"car"},a))},SmartyClearHistory:function(){"undefined"!==typeof R9Anon&&R9Anon||R9.globals&&R9.globals.anon?(this.currentSmartyHistory&&(this.currentSmartyHistory.clearHistory(),this.currentSmarty.hideDropdown(),this.currentSmarty.runSearch(!1)),R9.Analytics.api.trackEvent("smartyHistory/click/clearHistory/Anon")):(window.location.assign("/history"),R9.Analytics.api.trackEvent("smartyHistory/click/clearHistory/LoggedIn"))}});
R9.extend("Common.SmartyHistory.prototype",{history:null,received:!1,options:{historyType:"flight",maxSearchHistory:30,searchHistorySubtype:"",showPastDates:R9.config.getBoolean("ui.smarty-history.showPastDates",!1)},init:function(){this.received&&null!=this.history||this.update()},update:function(){var a=this;l.ajax({type:"GET",dataType:"json",url:"/s/run/recentsearchhistory/gethistory",data:{searchType:a.options.historyType,maxSearchHistoryNum:a.options.maxSearchHistory,searchHistorySubtype:a.options.searchHistorySubtype},
success:function(c){if(c)for(a.history=c,a.processPastDates(),a.received=!0,c=0;c<a.history.length;c++)a.history[c].idx=c}})},clearHistory:function(){this.history=[];var a=this;l.ajax({type:"POST",url:"/s/run/recentsearchhistory/clearhistory",data:{searchType:a.options.historyType},success:function(c){a.history=[];R9.Analytics.api.trackEvent({category:"Smarty-History",action:"clear-history"})}})},matchWord:function(a,c){var b=a.indexOf(c);0!==b&&(b=a.indexOf(" "+c),-1<b&&(b+=1));return b},processPastDates:function(){var a=
[];if(null!==this.history){for(var c=0;c<this.history.length;c++){var b=this.history[c],e=b.startDate||b.checkinDate,d=b.endDate||b.checkoutDate;if(e&&d){var e=new moment(e),d=new moment(d),g=new moment;e.isBefore(g,"day")||d.isBefore(g,"day")?this.options.showPastDates&&(b.isPast=!0,a.push(b)):a.push(b)}}this.history=a}}});R9.extend("Common.SmartyHistory.SmartyFlightHistory.prototype",!0,R9.Common.SmartyHistory.prototype,{filter:function(a,c,b,e,d){b=b||Infinity;var g=[];if(null==this.history)return[];
var h=[];if(c||""===d)h=this.history;else for(var f=0;f<this.history.length;f++){var k=this.history[f];k.departCode===d&&h.push(k)}h=this.filterByRoundTrip(h,e);if(""===a)return h.slice(0,b);for(f=0;f<h.length&&!(k=h[f],d=k.departShortName+" "+k.departAirportName.toUpperCase(),c||(d=k.destShortName+" "+k.destAirportName.toUpperCase()),-1<this.matchWord(d,a)&&(g.push(k),g.length>=b));f++);return this.filterByRoundTrip(g,e).slice(0,b)},filterByRoundTrip:function(a,c){if(null==a)return[];if(R9.config.getBoolean("ui.flight.smarty-history.separateRTOW",
!1)){for(var b=[],e=0;e<a.length;e++){var d=a[e];d.isRoundTrip===c&&b.push(d)}return b}return a}});R9.extend("Common.SmartyHistory.SmartyHotelHistory.prototype",!0,R9.Common.SmartyHistory.prototype,{filter:function(a,c){c=c||Infinity;var b=[];if(null==this.history)return[];if(""==a)return this.history.slice(0,c);for(var e=0;e<this.history.length;e++){var d=this.history[e],g=d.location.toUpperCase();if(-1<this.matchWord(g,a)&&(b.push(d),b.length>=c))break}return b.slice(0,c)}});R9.extend("Common.SmartyHistory.SmartyCarHistory.prototype",
!0,R9.Common.SmartyHistory.prototype,{filter:function(a,c,b,e){b=b||Infinity;var d=[];if(null==this.history)return[];var g=this.filterByOneWay(this.history,e);if(""===a)return g.slice(0,b);for(var h=0;h<g.length;h++){var f=g[h],k=null==f.airportCode?f.location.toUpperCase():f.location.toUpperCase()+" "+f.airportCode;c||(k=null==f.airportCode2?f.location2.toUpperCase():f.location2.toUpperCase()+" "+f.airportCode2);if(-1<this.matchWord(k,a)&&(d.push(f),d.length>=b))break}return this.filterByOneWay(d,
e).slice(0,b)},filterByOneWay:function(a,c){if(null==a)return[];for(var b=[],e=0;e<a.length;e++){var d=a[e];d.oneWay===c&&b.push(d)}return b}})})(jq||jQuery);function formatDate(a){if(6>a.length||10<a.length)return!1;if(0<=a.indexOf("/")){var c=a.split("/");if(3!=c.length||0==c[0].length||0==c[1].length||0==c[2].length)return!1;a=parseInt(c[1],10);var d=parseInt(c[0],10),c=parseInt(c[2],10)}else if(0<=a.indexOf("-")){c=a.split("-");if(3!=c.length||0==c[0].length||0==c[1].length||0==c[2].length)return!1;a=parseInt(c[2],10);d=parseInt(c[1],10);c=parseInt(c[0],10)}else if(0<=a.indexOf(".")){c=a.split(".");if(3!=c.length||0==c[0].length||0==c[1].length||0==
c[2].length)return!1;a=parseInt(c[0],10);d=parseInt(c[1],10);c=parseInt(c[2],10)}else return!1;100>c&&(c=30>c?c+2E3:c+1900);if(!isValidDate(c,d,a))return!1;var e="";10>d&&(e+="0");e+=d+"/";10>a&&(e+="0");return e+(a+"/")+c}function isValidDate(a,c,d){if(1970<=a){var e=new Date(a,c-1,d);if(d!=e.getDate()||c!=e.getMonth()+1||a!=e.getFullYear())return!1}else if(1>d||31<d||1>c||12<c||1E3>a||3E3<a)return!1;return 28<d&&getNumberOfDays(a,c)<d?!1:!0}
function getNumberOfDays(a,c){switch(c){case 2:return isLeapYear(a)?29:28;case 1:case 3:case 5:case 7:case 8:case 10:case 12:return 31;default:return 30}}function isLeapYear(a){return 0==a%4&&0!=a%100||0==a%400}
function validDate(a){if(0==a.value.length)return!0;if(!formatDate(a.value))return alert("Please enter a valid date. (MM/DD/YYYY format)"),a.focus(),a.select(),!1;var c=formatDate(a.value);if(isNaN(Date.parse(c)))return alert("Please enter a valid date. (MM/DD/YYYY format)"),a.focus(),a.select(),!1;a.value=c;return!0}function parseDate(a){var c=a.split("/");a=parseInt(zeroUnpad(c[0]));var d=parseInt(zeroUnpad(c[1])),c=parseInt(zeroUnpad(c[2]));return new Date(c,a-1,d)}
function zeroPad(a){return 1==a.length?"0"+a:a}function zeroUnpad(a){a=""+a;return a.match(/^0/)?a.substring(1):a}function addDays(a,c){a.setDate(a.getDate()+c);c=a.getMonth()+1;var d=a.getDate();a=a.getYear();1900>a&&(a+=1900);return zeroPad(c)+"/"+zeroPad(d)+"/"+a}
function countDays(a,c){a.setUTCMilliseconds(0);a.setUTCSeconds(0);a.setUTCMinutes(0);a.setUTCHours(12);c.setUTCMilliseconds(0);c.setUTCSeconds(0);c.setUTCMinutes(0);c.setUTCHours(13);a=c.getTime()-a.getTime();return Math.floor(a/864E5)}function existsInArray(a,c){for(var d=0;d<a.length;d++)if(a[d]==c)return!0;return!1}
Date.prototype.formatDate=function(a,c){function d(){return u[b.getDay()]}function e(){return b.getHours()}function k(){return 1==(new String(b.getHours())).length?"0"+b.getHours():b.getHours()}function g(){return 1==(new String(b.getMinutes())).length?"0"+b.getMinutes():b.getMinutes()}function l(){return b.getDate()}function m(){var b=f();return 0==b%4&&0!=b%100||0==b%4&&0==b%100&&0==b%400?1:0}function n(){return v[b.getMonth()]}function h(){return b.getMonth()+1}function p(){var a=Math.abs(b.getTimezoneOffset()),
c=""+Math.floor(a/60),a=""+a%60;1==c.length&&(c="0"+c);1==a.length&&(a="0"+a);return 0>b.getTimezoneOffset()?"+"+c+a:"-"+c+a}function q(){return 1==(new String(b.getSeconds())).length?"0"+b.getSeconds():b.getSeconds()}function f(){if(b.getFullYear){var a=(new Date("January 1 2001 00:00:00 +0000")).getFullYear();if(2001==a)return b.getFullYear()}a=b.getYear();a%=100;return a+(38>a?2E3:1900)}var r={a:function(){return 11<b.getHours()?"pm":"am"},A:function(){return 11<b.getHours()?"PM":"AM"},B:function(){var a=
60*(b.getTimezoneOffset()+60),a=3600*b.getHours()+60*b.getMinutes()+b.getSeconds()+a,a=Math.floor(a/86.4);1E3<a&&(a-=1E3);0>a&&(a+=1E3);1==(""+a).length&&(a="00"+a);2==(""+a).length&&(a="0"+a);return a},d:function(){return 1==(new String(b.getDate())).length?"0"+b.getDate():b.getDate()},D:d,F:function(){return w[b.getMonth()]},g:function(){return 12<b.getHours()?b.getHours()-12:b.getHours()},G:e,h:function(){if(12<b.getHours()){var a=new String(b.getHours()-12);return 1==a.length?"0"+(b.getHours()-
12):b.getHours()-12}a=new String(b.getHours());return 1==a.length?"0"+b.getHours():b.getHours()},H:k,i:g,j:l,l:function(){return x[b.getDay()]},L:m,m:function(){return 9>b.getMonth()?"0"+(b.getMonth()+1):b.getMonth()+1},M:n,n:h,O:p,r:function(){return d()+", "+l()+" "+n()+" "+f()+" "+k()+":"+g()+":"+q()+" "+p()},s:q,t:function(){return 1==m()&&2==h()?29:[null,31,28,31,30,31,30,31,31,30,31,30,31][h()]},T:function(){return e()+":"+g()},U:function(){return Math.round(b.getTime()/1E3)},w:function(){return b.getDay()},
y:function(){var a=f()+"";return a.substring(a.length-2,a.length)},Y:f,z:function(){var a=new Date("January 1 "+f()+" 00:00:00"),a=b.getTime()-a.getTime();return Math.floor(a/1E3/60/60/24)}},x="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),u="Sun Mon Tue Wed Thu Fri Sat".split(" "),v="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),w="January February March April May June July August September October November December".split(" "),b=this;if(c){var t=b.getTime();
b.setTime(c)}a=a.split("");for(c=0;a[c];)"\\"==a[c]?a.splice(c,1):r[a[c]]&&(a[c]=r[a[c]].call()),c++;t&&b.setTime(t);return a.join("")};
Date.prototype.formatUTCDate=function(a,c){function d(){return u[b.getUTCDay()]}function e(){return b.getUTCHours()}function k(){return 1==(new String(b.getUTCHours())).length?"0"+b.getUTCHours():b.getUTCHours()}function g(){return 1==(new String(b.getUTCMinutes())).length?"0"+b.getUTCMinutes():b.getUTCMinutes()}function l(){return b.getUTCDate()}function m(){var a=f();return 0==a%4&&0!=a%100||0==a%4&&0==a%100&&0==a%400?1:0}function n(){return v[b.getUTCMonth()]}function h(){return b.getUTCMonth()+
1}function p(){var a=Math.abs(b.getTimezoneOffset()),c=""+Math.floor(a/60),a=""+a%60;1==c.length&&(c="0"+c);1==a.length&&(a="0"+a);return 0>b.getTimezoneOffset()?"+"+c+a:"-"+c+a}function q(){return 1==(new String(b.getUTCSeconds())).length?"0"+b.getUTCSeconds():b.getUTCSeconds()}function f(){if(b.getUTCFullYear){var a=(new Date("January 1 2001 00:00:00 +0000")).getUTCFullYear();if(2001==a)return b.getUTCFullYear()}a=b.getUTCYear();a%=100;return a+(38>a?2E3:1900)}var r={a:function(){return 11<b.getUTCHours()?
"pm":"am"},A:function(){return 11<b.getUTCHours()?"PM":"AM"},B:function(){var a=60*(b.getTimezoneOffset()+60),a=3600*b.getHours()+60*b.getMinutes()+b.getSeconds()+a,a=Math.floor(a/86.4);1E3<a&&(a-=1E3);0>a&&(a+=1E3);1==(""+a).length&&(a="00"+a);2==(""+a).length&&(a="0"+a);return a},d:function(){return 1==(new String(b.getDate())).length?"0"+b.getDate():b.getUTCDate()},D:d,F:function(){return w[b.getUTCMonth()]},g:function(){return 12<b.getUTCHours()?b.getUTCHours()-12:b.getUTCHours()},G:e,h:function(){if(12<
b.getUTCHours()){var a=new String(b.getUTCHours()-12);return 1==a.length?"0"+(b.getUTCHours()-12):b.getUTCHours()-12}a=new String(b.getUTCHours());return 1==a.length?"0"+b.getUTCHours():b.getUTCHours()},H:k,i:g,j:l,l:function(){return x[b.getUTCDay()]},L:m,m:function(){return 9>b.getUTCMonth()?"0"+(b.getUTCMonth()+1):b.getUTCMonth()+1},M:n,n:h,O:p,r:function(){return d()+", "+l()+" "+n()+" "+f()+" "+k()+":"+g()+":"+q()+" "+p()},s:q,t:function(){return 1==m()&&2==h()?29:[null,31,28,31,30,31,30,31,
31,30,31,30,31][h()]},T:function(){return e()+":"+g()},U:function(){return Math.round(b.getTime()/1E3)},w:function(){return b.getUTCDay()},y:function(){var a=f()+"";return a.substring(a.length-2,a.length)},Y:f,z:function(){var a=new Date("January 1 "+f()+" 00:00:00"),a=b.getTime()-a.getTime();return Math.floor(a/1E3/60/60/24)}},x="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),u="Sun Mon Tue Wed Thu Fri Sat".split(" "),v="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
w="January February March April May June July August September October November December".split(" "),b=this;if(c){var t=b.getTime();b.setTime(c)}a=a.split("");for(c=0;a[c];)"\\"==a[c]?a.splice(c,1):r[a[c]]&&(a[c]=r[a[c]].call()),c++;t&&b.setTime(t);return a.join("")};(function(e,c){var d=null;e.extend("Admin",{AdminTools:function(a){this._tools={};this.setOptions(a)}});e.extend("Admin.AdminTools",{getInstance:function(a,b){b&&d&&(d=d.destroy()&&null);d||(d=(new this(a)).setupDOM());return d}});e.extend("Admin.AdminTools.prototype",{_tools:null,_mainContainer:null,_menuContainer:null,_contentContainer:null,_overlayElement:null,options:{classNameMainContainer:"r9-admin-main",classNameMenuContainer:"r9-admin-menu",classNameContentContainer:"r9-admin-dialog",classNameMenuItem:"r9-admin-menu-item",
classNameContentItem:"r9-admin-tool-container",classNameDialogOverlay:"r9-admin-tool-overlay",classNameDialogOverlayVisible:"r9-admin-tool-overlay-visible",classNameContentVisible:"r9-admin-tool-visible",classNameDialogVisible:"r9-admin-dialog-visible"},setOptions:function(a){this.options=c.extend({},this.options,a||{});return this},destroy:function(){var a,b=this._tools;for(a in b)b.hasOwnProperty(a)&&this.removeTool(b[a]);this.getMainContainer().remove();return this},setupDOM:function(){this.getMenuContainer();
this.getContentContainer();return this},toggleMenu:function(a){var b=this.options.classNameContentVisible;a=this._tools[a.data("id")];a.content.hasClass(b)?this.closeDialog():a.instance.options.dontOpenDialog||(this.openDialog(),this.getContentContainer().find("."+b).removeClass(b),a.instance.onClick(),a.content.addClass(b));return this},openDialog:function(){var a=this.options;this.getContentContainer().addClass(a.classNameDialogVisible);this.getOverlayElement().addClass(a.classNameDialogOverlayVisible);
return this},closeDialog:function(){var a=this.options,b=a.classNameContentVisible,c=this.getContentContainer();c.removeClass(a.classNameDialogVisible);this.getOverlayElement().removeClass(a.classNameDialogOverlayVisible);c.find("."+b).removeClass(b);return this},addTool:function(a){var b=this,d=this.options,e=this._tools,f=a.getId(),g=c('\x3cspan class\x3d"'+d.classNameMenuItem+'"\x3e\x3c/span\x3e'),d=c('\x3cdiv class\x3d"'+d.classNameContentItem+'"\x3e\x3c/div\x3e');e[f]={instance:a,menu:g,content:d};
this.getMenuContainer().append(g.data("id",f).click(function(){b.toggleMenu(c(this))}).append(a.getMenu()));this.getContentContainer().append(d.append(a.getContent()));return this},removeTool:function(a){var b=this._tools;"string"===typeof a&&(a=b[a]);a&&(a.menu.remove(),a.content.remove(),delete b[a.instance.getId()]);return this},getMainContainer:function(){var a=this._mainContainer;a||c("body").append(a=this._mainContainer=c('\x3cdiv class\x3d"'+this.options.classNameMainContainer+' layer-sticky"\x3e\x3c/div\x3e'));
return a},getMenuContainer:function(){var a=this._menuContainer;a||this.getMainContainer().append(a=this._menuContainer=c('\x3cdiv class\x3d"'+this.options.classNameMenuContainer+'"\x3e\x3c/div\x3e'));return a},getOverlayElement:function(){var a=this,b=this._overlayElement;b||this.getMainContainer().prepend(b=this._overlayElement=c('\x3cdiv class\x3d"'+this.options.classNameDialogOverlay+'"\x3e\x3c/div\x3e').click(function(){a.closeDialog()}));return b},getContentContainer:function(){var a=this._contentContainer;
a||this.getMainContainer().append(a=this._contentContainer=c('\x3cdiv class\x3d"'+this.options.classNameContentContainer+'"\x3e\x3c/div\x3e'));return a}})})(window.R9,window.jq||window.jQuery||{});(function(e,b){e.extend("Admin",{AdminContentTable:function(a){this.setOptions(a)}});e.extend("Admin.AdminContentTable.prototype",{_mainElement:null,_titleElement:null,_tableElement:null,_headerElement:null,_contentElement:null,staticScope:void 0,options:{styleClassMainElement:"r9-admin-table-wrapper",styleClassTableTitle:"r9-admin-table-title",styleClassTable:"r9-admin-table"},setOptions:function(a){this.options=b.extend({},this.options,a||{});return this},getMainElement:function(){var a=this._mainElement;
a||(a=this._mainElement=b('\x3cdiv class\x3d"'+this.options.styleClassMainElement+'"\x3e\x3c/div\x3e'));return a},getTitleElement:function(){var a=this._titleElement;a||this.getMainElement().prepend(a=this._titleElement=b('\x3cdiv class\x3d"'+this.options.styleClassTableTitle+'"\x3e\x3c/div\x3e'));return a},getTableElement:function(){var a=this._tableElement;a||this.getMainElement().append(a=this._tableElement=b('\x3ctable class\x3d"'+this.options.styleClassTable+'"\x3e\x3c/table\x3e'));return a},
getHeaderElement:function(){var a=this._headerElement;a||this.getTableElement().prepend(a=this._headerElement=b("\x3cthead\x3e\x3c/thead\x3e"));return a},getContentElement:function(){var a=this._contentElement;a||this.getTableElement().append(a=this._contentElement=b("\x3ctbody\x3e\x3c/tbody\x3e"));return a},setTitle:function(a){this.getTitleElement().html(a);return this},setHeader:function(a){var c,d=0,f=this.getHeaderElement();for(f.children().remove();d<(a=a||[]).length;d++)c=b("\x3cth\x3e\x3c/th\x3e").appendTo(f),
c.html(a[d]);return this},setContent:function(a){var c,d,f,g=0,e=this.getContentElement();for(e.children().remove();g<(a=a||[]).length;g++)for(d=b("\x3ctr\x3e\x3c/tr\x3e").appendTo(e),c=0;c<a[g].length;c++)f=b("\x3ctd\x3e\x3c/td\x3e").appendTo(d),f.html(a[g][c]);return this}})})(window.R9,window.jq||window.jQuery||{});(function(d,c){d.extend("Admin",{AdminContentFilter:function(b){this.setOptions(b)}});d.extend("Admin.AdminContentFilter.prototype",{_mainElement:null,_inputElement:null,staticScope:void 0,options:{classNameWrapperElement:"r9-admin-content-filter",defaultInputPlaceholderContent:"Enter text to filter..."},setOptions:function(b){this.options=c.extend({},this.options,b||{});return this},getMainElement:function(){var b=this._mainElement;b||(b=this._mainElement=c('\x3cdiv class\x3d"'+this.options.classNameWrapperElement+
'"\x3e\x3c/div\x3e'),this.getInputElement());return b},getInputElement:function(){var b=this,a=this._inputElement;a||(a=this._inputElement=c('\x3cinput type\x3d"text" placeholder\x3d"'+this.options.defaultInputPlaceholderContent+'" /\x3e'),a.off("keyup").on("keyup",function(){b.onKeyUp()}).appendTo(this.getMainElement()));return a},onKeyUp:function(){var b=c.trim(this.getInputElement().val()).toLowerCase(),a=this.getMainElement().parent();if(!a)return this;if(!b)return a.find("tr").show(),this;a.find("tr").each(function(){var a=
c(this);"TH"!=a.children().get(0).tagName&&(0>a.text().toLowerCase().indexOf(b)?a.hide():a.show())});a.find("."+d.Admin.AdminContentTable.prototype.options.styleClassMainElement).each(function(){var a=c(this);a.show();1>a.find("tr:visible").length&&a.hide()});return this}})})(window.R9,window.jq||window.jQuery||{});(function(a,e){a.extend("Admin.Tools",{BaseAdminTool:function(a){this.setOptions(a);this._init()}});a.extend("Admin.Tools.BaseAdminTool.prototype",{_loadedContent:null,staticScope:void 0,options:{url:"OVERRIDE_THIS"},setOptions:function(a){this.options=e.extend({},this.options,a||{});return this},loadContent:function(){var b=this,d=this.options.url,c=this._loadedContent;c?this.publishContent(c):e.ajax({url:d,type:"GET",success:function(a){b.processResponse(a,c=b._loadedContent=[]);b.publishContent(c)},
error:function(){a.utils.log("Failed to load experiment information from "+d)}});return this},onClick:function(){this._loadedContent||this.loadContent()},getId:function(){throw a.Debug.err("Extend this method in the specific a child class");},getMenu:function(){throw a.Debug.err("Extend this method in the specific a child class");},getContent:function(){throw a.Debug.err("Extend this method in the specific a child class");},processResponse:function(b,d){throw a.Debug.err("Extend this method in the specific a child class");
},publishContent:function(b){throw a.Debug.err("Extend this method in the specific a child class");},_init:function(){throw a.Debug.err("Extend this method in the specific a child class");}})})(window.R9,window.jq||window.jQuery||{});(function(c,f){c.extend("Admin.Tools",{BaseAdminTableTool:function(a){c.Admin.Tools.BaseAdminTool.call(this,a);this._tables=[]}});c.extend("Admin.Tools.BaseAdminTableTool.prototype",c.Admin.Tools.BaseAdminTool.prototype,{_filter:null,_tables:null,_contentWrapperElement:null,staticScope:void 0,options:{classNameContentWrapper:"OVERRIDE_THIS",tableHeader:["OVERRIDE_THIS"]},onClick:function(){c.Admin.Tools.BaseAdminTool.prototype.onClick.call(this);this.getFilter().getInputElement()[0].focus()},getFilter:function(){var a=
this._filter;a||(a=this._filter=new c.Admin.AdminContentFilter);return a},publishContent:function(a){for(var d,b=0,e=this._tables,f=this.getContentWrapper();b<e.length;b++)e[b].getMainElement().remove(),e[b]=null;for(b=e.length=0;b<a.length;b++)e.push(d=new c.Admin.AdminContentTable),d.setTitle(a[b].title),d.setHeader(this.options.tableHeader),d.setContent(a[b].content),f.append(d.getMainElement());return this},getContentWrapper:function(){var a=this._contentWrapperElement;a||(a=this._contentWrapperElement=
f('\x3cdiv class\x3d"'+this.options.classNameContentWrapper+'"\x3e\x3c/div\x3e'));return a},_init:function(){}})})(window.R9,window.jq||window.jQuery||{});(function(h,d){h.extend("Admin.Tools",{ExperimentTool:function(b){h.Admin.Tools.BaseAdminTableTool.call(this,b)}});h.extend("Admin.Tools.ExperimentTool.prototype",h.Admin.Tools.BaseAdminTableTool.prototype,{_menuElements:null,_contentElements:null,staticScope:void 0,options:{url:"/labxp-ajax",urlAssign:"/labxpassign?newxps\x3d{0}.{1}\x26url\x3d{2}",jiraUrlFormat:"https://jira.runwaynine.com/browse/{0}",currentExperiments:"",menuLabelPrefix:"Experiments: ",menuLabelAppendix:"active",labelActiveExperiment:"Activate control xp",
labelPerformance:"Performance",labelActiveExperimentList:"Active experiment list",classNameMenuPrefix:"r9-admin-menu-xp-prefix",classNameContentWrapper:"r9-admin-content-xp",classNameMenuValue:"r9-admin-menu-xp-value",classNameRunAlonePrefix:"r9-admin-content-xp-ra-",classNameActivePrefix:"r9-admin-content-xp-active-",classNameExperimentList:"r9-admin-content-xp-list",classNameExperimentListHeader:"r9-admin-content-xp-list-header",classNameExperimentListContent:"r9-admin-content-xp-list-content",
tableHeader:"#;Name;JIRA;%;Control %;Run Alone;Lifetime;Owner;Start date;Description;Assign Control;Performance".split(";")},getId:function(){return"experiments"},getMenu:function(){var b,e,a=this.options,c=this._menuElements;b=a.currentExperiments;c||(b=1===(e=b.split(",").length)?b?b:"undefined":e+" "+a.menuLabelAppendix,c=this._menuElements=d('\x3cspan class\x3d"'+a.classNameMenuPrefix+'"\x3e\x3c/span\x3e').html(a.menuLabelPrefix),c=c.add(d('\x3cspan class\x3d"'+a.classNameMenuValue+'"\x3e\x3c/span\x3e').html(b)));
return c},getContent:function(){var b;b=this.options;var e=this._contentElements;e||(b=d('\x3cdiv class\x3d"'+b.classNameExperimentList+'"\x3e\x3c/div\x3e').append(d('\x3cdiv class\x3d"'+b.classNameExperimentListHeader+'"\x3e\x3c/div\x3e').html(b.labelActiveExperimentList)).append(d('\x3cdiv class\x3d"'+b.classNameExperimentListContent+'"\x3e\x3c/div\x3e').html(b.currentExperiments.replace(/,/g,", "))),e=b.add(this.getFilter().getMainElement()).add(this.getContentWrapper()));return e},processResponse:function(b,
e){for(var a,c,t,l,m,n,g,u,p,q=0,v=this,f=this.options,r=h.Common.Utils.String,k;q<(b=b||[]).length;q++){n=[];l=b[q];c=l.content;for(a=0;a<c.length;a++)g=c[a].isReset,p=c[a].isActiveControl,u=c[a].isActive||p,m=c[a].isRunAlone?"Y":"N",t=r.formatString(f.urlAssign,c[a].name,c[a].type,window.location.pathname),k=c[a].jira,n.push([d('\x3cspan class\x3d"'+f.classNameActivePrefix+(u?"Y":"N")+'"\x3e'+(p?"C":"A")+"\x3c/span\x3e"),d('\x3ca href\x3d"'+t+'"\x3e'+c[a].name+"\x3c/a\x3e").click(function(){return v.setActiveXp(d(this))}),
k?d('\x3ca href\x3d"'+r.formatString(f.jiraUrlFormat,k)+'" target\x3d"_blank"\x3e'+k+"\x3c/a\x3e"):" ",g?" ":c[a].weight,g?" ":c[a].controlWeight,g?" ":d('\x3cspan class\x3d"'+f.classNameRunAlonePrefix+m+'"\x3e'+m+"\x3c/span\x3e"),c[a].lifetime||" ",c[a].owner||" ",c[a].startDate||" ",c[a].description||" ",g?" ":d('\x3ca href\x3d"'+r.formatString(f.urlAssign,c[a].controlName,c[a].type)+'"\x3e\x3c/a\x3e').html(f.labelActiveExperiment).click(function(){return v.setActiveXp(d(this))}),g?" ":d('\x3ca href\x3d"'+
c[a].performanceUrl+'" target\x3d"_blank"\x3e'+f.labelPerformance+"\x3c/a\x3e")]);e.push({title:l.title,content:n})}},setActiveXp:function(b){(b=b.attr("href"))&&d.ajax({url:b,type:"GET",complete:function(){window.location.reload()}});return!1}})})(window.R9,window.jq||window.jQuery||{});(function(d,b){d.extend("Admin.Tools",{FeatureTool:function(a){d.Admin.Tools.BaseAdminTableTool.call(this,a)}});d.extend("Admin.Tools.FeatureTool.prototype",d.Admin.Tools.BaseAdminTableTool.prototype,{_menuElements:null,_contentElements:null,staticScope:void 0,options:{url:"/features",menuLabel:"Features",classNameMenuPrefix:"r9-admin-menu-features",classNameContentWrapper:"r9-admin-content-features"},getId:function(){return"features"},getMenu:function(){var a=this.options,c=this._menuElements;c||
(c=this._menuElements=b('\x3cspan class\x3d"'+a.classNameMenuPrefix+'"\x3e\x3c/span\x3e').html(a.menuLabel));return c},getContent:function(){var a=this._contentElements;a||(a=this.getFilter().getMainElement().add(this.getContentWrapper()));return a},processResponse:function(a,c){var d=this,g=this.options,e=b("\x3cdiv\x3e\x3c/div\x3e");e.get(0).innerHTML=a;b(".xptbl",e).each(function(a,e){var f=[];a=d._findMatchingHeading(e);b(e).find("tr").each(function(){var a=b(this).children();if("TH"!=a.get(0).tagName){var c=
b(a.get(g.tableColumnIndexForName)).find("a");c.length&&f.push([b('\x3ca href\x3d"'+c.attr("href")+'"\x3e\x3c/a\x3e').html(b.trim(c.text())).click(function(){return d.onFeatureNameClick(b(this))}),b.trim(b(a.get(g.tableColumnIndexForDescription)).text())])}});f.length&&c.push({title:b.trim(a),content:f})})},onFeatureNameClick:function(a){(a=a.attr("href"))&&b.ajax({url:a,type:"GET",complete:function(){window.location.reload()}});return!1},_findMatchingHeading:function(a){a=b(a);return a.length?"H2"==
a.get(0).tagName?a.text():this._findMatchingHeading(a.prev()):null}})})(window.R9,window.jq||window.jQuery||{});(function(f,b){f.extend("Admin.Tools",{CookieTool:function(a){f.Admin.Tools.BaseAdminTableTool.call(this,a)}});f.extend("Admin.Tools.CookieTool.prototype",f.Admin.Tools.BaseAdminTableTool.prototype,{_menuElements:null,_contentElements:null,_contentWrapperElement:null,_addCookieFormElement:null,staticScope:void 0,options:{url:"/k/cookie",menuLabelContent:"Cookies",labelAddCookieHeader:"Add new cookie",labelTypeMetaCookie:"Meta cookie",labelTypeRawCookie:"Raw cookie",placeholderCookieName:"New cookie name",
placeholderCookieValue:"New cookie value",labelAddCookieSubmit:"Add cookie",classNameMenu:"r9-admin-menu-cookies",classNameContentWrapper:"r9-admin-content-cookies",classNameAddCookieWrapper:"r9-admin-cookies-form-wrapper",classNameAddCookieHeader:"r9-admin-cookies-form-header",classNameAddCookieTypes:"r9-admin-cookies-form-types",classNameAddCookieFields:"r9-admin-cookies-form-fields",tableHeader:["#","Cookie name","Cookie value"]},getId:function(){return"cookies"},getMenu:function(){var a=this.options,
c=this._menuElements;c||(c=this._menuElements=b('\x3cspan class\x3d"'+a.classNameMenu+'"\x3e\x3c/span\x3e').html(a.menuLabelContent));return c},getContent:function(){var a=this._contentElements;a||(a=this._contentElements=this.getAddCookieForm().add(this.getFilter().getMainElement()).add(this.getContentWrapper()));return a},getAddCookieForm:function(){var a,c=this,d=this.options,e=this._addCookieFormElement;e||(e=this._addCookieFormElement=b('\x3cdiv class\x3d"'+d.classNameAddCookieWrapper+'"\x3e\x3c/div\x3e'),
e.append(b('\x3cdiv class\x3d"'+d.classNameAddCookieHeader+'"\x3e\x3c/div\x3e').html(d.labelAddCookieHeader)).append(a=b("\x3cform\x3e\x3c/form\x3e")),a.append(b('\x3cdiv class\x3d"'+d.classNameAddCookieTypes+'"\x3e\x3c/div\x3e').append('\x3clabel\x3e\x3cinput type\x3d"radio" name\x3d"type" value\x3d"meta" checked\x3d"checked" /\x3e'+d.labelTypeMetaCookie+'\x3c/label\x3e\x3clabel\x3e\x3cinput type\x3d"radio" name\x3d"type" value\x3d"raw" /\x3e'+d.labelTypeRawCookie+"\x3c/label\x3e")),a.append(b('\x3cdiv class\x3d"'+
d.classNameAddCookieFields+'"\x3e\x3c/div\x3e').append('\x3cinput type\x3d"text" name\x3d"name" placeholder\x3d"'+d.placeholderCookieName+'" /\x3e\x3cinput type\x3d"text" name\x3d"value" placeholder\x3d"'+d.placeholderCookieValue+'" /\x3e\x3cinput type\x3d"submit" value\x3d"'+d.labelAddCookieSubmit+'" /\x3e')),a.on("submit",function(){return c.onAddCookieSubmit(b(this))}));return e},processResponse:function(a,c){var d=this;b('table[classname\x3d"code"]',a).each(function(a,f){var e={title:b(f).parent().children("h2").html(),
content:[]};b(this).find("tr").each(function(){var a=b(this).children("td");e.content.push([b(a.get(0)).find("form").on("submit",function(){return d.removeCookie(b(this))}),encodeURIComponent(b(a.get(1)).find("input").val()),encodeURIComponent(b(a.get(2)).find("input").val())])});c.push(e)})},onAddCookieSubmit:function(a){var c,d=this.options.url,e=a.find("input");a=e.filter("[name\x3dtype]:checked").val();var g=e.filter("[name\x3dname]").val(),e=e.filter("[name\x3dvalue]").val();switch(a){case "meta":c=
{metacookie:g,metavalue:e,url:d,action:"setmeta",formtoken:f.globals.formtoken};break;case "raw":c={rawcookie:g,rawvalue:e,url:d,action:"setraw",formtoken:f.globals.formtoken}}c&&b.ajax({url:d,type:"POST",data:c,success:function(){window.location.reload()}});return!1},removeCookie:function(a){var c={};a.find("input").each(function(){var a=b(this);c[a.attr("name")]=a.val();c.formtoken=f.globals.formtoken});b.ajax({url:a.attr("action"),type:a.attr("method")||"POST",data:c,success:function(){window.location.reload()}});
return!1}})})(window.R9,window.jq||window.jQuery||{});(function(c,b){c.extend("Admin.Tools",{FindTemplateTool:function(b){c.Admin.Tools.BaseAdminTool.call(this,b)}});c.extend("Admin.Tools.FindTemplateTool",{highlightElements:function(){function e(a){var e,f=[],d;g.remove();h.remove();a=b(document.elementFromPoint(a.clientX,a.clientY));g.css({top:a.offset().top,left:a.offset().left,width:a.width(),height:a.height()});h.css({top:a.offset().top,left:a.offset().left});a.addClass("SPECIALMARKER");for(e=document.body.innerHTML;d=m.exec(e);)f.push(d);a.removeClass("SPECIALMARKER");
0===f.length&&alert("Can't find any debugging comment. Please add nucleus.velocity.adddebugcomments\x3dtrue to dev-user.properties and rebuild.");f=c(f);null!==f&&(g.appendTo("body"),h.text(f).appendTo("body"))}function k(){g.remove();h.remove();b(document).off("mousemove",e);b(document).off("click",k);l.removeClass("active")}function c(a){function b(d,c){for(;d<a.length;d++)if("start"===a[d][1])d=b(d+1,a[d][2]);else{if("end"===a[d][1])return console.assert(a[d][2]===c,a[d][2]+" is different from "+
c),d;"SPECIALMARKER"===a[d][3]?e=c:console.assert(!1,"Unexpected",a[d])}}var e=null;b(0,"Root template");return e}var l=b(".r9-admin-menu-find-template"),m=/(?:\x3c!-- (start|end) parse(?:original)?\(([^)]+)\) --\x3e|(SPECIALMARKER))/g,g=b("\x3cdiv\x3e").css({position:"absolute",zIndex:9999999999,background:"rgba(0, 200, 200, 0.5)"}),h=b("\x3cdiv\x3e").css({position:"absolute",zIndex:9999999999,padding:"0 5px",lineHeight:"20px",background:"rgba(255, 255, 255, 0.8)"});b(document).mousemove(e);b(document).click(k);
l.addClass("active")}});c.extend("Admin.Tools.FindTemplateTool.prototype",c.Admin.Tools.BaseAdminTool.prototype,{_menuElements:null,options:{menuLabelContent:"Find template",classNameMenu:"r9-admin-menu-find-template",dontOpenDialog:!0},setOptions:function(e){this.options=b.extend({},this.options,e||{});return this},getId:function(){return"find-template"},getMenu:function(){var e=this.options,c=this._menuElements;c||(c=this._menuElements=b('\x3ca href\x3d"javascript:R9.Admin.Tools.FindTemplateTool.highlightElements()" class\x3d"'+
e.classNameMenu+'"\x3e\x3c/a\x3e').html(e.menuLabelContent));return c},getContent:function(){return b()},_init:function(){}})})(window.R9,window.jq||window.jQuery||{});function kmail(a){document.write('\x3ca class\x3d"mlink" href\x3d"mailto:'+a+'\x26#64;kayak\x26#46;com"\x3e'+a+"\x26#64;kayak\x26#46;com\x3c/a\x3e")}function kmail2(a,b){document.write('\x3ca class\x3d"mlink" href\x3d"mailto:'+a+"\x26#64;"+b+'"\x3e'+a+"\x26#64;"+b+"\x3c/a\x3e")}function validateEmail(a){if(!a||!a.match)return!1;a=a.match(/^[A-Z0-9._%+-]{1,63}@(?:[A-Z0-9-]+\.){1,125}[A-Z]{2,63}$/i);return!!(a&&a[0]&&a[0].length)}
function getRadioValue(a){return jq(a).filter(":checked").val()||null}function showmessage(a,b){var c=jq("#messagebox");c.length||(c=jq("\x3cdiv id\x3d'messagebox'\x3e\x3c/div\x3e").appendTo("body").r9dialog({autoOpen:!1,closeOnEscape:!1,dialogClass:"messagebox",modal:!1,position:["center",185],showCloseX:!1}));c.html(a);b?c.r9dialog("option","title",b).r9dialog("widget").removeClass("ui-dialog-no-title"):c.r9dialog("widget").addClass("ui-dialog-no-title");c.r9dialog("open")}
function hidemessage(){0<jq("#messagebox").length&&jq("#messagebox").r9dialog("close")}function msie(a){return jq.browser.msie&&(!a||a>=jq.browser.version-0)&&jq.browser.version-0||0}function getFader(){var a=jq("#faderPane");a.length||(a=jq("\x3cdiv id\x3d'faderPane' class\x3d'faderPane'\x3e\x3c/div\x3e").appendTo("body"));return a}
function toggleFaderPane(a,b){fader=getFader();a?(fader.css("height",jq(window).height()).show(),jq(window).resize(function(){fader.css("height",jq(window).height())})):fader.hide();hideMeOnPopup(a);fader[0].onclick="function"==typeof b&&a?b:null}function htmlSafe(a){return a.replace(/\&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/\"/g,"\x26quot;").replace(/\'/g,"\x26#39;")}function stripSpaces(a){return a.replace(/\s/g,"")}
function safeSpaces(a){return a.replace(/\s/g,"%20")}
function displaysmartad(a,b){if(!window.skipSmartAd){var c=jq(a).contents().find("iframe");null!=c&&0<c.length&&(a=c);a=jq(a).contents().find("body #smtdiv");try{var d=eval("smtad\x3d"+jq(a).text());d.searchid=d.searchid||window.searchid;d.provider_code&&d.searchid&&(getsmartadcreative(b,d.provider_code,d.searchid,d.click_tracking,d.sz,!0,Streaming.done),Streaming.done||pollsmartadcreative(b,d.provider_code,d.searchid,d.click_tracking,d.sz))}catch(e){}}}
function getsmartadcreative(a,b,c,d,e,f,g){var k=document.getElementById("displayAd"+a),h;if(R9.Ads.SmartAd.imageSlotEnabled)if("0"===a)h="R0";else if("1"===a)h="R1";else{if("4"===a||"3"===a)h="M0"}else"1"===a?h="R0":"3"===a&&(h="M0");h||(h="R0");k&&(b="/h/ads/smartad?provider_code\x3d"+safeSpaces(b)+"\x26searchid\x3d"+c+"\x26clicktracking\x3d"+encodeURIComponent(d)+"\x26sz\x3d"+e+"\x26rank\x3d"+a+"\x26logimpr\x3d"+f+"\x26strm\x3d"+g+"\x26pageorigin_location\x3d"+h+"\x26isstreaming\x3d"+("undefined"!==
typeof Streaming?Streaming.done:!1),-1==navigator.appVersion.indexOf("MSIE")||window.showNewGPTAds?setIframeUrl(k,b):(a=document.getElementById("displayAdSpanFrame"+a),a.innerHTML=a.innerHTML.replace(/src="[^"]*"/,'src\x3d"'+b+'"')))}function pollsmartadcreative(a,b,c,d,e){Streaming.done?getsmartadcreative(a,b,c,d,e,!1,!0):setTimeout(function(){pollsmartadcreative(a,b,c,d,e)},1E3)}function loadDisplayAds(){window.showNewGPTAds&&showNewGPTAds()}
function displayGPTCallback(){jq("div.GPT").each(function(){var a=jq(this),b=a.attr("id").replace("displayAd","");try{var c=jq(a).find("iframe").contents().find("body #smtdiv");c&&1==c.length&&displaysmartad(jq(a).find("iframe"),b)}catch(d){}})}jq(loadDisplayAds);
function resizeIframeToContents(a){if(!window.showNewGPTAds&&null!=a){var b=jq(a).contents().find("iframe");null!=b&&0<b.length&&(a=b);var b=jq(a).attr("id").replace("displayAd","displayAdHide"),c=!1,d=jq(a).contents().find("body img");d&&0!=d.length||(d=jq(a).contents().find("iframe").contents().find("body img"));d&&1==d.length&&null!=d.attr("src")&&0<d.attr("src").indexOf("/kayakadpixel.gif")&&(c=!0);d&&0!=d.length||((d=jq(a).contents().find("iframe").contents().find("body div.kayakadpixel"))&&
1==d.length?c=!0:(d=jq(a).contents().find("iframe").contents().find("body \x3e *"))&&0!=d.length||(c=!0));c?(a=b.replace("displayAdHide",""),jq("#bannerad"+a).hide(),jq("#"+b).hide()):(jq("#"+b).css("visibility","visible"),a=b.replace("displayAdHide",""),jq("#bannerad"+b.replace("displayAdHide","")).show(),"2"==a&&jq("#"+b).show())}}var clearFlagTimer=null,canReloadAds=!0;
function reloadBannerAds(){function a(a){var b=document.getElementById(a);if(null!=b){if(!b.src){window.Streaming&&Streaming.dbg(a+" NAF");return}var c=-1!=navigator.appVersion.indexOf("MSIE")?b.contentWindow.location.href:b.src;"undefined"!=typeof document.bannerUrls&&null!=document.bannerUrls[a]&&(c=document.bannerUrls[a]);a=(new Date).getTime();var c=(0>c.indexOf("\x26ad_ts\x3d")?c+"\x26ad_ts\x3d"+(new Date).getTime():c.substring(0,c.indexOf("\x26ad_ts")))+"\x26ad_ts\x3d"+(new Date).getTime(),
f=/ord%3D([0-9]*)%3F/;c.match(f)&&(c=c.replace(f,"ord%3D"+a+"%3F"));var g=jq(b).hasClass("hideAllAds");setIframeUrl(b,c);jq(b).load(function(){if(g)var a=0,c=setInterval(function(){try{2==a&&(jq(b).hasClass("hide_all_displayed_ads_before_load")||jq(b).addClass("hide_all_displayed_ads_before_load")),50<jq(b).contents().find("#output").height()&&(jq(b).removeClass("hide_all_displayed_ads_before_load"),clearInterval(c)),30<a++&&clearInterval(c)}catch(l){clearInterval(c)}},1E3)})}0<jq("#displayAdSpanFrame2").length?
jq("#displayAdHide2").show():jq("#displayAdHide2").hide()}function b(a){return(a=document.getElementById(a))&&"none"!=a.style.display}canReloadAds?(canReloadAds=!1,window.refreshGPTAds?refreshGPTAds():(a("displayAd1","1"),b("bannerad2")&&a("displayAd2","2"),b("bannerad3")&&a("displayAd3","3"),b("bannerad4")&&a("displayAd4","4")),R9.Analytics.api.trackEvent("bannerreload")):clearTimeout(clearFlagTimer);(function(){clearFlagTimer=setTimeout(function(){canReloadAds=!0},R9.globals.adsRefreshTimer||2500)})()}
function loadTT(a,b){var c=a.match(/^\#ttip(.*)/),d=c&&c[1];if(!d||jq(a).length)b();else{var c=function(){jq(a).length||jq("\x3cdiv id\x3d'ttip"+d+"'\x3e\x3c/div\x3e").appendTo("body");b()},e={action:"ttip",t:d};if(R9.ttip&&R9.ttip[d]){if(R9.ttip[d].empty)return c();jq.extend(e,R9.ttip[d].params)}return ssAJAX("/s/toolbox",e,c)}}
function showTT(a,b,c,d,e,f){loadTT("#ttip"+c,function(){""!=b&&jq("#ttipText"+c).html(b);"BL"==c?jq("#ttip"+c).css({left:"-9999",visibility:"visible"}).show(function(){_showTT(a,b,c,d,e,f)}):_showTT(a,b,c,d,e,f)})}
function _showTT(a,b,c,d,e,f){if(null==e||!e)hideAllTT(!1);else if(null!=f)for(parts=f.split(","),b=0;b<parts.length;b++)hideTTType(parts[b]);b=jq("#ttip"+c);obj=document.getElementById("ttip"+c);obj.style.display="block";f=jq(a).offset();e=f.top;f=f.left;null!=d&&(e+=d.y,f+=d.x);if("BL"==c)b.show(function(){jq(this).position({my:"left bottom",at:"left top",offset:"-30 5",of:jq(a)})});else{if("TL"==c)e=e+a.offsetHeight-5,f=f+a.offsetWidth-50;else if("CL"==c)e=e+a.offsetHeight-30,f=f+a.offsetWidth+
25;else if("CR"==c||"FSP"==c)e=e-b.outerHeight()/2+a.offsetHeight/2,f="CL"==c||"FL"==c||"FSP"==c?f+a.offsetWidth:f-b.outerWidth();else if("FL"==c)f=f+jq(a).outerWidth()+20,e=e+jq(a).outerHeight()/2-65;else if("DL"==c)f+=jq(a).outerWidth(),e=e+jq(a).outerHeight()/2-50,obj.style.zIndex="45";else if("DR"==c)e=e+jq(a).outerHeight()/2-50,f-=jq(obj).outerWidth()+3,obj.style.zIndex="45";else if("CT"==c||"CB"==c)e=e-0+a.offsetHeight,!jq.browser.mozilla&&!jq.browser.safari||"CL"!=c&&"FL"!=c?jq.browser.msie&&
parseInt(jq.browser.version):e+=8,f-=obj.offsetWidth/2;jq(obj).css({top:e,left:f,visibility:"visible"})}}function hideAllTT(a){-1!=navigator.appVersion.indexOf("MSIE 6.")&&jq("select.hideOnTT").css("visibility","visible");null==a&&(a=!0);jq.each("BL TL CL CR CB CT DL DR FL FSP DX DXC DT DG SHR HP SLT SLB".split(" "),function(){hideTTType(this)});try{jq("#createShareDiv").r9popover("close")}catch(b){}"function"==typeof localTTHidden&&a&&localTTHidden();jq("div.hideableTT").hide()}
function hideTTType(a){jq("#ttip"+a).hide()}function simpleurl(a){if(null==a)return a;var b=0==a.indexOf("http://"),c=a.indexOf("/",b?7:0);a=0<c?a.substring(b?7:0,c):a.substring(b?7:0);return 0==a.indexOf("www.")?a.substring(4):a}function cleanUrl(a,b){b="http"+(!0===b||"true"===b?"s":"");""!=a&&(0>a.indexOf("http")?a=b+"://"+a.slice(0,1017):0!=a.indexOf(b)&&0==a.indexOf("http")&&(a=b+a.slice(4,1017)));return a}
function replaceArgs(){str=arguments[0];for(var a=1;a<=arguments.length;a++)str=str.replace("{"+(a-1)+"}",arguments[a]);return str}"undefined"==typeof String.prototype.localeCompare&&(String.prototype.localeCompare=function(a){return this<a?-1:this>a?1:0});var R9_DisplayEds_JustHidden=!1;function hideDisplayAds(a){R9_DisplayEds_JustHidden=!0;null==a||a?(AjaxReg.regtype="displayad",AjaxReg.ui.register(function(){AjaxAlert.disableDisplayAds()})):AjaxAlert.disableDisplayAds()}
function StringBuilder(a){this.strings=[""];this.append(a)}jq.extend(StringBuilder.prototype,{append:function(a){a&&this.strings.push(a);return this},clear:function(){this.strings.length=1}});StringBuilder.prototype.toString=function(){return this.strings.join("")};function r9Float(a){return a-0}function hideMeOnPopup(a){jq("div.hideMeOnPopup").css({visibility:null==a||a?"hidden":"visible"})}
function hideOnOutsideClick(a,b){a=(b?".":"#")+a;jq("body").click(function(){jq(a).hide().unbind("click");jq("body").unbind("click")});jq(a).click(function(a){a.stopPropagation()})}function setToAnchor(a,b,c,d,e){var f=jq("#"+b).offset(),g=jq("#"+a).outerWidth();b=jq("#"+b).outerWidth();var k=f.left,f=f.top;"left"==c?k-=g:"right"==c&&(k+=b);0!=d&&(f+=d);0!=e&&(k+=e);jq("#"+a).css({position:"absolute",left:k,top:f,zIndex:50})}
function gradientDialogCleanup(){function a(){jq(".dialog_top").hide().show()}a();window.setTimeout(a,2E3)}function evalScript(a){a.src?jq.ajax({url:a.src,async:!1,dataType:"script"}):jq.globalEval(a.text||a.textContent||a.innerHTML||"");a.parentNode&&a.parentNode.removeChild(a)}function loadResults(a){showRPSpinner(R9.globals.messages.searchInProgress);jq.cookie("nus","t",{path:"/"});R9.ViewState.getInstance().reset();document.location.href=a}
function showRPSpinner(a,b){b=b||1;jq(".RPTopText").html(a);a=jq(".resbodySpinnerContainer");a.css({display:"block"});a.stop().animate({opacity:b},150)}function hideRPSpinner(){var a=jq(".resbodySpinnerContainer");a.stop().animate({opacity:0},150,function(){a.css({display:"none"})});removeCarResultsFade()}function addCarResultsFade(){jq(".carOuterResults #listbody").addClass("resultsFade")}function removeCarResultsFade(){jq(".carOuterResults #listbody").removeClass("resultsFade")}
function logTiming(a,b,c,d,e){c-=b;d-=b;b=e-b;jq.post("/s/sparkle",{searchid:a,action:"ss",rt:c,ht:d,st:b});R9&&(R9.extend("globals",{logTiming:"\x3cb\x3ePerformance metrics:\x3c/b\x3e\x3cbr /\x3eresp: "+c+"\x3cbr /\x3ehtml: "+d+"\x3cbr /\x3escript: "+b+"\x3cbr /\x3e"}),"undefined"==typeof FilterList&&displayLogTiming())}function displayLogTiming(){R9&&R9.globals&&R9.globals.logTiming&&jq("#kayak_pm_0001").html(R9.globals.logTiming)}
function deepExtend(a,b){if(!a)return b;jq.each(b,function(b,d){a[b]=deepExtend(a[b],d)});return a}function setIframeUrl(a,b){var c=R9.Common.Utils.getId();a.contentWindow?a.contentWindow.location.replace(b):jq(a).html("\x3ciframe id\x3d"+c+" onLoad\x3d\"autoResize('"+c+"');\" frameborder\x3d'0' scrolling\x3d'no' style\x3d'text-align:center;margin:0;padding:0;' src\x3d'"+b+"'\x3e\x3c/iframe\x3e")}
function autoResize(a){function b(){var d=document.getElementById(a);if(d&&d.contentWindow)var e=jq(d.contentWindow.document.body).height(),f=jq(d.contentWindow.document.body).width();d=jq(d);e&&0<e&&f&&0<f&&(d.css({height:e+"px",width:f+"px"}),d.attr("height",String(e)+"px"),d.attr("width",String(f)+"px"));0<c--&&setTimeout(b,500)}var c=3;try{b()}catch(d){}}R9.metacookie=R9.metacookie||{};R9.metacookie.saveQueue=R9.metacookie.saveQueue||[];
function saveQueuedMetaCookie(){if(0!=R9.metacookie.saveQueue.length){var a=R9.metacookie.saveQueue[0];jq.ajax({type:"POST",url:"/k/cookie",data:{action:"setmeta",metacookie:a.name,metavalue:a.value,formtoken:R9.globals.formtoken},complete:function(){R9.metacookie.saveQueue.shift();saveQueuedMetaCookie()},success:function(){a.callback()}})}}function setMetaCookie(a,b,c){R9.metacookie.saveQueue.push({name:a,value:b,callback:c||jq.noop});1==R9.metacookie.saveQueue.length&&saveQueuedMetaCookie()}
function deleteMetaCookie(a,b){"undefined"!=typeof b&&b||(b=jq.noop);jq.ajax({type:"POST",url:"/k/cookie",data:{action:"deletemeta",metacookie:a,formtoken:R9.globals.formtoken},success:b})}function attachEmailDisclaimerTooltip(){jq("#emailSpecialDealsLabel \x3e a").tipTip({delay:0,fadeOut:400})}
function initScrollbarSize(){var a=jq("\x3cp\x3e\x3c/p\x3e")[0];a.style.width="100%";a.style.height="200px";var b=jq("\x3cdiv\x3e\x3c/div\x3e")[0];b.style.position="absolute";b.style.top="0px";b.style.left="0px";b.style.visibility="hidden";b.style.width="200px";b.style.height="150px";b.style.overflow="hidden";b.appendChild(a);document.body.appendChild(b);var c=a.offsetWidth;b.style.overflow="scroll";a=a.offsetWidth;c==a&&(a=b.clientWidth);document.body.removeChild(b);window.scrollbarSize=c-a}
function getScrollbarSize(){window.scrollbarSize||initScrollbarSize();return window.scrollbarSize}function disableSelection(a){"undefined"!=typeof a.onselectstart?a.onselectstart=function(){return!1}:"undefined"!=typeof a.style.MozUserSelect?a.style.MozUserSelect="none":a.onmousedown=function(){return!1}}
function refreshGPTAds(){try{if("undefined"!==typeof cygnus_index_start)cygnus_index_start();else if("undefined"!==typeof amznads)amznads.getAdsCallback("3131",function(){window.googletag.pubads().clearTargeting("amznslots");amznads.setTargetingForGPTAsync("amznslots");window.googletag.pubads().refresh();window.setTimeout("displayGPTCallback()",500);window.setTimeout("displayGPTCallback()",800);window.setTimeout("displayGPTCallback()",1500);window.setTimeout("displayGPTCallback()",2500)});else{if(R9.config.getBoolean("ui.gpt.isAppendRefreshAnimate",
!0)){var a=googletag.pubads().getSlots();if(a)for(var b=0;b<a.length;b++)a[b].setTargeting&&a[b].setTargeting("animated","no")}window.googletag.pubads().refresh();window.setTimeout("displayGPTCallback()",500);window.setTimeout("displayGPTCallback()",800);window.setTimeout("displayGPTCallback()",1500);window.setTimeout("displayGPTCallback()",2500)}}catch(c){}}jq.ajaxPrefilter("script",function(a){a.cache=!0});
function updateRoomsAndGuests(a,b,c){for(var d in a)a.hasOwnProperty(d)&&updateSelectorTitleAndHtml("select[id\x3dguests"+d+"],select[id\x3dguests2"+d+"]",b,c);updateSelectorTitleAndHtml("select[name\x3drooms]",a,c)}function updateSelectorButtonsTitles(a,b,c){a=jq("#guests"+a+"-status");var d=jq("#rooms-status");d.is("span")&&d.html(b);a.is("span")&&a.html(c)}
function updateSelectorTitleAndHtml(a,b,c){a=void 0!=c?jq(a,c):jq(a);a.is("select")&&a.find("option").each(function(){var a=jq(this).val();(a=a?b[a]:null)&&jq(this).attr("title",a).html(a)})}function r9scrollIntoView(a,b,c){a=a.offset();var d=jq(document).scrollTop(),e=d+jq(window).height(),f=a.top,g=!1;c=c||{};c.center&&(f-=.5*(e-d),g=4<Math.abs(a.top-f));c=function(){"function"===typeof b&&b();b=null};a.top<d||a.top>e||g?jq("html, body").animate({scrollTop:f},1E3,c):c()};(function(f,l){function p(){for(var a={},c=0;c<arguments.length;c++)for(var d in arguments[c])arguments[c].hasOwnProperty(d)&&(a[d]=arguments[c][d]);return a}function k(a){var c=a.containerElement||document.body;a=a.theme?"theme-"+a.theme:"theme-default";var d=c.querySelector(":scope \x3e .r9-toast-container."+a);d||(d=document.createElement("div"),d.className="r9-toast-container "+a,c.appendChild(d));return d}function m(a){a.element.addEventListener("mouseenter",function(){e.hoverOnToast=a});a.element.addEventListener("mouseleave",
function(){setTimeout(function(){var c,d,b,f=e.hoverOnToast?e.hoverOnToast.id:-1;for(c in e)d=e[c],(b=c<=a.id&&d.isOld&&d.queue===a.queue)&&(c>f?h(d):g(d))},a.options.reasonableTimeout);delete e.hoverOnToast})}function g(a){a.element.classList.remove("is-visible")}function h(a){g(a);setTimeout(function(){a.element.classList.remove("is-solid")},a.options.reasonableTimeout);setTimeout(function(){try{a.element.parentNode.removeChild(a.element)}catch(c){}delete e[a.id]},2*a.options.reasonableTimeout)}
var q={auto:!0,button:!0,delay:6E3,escaped:!1,icon:"",reasonableTimeout:400,theme:""},n=0,e={};f.Widgets.Toaster={};f.Widgets.Toaster.addToast=function(a,c){var d=k(c),b={element:document.createElement("div"),id:n,options:p(q,c),queue:c.theme||"default",remove:function(){h(this)}};e[n]=b;n+=1;b.element.classList.add("r9-toast-bubble");b.element.classList.add("is-solid");f.config.getBoolean("ui.hotelbookurgency.bdcStyle",!1)?b.element.classList.add("bdcStyle"):f.config.getBoolean("ui.hotelbookurgency.bdcStackedStyle",
!1)&&b.element.classList.add("bdcStackedStyle");c=document.createElement("div");c.classList.add("r9-toast-message");b.options.escaped?c.innerHTML=a:c.appendChild(document.createTextNode(a));b.element.appendChild(c);b.options.icon&&(b.element.classList.add("has-icon"),b.element.classList.add("icon-"+b.options.icon));b.options.button&&(b.closeButton=document.createElement("div"),b.closeButton.classList.add("r9-toast-close"),b.closeButton.onclick=function(){h(b)},b.element.appendChild(b.closeButton));
b.options.auto&&(b.timer=setTimeout(function(){e.hoverOnToast&&b.id<=e.hoverOnToast.id&&b.queue===e.hoverOnToast.queue?(b.isOld=!0,b.id<e.hoverOnToast.id&&g(b)):h(b)},b.options.delay),m(b));d.appendChild(b.element);setTimeout(function(){b.element.classList.add("is-visible")},1);return b};f.Widgets.Toaster.removeAllToasts=function(){for(var a in e)h(e[a])};f.Widgets.Toaster.removeQueueToasts=function(a){var c,d;for(c in e)d=e[c],d.queue===a&&h(d)}})(R9,jq);
(function(f,l){try{f.querySelector(":scope body")}catch(p){["querySelector","querySelectorAll"].forEach(function(k){var m=l[k];l[k]=function(g){if(/(^|,)\s*:scope/.test(g)){var h=this.id;this.id="ID_"+Date.now();g=g.replace(/((^|,)\s*):scope/g,"$1#"+this.id);g=f[k](g);this.id=h;return g}return m.call(this,g)}})}})(window.document,Element.prototype);(function(c,e){function b(a){this.searchId=a.searchId;this.hotelId=a.hotelId;this.containerElement=a.containerElement;this.minimumDelay=a.minimumDelay||d.minimumDelay;this.spacingDelay=a.spacingDelay||d.spacingDelay;this.toastLength=a.toastLength||d.toastLength;this.url=a.url||d.url;this.messages=[];this.timeoutId=null;if(!this.searchId)throw console.error("Cannot instantiate an UrgencyMessaging object without a valid search ID."),Error("Cannot instantiate an UrgencyMessaging object without a valid search ID.");
}var d={minimumDelay:4E3,spacingDelay:2E3,toastLength:6E3,url:"/s/run/hotelbookmsg"};b.prototype.fetchAndDisplay=function(){var a=this,c=0;this.timeoutId=setTimeout(function(){2===++c&&a.showNextMessage()},a.minimumDelay);var b={searchid:a.searchId};a.hotelId&&(b.hid=a.hotelId,a.containerElement&&(b.inline=!0));e.ajax({type:"POST",dataType:"json",url:a.url,data:b,success:function(b){a.messages=b;2===++c&&a.showNextMessage()},error:function(a,b,c){console.error("UrgencyMessaging.fetchAndDisplay failed: "+
b)}})};b.prototype.showNextMessage=function(){var a=this;if(a.messages&&0<a.messages.length){var b=a.messages.shift();c.Widgets.Toaster.addToast(b.message,{escaped:!0,delay:a.toastLength,icon:b.icon||null,containerElement:a.containerElement});a.timeoutId=setTimeout(function(){a.showNextMessage()},a.spacingDelay)}};b.prototype.cleanUp=function(){clearTimeout(this.timeoutId);c.Widgets.Toaster.removeAllToasts()};c.Hotels=c.Hotels||{};c.Hotels.UrgencyMessaging=b})(R9,jq);(function(d,e){function f(b){for(var a=Math.floor((84-b.length)/2),c=0;c<a;c++)b=" "+b;return b}d.Common=d.Common||{};d.Common.enableConsoleBanner=function(b){b=b||"Want to work with an amazing team, building the best search engine in Travel?";var a=!1,c=window.setInterval(function(){try{if((window.Firebug&&window.Firebug.chrome&&window.Firebug.chrome.isInitialized||160<window.outerWidth-window.innerWidth||160<window.outerHeight-window.innerHeight)&&!a){window.clearInterval(c);a=!0;var d=b;isSafari=
-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Edge");console.log("\n\n");isSafari||console.log("\n.--------------. .--------------. .--------------. .--------------. .--------------.\n|  ___  ____   | |      __      | |  ____  ____  | |      __      | |  ___  ____   |\n| |_  ||_  _|  | |     /  \\     | | |_  _||_  _| | |     /  \\     | | |_  ||_  _|  |\n|   | |_/ /    | |    / /\\ \\    | |   \\ \\  / /   | |    / /\\ \\    | |   | |_/ /    |\n|---|  __'.----| |---/ /__\\ \\---| |----\\ \\/ /----| |---/ /__\\ \\---| |---|  __'.----|\n|  _| |  \\ \\_  | | _/ /_  _\\ \\_ | |    _|  |_    | | _/ /_  _\\ \\_ | |  _| |  \\ \\_  |\n| |____||____| | ||____|  |____|| |   |______|   | ||____|  |____|| | |____||____| |\n|              | |              | |              | |              | |              |\n'--------------' '--------------' '--------------' '--------------' '--------------'\n\n");
console.log("\n"+f(d)+"\n                           https://www.kayak.com/careers/\n\n\n")}}catch(g){console.error(g)}},500)};d.Common.enableKonamiCode=function(b){if(b){var a="";e(document).keydown(function(c){a+=c.keyCode;20<a.length&&(a=a.substr(a.length-20));if("38384040373937396665"==a)return window.open(decodeURIComponent(b),"_blank"),a="",c.preventDefault(),!1})}}})(R9,window.jq||window.jQuery);(function(m,e,g){function k(){var n=g.performance.getEntries(),c={},f=h;n.forEach(function(b){var d;d=(d=b.name.match(/^https?:\/\/(www\.)?([^/]+)\/(.*)/i))?d[2]:null;var a;if(a=d)a:{for(a=0;a<l.length;a++)if(d.match(l[a])){a=!1;break a}a=!0}a&&b.startTime>h&&(c[d]=c[d]||[],c[d].push(b),b.startTime>f&&(f=b.startTime))});var a={};Object.keys(c).forEach(function(b){var d=p(c[b]);0<d&&(a[b]=d)});0<Object.keys(a).length&&m.ajax({type:"POST",url:"/s/horizon/tools/performance/TagPerformanceMonitor",data:{timing:JSON.stringify(a),
formtoken:e.globals.formtoken}});h=f}function p(e){var c=0,f=0;e.sort(function(a,b){return a.startTime-b.startTime});e.forEach(function(a){var b=a.startTime+a.duration;a.startTime<=c&&b>c?(f+=b-c,c=b):(c=b,f+=a.duration)});return Math.round(f)}var l=[/localhost/,/kayak/,/swoodoo/,/checkfelix/,/r9cdn/,/runwaynine/],h=0;e.Common=e.Common||{};e.Common.TagPerformanceMonitor={collect:function(){g.performance.getEntries&&"complete"===document.readyState?k():g.performance.getEntries&&g.addEventListener("load",
k,!1)}}})(window.jQuery||window.jq||window.$,R9,window);(function(b,d){b.extend("RP.TravelTipsProTip",{});b=b.RP.TravelTipsProTip=function(a,c){this.searchId=a;this.containerId=c;return this};b.prototype={constructor:b,searchId:"",containerId:"",open:function(){var a=this;d.ajax({url:"/s/horizon/common/results/traveltips/TravelTipsProTip",data:{searchId:a.searchId,id:a.containerId},success:function(c){var b=d("#"+a.containerId);d.trim(c.content)?(c=d(c.content),b.replaceWith(c),a.bindEvents(c)):b.hide(400)}})},bindEvents:function(a){a.find(".close").on("click",
function(){a.hide(400)})}}})(window.R9,window.jq||window.jQuery);(function(b,c){b.extend("RP.TravelTipsUrgencyBubble",{});var d=b.RP.TravelTipsUrgencyBubble=function(a){this.searchId=a;return this};d.prototype={constructor:d,searchId:"",open:function(){var a=this;c.ajax({url:"/s/horizon/common/results/traveltips/TravelTips",data:{searchId:a.searchId},success:function(b){a.showTip(b.content)}})},showTip:function(a){c.trim(a)&&b.Widgets.Toaster.addToast(a,{escaped:!0,delay:6E3,icon:"tip",containerElement:document.body})}}})(window.R9,window.jq||window.jQuery);(function(a,b){a.extend("fd.UpcomingTrip",{});a=a.fd.UpcomingTrip=function(a){this.containerId=a;return this};a.prototype={constructor:a,containerId:"",load:function(){var a=this;b.ajax({url:"/trips/ajax/upcomingTrip",data:{id:a.containerId},success:function(c){var d=b("#"+a.containerId);b.trim(c.html)?(c=b(c.html),d.html(c)):d.hide(400)}})}}})(window.R9,window.jq||window.jQuery);(function(e){function k(a){return a?null!=g[a]?(R9.utils.log("Duplicate instance creation was attempted. ID -\x3e ",a),a=++m,null==g[a]?a:k()):a:(a=++m,null==g[a]?a:k())}var g={},d={},f={},l=null,m=0;R9.extend({ViewState:function(a,b){this.instanceId=k(a);this.setOptions(b);this.lastURLViewState=this.options.currentUrlState;g[this.instanceId]=this}});R9.extend("ViewState",{getInstance:function(a,b){if(!a&&!b||"object"==typeof a&&!b)l=l||k();var c=l||a;null!=l&&(b=a);null==g[c]?g[c]=new R9.ViewState(c,
b||{}):null!=b&&g[c].setOptions(b);return g[c]},getStateString:function(a){return R9.ViewState.getInstance(a).getStateString()},saveState:function(a,b){return R9.ViewState.getInstance(b).saveState(!1,a)},getUrlStateString:function(a){return this.getInstance(a).getUrlStateString()},isPageReloadState:function(){return!0},isLegacyLocationURL:function(){return 0<=window.location.pathname.indexOf("/r/")}});R9.extend("ViewState.prototype",{instanceId:null,lastURLViewState:"",options:{currentUrlState:"",
stateDelimiter:";",vertical:null,searchBaseUrl:null,urlStateRequestKey:"urlViewState",saving:{url:"/s/sparkle",searchIdKey:"searchid",searchType:"type",requestType:"POST",dataType:"json",actionKey:"action",actionValue:"viewState",ignoreWindowScrollPositionOnce:!1,requestKey:"viewState",resetValue:"RESET"},viewStatesKeys:{windowScroll:"ws",clickedResultIdListKey:"t",lastClickedResultIdKey:"lt",hotelDetailsOpenedIndex:"hdoix",hotelDetailsOpenedId:"hdoid",hotelDetailsOpenedTab:"hdot",hotelMiniDetailsOpenedId:"hmdoid",
hotelMiniDetailsOpenedTab:"hmdot",hotelMiniDetailsOpenedIdPage:"hmdoip",hotelMapFilterOpenedId:"hmfoid",showLayoverFilter:"lay",resultPageNumber:"pn",showMatrix:"mtx",showPlusMinusThree:"fflx",flightMatrixGridRawVisible:"fmgr",mapViewPortCenter:"mvpc",mapZoomLevel:"mzl",landingTimeSliders:"lts",flightDetailsOpenedIndexes:"fodi",carDetailsOpenedIndexes:"codi",carClassGroupsFiltered:"ccids",hotelMapMiniDetailsId:"hmmd",multiCityFlightFilterLeg:"mcleg",chosenDepartureId:"cdid",chosenReturnId:"crid",
activeDestinationAirport:"frdest"},urlViewStateKeys:{resultViewMode:"vw",mapTypeId:"mtid"},noPushState:!1},setOptions:function(a){this.options=e.extend(!0,{},this.options,a||{})},add:function(a,b){null==d[this.instanceId]&&(d[this.instanceId]={});a?d[this.instanceId][a]=b:R9.utils.log("State name cannot be empty: ",a);return this},addUrlState:function(a,b){null==f[this.instanceId]&&(f[this.instanceId]={});a?f[this.instanceId][a]=b:R9.utils.log("State name cannot be empty: ",a);return this},get:function(a){if(a){if(null!=
d[this.instanceId]&&null!=d[this.instanceId][a])return d[this.instanceId][a];if(null!=f[this.instanceId]&&null!=f[this.instanceId][a])return f[this.instanceId][a]}return null},remove:function(a){a&&null!=d[this.instanceId]&&null!=d[this.instanceId][a]&&delete d[this.instanceId][a];a&&null!=f[this.instanceId]&&null!=f[this.instanceId][a]&&delete f[this.instanceId][a];return this},restore:function(a){try{"string"==typeof a&&(a=e.parseJSON(a)),"object"==typeof d[this.instanceId]?e.extend(d[this.instanceId],
a):d[this.instanceId]=a}catch(b){R9.utils.log("Failed to parse JSON string: ",b)}return this},restoreUrlStates:function(a){try{"string"==typeof a&&(a=e.parseJSON(a)),f[this.instanceId]=a}catch(b){R9.utils.log("Failed to parse JSON string: ",b)}return this},reset:function(){d[this.instanceId]=null;return this},getStateString:function(){this.refreshRequiredViewStates();var a=e.extend({},f[this.instanceId]||{},d[this.instanceId]||{});e.isArray(a.ws)||"undefined"===typeof a.ws||delete a.ws;return h.stringify(a)},
getUrlStateString:function(){return this.options.currentUrlState},saveState:function(a,b){var c={};c[this.options.saving.actionKey]=this.options.saving.actionValue;c[this.options.saving.searchIdKey]=window.SearchID;c[this.options.saving.searchType]=R9.globals.vertical;c[this.options.saving.requestKey]=this.getStateString();var d=this;e.ajax(this.options.saving.url,{type:this.options.saving.requestType,dataType:this.options.saving.dataType,data:c,success:function(c){c&&0<parseInt(c.status,10)&&(d.restoreUrlStates(c.stateValues),
d.updateUrlState(c.state));(a||1==parseInt(c.reset,10))&&d.reset();"function"==typeof b&&b()},error:function(){}});return this},updateUrlState:function(a){if(!this.options.vertical||!this.options.searchBaseUrl&&!R9.ViewState.isLegacyLocationURL()||this.lastURLViewState==a)return this;this.options.currentUrlState=a;if(this._handleLegacyURLUpdate(a))return this;this.lastURLViewState=a;a=this.options.searchBaseUrl||"";var b=this.getUrlStateString();b&&(a+=this.options.stateDelimiter+b);var b=window.location.pathname.indexOf("/"+
this.options.vertical),c=window.location.hash.indexOf("/"+this.options.vertical);if(0>b&&0>c)return this;R9.ViewState.isPageReloadState()&&(a="/"+this.options.vertical+"/"+a,R9.Tabs&&R9.Tabs.SearchTabs?(R9.Tabs.SearchTabs.changeCurrentTabUrl(a),void 0!==history.pushState?history.replaceState(history.state,document.title,a):R9App.AppInstance.updateBrowserLocationWithoutNavigation(a)):window.location.pathname=a);return this},refreshRequiredViewStates:function(){if(this.options.saving.ignoreWindowScrollPositionOnce)return this.options.saving.ignoreWindowScrollPositionOnce=
!1,this;this.add(this.options.viewStatesKeys.windowScroll,[this.getScrollPositionHorizontalWindow(),this.getScrollPositionVerticalWindow()]);return this},getScrollPositionHorizontal:function(a){return e(a).length?e(a).get(0).scrollLeft:0},getScrollPositionVertical:function(a){return e(a).length?e(a).get(0).scrollTop:0},getScrollPositionHorizontalWindow:function(){return e.support.tbody?window.scrollX||window.pageXOffset||0:document.documentElement.scrollLeft},getScrollPositionVerticalWindow:function(){return e.support.tbody?
window.scrollY||window.pageYOffset||0:document.documentElement.scrollTop},addResultClicked:function(a){value=this.getNormalizedIntegerValue(a);if(0<=value){this.add(this.options.viewStatesKeys.lastClickedResultIdKey,value);var b=e.isArray(this.get(this.options.viewStatesKeys.clickedResultIdListKey))?this.get(this.options.viewStatesKeys.clickedResultIdListKey):[];0>e.inArray(value,b)&&b.push(value);this.add(this.options.viewStatesKeys.clickedResultIdListKey,b);a=e("#tbd"+a);a.parent().children(".lastclicked").removeClass("lastclicked");
a.addClass("clicked lastclicked")}return this},addHotelDetailsOpenedValues:function(a,b,c){a=this.getNormalizedIntegerValue(a);this.addResultClicked(a);this.add(this.options.viewStatesKeys.hotelDetailsOpenedIndex,a);b=this.getNormalizedIntegerValue(b);0<=b&&(this.add(this.options.viewStatesKeys.hotelDetailsOpenedId,b),this.addHotelDetailsOpenTabValue(c));return this},addHotelDetailsOpenTabValue:function(a){this.add(this.options.viewStatesKeys.hotelDetailsOpenedTab,a);return this},addHotelMiniDetailsOpenedValues:function(a,
b,c){a=this.getNormalizedIntegerValue(a);this.addResultClicked(a);this.add(this.options.viewStatesKeys.hotelDetailsOpenedIndex,a);b=this.getNormalizedIntegerValue(b);0<=b&&(a=this.get(this.options.viewStatesKeys.hotelMiniDetailsOpenedIdPage)||{},a[b]=c,this.add(this.options.viewStatesKeys.hotelMiniDetailsOpenedIdPage,a));return this},getHotelMiniDetailsOpened:function(){return this.get(this.options.viewStatesKeys.hotelMiniDetailsOpenedIdPage)},removeHotelMiniDetailsOpenedValues:function(){this.remove(this.options.viewStatesKeys.hotelMiniDetailsOpenedIdPage);
return this},removeSingleHotelMiniDetailsOpenedValues:function(a){a=this.getNormalizedIntegerValue(a);if(0<=a){var b=this.get(this.options.viewStatesKeys.hotelMiniDetailsOpenedIdPage)||{};null!=b[a]&&delete b[a];this.add(this.options.viewStatesKeys.hotelMiniDetailsOpenedIdPage,b)}return this},removeHotelDetailsOpenedValues:function(){this.remove(this.options.viewStatesKeys.hotelDetailsOpenedId);this.remove(this.options.viewStatesKeys.hotelDetailsOpenedTab);return this},addResultViewModeValue:function(a,
b){this.addUrlState(this.options.urlViewStateKeys.resultViewMode,a);this.options.noPushState=b;return this},addActiveDestinationAirport:function(a){this.add(this.options.viewStatesKeys.activeDestinationAirport,a);return this},addResultPageNumber:function(a){a=parseInt(a,10);a=isNaN(a)||0>=a?0:a-1;this.add(this.options.viewStatesKeys.resultPageNumber,a);this.resetViewStatesOnPageChange();return this},resetViewStatesOnPageChange:function(){this.resetOpenedFlightDetails();this.resetOpenedCarDetails();
return this},resetViewStatesOnFilters:function(){this.addResultPageNumber(0);this.resetOpenedFlightDetails();this.resetOpenedCarDetails();return this},resetViewStatesOnSort:function(){this.addResultPageNumber(0);this.resetOpenedFlightDetails();this.resetOpenedCarDetails();return this},addMapTypeId:function(a){this.addUrlState(this.options.urlViewStateKeys.mapTypeId,a);return this},addMapCenterPoint:function(a,b){null!=a&&null!=b&&this.add(this.options.viewStatesKeys.mapViewPortCenter,{lat:a,lng:b});
return this},addMapZoomLevel:function(a){a&&this.add(this.options.viewStatesKeys.mapZoomLevel,a);return this},addToOpenedDetailsList:function(a,b){b=this.getNormalizedIntegerValue(b);if(!(0>b)){var c=e.isArray(this.get(a))?this.get(a):[];0>e.inArray(b,c)&&(c.push(b),this.addResultClicked(b));var d=-1*b;for(b=0;b<c.length;b++)if(1/c[b]===1/d){c.splice(b,1);break}this.add(a,c);return this}},removeFromOpenedDetailsList:function(a,b){b=this.getNormalizedIntegerValue(b);if(!(0>b)){var c,d=e.isArray(this.get(a))?
this.get(a):[];for(c=0;c<d.length;c++)if(d[c]==b){d.splice(c,1);break}b*=-1;0>e.inArray(b,d)&&d.push(b);this.add(a,d);return this}},resetOpenedDetailsList:function(a){this.add(a,this.options.saving.resetValue);return this},addOpenedFlightDetails:function(a){return this.addToOpenedDetailsList(this.options.viewStatesKeys.flightDetailsOpenedIndexes,a)},removeOpenedFlightDetails:function(a){return this.removeFromOpenedDetailsList(this.options.viewStatesKeys.flightDetailsOpenedIndexes,a)},resetOpenedFlightDetails:function(){return this.resetOpenedDetailsList(this.options.viewStatesKeys.flightDetailsOpenedIndexes)},
addOpenedCarDetails:function(a){return this.addToOpenedDetailsList(this.options.viewStatesKeys.carDetailsOpenedIndexes,a)},addCarClassGroupsFiltered:function(a){return this.add(this.options.viewStatesKeys.carClassGroupsFiltered,a)},resetCarClassGroupsFiltered:function(){return this.addCarClassGroupsFiltered("")},removeOpenedCarDetails:function(a){return this.removeFromOpenedDetailsList(this.options.viewStatesKeys.carDetailsOpenedIndexes,a)},resetOpenedCarDetails:function(){return this.resetOpenedDetailsList(this.options.viewStatesKeys.carDetailsOpenedIndexes)},
addHotelMapMiniDetailsId:function(a){a=this.getNormalizedIntegerValue(a);0<=a&&this.add(this.options.viewStatesKeys.hotelMapMiniDetailsId,a);return this},removeHotelMapMiniDetailsId:function(){this.add(this.options.viewStatesKeys.hotelMapMiniDetailsId,-1);return this},addFlightLayoverAirportsState:function(a){"undefined"==typeof a&&(a=!0);this.add(this.options.viewStatesKeys.showLayoverFilter,a);return this},addFlightMultiCityFilterLegState:function(a){"undefined"!=typeof a&&this.add(this.options.viewStatesKeys.multiCityFlightFilterLeg,
a);return this},setIsAirlineFilterInAirlineView:function(a){"undefined"!=typeof a&&this.add(this.options.viewStatesKeys.airlineFilterIsAirlineView,a);return this},addFlightLandingTimeSlidersFilterState:function(a){"undefined"==typeof a&&(a=!0);this.add(this.options.viewStatesKeys.landingTimeSliders,a);return this},addShowMatrixViewState:function(a){"undefined"==typeof a&&(a=!1);this.add(this.options.viewStatesKeys.showMatrix,a);return this},addShowPlusMinusThreeViewState:function(a){"undefined"==
typeof a&&(a=!1);this.add(this.options.viewStatesKeys.showPlusMinusThree,a);return this},addflightMatrixGridRawVisibleState:function(a){"undefined"==typeof a&&(a=-1);this.add(this.options.viewStatesKeys.flightMatrixGridRawVisible,a);return this},setIgnoreWindowScrollPositionOnce:function(){this.options.saving.ignoreWindowScrollPositionOnce=!0;return this},getNormalizedIntegerValue:function(a){a=parseInt(a,10);"number"!=typeof a&&(a=-1);return a},addHotelMapFilterOpenedId:function(a){this.add(this.options.viewStatesKeys.hotelMapFilterOpenedId,
a);return this},removeHotelMapFilterOpenedId:function(a){this.get(this.options.viewStatesKeys.hotelMapFilterOpenedId)==a&&this.add(this.options.viewStatesKeys.hotelMapFilterOpenedId,"none_opened");return this},_handleLegacyURLUpdate:function(a){if(!R9.ViewState.isLegacyLocationURL())return!1;var b=window.location.pathname,c=b.indexOf(this.options.stateDelimiter+this.lastURLViewState);0<=c&&(b=b.substring(0,c));if(!a)return window.location.pathname=b,!0;a="";(c=this.getUrlStateString())&&(a+=this.options.stateDelimiter+
c);window.location.pathname=b+a;return!0},addChosenDepartureId:function(a){"undefined"!=typeof a&&this.add(this.options.viewStatesKeys.chosenDepartureId,a);return this},addChosenReturnId:function(a){"undefined"!=typeof a&&this.add(this.options.viewStatesKeys.chosenReturnId,a);return this},removeChosenDepartureId:function(){this.add(this.options.viewStatesKeys.chosenDepartureId,"RESET");return this},removeChosenReturnId:function(){this.add(this.options.viewStatesKeys.chosenReturnId,"RESET");return this}});
var h=window.JSON;"undefined"===typeof h&&(h={});"undefined"===typeof h.stringify&&e.extend(h,{stringify:function(a){var b=[];switch(typeof a){case "string":return'"'+a.replace(/(["\\\/\b\f\n\r\t]{1})/g,"{1}")+'"';case "number":case "boolean":return a.toString();case "undefined":return"undefined";case "object":if(e.isArray(a)){for(var c=0;c<a.length;c++)b.push(h.stringify(a[c]));return"["+b.join(",")+"]"}if(null==a)return"null";for(c in a)a.hasOwnProperty(c)&&b.push('"'+c.toString()+'":'+h.stringify(a[c]));
return"{"+b.join(",")+"}"}return""}})})(jq||jQuery);(function(c,d){c.extend("Common.RedirectMessage",{});var e=c.Common.RedirectMessage=function(b,a,d){this.containerId=b;this.redirectFromTo=a;this.redirectFromToAlt=d;this.init();return this};e.prototype={constructor:e,containerId:void 0,element:void 0,redirectFromTo:void 0,redirectFromToAlt:void 0,selector:{allRedirectLinks:".redirect-banner a",redirectLink:".redirect-banner\x3ea",dualRedirectLink:".redirect-banner-dual\x3ea",closeLink:".close"},init:function(){this.element=d("#"+this.containerId);
this.element.slideDown("slow");this.updateRedirectUrl();this.bindRedirectAdt()},updateRedirectUrl:function(){this.element.find(this.selector.allRedirectLinks).each(function(){var b=d(this),a=b.attr("href"),c=window.location.pathname,e=a.indexOf("\x26url\x3d");-1!==e&&(a=a.substr(0,e));c&&"/"!==c&&(a+="\x26url\x3d"+c);b.attr("href",a)})},addEventHandlers:function(){var b=this;this.element.find(this.selector.closeLink).click(function(){b.element.slideUp("slow");var a=d(this).attr("data-mc");setMetaCookie(a,
!0)})},bindRedirectAdt:function(){var b=this.element.find(this.selector.redirectLink),a=this.element.find(this.selector.dualRedirectLink);0!==b.length?b.off("click").click(this.redirectFromTo||this.redirectFromToAlt,this.redirectClickAdt):2===a.length&&(d(a.get(0)).off("click").click(this.redirectFromTo,this.redirectClickAdt),d(a.get(1)).off("click").click(this.redirectFromToAlt,this.redirectClickAdt))},redirectClickAdt:function(b){c.Analytics.api.trackEvent({category:"redirect-banner",action:"click",
label:b.data})}}})(window.R9,window.jq||window.jQuery);