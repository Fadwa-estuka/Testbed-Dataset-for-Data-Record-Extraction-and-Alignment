
var jq = jQuery;
(function(e){var f={extend:function(){var a=Array.prototype.slice.call(arguments);if(a.length){var c=R9;if("string"==typeof a[0]){var b=a.shift();if(!a.length)return R9;for(var b=b.split("."),d=0;d<b.length;d++)c[b[d]]=c[b[d]]||{},c=c[b[d]]}b=!1;"boolean"==typeof a[0]&&(b=a.shift());a.unshift(c);b&&a.unshift(!0);e.extend.apply(e,a)}return R9}};"object"===typeof window.R9&&0<Object.keys(window.R9).length?window.R9.extend=f.extend:window.R9=f})(window.jq||window.jQuery);
window.console||(window.console={log:function(){},warn:function(){},error:function(){},time:function(){},timeEnd:function(){}});(function(c){R9.extend("config",{getString:function(a,b){return window.R9&&R9.globals&&R9.globals.uiconfig&&"undefined"!=typeof R9.globals.uiconfig[a]?R9.globals.uiconfig[a]:b},getBoolean:function(a,b){return(a=R9.config.getString(a))?"true"===a.toLowerCase():b},getInt:function(a,b){return(a=R9.config.getString(a))?parseInt(a):b}})})(jq||jQuery);(function(d){R9.extend("utils",{log:function(){"undefined"!=typeof console&&null!=console&&(null!=console.exception?console.exception.apply(window,arguments):(null!=console.error&&console.error(Array.prototype.slice.call(arguments)),null!=console.trace&&console.trace()))},formToObject:function(b){var a={};b=d(b).serializeArray();d.each(b,function(){a[this.name]="undefined"!=typeof a[this.name]?a[this.name]+","+this.value:this.value});return a},slugify:function(b){return b.replace(/[^A-Za-z0-9\-_]/g,
"")},roundTo:function(b,a){if(!b||isNaN(parseInt(b,10)))return 0;a=Math.pow(10,parseInt(a,10)||0);return Math.round(b*a)/a},roundToNearest:function(b,a,c){null==c&&(c=!0);var d=Math.floor(b/a);return 0<b%a?c?(d+1)*a:d*a:b},evaluateScript:function(b){var a=null;try{switch(typeof b){case "string":a=b;break;case "number":b=this;default:a=b.innerText||b.textContent}a&&(a=a.replace(/([^\r])\n/,"$1\r\n"),d.globalEval(a))}catch(c){this.log(c,a),window.Rollbar&&Rollbar.error("Error while evaluating script. script\x3d"+
a.substring(0,64),c)}},applyMethod:function(b,a,c){a=b&&b[a];return"function"===typeof a?a.apply(b,c):null}})})(jq||jQuery);R9.extend("Common.Utils",{getId:function(){var a=(new Date).getTime();return function(){return++a}}(),formatPrice:function(a,b){return(!1!==b?R9.globals._LEFT_CURSYMBOL:"")+R9.Common.Utils.formatThousandsSeparator(parseInt(1*a+.5))+(!1!==b?R9.globals._RIGHT_CURSYMBOL:"")},getShortTime:function(a,b){return a.formatUTCDate(b?"D T":"T")},getShortDate:function(a){return a.formatUTCDate("j M")},formatThousandsSeparator:function(a,b,c){b=b||R9.globals._PRICE_THOUSANDS_SEPARATOR;c=c||".";var d=a.toString().split(".");
a=d[0];c=1<d.length?c+d[1]:"";d=/(\d+)(\d{3})/;if(0<b.length)for(;d.test(a);)a=a.replace(d,"$1"+b+"$2");return a+c},arrayDifference:function(a,b){var c=[],d=[],e=[];jq.each(a,function(a,c){0>b.indexOf(c)?d.push(c):e.push(c)});jq.each(b,function(b,d){0>a.indexOf(d)&&c.push(d)});return{added:c,removed:d,unchanged:e}},getDimensions:function(a){jq("body").append(a.addClass("outOfView"));var b={width:a.outerWidth(),height:a.outerHeight()};a.detach();a.removeClass("outOfView");return b},throttle:function(a,
b,c){if(isNaN(a))throw new TypeError("limit must be an number");var d=0;return function(){if(d<a){d++;var e=Array.prototype.slice.call(arguments);e.push(d===a);e.push(d);return b.apply(c||this,e)}}},after:function(a,b,c){if(isNaN(a))throw new TypeError("waitCount must be an number");var d=0;return function(){if(d>=a)return b.apply(c||this,arguments);d++}},debounce:function(a,b,c){var d,e=0;b=b||200;return function(){var f=Array.prototype.slice.call(arguments);e+=1;clearTimeout(d);d=setTimeout(function(){f.push(e);
a.apply(c||this,f)},b)}},defer:function(a){setTimeout(function(){a()},0)},throwop:function(a){return function(){throw Error((a||"unknown")+" function is abstract and must be overridden");}}});
R9.extend("Common.Utils",{Browsers:{ANIMATION_END:"webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",TRANSITION_END:"transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",isChrome:function(){return!!navigator.userAgent.match(/chrome\/(\d+)/i)},isIE:function(a){var b=-1;if("Microsoft Internet Explorer"==navigator.appName){if(null!==/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(b=parseFloat(RegExp.$1)),"undefined"!==typeof a)return a===
b}else if(Object.hasOwnProperty.call(window,"ActiveXObject")&&!window.ActiveXObject&&(b=11,"undefined"!==typeof a))return a===b;return-1!==b},isEdge:function(){return-1<navigator.userAgent.indexOf("Edge")},isMobileSafari:function(){return-1!==navigator.userAgent.indexOf("AppleWebKit")&&-1!==navigator.userAgent.indexOf("Mobile")}},URL:{getQueryParams:function(){for(var a=[],b,c=window.location.href.slice(window.location.href.indexOf("?")+1).split("\x26"),d=0;d<c.length;d++)b=c[d].split("\x3d"),a.push(b[0]),
a[b[0]]=b[1];return a},addQueryParameter:function(a,b,c){var d=a.indexOf("#"),e=-1===d?"":a.substr(d);a=-1===d?a:a.substr(0,d);var d=new RegExp("([?\x26])"+b+"\x3d.*?(\x26|$)","i"),f=-1!==a.indexOf("?")?"\x26":"?";a=a.match(d)?a.replace(d,"$1"+b+"\x3d"+c+"$2"):a+f+b+"\x3d"+c;return a+e},getParameterByName:function(a,b){a||(a=window.location.href);b=b.replace(/[\[\]]/g,"\\$\x26");return(a=(new RegExp("[?\x26]"+b+"(\x3d([^\x26#]*)|\x26|#|$)")).exec(a))?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):
"":null},removeHash:function(){var a=window.location;"pushState"in history?history.replaceState("",document.title,a.pathname+a.search):a.hash=""},stripHash:function(a){var b=a.indexOf("#");return-1!==b?a.substr(0,b):a},addHash:function(a,b){var c=a.indexOf("#");return-1===c?a+"#"+b:a.substr(0,c+1)+b}}});String.prototype.camelizeUpper=function(){return this.substr(0,1).toUpperCase()+this.substr(1)};
String.prototype.format=function(){return[].slice.call(arguments).reduce(function(a,b){return a.replace("%s",b)},this.valueOf())};String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return this.substr(b||0,a.length)===a});"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});Object.values=Object.values||function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b};
Array.prototype.each=function(a){for(var b=0,c=this.length;b<c;b++)a(this[b])};window.getQueryVariable=function(a){for(var b=window.location.search.substring(1).split("\x26"),c=0;c<b.length;c++){var d=b[c].split("\x3d");if(decodeURIComponent(d[0])==a)return decodeURIComponent(d[1])}};
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a));c=window.setTimeout(function(){b(d+e)},e);a=d+e;return c});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(a){clearTimeout(a)})})();(function(a){a.extend("Common.Utils",{getShortTime:function(a,c,d){var b=a.getUTCHours();13<=b?b-=12:0===b&&(b=12);var f=a.getUTCMinutes();10>f&&(f="0"+f);f=":"+f;!1===d&&(f="");d=12<=a.getUTCHours()?"p":"a";return c?a.formatUTCDate("D")+" "+b+f+d:b+f+d},getShortDate:function(a){return a.formatUTCDate("M j")}})})(window.R9);R9.extend("Common.Utils",{getImageToContainerSize:function(a,b,c,d){if(a>=c&&b>=d){var e;e=c*b/a;a=d*a/b;(0<=d-e?d-e:0)<=(0<=c-a?c-a:0)?(a=c,b=e):b=d}else if(a>=c||b>=d)e=a>=c?c/a:d/b,a*=e,b*=e;a=parseInt(a);b=parseInt(b);10>Math.abs(c-a)&&(a=c);var f=e=0;a>c&&(e=parseInt(a/2-c/2));b>d&&(f=parseInt(b/2-d/2));b<d&&(f=-1*parseInt((d-b)/2));return{finalWidth:a,finalHeight:b,shiftX:e,shiftY:f}}});(function(g){R9.extend("Common.Utils.String",{formatString:function(a,b){var f=arguments;return a.replace(/{(\d)}/g,function(a,b){return f[(parseInt(b,10)||0)+1]})},replaceArgs:function(){for(var a=arguments[0],b=1;b<=arguments.length;b++)a=a.replace("{"+(b-1)+"}",arguments[b]);return a},formatChoice:function(a,b,f){var c=arguments,d,e;a=a.split("|",20);for(e=a.length-1;0<=e;e--)if(d=a[e].split("#",2),!(2>d.length||isNaN(d[0])||b<d[0]))return c=Array.prototype.slice.call(c,2),c=Array.prototype.concat([d[1]],
c),R9.Common.Utils.String.formatString.apply(this,c);return a},isNullOrUndefinedOrEmpty:function(a){return null===a||void 0===a||R9.Common.Utils.String.isEmpty(a)},isEmpty:function(a){return""===a},isWhitespace:function(a){return!R9.Common.Utils.String.isEmpty(a)&&R9.Common.Utils.String.isEmpty(g.trim(a))},isNullOrUndefinedOrEmptyOrWhitespace:function(a){return R9.Common.Utils.String.isNullOrUndefinedOrEmpty(a)||R9.Common.Utils.String.isWhitespace(a)},formElementValueIsNullOrUndefinedOrEmptyOrWhitespace:function(a){R9.conditions.jquery.hasExactlyOneJqElement(a);
return R9.Common.Utils.String.isNullOrUndefinedOrEmptyOrWhitespace(a.val())}})})(jq||jQuery);R9.extend("Common.RemoveAccents",{translate_re:/[\u00f6\u00e4\u00fc\u00d6\u00c4\u00dc\u00e1\u00e0\u00e2\u00e9\u00e8\u00ea\u00fa\u00f9\u00fb\u00f3\u00f2\u00f4\u00c1\u00c0\u00c2\u00c9\u00c8\u00ca\u00da\u00d9\u00db\u00d3\u00d2\u00d4\u00df\u00e6\u00e7\u00d8\u00f8\u00f0\u00c7\u00d0\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u00d1\u00f1\u0160\u0161\u0178\u00ff\u00fd\u017d\u017e\u0152\u0430\u0431\u0432\u0433\u0434\u0435\u0451\u0436\u0437\u0438\u0439\u043a\u043b\u043c\u043d\u043e\u043f\u0440\u0441\u0442\u0443\u0444\u0445\u0446\u0447\u0448\u0449\u044a\u044b\u044c\u044d\u044e\u044f\u0410\u0411\u0412\u0413\u0414\u0415\u0401\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\u0425\u0426\u0427\u0428\u0429\u042a\u042b\u042c\u042d\u042e\u042f\u0391\u03b1\u0386\u03ac\u0392\u03b2\u0393\u03b3\u0394\u03b4\u0395\u03b5\u0388\u03ad\u0396\u03b6\u0397\u03b7\u0389\u03ae\u0398\u03b8\u0399\u03b9\u038a\u03af\u03aa\u03ca\u0390\u039a\u03ba\u039b\u03bb\u039c\u03bc\u039d\u03bd\u039e\u03be\u039f\u03bf\u038c\u03cc\u03a0\u03c0\u03a1\u03c1\u03a3\u03c3\u03c2\u03a4\u03c4\u03a5\u03c5\u038e\u03cd\u03ab\u03cb\u03b0\u03a6\u03c6\u03a7\u03c7\u03a8\u03c8\u03a9\u03c9\u038f\u03ce]/g,
translate:{"\u00e4":"a","\u00f6":"o","\u00fc":"u","\u00c4":"A","\u00d6":"O","\u00dc":"U","\u00e1":"a","\u00e0":"a","\u00e2":"a","\u00e9":"e","\u00e8":"e","\u00ea":"e","\u00fa":"u","\u00f9":"u","\u00fb":"u","\u00f3":"o","\u00f2":"o","\u00f4":"o","\u00c1":"A","\u00c0":"A","\u00c2":"A","\u00c9":"E","\u00c8":"E","\u00ca":"E","\u00da":"U","\u00d9":"U","\u00db":"U","\u00d3":"O","\u00d2":"O","\u00d4":"O","\u00df":"s","\u00e6":"o","\u00e7":"c","\u00d8":"O","\u00f8":"o","\u00f0":"e","\u00c7":"C","\u00d0":"D",
"\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i","\u00d1":"N","\u00f1":"n","\u0160":"S","\u0161":"s","\u0178":"Y","\u00ff":"y","\u00fd":"y","\u017d":"Z","\u017e":"z","\u0152":"O","\u0107":"c","\u0430":"a","\u0431":"b","\u0432":"v","\u0433":"g","\u0434":"d","\u0435":"e","\u0451":"jo","\u0436":"zh","\u0437":"z","\u0438":"i","\u0439":"jj","\u043a":"k","\u043b":"l","\u043c":"m","\u043d":"n","\u043e":"o","\u043f":"p","\u0440":"r","\u0441":"s","\u0442":"t",
"\u0443":"u","\u0444":"f","\u0445":"kh","\u0446":"c","\u0447":"ch","\u0448":"sh","\u0449":"shh","\u044a":'"',"\u044b":"y","\u044c":"'","\u044d":"eh","\u044e":"ju","\u044f":"ja","\u0410":"A","\u0411":"B","\u0412":"V","\u0413":"G","\u0414":"D","\u0415":"E","\u0401":"JO","\u0416":"ZH","\u0417":"Z","\u0418":"I","\u0419":"JJ","\u041a":"K","\u041b":"L","\u041c":"M","\u041d":"N","\u041e":"O","\u041f":"P","\u0420":"R","\u0421":"S","\u0422":"T","\u0423":"U","\u0424":"F","\u0425":"KH","\u0426":"C","\u0427":"CH",
"\u0428":"SH","\u0429":"SHH","\u042a":'""',"\u042b":"Y","\u042c":"''","\u042d":"EH","\u042e":"JU","\u042f":"JA","\u0391":"A","\u03b1":"a","\u0386":"A","\u03ac":"a","\u0392":"V","\u03b2":"v","\u0393":"G","\u03b3":"g","\u0394":"D","\u03b4":"d","\u0395":"E","\u03b5":"e","\u0388":"E","\u03ad":"e","\u0396":"Z","\u03b6":"z","\u0397":"I","\u03b7":"i","\u0389":"I","\u03ae":"i","\u0398":"Th","\u03b8":"th","\u0399":"I","\u03b9":"i","\u038a":"I","\u03af":"i","\u03aa":"I","\u03ca":"i","\u0390":"i","\u039a":"K",
"\u03ba":"k","\u039b":"L","\u03bb":"l","\u039c":"M","\u03bc":"m","\u039d":"N","\u03bd":"n","\u039e":"X","\u03be":"x","\u039f":"O","\u03bf":"o","\u038c":"O","\u03cc":"o","\u03a0":"P","\u03c0":"p","\u03a1":"R","\u03c1":"r","\u03a3":"S","\u03c3":"s","\u03c2":"s","\u03a4":"T","\u03c4":"t","\u03a5":"Y","\u03c5":"y","\u038e":"Y","\u03cd":"y","\u03ab":"Y","\u03cb":"y","\u03b0":"y","\u03a6":"F","\u03c6":"f","\u03a7":"Ch","\u03c7":"ch","\u03a8":"Ps","\u03c8":"ps","\u03a9":"O","\u03c9":"o","\u038f":"O","\u03ce":"o"},
removeAccentedChars:function(a){var b=this;return a.replace(b.translate_re,function(a){return b.translate[a]})}});String.prototype.removeAccentedChars=function(){return R9.Common.RemoveAccents.removeAccentedChars(this)};R9.extend("Common.Communication",{ScriptLoader:function(){var g=[],e={load:function(a,c,b,f){b=b||!1;"undefined"==typeof f&&(f=!0);if(f&&-1<jq.inArray(a,g))b||c();else if(g.push(a),b){var d="C"+R9.Common.Utils.getId();b=document.createElement("script");e.loaderCallbacks[d]=function(){clearTimeout(h);delete e.loaderCallbacks[d];c()};a=a.replace(/^(\s)*http(s)?:\/\//i,location.protocol+"//");b.src=a;c&&(b.src+="\x26callback\x3dR9.Common.Communication.ScriptLoader.loaderCallbacks."+d);b.type="text/javascript";
var h=setTimeout(function(){delete e.loaderCallbacks[d]},3E4);a=jq("#scripts");a=a.length?a.get(0):document.getElementsByTagName("head")[0];a.appendChild(b)}else jq.getScript(a,function(){c()})},loaderCallbacks:{}};return e}()});(function(g){function e(a,b){function c(){if(0<a.length){var d=a.pop();R9.Common.Communication.ScriptLoader.load(d.name,c,d.callbackInQuery||!1)}else b&&b()}a=a.reverse();c()}var c=!1;R9.extend("Maps.Google",{channel:"",url:"/gmap?libraries\x3dplaces,geometry\x26description\x3dR9.Maps.Google",load:function(a,b){var f=this;window.google&&window.google.maps?(c=!0,a&&a()):c?a&&a():e([{name:b&&""!=b?R9.Maps.Google.url+"\x26channel\x3d"+b:R9.Maps.Google.url,callbackInQuery:!0}],function(){f.channel=b;
c=!0;a&&a()})},isLoaded:function(){return c}})})(jq||jQuery);(function(a,b){a.Common=a.Common||{};a.Common.SwindlePublisher={publish:function(a){window.localStorage&&localStorage.setItem("swindle",a.removeAccentedChars())}}})(R9,window.jq||window.jQuery);R9.extend("Social",{deleteControlCookie:function(){document.cookie="ssocontrol\x3d; expires\x3dThu, 01 Jan 1970 00:00:00 GMT"},doNotLoadThirdPartyScripts:function(){return null!=document.location.href.match("/hotelreservation")||null!=document.location.href.match("/flightreservation")||null!=document.location.href.match("/carreservation")||null!=document.location.href.match("/bookings/")||null!=document.location.href.match("/trips/")||null!=document.location.href.match("/trips-preferences")?!0:!1},
doNotLoadSocialResources:function(){return R9.config&&R9.globals&&R9.globals.uiconfig?R9.config.getBoolean("ui.social.forceOff",!1):!1}});
R9.extend("Social.FB",{ensureAPILoaded:function(a){var b=jq.Deferred();b.promise();if(R9.Social.doNotLoadSocialResources())return"function"===typeof a&&a(),b.resolve();window.FB?("function"===typeof a&&a(),b.resolve()):jq.ajax({url:"//connect.facebook.net/en_US/sdk.js",dataType:"script",async:!1}).done(this.onLoadSuccess.bind(this,b,a)).fail(this.onLoadError.bind(this,b));return b},onLoadSuccess:function(a,b){if(window.FB)FB.init({appId:R9.globals.facebookAppId,cookie:!1,status:!1,xfbml:!1,version:"v2.6"}),
R9.events.publish("r9.facebook.api.loaded"),"function"===typeof b&&b(),a.resolve();else this.onLoadError(a)},onLoadError:function(a){(new R9.logger).error("Facebook Login API failed to load");return a.reject()},login:function(a){window.FB&&(jq.get("/vs/fd/topstrip/facebooklogin?action\x3dvs"),a=jq.extend({error:jq.noop,perms:"email,user_location",success:jq.noop},a),FB.login(function(b){b.authResponse?(jq.get("/vs/fd/topstrip/facebooklogin/accept?action\x3dvs"),a.success(b.authResponse.accessToken,
b.authResponse.userID)):(jq.get("/vs/fd/topstrip/facebooklogin/reject?action\x3dvs"),a.error())},{scope:a.perms}));return!1},link:function(a,b){return null!=FB.getAuthResponse()?(FB.logout(function(){AjaxReg.ui.fbLinkWarning(a,b)}),!1):R9.Social.FB.login({success:function(b,d){AjaxReg.facebook.link(a,b,d)},perms:b||""})},verifyLoginStatus:function(){R9.Social.doNotLoadThirdPartyScripts()||(-1!=document.cookie.indexOf("ssocontrol\x3dfbstatus")?R9.Social.FB.ensureAPILoaded(function(){FB.getLoginStatus(function(a){null==
a.authResponse&&R9.Analytics.api.trackEvent("facebook/status/unknown")})}):-1!=document.cookie.indexOf("ssocontrol\x3dfblogout")&&R9.Social.FB.ensureAPILoaded(function(){FB.getLoginStatus(function(a){a.authResponse?FB.logout(function(a){R9.Social.deleteControlCookie()}):R9.Social.deleteControlCookie()})}))}});
R9.extend("Social.Google",{initializing:!1,ensureAPILoaded:function(a){var b=jq.Deferred();b.promise();if(R9.Social.doNotLoadSocialResources())return"function"===typeof a&&a(),b.resolve();window.gapi&&window.gapi.auth2||this.initializing?("function"===typeof a&&a(),b.resolve()):(this.initializing=!0,jq.ajax({url:"https://apis.google.com/js/platform.js",async:!1,dataType:"script"}).done(this.onLoadSuccess.bind(this,b,a)).fail(this.onLoadError.bind(this,b)));return b},onLoadSuccess:function(a,b){var c=
this;if(gapi)gapi.load("auth2",function(){auth2=gapi.auth2.init({client_id:R9.globals.googleClientId,scope:"profile email"});c.initializing=!1;R9.events.publish("r9.google.api.loaded");return"function"===typeof b?b():a.resolve()});else this.onLoadError(a)},onLoadError:function(a){(new R9.logger).error("Google Social API failed to load");return a.reject()},login:function(a){gapi.auth2.getAuthInstance().signIn().then(function(b){(b=b.getAuthResponse())&&b.id_token&&R9.Social.WebCredentials.tryStoreGoogleLoginInWebCredentials(auth2.currentUser.get().getBasicProfile().getEmail());
a(b)});return!1},logout:function(a){gapi.auth2.getAuthInstance().signOut()},link:function(a){gapi.auth2.getAuthInstance().signIn().then(function(b){b=b.getAuthResponse();AjaxReg.google.link(a,b.access_token)})},verifyLoginStatus:function(){R9.Social.doNotLoadThirdPartyScripts()}});
R9.extend("Social.Google.Gmail",{ensureApiLoaded:function(){var a=jq.Deferred();"undefined"===typeof gapi||"undefined"===typeof gapi.auth?jq.getScript("https://apis.google.com/js/client.js",function(){gapi.load("auth",function(){gapi.auth.init(function(){a.resolve()})})}):a.resolve();return a.promise()},authorize:function(a,b){"function"!==typeof a&&(a=function(){});"function"!==typeof b&&(b=function(){});gapi.auth.authorize({client_id:R9.globals.gmailIScraperClientId,scope:"https://www.googleapis.com/auth/gmail.readonly profile email",
immediate:!1,access_type:"offline",approval_prompt:"force",response_type:"code",redirect_uri:"postmessage"},function(c){"undefined"!==typeof c.error?b(c.error):jq.ajax({type:"POST",url:"/k/run/inbox/requests/gmail/subscription",headers:{"X-CSRF":R9.globals.formtoken},data:"code\x3d"+c.code}).done(function(c){jq.ajax({type:"POST",dataType:"json",contentType:"application/json",url:"/inbox/gmail/subscribe",headers:{"X-CSRF":R9.globals.formtoken},data:JSON.stringify(c)}).done(function(b){a(b)}).fail(function(a){b(a.responseText,
a.status)})}).fail(function(a){b(a.responseText,a.status)})});return!1},unauthorize:function(a,b,c){"function"!==typeof b&&(b=function(){});"function"!==typeof c&&(c=function(){});jq.ajax({type:"POST",dataType:"json",url:"/k/run/inbox/requests/gmail/unsubscription",headers:{"X-CSRF":R9.globals.formtoken},data:"email\x3d"+a}).done(function(a){jq.ajax({type:"POST",dataType:"json",contentType:"application/json",url:"/inbox/gmail/unsubscribe",headers:{"X-CSRF":R9.globals.formtoken},data:JSON.stringify(a)}).done(function(a){b(a)}).fail(function(a){c(a.responseText,
a.status)})}).fail(function(a){c(a.responseText,a.status)});return!1}});
R9.extend("Social.WebCredentials",{postPasswordLoginForm:function(a){var b=jq.Deferred();a?(a.passwordName="passwd",a.additionalData=new URLSearchParams,a.additionalData.append("sticky",1),fetch("/k/run/auth/login",{method:"POST",credentials:a,headers:new Headers({"X-CSRF":R9.globals.formtoken})}).then(function(a){a&&200==a.status?a.json().then(function(a){0==a.status?(b.resolve(!0),R9.Analytics.api.trackEvent("webcredentials/password/success"),document.location=document.location.href):b.resolve(!1)}):
b.resolve(!1)})):b.resolve(!1);return b.promise()},postGoogleLogin:function(a){var b=jq.Deferred();if(a&&a.access_token){var c=new URLSearchParams;c.append("accessToken",a.access_token);c.append("sticky","true");fetch("/k/run/googleauth/login",{method:"POST",credentials:"same-origin",body:c,headers:new Headers({"X-CSRF":R9.globals.formtoken})}).then(function(a){a&&200==a.status?a.json().then(function(a){0==a.status?(b.resolve(!0),R9.Analytics.api.trackEvent("webcredentials/federated/success"),document.location=
document.location.href):b.resolve(!1)}):b.resolve(!1)})}else b.resolve(!1);return b.promise()},tryGoogleLogin:function(a){var b=jq.Deferred(),c=gapi.auth2.getAuthInstance();c.isSignedIn.get()&&c.currentUser.get().getBasicProfile().getEmail()===a.id&&b.resolve(!0);c.signIn({login_hint:a.id||""}).then(function(a){R9.Social.WebCredentials.postGoogleLogin(a.getAuthResponse())});return b.promise()},handleCredential:function(a){var b=jq.Deferred();a&&"password"==a.type?R9.Social.WebCredentials.postPasswordLoginForm(a).then(function(a){b.resolve(a)}):
a&&"federated"==a.type&&window.gapi?R9.Social.WebCredentials.tryGoogleLogin(a).then(function(a){b.resolve(a)}):b.resolve(!1);return b.promise()},tryAutoSignIn:function(){if(R9.globals.loginEnabled&&R9.globals.webCredentialsEnabled&&"https:"===document.location.protocol&&window.self===window.top){var a=R9.Social.WebCredentials.getCredentials();a&&(R9.Analytics.api.trackEvent("webcredentials/auto/start"),a.get({password:!0,unmediated:!0}).then(R9.Social.WebCredentials.handleCredential))}},trySignIn:function(a){R9.Social.Google.ensureAPILoaded();
var b=R9.Social.WebCredentials.getCredentials();b?b.get({password:!0,federated:{providers:["https://accounts.google.com"]}}).then(function(b){R9.Social.WebCredentials.handleCredential(b).then(function(b){b||a()})}):a()},tryStorePasswordLoginInWebCredentials:function(a,b){var c=R9.Social.WebCredentials.getCredentials();c&&a&&b&&(a=new PasswordCredential({id:a,password:b}),c.store(a))},tryStoreGoogleLoginInWebCredentials:function(a){var b=R9.Social.WebCredentials.getCredentials();b&&(a=new FederatedCredential({id:a,
provider:"https://accounts.google.com"}),b.store(a))},requireUserMediation:function(){var a=R9.Social.WebCredentials.getCredentials();a&&a.requireUserMediation()},getCredentials:function(){try{return navigator.credentials}catch(a){return null}}});(function(h){R9.extend("XDM",{getScriptSync:function(a){jq.ajax({url:a,dataType:"script",async:!1,cache:!1})},init:function(){if(!this.xdmRemote){"undefined"==typeof easyXDM&&this.getScriptSync("/res/js/alien/easyXDM.2.4.19.3.min.js?v\x3d927d357555171a7808eb57441ad8ee2c411412a2-nc");jq.isPlainObject(window.JSON)||this.getScriptSync("/res/js/mweb/json2.js?v\x3db551cdb9bd0f7213acf4dce4c63176dca7fb6f9c");var a=void 0!==window.AjaxReg?window.AjaxReg.remoteHost:R9.globals.remoteHost;this.xdmRemote=new easyXDM.Rpc({local:"/k/run/auth/xdm/name",
remote:a+"/k/run/auth/xdm/remoteMethods",remoteHelper:a+"/k/run/auth/xdm/name",swf:a+"/res/images/swf/easyxdm.2.4.19.3.swf?v\x3d4c1f8f9a5365b1f81c5962d6328a2a648a9f1891"},{remote:{postAjax:{},postJSON:{},loadAjax:{}}})}},remotePostAjax:function(a,d,e,f,b){try{this.init(),this.xdmRemote.postAjax(a,d,e,f)}catch(c){"function"===typeof b&&b(c)}},remotePostJSON:function(a,d,e,f,b){try{this.init(),this.xdmRemote.postJSON(a,d,e,f)}catch(c){"function"===typeof b&&b(c)}},remoteShowAjax:function(a,d,e,f,b,
c){try{this.init(),this.xdmRemote.loadAjax(a,d,e,f,b)}catch(g){"function"===typeof c&&c(g)}},xdmRemote:null})})(jq||jQuery);(function(t,w,p){function m(a,b){if(a&&b&&"object"===typeof b){var c,d;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);for(c=n.length;c--;)d=n[c],b.hasOwnProperty(d)&&(a[d]=b[d])}return a}function u(){return function(){return this.constructor.apply(this,arguments)||null}}var x=Object.create||function(){var a=function(){};return function(b){a.prototype=b;return new a}}(),n="hasOwnProperty valueOf isPrototypeOf propertyIsEnumerable toLocaleString toString constructor".split(" "),h=function(){};m(h,{$_className:"BaseClass",
$_isBaseClass:!0,parentClass:null,deepExtend:!1,singleton:!1,extend:function(a){var b=a.prototype,c,d;c=this.prototype=x(b);this.parentClass=c.parentClass=b;if(!a.$_isBaseClass)for(d in a=h.prototype,a)a.hasOwnProperty(d)&&d in c&&(c[d]=a[d])},addMembers:function(a){var b=this.prototype,c=[],d,e,f,g;for(f in a)a.hasOwnProperty(f)&&c.push(f);n&&c.push.apply(c,n);d=0;for(e=c.length;d<e;d++)f=c[d],a.hasOwnProperty(f)&&(g=a[f],b[f]="object"===typeof g&&"undefined"!==typeof b.deepExtend&&!0===b.deepExtend?
w.extend({},b[f]||{},g||{}):g);return this},addStatics:function(a){var b,c;for(c in a)a.hasOwnProperty(c)&&(b=a[c],this[c]=b);return this}});var l,q=[],r,v;for(r in h)h.hasOwnProperty(r)&&q.push(r);v=q.length;l=function(a,b,c){b||(b={});a=l.createClass(a);l.extend(a,b);b.statics&&(a.addStatics(b.statics),delete b.statics);b.$_className&&(a.$_className=b.$_className);a.addMembers.call(a,b);c.call(a);return a};m(l,{createClass:function(a){var b,c;a||(a=u());for(c=0;c<v;c++)b=q[c],a[b]=h[b];return a},
extend:function(a,b){var c=h.prototype,d=b.extend,e;if(d&&"string"===typeof d)throw Error("Extend class not found maybe you need to change extending order?");delete b.extend;delete b.parentClass;b=d&&d!==Object?d:h;d=b.prototype;if(!b.$_isBaseClass)for(e in c)c.hasOwnProperty(e)&&!d[e]&&(d[e]=c[e]);a.extend(b)}});var k={classes:{},existCache:{},enableNamespaceParseCache:!0,namespaceParseCache:{},parseNamespace:function(a){if("string"!==typeof a)throw Error("[Manager#parseNamespace] Invalid namespace, must be a string");
var b=this.namespaceParseCache,c;if(this.enableNamespaceParseCache&&b.hasOwnProperty(a))return b[a];c=[];c.push(p);c=c.concat(a.split("."));this.enableNamespaceParseCache&&(b[a]=c);return c},setNamespace:function(a,b){var c=p;a=this.parseNamespace(a);var d=a.length-1,e=a[d],f,g;for(f=0;f<d;f++)g=a[f],"string"!==typeof g?c=g:(c[g]||(c[g]={}),c=c[g]);c[e]=b;return c[e]},set:function(a,b){this.classes[a]=this.setNamespace(a,b);return this},get:function(a){var b=this.classes,c,d,e;if(b[a])return b[a];
b=p;a=this.parseNamespace(a);d=0;for(e=a.length;d<e;d++)if(c=a[d],"string"!==typeof c)b=c;else{if(!b||!b[c])return null;b=b[c]}return b},createClass:function(a,b){if(null!==a&&"string"!==typeof a)throw Error("[R9.define] Invalid class name '"+a+"' specified, must be a non-empty string");var c=u();"function"===typeof b&&(b=b(c));b.$_className=a;var d=b.extend;d&&"string"===typeof d&&(b.extend=k.get(d));return new l(c,b,function(){a&&k.set(a,this);b.singleton&&k.set(a,new this)})}};m(t,{define:function(a,
b){return k.createClass.apply(k,arguments)},get:function(a){return k.get.apply(k,arguments)}});t.apply=m})(window.R9,window.jQuery,window);(function(b){b.publish=function(a,c){c=c||{};a=a.split(".");var d={};d[a.pop()]=c;a=a.join(".");0<a.length?b.extend(a,d):b.extend(d)}})(R9);(function(b,d,e){var f=function(a,c,b){if(window.Rollbar){if("file"===window.location.protocol.substring(0,4)||!(0!==a.status&&0!==a.readyState||"error"===c&&""!==b))return;Rollbar.error("Action request failed. Url\x3d"+this.url,{url:this.url,statusCode:a.status,status:c,error:b})}"function"===typeof this.options.error&&this.options.error(a,c,b)};b.publish("action",e.extend({options:{},constructor:function(a,c){this.url=b.ajax.urlPrefix+a.split(".").join("/");this.options=d.extend({},this.options,
c)},execute:function(a){return d.ajax({type:"POST",url:this.url,data:d.extend(a,{formtoken:b.globals.formtoken}),success:this.options.success,error:f.bind(this)})}}));b.action.execute=function(a,c,e,f){return(new b.action(a,{success:e||d.noop,error:f||d.noop})).execute(c)}})(R9,jQuery,base2.Base);(function(b,h){function A(a,c,d,f){if(q(d)){var e=null;d>b.LOG_LEVEL.INFO&&(e=Error().stack||null);"string"!=typeof a&&(a=x(a));r(t([a,c,d,f,e].join("-")),function(b){b.message=a;b.path=c;b.errorType=f;b.errorLevel=u(d);b.stackTrace=e})}}function B(a,c,d){if(q(c)){var f=null;c>b.LOG_LEVEL.INFO&&(f=Error().stack||null);"string"!=typeof a&&(a=x(a));r(t([a,c,d,f].join("-")),function(e){e.message=a;e.errorType=d;e.errorLevel=u(c||b.LOG_LEVEL.DEBUG);e.stackTrace=f})}}function C(a,c,d,f,e){var g,h=b.LOG_TYPE.WINDOW,
k=b.LOG_LEVEL.ERROR;q(k)&&(e=t([k,h,a,c=c||null,d=d||null,f=f||null,g=e&&e.stack||null].join("-")),r(e,function(b){b.message=a;b.errorType=h;b.errorLevel=u(k);b.stackTrace=g;b.fileName=c;b.lineNo=d;b.colNo=f}))}function D(){for(var a=0,c=[],d=Object.keys(k);a<d.length;a++)c.push(k[d[a]]);return c}function E(a){var c=k[a];c||(c=k[a]={id:a,errorType:null,errorLevel:null,message:null,fileName:null,lineNo:null,colNo:null,stackTrace:null,element:null,occurrences:0});return c}function r(a,c){var d;-1<(g&&
g.ignored||[]).indexOf(a)||(0===(d=E(a)).occurrences&&c(d),d.occurrences++,null===v&&(l&&g.requestTimeout?g.requestAttemptLimit&&g.requestAttemptLimit<=n&&(l*=2):l=g.requestTimeout,v=l&&h.setTimeout(function(){y()},l)||y()))}function t(a){var c,d,b=0,e=0;if(a)for(d=a.length;b<d;b++)c=a.charCodeAt(b),e=(e<<5)-e+c,e|=0;return e}function u(a){for(var c=0,d=Object.keys(b.LOG_LEVEL);c<d.length;c++)if(b.LOG_LEVEL[d[c]]===a)return d[c];return null}function y(){var a=g.url||"",c=g&&g.testXHR||new h.XMLHttpRequest;
if(!c)return w("Browser does not support XHR"),null;c.onreadystatechange=F;c.open("POST",a,!0);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.send("content\x3d"+G(D()));k={};n++;return null}function F(){try{if(4===this.readyState)if(200!==this.status)w("Server side error",this.responseText);else{try{var a=JSON.parse(this.responseText);a&&a.ceaseLogging&&(g.enabled=!1)}catch(c){}v=null}}catch(c){w(c)}}function G(a){return encodeURIComponent(JSON.stringify({messageList:a,context:m({url:h.location.href,
attempt:n},m(p,m(H,{})))},function(a,b){return null!=b?b:""}))}function q(a){return g&&g.enabled&&a>=g.logLevel&&(!g.requestAttemptTotalLimit||n<g.requestAttemptTotalLimit)}function m(a,c){for(var b=0,f=Object.keys(a);b<f.length;b++)c[f[b]]=a[f[b]];return c}function x(a){if(a&&"undefined"!=typeof a.length){for(var b,d=0,f=[],e=Object.keys(a);d<e.length;d++)f.push("object"!=typeof(b=a[e[d]])?b:JSON.stringify(b));return f.join(", ")}return JSON.stringify(a)}function w(){(console&&(console.error||console.log)||
function(){}).apply(console||h,arguments)}var k={},n=0,v=null,l=0,H=function(){var a=h.screen||{};return{width:a.availWidth||0,height:a.availHeight||0}}(),z={url:"/horizon/clientlogger",enabled:!1,logLevel:3,consoleLogLevel:5,ignored:[],requestAttemptLimit:10,requestTimeout:750,requestAttemptTotalLimit:30},g=Object.create(z),p={};b.LOG_TYPE={WINDOW:"window",DEBUG:"debug"};b.LOG_LEVEL={ERROR:4,WARN:3,INFO:2,DEBUG:1};b.setOptions=function(a){m(a,g=Object.create(z));return b};b.log=function(a,c,d){B(a,
c||b.LOG_LEVEL.DEBUG,d||b.LOG_TYPE.DEBUG);return b};b.logWindow=function(a,c,d,f,e){C(a,c,d,f,e);return b};b.componentLog=function(a,c,d,f){A(a,c||"horizon/general",d||b.LOG_LEVEL.DEBUG,f||b.LOG_TYPE.DEBUG)};b.addToContext=function(a,c){a&&("object"==typeof a?m(a,p):p[a]=c);return b};b.removeFromContext=function(a){a&&delete p[a];return b};h.onerror=function(a,c,d,f,e){b.logWindow(a,c,d,f,e)};if(h.console&&h.console.log)try{b.console=h.console.log.apply?function(){return h.console.log.apply(h.console,
arguments)}:h.console.log}catch(a){b.console=function(){}}else b.console=function(){}})(window.R9Log={},window);(function(b,d,c){b.publish("logger",c.extend({componentPath:null,constructor:function(a){this.componentPath=a;this.consoleFormatString="%c %s %c".format(this.componentPath)},_log:function(a,b){R9Log.componentLog(b,this.componentPath,a,R9Log.LOG_TYPE.DEBUG)},info:function(a){this._log(R9Log.LOG_LEVEL.INFO,a)},warn:function(a){this._log(R9Log.LOG_LEVEL.WARN,a)},error:function(a){this._log(R9Log.LOG_LEVEL.ERROR,a)},console:function(){b.globals.showComponentLog&&(1===arguments.length&&"string"===typeof arguments[0]?
R9Log.console("%s %s".format(this.consoleFormatString,arguments[0]),"background: rgba(10, 10, 10, .9); color: #f49100","background: rgba(10,10,10, .9); color: #d3d1a1; text-shadow: 0 1px 6px rgba(255,255,255,0.81)"):this.consoleGroup.apply(this,arguments))},consoleGroup:function(){R9Log.console("--- %s ---".format(this.consoleFormatString),"background: rgba(10, 10, 10, .9); color: #f49100","");try{console.group&&console.group()||console.log();for(var a=0;a<arguments.length;a++)"string"===typeof arguments[a]?
R9Log.console("%c %s".format(arguments[a]),"background: rgba(10,10,10, .9); color: #d3d1a1; text-shadow: 0 1px 6px rgba(255,255,255,0.81)"):R9Log.console(arguments[a]);console.groupEnd&&console.groupEnd()}catch(e){console.groupEnd&&console.groupEnd()}}}))})(R9,jQuery,base2.Base);(function(d,e){e.remotePostJSON=function(b){var a=e.Deferred();d.XDM.remotePostJSON(b.url,b.data,b.success||a.resolve,b.error||a.reject,function(a){});return a.promise()};d.ajax=function(b,a){a=a||{};a.url=d.ajax.urlPrefix+b;var c=this;this.options.success=function(a,b,e){c.handleSuccess(a,b,e)};this.options.error=function(a,b,e){c.handleError(a,b,e)};this.options=e.extend(!0,{},this.options,a||{})};d.extend("ajax",!0,{_styles:{},_scripts:{},execute:function(b,a){return(new d.ajax(b,a)).execute()},
init:function(b,a){d.ajax.useFullResourceVersion=b;d.ajax.urlPrefix=a;d.ajax._initStyles();d.ajax._initScripts()},_initStyles:function(){for(var b,a=e(document.getElementsByTagName("head")[0]).find("style[data-type\x3d'style-metadata']").text().trim(),a=a.substring(2,a.length-2),a=a.split("|"),c=0;c<a.length;c++)b=d.ajax.canonicalizeResourceName(a[c]),d.ajax._styles[b]=b},_initScripts:function(){for(var b,a=e("style[data-type\x3d'script-metadata']").text().trim(),a=a.substring(2,a.length-2),a=a.split("|"),
c=0;c<a.length;c++)b=d.ajax.canonicalizeResourceName(a[c]),d.ajax._scripts[b]=b},canonicalizeResourceName:function(b){if(d.ajax.useFullResourceVersion)return b;var a=b.split("horizon/");return 2>a.length?b:a[1].replace(/\?(.*)$/,"")},preloadResources:function(b,a){var c=[].concat(b);b=[].concat(a);var e=new d.ajax;d.action.execute("common/core/PackageInfoAction",{packages:c,types:b},function(a){c.filter(function(b){return a.hasOwnProperty(b)}).forEach(function(b){b=a[b];b.hasOwnProperty("styles")&&
e.updateResources("styles",e.addStyle,b.styles);b.hasOwnProperty("scripts")&&e.updateResources("scripts",e.addScript,b.scripts)})})}});d.extend("ajax.prototype",!0,{request:null,response:null,options:{type:"POST",beforeScript:null,afterScript:null,errorScript:null,appendTo:null,insertAfter:!1,insertBefore:!1,replace:!1,renderImmediately:!0,htmlOnly:!1,useXDM:!1,enforceCaptcha:!1,captchaRedirectUrlHandler:function(){return encodeURIComponent(window.location.pathname)},beforeSend:function(b){b.setRequestHeader("X-CSRF",
d.globals.formtoken);b.setRequestHeader("X-RequestId",d.globals.requestId)},ajaxOptions:{},customUpdate:null},execute:function(){var b=this;this.promise=e.Deferred();var a=this.promise.promise();a.abort=function(){return b.request?b.request.abort():!1};this.request=this.options.useXDM?e.remotePostJSON(this.options):e.ajax(this.getAJAXOptions());return a},getAJAXOptions:function(){var b={},a;for(a in this.options)if(this.options.hasOwnProperty(a)){switch(a){case "beforeScript":case "afterScript":case "errorScript":case "appendTo":case "insertAfter":case "insertBefore":case "replace":case "renderImmediately":case "htmlOnly":case "useXDM":case "captchaRedirectUrlHandler":case "customUpdate":continue}b[a]=
this.options[a]}return b},handleSuccess:function(b,a,c){var d=this;this.processResponse(b);!1!==this.executeBeforeScripts()?e.when(this.updateStyles(),this.updateScripts()).then(function(){try{d.updateDOM();d.executeAfterScripts();var a={id:d.id};d.options.htmlOnly&&(a.html=d.response.content);d.promise.resolve(a,c)}catch(f){window.Rollbar&&Rollbar.error("Ajax success callback failed ("+d.options.url+")",f,{url:d.options.url})}}).fail(function(a){d.promise.reject(a);window.Rollbar&&Rollbar.error("Ajax resource update failed. ("+
d.options.url+")",a,{url:d.options.url})}):this.promise.resolve()},handleError:function(b,a,c){if(403===b.status&&this.options.enforceCaptcha)return this.handleCaptchaChallenge(b);this.promise.reject(b,a,c);window.Rollbar&&"file"!==window.location.protocol.substring(0,4)&&(0!==b.status&&0!==b.readyState||"error"===a&&""!==c)&&Rollbar.error("Ajax request failed. Url\x3d"+this.options.url,{url:this.options.url,statusCode:b.status,status:a,error:c})},handleCaptchaChallenge:function(b){window.location=
"/h/bots/human-redirect.vtl?url\x3d"+this.options.captchaRedirectUrlHandler()},computeNeededResources:function(b,a){return(a||this.response[b]||[]).filter(function(a){return!d.ajax["_"+b].hasOwnProperty(d.ajax.canonicalizeResourceName(a))})},updateResources:function(b,a,c){b=this.computeNeededResources(b,c);c=e.Deferred();e.when.apply(e,b.map(function(b){return a(b)})).then(c.resolve).fail(c.reject);return c.promise()},updateStyles:function(){return this.updateResources("styles",this.addStyle.bind(this))},
addStyle:function(b){var a=e('\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+b+'"/\x3e'),c=e.Deferred();d.config&&d.config.getBoolean("ui.horizon.ajax.blockUntilStylesLoad",!0)?(a.get(0).onload=function(){var a=d.ajax.canonicalizeResourceName(b);d.ajax._styles[a]=a;c.resolve()},a.get(0).onerror=c.reject):c.resolve();e("head").append(a);return c.promise()},updateScripts:function(){return this.updateResources("scripts",this.addScript.bind(this))},addScript:function(b){var a=e.Deferred();
e.getScript(b).done(function(){var c=d.ajax.canonicalizeResourceName(b);d.ajax._scripts[c]=c;a.resolve()}).fail(a.reject);return a.promise()},updateDOM:function(){var b=!1;if(!this.options.htmlOnly){var a=this,c=e("\x3cdiv\x3e");this.options.renderImmediately||c.css("display","none");c.html(this.response.content);"function"===typeof this.options.customUpdate&&(b=this.options.customUpdate(c.children(),this.response.content,this.options.replace));b||c.children().each(function(b,c){var d,h=a.options.replace||
null!==c.getAttribute("data-ajax-replace");c.id&&(d=e("#%s".format(c.id)),a.id=a.id||c.id);if(d&&0<d.length)h?d.html(e(c).html()):d.append(e(c).html());else try{if(a.options.appendTo)if(e.isArray(a.options.appendTo)){var g=a.options.appendTo.length,k=e(a.options.appendTo[b<g?b:g-1]);h?k.html(e(c)):k.append(c)}else a.options.replace?a.options.appendTo.html(e(c)):a.options.insertAfter?e(c).insertAfter(a.options.appendTo):a.options.insertBefore?e(c).insertBefore(a.options.appendTo):a.options.appendTo.append(c);
else console.error("No element present to append to")}catch(l){console.error("Error in DOM updating, FYI: appendTo has been switched to jQuery element",l)}});c.html(this.response.bufferedHTML);this.updateOrAppendBufferedHtml(c,!0);c.html(this.response.bufferedSVGs);this.updateOrAppendBufferedHtml(c,!1,e("#BufferedSVGWrapper"));c.html(this.response.clientTemplates);this.updateOrAppendBufferedHtml(c,!1)}},updateOrAppendBufferedHtml:function(b,a,c){var d=this;b.children().each(function(b,f){b=f.id?e(document.getElementById(f.id)):
[];d.id=d.id||f.id;0<b.length&&a?b.html(e(f).html()):0<b.length&&!a||("undefined"!==typeof c?c.append(f):e("body").append(f))})},executeBeforeScripts:function(){return"function"===typeof this.options.beforeScript?this.options.beforeScript.call(this):!0},executeAfterScripts:function(){for(var b=0;b<this.response.bufferedScripts.length;++b)d.utils.evaluateScript(this.response.bufferedScripts[b]);if("function"===typeof this.options.afterScript)return this.options.afterScript.call(this)},processResponse:function(b){this.response=
e.extend({content:"",context:"",cid:"",bufferedScripts:[],scripts:[],styles:[]},b||{})}})})(R9,jQuery);(function(f){var k=function(a,b,c){window.Rollbar&&Rollbar.error("Error in events.publish ("+a+")",c,{event:a,publishData:b})},g=function(a,b,c){if(window._debugEvents||R9.config&&R9.config.getBoolean("ui.events.debug",!1))a=["%c %s: %c %s".format(a,b),"color: #"+("subscribe"===a?"3083F0":"FF690F"),"color: inherit"],"undefined"!==typeof c&&a.push(c),"string"===typeof window._debugEvents&&-1===b.indexOf(window._debugEvents)||window.console.log.apply(window.console,a)},l=function(a){return function(b){if("string"===
typeof a)return b===a;if("object"===typeof a&&"object"===typeof b){for(var c in a)if(a.hasOwnProperty(c)&&(!b.hasOwnProperty(c)||b[c]!==a[c]))return!1;return!0}return!1}};R9.publish("events",{subscribe:function(a){var b=[].concat(a),c,d;if(3===arguments.length){d=arguments[2];var m=l(arguments[1]);c=function(a,b){try{m(b)&&d(b)}catch(h){k(a.type,b,h)}}}else d=arguments[1],c=function(a,b){try{d(b)}catch(h){k(a.type,b,h)}};for(var e=0;e<b.length;e++)g("subscribe",b[e]),f(R9.events).bind(R9.events._prefix+
b[e].replace(/\./g,"_"),c);return c},unsubscribe:function(a,b){a=[].concat(a);for(var c=0;c<a.length;c++)g("unsubscribe",a[c]),f(R9.events).unbind(R9.events._prefix+a[c].replace(/\./g,"_"),b)},publish:function(a,b){a||console.error("Missing event name - may cause weird stuff to happen");a=[].concat(a);for(var c=0;c<a.length;c++)g("publish",a[c],b),f(R9.events).trigger(R9.events._prefix+a[c].replace(/\./g,"_"),b)},when:function(a,b){void 0!==this._globals[a]?b(this._globals[a]):this.subscribe(a,b)},
ready:function(a,b){this._globals[a]=b;this.publish(a,b)},_globals:{},_prefix:"horizon_events_"})})(window.jq||window.jQuery);(function(d){R9.publish("question",{_questionAnswerMap:{},answer:function(a,b){a=a.replace(/\./g,"_");this._questionAnswerMap.hasOwnProperty(a)&&console.error("Duplicate question name '"+a+"' is being overwritten.");"function"!==typeof b?console.error("Handler for answer is not a function"):this._questionAnswerMap[a]=b},ask:function(a,b){(a=a.replace(/\./g,"_"))||console.error("Missing question name - may cause weird stuff to happen");if(this._questionAnswerMap.hasOwnProperty(a)&&"function"===typeof this._questionAnswerMap[a])try{return this._questionAnswerMap[a].call({questionName:a},
b)}catch(c){window.Rollbar&&Rollbar.error("Error in question.ask ("+a+")",c,{questionName:a})}window._debugEvents&&console.warn("Missing question answer: '%s'.  No component is registered to answer this question".format(a));return null},forget:function(a){a=a.replace(/\./g,"_");return this._questionAnswerMap.hasOwnProperty(a)?(delete this._questionAnswerMap[a],!0):!1}})})(window.jq||window.jQuery);(function(d){var b=!1;try{window.localStorage.setItem("vendor-support-test","success?"),window.localStorage.removeItem("vendor-support-test"),b=!0}catch(a){}d.publish("storage",{get:function(a){if(b){a=localStorage.getItem(a);try{return JSON.parse(a)}catch(c){return a}}},set:function(a,c){try{b&&(null!==c&&"object"===typeof c?localStorage.setItem(a,JSON.stringify(c)):localStorage.setItem(a,c))}catch(e){}},remove:function(a){try{b&&localStorage.removeItem(a)}catch(c){}},clear:function(){b&&localStorage.clear()},
isAvailable:function(){return b}})})(R9);(function(c,d,e){c.publish("template",{_parsedComponents:{},render:function(b,c){var a=this._parsedComponents[b];if(void 0===a){a=d("#"+b).html();if(null===a)throw"TemplateFactory rendering failure: template [%s] is absent or blank".format(b);this._parsedComponents[b]=a;e.parse(a)}return e.render(a,c||{})},renderElement:function(){return d(this.render.apply(this,arguments))}})})(R9,jQuery,Mustache);(function(d,e,h){function f(a,b,c){var g;"function"===typeof c?(["options","events"].forEach(function(a){b.hasOwnProperty(a)&&c.prototype.hasOwnProperty(a)&&(b[a]=e.extend({},c.prototype[a],b[a]))}),g=c.extend(b)):g=d.Component.extend(b);g.prototype._namespace=a;d.publish(a,g);d.events.ready(a,g)}d.publish("ComponentManager",function(){var a={};return{register:function(b,c){a[b]=c},remove:function(b,c){var d=this,f="undefined"!==typeof c?c:!0;b=e("string"!==typeof b?b:"#"+b);var h=b.attr("id");Object.keys(a).filter(function(a){return d.isChildOfParentComponent(a,
h)}).forEach(function(b){var c=document.getElementById(b);a[b].destroy();delete a[b];null!==c&&f&&c.parentNode.removeChild(c)});f&&b.remove()},isChildOfParentComponent:function(a,c){if(!a||!c)return!1;for(a=document.getElementById(a);null!==a;){if(a.id===c)return!0;a=a.parentElement}},debugGetComponent:function(b){return a[b]}}}());window.debugGetComponent=function(a){return window.R9.ComponentManager.debugGetComponent(a)};d.publish("Component",h.extend({options:{namespace:null},subscriptions:null,
questions:null,events:{},element:null,elementNode:null,_id:"",_namespace:null,_logPath:"horizon/general",constructor:function(a,b,c){this.options=e.extend(!0,{},this.options,b||{},c||{});this.element=e("string"!==typeof a||0===a.length?a:"#"+a);this.elementNode=this.element.get(0);this._id="string"===typeof a?a:this.element.attr("id");this.subscriptions={};this.questions={};this.element.attr("js-component",!0);d.ComponentManager.register(this._id,this);this._namespace&&(this.product=this._namespace.split(".")[0],
a=this._namespace.replace(/\./g,"/")+"/",this.options.namespace&&(a+=this.options.namespace+"/"),this._logPath=a);this.log=new d.logger(this._logPath);this.init(this.element);this.addEventHandlers(this.element);d.events.when("inlineComponents.initialized",e.proxy(function(){this.inlineComponentsReady()},this))},id:function(a){return 0<arguments.length?"%s-%s".format(this._id,a):this._id},getChildElement:function(a){return e("#"+this.id(a))},inlineComponentsReady:function(){},init:function(a){},addEventHandlers:function(a){},
destroy:function(){Object.keys(this.subscriptions).forEach(this.unsubscribe.bind(this));Object.keys(this.questions).forEach(function(a){d.question.forget(a)})},subscribe:function(){var a=Array.prototype.slice.call(arguments);[].concat(a.shift(1)).forEach(function(b){var c=d.events.subscribe.apply(null,[b].concat(a));e.isArray(this.subscriptions[b])?this.subscriptions[b].push(c):this.subscriptions[b]=[c]}.bind(this))},unsubscribe:function(a){e.isArray(this.subscriptions[a])&&(this.subscriptions[a].map(function(b){d.events.unsubscribe(a,
b)}),delete this.subscriptions[a])},answer:function(a,b){this.questions[a]=b;d.question.answer(a,b)}}));d.createComponentClass=function(a){if(3===arguments.length&&"object"===typeof arguments[2]){var b=arguments[2];d.events.when(arguments[1],function(c){f(a,b,c)})}else f.apply(this,arguments)};d.define("R9.common.Component",e.extend({},d.Component.prototype,{parentClass:"BaseClass"}))})(window.R9,window.jQuery,window.base2.Base);(function(c,e){c.publish("authentication",{url:"common/authentication/DialogContainer",formToken:null,userInfo:null,cached_params:null,cached_dialog:null,waitingOnDialog:!1,needsRefresh:!1,loggingPrefix:"account-login",showDefault:function(a){!c.config.getBoolean("ui.login.staticSignInEnabled",!1)||c.config.getBoolean("ui.social.forceOff",!1)?this.showLogin(a):this._showDialog("default",a)},showLogin:function(a){this._showDialog("login",a)},showSignup:function(a){this._showDialog("signup",a)},showTabFromUsername:function(a){this._showDialog("auto",
a)},preloadDialog:function(){!c.config.getBoolean("ui.login.staticSignInEnabled",!1)||c.config.getBoolean("ui.social.forceOff",!1)?this._getDialog("login",{}):this._getDialog("default",{})},_showDialog:function(a,b,g){function d(){f.waitingOnDialog=!0;f._getDialog(a,b).then(function(a){a.open();h&&h(a);f.waitingOnDialog=!1;e&&c.events.subscribe("authentication.success",e);c.events.publish("authentication.showLogin")}).fail(function(c){f.waitingOnDialog=!1;!b.username||"undefined"!==typeof g&&g||(delete b.username,
b.success=e||null,b.aftershow=h||null,f._showDialog(a,b,!0))})}var f=this,h=null,e=null;this.waitingOnDialog||(b&&(void 0!==b.success&&"function"===typeof b.success&&(e=b.success,b.usingCustomCallback=!0,delete b.success),void 0!==b.aftershow&&"function"===typeof b.aftershow&&(h=b.aftershow,delete b.aftershow)),this._loadThirdPartyJS().then(d,d),"default"===a&&c.Analytics.api.trackEvent({category:this.loggingPrefix,action:"display-dialog",label:b.promoType}))},_canUseExistingDialog:function(a,b){a=
JSON.stringify(b)+a+this.url;if(this.cached_params===a&&null!==this.cached_dialog)return!0;this.cached_params=a;return!1},_getDialog:function(a,b){var g=this,d=e.Deferred(),f=e.extend({type:a},b);if(this._canUseExistingDialog(a,b))return d.resolve(this.cached_dialog);c.ajax.execute(this.url,{data:f,useXDM:"location"in document&&"http:"===document.location.protocol}).then(function(a){var c=e("#"+a.id).dialog({preventClose:b&&b.preventClose}).getWidget();g.cached_dialog=c;return d.resolve(c,a)}).fail(function(a){return d.reject(a)});
return d.promise()},_loadThirdPartyJS:function(){var a=c.Social.FB.ensureAPILoaded(),b=c.Social.Google.ensureAPILoaded();window.setTimeout(function(){a.resolve();b.resolve()},2E3);return e.when(a,b)}});c.publish("authentication.social",e.extend({},c.authentication,{url:"common/authentication/SocialSignInDialog",showSocialLogin:function(a){this._showDialog("login",a)}}));c.publish("authentication.external",{url:"common/authentication/ExternalResponse",facebook:{url:"/k/run/fbauth/",doExternalLogin:function(){var a=
e.Deferred();c.Social.FB.login({success:a.resolve});return a.promise()},_login:function(a,b,g,d,f){e.remotePostJSON({url:this.url+"login",data:{accessToken:a||"",userId:b||"",confirm:g||0,confcode:d||""}}).then(function(d){0===d.status?(c.events.publish("fbauth.login.success",d),f=e.extend({},{category:"account-login",label:null},f),"signin"===d.message?c.Analytics.api.trackEvent({category:f.category,action:"login-facebook",label:f.label}):"signup"===d.message&&c.Analytics.api.trackEvent({category:f.category,
action:"signup-facebook",label:f.label})):1===d.status&&c.ajax.execute(c.authentication.external.url,{data:{accessToken:a,userId:b,type:d.message,site:"fb"}}).then(function(){c.events.publish("social.response.loaded",!0)})})},login:function(a,b,c,d,f){var e=this;if(a&&b)return this._login.apply(this,arguments);this.doExternalLogin().then(function(a,b){e._login(a,b,c,d,f)})},loginAndLink:function(a,b,g,d){e.remotePostJSON({url:this.url+"loginAndLinkExisting",data:{accessToken:a||"",userId:b||"",username:g,
passwd:d}}).then(function(a){0===a.status?(c.events.publish("fbauth.login.success",a),"signin"===a.message?c.Analytics.api.trackEvent({category:"account-login",action:"login-facebook"}):"signup"===a.message&&c.Analytics.api.trackEvent({category:"account-login",action:"signup-facebook"})):1!==a.status&&c.events.publish("social.error",a)})}},google:{url:"/k/run/googleauth/",doExternalLogin:function(){var a=e.Deferred();c.Social.Google.login(a.resolve);return a.promise()},_login:function(a,b,g,d){e.remotePostJSON({url:this.url+
"login",data:{confcode:g||"",confirm:b||0,accessToken:a,sticky:!0}}).then(function(b){0===b.status?(c.events.publish("googleauth.login.success",b),d=e.extend({},{category:"account-login",label:null}),"signin"===b.message?c.Analytics.api.trackEvent({category:d.category,action:"login-google",label:d.label}):"signup"===b.message&&c.Analytics.api.trackEvent({category:d.category,action:"signup-google",label:d.label})):1===b.status&&"w"===b.message?c.ajax.execute(c.authentication.external.url,{data:{accessToken:a,
type:b.message,site:"google"}}).then(function(){c.events.publish("social.response.loaded",!0)}):c.events.publish("social.error",b)})},login:function(a,b,c,d){var f=this;if(a)return this._login.apply(this,arguments);this.doExternalLogin().then(function(a){f._login(a.access_token,b,c,d)})},loginAndLink:function(a,b,g,d){e.remotePostJSON({url:this.url+"loginAndLinkExisting",data:{accessToken:a||"",userId:b||"",username:g,passwd:d}}).then(function(a){0===a.status?(c.events.publish("googleauth.login.success",
a),"signin"===a.message?c.Analytics.api.trackEvent({category:"account-login",action:"login-google"}):"signup"===a.message&&c.Analytics.api.trackEvent({category:"account-login",action:"signup-google"})):c.events.publish("social.error",a)})},link:function(a){e.remotePostJSON({url:this.url+"link",data:{accessToken:a}}).then(function(a){0===a.status?c.events.publish("googleauth.link.success",a):1===a.status?c.Social.Google.logout():-1===a.status&&c.events.publish("social.error",a)})}}})})(R9,jQuery||
jq);(function(f,c,k){function g(a,b,e){var d;"function"===typeof e?(["options","events"].forEach(function(a){b.hasOwnProperty(a)&&e.prototype.hasOwnProperty(a)&&(b[a]=c.extend({},e.prototype[a],b[a]))}),d=e.extend(b)):d=f.Widget.extend(b);d.prototype._namespace=a;f.publish(a,d);f.events.ready(a,d);return d}function h(a,b){c.fn.hasOwnProperty(a)?console.error("jQuery.fn constructor already exists for %s, use jQueryConstructorName to avoid namespace collision".format(a)):c.fn[a]=function(a){return this.each(function(){new f.common.widgets[b](c(this),
a)})}}c.fn.getWidget=function(){return this.data("widget")};f.publish("Widget",f.Component.extend({constructor:function(a,b,e){null!==a?(this.base(a,b,e),this.bindComponent()):(this.options=c.extend({},this.options,c.extend(b||{},e||{})),this.init())},bindComponent:function(){this.element.data("widget",this)},isValidElement:function(){return!0},setOption:function(a,b){this.options&&this.options.hasOwnProperty(a)&&(this.options[a]=b)},getValue:function(){return null}}));f.createWidgetClass=function(a){var b=
"common.widgets."+a,e,d,c;3===arguments.length&&"function"===typeof arguments[1]?(d=arguments[1],e=arguments[2],c=g(b,e,d)):3===arguments.length&&"string"===typeof arguments[1]?(d=arguments[1],e=arguments[2],f.events.when(d,function(a){c=g(b,e,a)})):c=g(b,arguments[1]);d=c&&c.prototype&&c.prototype.hasOwnProperty("jQueryConstructorName")?c.prototype.jQueryConstructorName:a[0].toLowerCase()+a.slice(1);h(d,a)}})(R9,jQuery,base2.Base);(function(a){var b={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#39;"};a.publish("utils.escapeHTML",function(a){return String(a).replace(/[&<>"']/g,function(a){return b[a]})})})(R9);(function(b){b.publish("utils.search.encodeLocation",function(a){a=(a+"").replace(/, /g,",").replace(/ - /g,",").replace(/ /g,"-").removeAccentedChars();if("undefined"===typeof b.globals||"undefined"===typeof b.globals.useFullSearchUrl||!0!==b.globals.useFullSearchUrl)a=a.replace(/[^A-Za-z0-9_\-,.]/g,"");return a})})(R9);(function(e,d){e.define("R9.utils.AsyncRequestQueue",{requestQ:[],delay:100,polling:!1,REQUEUE:"requeue",constructor:function(a){this.delay=a.pollFrequency||this.delay},createRequest:function(a){var c=this,b=d.Deferred();a=function(a,b){return{fire:function(a){b.call(c,a)},deferred:a}}(b,a);this.requestQ.push(a);this.poll();return b},serviceRequest:function(){var a=this.requestQ.shift(),c=this;if(a){var b=d.Deferred();a.fire(b);d.when(b).then(function(c){a.deferred.resolve(c)}).fail(function(b){b===
c.REQUEUE?c.requestQ.push(a):a.deferred.reject("failed to get the data: "+b)}).always(function(){setTimeout(c.serviceRequest.bind(c),c.delay)})}else this.polling=!1},poll:function(){this.polling||(this.polling=!0,this.serviceRequest())}})})(R9,jQuery);(function(b,d){b.define("R9.utils.ClipboardCopy",{trigger:void 0,options:{clearSelection:!1,onError:null,onSuccess:null},constructor:function(a,b){this.trigger=a;d.extend(this.options,b);this.init();return this},meetsRequirements:function(){return"function"!==typeof Clipboard?(console.warn("clipboard.js lib dependency not met"),!1):"function"!==typeof b.Widgets.Tooltip?(console.warn("toolTip lib dependency not met"),!1):1>d(this.options.trigger).attr("data-title")?(console.warn("data-title attr missing for tooltip"),
!1):!0},init:function(){var a=this;if(this.meetsRequirements()){var e=new Clipboard(a.trigger,a.options),f=function(c,a){var b={showImmediately:!0,delay:0,closeDelay:a.lifetime,closeOnBodyClick:!1},d=c.attr(a.error?"data-error-title":"data-title");b.content=d?d:a.content;c.toolTip(b);setTimeout(function(){c.data("toolTip")&&c.data("toolTip").removeWidget()},a.lifetime)};e.on("success",function(c){console.log(b.messages);f(d(c.trigger),{content:b.messages.framework.CLIPBOARD_COPY_SUCCESS,lifetime:1E3});
a.options.clearSelection&&c.clearSelection();if(a.options.onSuccess)a.options.onSuccess()});e.on("error",function(c){var e=-1<window.navigator.platform.indexOf("Mac")?b.messages.framework.CLIPBOARD_ERROR_MAC:b.messages.framework.CLIPBOARD_ERROR_WINDOWS;f(d(c.trigger),{content:e,error:!0,lifetime:3E3});console.warn("Clipboard copy error:",c);if(a.options.onError)a.options.onError()})}}})})(R9,jQuery);(function(a,b){a.publish("utils.presentation.isMobile",function(){return 568>b(window).width()});a.publish("utils.presentation.isTablet",function(){return 1040>b(window).width()})})(R9,jQuery);(function(c,d){c.createComponentClass("framework.body",{classes:{keelClass:"",extraClass:"",packageClass:""},options:{keelClass:"",extraClass:"",packageClass:""},init:function(){this.classes={keelClass:this.options.keelClass,packageClass:this.options.packageClass,extraClass:this.options.extraClass}},addEventHandlers:function(){var a=this;c.events.subscribe("body.setClass",function(b){"string"===typeof b?a.setBodyClass({extraClass:b}):a.setBodyClass(b)})},setBodyClass:function(a){d.extend(this.classes,
a);this.elementNode.className="%s %s %s horizon".format(this.classes.keelClass,this.classes.packageClass,this.classes.extraClass)}})})(R9,jQuery);(function(e,f){e.publish("validation",{currentError:null,types:{ALPHABETIC:{regEx:/^[a-zA-Z -]+$/,msg:"ERROR_VALIDATION_ALPHABETIC"},ALPHANUMERIC:{regEx:/^[\w -/]+$/,msg:"ERROR_VALIDATION_ALPHANUMERIC"},URL:{regEx:/^([\w-]+\:\/\/)?[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?$/,msg:"ERROR_VALIDATION_URL"},NUMERIC:{regEx:/^-?[0-9.]+$/,msg:"ERROR_VALIDATION_NUMERIC"},YEAR:{regEx:/^\d{4}$/,msg:"ERROR_VALIDATION_YEAR"},PHONE:{regEx:/^\+?[\d .-]{7,20}$/,msg:"ERROR_VALIDATION_PHONE"},
POSTALCODE:{regEx:/^[a-z0-9][a-z0-9\- ]{0,10}[a-z0-9]$/,msg:"ERROR_VALIDATION_POSTALCODE"},NOSPECIAL:{regEx:/^[\w .,()-]+$/,msg:"ERROR_VALIDATION_SENTENCE"},CUSTOM:{msg:"ERROR_VALIDATION_CUSTOM"}},validate:function(a,b,c,d){return(b=b||f(a).data("validationType"))?this._validate(this.types[b.toUpperCase()],a,c,d):!0},customValidate:function(a,b,c,d){return this._validate(this.types.CUSTOM,a,c,d,b)},_validate:function(a,b,c,d,g){var e=f(b).val();g=g?g:a.regEx;if(""!==e&&g&&!g.test(e))return(d&&"function"===
typeof d?d:this._showError)(b,a),!1;(c&&"function"===typeof c?c:this._clearError)(b);return!0},_showError:function(a,b){f(a).toolTip({content:e.Common.Utils.String.formatString(b.msg),baseClass:"loginDlgError",position:"top",showImmediately:!0,activation:"focus"})},_clearError:function(a){f(a).data("toolTip")&&f(a).data("toolTip").removeWidget()}})})(R9,jQuery);(function(a){a.extend("messages.framework",{CLIPBOARD_COPY_SUCCESS:"Copied",CLIPBOARD_ERROR_WINDOWS:"Press Ctrl+C or use the browser menus to copy",CLIPBOARD_ERROR_MAC:"Press \u2318+C or use the menus to copy"})})(R9);