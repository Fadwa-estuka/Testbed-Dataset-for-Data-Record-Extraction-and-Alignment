(function(b,c){b.createComponentClass("activities.ads.ActivitiesIntentMedia","common.ads.IntentMedia",{options:{searchFormPrefix:"activities"},addEventHandlers:function(){this.base();this.subscribe("activities.frontdoor.form.location",this.onFormLocationChange.bind(this))},onFormLocationChange:function(a){var b=this;this.lastLocationChangeID&&clearTimeout(this.lastLocationChangeID);a&&(this.lastLocationChangeID=setTimeout(function(){b.loadSmartyCityProperties(a.cityId)},300))},setupSearchIntentMediaProperties:function(a){a=
a||{};window.IntentMediaProperties=window.IntentMediaProperties||{};c.extend(window.IntentMediaProperties,{travel_date_start:a.departDate,travel_date_end:a.returnDate,form_compare_pops:0,activities_area_id:this.options.searchCityId,activities_city:this.options.searchCity,activities_state:this.options.searchState,activities_country:this.options.searchCountry})}})})(R9,jQuery);(function(a,b){a.createComponentClass("activities.details.DetailsContent",{image:null,init:function(){this.image=this.getChildElement("image");this.handleWindowResizeEvent();a.Widgets.Toaster.removeAllToasts("saveToTripToast")},addEventHandlers:function(){var c=this;this.getChildElement("book").click(function(b){a.events.publish("book.providerClicked",{resultId:c.options.activityId});c.trackResultEvent(b)});b(window).resize(this.handleWindowResizeEvent.bind(c));this.getChildElement("save").on("click")},
trackResultEvent:function(){a.Analytics.api.trackEvent({category:"booking-clicks",action:"booking-click-button"})},handleWindowResizeEvent:function(){a.utils.presentation.isMobile()&&this.image.attr("src")!==this.options.thumbmobileurl?this.image.attr("src",this.options.thumbmobileurl):!a.utils.presentation.isMobile()&&a.utils.presentation.isTablet()&&this.image.attr("src")!==this.options.thumburl&&this.image.attr("src",this.options.thumburl)}})})(R9,window.jq||window.jQuery);(function(c){c.createComponentClass("activities.details.Map",{mapId:"map",options:{lat:0,lng:0,filterLmLat:0,filterLmLong:0,name:"",geoPointImage:null,poi:null},map:null,mapNode:null,center:null,orange:"#FF690F",blue:"#3083F0",init:function(){var a=this;this.mapNode=this.getChildElement("map").get(0);this.center=this.getCenter();var b=this.options.showNearbyPanel?"customMapType":google.maps.MapTypeId.ROADMAP;this.map=new google.maps.Map(this.mapNode,{center:this.center,zoom:13,draggable:this.isTouchDevice()?
!1:!0,scrollwheel:!1,panControl:!1,scaleControl:!1,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},streetViewControl:!1,mapTypeControl:!1,mapTypeControlOptions:{mapTypeIds:[b,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.TERRAIN,google.maps.MapTypeId.HYBRID]}});a.map.set("styles",c.Common.Widgets.Maps.Styles.MapInlineDetailsStyle.getGoogleStyle().styles);a.map.addListener("maptypeid_changed",function(){a.map.mapTypeId===google.maps.MapTypeId.ROADMAP?a.map.set("styles",
c.Common.Widgets.Maps.Styles.MapInlineDetailsStyle.getGoogleStyle().styles):a.map.set("styles",[]);a.map.mapTypeId!==google.maps.MapTypeId.SATELLITE&&a.map.mapTypeId!==google.maps.MapTypeId.HYBRID||a.map.setTilt(45)});"customMapType"===b&&(this.map.mapTypes.set("customMapType",c.Common.Widgets.Maps.Styles.MapInlineDetailsStyle.getGoogleStyle()),this.map.setMapTypeId("customMapType"));this.addPOIMarkers();this.addFilterMarker(this.options.filterLmLat,this.options.filterLmLong);this.addActivityMarker();
this.updateCenter()},addEventHandlers:function(){jq(window).resize(this.updateCenter.bind(this))},getCenter:function(){if(this.options.lat&&this.options.lng)return new google.maps.LatLng(this.options.lat,this.options.lng);if(this.options.filterLmLat&&this.options.filterLmLong)return new google.maps.LatLng(this.options.filterLmLat,this.options.filterLmLong)},addActivityMarker:function(){this.options.lat&&this.options.lng&&this.addMarker(this.center,this.circleIcon(this.orange),100)},addFilterMarker:function(a,
b){if(!a||!b)return!1;this.addMarker(new google.maps.LatLng(a,b),this.options.geoPointImage||this.circleIcon(this.blue),99)},addPOIMarkers:function(){if(!this.options.poi)return!1;for(var a=this.options.poi.length,b=0;b<a;b++){var c=this.options.poi[b];this.addMarker(new google.maps.LatLng(c.first,c.second),this.circleIcon(this.blue),98)}},addMarker:function(a,b,c){new google.maps.Marker({map:this.map,position:a,icon:b,optimized:!1,zIndex:c||1})},circleIcon:function(a){return{path:google.maps.SymbolPath.CIRCLE,
scale:10,fillColor:a,fillOpacity:1,strokeColor:"#FFF",strokeWeight:2}},updateCenter:function(){this.map.setCenter(this.center)},isTouchDevice:function(){return"ontouchstart"in window||navigator&&navigator.maxTouchPoints}})})(R9);(function(a){a.createComponentClass("activities.frontdoor.ActivitiesFrontDoor","base.frontdoor.FrontDoor",{})})(R9);(function(a){a.createComponentClass("activities.frontdoor.ActivitiesFrontDoorContent","common.frontdoor.FrontDoorContent",{vertical:"activities"})})(window.R9);(function(c,d){c.createComponentClass("activities.mobile.Smarty",{dialog:null,done:null,location:null,body:null,data:null,options:{parentId:null,smartyType:4,smartyUrl:"/f/smarty",smartyVersion:"v1"},init:function(){this.dialog=this.element.dialog({afterOpen:this.focusToInput.bind(this)}).getWidget();this.done=this.getChildElement("done");this.location=this.getChildElement("location");this.body=this.getChildElement("contents");this.bindSmartyBox()},addEventHandlers:function(){c.events.subscribe("activities.mobile.Smarty.show",
d.proxy(this.open,this));c.events.subscribe("activities.mobile.Smarty.hide",d.proxy(this.close,this));this.done.on("click",this.close.bind(this))},open:function(a){this.data=a;this.dialog.open()},close:function(){this.data=null;this.dialog.close()},focusToInput:function(){this.location.val(this.data?this.data.location:"").trigger("mousedown").focus()},getParentId:function(){return this.options.parentId},getParentElement:function(a){return d("#"+this.getParentId()+"-"+a)},bindSmartyBox:function(){var a=
this;this.cityId=this.getParentElement("city-id");this.activityId=this.getParentElement("activity-id");this.regionId=this.getParentElement("regionId");this.freeRegionId=this.getParentElement("freeRegionId");this.countryId=this.getParentElement("countryId");this.location.activitiesSmarty({flareSmartyType:a.options.smartyType,dataSource:a.options.smartyUrl,minWidth:420,extendRequest:{v:a.options.smartyVersion},appendTo:a.body,dropdownClass:" smartbox smartbox-air R9-Overlay mobile-smarty",clearItem:function(){a.cityId.val("");
a.activityId.val("");a.neighbourhoodId=null;a.freeRegionId.val("");a.regionId.val("");a.countryId.val("");c.events.publish("activities.frontdoor.form.location",{id:a.getParentId(),location:"",cityId:"",activityId:""})},setItem:function(d,e){var b=e||{};setTimeout(function(){c.Analytics.api.trackEvent({category:a.trackCategory,action:"select-destination",value:b.str});c.events.publish("activities.frontdoor.form.location",{id:a.getParentId(),location:b.str,cityId:b.id||"",activityId:b.activityId||"",
freeRegionId:b.frid||"",regionId:b.rid||"",countryId:b.cid||""});a.location.val(b.str);a.dialog.close()},1)},afterDone:function(){""===a.location.val()&&(a.cityId.val(""),a.activityId.val(""),a.freeRegionId.val(""),a.regionId.val(""),a.countryId.val(""),c.events.publish("activities.frontdoor.form.location",{id:a.getParentId(),location:"",cityId:"",activityId:""}))}})}})})(R9,window.jq||window.jQuery);(function(f){f.createComponentClass("activities.results.filters.ActivitiesCategoriesFilter","common.results.filters.ValueSetFilter",{itemTemplateId:"activitiesCategoriesFilterItem",makeFilterOption:function(a,b,c,e){var d=this;return new f.activities.results.filters.ActivitiesCategoriesFilterItem(a,{state:b,name:c,group:this.name,onUserChange:function(){d.filterItemDidChange.apply(d,Array.prototype.slice.call(arguments).concat(this))},heading:e})},reset:function(a){var b=this;this.forEachItem(function(a,
e){e&&null===e.state.parent&&b.toggleElementPartiallySelected(e.element,!1)});this.base(a)},toggleParentCategory:function(a){if(!a)return!1;var b=this.getRenderedFilterOptions()[a];if(!b)return!1;a=this.countChildrenSelected(a);var c=a.total===a.selected?1:0;this.toggleElementPartiallySelected(b.element,!c&&0<a.selected);b.setChecked(c)},toggleChildCategories:function(a,b){if(!a)return!1;this.forEachItem(function(c,d){d&&d.state.parent===a&&d.setChecked(void 0===b.selected?1:b.selected)});var c=this.getRenderedFilterOptions()[a];
c&&this.toggleElementPartiallySelected(c.element,!1)},toggleElementPartiallySelected:function(a,b){a.toggleClass("partialSelected",b)},countChildrenSelected:function(a){var b=0,c=0;this.forEachItem(function(e,d){d&&d.state.parent===a&&(b++,c+=d.state.selected?1:0)});return{total:b,selected:c}},filterItemDidChange:function(a,b){"showArrow"===b?this.element.find(".childCategory[data-parent\x3d"+a+"]").toggleClass("hidden"):("toggle"===b&&this.handleCategoryToggle(a),this.base(a,b),this.only&&($(".partialSelected",
this.element).removeClass("partialSelected"),(a=this.getRenderedFilterOptions()[a])&&a.state.parent&&this.toggleParentCategory(a.state.parent)))},handleCategoryToggle:function(a){var b=this.getRenderedFilterOptions()[a];this.only&&(this.only.setChecked(1),this.only=null);b&&b.state.parent&&this.toggleParentCategory(b.state.parent);b&&!b.state.parent&&(this.only=null,this.toggleChildCategories(a,b.state))},logUserInteraction:function(a,b){if("ga"===this.options.loggingType){a=a.split("/");var c;a[0]&&
(c="reset"===a[0]?"showall":a[0]);var e=this.getRenderedFilterOptions()[a[0]],d=null;e&&(e.state.parent&&(d=this.getRenderedFilterOptions()[e.state.parent]),c=(d?d.state.slug+"-":"")+e.state.slug,a[1]&&"toggle"===a[1]&&(a[1]=e.state.selected?"show":"hide"));a[1]&&(c=(b?"":a[1]+"-")+c+(b?"-"+a[1]:""));f.Analytics.api.trackEvent({category:this.trackCategory,action:this.name,label:c})}else this.base(a,b)}})})(R9);(function(a){a.createComponentClass("activities.results.filters.ActivitiesCategoriesFilterItem","common.results.filters.ValueSetFilterItem",{})})(R9);(function(e){e.createComponentClass("activities.results.filters.ActivitiesDurationFilter","common.results.filters.DurationFilter",{options:{min:void 0,max:void 0,maxValueSlider:!1,step:60,moreString:"",displayFormat:void 0,thousandsDelimiter:",",decimalDelimiter:"."},spaceless:!1,init:function(){this.base();var a=this;this.spaceless=e.config.getBoolean("ui.activities.results.duration.spaceless",!1);this.slider=new e.common.results.filters.RangeFilterSlider(this.getChildElement("slider"),{min:this.options.min,
max:this.options.max,step:this.options.step,displayFormat:this.formatHoursMinutes.bind(a),maxValueSlider:this.options.maxValueSlider,formatValues:function(b){return b.map(a.formatThousands.bind(a))},onStop:function(b,c,d){a.logUserInteraction(null,b,d);d&&a.pushStateChange()}})},formatHoursMinutes:function(a){if("undefined"===typeof a)return a;a=a.replace(/[.,]/g,"");var b=a%60,c=(a-b)%1440,d=c/60,c=(a-b-c)/1440,f=b.toString();10>b&&(f="0"+f);return 0===c&&0===d?replaceArgs("{0}m",f):0===c&&0===b?
this.getDateString(a,null,d):0===d&&0===b?this.getDateString(a,c):0===b?this.getDateString(a,c,d):0===c?replaceArgs("{0}h {1}m",d,f):e.Common.Utils.String.formatChoice("0#{0}d {1}h {2}m|1#{0}d {1}h {2}m|2#{0}d {1}h {2}m",c,c,d,f)},getDateString:function(a,b,c){var d="";a=a>=e.config.getInt("ui.activities.results.duration.limit.max",7200);b&&(d=b+(this.spaceless?"":" ")+e.Common.Utils.String.formatChoice("0#days|1#day|2#days",b));c&&(d+=(""!==d?" ":"")+c+(this.spaceless?"":" ")+e.Common.Utils.String.formatChoice("0#hours|1#hour|2#hours",
c));return a?replaceArgs(this.options.moreString,d):d}})})(R9);(function(a){a.createComponentClass("activities.results.filters.ActivitiesFilterList","common.results.filters.FilterList",{hotelSortDropdown:null,options:{filters:[],closeOnSelection:!1,filtersData:null},init:function(){this.base();if(this.isAjaxRequest()){var b=a.question.ask("resultspage.filterData.get");a.events.publish("resultspage.filtersData.changed",b);this.showFilterList()}},addEventHandlers:function(){this.base();var b=this,c=this.getChildElement("mapViewPortal"),d=this.getChildElement("leftRailAdminDebug"),
e=this.getChildElement("providersdebug");this.subscribe("searchform.submit",function(a){c.prop("href","/"+a.url+";map")});this.subscribe("resultspage.streaming.done",function(c){b.options.admin&&a.ajax.execute("common/results/filters/admin/ProviderDebuggingPanel",{data:{searchId:c.searchId,filterId:e.attr("id")},appendTo:d,replace:!0})})},isAjaxRequest:function(){return this.options.isAjax}})})(R9);(function(a,b){a.createComponentClass("activities.results.ActivitiesAllResultsFiltered",{init:function(){},addEventHandlers:function(){this.getChildElement("filteredOutResetAll").click(function(){a.events.publish("filters.reset")});b("."+this.id("filteredOutReset")).click(function(){var c=b(this).data("filter-name");a.events.publish("filter.reset",{name:c})})}})})(R9,jQuery);(function(a){a.createComponentClass("activities.results.ActivitiesLeftRail","base.results.Rail",{})})(R9);(function(c,d){c.createComponentClass("activities.results.ActivitiesResultItem","base.results.HorizonResult",{detailsComponentUrl:"activities/results/InlineDetailTabs",trackCategory:"results-activities",loggingPrefix:"activities/results/",title:null,rating:null,currentTab:"overview",thumb:null,image:null,options:{toolTipEnabled:!1,noPriceFlag:"",hrpMapLink:null,tripId:null,displayPrice:null,detailsEnabled:!1,description:null,durationFromDisplay:null,durationToDisplay:null,hasUserRating:null,isDurationInterval:null,
isDurationUnknown:null,name:null,providerName:null,providerUrl:null,returnDate:null,reviewCount:null,thumbmobileurl:null,thumburl:null,userRating:null,filterLmLat:null,filterLmLong:null},init:function(){this.base();this.image=this.getChildElement("thumbImage");this.thumb=this.getChildElement("thumb");this.machineTranslated=this.getChildElement("machineTranslated");this.title=this.getChildElement("title").find(".titleContainer");this.rating=this.getChildElement("rating")},addEventHandlers:function(){this.base();
var a=this;this.addMachineTranslatedToolTip();this.getChildElement("book").click(function(b){if(c.utils.presentation.isTablet())return c.events.publish("horizon.mobile.DetailsDialog.show",{searchId:a.options.searchId,resultId:a.options.resultId,name:a.options.name}),!1;c.events.publish("book.providerClicked",{resultId:a.options.resultId});a.trackResultEvent(b)});this.subscribe("activities.inline.detail.loaded",{resultId:a.options.resultId},function(){a.element.removeClass("Preloaded");a.detailsWrapper.height(a.detailsContent.outerHeight())});
this.subscribe("activities.inline.detail.heightChanged",{resultId:a.options.resultId},function(){a.detailsWrapper.height(a.detailsContent.outerHeight())});this.subscribe("horizontal.multibook.showOverflow",{resultId:a.options.resultId},function(){a.detailsWrapper.height(a.detailsContent.outerHeight())});this.element.hover(function(){c.events.publish("activities.result.hover",{resultId:a.options.resultId})});this.getChildElement("showReviews").click(this.handleClick.bind(this,"rating"));this.getChildElement("rating").click(this.handleClick.bind(this,
"rating"));this.getChildElement("title").click(this.handleClick.bind(this,"title"));this.getChildElement("thumb").click(this.handleClick.bind(this,"image"));this.getChildElement("description").click(this.handleClick.bind(this,"description"));this.element.click(this.handleClick.bind(this,"body"));this.subscribe("common.results.updateTripId",function(b){b&&b.hasOwnProperty("tripId")&&b.hasOwnProperty("resultId")&&a.options.resultId===b.resultId&&(a.options.tripId=b.tripId,a.element.find(".removeItemOverlay").remove())});
this.cheapest.click(this.handleClick.bind(this,"price"));this.handleWindowResizeEvent();d(window).resize(this.handleWindowResizeEvent.bind(a))},trackResultEvent:function(a){var b="button";d(a.target).hasClass("provider")?b="provider":d(a.target).hasClass("price")&&(b="price");c.Analytics.api.trackEvent({category:"booking-clicks",action:"booking-click-"+b})},getRatingContent:function(){return"\x3cdiv class\x3d'ratingTitle'\x3e"+this.rating.data("title")+"\x3c/div\x3e\x3cdiv class\x3d'ratingMessage'\x3e"+
this.rating.data("message")+"\x3c/div\x3e"},handleClick:function(a,b){b.stopImmediatePropagation();var e=d(b.target);if(!e.closest(".Common-Trips-ResultItemSaveToTrips").length){"body"!==a||1!==e.closest(".cheapest").length&&1!==e.closest(".selectButton").length||(a="price");if(c.utils.presentation.isTablet()||this.isDetailsEnabled()&&"price"!==a)return b.preventDefault(),c.events.publish("horizon.mobile.DetailsDialog.show",{searchId:this.options.searchId,resultId:this.options.resultId,filterLmLat:this.options.filterLmLat,
filterLmLong:this.options.filterLmLong,name:this.options.name}),this.trackAction(a),!1;this.trackAction(a)}},trackAction:function(a){c.Analytics.api.trackEvent({category:this.trackCategory,action:a})},isDetailsEnabled:function(){return this.options.detailsEnabled},handleWindowResizeEvent:function(){c.utils.presentation.isMobile()?(this.machineTranslated.data("toolTip")&&this.machineTranslated.toolTip("removeWidget").data("toolTip",null),this.thumb.hasClass("mobile")||this.thumb.css("background-image",
"url("+this.options.thumbmobileurl+")").addClass("mobile")):c.utils.presentation.isMobile()||(this.machineTranslated.data("toolTip")||this.addMachineTranslatedToolTip(),this.thumb.hasClass("mobile")&&this.thumb.css("background-image",null).removeClass("mobile"))},addMachineTranslatedToolTip:function(){this.machineTranslated&&this.options.toolTipEnabled&&this.machineTranslated.toolTip({content:this.machineTranslated.data("message"),showImmediately:!1})}})})(R9,jQuery);(function(b){b.createComponentClass("activities.results.ActivitiesResultsListHeader","base.results.ResultsListHeader",{reviewDropdownWidget:null,filterState:null,controls:null,init:function(){this.filterState={};this.controls=this.getChildElement("controls")},addEventHandlers:function(){var a=this;this.base();this.reviewDropdownWidget=this.getChildElement("review").dropdown({change:function(a){if(a)this.onReviewSortChange()}}).getWidget();this.subscribe("resultsHeader.reviewType.set",this.onSortModeChange.bind(this));
this.getChildElement("sort").click(this.onSortClick.bind(this));this.getChildElement("filter").click(this.onFilterClick.bind(this));this.subscribe("resultspage.filtersData.changed",function(){a.controls.removeClass("disabled")});this.subscribe(["search.startSearch","search.searchFailed"],function(){a.controls.addClass("disabled")})},onSortClick:function(){if(this.controls.hasClass("disabled"))return!1;b.events.publish("horizon.mobile.SortDialog.show",{name:"Sort",hasSortByLabel:!0})},onFilterClick:function(){if(this.controls.hasClass("disabled"))return!1;
b.events.publish("horizon.mobile.FiltersDialog.show",{name:"Filters",searchId:this.options.searchId})},onReviewSortChange:function(){var a=this.sortUnrolled.find("a.sortDropdown").attr("data-sort"),c=a.split("_")[0],a="a"===a.split("_")[1];b.events.publish("resultsHeader.changed",{reviewType:this.reviewDropdownWidget.getValue(),sort:{sortType:c,ascending:a}})}})})(window.R9);(function(c,d){c.createComponentClass("activities.results.ActivitiesResultsPage","base.results.ResultsPage",{vertical:"activities",trackCategory:"sort",loggingPrefix:"activitiesresultspage",_options:{showUrgencyBubbles:!0,getInLine:!1},init:function(){this.options=d.extend(this._options,this.options);this.base()},addEventHandlers:function(){this.base();c.events.subscribe("resultItem.saved",d.proxy(this.onItemSaved,this))},destroyOldResults:function(){this.resultsList.find(".Activities-Results-ActivitiesResultItem").each(function(){c.ComponentManager.remove(d(this).attr("id"),
!1)})},onResultsListHeaderChange:function(a){if(!a.rpIgnore){if(void 0!==a.sort){this.options.sortMode=a.sort.sortType;this.options.ascending=a.sort.ascending;var b;switch(a.sort.sortType){case "rank":b="recommended";break;case "userrating":b="rating";break;default:b=a.sort.sortType}c.Analytics.api.trackEvent({category:this.trackCategory,action:b,label:a.sort.ascending?"ascending":"descending"})}else void 0!==a.priceType&&(this.options.priceType=a.priceType,c.Analytics.api.trackEvent({category:this.trackCategory,
action:"priceType",label:a.priceType}));void 0!==a.reviewType&&(this.options.reviewType=a.reviewType,c.Analytics.api.trackEvent({category:this.trackCategory,action:"reviewType",label:a.reviewType}));this.updateFrenchWarning();this.setPageNumber(1);this.resultsReason="resultsHeader.changed";this.refreshResults()}},syncFilterState:function(a){null===a.state?delete this.filterState[a.name]:this.filterState[a.name]=a.state},getFetchResultsOpts:function(){var a=this.base(),b=c.question.ask("activities.search.nearme.coords");
b&&null!==b.lng&&null!==b.lat&&(a.lat=b.lat,a.lng=b.lng);return a},onItemSaved:function(a){this._showToast(a.tripId,a.tripName,a.eventID)},_showToast:function(a,b,d){a=c.template.render("saveToTripToast",{tripName:b,tripId:a,eventId:d});c.Widgets.Toaster.addToast(a,{button:!1,escaped:!0,theme:"centered"})}})})(R9,jQuery);(function(a){a.createComponentClass("activities.results.ActivitiesRightRail","base.results.Rail",{})})(R9);var _slicedToArray=function(){return function(d,e){if(Array.isArray(d))return d;if(Symbol.iterator in Object(d)){var a=[],c=!0,b=!1,g=void 0;try{for(var f=d[Symbol.iterator](),h;!(c=(h=f.next()).done)&&(a.push(h.value),!e||a.length!==e);c=!0);}catch(k){b=!0,g=k}finally{try{if(!c&&f["return"])f["return"]()}finally{if(b)throw g;}}return a}throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();
(function(d,e){d.createComponentClass("activities.results.ActivitiesSortDropdown",{sortDropdownWidget:null,reviewDropdownWidget:null,sortUnrolled:null,options:{sortUnrolled:!1,closeOnSelection:!1},init:function(){},addEventHandlers:function(){var a=this,c=this;this.options.sortUnrolled?(this.sortUnrolled=this.getChildElement("sortUnrolled"),this.sortUnrolled.find("a.sortOption").click(function(){c.onSortModeChange(e(this).attr("data-sort"),e(this))})):this.sortDropdownWidget=this.getChildElement("sorting").dropdown({change:function(b){return b&&
a.onSortModeChange()}}).getWidget();this.reviewDropdownWidget=this.getChildElement("review").dropdown({change:function(b){return b&&a.onReviewSortChange()}}).getWidget();this.subscribe("resultsHeader.changed",function(b){if(null!==a.sortUnrolled&&b.sort){if("userrating"!==b.sort.sortType&&a.sortUnrolled.find("a.sortDropdown").hasClass("selected")){var c=a.sortUnrolled.find("a.sortDropdown select option").first();a.reviewDropdownWidget.setValue(c)}a.sortUnrolled.find("a").removeClass("selected");a.sortUnrolled.find("[data-sort\x3d"+
b.sort.sortType+"_"+(b.sort.ascending?"a":"b")+"]").addClass("selected");a.options.closeOnSelection&&d.events.publish("horizon.mobile.SortDialog.hide")}});this.subscribe("resultsHeader.sortType.set",this.onSortModeChange.bind(this));this.subscribe("resultsHeader.reviewType.set",this.onSortModeChange.bind(this))},onSortModeChange:function(a,c){"undefined"===typeof a&&null!==this.sortDropdownWidget&&(a=this.sortDropdownWidget.getValue());a=a.split("_");var b=_slicedToArray(a,2);a=b[0];b="a"===b[1];
void 0!==c&&(this.options.sortUnrolled&&c.hasClass("selected")&&(b=!b),c.attr("data-sort","%s_%s".format(a,b?"a":"b")));d.events.publish("resultsHeader.changed",{sort:{sortType:a,ascending:b}})},onReviewSortChange:function(){var a=this.sortUnrolled.find("a.sortDropdown").attr("data-sort").split("_"),c=_slicedToArray(a,2),a=c[0],c="a"===c[1];d.events.publish("resultsHeader.changed",{reviewType:this.reviewDropdownWidget.getValue(),sort:{sortType:a,ascending:c}})}})})(window.R9,window.jq||window.jQuery);(function(d,e){d.createComponentClass("activities.search.ActivitiesInlineSearchForm","activities.search.ActivitiesSearchForm",{formQuestion:"activities.rp.searchform",priceDropdownWidget:null,startingForm:null,streamingLabel:null,activityLabel:null,options:{useCmp2Submit:!1,priceTypeEnabled:!1,refactorDropdown:!1,displayViewFormFocus:!1,dayOfWeekEnabled:!1,tempActivityLabel:!1,msg:{nearMeLocText:""}},init:function(){this.options.useHistory=!1;this.base();this.filteredCount=this.getChildElement("filtered");
this.totalCount=this.getChildElement("totalCount");this.totalContainer=this.getChildElement("total");this.startingForm=this.serialize();this.streamingLabel=this.getChildElement("tempActivityLabel");this.activityLabel=this.getChildElement("activityLabel")},addEventHandlers:function(){this.base();var a=this,b=e(document),c=this.getChildElement("counts").find("a.showAll").eq(0),f=function(b){b=e(b.target);!a.element.is(".FormView")||a.options.forceOpen||0!==b.closest(".R9-Overlay").length||b.hasClass("searchButton")||
b.hasClass("selectTextOnFocus")||a.setView("Display")},g=function(){b.off("mousedown",f);setTimeout(function(){b.on("mousedown",f)},50)};if(this.location&&this.location.getWidget()){var h="";this.location.getWidget().setOption("beforeStart",function(){h=a.location.val();b.off("mousedown",f);a.element.off("mousedown",g)});var k=this.location.getWidget().options.afterDone;this.location.getWidget().setOption("afterDone",function(){k.call(this,arguments);setTimeout(function(){b.on("mousedown",f);a.element.on("mousedown",
g)},h!==a.location.val()?200:0);h=a.location.val()})}c.length&&c.click(function(){g()});d.events.subscribe("activities.inline.search.form.show",function(b){a.setView("Form");b&&b.focus&&a.getChildElement("location").focus()});this.getChildElement("display").on("mousedown",function(b){if(0===e(b.target).closest("#"+a.id("counts")+" a.showAll").length&&0===e(b.target).closest("#"+a.id("change")).length){if(a.isResponsive()&&d.utils.presentation.isTablet())return!1;a.setView("Form");a.options.displayViewFormFocus&&
a.focusFormAfterDisplayView(b.target)}});this.getChildElement("display-location").on("mousedown",function(b){if(a.isResponsive()&&d.utils.presentation.isTablet())return!1;a.setView("Form");a.options.displayViewFormFocus?a.focusFormAfterDisplayView(b.target):a.getChildElement("location").focus()});this.getChildElement("change").on("mousedown",function(){a.isResponsive()&&d.utils.presentation.isTablet()?a.handleResponsive():a.setView("Form")});this.subscribe("activities.inline.search.form.setview",
function(b){a.setView(b)});b.on("mousedown",f);this.element.on("mousedown",g);d.events.subscribe(["searchform.submit","inline.update.view"],function(b){a.transferNearMeInfo(b);a.correctForSameDay(b);a.load(b);a.updateDisplayView()});d.question.answer("activities.search.nearme.coords",function(){return{lat:a.options.nearMeLatitude,lng:a.options.nearMeLongitude}});this.options.tempActivityLabel&&(this.subscribe("resultspage.streaming.start",function(){a.activityLabel.addClass("hidden");a.streamingLabel.removeClass("hidden")}),
this.subscribe("resultspage.streaming.done",function(){a.activityLabel.removeClass("hidden");a.streamingLabel.addClass("hidden")}))},bindAdvancedFilter:function(){return!1},setView:function(a){"Display"===a?(this.element.removeClass("FormView"),this.disableSearchButton()):"Form"===a?(this.element.addClass("FormView"),this.enableSearchButton(),d.Analytics.api.trackEvent({category:this.trackCategory,action:"change-search"})):this.element.removeClass("FormView")},handleResponsive:function(){window.location=
"/"+this.product+"/"},updateDisplayView:function(){var a=this.serialize(),b=this.isNearMeActivated()?this.options.msg.nearMeLocText:a.location,a={departDate:a.departDate?moment(a.departDate,this._dateFormat).format(d.common.widgets.DaterangePicker.prototype.options.inlineDisplayFormat):null,returnDate:a.returnDate?moment(a.returnDate,this._dateFormat).format(d.common.widgets.DaterangePicker.prototype.options.inlineDisplayFormat):null,location:b,departLabel:a.departDate?moment(a.departDate,this._dateFormat).format("dddd"):
null,departLabelShort:a.departDate?moment(a.departDate,this._dateFormat).format("ddd"):null,returnLabel:a.returnDate?moment(a.returnDate,this._dateFormat).format("dddd"):null,returnLabelShort:a.returnDate?moment(a.returnDate,this._dateFormat).format("ddd"):null,checkArrow:a.departDate&&a.returnDate?!0:!1},c;for(c in a)a.hasOwnProperty(c)&&(b=e("[data-disp-%s]".format(c),this.element),"checkArrow"!==c&&b.html(a[c]),b[(a[c]&&null!=a[c]?"remove":"add")+"Class"]("hidden"))},focusFormAfterDisplayView:function(a){if(a){a=
e(a);var b=this,c;a.is(this.getChildElement("display-location"))?c=function(){b.location&&b.location.focus&&b.location.trigger&&b.location.focus().trigger("mousedown")}:a.is(this.element.find(".dateStartContainer *"))?c=function(){b.daterangePicker&&b.daterangePicker.startDisplay&&b.daterangePicker.startDisplay.trigger&&b.daterangePicker.startDisplay.trigger("mousedown")}:a.is(this.element.find(".dateEndContainer *"))&&(c=function(){b.daterangePicker&&b.daterangePicker.endDisplay&&b.daterangePicker.endDisplay.trigger&&
b.daterangePicker.endDisplay.trigger("mousedown")});c&&(this.focusSearchFormTID&&clearTimeout(this.focusSearchFormTID),this.focusSearchFormTID=setTimeout(c,200))}},correctForSameDay:function(a){if(a.departDate&&a.returnDate){var b=moment(a.departDate,this._dateFormat),c=moment(a.returnDate,this._dateFormat);0===b.diff(c,"days")&&(a.returnDate=b.add(1,"days").format(this._dateFormat))}},onSubmit:function(a){this.resetNearMeInfo();this.checkFormChanges()?(this.base(a),this.validate()||(this.updateDisplayView(),
this.setView("Display"),this.startingForm=this.serialize())):(d.events.publish("resultsHeader.changed",{tab:"activities"}),this.updateDisplayView(),this.setView("Display"))},checkFormChanges:function(){var a=this.serialize();if(a&&this.startingForm){var b=a.departDate===this.startingForm.departDate,c=a.returnDate===this.startingForm.returnDate;if(a.location===this.startingForm.location&&b&&c)return!1}return!0},handleWindowResizeEvent:function(){this.base();this.setView("Display")},transferNearMeInfo:function(a){this.options.isNearMeNowEnabled&&
(null!=a&&(this.options.nearMeLongitude=a.lng,this.options.nearMeLatitude=a.lat),this.isNearMeActivated()&&this.resetFieldsForNearMe())},resetNearMeInfo:function(){if(this.options.isNearMeNowEnabled&&""!==this.location.val()){var a=this.serialize();this.options.nearMeLatitude=null;this.options.nearMeLongitude=null;null!=a.lat&&(a.lat=null);null!=a.lng&&(a.lng=null)}}})})(R9,jQuery);(function(e,g){function f(a){return null!=a?"string"===typeof a&&""===a.trim():!0}e.createComponentClass("activities.search.ActivitiesSearchForm","base.search.SearchForm",{formQuestion:"activities.fd.searchform",trackCategory:"search-form",options:{responsive:!1,forceOpen:!1,filterTemplateName:null,msg:{location:"",city:"",departDate:"",returnDate:"",nearMeLoading:"",nearMeLink:""},isSingleActivity:!1,loggingPrefix:"",keepLocation:!0,isNearMeNowEnabled:!1,nearMeLatitude:null,nearMeLongitude:null,
smartyType:4,smartyUrl:"/f/smarty",smartyVersion:"v1"},filtersContainerEl:null,amenity:null,ambiance:null,neighbourhoodId:null,neighbourhood:null,location:null,landmarkId:null,cityId:null,activityId:null,freeRegionId:null,regionId:null,countryId:null,clearDates:null,daterangePicker:null,vertical:"activities",_dateFormat:"YYYY-MM-DD",extraFiltersData:{},geocodingAPI:null,lastDepartDate:null,lastReturnDate:null,nearMeClicked:!1,init:function(){this.base();this.bindNearMeElement();this.bindDaterangePicker();
this.bindLocationField();this.clearDates=this.getChildElement("clearDates");this.filtersContainerEl=this.getChildElement("filtersContainer")},addEventHandlers:function(){this.base();var a=this;this.subscribe(["activities.frontdoor.form.location","activities.frontdoor.form.dates","activities.frontdoor.form.all","cmp2.form.fill"],g.proxy(this.onChange,this));this.subscribe(["activities.frontdoor.form.location","activities.frontdoor.form.dates","activities.frontdoor.form.all","cmp2.form.fill"],{id:this.id()},
g.proxy(this.onInternalChange,this));this.subscribe("intentmedia.submit.handler",g.proxy(this.onHookSubmitForIntentMedia,this));this.options.isNearMeNowEnabled&&this.subscribe("activities.frontdoor.form.currentLocation",g.proxy(this.getCurrentLocation,this));this.clearDates.on("click",g.proxy(this.onDatesClear,this));e.question.answer(this.formQuestion,function(){return a.serialize()});this.isResponsive()&&g(window).resize(this.handleWindowResizeEvent.bind(a))},bindLocationField:function(){this.location=
this.getChildElement("location");this.cityId=this.getChildElement("city-id");this.activityId=this.getChildElement("activity-id");this.landmarkId=this.getChildElement("landmark-id");this.regionId=this.getChildElement("regionId");this.freeRegionId=this.getChildElement("freeRegionId");this.countryId=this.getChildElement("countryId");this.isResponsive()?this.handleWindowResizeEvent():this.bindSmartyBox()},bindSmartyBox:function(){var a=this;this.location.activitiesSmarty({flareSmartyType:a.options.smartyType,
dataSource:a.options.smartyUrl,extendRequest:{v:a.options.smartyVersion},minWidth:420,showBackgroundAutocomplete:e.config.getBoolean("ui.common.smarty.background.autocomplete.enabled",!1),clearItem:function(){a.cityId.val("");a.landmarkId.val("");a.activityId.val("");a.neighbourhoodId=null;a.freeRegionId.val("");a.regionId.val("");a.countryId.val("");a.getGeocodingAPI().clear();e.events.publish("activities.frontdoor.form.location",{id:a.id(),location:"",cityId:"",landmarkId:"",activityId:""})},setItem:function(b,
d){var c=d||{};setTimeout(function(){e.Analytics.api.trackEvent({category:a.trackCategory,action:"select-destination",value:c.str});e.events.publish("activities.frontdoor.form.location",{id:a.id(),location:c.str,cityId:c.id||"",landmarkId:c.lmid||"",activityId:c.activityId||"",freeRegionId:c.frid||"",regionId:c.rid||"",countryId:c.cid||"",neighbourhoodId:c.nhid||""})},1)},afterDone:function(){""===a.location.val()&&(a.cityId.val(""),a.landmarkId.val(""),a.activityId.val(""),a.freeRegionId.val(""),
a.regionId.val(""),a.countryId.val(""),e.events.publish("activities.frontdoor.form.location",{id:a.id(),location:"",cityId:"",landmarkId:"",activityId:""}))}})},bindMobileSmartyBox:function(){this.location.off("mousedown.activitiesSearchForm").on("mousedown.activitiesSearchForm",this.onLocationMobileClick.bind(this)).data("MobileSmartyBox",!0)},unbindMobileSmartyBox:function(){this.location.off("mousedown.activitiesSearchForm").removeData("MobileSmartyBox");e.events.publish("activities.mobile.Smarty.hide")},
bindNearMeElement:function(){if(this.options.isNearMeNowEnabled){var a=this;this.nearMeElement=this.getChildElement("nearMe").click(function(){a.nearMeClicked||(e.Analytics.api.trackEvent("activities-near-me-now/link/clicked"),a.adjustNearMeElement(!1),a.getCurrentLocation())})}},bindDaterangePicker:function(){var a=this;this.daterangePicker=this.getChildElement("stayDates").daterangePicker({change:function(){var b=a.serialize(),d="empty",c=void 0;b.hasOwnProperty("departDate")&&b.departDate!==a.lastDepartDate?
(d="from",c=b.departDate):b.hasOwnProperty("returnDate")&&b.returnDate!==a.lastReturnDate&&(d="to",c=b.returnDate);e.Analytics.api.trackEvent({category:a.trackCategory,action:"select-date",label:d,value:c});e.events.publish("activities.frontdoor.form.dates",{id:a.id(),departDate:b.departDate,returnDate:b.returnDate,forceUpdate:!0})},skipForceSetDefaultStartOnFocusBlur:!0,skipForceSetDefaultEndOnFocusBlur:!0,doNotFillWhenEmpty:!0,useDaysFormat:!0,responsive:a.options.responsive}).getWidget()},onHookSubmitForIntentMedia:function(a){a&&
"function"===typeof a.callOnSubmit&&(this.intentMediaCallOnSubmit=a.callOnSubmit)},getGeocodingAPI:function(){this.geocodingAPI||(this.geocodingAPI=new e.common.maps.Geocoding("activities-fd",this._namespace));return this.geocodingAPI},onSubmit:function(a){var b=this,d=b.base;this.isSubmitted||(this.submitIntentMedia(),this.isGeocodingNeeded()?this.getGeocodingAPI().findAddress(this.location.val(),!1,b._namespace+"#onSubmit()").done(function(c){null!==c.location&&b.load({id:b.id(),location:c.location});
d.call(b,a)}).fail(function(){d.call(b,a)}):this.base(a));return!1},onDatesClear:function(){this.daterangePicker.setStartDate(0);this.daterangePicker.setEndDate(0);e.events.publish("activities.frontdoor.form.dates",{id:this.id(),departDate:this.daterangePicker.getStartDate(),returnDate:this.daterangePicker.getEndDate(),forceUpdate:!0})},handleWindowResizeEvent:function(){var a=this.location.getWidget();if(e.utils.presentation.isTablet())a&&"smarty"===a.widgetName&&a.destroy(),this.location.data("MobileSmartyBox")||
this.bindMobileSmartyBox();else if(!a||"smarty"!==a.widgetName||this.location.data("MobileSmartyBox"))this.location.data("MobileSmartyBox")&&this.unbindMobileSmartyBox(),this.bindSmartyBox()},onLocationMobileClick:function(a){a.preventDefault();a.stopImmediatePropagation();e.events.publish("activities.mobile.Smarty.show",{location:this.location.val()})},trackSubmitEvent:function(){var a=this.serialize();e.Analytics.api.trackEvent({category:this.trackCategory,action:"click-search",label:"dest:{destination}; from:{date}; to:{date}",
value:"dest:"+a.location+"; from:"+(a.departDate?a.departDate:"empty")+"; to:"+(a.returnDate?a.returnDate:"empty")})},onChange:function(a){this.shouldUpdate(a)&&(this.load(a),this.saveToStorage())},onInternalChange:function(a){for(var b=["location","departDate","returnDate","refreshCmp2sOnOpen"],d=0;d<b.length;d++)if(a.hasOwnProperty(b[d])){this.loadCompareToItems();break}b=null;a.hasOwnProperty("departDate")&&(a.departDate!==this.lastDepartDate&&(b="departDate"),this.lastDepartDate=a.departDate);
a.hasOwnProperty("returnDate")&&(a.returnDate!==this.lastReturnDate&&(b="returnDate"),this.lastReturnDate=a.returnDate);null!==b&&delete a["returnDate"===b?"departDate":"returnDate"]},executeNearMeSearch:function(){this.resetFieldsForNearMe();e.Analytics.api.trackEvent("activities-near-me-now/search/executed");this.getChildElement("submit").trigger("click")},resetFieldsForNearMe:function(){var a=new Date;this.daterangePicker.setStartDate(a);this.daterangePicker.setEndDate(a);this.location.val("");
this.cityId.val("")},getCurrentLocation:function(){var a=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(b){a.options.nearMeLatitude=b.coords.latitude;a.options.nearMeLongitude=b.coords.longitude;a.adjustNearMeElement(!0);a.executeNearMeSearch()},function(b){e.events.publish("nearMe.error.alert",b.code===b.PERMISSION_DENIED);a.adjustNearMeElement(!0);e.Analytics.api.trackEvent("activities-near-me-now/getLocation/failed")},{enableHighAccuracy:!0,timeout:1E4,maximumAge:0}):
(a.adjustNearMeElement(!0),e.Analytics.api.trackEvent("activities-near-me-now/getLocation/failed"))},serialize:function(){var a=this.base(),b=moment(this.daterangePicker.getStartDate()),d=moment(this.daterangePicker.getEndDate()),c=this.getGeocodingAPI().getLastResult();g.extend(a,{location:this.location.val(),cityId:this.cityId.val(),landmarkId:this.landmarkId.val(),activityId:this.activityId.val(),departDate:b.isValid()?b.format(this._dateFormat):null,returnDate:d.isValid()?d.format(this._dateFormat):
null,freeRegionId:this.freeRegionId.val(),amenity:this.amenity,regionId:this.regionId.val(),countryId:this.countryId.val(),neighbourhoodId:this.neighbourhoodId,neighbourhood:this.neighbourhood,ambiance:this.ambiance,searchType:"C",citycode:this.cityId.val(),page_origin:this.options.pageOrigin,applyFilters:!0,filterState:JSON.stringify(this.advancedFilterState)});this.isNearMeActivated()&&g.extend(a,{lng:this.options.nearMeLongitude,lat:this.options.nearMeLatitude,citycode:"",cityId:"",location:""});
c.isAddress&&g.extend(a,{searchType:"A",address:c.address,addressNickname:c.addressNickname,postalCode:c.postalCode,lat:c.lat,lng:c.lng});this.nearMeSearchExecuted=!1;return a},serializeForCompareTo:function(){var a=this.serialize();delete a.departDate;delete a.returnDate;var b=moment(this.daterangePicker.getStartDate()),d=moment(this.daterangePicker.getEndDate());a.depart_date=b.isValid()?b.format(e.globals.apiDateFormat):null;a.return_date=d.isValid()?d.format(e.globals.apiDateFormat):null;return a},
load:function(a){a.hasOwnProperty("searchDialog")&&a.searchDialog&&this.resetFieldsForSearchDialog();a.location&&this.location.val(a.location);a.cityId&&this.cityId.val(a.cityId);a.landmarkId&&this.landmarkId.val(a.landmarkId);a.activityId&&this.activityId.val(a.activityId);a.freeRegionId&&this.freeRegionId.val(a.freeRegionId);a.regionId&&this.regionId.val(a.regionId);a.countryId&&this.countryId.val(a.countryId);a.neighbourhoodId&&(this.neighbourhoodId=a.neighbourhoodId);a.departDate?this.daterangePicker.setStartDate(moment(a.departDate,
this._dateFormat)):a.forceUpdate&&this.daterangePicker.setStartDate(null);a.returnDate?this.daterangePicker.setEndDate(moment(a.returnDate,this._dateFormat)):a.forceUpdate&&this.daterangePicker.setEndDate(null)},resetFieldsForSearchDialog:function(){this.options.keepLocation||(this.location.val(""),this.cityId.val(""),this.landmarkId.val(""),this.activityId.val(""));this.freeRegionId.val("");this.regionId.val("");this.countryId.val("");this.neighbourhoodId=null},getCookieData:function(){return this.base()},
getStorageProps:function(){return"departDate returnDate location cityId landmarkId activityId searchType".split(" ")},buildSearchURL:function(a){e.storage.remove("activities.results.saveToTrips.tripId");var b=["activities"],d=a.location,c=[],k="-c%s",h=a.address||"";f(h)||(d=h,-1===h.indexOf(a.location)&&(d+=","+a.location),k="-a%s");c.push(e.utils.search.encodeLocation(d));f(a.freeRegionId)?f(a.regionId)?f(a.countryId)?f(a.cityId)||c.push(k.format(a.cityId)):c.push("-u%s".format(a.countryId)):c.push("-r%s".format(a.regionId)):
c.push("-e%s".format(a.freeRegionId));f(a.activityId)?f(a.landmarkId)?f(a.neighbourhoodId)||c.push("-n%s".format(a.neighbourhoodId)):c.push("-l%s".format(a.landmarkId)):c.push("-h%s".format(a.activityId));f(a.amenity)||c.push("-f%s".format(a.amenity));!this.isNearMeActivated()||f(a.lat)||f(a.lng)||(c.push("lat\x3d"+a.lat),c.push("\x26lng\x3d"+a.lng));b.push(c.join(""));f(a.departDate)||b.push(a.departDate);f(a.returnDate)||b.push(a.returnDate);f(a.addressNickname)||b.push("at-%".format(e.utils.search.encodeLocation(a.addressNickname)));
b=b.join("/");d=null;f(a.neighbourhood)?f(a.ambiance)||(d={ambiance:a.ambiance,filterType:"A"}):d=g.extend(d,{neighborhood:a.neighbourhood,filterType:"N"});null!==d&&(b+="?"+g.param(d));return b},validate:function(){if(!this.isNearMeActivated()){if(!this.options.isSingleActivity&&!g.trim(this.cityId.val()))return this.options.msg.city;if(null===this.location.val())return this.options.msg.location}if(null===this.daterangePicker.getEndDate()&&null!==this.daterangePicker.getStartDate())return this.options.msg.returnDate;
if(null!==this.daterangePicker.getEndDate()&&null===this.daterangePicker.getStartDate())return this.options.msg.departDate},isEnoughInformationForCompareToRequest:function(){return void 0===this.validate()},adjustNearMeElement:function(a){a?(this.nearMeClicked=!1,this.nearMeElement.addClass("nearMe"),this.nearMeElement.text(this.options.msg.nearMeLink),this.enableSearchButton()):(this.nearMeClicked=!0,this.nearMeElement.removeClass("nearMe"),this.nearMeElement.text(this.options.msg.nearMeLoading),
this.disableSearchButton())},getCompareToFormData:function(){var a=this.serializeForCompareTo();return g.extend({vertical:this.vertical,show_on:"fd"},a)},isGeocodingNeeded:function(){var a=this.getGeocodingAPI().getLastResult();return f(this.cityId.val())&&!f(this.location.val())&&a.location!==this.location.val()},submitIntentMedia:function(){"function"===typeof this.intentMediaCallOnSubmit&&this.intentMediaCallOnSubmit.call(null,this.serialize())},isResponsive:function(){return this.options.responsive},
isNearMeActivated:function(){return null!=this.options.nearMeLatitude&&null!=this.options.nearMeLongitude},loadFromHistory:function(){}})})(window.R9,window.jQuery);(function(a){a.createComponentClass("activities.search.ActivitiesSearchPage","base.search.SearchPage",{options:{isNearMeEnabled:!1,challengerEnabled:!1},addEventHandlers:function(){var c=this;this.base();this.subscribe("searchform.submit",function(b){c.options.isNearMeEnabled&&"C"===b.searchType&&a.events.publish("common.distanceFilter.renew.disable.options",null!=b.lat&&null!=b.lng)});this.handleWindowResizeEvent();$(window).resize(this.handleWindowResizeEvent.bind(c))},isChallengerEnabled:function(){return this.options.challengerEnabled},
handleWindowResizeEvent:function(){this.isChallengerEnabled()&&(a.utils.presentation.isTablet()&&this.element.hasClass("challenger")?this.element.removeClass("challenger"):a.utils.presentation.isTablet()||this.element.hasClass("challenger")||this.element.addClass("challenger"))}})})(R9);(function(b){b.createComponentClass("activities.search.NearMeErrorDialog",{dialog:null,okButton:null,tryAgainButton:null,cancelButton:null,errorMsgEl:null,options:{tryAgainMsgText:"",okMsgText:""},init:function(){this.dialog=this.getChildElement("dialog").dialog().getWidget();this.okButton=this.getChildElement("ok");this.cancelButton=this.getChildElement("cancel");this.tryAgainButton=this.getChildElement("tryAgain");this.errorMsgEl=this.getChildElement("message")},addEventHandlers:function(){var a=
this;this.subscribe("nearMe.error.alert",this.show.bind(this));this.cancelButton.click(function(){a.hide()});this.okButton.click(function(){a.hide()});this.tryAgainButton.click(function(){a.hide();b.events.publish("activities.frontdoor.form.currentLocation")})},show:function(a){a?(this.okButton.removeClass("hideButton"),this.tryAgainButton.addClass("hideButton"),this.cancelButton.addClass("hideButton"),this.errorMsgEl.text(this.options.okMsgText)):(this.okButton.addClass("hideButton"),this.tryAgainButton.removeClass("hideButton"),
this.cancelButton.removeClass("hideButton"),this.errorMsgEl.text(this.options.tryAgainMsgText));this.dialog.open()},hide:function(){this.dialog.close()}})})(R9);