
var KAMPYLE_REVISION='1.24.0.0';var KAMPYLE_CONSTANT={FORM_HEIGHT:'450',FORM_WIDTH:'450',COOKIE_EXPIRATION:365,DEVICES:{DESKTOP:'desktop',MOBILE:'mobile',TABLET:'tablet',},TIME_FORMATS:{SECONDS:'seconds',MINUTES:'minutes',HOURS:'hours',DAYS:'days',WEEKS:'weeks',MONTHS:'months',YEARS:'years',},DISPLAY_TYPES:{LIGHTBOX:'lightbox',ANIMATION:'animation',}};var KAMPYLE_FUNC=(function(){function init(){var formattedFormData;formattedFormData=kampyleGetData()||{};var customParams;if(formattedFormData.formNodes&&formattedFormData.formNodes.length){for(var i=0;i<formattedFormData.formNodes.length;i++){if(formattedFormData.formNodes[i].customParams){customParams=JSON.parse(formattedFormData.formNodes[i].customParams);formattedFormData.formNodes[i].customParams=customParams;}}}
KAMPYLE_EVENT_DISPATCHER.init();KAMPYLE_DATA.init();subscribeFirstToPageEvents();KAMPYLE_VIEW.init();KAMPYLE_TARGETING.init();KAMPYLE_MESSAGE.init();KAMPYLE_ANIMATION.init();var region=formattedFormData?formattedFormData.region:'dev';formattedFormData=validateFormContract(formattedFormData);KAMPYLE_DATA.setMemoryData('dataJson',formattedFormData);var context=KAMPYLE_UTILS.getUrlParam('nebContext')||'live';KAMPYLE_DATA.setMemoryData('context',context);KAMPYLE_DATA.setMemoryData('region',region);KAMPYLE_DATA.setMemoryData('kampyleDevice',checkDevice());KAMPYLE_DATA.setMemoryData('hostedViewportContent',[]);var browser=KAMPYLE_UTILS.getBrowser();if(KAMPYLE_DATA.getMemoryData('context')!=='preview'&&(browser.name!=='MSIE'||parseInt(browser.version,10)>9)){}
KAMPYLE_LOGGER.init();KAMPYLE_COOLADATA.init();KAMPYLE_SESSIONCAM.init();createSession();subscribeToPageEvents();KAMPYLE_UTILS.setEventHandler(window,'hashchange',handleHashChanged);KAMPYLE_UTILS.triggerCustomEvent('neb_OnsiteLoaded');}
function validateFormContract(formsObj){formsObj.formNodes=formsObj.formNodes||[];var currForm;for(var i=formsObj.formNodes.length-1;i>=0;i--){currForm=formsObj.formNodes[i];if(!currForm.formHeight||currForm.formHeight==='null'){currForm.formHeight=KAMPYLE_CONSTANT.FORM_HEIGHT;}
if(!currForm.formWidth||currForm.formWidth==='null'){currForm.formWidth=KAMPYLE_CONSTANT.FORM_WIDTH;}}
return formsObj;}
function subscribeFirstToPageEvents(){var eventMapping={neb_inviteReady:[sendInviteInitialData],neb_buttonClicked:[loadFormFirst],neb_inviteAccepted:[loadFormFirst],neb_showInvitation:[prepareInviteTriggeringData],};KAMPYLE_EVENT_DISPATCHER.subscribeMany(eventMapping);}
function loadFormFirst(eventName,data){var formState=KAMPYLE_DATA.getFormState(data.formId);if(!formState.loaded&&!formState.loading){KAMPYLE_EVENT_DISPATCHER.trigger('neb_loadForm',{formId:data.formId});}}
function focusOnInviteIframe(){var iframe=document.querySelector('#kampyleInvite');if(iframe&&typeof iframe.focus==='function'){iframe.focus();}}
function triggerInviteReady(eventName,data){data=data||{};if(KAMPYLE_DATA.getFormState(data.formId).inviteLoaded){KAMPYLE_EVENT_DISPATCHER.trigger('neb_inviteReady',data);}}
function subscribeToPageEvents(){var eventMapping={neb_pageView:[increasePageViewCounter],neb_showInvitation:[setInviteState,setFocusedElement,focusOnInviteIframe,triggerInviteReady],neb_buttonClicked:[setFocusedElement,handleShowForm],neb_sdkShowForm:[setFocusedElement,handleShowForm],neb_skipInvitation:[handleShowForm],neb_inviteLoaded:[setInviteState,handleInviteLoaded],neb_inviteAccepted:[setInviteState,handleShowForm],neb_inviteDeclined:[setInviteState,handleInviteDeclined],neb_formClosed:[handleFormClosed],neb_popupBlocked:[handleFormClosed],neb_loadForm:[handleFormLoading],neb_formLoaded:[handleFormLoaded,loadScreenCaptureApi],neb_formReady:[sendFormExtraData,handleVersion],neb_feedbackSubmitted:[handleFeedbackSubmitted],neb_captureImageClicked:[handleTakenScreenCapture],neb_sdkPageView:[startCheckingTargeting],neb_screenCaptureLoaded:[handleScreenCaptureApiLoaded],};KAMPYLE_EVENT_DISPATCHER.subscribeMany(eventMapping);}
function getTriggerTypeByEvent(eventName){var eventTriggerMapping={neb_buttonClicked:'Button',neb_sdkShowForm:'ByCode',neb_skipInvitation:'Invitation',neb_inviteAccepted:'Invitation',};return eventTriggerMapping[eventName]||null;}
function handleShowForm(eventName,data){data=data||{};data.triggerType=data.triggerType||getTriggerTypeByEvent(eventName);KAMPYLE_DATA.saveFormExtraData(data.formId,{triggerType:data.triggerType,});KAMPYLE_DATA.setMemoryData('currentFormId',data.formId);KAMPYLE_DATA.setMemoryData('formIsShown',true);KAMPYLE_DATA.setFormState(data.formId,{shown:true});if(KAMPYLE_FUNC.isFormLoaded(data.formId)){KAMPYLE_EVENT_DISPATCHER.trigger('neb_formReady',{formId:data.formId});}}
function createSession(){var refDomain=document.referrer.match(/:\/\/(.[^/]+)/);if(refDomain!==null){refDomain=refDomain[1];}
var kampyleUserSession=KAMPYLE_DATA.getData('kampyleUserSession');if(!kampyleUserSession||document.referrer===''||refDomain!==window.location.host){var currentTime=new Date();KAMPYLE_DATA.setData('kampyleUserSession',currentTime.getTime());KAMPYLE_DATA.setData('kampyleSessionPageCounter',0);addToSessionCount();KAMPYLE_DATA.deleteData('kampyleUserPercentile');KAMPYLE_DATA.deleteData('kampyleInvitePresented');}}
function kampyleGetData(){var dataJson=KAMPYLE_DATA.getMemoryData('dataJson');if(dataJson){return dataJson;}
return{"provisions":{"legacyNativeSelect":"true","customFormTemplates":"true","dynamicFormSizing":"true","nativeSelect":"true","screenCapture":"true"},"region":"prodUsOregon","websiteId":71154,"accountId":71153,"isSpa":false,"isWCAG":false,"isFormsPreloaded":true,"isGoogleAnalyticsClientGTM":false,"cookieExpirationTime":null,"formNodes":[{"formId":"8316","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/8316/form1482930753932.html","formWidth":"520","formHeight":"450","isFixedSize":"false","functionFileUrl":"","customParams":"[]","formType":"invitation","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"inviteData":{"inviteUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/8316/invitation1485862594103.html","inviteHeight":"400","inviteWidth":"700","skipInvitation":"true","invitationPosition":""},"urlRules":{"exclusionUrl":{"rule":"/en-us/Calendar/Index/1200578;/en-us/Calendar/Index/1275000"},"inclusionUrl":{"rule":"/en-us/HotelPromotion/;/en-us/Calendar/;/en-us/HotelBookings/"}},"onSiteData":{"devicetypes":["desktop","mobile","tablet"],"kampyleTimeOnPage":{"time":"180"},"kampyleInvitePercentageUsers":{"prec":"10.0"},"kampyleTimeInSession":{"time":"300"},"declined":{"days":"30"},"kampyleInvitePerSession":{"inviteOncePerSession":"false"},"submitted":{"days":"30"}}},{"formId":"4736","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4736/form1482930745078.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"urlRules":{"exclusionUrl":{"rule":"/it-it/"},"inclusionUrl":{"rule":"/lt-lt/"}},"onSiteData":{"devicetypes":["desktop","tablet"]}},{"formId":"4467","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4467/form1482930750527.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/uk-ua/"}}},{"formId":"4466","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4466/form1482930754446.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/et-ee/"}}},{"formId":"4465","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4465/form1482930728397.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/hr-hr/"}}},{"formId":"4463","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4463/form1482930721272.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/lv-lv/"}}},{"formId":"4462","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4462/form1482930749335.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":"/lt-lt/"},"inclusionUrl":{"rule":"/it-it/"}}},{"formId":"4461","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4461/form1482930755705.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/he-il/"}}},{"formId":"4460","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4460/form1482930726594.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/sl-si/"}}},{"formId":"4459","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4459/form1482930723440.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/ro-ro/"}}},{"formId":"4458","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4458/form1482930755774.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/bg-bg/"}}},{"formId":"4457","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4457/form1482930745099.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/hi-in/"}}},{"formId":"4456","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4456/form1482930765552.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/hu-hu/"}}},{"formId":"4455","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4455/form1482930744795.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/ca-es/"}}},{"formId":"4454","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4454/form1482930761390.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/tr-tr/"}}},{"formId":"4453","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4453/form1482930747329.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/cs-cz/"}}},{"formId":"4452","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4452/form1482930765816.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/fi-fi/"}}},{"formId":"4451","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4451/form1482930754095.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/da-dk/"}}},{"formId":"4450","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4450/form1482930746657.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/nb-no/"}}},{"formId":"4449","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4449/form1482930760312.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/pl-pl/"}}},{"formId":"4448","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4448/form1482930746093.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/sv-se/"}}},{"formId":"4447","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4447/form1482930776283.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/nl-nl/"}}},{"formId":"4446","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4446/form1482930746824.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/pt-pt/"}}},{"formId":"4445","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4445/form1482930763714.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/ar-ae/"}}},{"formId":"4423","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4423/form1482930744163.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/ru-ru/"}},"onSiteData":{"devicetypes":["desktop","tablet"]}},{"formId":"4419","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4419/form1482930723294.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/el-gr/"}}},{"formId":"4415","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4415/form1482930732612.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/es-es/"}}},{"formId":"4413","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4413/form1482930741375.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/de-de/"}}},{"formId":"4412","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4412/form1482930748012.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"onSiteData":{"devicetypes":["desktop","tablet"]},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/fr-fr/"}}},{"formId":"4411","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4411/form1482930748043.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/zh-tw/"}},"onSiteData":{"devicetypes":["desktop","tablet"]}},{"formId":"4410","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4410/form1482930724364.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/ko-kr/"}},"onSiteData":{"devicetypes":["desktop","tablet"]}},{"formId":"4409","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4409/form1482930746433.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/zh-cn/"}},"onSiteData":{"devicetypes":["desktop","tablet"]}},{"formId":"4408","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4408/form1482930768125.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/zh-hk/"}},"onSiteData":{"devicetypes":["desktop","tablet"]}},{"formId":"4407","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4407/form1482930759840.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/ja-jp/"}},"onSiteData":{"devicetypes":["desktop","tablet"]}},{"formId":"4406","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4406/form1482930755766.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/id-id/"}},"onSiteData":{"devicetypes":["desktop","tablet"]}},{"formId":"4405","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4405/form1482930745524.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/vi-vn/"}},"onSiteData":{"devicetypes":["desktop","tablet"]}},{"formId":"4403","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4403/form1482930750456.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/ms-my/"}},"onSiteData":{"devicetypes":["desktop","tablet"]}},{"formId":"4283","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/4283/form1482930764618.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"urlRules":{"exclusionUrl":{"rule":""},"inclusionUrl":{"rule":"/th-th/"}},"onSiteData":{"devicetypes":["desktop","tablet"]}},{"formId":"3491","isCustomHtmlEnabled":"false","formHtmlUrl":"https://nebula-cdn.kampyle.com/wu/71154/forms/3491/form1482930740723.html","formWidth":"450","formHeight":"520","isFixedSize":"true","functionFileUrl":"","customParams":"[{\"id\":\"199\",\"unique_name\":\"Not IE\",\"type\":\"Text\",\"source\":\"Var\",\"source_name\":\"Explorer\"}]","formType":"button","formDisplay":{"displayType":"lightbox","displayDirection":"centerRight"},"buttonData":{"type":"custom","text":"Feedback","textColor":"#ffffff","backgroundColor":"#5081ff","buttonUrl":"https://nebula-cdn.kampyle.com/wu/71154/resources/image/1464614402627_1x1.png","position":"bottomLeft","cornerMargin":"0.0","verticalOffset":"0.0"},"urlRules":{"exclusionUrl":{"rule":"/ar-ae/;/de-de/;/es-es/;/ja-jp/;/zh-hk/;/zh-cn/;/ko-kr/;/el-gr/;/ru-ru/;/pt-pt/;/nl-nl/;/zh-tw/;/th-th/;/ms-my/;/vi-vn/;/sv-se/;/id-id/;/pl-pl/;/nb-no/;/da-dk/;/fi-fi/;/cs-cz/;/tr-tr/;/ca-es/;/hu-hu/;/hi-in/;/bg-bg/;/ro-ro/;/sl-si/;/he-il/;/fr-fr/;/lv-lv/;/hr-hr/;/et-ee/;/uk-ua/;/it-it/;/lt-lt/"},"inclusionUrl":{"rule":""}},"onSiteData":{"devicetypes":["desktop","tablet"]}}],"integrations":{"recordedSessions":[]}};}
function handleInviteLoaded(eventName,data){data=data||{};var inviteVersion=KAMPYLE_UTILS.getNestedPropertyValue(data,'inviteVersion');KAMPYLE_DATA.setMemoryData('inviteVersion',inviteVersion);var formState=KAMPYLE_DATA.getFormState(data.formId)||{};if(formState.inviteShown){KAMPYLE_EVENT_DISPATCHER.trigger('neb_inviteReady',data);}}
function handleFormLoading(eventName,data){data=data||{};KAMPYLE_DATA.setFormState(data.formId,{loading:true,});}
function sendInviteInitialData(eventName,data){data=data||{};if(!KAMPYLE_DATA.getFormState(data.formId).inviteLoaded){return false;}
KAMPYLE_UTILS.sendMessageToIframe('kampyleInvite',{action:'inviteShown',});var messageData={accountId:data.accountId,websiteId:data.websiteId,environment:data.enviroment,url:document.location.href,kampyle_version:window.KAMPYLE_REVISION||'0.0.0.0',formId:data.formId,cookie_size:KAMPYLE_UTILS.getByteSize(document.cookie),isWCAG:KAMPYLE_DATA.isFeatureEnabled('WCAG'),user_id:KAMPYLE_COOLADATA.getUserId(),deviceType:checkDevice(),provisions:getAllProvisions(),position:KAMPYLE_VIEW.getInvitePosition(data.formId),};KAMPYLE_UTILS.sendMessageToIframe('kampyleInvite',{action:'setExtraData',data:messageData,});}
function setInviteState(eventName,data){data=data||{};switch(eventName){case'neb_showInvitation':KAMPYLE_DATA.setFormState(data.formId,{inviteShown:true,});break;case'neb_inviteDeclined':case'neb_inviteAccepted':KAMPYLE_DATA.setFormState(data.formId,{inviteShown:false,});break;case'neb_inviteLoaded':KAMPYLE_DATA.setFormState(data.formId,{inviteLoaded:true,});break;default:KAMPYLE_UTILS.showWarning('Unhandled event name '+eventName);}}
function updatePreviewIframeStyle(formData){var currentFormId=formData.formId;var formWidth;var formHeight;if(formData){formWidth=parseInt(formData.formWidth,10);formHeight=parseInt(formData.formHeight,10);}
var hostWidth=document.documentElement.clientWidth;var hostHeight=document.documentElement.clientHeight;var innerContainerStyle={overflowY:'auto',height:'100%',};KAMPYLE_UTILS.setElementStyle(document.getElementById('innerContainer'),innerContainerStyle);var iframeStyleObject={border:0,position:'relative',margin:'50px auto 50px',height:formHeight+'px',width:formWidth+'px',};if(hostWidth>formWidth&&hostHeight>formHeight){if(KAMPYLE_DATA.isCustomHtmlForm(currentFormId)){iframeStyleObject={position:'absolute',top:'50%','margin-top':-formHeight/2+'px',left:'50%','margin-left':-formWidth/2+'px',height:formHeight+'px',width:formWidth+'px',};}
else{iframeStyleObject={position:'fixed',height:'100%',width:'100%',};}}
var modal=document.getElementById('kampyleFormModal');if(modal&&modal.style&&modal.removeAttribute){modal.removeAttribute('style');KAMPYLE_UTILS.setElementStyle(modal,iframeStyleObject);}}
function showPreviewForm(){var formHeight=450;var formWidth=450;var formUrl=KAMPYLE_UTILS.getUrlParam('url');var url;if(KAMPYLE_DATA.getMemoryData('kampyleDevice')==='mobile'){formWidth='100%';formHeight='100%';}
else{var height=KAMPYLE_UTILS.getUrlParam('height');var width=KAMPYLE_UTILS.getUrlParam('width');if(!!height&&!isNaN(height)){formHeight=height;}
if(!!width&&!isNaN(width)){formWidth=width;}}
if(!!formUrl&&KAMPYLE_UTILS.validateKampyleDomain(decodeURIComponent(formUrl))){formUrl=decodeURIComponent(formUrl);formUrl+='?region='+KAMPYLE_DATA.getMemoryData('region');var formId=KAMPYLE_UTILS.getUrlParam('formId');if(!!formId){formUrl+='&formId='+formId;KAMPYLE_DATA.setMemoryData('currentFormId',formId);}
else{url=location.protocol+'//'+location.host;window.location=url+'/#/error/404';}
var provisions=decodeURIComponent(window.getUrlParam('provisions'));if(!!provisions){formUrl+='&provisions='+encodeURIComponent(provisions);}
var currentWebsiteId=decodeURIComponent(window.getUrlParam('websiteId'));if(!!currentWebsiteId){formUrl+='&websiteId='+encodeURIComponent(currentWebsiteId);}
var type=KAMPYLE_UTILS.getUrlParam('type')||'direct';var validTypes=['live','direct','preview'];if(validTypes.indexOf(type.toLowerCase())===-1){type='direct';}
formUrl+='&type='+type;var iframeHeight='100%';var iframeWidth='100%';if(KAMPYLE_DATA.isCustomHtmlForm(formId)){iframeHeight=formHeight;iframeWidth=formWidth;}
var iframe=KAMPYLE_UTILS.createIframe(formUrl,iframeWidth,iframeHeight,'kampyleForm'+formId);if(KAMPYLE_DATA.isCustomHtmlForm(formId)){updatePreviewIframeStyle({formId:formId,formHeight:formHeight,formWidth:formWidth,});}
var modal=document.getElementById('kampyleFormModal');if(!!modal){modal.appendChild(iframe);if(iframe.offsetTop<30&&!KAMPYLE_DATA.getMemoryData('kampyleDevice')==='mobile'){modal.style.paddingTop=30-iframe.offsetTop+'px';}}}
else{url=location.protocol+'//'+location.host;window.location=url+'/#/error/404';}}
function startCheckingTargeting(){KAMPYLE_EVENT_DISPATCHER.trigger('neb_pageView');if(KAMPYLE_DATA.getMemoryData('context')==='preview'){showPreviewForm();}
else if(window.KAMPYLE_ONSITE_STATE!=='manual'){KAMPYLE_EVENT_DISPATCHER.trigger('neb_targetingInit');}}
function increasePageViewCounter(){var sessionPageCounter=KAMPYLE_DATA.getData('kampyleSessionPageCounter')||0;sessionPageCounter=parseInt(sessionPageCounter);KAMPYLE_DATA.setData('kampyleSessionPageCounter',++sessionPageCounter);}
function handleFormClosed(eventName,data){data=data||{};if(!data.isFormSubmitted){KAMPYLE_DATA.setData('DECLINED_DATE',Date.now());}
KAMPYLE_DATA.setMemoryData('formIsShown',false);KAMPYLE_DATA.setFormState(data.formId,{shown:false,});refocusActiveElement();KAMPYLE_UTILS.triggerCustomEvent('neb_formClosed',{formId:data.formId});if(KAMPYLE_DATA.getMemoryData('context')==='preview'){window.close();}
var formData=KAMPYLE_DATA.getFormData(KAMPYLE_DATA.getMemoryData('buttonFormId'));var delay=0;if(KAMPYLE_DATA.getDisplayType(formData)==='animation'){delay=1000;}
if(KAMPYLE_DATA.getMemoryData('buttonFormId')){setTimeout(function(){KAMPYLE_EVENT_DISPATCHER.trigger('neb_showButton',{formId:KAMPYLE_DATA.getMemoryData('buttonFormId')});},delay);}}
function handleFeedbackSubmitted(eventMapping,data){KAMPYLE_DATA.setData('SUBMITTED_DATE',Date.now());}
function handleInviteDeclined(eventName,data){KAMPYLE_DATA.setData('DECLINED_DATE',Date.now());refocusActiveElement();}
function handleFormLoaded(eventName,data){KAMPYLE_DATA.setFormState(data.formId,{loading:false,loaded:true,});if(isFormShown(data.formId)){KAMPYLE_EVENT_DISPATCHER.trigger('neb_formReady',{formId:data.formId});}}
function loadScreenCaptureApi(eventName,data){data=data||{};var browser=KAMPYLE_UTILS.getBrowser();var compatibleBrowser=(browser.name!=='MSIE'||(browser.name==='MSIE'&&parseInt(browser.version,10)>8));if(data.isScreenCaptureEnabled!==false&&compatibleBrowser){KAMPYLE_SCREEN_CAPTURE.init(function(){KAMPYLE_EVENT_DISPATCHER.trigger('neb_screenCaptureLoaded',{formId:data.formId});});}}
function handleScreenCaptureApiLoaded(eventName,data){data=data||{};var formData=KAMPYLE_DATA.getFormData(data.formId);var iframePrefix;switch(KAMPYLE_DATA.getDisplayType(formData)){case KAMPYLE_CONSTANT.DISPLAY_TYPES.LIGHTBOX:iframePrefix='kampyleForm';break;case KAMPYLE_CONSTANT.DISPLAY_TYPES.ANIMATION:iframePrefix='kampyleFormAnimation';break;default:iframePrefix='kampyleForm';}
var iframeId=iframePrefix+data.formId;KAMPYLE_UTILS.sendMessageToIframe(iframeId,{action:'screenCaptureLoaded'});}
function setFocusedElement(){KAMPYLE_DATA.setMemoryData('kampyleFocusedElement',document.activeElement);}
function refocusActiveElement(){var focused=KAMPYLE_DATA.getMemoryData('kampyleFocusedElement');if(focused&&focused.focus){focused.focus();}}
function checkProvision(name){var dataObj=kampyleGetData();return!!name&&!!dataObj&&!!dataObj.provisions&&(!!dataObj.provisions[name]||dataObj.provisions[name]==='true');}
function getAllProvisions(){var allProvisions=kampyleGetData().provisions;var provisions={};for(var provision in allProvisions){if(allProvisions.hasOwnProperty(provision)){provisions[provision]=checkProvision(provision);}}
return provisions;}
function checkDevice(){if(!KAMPYLE_DATA.getMemoryData('kampyleDevice'))
{var deviceType=function(agent){return agent.match(/GoogleTV|SmartTV|Internet.TV|NetCast|NETTV|AppleTV|boxee|Kylo|Roku|DLNADOC|CE\-HTML/i)?'desktop':agent.match(/Xbox|PLAYSTATION.3|Wii/i)?'desktop':agent.match(/iPad/i)||agent.match(/tablet/i)&&!agent.match(/RX-34/i)||agent.match(/FOLIO/i)?'tablet':agent.match(/Linux/i)&&agent.match(/Android/i)&&!agent.match(/Fennec|mobi|HTC.Magic|HTCX06HT|Nexus.One|SC-02B|fone.945/i)?'tablet':agent.match(/Kindle/i)||agent.match(/Mac.OS/i)&&agent.match(/Silk/i)?'tablet':agent.match(/GT-P10|SC-01C|SHW-M180S|SGH-T849|SCH-I800|SHW-M180L|SPH-P100|SGH-I987|zt180|HTC(.Flyer|\_Flyer)|Sprint.ATP51|ViewPad7|pandigital(sprnova|nova)|Ideos.S7|Dell.Streak.7|Advent.Vega|A101IT|A70BHT|MID7015|Next2|nook/i)||agent.match(/MB511/i)&&agent.match(/RUTEM/i)?'tablet':agent.match(/BOLT|Fennec|Iris|Maemo|Minimo|Mobi|mowser|NetFront|Novarra|Prism|RX-34|Skyfire|Tear|XV6875|XV6975|Google.Wireless.Transcoder/i)?'mobile':agent.match(/Opera/i)&&agent.match(/Windows.NT.5/i)&&agent.match(/HTC|Xda|Mini|Vario|SAMSUNG\-GT\-i8000|SAMSUNG\-SGH\-i9/i)?'mobile':agent.match(/Windows.(NT|XP|ME|9)/)&&!agent.match(/Phone/i)||agent.match(/Win(9|.9|NT)/i)?'desktop':agent.match(/Macintosh|PowerPC/i)&&!agent.match(/Silk/i)?'desktop':agent.match(/Linux/i)&&agent.match(/X11/i)?'desktop':agent.match(/Solaris|SunOS|BSD/i)?'desktop':agent.match(/Bot|Crawler|Spider|Yahoo|ia_archiver|Covario-IDS|findlinks|DataparkSearch|larbin|Mediapartners-Google|NG-Search|Snappy|Teoma|Jeeves|TinEye/i)&&!agent.match(/Mobile/i)?'desktop':'mobile';};KAMPYLE_DATA.setMemoryData('kampyleDevice',deviceType(navigator.userAgent));}
return KAMPYLE_DATA.getMemoryData('kampyleDevice')||'desktop';}
function isFormShown(formId){var formState=KAMPYLE_DATA.getFormState(formId);return formState&&formState.shown;}
function isFormLoaded(formId){var formState=KAMPYLE_DATA.getFormState(formId);return!!formState&&!!formState.loaded;}
function addScreenCaptureData(messageData){var version=KAMPYLE_DATA.getMemoryData('version');if(version===1){messageData.screenCapture={isTaken:false};}
else{messageData.integrations.screenCapture={isTaken:false};}
return messageData;}
function sendFormExtraData(eventName,data){data=data||{};var formData=KAMPYLE_DATA.getFormData(data.formId);if(!formData||!data.formId){return false;}
var targetWindow;var currIframe;var formDisplayType=KAMPYLE_DATA.getDisplayType(formData);switch(formDisplayType){case'animation':currIframe=document.getElementById('kampyleFormAnimation'+data.formId);break;case'lightbox':currIframe=document.getElementById('kampyleForm'+data.formId);break;case'popup':targetWindow=KAMPYLE_DATA.getMemoryData('popupHandler');break;default:KAMPYLE_UTILS.showWarning('Invalid display type - '+formDisplayType);return false;}
var origin='*';if(currIframe&&currIframe.getAttribute){origin=currIframe.getAttribute('origin')||'*';targetWindow=currIframe.contentWindow;}
if(targetWindow&&targetWindow.postMessage){if(hasCustomParams(data.formId))
{var customParams=formatCustomParams(data.formId);targetWindow.postMessage('{"action": "customParamsLoaded","customParams" : '+JSON.stringify(customParams)+'}',origin);}
var messageData='{"action": "setFormId","formId" : '+data.formId+'}';targetWindow.postMessage(messageData,origin);messageData={action:'setExtraData',};messageData.provisions=getAllProvisions();messageData.integrations=KAMPYLE_INTEGRATION.getIntegrationData();messageData.websiteId=kampyleGetData().websiteId||null;messageData.device=KAMPYLE_DATA.getMemoryData('kampyleDevice');messageData.context=KAMPYLE_DATA.getMemoryData('context');messageData.url=encodeURIComponent(document.location.href);messageData=addScreenCaptureData(messageData);messageData.isScreenCaptureEnabled=KAMPYLE_SCREEN_CAPTURE.isScreenCaptureEnabled(data.formId);messageData.provisions.screenCapture=checkProvision('screenCapture');messageData.displayType=KAMPYLE_DATA.getDisplayType(formData);var pendingExtraData=KAMPYLE_DATA.flushFormExtraData(data.formId);if(pendingExtraData){for(var extra in pendingExtraData){if(pendingExtraData.hasOwnProperty(extra)){messageData[extra]=pendingExtraData[extra];}}}
targetWindow.postMessage(JSON.stringify(messageData),origin);}
KAMPYLE_EVENT_DISPATCHER.trigger('neb_formShown',{formId:data.formId,feedbackUUID:data.uuid,});}
function handleVersion(eventName,data){data=data||{};KAMPYLE_DATA.setMemoryData('NEB_FORM_VERSION',data.formVersion||0);}
function handleTakenScreenCapture(eventName,data){data=data||{};var iframeId='kampyleForm'+data.formId;var formData=KAMPYLE_DATA.getFormData(data.formId);if(KAMPYLE_DATA.getDisplayType(formData)==='animation'){iframeId='kampyleFormAnimation'+data.formId;}
KAMPYLE_UTILS.sendMessageToIframe(iframeId,{action:'takenScreenCapture',data:data});}
function isAnyInviteShown(){var allFormStates=KAMPYLE_DATA.getMemoryData('formsState')||{};for(formId in allFormStates){if(allFormStates.hasOwnProperty(formId)){if(allFormStates[formId].inviteShown){return true;}}}
return false;}
function isAnyFormShown(){var allFormStates=KAMPYLE_DATA.getMemoryData('formsState')||{};for(formId in allFormStates){if(allFormStates.hasOwnProperty(formId)){if(allFormStates[formId].shown){return true;}}}
return false;}
function hasCustomParams(formId){var formData=KAMPYLE_DATA.getFormData(formId);return!!formData&&!!formData.customParams&&!!formData.customParams.length;}
function getSafeCustomParamVal(currParam){currParam=currParam||{};var currParamVal=currParam.value;var currParamSource=currParam.source||'var';var currParamType=currParam.type||''
var currParamName=currParam.name;if(currParamVal===undefined){switch(KAMPYLE_UTILS.safeToLower(currParamSource)){case'var':currParamVal=KAMPYLE_UTILS.getNestedPropertyValue(window,currParamName);break;case'url':currParamVal=KAMPYLE_UTILS.getUrlParam(currParamName);if(currParamVal===''){currParamVal=null;}
break;default:currParamVal=null;break;}}
if(currParamVal!==null){switch(currParamType.toLowerCase()){case'datetime':if(typeof currParamVal==='string')
{currParamVal=parseInt(currParamVal)||null;}
else if(!(currParamVal instanceof Date)&&(!currParamVal.getTime||isNaN(currParamVal.getTime())))
{currParamVal=null;}
else{currParamVal=currParamVal.getTime();}
break;case'number':if(typeof(currParamVal)!=='number'&&isNaN(Number(currParamVal)))
{currParamVal=null;}
else{currParamVal=Number(currParamVal);}
break;case'text':if(typeof(currParamVal)!=='string')
{currParamVal=null;}
break;case'boolean':if(currParamVal==='true')
{currParamVal=true;}
else if(currParamVal==='false')
{currParamVal=false;}
if(typeof(currParamVal)!=='boolean')
{currParamVal=null;}
break;default:currParamVal=null;console.error('Invalid custom parameter type '+currParamType);break;}}
return currParamVal;}
function formatCustomParams(formId){var formData=KAMPYLE_DATA.getFormData(formId)||{};var customParams=formData.customParams||null;var currParamName,currParamType,currParamVal,theForm;customParamsLength=customParams&&customParams.length?customParams.length:0;for(var j=0;j<customParamsLength;j++){customParams[j].value=getSafeCustomParamVal({name:customParams[j].source_name,type:customParams[j].type,source:customParams[j].source,});}
return customParams;}
function isPreloadConfigured(){var data=KAMPYLE_FUNC.kampyleGetData();return(!!data&&data.isFormsPreloaded!=='false'&&data.isFormsPreloaded!==false);}
function addToSessionCount(){var kampyleUserSessionsCount=KAMPYLE_DATA.getData('kampyleUserSessionsCount');kampyleUserSessionsCount=Number(kampyleUserSessionsCount)||0;KAMPYLE_DATA.setData('kampyleUserSessionsCount',++kampyleUserSessionsCount);}
function handleHashChanged(){if(KAMPYLE_DATA.isFeatureEnabled('SPA')){startCheckingTargeting();}}
function kampyleButtonClicked(formData){formData=formData||{};KAMPYLE_EVENT_DISPATCHER.trigger('neb_buttonClicked',{formId:formData.formId,});}
function getTimeInSession(){var sessionStartTimestamp=Number(KAMPYLE_DATA.getData('kampyleUserSession'))||Date.now();return Math.floor(KAMPYLE_UTILS.getTimeDiff(sessionStartTimestamp,KAMPYLE_CONSTANT.TIME_FORMATS.SECONDS));}
function getTimeOnPage(){var timeOnPage=Number(KAMPYLE_DATA.getData('kampylePageLoadedTimestamp'))||Date.now();return Math.floor(KAMPYLE_UTILS.getTimeDiff(timeOnPage,KAMPYLE_CONSTANT.TIME_FORMATS.SECONDS));}
function getLastDeclineSubmit(key){var date=Number(KAMPYLE_DATA.getData(key));return!!date?KAMPYLE_UTILS.getTimeDiff(date,KAMPYLE_CONSTANT.TIME_FORMATS.DAYS):null;}
function prepareInviteTriggeringData(eventName,data){var deviceName=(KAMPYLE_DATA.getMemoryData('kampyleDevice')||KAMPYLE_CONSTANT.DEVICES.DESKTOP).toLowerCase();var formData=KAMPYLE_DATA.getFormData(data.formId);var inviteTriggeringData={desktop:deviceName===KAMPYLE_CONSTANT.DEVICES.DESKTOP,mobile:deviceName===KAMPYLE_CONSTANT.DEVICES.MOBILE,tablet:deviceName===KAMPYLE_CONSTANT.DEVICES.TABLET,abandon:!!KAMPYLE_DATA.getMemoryData('targetingState.abandon'),time_in_session:getTimeInSession(),time_on_page:getTimeOnPage(),excluded_urls:KAMPYLE_UTILS.getNestedPropertyValue(formData,'urlRules.exclusionUrl.rule'),included_urls:KAMPYLE_UTILS.getNestedPropertyValue(formData,'urlRules.inclusionUrl.rule'),number_of_visits:Number(KAMPYLE_DATA.getData('kampyleUserSessionsCount'))||1,last_declined:getLastDeclineSubmit('DECLINED_DATE'),last_feedback:getLastDeclineSubmit('SUBMITTED_DATE'),percentage:KAMPYLE_TARGETING.getUserPercentile(data.formId),};KAMPYLE_DATA.setMemoryData('invitationTriggeringData',inviteTriggeringData);}
return{formatCustomParams:formatCustomParams,increasePageViewCounter:increasePageViewCounter,subscribeToPageEvents:subscribeToPageEvents,createSession:createSession,checkProvision:checkProvision,getAllProvisions:getAllProvisions,addScreenCaptureData:addScreenCaptureData,sendFormExtraData:sendFormExtraData,handleVersion:handleVersion,hasCustomParams:hasCustomParams,showPreviewForm:showPreviewForm,updatePreviewIframeStyle:updatePreviewIframeStyle,validateFormContract:validateFormContract,getTriggerTypeByEvent:getTriggerTypeByEvent,prepareInviteTriggeringData:prepareInviteTriggeringData,loadScreenCaptureApi:loadScreenCaptureApi,handleInviteLoaded:handleInviteLoaded,sendInviteInitialData:sendInviteInitialData,init:init,startCheckingTargeting:startCheckingTargeting,isAnyFormShown:isAnyFormShown,isAnyInviteShown:isAnyInviteShown,getSafeCustomParamVal:getSafeCustomParamVal,isPreloadConfigured:isPreloadConfigured,kampyleGetData:kampyleGetData,isFormLoaded:isFormLoaded,kampyleButtonClicked:kampyleButtonClicked,};})();var KAMPYLE_DATA=(function(){var dataJson;var _memory;var TargetingMapping={abandon:'abandon',percentage:'kampyleInvitePercentageUsers',timeInSession:'kampyleTimeInSession',timeOnPage:'kampyleTimeOnPage',deviceTypes:'devicetypes',pageEvents:'pageElementEvent',};var init=function(){dataJson=KAMPYLE_FUNC.kampyleGetData()||{};_memory={};initFormState();};function getShownFormId(){var allFormStates=KAMPYLE_DATA.getMemoryData('formsState')||{};for(var formId in allFormStates){if(allFormStates.hasOwnProperty(formId)){if(allFormStates[formId].shown){return formId;}}}
return false;}
function initFormState(){var formsState={};var allData=KAMPYLE_FUNC.kampyleGetData()||{};var allForms=allData.formNodes||[];var len=allForms.length;var curr;for(var i=0;i<len;i++){curr=allForms[i];formsState[curr.formId]={loading:false,loaded:false,shown:false,inviteLoaded:false,inviteShown:false,};}
setMemoryData('formsState',formsState);}
function isFeatureEnabled(featureName){var featureToPathMapping={'GTM':'isGoogleAnalyticsClientGTM','WCAG':'isWCAG','SPA':'isSpa',};var path=featureToPathMapping[featureName];return!!path&&!!KAMPYLE_UTILS.getNestedPropertyValue(dataJson,path);}
function getData(dataName){var result;try{result=localStorage[dataName]||KAMPYLE_UTILS.kampyleGetCookie(dataName);}
catch(e){result=KAMPYLE_UTILS.kampyleGetCookie(dataName);}
return result;}
function getMemoryData(dataName){dataName=dataName||'';return KAMPYLE_UTILS.getNestedPropertyValue(_memory,dataName);}
function setMemoryData(dataName,dataValue){KAMPYLE_UTILS.setNestedPropertyValue(_memory,dataName,dataValue);};function setData(dataName,dataValue,expriration){try{localStorage[dataName]=dataValue;}
catch(e){}
KAMPYLE_UTILS.kampyleSetCookie(dataName,dataValue,expriration||getCookieExpiration());return true;}
var deleteData=function(dataName){try{if(localStorage[dataName]!==undefined){delete localStorage[dataName];}}
catch(e){}
KAMPYLE_UTILS.kampyleDeleteCookie(dataName);};function getFormData(formId){var allForms=getAllForms();var len=allForms.length,curr;for(var i=0;i<len;i++){curr=allForms[i];if(parseInt(formId)===parseInt(curr.formId)){return curr;}}
return null;};function getMemory(){return _memory;}
function getFormState(formId){formId=formId||'';return getMemoryData('formsState.'+formId)||null;}
function setFormState(formId,data){data=data||{};var allFormState=getMemoryData('formsState')||{};allFormState[formId]=allFormState[formId]||{};for(var prop in data){allFormState[formId][prop]=data[prop];}
setMemoryData('formsState',allFormState);}
function getAllForms(){var allData=KAMPYLE_FUNC.kampyleGetData()||{};var allForms=allData.formNodes||[];return allForms;}
function getInegrations(){var allData=KAMPYLE_FUNC.kampyleGetData()||{};return allData.integrations||{};}
function getInviteData(formId){var formData=getFormData(formId);return!!formData?formData.inviteData:null;}
function isNewMobileInvitation(){var hasProvision=KAMPYLE_FUNC.checkProvision('mobileInvitationLayout');var kampyleDevice=KAMPYLE_DATA.getMemoryData('kampyleDevice');return!!hasProvision&&kampyleDevice!=='desktop';}
function getDisplayType(formData){var kampyleDevice=KAMPYLE_DATA.getMemoryData('kampyleDevice');if(kampyleDevice!=='desktop'){return'lightbox';}
else{return KAMPYLE_UTILS.getNestedPropertyValue(formData,'formDisplay.displayType')||'lightbox';}}
function saveFormExtraData(formId,extraData){extraData=extraData||{};var oldExtraData=(getFormState(formId)||{}).pendingExtraData||{};extraData=Object.assign(oldExtraData,extraData);setFormState(formId,{pendingExtraData:extraData});}
function flushFormExtraData(formId){var formState=getFormState(formId)||{};var extraData={};if(formState&&formState.pendingExtraData){extraData=formState.pendingExtraData;delete formState.pendingExtraData;}
return extraData;}
function isCustomHtmlForm(formId){var formData=getFormData(formId)||{};var isCustomHtml=KAMPYLE_UTILS.getUrlParam('isCustomHtml');return formData.isCustomHtmlEnabled===true||formData.isCustomHtmlEnabled==='true'||isCustomHtml===true||isCustomHtml==='true';}
function getCookieExpiration(){return KAMPYLE_UTILS.getNestedPropertyValue(dataJson,'cookieExpirationTime')||KAMPYLE_CONSTANT.COOKIE_EXPIRATION;}
function getTargetingData(formId,targetingName){if(!formId||!targetingName||!TargetingMapping[targetingName]){return null;}
var selectedForm=getFormData(formId)||{};var targetingRealName=TargetingMapping[targetingName];return KAMPYLE_UTILS.getNestedPropertyValue(selectedForm,'onSiteData.'+targetingRealName);}
return{init:init,isFeatureEnabled:isFeatureEnabled,getData:getData,setData:setData,deleteData:deleteData,getAllForms:getAllForms,getInegrations:getInegrations,getFormData:getFormData,getMemoryData:getMemoryData,getTargetingData:getTargetingData,setMemoryData:setMemoryData,getShownFormId:getShownFormId,getFormState:getFormState,setFormState:setFormState,getInviteData:getInviteData,getDisplayType:getDisplayType,saveFormExtraData:saveFormExtraData,flushFormExtraData:flushFormExtraData,isCustomHtmlForm:isCustomHtmlForm,getCookieExpiration:getCookieExpiration,isNewMobileInvitation:isNewMobileInvitation,getMemory:getMemory,};})();var KAMPYLE_TARGETING=(function(window,document){function init(){var eventMapping={neb_targetingInit:[initTargeting],neb_initInvitation:[initInvitation],neb_initButton:[handleButton],};KAMPYLE_EVENT_DISPATCHER.subscribeMany(eventMapping);KAMPYLE_DATA.setMemoryData('targetingState',{});}
function isDataValid(days,cookieName){var checkingDate=Number(KAMPYLE_DATA.getData(cookieName));days=Number(days);if(!checkingDate||!days){return false;}
var msInOneDay=1000*60*60*24;return(checkingDate+(msInOneDay*days))>Date.now();}
function handleButton(eventName,data){data=data||{};var formData=KAMPYLE_DATA.getFormData(data.formId);if(!formData){return false;}
if(targetingDevice(formData)===false){return false;}
var kampyleDevice=KAMPYLE_DATA.getMemoryData('kampyleDevice');if(kampyleDevice==='mobile'||kampyleDevice==='tablet'){if(KAMPYLE_FUNC.isPreloadConfigured()){KAMPYLE_EVENT_DISPATCHER.trigger('neb_loadForm',{formId:data.formId});}}
KAMPYLE_DATA.setFormState(data.formId,{loaded:false});KAMPYLE_DATA.setMemoryData('buttonFormId',data.formId);KAMPYLE_EVENT_DISPATCHER.trigger('neb_showButton',{formId:data.formId});KAMPYLE_DATA.setMemoryData('isButtonShown',true);return true;}
function isShowInvite(formData){var currentFormId=KAMPYLE_DATA.getMemoryData('currentFormId');formData=formData||KAMPYLE_DATA.getFormData(currentFormId);if(!formData){return false;}
var targetingState=KAMPYLE_DATA.getMemoryData('targetingState');for(var index in targetingState){if(targetingState[index]!==true){return false;}}
if(isDeclined(formData.onSiteData)===true){return false;}
if(isSubmitted(formData.onSiteData)===true){return false;}
if(KAMPYLE_DATA.getMemoryData('formIsShown')===true){return false;}
if(isInviteShownInSession(formData.onSiteData.kampyleInvitePerSession)===true){return false;}
KAMPYLE_DATA.setData('kampyleInvitePresented',true);var isSkipInvitation=KAMPYLE_UTILS.getNestedPropertyValue(formData,'inviteData.skipInvitation');if(isSkipInvitation===true||isSkipInvitation==='true'){if(!KAMPYLE_FUNC.isPreloadConfigured()){KAMPYLE_EVENT_DISPATCHER.trigger('neb_loadForm',{formId:formData.formId});}
KAMPYLE_EVENT_DISPATCHER.trigger('neb_skipInvitation',{formId:formData.formId});}
else{KAMPYLE_EVENT_DISPATCHER.trigger('neb_showInvitation',{formId:formData.formId});if(KAMPYLE_FUNC.isPreloadConfigured()){KAMPYLE_EVENT_DISPATCHER.trigger('neb_loadForm',{formId:formData.formId});}}
return true;}
function initTargetingObject(){var targetingState=KAMPYLE_DATA.getMemoryData('targetingState');targetingState.kampyleTimeInSession=false;targetingState.kampyleTimeOnPage=false;KAMPYLE_DATA.setMemoryData('targetingState',targetingState);}
function isUrlMatch(urlToMatch){if(!(typeof urlToMatch==='string')){return false;}
urlToMatch=urlToMatch.toLowerCase();var currentUrl=document.location.href.toLowerCase();var matchUrl=currentUrl.substring(0,urlToMatch.length);if(matchUrl===urlToMatch){return true;}
else{currentUrl=currentUrl.replace(/^(?:https?:\/\/)?(?:www\.)?([^\/]+)/i,'');matchUrl=currentUrl.substring(0,urlToMatch.length);if(matchUrl===urlToMatch){return true;}}
return false;}
function isUrlLimits(urlsData){urlsData=urlsData.split(';');var length=urlsData.length;for(var i=0;i<length;i++){var res=isUrlMatch(urlsData[i]);if(res===true){return true;}}
return false;}
function isUrlExcluded(data){if(!!data.urlRules&&!!data.urlRules.exclusionUrl){if(!!data.urlRules.exclusionUrl.rule){var isExcluded=isUrlLimits(data.urlRules.exclusionUrl.rule);return isExcluded;}}
return false;}
function isUrlIncluded(data){if(!!data.urlRules&&!!data.urlRules.inclusionUrl){if(!!data.urlRules.inclusionUrl.rule){var isIncluded=isUrlLimits(data.urlRules.inclusionUrl.rule);return isIncluded;}}
return true;}
function targetingDevice(data){if(data&&data.onSiteData&&data.onSiteData.devicetypes)
{var devicetypesLength=data.onSiteData.devicetypes.length;for(var i=0;i<devicetypesLength;i++){if(data.onSiteData.devicetypes[i]===KAMPYLE_DATA.getMemoryData('kampyleDevice')){return true;}}
return false;}
return true;}
function timeInSession(time){validateGap(time);}
function getTimeInSession(){var kampyleUserSession=KAMPYLE_DATA.getData('kampyleUserSession');var kampyleUserSessionTimestamp=parseInt(kampyleUserSession);var diff=KAMPYLE_UTILS.getTimeDiff(kampyleUserSessionTimestamp);return diff;}
function validateGap(time){var requiredTimeInSession=parseInt(time)*1000;var timeInSession=getTimeInSession();var targetingState=KAMPYLE_DATA.getMemoryData('targetingState');if(targetingState&&timeInSession>=requiredTimeInSession){targetingState.kampyleTimeInSession=true;KAMPYLE_DATA.setMemoryData('targetingState',targetingState);isShowInvite();}
else{var diff=requiredTimeInSession-timeInSession;var thisObj=this;setTimeout(function(){validateGap(time);},diff);}}
function isDeclined(data){data=data||{};if(data.declined!==null&&data.declined!==undefined){var isStillDeclined=isDataValid(data.declined.days,'DECLINED_DATE');return isStillDeclined;}
return false;}
function isInviteShownInSession(oncePerSessionObj){var inviteShownFlag=KAMPYLE_DATA.getData('kampyleInvitePresented');var inviteShownFlag=(inviteShownFlag===true||inviteShownFlag==='true');oncePerSessionObj=oncePerSessionObj||{};var configuredOncePerSession=(oncePerSessionObj.inviteOncePerSession===true||oncePerSessionObj.inviteOncePerSession==='true');if(configuredOncePerSession===true){return false;}
return!!inviteShownFlag;}
function isSubmitted(data){if(data.submitted!==null&&data.submitted!==undefined){var isStillSubmitted=isDataValid(data.submitted.days,'SUBMITTED_DATE');return isStillSubmitted;}
return false;}
function timeOnPage(time){if(time===null){KAMPYLE_DATA.setMemoryData('targetingState.kampyleTimeOnPage',true);return;}
var thisObj=this;var timeOnPageTimeOut=setTimeout(function(){KAMPYLE_DATA.setMemoryData('targetingState.kampyleTimeOnPage',true);isShowInvite();},time*1000);KAMPYLE_DATA.setData('kampylePageLoadedTimestamp',Date.now());}
function getUserPercentile(formId){var percentile=KAMPYLE_DATA.getData('kampyleUserPercentile');if(!percentile&&percentile!=='0')
{percentile=Math.random()*100;KAMPYLE_DATA.setData('kampyleUserPercentile',percentile);}
return Number(percentile);}
function invitePercentageUsers(precUsersObj){var userPercentile=getUserPercentile();if(!!precUsersObj&&!!userPercentile){var prec=Number(precUsersObj.prec);if(userPercentile>prec){return false;}}
return true;}
function initDynamicTargeting(formData){var targetingState=KAMPYLE_DATA.getMemoryData('targetingState');if(formData.onSiteData.kampyleTimeInSession!==undefined){timeInSession(formData.onSiteData.kampyleTimeInSession.time);}
else{targetingState.kampyleTimeInSession=true;}
if(formData.onSiteData.kampyleTimeOnPage!==undefined){timeOnPage(formData.onSiteData.kampyleTimeOnPage.time);}
else{targetingState.kampyleTimeOnPage=true;}
KAMPYLE_DATA.setMemoryData('targetingState',targetingState);for(var key in targetingState){if(targetingState.hasOwnProperty(key)&&!targetingState[key]){return false;}}
isShowInvite(formData);}
function initInvitation(eventName,params){params=params||{};KAMPYLE_DATA.setMemoryData('currentFormId',params.formId);var data=KAMPYLE_DATA.getFormData(params.formId)
if(targetingDevice(data)===false){return false;}
if((!!data.onSiteData.kampyleInvitePercentageUsers&&invitePercentageUsers(data.onSiteData.kampyleInvitePercentageUsers)===false))
{return false;}
if(data.inviteData.skipInvitation===true||data.inviteData.skipInvitation==='true'){if(KAMPYLE_FUNC.isPreloadConfigured()){KAMPYLE_EVENT_DISPATCHER.trigger('neb_loadForm',{formId:params.formId});}}
else{KAMPYLE_EVENT_DISPATCHER.trigger('neb_loadInvitation',{formId:params.formId});}
initDynamicTargeting(data);KAMPYLE_DATA.setMemoryData('isInviteActivated',true);}
function initTargeting(){KAMPYLE_DATA.setMemoryData('invitationTimeStamp',null);KAMPYLE_DATA.setMemoryData('formIsShown',false);var canShow=true;KAMPYLE_DATA.setMemoryData('isButtonShown',false);KAMPYLE_DATA.setMemoryData('isInviteActivated',false);KAMPYLE_DATA.setMemoryData('targetingState',{});var browserObj=KAMPYLE_UTILS.getBrowser();if(!!browserObj&&(browserObj.name.toLowerCase()==='msie'&&parseInt(browserObj.version)<9)){return false;}
initTargetingObject();var allForms=KAMPYLE_DATA.getAllForms();if(!allForms||!allForms.length){return;}
for(var i=allForms.length-1;i>=0;i--){canShow=true;if(canShow===true){if(isUrlExcluded(allForms[i])===true){canShow=false;}}
if(canShow===true){var isIncluded=isUrlIncluded(allForms[i]);if(isIncluded===false){canShow=false;}}
if(canShow===true){if(allForms[i].formType==='button'){if(KAMPYLE_DATA.getMemoryData('isButtonShown')===false){KAMPYLE_EVENT_DISPATCHER.trigger('neb_initButton',{formId:allForms[i].formId});}
else if(KAMPYLE_DATA.getMemoryData('isInviteActivated')===true){return;}}
else if(allForms[i].formType==='invitation'&&KAMPYLE_UTILS.kampyleIsCookieEnabled()){if(KAMPYLE_DATA.getMemoryData('isInviteActivated')===false){KAMPYLE_EVENT_DISPATCHER.trigger('neb_initInvitation',{formId:allForms[i].formId});}
else if(KAMPYLE_DATA.getMemoryData('isButtonShown')===true){return;}}}}}
function setTargetingState(targetingName,isPassed){KAMPYLE_DATA.setMemoryData('targetingState.'+targetingName,isPassed);}
return{init:init,initTargeting:initTargeting,initInvitation:initInvitation,isShowInvite:isShowInvite,handleButton:handleButton,isDataValid:isDataValid,targetingDevice:targetingDevice,getUserPercentile:getUserPercentile,invitePercentageUsers:invitePercentageUsers,validateGap:validateGap,setTargetingState:setTargetingState,isInviteShownInSession:isInviteShownInSession,};})(window,document);var KAMPYLE_ANIMATION=(function(){var DEFAULTS={ANIMATION_DIRECTION:'centerRight',};var CONSTANTS={CONTAINER_ID:'KampyleAnimationContainer',IFRAME_ID:'kampyleFormAnimation',};function init(){var eventMapping={neb_buttonClicked:[animateWithInit],neb_sdkShowForm:[animateWithInit],neb_loadForm:[createFormIframe,initAnimationPosition],neb_inviteAccepted:[animateWithInit],neb_skipInvitation:[animateWithInit],neb_formClosed:[animateOut,refreshFormIframe],neb_popupBlocked:[animateOut,refreshFormIframe],neb_captureInit:[animateOut],neb_captureImageClicked:[animateIn],neb_cancelCaptureClicked:[animateIn],neb_formHide:[animateOut],};KAMPYLE_EVENT_DISPATCHER.subscribeMany(eventMapping);var formSpanPlacer=document.createElement('span');var innerHtml='<div id="{{CONTAINER_ID}}" style="z-index: 2147483000"></div>';innerHtml=innerHtml.replace(/{{CONTAINER_ID}}/g,CONSTANTS.CONTAINER_ID);formSpanPlacer.innerHTML=innerHtml;document.body.appendChild(formSpanPlacer);var animationContainer=document.getElementById(CONSTANTS.CONTAINER_ID);if(animationContainer){KAMPYLE_UTILS.setElementStyle(animationContainer,{border:0,position:'fixed',display:'block',zIndex:'2147483000',});}
hideAnimationContainer();}
function animateWithInit(eventName,data){initAnimationPosition(eventName,data);setTimeout(function(){animateIn(eventName,data);},10);}
function animateIn(eventName,data){data=data||{};var formData=KAMPYLE_DATA.getFormData(data.formId);var animationContainer=document.getElementById(CONSTANTS.CONTAINER_ID);if(!formData||!animationContainer||!isAnimationForm(formData)){return false;}
var formIframe=document.getElementById(CONSTANTS.IFRAME_ID+data.formId);if(formIframe){formIframe.style.display='block';}
var displayDirection=getDisplayDirection(formData);switch(displayDirection){case'centerRight':KAMPYLE_UTILS.setElementStyle(animationContainer,{right:0,});break;case'centerLeft':KAMPYLE_UTILS.setElementStyle(animationContainer,{left:0,});break;case'bottomRight':case'bottomLeft':KAMPYLE_UTILS.setElementStyle(animationContainer,{bottom:0,});break;default:KAMPYLE_UTILS.showWarning('Invalid animation type - '+displayDirection);return false;}}
function hideAnimationContainer(){var animationContainer=document.getElementById(CONSTANTS.CONTAINER_ID);if(animationContainer){KAMPYLE_UTILS.setElementStyle(animationContainer,{width:0,height:0,});}}
function refreshFormIframe(eventName,data){setTimeout(function(){var formData=KAMPYLE_DATA.getFormData(data.formId);var currIframe=document.getElementById(CONSTANTS.IFRAME_ID+data.formId);if(!!currIframe){currIframe.src=currIframe.src;currIframe.style.display='none';if(currIframe.removeAttribute){currIframe.removeAttribute('origin');}}
hideAnimationContainer();},1000);}
function animateOut(eventName,data){var formData=KAMPYLE_DATA.getFormData(data.formId);if(KAMPYLE_DATA.getDisplayType(formData)!=='animation'){return false;}
data=data||{};var animationContainer=document.getElementById(CONSTANTS.CONTAINER_ID);if(!formData||!animationContainer||!isAnimationForm(formData)){return false;}
setAnimationContainerInitialPosition(formData,animationContainer);}
function getMiddleHeight(formHeight){return String((window.innerHeight-parseInt(formHeight,10))/2)+'px';}
function getDisplayDirection(formData){formData=formData||{};return KAMPYLE_UTILS.getNestedPropertyValue(formData,'formDisplay.displayDirection')||DEFAULTS.ANIMATION_DIRECTION;}
function setAnimationContainerInitialPosition(formData,animationContainer){var cornerMargin;switch(getDisplayDirection(formData)){case'centerRight':KAMPYLE_UTILS.setElementStyle(animationContainer,{top:getMiddleHeight(animationContainer.style.height),right:'-'+formData.formWidth+'px',bottom:null,left:null,transition:'right 1s ease-in-out',});break;case'centerLeft':KAMPYLE_UTILS.setElementStyle(animationContainer,{top:getMiddleHeight(animationContainer.style.height),right:null,bottom:null,left:'-'+formData.formWidth+'px',transition:'left 1s ease-in-out',});break;case'bottomRight':cornerMargin=KAMPYLE_VIEW.getCornerMargin(formData)+'px';KAMPYLE_UTILS.setElementStyle(animationContainer,{top:null,right:cornerMargin,bottom:'-'+formData.formHeight+'px',left:null,transition:'bottom 1s ease-in-out',});break;case'bottomLeft':cornerMargin=KAMPYLE_VIEW.getCornerMargin(formData)+'px';KAMPYLE_UTILS.setElementStyle(animationContainer,{top:null,right:null,bottom:'-'+formData.formHeight+'px',left:cornerMargin,transition:'bottom 1s ease-in-out',});break;default:KAMPYLE_UTILS.showWarning('Invalid animation type - '+formData.formDisplayDirection);return false;}}
function isAnimationForm(formData){return KAMPYLE_DATA.getDisplayType(formData)==='animation';}
function createFormIframe(eventName,data){data=data||{};var formData=KAMPYLE_DATA.getFormData(data.formId);var animationContainer=document.getElementById(CONSTANTS.CONTAINER_ID);if(!animationContainer||!formData||!isAnimationForm(formData)){return false;}
var formIframe=document.getElementById(CONSTANTS.IFRAME_ID+data.formId);if(!formIframe){formIframe=document.createElement('iframe');KAMPYLE_UTILS.setElementStyle(formIframe,{border:0,height:formData.formHeight+'px',width:formData.formWidth+'px',display:'none',});formIframe.id=CONSTANTS.IFRAME_ID+data.formId;animationContainer.appendChild(formIframe);}
var formHtml=formData.formHtmlUrl;formHtml=KAMPYLE_UTILS.createFormUrl(formHtml,data.formId);formIframe.src=formHtml;}
function initAnimationPosition(eventName,data){data=data||{};var formData=KAMPYLE_DATA.getFormData(data.formId);var animationContainer=document.getElementById(CONSTANTS.CONTAINER_ID);if(!animationContainer||!formData||!isAnimationForm(formData)){return false;}
if(!document.getElementById(CONSTANTS.IFRAME_ID+data.formId)){createFormIframe(eventName,data);}
KAMPYLE_UTILS.setElementStyle(animationContainer,{height:formData.formHeight+'px',width:formData.formWidth+'px',});setAnimationContainerInitialPosition(formData,animationContainer);}
return{initAnimationPosition:initAnimationPosition,getDisplayDirection:getDisplayDirection,init:init,};})();var KAMPYLE_VIEW=(function(window,document){var DEFAULTS={CORNER_MARGIN:0,TRIANGULAR_MARGIN:0,VERTICAL_MARGIN:30,};function handleInviteReady(eventName,data){data=data||{};var inviteContainer=document.getElementById('kampyleInviteContainer');if(newMobileInvite()){restoreHostingDOM();if(inviteContainer){KAMPYLE_UTILS.setElementStyle(inviteContainer,{top:'',bottom:'',left:'',right:'',background:'none',visibility:'',display:'none',},true);}}
else{KAMPYLE_UTILS.setElementStyle(inviteContainer,{visibility:'visible',},true);var iframe=document.getElementById('kampyleInvite');if(iframe){KAMPYLE_UTILS.setElementStyle(iframe,{visibility:'visible',},true);}}}
function init(){var eventMapping={neb_targetingInit:[removeAllShownElements],neb_loadInvitation:[createInviteIframe],neb_loadForm:[createIframe,showSpinner],neb_formReady:[hideButton],neb_formLoaded:[setIframeOrigin,hideSpinner],neb_showInvitation:[showInvite],neb_inviteHeightChanged:[changeInviteHeight],neb_inviteReady:[handleInviteReady],neb_scrollToForm:[scrollToForm],neb_showButton:[showButton,alignButtonWithForm],neb_buttonClicked:[showForm],neb_sdkShowForm:[showForm,hideButton],neb_captureInit:[hideVisibility,hideButton],neb_inviteAccepted:[hideInvite,showForm,hideButton],neb_skipInvitation:[showForm,hideButton],neb_inviteDeclined:[hideInvite],neb_formClosed:[hideForm],neb_popupBlocked:[hideForm],neb_formHide:[hideVisibility],neb_captureImageClicked:[showVisibility],neb_cancelCaptureClicked:[showVisibility],};eventMapping.neb_showButton.push(setVerticalOffset);KAMPYLE_EVENT_DISPATCHER.subscribeMany(eventMapping);KAMPYLE_UTILS.addStyle('.noOutline{outline: none !important;}');KAMPYLE_UTILS.setEventHandler(window,'resize',function(e){updateIframeStyle();});}
function toggleSpinner(isShow){var display=isShow?'block':'none';var spinners=document.getElementsByClassName('neb-loading-spinner');if(spinners&&spinners.length){for(var i=spinners.length-1;i>=0;i--){KAMPYLE_UTILS.setElementStyle(spinners[i],{display:display});}}}
function hideSpinner(eventName,data){toggleSpinner(false);}
function showSpinner(eventName,data){toggleSpinner(true);}
function scrollToForm(eventName,data){document.getElementById('kampyleFormContainer').scrollIntoView();}
function getCornerMargin(formData){formData=formData||{};var isInvite=KAMPYLE_UTILS.getNestedPropertyValue(formData,'formType')==='invitation';var margin;if(!isInvite){var buttonType=KAMPYLE_UTILS.getNestedPropertyValue(formData,'buttonData.type');switch(buttonType){case'vertical':case'triangular':margin=DEFAULTS.TRIANGULAR_MARGIN;break;case'custom':margin=KAMPYLE_UTILS.getNestedPropertyValue(formData,'buttonData.cornerMargin')||DEFAULTS.CORNER_MARGIN;break;default:margin=DEFAULTS.CORNER_MARGIN;break;}}
else{margin=DEFAULTS.CORNER_MARGIN;}
return parseInt(margin,10);}
function getButtonDirection(formData){formData=formData||{};return KAMPYLE_UTILS.getNestedPropertyValue(formData,'buttonData.position')||'right';}
function alignButtonWithForm(eventName,data){data=data||{};var formData=KAMPYLE_DATA.getFormData(data.formId);var buttonContainer=document.getElementById('nebula_div_btn');if(!buttonContainer||!formData){return false;}
var cornerMargin=getCornerMargin(formData)+'px';switch(getButtonDirection(formData)){case'bottomRight':buttonContainer.style.right=cornerMargin;break;case'bottomLeft':buttonContainer.style.left=cornerMargin;break;default:break;}}
function setVerticalOffset(eventName,data){var formData=KAMPYLE_DATA.getFormData(data.formId);var buttonData=KAMPYLE_UTILS.getNestedPropertyValue(formData,'buttonData');var offset=KAMPYLE_UTILS.getNestedPropertyValue(buttonData,'verticalOffset')||0;if(!isNaN(offset)){var nebButton=document.getElementById('nebula_div_btn');if(nebButton&&nebButton.style){if(buttonData.position.indexOf('bottom')>-1){nebButton.style.marginBottom=offset+'px';}else{offset=Number(offset)*-1;nebButton.style.marginTop=offset+'px';}}}}
function showVisibility(eventName,data){var currentFormId=KAMPYLE_DATA.getMemoryData('currentFormId');var formData=KAMPYLE_DATA.getFormData(currentFormId);if(KAMPYLE_DATA.getDisplayType(formData)==='animation'){return false;}
var formContainer=document.getElementById('kampyleFormContainer');var formIframe=document.getElementById('kampyleForm'+currentFormId);if(!!formContainer&&!!formIframe)
{KAMPYLE_UTILS.setElementStyle(formContainer,{display:'block',visibility:'visible',},true);}}
function getWCAGClass(){var noOutlineClass=' noOutline ';if(KAMPYLE_DATA.isFeatureEnabled('WCAG')){noOutlineClass=' ';}
return noOutlineClass;}
function hideVisibility(){var currentFormId=KAMPYLE_DATA.getMemoryData('currentFormId');if(!currentFormId){return;}
var formContainer=document.getElementById('kampyleFormContainer');var formIframe=document.getElementById('kampyleForm'+currentFormId);if(!!formContainer&&!!formIframe)
{KAMPYLE_UTILS.setElementStyle(formContainer,{display:'none',visibility:'hidden',},true);}}
function hideForm(eventName,data){data=data||{};var currentFormId=KAMPYLE_DATA.getMemoryData('currentFormId');setMetaViewport('remove');if(document.getElementById('kampyleFormContainer')!==null){var currIframe=document.getElementById('kampyleForm'+currentFormId);if(!!currIframe){currIframe.src=currIframe.src;KAMPYLE_UTILS.setElementStyle(currIframe,{display:'none',},true);if(currIframe.removeAttribute){currIframe.removeAttribute('origin');}}
hideVisibility();restoreHostingDOM();}
if(data.sourceWindow&&data.sourceWindow.close){data.sourceWindow.close();}}
function formatTriangularStyle(data){data=data||{};var triangularStyle=['.kampyle_feedback-button{','font-family:"Open Sans",sans-serif;cursor:pointer;position:fixed;z-index:99999990','}','.kampyle_feedback-button .kampyle_triangle{position:absolute;width:0;height:0;z-index:-1}','.kampyle_feedback-button .kampyle_button-text{ ','height:81px;width:81px;text-align:center;z-index:1000;color:{{BUTTON_TEXT_COLOR}};font-size:14px;','}','.kampyle_feedback-button .kampyle_bottom{','line-height:105px;','}','.kampyle_feedback-button .kampyle_top {','line-height:60px;','}','.kampyle_feedback-button.kampyle_top-right{ ','top:0;right:0','}','.kampyle_feedback-button.kampyle_top-right .kampyle_triangle {','top:0;right:0;border-top:81px solid {{BUTTON_BACKGROUND_COLOR}};border-left:81px solid transparent ','}','.kampyle_feedback-button.kampyle_top-right .kampyle_button-text { ','-ms-transform:rotate(45deg); -webkit-transform:rotate(45deg); transform:rotate(45deg)','}','.kampyle_feedback-button.kampyle_top-left {','top:0;left:0;','}','.kampyle_feedback-button.kampyle_top-left .kampyle_triangle {','top:0;left:0;border-top:81px solid {{BUTTON_BACKGROUND_COLOR}};border-right:81px solid transparent;','}','.kampyle_feedback-button.kampyle_top-left .kampyle_button-text {','-ms-transform:rotate(-45deg);-webkit-transform:rotate(-45deg);transform:rotate(-45deg)','}','.kampyle_feedback-button.kampyle_bottom-right {','bottom:0;right:0;','}','.kampyle_feedback-button.kampyle_bottom-right .kampyle_triangle {','bottom:0;right:0;border-bottom:81px solid {{BUTTON_BACKGROUND_COLOR}};border-left:81px solid transparent','}','.kampyle_feedback-button.kampyle_bottom-right .kampyle_button-text {','-ms-transform:rotate(-45deg);-webkit-transform:rotate(-45deg);transform:rotate(-45deg);','}','.kampyle_feedback-button.kampyle_bottom-left {','bottom:0;left:0;','}','.kampyle_feedback-button.kampyle_bottom-left .kampyle_triangle {','bottom:0;left:0;border-bottom:81px solid {{BUTTON_BACKGROUND_COLOR}};border-right:81px solid transparent','}','.kampyle_feedback-button.kampyle_bottom-left .kampyle_button-text {','-ms-transform:rotate(45deg);-webkit-transform:rotate(45deg);transform:rotate(45deg);','}',].join(' ');triangularStyle=triangularStyle.replace(/{{BUTTON_TEXT_COLOR}}/g,data.textColor);triangularStyle=triangularStyle.replace(/{{BUTTON_BACKGROUND_COLOR}}/g,data.backgroundColor);return triangularStyle;}
function formatVerticalStyle(data){data=data||{};var verticalStyle=['.kampyle_vertical_button {','font-family:"Open Sans",sans-serif;cursor:pointer;position:fixed;top:45%;z-index:99999990;height:35px;width:125px;-ms-transform:rotate(90deg);-webkit-transform:rotate(90deg);transform:rotate(90deg)','}','.kampyle_vertical_button .kampyle_button {','height:35px;width:125px;background:{{BUTTON_BACKGROUND_COLOR}};color:{{BUTTON_TEXT_COLOR}};position:absolute;top:0;left:0;z-index:-1;','}','.kampyle_vertical_button .kampyle_button-text {','color:{{BUTTON_TEXT_COLOR}};font-size:14px;line-height:35px;text-align:center;','}','.kampyle_vertical_button.kampyle_left .kampyle_button {','-webkit-border-radius:3px 3px 0 0;-moz-border-radius:3px 3px 0 0;-ms-border-radius:3px 3px 0 0;border-radius:3px 3px 0 0;','}','.kampyle_vertical_button.kampyle_right {','right:-45px;','}','.kampyle_vertical_button.kampyle_left {','left:-45px','}','.kampyle_vertical_button.kampyle_right .kampyle_button {','-webkit-border-radius:0 0 3px 3px;-moz-border-radius:0 0 3px 3px;-ms-border-radius:0 0 3px 3px;border-radius:0 0 3px 3px','}',].join(' ');verticalStyle=verticalStyle.replace(/{{BUTTON_TEXT_COLOR}}/g,data.textColor);verticalStyle=verticalStyle.replace(/{{BUTTON_BACKGROUND_COLOR}}/g,data.backgroundColor);return verticalStyle;}
function getTriangleButtonStyle(formData){var html='';var classDirection={topbottom:'kampyle_bottom',leftright:'kampyle_bottom-left'};switch(formData.buttonData.position){case'bottomLeft':classDirection.leftright='kampyle_bottom-left';classDirection.topbottom='kampyle_bottom';break;case'bottomRight':classDirection.leftright='kampyle_bottom-right';classDirection.topbottom='kampyle_bottom';break;case'topLeft':classDirection.leftright='kampyle_top-left';classDirection.topbottom='kampyle_top';break;case'topRight':classDirection.leftright='kampyle_top-right';classDirection.topbottom='kampyle_top';break;default:break;}
html='<div id="nebula_div_btn" alt="'+formData.buttonData.text+'" tabindex="0" class="kampyle_feedback-button '+classDirection.leftright+" "+getWCAGClass()+'"><div class="kampyle_triangle"></div><div class="kampyle_button-text '+classDirection.topbottom+'">'+formData.buttonData.text+'</div></div>';return html;}
function getVerticalButtonStyle(formData){var html='';var direction='kampyle_left'
switch(formData.buttonData.position){case"left":direction='kampyle_left';break;case"right":direction='kampyle_right';break;}
html='<div id="nebula_div_btn" style="position: fixed !important;" alt="'+formData.buttonData.text+'" tabindex="0" class="kampyle_vertical_button '+direction+" "+getWCAGClass()+'"><div class="kampyle_button"></div><div class="kampyle_button-text">'+formData.buttonData.text+'</div></div>';return html;}
function displayGenericFormBtn(formData){var html='';var style;switch(formData.buttonData.type){case'vertical':style=formatVerticalStyle({textColor:formData.buttonData.textColor,backgroundColor:formData.buttonData.backgroundColor,});KAMPYLE_UTILS.addStyle(style);html=getVerticalButtonStyle(formData);break;case'triangular':style=formatTriangularStyle({textColor:formData.buttonData.textColor,backgroundColor:formData.buttonData.backgroundColor,});KAMPYLE_UTILS.addStyle(style);html=getTriangleButtonStyle(formData);break;default:KAMPYLE_UTILS.showWarning('Invalid button type '+formData.buttonData.type);break;}
return html;}
function displayImageFormBtn(formData){var divStyle="z-index: 99999990 !important;position: fixed !important;cursor: pointer !important;line-height:1px !important;";switch(formData.buttonData.position){case'bottomLeft':divStyle+='bottom:0;left:0;';break;case'bottomRight':divStyle+='bottom:0;right:0;';break;case'topLeft':divStyle+='top:0;left:0;';break;case'topRight':divStyle+='top:0;right:0;';break;case'left':divStyle+='left:0;top:50%;';break;case'right':divStyle+='right:0;top:50%;';break;}
return'<div id="nebula_div_btn" class="'+getWCAGClass()+'" style="'+divStyle+'" tabindex="0"><img alt="'+formData.buttonData.text+'" src="'+formData.buttonData.buttonUrl+'" /></div>';}
function showButton(eventName,data){var btnHtml='';data=data||{};var formData=KAMPYLE_DATA.getFormData(data.formId)||{};var buttonType=KAMPYLE_UTILS.getNestedPropertyValue(formData,'buttonData.type')||'';switch(buttonType.toLowerCase()){case'vertical':case'triangular':btnHtml=displayGenericFormBtn(formData);break;case'custom':btnHtml=displayImageFormBtn(formData);break;default:KAMPYLE_UTILS.showWarning('Invalid button type - '+buttonType);return false;}
var spanContainer=document.getElementById('kampyleButtonContainer')
if(spanContainer===null){spanContainer=document.createElement('span');spanContainer.innerHTML=btnHtml;spanContainer.id="kampyleButtonContainer";var s=document.body.appendChild(spanContainer);}
else{spanContainer.innerHTML=btnHtml;}
spanContainer.onclick=function(event){KAMPYLE_EVENT_DISPATCHER.trigger('neb_buttonClicked',{formId:data.formId});event.preventDefault();event.stopPropagation();};spanContainer.onmouseover=function(event){if(!KAMPYLE_DATA.getFormState(data.formId).loaded){KAMPYLE_EVENT_DISPATCHER.trigger('neb_loadForm',{formId:data.formId});}};if(KAMPYLE_DATA.getMemoryData('kampyleDevice')==='desktop'){document.body.onmousemove=function(event){var formState=KAMPYLE_DATA.getFormState(data.formId);if(!formState||formState.loading||formState.loaded){return false;}
var isNear=KAMPYLE_UTILS.isNear('nebula_div_btn',100,event);if(isNear){KAMPYLE_EVENT_DISPATCHER.trigger('neb_loadForm',{formId:data.formId});}}}
else{KAMPYLE_EVENT_DISPATCHER.trigger('neb_loadForm',{formId:data.formId});}
spanContainer.onkeyup=function(event){switch(event.keyCode){case 9:KAMPYLE_EVENT_DISPATCHER.trigger('neb_loadForm',{formId:data.formId});break;}};spanContainer.onkeypress=function(event){switch(event.keyCode){case 13:KAMPYLE_EVENT_DISPATCHER.trigger('neb_buttonClicked',{formId:data.formId});break;}};}
function setIframeOrigin(eventName,data){var formIframe=document.getElementById('kampyleForm'+data.formId);if(formIframe&&formIframe.setAttribute){formIframe.setAttribute("origin",data.origin);}}
function updateIframeStyle(formData){var currentFormId=KAMPYLE_DATA.getMemoryData('currentFormId')||KAMPYLE_DATA.getShownFormId();if(document.getElementById('kampyleFormContainer')===null||!currentFormId){return;}
formData=formData||KAMPYLE_DATA.getFormData(currentFormId);var formWidth;var formHeight;if(formData){formWidth=parseInt(formData.formWidth,10)||450;formHeight=parseInt(formData.formHeight,10)||450;}
var hostHeight=document.documentElement.clientHeight;var innerContainerStyle={overflowY:'auto',height:'100%',};KAMPYLE_UTILS.setElementStyle(document.getElementById('innerContainer'),innerContainerStyle);var iframeStyleObject={border:0,position:'relative',margin:'50px auto 50px',height:formHeight+'px',width:formWidth+'px',};var kampyleDevice=KAMPYLE_DATA.getMemoryData('kampyleDevice');if(kampyleDevice==='mobile'||kampyleDevice==='tablet'){formHeight='100%';formWidth='100%';iframeStyleObject={position:'relative',margin:'0',height:formHeight,width:formWidth,};}
else if(KAMPYLE_DATA.isCustomHtmlForm(currentFormId)){iframeStyleObject={position:'absolute',top:'50%','margin-top':-formHeight/2+'px',left:'50%','margin-left':-formWidth/2+'px',height:formHeight+'px',width:formWidth+'px',};if(hostHeight<formHeight){iframeStyleObject.position='relative';iframeStyleObject.top='0';iframeStyleObject['margin-top']='50px';iframeStyleObject['margin-bottom']='50px';}}
else{iframeStyleObject={position:'fixed',height:'100%',width:'100%',};}
var modal=document.getElementById('kampyleFormModal');if(modal&&modal.style&&modal.removeAttribute){modal.removeAttribute('style');KAMPYLE_UTILS.setElementStyle(modal,iframeStyleObject,true);}}
function openPopup(formUrl,formId,formWidth,formHeight,eventName){formUrl=KAMPYLE_UTILS.createFormUrl(formUrl,formId);var popupHandler=window.open(formUrl,'NebulaCX'+formId,'width='+formWidth+', height='+formHeight+',scrollbars=yes');KAMPYLE_DATA.setMemoryData('popupHandler',popupHandler);setTimeout(function(){if(!popupHandler||popupHandler.outerHeight===0){if(eventName!=='neb_skipInvitation'){alert('Can\'t open pop-up, please disable pop-up blocker and try again.');}
KAMPYLE_EVENT_DISPATCHER.trigger('neb_popupBlocked',{formId:formId,});}},25);}
function showForm(eventName,data){data=data||{};var formData=KAMPYLE_DATA.getFormData(data.formId);if(!formData||KAMPYLE_DATA.getDisplayType(formData)==='animation'){return false;}
var formUrl=formData.formHtmlUrl;var formWidth=formData.formWidth;var formHeight=formData.formHeight;var displayType=KAMPYLE_DATA.getDisplayType(formData);displayType=displayType.toLowerCase();setMetaViewport('add');KAMPYLE_DATA.setMemoryData('currentFormId',data.formId);KAMPYLE_DATA.setMemoryData('formIsShown',true);var kampyleDevice=KAMPYLE_DATA.getMemoryData('kampyleDevice');if(displayType==='lightbox'||kampyleDevice==='tablet'||kampyleDevice==='mobile'){prepareHostingDOM();var kampyleFormContainer=document.getElementById('kampyleFormContainer');if(kampyleFormContainer){updateIframeStyle(formData);var currIframe=document.getElementById('kampyleForm'+data.formId);if(!!currIframe){KAMPYLE_UTILS.setElementStyle(currIframe,{display:'block',},true);}
KAMPYLE_UTILS.setElementStyle(kampyleFormContainer,{display:'block',visibility:'visible',},true);}
else{KAMPYLE_UTILS.showWarning("formContainer wasn't loaded properly");}}
else if(displayType==='popup'){openPopup(formUrl,data.formId,formWidth,formHeight,eventName);}
return true;}
function hideInvite(){setMetaViewport('remove');var inviteContainer=document.getElementById('kampyleInviteContainer');var kampyleInvite=document.getElementById('kampyleInvite');if(inviteContainer&&kampyleInvite){KAMPYLE_UTILS.setElementStyle(inviteContainer,{display:'none',},true);restoreHostingDOM();}}
function changeInviteHeight(eventName,data){const positions=['top','bottom'];if(!newMobileInvite()){return;}
var pos=KAMPYLE_VIEW.getInvitePosition(data.formId);var inviteContainer=document.getElementById('kampyleInviteContainer');var inviteIframe=document.getElementById('kampyleInvite');KAMPYLE_UTILS.setElementStyle(inviteIframe,{visibility:'visible',},true);var style={display:'block',height:data.newHeight+'px',left:'0',right:'0',};style[pos]=0;style[positions[(positions.indexOf(pos)+1)%2]]='';KAMPYLE_UTILS.setElementStyle(inviteContainer,style,true);}
function setMetaViewport(optional){optional=optional||'';if(KAMPYLE_DATA.getMemoryData('kampyleDevice')==='desktop'){return;}
var kampyleMeta=document.getElementById('kampyleMetaViewport');var hostedViewportContent=document.getElementsByName('viewport');var savedViewportContent=KAMPYLE_DATA.getMemoryData('hostedViewportContent')||[];if(hostedViewportContent&&hostedViewportContent.length&&!savedViewportContent.length){for(var i=hostedViewportContent.length-1;i>=0;i--){if(hostedViewportContent[i].hasAttribute('content')){savedViewportContent.push(hostedViewportContent[i]);}}}
switch(optional.toLowerCase()){case"add":if(savedViewportContent&&savedViewportContent.length){for(var i=savedViewportContent.length-1;i>=0;i--){if(savedViewportContent[i].hasAttribute("id")&&savedViewportContent[i].id==="kampyleMetaViewport"){continue;}
else{if(savedViewportContent[i].remove){savedViewportContent[i].remove();}}};}
if(!kampyleMeta){var meta=document.createElement('meta');meta.content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';meta.name='viewport';meta.id='kampyleMetaViewport';document.getElementsByTagName('head')[0].appendChild(meta);}else{kampyleMeta.content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';kampyleMeta.name='viewport';}
break;case"remove":if(kampyleMeta){kampyleMeta.content="";kampyleMeta.name="";if(kampyleMeta.remove){kampyleMeta.remove();}}
if(savedViewportContent&&savedViewportContent.length){for(var i=savedViewportContent.length-1;i>=0;i--){if(savedViewportContent[i].hasAttribute("id")&&savedViewportContent[i].id==="kampyleMetaViewport"){continue;}
else{document.getElementsByTagName('head')[0].appendChild(savedViewportContent[i]);}}}
break;}
KAMPYLE_DATA.setMemoryData('hostedViewportContent',savedViewportContent);}
function newMobileInvite(){return(Number(KAMPYLE_DATA.getMemoryData('inviteVersion'))>0)&&KAMPYLE_DATA.isNewMobileInvitation();}
function getInvitePosition(formId){var formData=(KAMPYLE_DATA.getFormData(formId)||{});return(formData.inviteData||{}).invitationPosition||'top';}
function showInvite(eventName,data){if(!KAMPYLE_FUNC.isPreloadConfigured()){KAMPYLE_EVENT_DISPATCHER.trigger('neb_loadForm',{formId:data.formId});}
setMetaViewport('add');var inviteTop='25%';var inviteData=KAMPYLE_DATA.getInviteData(data.formId);if(!inviteData){return false;}
var kampyleDevice=KAMPYLE_DATA.getMemoryData('kampyleDevice');if(kampyleDevice==='mobile'||kampyleDevice==='tablet'){inviteData.inviteHeight='100%';inviteData.inviteWidth='100%';inviteTop=0;}
var invitationTimeStamp=new Date().getTime();KAMPYLE_DATA.setMemoryData('invitationTimeStamp',invitationTimeStamp);KAMPYLE_DATA.setData('LAST_INVITATION_VIEW',invitationTimeStamp);var inviteContainer=document.getElementById('kampyleInviteContainer');if(inviteContainer&&KAMPYLE_DATA.getMemoryData('formIsShown')===false){KAMPYLE_UTILS.setElementStyle(inviteContainer,{display:'block',visibility:KAMPYLE_DATA.isNewMobileInvitation()?'hidden':'visible',},true);prepareHostingDOM();var inviteModal=document.getElementById('kampyleInviteModal');if(inviteModal){KAMPYLE_UTILS.setElementStyle(inviteModal,{top:inviteTop,width:inviteData.inviteWidth+'px','max-width':inviteData.inviteWidth+'px',height:inviteData.inviteHeight+'px','max-height':inviteData.inviteHeight+'px',display:'block',},true);}
var inviteIframe=document.getElementById('kampyleInvite');if(inviteIframe){KAMPYLE_UTILS.setElementStyle(inviteIframe,{width:inviteData.inviteWidth+'px','max-width':inviteData.inviteWidth+'px',height:inviteData.inviteHeight+'px','max-height':inviteData.inviteHeight+'px',display:'block',visibility:KAMPYLE_DATA.isNewMobileInvitation()?'hidden':'visible',},true);}}}
function prepareHostingDOM(){var kampyleDevice=KAMPYLE_DATA.getMemoryData('kampyleDevice');KAMPYLE_DATA.setMemoryData('hostedBodyOverflowAttr',document.body.style.overflow);KAMPYLE_DATA.setMemoryData('hostedBodyPositionAttr',document.body.style.position);document.body.style.overflow='hidden';}
function restoreHostingDOM(){document.body.style.overflow=KAMPYLE_DATA.getMemoryData('hostedBodyOverflowAttr')||'';document.body.style.position=KAMPYLE_DATA.getMemoryData('hostedBodyPositionAttr')||'';}
function createIframe(eventName,data){data=data||{};var formState=KAMPYLE_DATA.getFormState(data.formId);if(formState&&formState.loaded){return;}
var formData=KAMPYLE_DATA.getFormData(data.formId);var displayType=KAMPYLE_DATA.getDisplayType(formData);if(!formData||!data.formId||displayType!=='lightbox'){return;}
if(!document.getElementById('kampyleFormContainer')){var formSpanPlacer=document.createElement('span');var html='';html+='<div id="kampyleFormContainer" style="top:0 !important;left:0 !important;width: 100% !important;height: 100% !important;position: fixed !important;visibility:hidden !important;display:table !important;background-color: rgba(102,102,102,0.4) !important;z-index:99999999 !important;-webkit-overflow-scrolling: touch !important; ">';html+='<div id="innerContainer">';html+='<img class="neb-loading-spinner" alt="Loading" style="position:absolute !important;top:50% !important;left:50% !important; margin-top: -30px !important;margin-left: -30px !important; max-width:60px !important;" src="https://cdn-prod.kampyle.com/resources/onsite/images/kloader.gif"/>';html+='<div id="kampyleFormModal" style="z-index:99999999 !important; -webkit-overflow-scrolling: touch !important;"></div>';html+='</div>';html+='</div>';formSpanPlacer.innerHTML=html;var s=document.body.appendChild(formSpanPlacer);}
var formHtml=data.formHtmlUrl||formData.formHtmlUrl;formHtml=KAMPYLE_UTILS.createFormUrl(formHtml,data.formId);if(displayType==="popup"){}
else{var formIframe=document.getElementById('kampyleForm'+data.formId);if(!formIframe){var iframeStyleObject={border:0,height:'100%','max-height':'100%','min-height':'100%',width:'100%','max-width':'100%','min-width':'100%',display:'none',};formIframe=document.createElement('iframe');formIframe.id='kampyleForm'+data.formId;if(!KAMPYLE_DATA.isCustomHtmlForm(data.formId)){iframeStyleObject.position='fixed';}
KAMPYLE_UTILS.setElementStyle(formIframe,iframeStyleObject,true);}
formIframe.src=formHtml;document.getElementById('kampyleFormModal').appendChild(formIframe);}}
function createInviteIframe(eventName,eventData){var data=KAMPYLE_DATA.getFormData(eventData.formId);var inviteSpanPlacer=document.createElement('span');var inviteContainerStyles='top:0 !important;left:0 !important;width: 100% !important;';inviteContainerStyles+='height: 100% !important;position: fixed !important;visibility:hidden !important;';inviteContainerStyles+='display:none !important;background-color: rgba(22,22,22,0.5) !important;';inviteContainerStyles+='z-index:99999999 !important;overflow:auto !important';var spinnerStyles='position:absolute !important;top:50% !important;left:50% !important;';spinnerStyles+='margin-top: -30px !important;margin-left: -30px !important; max-width:60px !important;';inviteSpanPlacer.innerHTML='<div id="kampyleInviteContainer" style="'+inviteContainerStyles+'"><img class="neb-loading-spinner" alt="Loading" style="'+spinnerStyles+'" src="https://cdn-prod.kampyle.com/resources/onsite/images/kloader.gif"/><div id="kampyleInviteModal" style="overflow: hidden;margin: 0 auto;height:'+data.inviteData.inviteHeight+';width:'+data.inviteData.inviteWidth+';position:relative;z-index:99999999;top: 25%;-webkit-box-shadow:0 0 10px rgba(0,0,0,0.4);-moz-box-shadow:0 0 10px rgba(0,0,0,0.4); box-shadow:0 0 10px rgba(0,0,0,0.4);"></div></div>';var s=document.body.appendChild(inviteSpanPlacer);var inviteIframe=document.createElement('iframe');inviteIframe.id='kampyleInvite';inviteIframe.title='Invitation to provide feedback';var inviteHeight=data.inviteData.inviteHeight;var inviteWidth=data.inviteData.inviteWidth;var kampyleDevice=KAMPYLE_DATA.getMemoryData('kampyleDevice');if(kampyleDevice==='mobile'||kampyleDevice==='tablet'){inviteHeight='100%';inviteWidth='100%';var inviteModal=document.getElementById("kampyleInviteModal");if(!!inviteModal)
{KAMPYLE_UTILS.setElementStyle(inviteModal,{height:'100%',width:'100%',},true);}}
KAMPYLE_UTILS.setElementStyle(inviteIframe,{height:inviteHeight,width:inviteWidth,display:'none',border:'0',},true);if(KAMPYLE_DATA.isFeatureEnabled('WCAG')){data.inviteData.inviteUrl+='?isWCAG=true';}
inviteIframe.src=data.inviteData.inviteUrl;document.getElementById('kampyleInviteModal').appendChild(inviteIframe);if(KAMPYLE_DATA.isNewMobileInvitation()){var spinner=document.getElementsByClassName('neb-loading-spinner')[0];KAMPYLE_UTILS.setElementStyle(spinner,{display:'none',},true);KAMPYLE_UTILS.setElementStyle(inviteSpanPlacer,{'z-index':99999998,},true);var inviteContainer=document.getElementById('kampyleInviteContainer');if(inviteContainer){KAMPYLE_UTILS.setElementStyle(inviteContainer,{'z-index':99999998,},true);}}}
function hideButton(eventName,data){if(document.getElementById('kampyleButtonContainer')){document.getElementById('kampyleButtonContainer').innerHTML='';}}
function removeAllShownElements(){var kampyleFormContainer=document.getElementById('kampyleFormContainer');var kampyleInviteContainer=document.getElementById('kampyleInviteContainer');hideButton();if(kampyleFormContainer){KAMPYLE_UTILS.removeAllContent(kampyleFormContainer);}
if(kampyleInviteContainer){KAMPYLE_UTILS.removeAllContent(kampyleInviteContainer);}}
return{removeAllShownElements:removeAllShownElements,createIframe:createIframe,showInvite:showInvite,showForm:showForm,hideForm:hideForm,showButton:showButton,hideInvite:hideInvite,updateIframeStyle:updateIframeStyle,formatTriangularStyle:formatTriangularStyle,formatVerticalStyle:formatVerticalStyle,prepareHostingDOM:prepareHostingDOM,restoreHostingDOM:restoreHostingDOM,getInvitePosition:getInvitePosition,newMobileInvite:newMobileInvite,changeInviteHeight:changeInviteHeight,init:init,setMetaViewport:setMetaViewport,showVisibility:showVisibility,getCornerMargin:getCornerMargin,};})(window,document);var KAMPYLE_MESSAGE=(function(){function init(){KAMPYLE_UTILS.setEventHandler(window,'message',handleMessage);}
function handleMessage(e){if(!e||!e.origin||e.origin.indexOf("kampyle.com")===-1||!e.data){return false;}
var currDate=new Date();var data;try{data=JSON.parse(e.data);}
catch(e){return false;}
switch(data.action){case"inviteAccepted":KAMPYLE_EVENT_DISPATCHER.trigger('neb_inviteAccepted',{'formId':data.formId});break;case"inviteDeclined":case"inviteDefered":KAMPYLE_EVENT_DISPATCHER.trigger('neb_inviteDeclined',{'formId':data.formId});break;case"inviteHeightChanged":KAMPYLE_EVENT_DISPATCHER.trigger('neb_inviteHeightChanged',{formId:data.formId,newHeight:data.newHeight});case"formLoaded":KAMPYLE_EVENT_DISPATCHER.trigger('neb_formLoaded',{'formId':data.formId,origin:e.origin,isScreenCaptureEnabled:data.isScreenCaptureEnabled});break;case"formSubmitPending":case"formHide":KAMPYLE_EVENT_DISPATCHER.trigger('neb_formHide',{'formId':data.formId});break;case"formSubmitted":KAMPYLE_EVENT_DISPATCHER.trigger('neb_feedbackSubmitted',{'formId':data.formId,'feedbackUUID':data.uuid});break;case"formClose":KAMPYLE_EVENT_DISPATCHER.trigger('neb_formClosed',{formId:data.formId,feedbackUUID:data.uuid,sourceWindow:e.source,isFormSubmitted:data.isFormSubmitted});break;case"formPageShown":KAMPYLE_EVENT_DISPATCHER.trigger('neb_formPageShown',{'formId':data.formId,'feedbackUUID':data.uuid,'pageNumber':data.pageNumber,});break;case"triggerScreenCapture":KAMPYLE_EVENT_DISPATCHER.trigger('neb_captureInit',{'formId':data.formId,'feedbackUUID':data.uuid,'screenCaptureSettings':data.screenCaptureSettings});break;case"scrollToForm":KAMPYLE_EVENT_DISPATCHER.trigger('neb_scrollToForm',{});break;case'inviteLoaded':KAMPYLE_EVENT_DISPATCHER.trigger('neb_inviteLoaded',{formId:data.formId,inviteVersion:data.inviteVersion,});break;default:KAMPYLE_UTILS.showWarning('invalid action - '+data.action);return false;}}
return{init:init,handleMessage:handleMessage,};})();var KAMPYLE_UTILS={triggerCustomEvent:function(eventName,data){data=data||{};var event=new CustomEvent(eventName,data);window.dispatchEvent(event);},createFormUrl:function(url,formId){url+='?formId='+formId;url+='&type=live';var fullUrl=window.location.href;var splitted=fullUrl.split('?');if(splitted&&splitted.length)
{fullUrl=splitted[0];}
url+='&referrer='+encodeURIComponent(fullUrl);var region=KAMPYLE_DATA.getMemoryData('region');if(region){url+='&region='+region;}
if(KAMPYLE_DATA.isFeatureEnabled('WCAG')){url+='&isWCAG=true';}
return url;},isDebugMode:function(){var region=KAMPYLE_DATA.getMemoryData('region');return(region==='dev'||region==='qa');},showErrorStack:function(e){if(KAMPYLE_UTILS.isDebugMode()){console.warn(e.stack);}},showWarning:function(message){if(KAMPYLE_UTILS.isDebugMode()){console.warn(message);}},addStyle:function(cssStyle,referencedDocument){referencedDocument=referencedDocument||window.document;var style=referencedDocument.getElementById('kampyleStyle');if(style===null){style=referencedDocument.createElement('style');style.type='text/css';style.id='kampyleStyle';var head=referencedDocument.head||referencedDocument.getElementsByTagName('head')[0];head.appendChild(style);}
if(style.styleSheet){style.styleSheet.cssText+=cssStyle;}else{style.appendChild(document.createTextNode(cssStyle));}},getTimeDiff:function(time,format){var datetime=typeof time!=='undefined'?time:"2014-01-01 01:02:03.123456";datetime=new Date(datetime).getTime();var now=Date.now();if(isNaN(datetime)){return'';}
var miliSecDiff=0;if(datetime<now){miliSecDiff=now-datetime;}else{miliSecDiff=datetime-now;}
switch(format){case KAMPYLE_CONSTANT.TIME_FORMATS.SECONDS:return miliSecDiff.toFixed(1)/1000;case KAMPYLE_CONSTANT.TIME_FORMATS.DAYS:return Math.floor(miliSecDiff/1000/60/60/24);default:return miliSecDiff;}},setEventHandler:function(elem,eventType,handler){if(elem.addEventListener){elem.addEventListener(eventType,handler,false);}
else if(elem.attachEvent){elem.attachEvent('on'+eventType,handler);}},setElementStyle:function(element,styleObj,isImportant){var k;var dashed;isImportant=!!isImportant?'important':'';if(element){for(k in styleObj){if(styleObj.hasOwnProperty(k)){if(isImportant&&element&&element.style.setProperty){dashed=KAMPYLE_UTILS.camelToDash(k);try{element.style.setProperty(dashed,''+styleObj[k],isImportant);}
catch(e){element.style.setProperty(dashed,''+styleObj[k],'!'+isImportant);}}
else{element.style[k]=styleObj[k];}}}}},isNear:function(elementId,distance,event){var element=document.getElementById(elementId);if(!element){return false;}
var left=KAMPYLE_UTILS.offset(element).left-distance;var top=KAMPYLE_UTILS.offset(element).top-distance;var right=left+element.clientWidth+(2*distance);var bottom=top+element.clientHeight+(2*distance);var x=event.pageX;var y=event.pageY;return(x>left&&x<right&&y>top&&y<bottom);},offset:function(element){if(!element){return false;}
var rect=element.getBoundingClientRect();var bodyElm=document.body;return{top:+rect.top+bodyElm.scrollTop,left:rect.left+bodyElm.scrollLeft,};},createIframe:function(src,width,height,iframeId){var iframe=document.createElement('iframe');iframe.width=width;iframe.height=height;iframe.src=src;iframe.id=iframeId;iframe.style.border=0;iframe.frameBorder=0;iframe.style.display="inline-block";return iframe;},getUrlParam:function(name){var params=location.search.substr(location.search.indexOf("?")+1);if(params===""){params=location.hash.substr(location.hash.indexOf("?")+1);}
var sval="";params=params.split("&");var paramLenght=params.length;for(var i=0;i<paramLenght;i++)
{var temp=params[i].split("=");if(temp&&[temp[0]]==name){sval=temp[1];}}
return sval;},htmlDecode:function(inputHtml){inputHtml=inputHtml||'';var re;re=new RegExp('&lt','g');inputHtml=inputHtml.replace(re,'<');re=new RegExp('&gt','g');inputHtml=inputHtml.replace(re,'>');return inputHtml;},escapeRegExp:function(str){return str.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");},replaceAll:function(str,find,replace){return str.replace(new RegExp(KAMPYLE_UTILS.escapeRegExp(find),'g'),replace);},sendMessageToIframe:function(iframeId,message){var origin;var targetWindow;var iframe;if(!iframeId){return;}
iframe=document.getElementById(iframeId);if(!iframe||!iframe.getAttribute){return;}
var origin=iframe.getAttribute("origin")||'*';var targetWindow=iframe.contentWindow;if(targetWindow&&targetWindow.postMessage)
{targetWindow.postMessage(JSON.stringify(message),origin);}},getBrowser:function(){var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(M[1])){tem=/\brv[ :]+(\d+)/g.exec(ua)||[];return{name:'IE',version:tem[1]||''}}
if(M[1]==='Chrome'){tem=ua.match(/\b(OPR|Edge)\/(\d+)/);if(tem!=null){var temArr=tem.slice(1);return{name:temArr[0].replace('OPR','Opera'),version:temArr[1]||''}}}
M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,'-?'];if((tem=ua.match(/version\/(\d+)/i))!=null)M.splice(1,1,tem[1]);return{name:M[0],version:M[1]};},initEventSubscriptions:function(eventObj,callback){for(var prop in eventObj)
{if(eventObj.hasOwnProperty(prop))
{KAMPYLE_EVENT_DISPATCHER.subscribe(prop,callback);}}},kampyleGetUserId:function(){var userid=KAMPYLE_DATA.getData('kampyle_userid');if(!userid){userid=KAMPYLE_UTILS.kampyleCreateUUID();KAMPYLE_DATA.setData('kampyle_userid',userid);}
return userid;},kampyleCreateUUID:function(){var numAttempts=8;var uuidAlgorithm=function(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);};var uuid=uuidAlgorithm();for(var i=0;i<numAttempts-1;i++){uuid+='-'+uuidAlgorithm();}
return uuid;},removeAllContent:function(elem){if(!elem){return;}
while(elem.firstChild){elem.removeChild(elem.firstChild);}
elem.parentNode.removeChild(elem);},safeToLower:function(toLower){if(typeof toLower!=='string')
{return toLower;}
else{return toLower.toLowerCase();}},kampyleSetCookie:function(cookieName,cookieValue,exDays){var currDate=new Date();currDate.setTime(currDate.getTime()+(exDays*24*60*60*1000));var expires="expires="+currDate.toUTCString();document.cookie=cookieName+"="+cookieValue+"; "+expires+";path=/";},kampyleGetCookie:function(cookieName){this.name=cookieName+"=";this.ca=document.cookie.split(';');for(var i=0;i<this.ca.length;i++){this.c=this.ca[i];while(this.c.charAt(0)===' ')this.c=this.c.substring(1);if(this.c.indexOf(this.name)===0)return this.c.substring(this.name.length,this.c.length);}
return'';},getByteSize:function(s){return encodeURIComponent('<q></q>'+s).length;},getAllKampyleData:function(){var kampyleDataNames=['SUBMITTED_DATE','kampyleUserPercentile','kampyleUserSession','kampyle_userid','kampyleInvitePresented','DECLINED_DATE','LAST_INVITATION_VIEW'];var result={};for(var i=kampyleDataNames.length-1;i>=0;i--){result[kampyleDataNames[i]]=KAMPYLE_DATA.getData(kampyleDataNames[i]);}
return result;},kampyleDeleteCookie:function(cookieName){var expires="expires=Thu, 01 Jan 1970 00:00:00 UTC";document.cookie=cookieName+"= ; "+expires+'; path=/';},kampyleIsCookieEnabled:function(){return navigator.cookieEnabled;},kampyleCompareTimestamps:function(source,toCompare,operator)
{if(typeof source!=='number'||typeof toCompare!=='number')
{return false;}
source=new Date(source);toCompare=new Date(toCompare);source.setHours(0,0,0,0);switch(operator){case'equals':toCompare.setHours(0,0,0,0);return(source.getTime()===toCompare.getTime());break;case'laterthan':toCompare.setHours(23,59,59,999);return(source>toCompare);break;case'earlierthan':toCompare.setHours(0,0,0,0);return(source<toCompare);break;case'doesnotequal':toCompare.setHours(0,0,0,0);return(source.getTime()!==toCompare.getTime());break;default:return false;break;}},kampyleCompareByOperator:function(source,toCompare,operator,varType){varType=KAMPYLE_UTILS.safeToLower(varType);var ans=false;if(source===undefined)
{return ans;}
operator=KAMPYLE_UTILS.safeToLower(operator);switch(operator){case'equals':if(varType==='datetime')
{ans=KAMPYLE_UTILS.kampyleCompareTimestamps(source,toCompare,operator);}
else{ans=(source===toCompare);}
break;case'doesnotequal':if(varType==='datetime')
{ans=KAMPYLE_UTILS.kampyleCompareTimestamps(source,toCompare,operator);}
else{ans=(source!==toCompare);}
break;break;case'greaterthan':ans=(source>toCompare);break;case'laterthan':if(varType==='datetime')
{ans=KAMPYLE_UTILS.kampyleCompareTimestamps(source,toCompare,operator);}
else{ans=(source>toCompare);}
break;case'smallerthan':ans=(source<toCompare);break;case'earlierthan':if(varType==='datetime')
{ans=KAMPYLE_UTILS.kampyleCompareTimestamps(source,toCompare,operator);}
else{ans=(source>toCompare);}
break;case'contains':ans=(!!source&&source.indexOf&&source.indexOf(toCompare)!==-1);break;case'doesnotcontain':ans=(!!source&&source.indexOf&&source.indexOf(toCompare)===-1);break;case'startswith':ans=(!!source&&source.indexOf&&source.indexOf(toCompare)===0);break;case'endswith':ans=(!!source&&source.indexOf&&source.length&&source.indexOf(toCompare,source.length-source.length)!==-1);break;case'hasvalue':ans=(!!source||source===''||source===false||source===0);break;default:break;}
return ans;},setNestedPropertyValue:function(obj,propString,value){var schema=obj;var pList=propString.split('.');var len=pList.length;for(var i=0;i<len-1;i++){var elem=pList[i];if(!schema[elem]){schema[elem]={};}
schema=schema[elem];}
schema[pList[len-1]]=value;},getNestedPropertyValue:function(obj,propString){if(!obj||!propString){return null;}
var props=propString.split('.');var tmpObj=obj;var len=props.length;for(var i=0;i<len;i++){if(!!tmpObj&&(tmpObj.hasOwnProperty(props[i])||tmpObj[props[i]]))
{tmpObj=tmpObj[props[i]];}
else{return null;}}
return tmpObj;},validateKampyleDomain:function(url){var urlRegex=/(^https?:\/\/[A-Za-z0-9\-]+\.kampyle\.com(\/[A-Za-z0-9\-\._~:\/\?#\[\]@!$&'\(\)\*\+,;\=]*)?)/;var result=urlRegex.test(url);if(!result){console.warn('Invalid url in validateKampyleDomain: '+url);}
return result;},camelToDash:function(str){if(typeof str!=='string'){return str;}
else{return str.replace(/\W+/g,'-').replace(/([a-z\d])([A-Z])/g,'$1-$2').toLowerCase();}},objectPropertyObserver:function(obj,pathToProperty,callback){var MAX_TIMEOUT_RUNS=100;var timeoutMs=100;var runsCounter=0;function timoutCallback(){var propertyValue=KAMPYLE_UTILS.getNestedPropertyValue(obj,pathToProperty);if(!!propertyValue&&callback instanceof Function){return callback(propertyValue);}
if(runsCounter++<MAX_TIMEOUT_RUNS){window.setTimeout(timoutCallback,timeoutMs);}}
window.setTimeout(timoutCallback,timeoutMs);},};var KAMPYLE_EVENT_DISPATCHER=(function(window,document){var eventSubscriptions;function init(){eventSubscriptions={};}
var getEventSubscriptions=function(eventName){if(eventName&&eventSubscriptions[eventName]){return eventSubscriptions[eventName];}
else{return eventSubscriptions;}};var unsubscribe=function(eventName,callback){if(!eventName||typeof eventName!=='string'||!callback||typeof callback!=='function'){return false;}
var subscribers=eventSubscriptions[eventName];if(typeof subscribers!=='undefined'){var callbackIndex=subscribers.indexOf(callback);if(callbackIndex!==-1)
{subscribers.splice(callbackIndex,1);}}
return true;};var subscribe=function(eventName,callback){if(!eventName||typeof eventName!=='string'||!callback||typeof callback!=='function'){return false;}
var subscribers=eventSubscriptions[eventName];if(typeof subscribers==='undefined'){subscribers=eventSubscriptions[eventName]=[];}
var callbackIndex=subscribers.indexOf(callback);if(callbackIndex===-1)
{subscribers.push(callback);}
return true;};function appendDefaultEventParams(data){data=data||{};var allData=KAMPYLE_FUNC.kampyleGetData();var defaultValues={};if(allData){defaultValues={'accountId':allData.accountId,'websiteId':allData.websiteId,'enviroment':allData.region};}
return Object.assign(data,defaultValues);}
var trigger=function(eventName,data,context){var subscribers=eventSubscriptions[eventName];var i,iMax;if(typeof subscribers==='undefined'){return false;}
data=appendDefaultEventParams(data);data=(data instanceof Array)?data:[data];context=context||null;iMax=subscribers.length;for(i=0;i<iMax;i+=1){try{subscribers[i].apply(context,[eventName].concat(data));}catch(e){KAMPYLE_UTILS.showErrorStack(e)
continue;}}
return true;};var subscribeMany=function(eventMapping){for(var eventName in eventMapping){if(eventMapping.hasOwnProperty(eventName)){for(var i=0;i<eventMapping[eventName].length;i++){subscribe(eventName,eventMapping[eventName][i]);}}}};function subscribeOnce(eventName,callback){var subscribers=getEventSubscriptions(eventName);if(subscribers.indexOf(callback)===-1){subscribe(eventName,callback);}}
return{subscribe:subscribe,subscribeOnce:subscribeOnce,subscribeMany:subscribeMany,trigger:trigger,unsubscribe:unsubscribe,init:init,getEventSubscriptions:getEventSubscriptions,appendDefaultEventParams:appendDefaultEventParams}})(window,document);var KAMPYLE_LOGGER=(function(window,document){var CONFIG={UDC_LOGS_IMAGE_ID:'kampyle_udclogs',LOGS_DOMAIN:'https://feedback.kampyle.com/feedback/'};var COMMON_FIELDS;var loggerEvents={'neb_inviteAccepted':{eventId:'nebula_invite_accepted'},'neb_inviteDeclined':{eventId:'nebula_invite_declined'},'neb_showInvitation':{eventId:'nebula_show_invitation_show_form'},'neb_feedbackSubmitted':{eventId:'nebula_form_submitted'},'neb_formShown':{eventId:'nebula_form_shown'},'neb_buttonClicked':{eventId:'nebula_button_clicked'},neb_formClosed:{eventId:'nebula_form_closed'},neb_popupBlocked:{eventId:'nebula_popup_blocked',},'neb_skipInvitation':{eventId:'nebula_skip_invitation_show_form'},'neb_formPageShown':{eventId:'nebula_form_page_shown'},'neb_captureInit':{eventId:'nebula_capture_init'},'neb_captureImageClicked':{eventId:'nebula_capture_image_clicked'},'neb_cancelCaptureClicked':{eventId:'nebula_cancel_capture_clicked'}};var kampyleSendLoggerData=function(dataFormatted){if(!dataFormatted||CONFIG.LOGS_DOMAIN==='https://feedback.kampyle.com/feedback/'){return false;}
var src;var currTime=new Date().getTime();var img=document.getElementById(CONFIG.UDC_LOGS_IMAGE_ID);if(!img){img=new Image();img.width='1px';img.height='1px';img.id='udc';img.style.position='absolute';img.style.top='-100px';img.style.left='-100px';}
img.src="";src="";src+=CONFIG.LOGS_DOMAIN;src+='api/udc/event?data=';src+=encodeURIComponent(JSON.stringify(dataFormatted));src+='&t='+currTime;img.src=src;};var formatData=function(eventName,oData){var result=oData;for(var prop in COMMON_FIELDS)
{result[prop]=COMMON_FIELDS[prop];}
for(var eventProp in loggerEvents[eventName])
{result[eventProp]=loggerEvents[eventName][eventProp];}
return result;};var triggerLoggerEvent=function(eventName,oData){if(!loggerEvents[eventName]){return false;}
var oDataFormatted=formatData(eventName,oData);kampyleSendLoggerData(oDataFormatted);};function init(){COMMON_FIELDS={environment:'public',pageURL:location.href,userid:KAMPYLE_UTILS.kampyleGetUserId()};for(var prop in loggerEvents)
{if(loggerEvents.hasOwnProperty(prop))
{KAMPYLE_EVENT_DISPATCHER.subscribe(prop,triggerLoggerEvent);}}
return true;};return{kampyleSendLoggerData:kampyleSendLoggerData,formatData:formatData,init:init,triggerLoggerEvent:triggerLoggerEvent};})(window,document);var KAMPYLE_COOLADATA=(function(window,document){var COMMON_FIELDS;var COOLADATA_SRC='//nebula-cdn.kampyle.com/resources/onsite/js/cool-2.1.15.min.js';var cooladataEvents={neb_pageView:{eventId:'nebula_page_view',},neb_inviteAccepted:{eventId:'nebula_invite_accepted',},neb_inviteDeclined:{eventId:'nebula_invite_declined',},neb_showInvitation:{eventId:'nebula_show_invitation_show_form',memoryDataKey:'invitationTriggeringData',},neb_feedbackSubmitted:{eventId:'nebula_form_submitted',},neb_formShown:{eventId:'nebula_form_shown',},neb_buttonClicked:{eventId:'nebula_button_clicked',},neb_sdkShowForm:{eventId:'nebula_code_trigger_form',},neb_loadForm:{eventId:'nebula_code_load_form',},neb_formClosed:{eventId:'nebula_form_closed',},neb_popupBlocked:{eventId:'nebula_popup_blocked',},neb_skipInvitation:{eventId:'nebula_skip_invitation_show_form',},neb_formPageShown:{eventId:'nebula_form_page_shown',},neb_captureInit:{eventId:'nebula_capture_init',},neb_captureImageClicked:{eventId:'nebula_capture_image_clicked',},neb_cancelCaptureClicked:{eventId:'nebula_cancel_capture_clicked',},};var kampyleSendCoolaData=function(dataFormatted){if(!dataFormatted||!window.cooladata){return false;}
dataFormatted.uuid=dataFormatted.feedbackUUID;var dataToSend={enviroment:dataFormatted.enviroment,accountId:dataFormatted.accountId,url:dataFormatted.pageURL,websiteId:dataFormatted.websiteId,feedback_uuid:dataFormatted.uuid||null,formId:dataFormatted.formId||null,kampyle_data:dataFormatted.kampyle_data||null,cookie_size:dataFormatted.cookie_size||null,kampyle_version:dataFormatted.kampyle_version||'',history_length:window.history.length,event_local_timestamp:Date.now(),};if(dataFormatted.eventId==='nebula_form_page_shown'){dataToSend.pageNumber=dataFormatted.pageNumber;}
cooladata.trackEvent(dataFormatted.eventId,dataToSend);return true;};function formatData(eventName,oData){if(!eventName||!oData){return null;}
var result=oData;for(var prop in COMMON_FIELDS){result[prop]=COMMON_FIELDS[prop];}
for(var eventProp in cooladataEvents[eventName]){result[eventProp]=cooladataEvents[eventName][eventProp];}
var kampyleData=appendDataByEventName(eventName,KAMPYLE_UTILS.getAllKampyleData());result.kampyle_data=kampyleData;result.cookie_size=KAMPYLE_UTILS.getByteSize(document.cookie);result.kampyle_version=window.KAMPYLE_REVISION||'0.0.0.0';return result;}
var triggerCooladataEvent=function(eventName,oData){if(!cooladataEvents[eventName]){return false;}
var oDataFormatted=formatData(eventName,oData);kampyleSendCoolaData(oDataFormatted);};function init(){if(!window.cooladata){(function(d,a){if(!a.__SV){var b,c,g,e;window.cooladata=a;a._i=[];a.init=function(b,c,f){function d(a,b){var c=b.split(".");2==c.length&&(a=a[c[0]],b=c[1]);a[b]=function(){a.push([b].concat(Array.prototype.slice.call(arguments,0)))}}var h=a;"undefined"!==typeof f?h=a[f]=[]:f="cooladata";g=["trackEvent","trackEventLater","trackPageload","flush","setConfig"];for(e=0;e<g.length;e++)d(h,g[e]);a._i.push([b,c,f])};a.__SV=1.2;b=d.createElement("script");b.type="text/javascript";b.async=!0;b.src=COOLADATA_SRC;c=d.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.cooladata||[]);}
COMMON_FIELDS={pageURL:location.href,userid:KAMPYLE_UTILS.kampyleGetUserId(),};if(window.cooladata){cooladata.init({cookie_expiration:KAMPYLE_DATA.getCookieExpiration(),app_key:'qceuv8449dzg58ptt1bhda9g8ue19c7s',track_pageload:false,img_src_get_request:true,api_host:'udc-neb.kampyle.com',});}
KAMPYLE_UTILS.initEventSubscriptions(cooladataEvents,triggerCooladataEvent);return true;}
function getUserId(){return KAMPYLE_DATA.getData('cd_user_id')||window.cooladata.config.user_id||null;}
function appendDataByEventName(eventName,dataObj){var memoryDataKey=cooladataEvents[eventName].memoryDataKey;var memoryData=KAMPYLE_DATA.getMemoryData(memoryDataKey);if(memoryData){dataObj[memoryDataKey]=memoryData;}
return dataObj;}
return{kampyleSendCoolaData:kampyleSendCoolaData,formatData:formatData,appendDataByEventName:appendDataByEventName,init:init,triggerCooladataEvent:triggerCooladataEvent,getUserId:getUserId,};})(window,document);var KAMPYLE_THERMO_TEALEAF_FUNC=(function(){var TEALEAF_COOKIE_SESSION_ID='TLTSID';function isTealeafEnabled(){return!!KAMPYLE_UTILS.kampyleGetCookie(TEALEAF_COOKIE_SESSION_ID);}
function getTealeafData(){if(KAMPYLE_THERMO_TEALEAF_FUNC.isTealeafEnabled()){return{sid:KAMPYLE_UTILS.kampyleGetCookie(TEALEAF_COOKIE_SESSION_ID),};}
return null;}
return{isTealeafEnabled:isTealeafEnabled,getTealeafData:getTealeafData,};})();var KAMPYLE_CLICKTALE_FUNC=(function(){function isClicktaleEnabled(){return(!!window.ClickTale&&!!window.ClickTale.KampyleLink);};function getClicktaleData(){if(KAMPYLE_CLICKTALE_FUNC.isClicktaleEnabled()){if(window.ClickTale.KampyleLink!=='NOT_RECORDING'){var clicktaleData={recordingUrl:window.ClickTale.KampyleLink};return clicktaleData;}}
return null;}
return{isClicktaleEnabled:isClicktaleEnabled,getClicktaleData:getClicktaleData};})();var KAMPYLE_SESSIONCAM={isSessionCamEnabled:function(){return(!!window.sessionCamRecorder);},getSessionCamData:function(){if(KAMPYLE_SESSIONCAM.isSessionCamEnabled()){var sessionId=window.sessionCamRecorder.sessionId();if(!!sessionId){var sessionCamData={recordingUrl:"https://console.sessioncam.com/Console/Recordings/PlaybackSession?sessionId="+sessionId};return sessionCamData;}}
return null;},sendCustomParam:function(key,value){window.sessioncamConfiguration=window.sessioncamConfiguration||{};window.sessioncamConfiguration.customDataObjects=window.sessioncamConfiguration.customDataObjects||[];var item={key:key,value:value};window.sessioncamConfiguration.customDataObjects.push(item);},init:function(){KAMPYLE_EVENT_DISPATCHER.subscribe("neb_feedbackSubmitted",this.sessionCamFormSubmittedCallback);},sessionCamFormSubmittedCallback:function(eventName,oData){if(eventName!=='neb_feedbackSubmitted'){return;}
KAMPYLE_SESSIONCAM.sendCustomParam("nebula_feedback_uuid",oData.feedbackUUID);}};var KAMPYLE_SCREEN_CAPTURE=(function(window,document){var widgetTemplate=['<html>','<head>','<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans:400,300,700" />','<script type="text/javascript">','function resizeIframe() {','parent.document.getElementById("nebScIframe").height = document.getElementById("sc-widget").scrollHeight + 15;','}','</script>','<style>{tooltipStyles}</style>','</head>','<body onload="resizeIframe();" style="margin:0px;">','<div id="sc-widget" class="sc-widget" style="{widget}">','<div class="sc-widget-content" style="{widgetContent}">','{{instructionsScreenCapture}}','</div>','<div class="sc-widget-footer" style="{widgetFooter}">','<button onclick="parent.KAMPYLE_SCREEN_CAPTURE.cancelScreenCapture();" class="sc-widget-footer-cancel top-tip" data-tips="{{cancelScreenCaptureTooltip}}" style="{widgetFooterBtn} {widgetFooterCancel}">','{{cancelScreenCaptureLabel}}','</button>','<button onclick="parent.UserSnap.api.sendReport();" class="sc-widget-footer-capture top-tip" data-tips="{{submitScreenCaptureTooltip}}" style="{widgetFooterBtn} {widgetFooterCapture}">','<img alt="Loading" src="https://cdn-prod.kampyle.com/resources/onsite/images/kloader.gif" id="widgetFooterCaptureImg" style="width:20px;height:20px;display: none;" />','<span id="widgetFooterCaptureText">{{submitScreenCaptureLabel}}</span>','</button>','</div>','</div>','</body></html>',].join(' ');var defaultStyles={overlay:{'position':'fixed','top':'0','left':'0','z-index':'2147483646','right':'0','bottom':'0','display':'block','pointer-events':'none'},widget:{'font-family':'\'Open Sans\'','border':'1px solid #999','width':'285px','border-radius':'5px','position':'absolute','z-index':'2147483647','pointer-events':'auto','background':'#FFFFFF','text-align':'center','line-height':'20px'},widgetContent:{'padding':'10px 14px'},widgetFooter:{'font-family':'\'Open Sans\' !important','padding':'10px','font-size':'14px','padding-top':'0','font-stretch':'normal','font-style':'normal','font-variant':'normal','font-weight':'normal','letter-spacing':'normal','line-height':'20px'},widgetFooterBtn:{'height':'34px','margin':'0 0 2px 5px','min-width':'100px','outline-style':'none','outline-width':'0px','padding':'6px 12px','display':'inline-block','border-radius':'4px','cursor':'pointer','transition-delay':'0s','transition-duration':'0.3s','transition-property':'all','transition-timing-function':'ease','vertical-align':'middle','white-space':'nowrap','word-spacing':'0px','border':'none','color':'#FFF',},widgetFooterCancel:{'background':'#A2A2A2'},widgetFooterCapture:{'margin-left':'5px','background':'#020202'}};var tooltipStyles='[data-tips]{position:relative;text-decoration:none}[data-tips]:after,[data-tips]:before{position:absolute;z-index:100;opacity:0}[data-tips]:after{content:attr(data-tips);line-height:20px;padding:0 10px;font-size:12px;text-align:center;color:#fff;background:#222;border-radius:5px;text-shadow:0 0 5px #000;-moz-box-shadow:0 0 5px rgba(0, 0, 0, .3);-webkit-box-shadow:0 0 5px rgba(0, 0, 0, .3);box-shadow:0 0 5px rgba(0, 0, 0, .3);white-space:normal;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;width:135px;word-wrap:break-word}[data-tips]:before{content:"";width:0;height:0;border-width:6px;border-style:solid}[data-tips]:hover:after,[data-tips]:hover:before{opacity:1}[data-tips].top-tip:after,[data-tips].top-tip:before{-webkit-transition:bottom .25s ease-in-out, opacity .25s ease-in-out;-moz-transition:bottom .25s ease-in-out, opacity .25s ease-in-out;transition:bottom .25s ease-in-out, opacity .25s ease-in-out;bottom:90%;left:-9999px;margin-bottom:12px}[data-tips].top-tip:before{border-color:#222 transparent transparent;margin-bottom:0}[data-tips].top-tip:hover:after,[data-tips].top-tip:hover:before{bottom:100%;left:0}[data-tips].top-tip:hover:before{left:15px}[data-tips].bottom-tip:after,[data-tips].bottom-tip:before{-webkit-transition:top .25s ease-in-out, opacity .25s ease-in-out;-moz-transition:top .25s ease-in-out, opacity .25s ease-in-out;transition:top .25s ease-in-out, opacity .25s ease-in-out;top:90%;left:-9999px;margin-top:12px}[data-tips].bottom-tip:before{border-color:transparent transparent #222;margin-top:0}[data-tips].bottom-tip:hover:after,[data-tips].bottom-tip:hover:before{top:100%;left:0}[data-tips].bottom-tip:hover:before{left:15px}[data-tips].left-tip:after,[data-tips].left-tip:before{-webkit-transition:left .25s ease-in-out, opacity .25s ease-in-out;-moz-transition:left .25s ease-in-out, opacity .25s ease-in-out;transition:left .25s ease-in-out, opacity .25s ease-in-out;top:-9999px;left:96%;margin-left:12px}[data-tips].left-tip:before{border-color:transparent #222 transparent transparent;margin-left:0}[data-tips].left-tip:hover:after,[data-tips].left-tip:hover:before{left:100%;top:0}[data-tips].left-tip:hover:before{top:7px}[data-tips].right-tip:after,[data-tips].right-tip:before{-webkit-transition:right .25s ease-in-out, opacity .25s ease-in-out;-moz-transition:right .25s ease-in-out, opacity .25s ease-in-out;transition:right .25s ease-in-out, opacity .25s ease-in-out;top:-9999px;right:96%;margin-right:12px}[data-tips].right-tip:before{border-color:transparent transparent transparent #222;margin-right:0}[data-tips].right-tip:hover:after,[data-tips].right-tip:hover:before{right:100%;top:0}[data-tips].right-tip:hover:before{top:7px}';var texts={submitScreenCaptureLabel:'Capture Image',cancelScreenCaptureLabel:'Cancel',instructionsScreenCapture:'<h2 style="font-size: 1.5em;">Screen Capture</h2><p style="font-size: 1em; margin-top: 10px;">Drag the cursor around the area you want to highlight.<br>Press Capture Image to take the snapshot and return to your feedback</p>',submitScreenCaptureTooltip:'Take snapshot',cancelScreenCaptureTooltip:'Back to Feedback',};var formData;function initWidget(eventName,data){data=data||{};var UserSnap=window.UserSnap;formData.uuid=data.feedbackUUID;formData.websiteId=data.websiteId;formData.accountId=data.accountId;formData.formId=data.formId;formData.screenCaptureSettings=data.screenCaptureSettings;formData.canceledClicked=false;UserSnap.api.startUsersnap();}
function overrideDefaultStyles(customSettings){var res=defaultStyles;if(!!customSettings)
{res.widget.background=!!customSettings.backgroundColor?customSettings.backgroundColor:res.widget.background;res.widgetFooterCapture.background=!!customSettings.submitButtoncolor?customSettings.submitButtoncolor:res.widgetFooterCapture.background;res.widgetFooterCancel.background=!!customSettings.closeButtoncolor?customSettings.closeButtoncolor:res.widgetFooterCancel.background;}
return res;}
function overrideDefaultTexts(customSettings){var res=texts;if(!!customSettings)
{for(var prop in res){if(customSettings.hasOwnProperty(prop)&&res.hasOwnProperty(prop))
{res[prop]=customSettings[prop];}}
return res;}};function formatWidget(){formData=formData||{};var widgetHtml=widgetTemplate;var formattedText=overrideDefaultTexts(formData.screenCaptureSettings);if(!formattedText||!formattedText.submitScreenCaptureTooltip)
{widgetHtml=widgetHtml.replace('data-tips="{{submitScreenCaptureTooltip}}"','');}
if(!formattedText||!formattedText.cancelScreenCaptureTooltip)
{widgetHtml=widgetHtml.replace('data-tips="{{cancelScreenCaptureTooltip}}"','');}
for(var prop in formattedText){if(texts.hasOwnProperty(prop))
{widgetHtml=widgetHtml.replace('{{'+prop+'}}',texts[prop]);}}
var formattedStyles=overrideDefaultStyles(formData.screenCaptureSettings);for(var element in formattedStyles){widgetHtml=KAMPYLE_UTILS.replaceAll(widgetHtml,'{'+element+'}',styleObjToInline(defaultStyles[element]));}
widgetHtml=widgetHtml.replace('{tooltipStyles}',tooltipStyles);return KAMPYLE_UTILS.htmlDecode(widgetHtml);}
var showSpinner=function(){var iframeDocument=document.getElementById('nebScIframe').contentDocument;var spinner=iframeDocument.getElementById('widgetFooterCaptureImg');if(!!spinner)
{spinner.style.display='inline';var text=iframeDocument.getElementById('widgetFooterCaptureText');if(!!text)
{text.style.display='none';}}};var hideSpinner=function(){var iframeDocument=document.getElementById('nebScIframe').contentDocument;var spinner=iframeDocument.getElementById('widgetFooterCaptureImg');if(!!spinner)
{spinner.style.display='none';var text=iframeDocument.getElementById('widgetFooterCaptureText');if(!!text)
{text.style.display='inline';}}};var beforeOpen=function(){var widgetHtml=formatWidget();var scIframe=document.createElement('iframe');scIframe.id='nebScIframe';scIframe.style.width='310px';scIframe.frameBorder='0';scIframe.style.bottom='20px';scIframe.style.left='20px';scIframe.style.zIndex=2147483647;scIframe.style.position='fixed';scIframe.sandbox='allow-top-navigation allow-same-origin allow-scripts';var container=document.getElementById('us_sandbox');if(!!container){container.style.display='block';container.style.zIndex=2147483646;container.parentNode.insertBefore(scIframe,container);scIframe.contentWindow.contents=widgetHtml;scIframe.src='javascript:window["contents"]';}
setTimeout(function(){document.activeElement.blur();},100);};var cancelScreenCapture=function(){formData.canceledClicked=true;KAMPYLE_EVENT_DISPATCHER.trigger('neb_cancelCaptureClicked',{formId:formData.formId,feedbackUUID:formData.uuid});closeScreenCapture();}
var closeScreenCapture=function(preventApiFlag){var container=document.getElementById('us_sandbox');if(!!container)
{container.style.display='none';}
var scIframe=document.getElementById('nebScIframe');if(!!scIframe)
{scIframe.parentNode.removeChild(scIframe);}
if(!preventApiFlag){window.UserSnap.api.closeUsersnap();}}
var isScreenCaptureEnabled=function(formId){var browser=KAMPYLE_UTILS.getBrowser();var formJson=KAMPYLE_DATA.getFormData(formId);if(!formJson){return false;}
var displayType=KAMPYLE_DATA.getDisplayType(formJson);return!!browser&&(browser.name!=='MSIE'||Number(browser.version)>8)&&!!displayType&&displayType!=='popup';};var styleObjToInline=function(styleObj){var inlineStyle='';for(var prop in styleObj){inlineStyle+=prop+':'+styleObj[prop]+';';}
return inlineStyle;};var getUsersnapUrlByRegion=function(region){var url='//screencapture.kampyle.com/screenApi/load/';regionToIdMap={'dev':'68f6a493-2a07-4821-b56e-9565a730b01e','qa':'9b9e2585-24ad-4c5a-a369-ef84f38bbfe3','remoteQa1':'7a93319f-df63-4da7-8240-cae32a97f763','remoteQa3':'d36be0be-e3fa-4415-b3e1-45879ad213bb','prodUsOregon':'0d9bccf0-07c5-4694-abf9-9f4bcf1d1ec2','prodEuIrland':'19bfad23-c185-4f20-90b3-8fedb80c92fa','remoteQaMedalia':'3b3d8a8f-859f-4f2b-b947-fea36902fdee','prodAuSydney':'41199294-f928-4c27-be84-555713f191d1','demoCaCybertron':'55595a29-49de-42e0-b42d-35534575c321'};var userSnapId=regionToIdMap[region]||regionToIdMap.dev;return url+userSnapId+'.js';};function beforeSend(obj){if(formData.canceledClicked){formData.canceledClicked=false;}
showSpinner();obj.addInfo={uuid:formData.uuid,websiteId:formData.websiteId};};function afterSend(id){this.snapId=id;if(!formData.canceledClicked){hideSpinner();closeScreenCapture();KAMPYLE_EVENT_DISPATCHER.trigger('neb_captureImageClicked',{formId:formData.formId,feedbackUUID:formData.uuid});}};function init(callback){formData={};window._usersnapconfig={api:true,hideUI:true,mode:'report',hideTour:true,cancelHandler:function(){closeScreenCapture(true);},loadHandler:function(){if(window.UserSnap){window.UserSnap.on('beforeOpen',beforeOpen);window.UserSnap.on('beforeSend',beforeSend);window.UserSnap.on('afterSend',afterSend);}},hostconfig:{homeHost:"//screencaptue-cdn.kampyle.com/",UrlSessionkey:"//screencapture.kampyle.com/screenApi/report/sessionkey",UrlHtml2pngAndSend:"//screencapture.kampyle.com/screenApi/report/sendScreenshot",UrlHtml2png:"//screencapture.kampyle.com/screenApi/report/html2png",UrlSendreport:"//screencapture.kampyle.com/screenApi/report/sendReport",apiErrorUrl:"//screencapture.kampyle.com/screenErr/yuno"}};appendScreenCaptureScript();KAMPYLE_UTILS.objectPropertyObserver(window,'UserSnap',callback);KAMPYLE_EVENT_DISPATCHER.subscribeOnce('neb_captureInit',initWidget);}
function appendScreenCaptureScript(){var id='kampyleSceenCaptureScript';if(document.getElementById(id)){return false;}
var t=document.createElement('script');t.id=id;t.type='text/javascript';t.async=true;var region=KAMPYLE_DATA.getMemoryData('region');var userSnapUrl=getUsersnapUrlByRegion(region);t.src=userSnapUrl;var s=document.body.appendChild(t);}
return{isScreenCaptureEnabled:isScreenCaptureEnabled,closeScreenCapture:closeScreenCapture,initWidget:initWidget,formatWidget:formatWidget,styleObjToInline:styleObjToInline,overrideDefaultTexts:overrideDefaultTexts,overrideDefaultStyles:overrideDefaultStyles,getUsersnapUrlByRegion:getUsersnapUrlByRegion,beforeOpen:beforeOpen,cancelScreenCapture:cancelScreenCapture,init:init};})(window,document);var KAMPYLE_ONSITE_SDK=(function(window,document){function loadForm(formId){var formState=KAMPYLE_DATA.getFormState(formId);if(!formState){KAMPYLE_UTILS.showWarning('Error fetching data for form id '+formId);return false;}
if(!formState.loaded){KAMPYLE_EVENT_DISPATCHER.trigger('neb_loadForm',{formId:formId});}
return true;}
function showForm(formId,options){options=options||{};var formState=KAMPYLE_DATA.getFormState(formId);if(!formState){KAMPYLE_UTILS.showWarning('Error fetching data for form id '+formId);return false;}
if(KAMPYLE_FUNC.isAnyInviteShown()){KAMPYLE_UTILS.showWarning('There is already an invite displayed');return false;}
if(KAMPYLE_FUNC.isAnyFormShown()){KAMPYLE_UTILS.showWarning('There is already a form displayed');return false;}
if(!formState.loaded){loadForm(formId);}
options.triggerType=options.triggerType||'ByCode';KAMPYLE_DATA.saveFormExtraData(formId,options);var extraData={formId:formId,};for(var prop in options){if(options.hasOwnProperty(prop)){extraData[prop]=options[prop];}}
KAMPYLE_EVENT_DISPATCHER.trigger('neb_sdkShowForm',{formId:formId});return true;}
function updatePageView(){KAMPYLE_EVENT_DISPATCHER.trigger('neb_sdkPageView');}
return{loadForm:loadForm,showForm:showForm,updatePageView:updatePageView,};})(window,document);var KAMPYLE_POLYFILLS=(function(window,document){if(typeof Object.assign!='function'){Object.assign=function(target,varArgs){if(target==null){throw new TypeError('Cannot convert undefined or null to object');}
var to=Object(target);for(var index=1;index<arguments.length;index++){var nextSource=arguments[index];if(nextSource!=null){for(var nextKey in nextSource){if(Object.prototype.hasOwnProperty.call(nextSource,nextKey)){to[nextKey]=nextSource[nextKey];}}}}
return to;};}
if(!Array.prototype.indexOf){Array.prototype.indexOf=function(searchElement,fromIndex){var k;if(this==null){throw new TypeError('"this" is null or not defined');}
var o=Object(this);var len=o.length>>>0;if(len===0){return-1;}
var n=+fromIndex||0;if(Math.abs(n)===Infinity){n=0;}
if(n>=len){return-1;}
k=Math.max(n>=0?n:len-Math.abs(n),0);while(k<len){if(k in o&&o[k]===searchElement){return k;}
k++;}
return-1;};}
if(!window.JSON){window.JSON={parse:function(sJSON){return eval('('+sJSON+')');},stringify:(function(){var toString=Object.prototype.toString;var isArray=Array.isArray||function(a){return toString.call(a)==='[object Array]';};var escMap={'"':'\\"','\\':'\\\\','\b':'\\b','\f':'\\f','\n':'\\n','\r':'\\r','\t':'\\t'};var escFunc=function(m){return escMap[m]||'\\u'+(m.charCodeAt(0)+0x10000).toString(16).substr(1);};var escRE=/[\\"\u0000-\u001F\u2028\u2029]/g;return function stringify(value){if(value==null){return'null';}else if(typeof value==='number'){return isFinite(value)?value.toString():'null';}else if(typeof value==='boolean'){return value.toString();}else if(typeof value==='object'){if(typeof value.toJSON==='function'){return stringify(value.toJSON());}else if(isArray(value)){var res='[';for(var i=0;i<value.length;i++)
res+=(i?', ':'')+stringify(value[i]);return res+']';}else if(toString.call(value)==='[object Object]'){var tmp=[];for(var k in value){if(value.hasOwnProperty(k))
tmp.push(stringify(k)+': '+stringify(value[k]));}
return'{'+tmp.join(', ')+'}';}}
return'"'+value.toString().replace(escRE,escFunc)+'"';};})()};}
if(!Date.now){Date.now=function now(){return new Date().getTime();};}
if(typeof Object.assign!='function'){(function(){Object.assign=function(target){'use strict';if(target===undefined||target===null){throw new TypeError('Cannot convert undefined or null to object');}
var output=Object(target);for(var index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&source!==null){for(var nextKey in source){if(source.hasOwnProperty(nextKey)){output[nextKey]=source[nextKey];}}}}
return output;};})();}
(function(){if(typeof window.CustomEvent==="function")return false;function CustomEvent(event,params){params=params||{bubbles:false,cancelable:false,detail:undefined};var evt=document.createEvent('CustomEvent');evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt;}
CustomEvent.prototype=window.Event.prototype;window.CustomEvent=CustomEvent;})();})(window,document);var KAMPYLE_INTEGRATION=(function(){var INTEGRATION_CONTEXT={sessionCam:'sessionCamRecorder',};function getParameterBySource(source,param,context){switch(source){case'var':return KAMPYLE_UTILS.getNestedPropertyValue(window,param);case'cookie':return KAMPYLE_UTILS.kampyleGetCookie(param);case'function':var func=KAMPYLE_UTILS.getNestedPropertyValue(window,param);if(typeof func==='function'){return func.apply(context);}
else{return null;}
case'url':return KAMPYLE_UTILS.getUrlParam(KAMPYLE_UTILS.getNestedPropertyValue(window,param));case'storage':return localStorage.getItem(KAMPYLE_UTILS.getNestedPropertyValue(window,param));default:}}
function isEnabled(integrationData){var isEnabledBol=true;var valueBySource;var paramValue;var isEnabledArray=integrationData.isEnabled;var contextParam=INTEGRATION_CONTEXT[integrationData.integrationName];var integrationContext=KAMPYLE_UTILS.getNestedPropertyValue(window,contextParam);for(var i=0;i<isEnabledArray.length;i++){var isEnabledCurr=false;var isEnabledCurrName=isEnabledArray[i].param;paramValue=isEnabledArray[i].paramValue;if(!isEnabledCurrName){KAMPYLE_UTILS.showWarning('no current name found');}
valueBySource=getParameterBySource(isEnabledArray[i].source,isEnabledCurrName,integrationContext);if(paramValue===null){isEnabledCurr=(valueBySource!==undefined&&valueBySource!==null);}
else{isEnabledCurr=paramValue===valueBySource;}
isEnabledBol=isEnabledBol&&isEnabledCurr;}
return isEnabledBol;}
function prepareIntegrationData(integrationData){var parametersJson={};var integrationDataJson={};var parametersArray=integrationData.parameters||[];var contextParam=INTEGRATION_CONTEXT[integrationData.integrationName]||null;var integrationContext=KAMPYLE_UTILS.getNestedPropertyValue(window,contextParam);for(var i=0;i<parametersArray.length;i++){var paramValue=getParameterBySource(parametersArray[i].source,parametersArray[i].param,integrationContext);var putIn=integrationData.parameters[i].putIn;KAMPYLE_UTILS.setNestedPropertyValue(parametersJson,putIn,paramValue);}
integrationDataJson={integrationName:integrationData.integrationName,parameters:parametersJson,};return integrationDataJson;}
function getIntegrationData(){var integrations=KAMPYLE_DATA.getInegrations()||{};var integrationData={};var currIntegration;for(var integrationType in integrations){if(integrations.hasOwnProperty(integrationType)){var currIntegrationType=integrations[integrationType];for(var i=0;i<currIntegrationType.length;i++){currIntegration=currIntegrationType[i];if(isEnabled(currIntegration)){integrationData[integrationType]=integrationData[integrationType]||[];integrationData[integrationType].push(prepareIntegrationData(currIntegration));}}}}
return integrationData;}
return{isEnabled:isEnabled,prepareIntegrationData:prepareIntegrationData,getParameterBySource:getParameterBySource,getIntegrationData:getIntegrationData,};})();KAMPYLE_FUNC.init();KAMPYLE_FUNC.startCheckingTargeting();