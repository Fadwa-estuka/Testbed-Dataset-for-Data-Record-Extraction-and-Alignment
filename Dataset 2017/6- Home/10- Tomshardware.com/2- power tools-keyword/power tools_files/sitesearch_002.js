!function(a){function b(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function c(a){return"undefined"==typeof a}var d={},e=a.TraceKit,f=[].slice,g="?";d.noConflict=function(){return a.TraceKit=e,d},d.wrap=function(a){function b(){try{return a.apply(this,arguments)}catch(b){throw d.report(b),b}}return b},d.report=function(){function c(a){i(),m.push(a)}function e(a){for(var b=m.length-1;b>=0;--b)m[b]===a&&m.splice(b,1)}function g(a,c){var e=null;if(!c||d.collectWindowErrors){for(var g in m)if(b(m,g))try{m[g].apply(null,[a].concat(f.call(arguments,2)))}catch(h){e=h}if(e)throw e}}function h(a,b,c){var e=null;if(o)d.computeStackTrace.augmentStackTraceWithInitialElement(o,b,c,a),e=o,o=null,n=null;else{var f={url:b,line:c};f.func=d.computeStackTrace.guessFunctionName(f.url,f.line),f.context=d.computeStackTrace.gatherContext(f.url,f.line),e={mode:"onerror",message:a,url:document.location.href,stack:[f],useragent:navigator.userAgent}}return g(e,"from window.onerror"),k?k.apply(this,arguments):!1}function i(){l!==!0&&(k=a.onerror,a.onerror=h,l=!0)}function j(b){var c=f.call(arguments,1);if(o){if(n===b)return;var e=o;o=null,n=null,g.apply(null,[e,null].concat(c))}var h=d.computeStackTrace(b);throw o=h,n=b,a.setTimeout(function(){n===b&&(o=null,n=null,g.apply(null,[h,null].concat(c)))},h.incomplete?2e3:0),b}var k,l,m=[],n=null,o=null;return j.subscribe=c,j.unsubscribe=e,j}(),d.computeStackTrace=function(){function e(b){function c(){try{return new a.XMLHttpRequest}catch(b){return new a.ActiveXObject("Microsoft.XMLHTTP")}}if(!d.remoteFetching)return"";try{var e=c();return e.open("GET",b,!1),e.send(""),e.responseText}catch(f){return""}}function f(a){if(!b(w,a)){var c="";-1!==a.indexOf(document.domain)&&(c=e(a)),w[a]=c?c.split("\n"):[]}return w[a]}function h(a,b){var d,e=/function ([^(]*)\(([^)]*)\)/,h=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,i="",j=10,k=f(a);if(!k.length)return g;for(var l=0;j>l;++l)if(i=k[b-l]+i,!c(i)){if(d=h.exec(i))return d[1];if(d=e.exec(i))return d[1]}return g}function i(a,b){var e=f(a);if(!e.length)return null;var g=[],h=Math.floor(d.linesOfContext/2),i=h+d.linesOfContext%2,j=Math.max(0,b-h-1),k=Math.min(e.length,b+i-1);b-=1;for(var l=j;k>l;++l)c(e[l])||g.push(e[l]);return g.length>0?g:null}function j(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,"\\$&")}function k(a){return j(a).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function l(a,b){for(var c,d,e=0,g=b.length;g>e;++e)if((c=f(b[e])).length&&(c=c.join("\n"),d=a.exec(c)))return{url:b[e],line:c.substring(0,d.index).split("\n").length,column:d.index-c.lastIndexOf("\n",d.index)-1};return null}function m(a,b,c){var d,e=f(b),g=new RegExp("\\b"+j(a)+"\\b");return c-=1,e&&e.length>c&&(d=g.exec(e[c]))?d.index:null}function n(b){for(var c,d,e,f,g=[a.location.href],h=document.getElementsByTagName("script"),i=""+b,m=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]*)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,n=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,o=0;o<h.length;++o){var p=h[o];p.src&&g.push(p.src)}if(e=m.exec(i)){var q=e[1]?"\\s+"+e[1]:"",r=e[2].split(",").join("\\s*,\\s*");c=j(e[3]).replace(/;$/,";?"),d=new RegExp("function"+q+"\\s*\\(\\s*"+r+"\\s*\\)\\s*{\\s*"+c+"\\s*}")}else d=new RegExp(j(i).replace(/\s+/g,"\\s+"));if(f=l(d,g))return f;if(e=n.exec(i)){var s=e[1];if(c=k(e[2]),d=new RegExp("on"+s+"=[\\'\"]\\s*"+c+"\\s*[\\'\"]","i"),f=l(d,g[0]))return f;if(d=new RegExp(c),f=l(d,g))return f}return null}function o(a){if(!a.stack)return null;for(var b,c,d=/^\s*at (?:((?:\[object object\])?\S+) )?\(?((?:file|http|https):.*?):(\d+)(?::(\d+))?\)?\s*$/i,e=/^\s*(\S*)(?:\((.*?)\))?@((?:file|http|https).*?):(\d+)(?::(\d+))?\s*$/i,f=a.stack.split("\n"),j=[],k=/^(.*) is undefined$/.exec(a.message),l=0,n=f.length;n>l;++l){if(b=e.exec(f[l]))c={url:b[3],func:b[1]||g,args:b[2]?b[2].split(","):"",line:+b[4],column:b[5]?+b[5]:null};else{if(!(b=d.exec(f[l])))continue;c={url:b[2],func:b[1]||g,line:+b[3],column:b[4]?+b[4]:null}}!c.func&&c.line&&(c.func=h(c.url,c.line)),c.line&&(c.context=i(c.url,c.line)),j.push(c)}return j[0]&&j[0].line&&!j[0].column&&k&&(j[0].column=m(k[1],j[0].url,j[0].line)),j.length?{mode:"stack",name:a.name,message:a.message,url:document.location.href,stack:j,useragent:navigator.userAgent}:null}function p(a){for(var b,c=a.stacktrace,d=/ line (\d+), column (\d+) in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\) in (.*):\s*$/i,e=c.split("\n"),f=[],g=0,j=e.length;j>g;g+=2)if(b=d.exec(e[g])){var k={line:+b[1],column:+b[2],func:b[3]||b[4],args:b[5]?b[5].split(","):[],url:b[6]};if(!k.func&&k.line&&(k.func=h(k.url,k.line)),k.line)try{k.context=i(k.url,k.line)}catch(l){}k.context||(k.context=[e[g+1]]),f.push(k)}return f.length?{mode:"stacktrace",name:a.name,message:a.message,url:document.location.href,stack:f,useragent:navigator.userAgent}:null}function q(c){var d=c.message.split("\n");if(d.length<4)return null;var e,g,j,m,n=/^\s*Line (\d+) of linked script ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,o=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,p=/^\s*Line (\d+) of function script\s*$/i,q=[],r=document.getElementsByTagName("script"),s=[];for(g in r)b(r,g)&&!r[g].src&&s.push(r[g]);for(g=2,j=d.length;j>g;g+=2){var t=null;if(e=n.exec(d[g]))t={url:e[2],func:e[3],line:+e[1]};else if(e=o.exec(d[g])){t={url:e[3],func:e[4]};var u=+e[1],v=s[e[2]-1];if(v&&(m=f(t.url))){m=m.join("\n");var w=m.indexOf(v.innerText);w>=0&&(t.line=u+m.substring(0,w).split("\n").length)}}else if(e=p.exec(d[g])){var x=a.location.href.replace(/#.*$/,""),y=e[1],z=new RegExp(k(d[g+1]));m=l(z,[x]),t={url:x,line:m?m.line:y,func:""}}if(t){t.func||(t.func=h(t.url,t.line));var A=i(t.url,t.line),B=A?A[Math.floor(A.length/2)]:null;t.context=A&&B.replace(/^\s*/,"")===d[g+1].replace(/^\s*/,"")?A:[d[g+1]],q.push(t)}}return q.length?{mode:"multiline",name:c.name,message:d[0],url:document.location.href,stack:q,useragent:navigator.userAgent}:null}function r(a,b,c,d){var e={url:b,line:c};if(e.url&&e.line){a.incomplete=!1,e.func||(e.func=h(e.url,e.line)),e.context||(e.context=i(e.url,e.line));var f=/ '([^']+)' /.exec(d);if(f&&(e.column=m(f[1],e.url,e.line)),a.stack.length>0&&a.stack[0].url===e.url){if(a.stack[0].line===e.line)return!1;if(!a.stack[0].line&&a.stack[0].func===e.func)return a.stack[0].line=e.line,a.stack[0].context=e.context,!1}return a.stack.unshift(e),a.partial=!0,!0}return a.incomplete=!0,!1}function s(a,b){for(var c,e,f,i=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,j=[],k={},l=!1,o=s.caller;o&&!l;o=o.caller)if(o!==t&&o!==d.report){if(e={url:null,func:g,line:null,column:null},o.name?e.func=o.name:(c=i.exec(o.toString()))&&(e.func=c[1]),f=n(o)){e.url=f.url,e.line=f.line,e.func===g&&(e.func=h(e.url,e.line));var p=/ '([^']+)' /.exec(a.message||a.description);p&&(e.column=m(p[1],f.url,f.line))}k[""+o]?l=!0:k[""+o]=!0,j.push(e)}b&&j.splice(0,b);var q={mode:"callers",name:a.name,message:a.message,url:document.location.href,stack:j,useragent:navigator.userAgent};return r(q,a.sourceURL||a.fileName,a.line||a.lineNumber,a.message||a.description),q}function t(a,b){var c=null;b=null==b?0:+b;try{if(c=p(a))return c}catch(d){if(v)throw d}try{if(c=o(a))return c}catch(d){if(v)throw d}try{if(c=q(a))return c}catch(d){if(v)throw d}try{if(c=s(a,b+1))return c}catch(d){if(v)throw d}return{mode:"failed"}}function u(a){a=(null==a?0:+a)+1;try{throw new Error}catch(b){return t(b,a+1)}return null}var v=!1,w={};return t.augmentStackTraceWithInitialElement=r,t.guessFunctionName=h,t.gatherContext=i,t.ofCaller=u,t}(),d.remoteFetching||(d.remoteFetching=!0),d.collectWindowErrors||(d.collectWindowErrors=!0),(!d.linesOfContext||d.linesOfContext<1)&&(d.linesOfContext=7),a.TraceKit=d}(window),function(a,b){"use strict";function c(a,b){var c,d;b=b||{},a="raven"+a.substr(0,1).toUpperCase()+a.substr(1),document.createEvent?(c=document.createEvent("HTMLEvents"),c.initEvent(a,!0,!0)):(c=document.createEventObject(),c.eventType=a);for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);if(document.createEvent)document.dispatchEvent(c);else try{document.fireEvent("on"+c.eventType.toLowerCase(),c)}catch(e){}}function d(a){this.name="RavenConfigError",this.message=a}function e(a){var b=F.exec(a),c={},e=7;try{for(;e--;)c[E[e]]=b[e]||""}catch(f){throw new d("Invalid DSN: "+a)}if(c.pass)throw new d("Do not specify your private key in the DSN!");return c}function f(a){return"undefined"==typeof a}function g(a){return"function"==typeof a}function h(a){return"string"==typeof a}function i(a,b){var c,d;if(f(a.length))for(c in a)a.hasOwnProperty(c)&&b.call(null,c,a[c]);else if(d=a.length)for(c=0;d>c;c++)b.call(null,c,a[c])}function j(){if(G)return G;var a=["sentry_version=4","sentry_client=raven-js/"+D.VERSION];return x&&a.push("sentry_key="+x),G="?"+a.join("&")}function k(a,b){var d=[];a.stack&&a.stack.length&&i(a.stack,function(a,b){var c=l(b);c&&d.push(c)}),c("handle",{stackInfo:a,options:b}),n(a.name,a.message,a.url,a.lineno,d,b)}function l(a){if(a.url){var b,c={filename:a.url,lineno:a.line,colno:a.column,"function":a.func||"?"},d=m(a);if(d){var e=["pre_context","context_line","post_context"];for(b=3;b--;)c[e[b]]=d[b]}return c.in_app=!(!B.includePaths.test(c.filename)||/(Raven|TraceKit)\./.test(c["function"])||/raven\.(min\.)js$/.test(c.filename)),c}}function m(a){if(a.context&&B.fetchContext){for(var b=a.context,c=~~(b.length/2),d=b.length,e=!1;d--;)if(b[d].length>300){e=!0;break}if(e){if(f(a.column))return;return[[],b[c].substr(a.column,50),[]]}return[b.slice(0,c),b[c],b.slice(c+1)]}}function n(a,b,c,d,e,f){var g,h;b&&(B.ignoreErrors.test(b)||(e&&e.length?(g={frames:e},c=c||e[0].filename):c&&(g={frames:[{filename:c,lineno:d}]}),B.ignoreUrls&&B.ignoreUrls.test(c)||(!B.whitelistUrls||B.whitelistUrls.test(c))&&(h=d?b+" at "+d:b,q(o({exception:{type:a,value:b},stacktrace:g,culprit:c,message:h},f)))))}function o(a,b){return b?(i(b,function(b,c){a[b]=c}),a):a}function p(){var a={url:document.location.href,headers:{"User-Agent":navigator.userAgent}};return document.referrer&&(a.headers.Referer=document.referrer),a}function q(a){s()&&(a=o({project:y,logger:B.logger,site:B.site,platform:"javascript",request:p()},a),a.tags=o(B.tags,a.tags),a.extra=o(B.extra,a.extra),a.tags||delete a.tags,a.extra||delete a.extra,w&&(a.user=w),g(B.dataCallback)&&(a=B.dataCallback(a)),(!g(B.shouldSendCallback)||B.shouldSendCallback(a))&&r(a))}function r(a){var b=new Image,d=v+j()+"&sentry_data="+encodeURIComponent(JSON.stringify(a));b.onload=function(){c("success",{data:a,src:d})},b.onerror=b.onabort=function(){c("failure",{data:a,src:d})},b.src=d}function s(){return A?v?!0:(a.console&&console.error&&console.error("Error: Raven has not been configured."),!1):!1}function t(a){for(var b=[],c=a.length;c--;)b[c]=h(a[c])?a[c].replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"):a[c].source;return new RegExp(b.join("|"),"i")}var u,v,w,x,y,z=a.Raven,A=!(!a.JSON||!a.JSON.stringify),B={logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],collectWindowErrors:!0,tags:{},extra:{}},C=TraceKit.noConflict();C.remoteFetching=!1;var D={VERSION:"1.1.2",TraceKit:C,afterLoad:function(){var b=a.RavenConfig;b&&this.config(b.dsn,b.config).install()},noConflict:function(){return a.Raven=z,D},config:function(a,b){var c=e(a),d=c.path.lastIndexOf("/"),f=c.path.substr(1,d);return b&&i(b,function(a,b){B[a]=b}),B.ignoreErrors.push("Script error."),B.ignoreErrors.push("Script error"),B.ignoreErrors=t(B.ignoreErrors),B.ignoreUrls=B.ignoreUrls.length?t(B.ignoreUrls):!1,B.whitelistUrls=B.whitelistUrls.length?t(B.whitelistUrls):!1,B.includePaths=t(B.includePaths),x=c.user,y=~~c.path.substr(d+1),v="//"+c.host+(c.port?":"+c.port:"")+"/"+f+"api/"+y+"/store/",c.protocol&&(v=c.protocol+":"+v),B.fetchContext&&(C.remoteFetching=!0),B.linesOfContext&&(C.linesOfContext=B.linesOfContext),C.collectWindowErrors=!!B.collectWindowErrors,D},install:function(){return s()?(C.report.subscribe(k),D):void 0},context:function(a,c,d){return g(a)&&(d=c||[],c=a,a=b),D.wrap(a,c).apply(this,d)},wrap:function(a,c){function d(){for(var b=[],d=arguments.length;d--;)b[d]=D.wrap(a,arguments[d]);try{return c.apply(this,b)}catch(e){throw D.captureException(e,a),e}}if(f(c)&&!g(a))return a;if(g(a)&&(c=a,a=b),!g(c))return c;if(c.__raven__)return c;for(var e in c)c.hasOwnProperty(e)&&(d[e]=c[e]);return d.__raven__=!0,d},uninstall:function(){return C.report.unsubscribe(k),D},captureException:function(a,b){if(h(a))return D.captureMessage(a,b);u=a;try{C.report(a,b)}catch(c){if(a!==c)throw c}return D},captureMessage:function(a,b){return q(o({message:a},b)),D},setUser:function(a){return w=a,D},lastException:function(){return u}},E="source protocol user pass host port path".split(" "),F=/^(?:(\w+):)?\/\/(\w+)(:\w+)?@([\w\.-]+)(?::(\d+))?(\/.*)/;d.prototype=new Error,d.prototype.constructor=d;var G;D.afterLoad(),a.Raven=D,"function"==typeof define&&define.amd&&define("raven",[],function(){return D.noConflict()})}(window),function(a,b,c){"use strict";if(c){var d=c.event.add;c.event.add=function(a,e,f,g,h){var i;return f&&f.handler?(i=f.handler,f.handler=b.wrap(f.handler)):(i=f,f=b.wrap(f)),f.guid=i.guid?i.guid:i.guid=c.guid++,d.call(this,a,e,f,g,h)};var e=c.fn.ready;c.fn.ready=function(a){return e.call(this,b.wrap(a))};var f=c.ajax;c.ajax=function(a,d){var e,g=["complete","error","success"];for("object"==typeof a&&(d=a,a=void 0),d=d||{};e=g.pop();)c.isFunction(d[e])&&(d[e]=b.wrap(d[e]));try{return f.call(this,a,d)}catch(h){throw b.captureException(h),h}}}}(this,Raven,window.jQuery),function(a,b){"use strict";var c=function(c){var d=a[c];a[c]=function(){var a=[].slice.call(arguments),c=a[0];return"function"==typeof c&&(a[0]=b.wrap(c)),d.apply?d.apply(this,a):d(a[0],a[1])}};c("setTimeout"),c("setInterval")}(this,Raven);(function($){'use strict';BOM=BOM||{};BOM.Tools=BOM.Tools||{};BOM.Tools.RavenConfig=function(conf){this.conf=$.extend({url:null,culture:null,env:null,assets:null,assetsRevision:null,userId:null},conf);if(typeof Raven!=='undefined'&&this.conf.url!==null){this.init()}};BOM.Tools.RavenConfig.prototype={init:function(){var url=this.conf.url;var culture=this.conf.culture;var env=this.conf.env;var assets=this.conf.assets;var assetsRevision=this.conf.assetsRevision;var userId=this.conf.userId;Raven.config(url,{whitelistUrls:[/tomshardware\.com/,/tomshardware\.co\.uk/,/tomshardware\.fr/,/tomshardware\.de/,/tomsguide\.com/,/tomsguide\.fr/],tags:{culture:culture,env:env,assets:assets,assetsRevision:assetsRevision}}).install();Raven.setUser({id:userId})}};BOM.Tools.RavenConfig.initModule=function(conf){conf=conf||BOM.Tools.RavenConfigConf||{};new BOM.Tools.RavenConfig(conf)};BOM.Tools.RavenConfig.initModule()}(jQuery));﻿(function(n,t){"use strict";function r(n){a[a.length]=n}function k(n){var t=new RegExp(" ?\\b"+n+"\\b");c.className=c.className.replace(t,"")}function p(n,t){for(var i=0,r=n.length;i<r;i++)t.call(n,n[i],i)}function tt(){var t,e,f,o;c.className=c.className.replace(/ (w-|eq-|gt-|gte-|lt-|lte-|portrait|no-portrait|landscape|no-landscape)\d+/g,"");t=n.innerWidth||c.clientWidth;e=n.outerWidth||n.screen.width;u.screen.innerWidth=t;u.screen.outerWidth=e;r("w-"+t);p(i.screens,function(n){t>n?(i.screensCss.gt&&r("gt-"+n),i.screensCss.gte&&r("gte-"+n)):t<n?(i.screensCss.lt&&r("lt-"+n),i.screensCss.lte&&r("lte-"+n)):t===n&&(i.screensCss.lte&&r("lte-"+n),i.screensCss.eq&&r("e-q"+n),i.screensCss.gte&&r("gte-"+n))});f=n.innerHeight||c.clientHeight;o=n.outerHeight||n.screen.height;u.screen.innerHeight=f;u.screen.outerHeight=o;u.feature("portrait",f>t);u.feature("landscape",f<t)}function it(){n.clearTimeout(b);b=n.setTimeout(tt,50)}var y=n.document,rt=n.navigator,ut=n.location,c=y.documentElement,a=[],i={screens:[240,320,480,640,768,800,1024,1280,1440,1680,1920],screensCss:{gt:!0,gte:!1,lt:!0,lte:!1,eq:!1},browsers:[{ie:{min:6,max:11}}],browserCss:{gt:!0,gte:!1,lt:!0,lte:!1,eq:!0},html5:!0,page:"-page",section:"-section",head:"head"},v,u,s,w,o,h,l,d,f,g,nt,e,b;if(n.head_conf)for(v in n.head_conf)n.head_conf[v]!==t&&(i[v]=n.head_conf[v]);u=n[i.head]=function(){u.ready.apply(null,arguments)};u.feature=function(n,t,i){return n?(Object.prototype.toString.call(t)==="[object Function]"&&(t=t.call()),r((t?"":"no-")+n),u[n]=!!t,i||(k("no-"+n),k(n),u.feature()),u):(c.className+=" "+a.join(" "),a=[],u)};u.feature("js",!0);s=rt.userAgent.toLowerCase();w=/mobile|android|kindle|silk|midp|phone/.test(s);u.feature("mobile",w,!0);u.feature("desktop",!w,!0);s=/(chrome|firefox)[ \/]([\w.]+)/.exec(s)||/(iphone|ipad|ipod)(?:.*version)?[ \/]([\w.]+)/.exec(s)||/(android)(?:.*version)?[ \/]([\w.]+)/.exec(s)||/(webkit|opera)(?:.*version)?[ \/]([\w.]+)/.exec(s)||/(msie) ([\w.]+)/.exec(s)||/(trident).+rv:(\w.)+/.exec(s)||[];o=s[1];h=parseFloat(s[2]);switch(o){case"msie":case"trident":o="ie";h=y.documentMode||h;break;case"firefox":o="ff";break;case"ipod":case"ipad":case"iphone":o="ios";break;case"webkit":o="safari"}for(u.browser={name:o,version:h},u.browser[o]=!0,l=0,d=i.browsers.length;l<d;l++)for(f in i.browsers[l])if(o===f)for(r(f),g=i.browsers[l][f].min,nt=i.browsers[l][f].max,e=g;e<=nt;e++)h>e?(i.browserCss.gt&&r("gt-"+f+e),i.browserCss.gte&&r("gte-"+f+e)):h<e?(i.browserCss.lt&&r("lt-"+f+e),i.browserCss.lte&&r("lte-"+f+e)):h===e&&(i.browserCss.lte&&r("lte-"+f+e),i.browserCss.eq&&r("eq-"+f+e),i.browserCss.gte&&r("gte-"+f+e));else r("no-"+f);r(o);r(o+parseInt(h,10));i.html5&&o==="ie"&&h<9&&p("abbr|article|aside|audio|canvas|details|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|progress|section|summary|time|video".split("|"),function(n){y.createElement(n)});p(ut.pathname.split("/"),function(n,u){if(this.length>2&&this[u+1]!==t)u&&r(this.slice(u,u+1).join("-").toLowerCase()+i.section);else{var f=n||"index",e=f.indexOf(".");e>0&&(f=f.substring(0,e));c.id=f.toLowerCase()+i.page;u||r("root"+i.section)}});u.screen={height:n.screen.height,width:n.screen.width};tt();b=0;n.addEventListener?n.addEventListener("resize",it,!1):n.attachEvent("onresize",it)})(window);(function(n,t){"use strict";function a(n){for(var r in n)if(i[n[r]]!==t)return!0;return!1}function r(n){var t=n.charAt(0).toUpperCase()+n.substr(1),i=(n+" "+c.join(t+" ")+t).split(" ");return!!a(i)}var h=n.document,o=h.createElement("i"),i=o.style,s=" -o- -moz- -ms- -webkit- -khtml- ".split(" "),c="Webkit Moz O ms Khtml".split(" "),l=n.head_conf&&n.head_conf.head||"head",u=n[l],f={gradient:function(){var n="background-image:";return i.cssText=(n+s.join("gradient(linear,left top,right bottom,from(#9f9),to(#fff));"+n)+s.join("linear-gradient(left top,#eee,#fff);"+n)).slice(0,-n.length),!!i.backgroundImage},rgba:function(){return i.cssText="background-color:rgba(0,0,0,0.5)",!!i.backgroundColor},opacity:function(){return o.style.opacity===""},textshadow:function(){return i.textShadow===""},multiplebgs:function(){i.cssText="background:url(https://),url(https://),red url(https://)";var n=(i.background||"").match(/url/g);return Object.prototype.toString.call(n)==="[object Array]"&&n.length===3},boxshadow:function(){return r("boxShadow")},borderimage:function(){return r("borderImage")},borderradius:function(){return r("borderRadius")},cssreflections:function(){return r("boxReflect")},csstransforms:function(){return r("transform")},csstransitions:function(){return r("transition")},touch:function(){return"ontouchstart"in n},retina:function(){return n.devicePixelRatio>1},fontface:function(){var t=u.browser.name,n=u.browser.version;switch(t){case"ie":return n>=9;case"chrome":return n>=13;case"ff":return n>=6;case"ios":return n>=5;case"android":return!1;case"webkit":return n>=5.1;case"opera":return n>=10;default:return!1}}};for(var e in f)f[e]&&u.feature(e,f[e].call(),!0);u.feature()})(window);(function(n,t){"use strict";function w(){}function u(n,t){if(n){typeof n=="object"&&(n=[].slice.call(n));for(var i=0,r=n.length;i<r;i++)t.call(n,n[i],i)}}function it(n,i){var r=Object.prototype.toString.call(i).slice(8,-1);return i!==t&&i!==null&&r===n}function s(n){return it("Function",n)}function a(n){return it("Array",n)}function et(n){var i=n.split("/"),t=i[i.length-1],r=t.indexOf("?");return r!==-1?t.substring(0,r):t}function f(n){(n=n||w,n._done)||(n(),n._done=1)}function ot(n,t,r,u){var f=typeof n=="object"?n:{test:n,success:!t?!1:a(t)?t:[t],failure:!r?!1:a(r)?r:[r],callback:u||w},e=!!f.test;return e&&!!f.success?(f.success.push(f.callback),i.load.apply(null,f.success)):e||!f.failure?u():(f.failure.push(f.callback),i.load.apply(null,f.failure)),i}function v(n){var t={},i,r;if(typeof n=="object")for(i in n)!n[i]||(t={name:i,url:n[i]});else t={name:et(n),url:n};return(r=c[t.name],r&&r.url===t.url)?r:(c[t.name]=t,t)}function y(n){n=n||c;for(var t in n)if(n.hasOwnProperty(t)&&n[t].state!==l)return!1;return!0}function st(n){n.state=ft;u(n.onpreload,function(n){n.call()})}function ht(n){n.state===t&&(n.state=nt,n.onpreload=[],rt({url:n.url,type:"cache"},function(){st(n)}))}function ct(){var n=arguments,t=n[n.length-1],r=[].slice.call(n,1),f=r[0];return(s(t)||(t=null),a(n[0]))?(n[0].push(t),i.load.apply(null,n[0]),i):(f?(u(r,function(n){s(n)||!n||ht(v(n))}),b(v(n[0]),s(f)?f:function(){i.load.apply(null,r)})):b(v(n[0])),i)}function lt(){var n=arguments,t=n[n.length-1],r={};return(s(t)||(t=null),a(n[0]))?(n[0].push(t),i.load.apply(null,n[0]),i):(u(n,function(n){n!==t&&(n=v(n),r[n.name]=n)}),u(n,function(n){n!==t&&(n=v(n),b(n,function(){y(r)&&f(t)}))}),i)}function b(n,t){if(t=t||w,n.state===l){t();return}if(n.state===tt){i.ready(n.name,t);return}if(n.state===nt){n.onpreload.push(function(){b(n,t)});return}n.state=tt;rt(n,function(){n.state=l;t();u(h[n.name],function(n){f(n)});o&&y()&&u(h.ALL,function(n){f(n)})})}function at(n){n=n||"";var t=n.split("?")[0].split(".");return t[t.length-1].toLowerCase()}function rt(t,i){function e(t){t=t||n.event;u.onload=u.onreadystatechange=u.onerror=null;i()}function o(f){f=f||n.event;(f.type==="load"||/loaded|complete/.test(u.readyState)&&(!r.documentMode||r.documentMode<9))&&(n.clearTimeout(t.errorTimeout),n.clearTimeout(t.cssTimeout),u.onload=u.onreadystatechange=u.onerror=null,i())}function s(){if(t.state!==l&&t.cssRetries<=20){for(var i=0,f=r.styleSheets.length;i<f;i++)if(r.styleSheets[i].href===u.href){o({type:"load"});return}t.cssRetries++;t.cssTimeout=n.setTimeout(s,250)}}var u,h,f;i=i||w;h=at(t.url);h==="css"?(u=r.createElement("link"),u.type="text/"+(t.type||"css"),u.rel="stylesheet",u.href=t.url,t.cssRetries=0,t.cssTimeout=n.setTimeout(s,500)):(u=r.createElement("script"),u.type="text/"+(t.type||"javascript"),u.src=t.url);u.onload=u.onreadystatechange=o;u.onerror=e;u.async=!1;u.defer=!1;t.errorTimeout=n.setTimeout(function(){e({type:"timeout"})},7e3);f=r.head||r.getElementsByTagName("head")[0];f.insertBefore(u,f.lastChild)}function vt(){for(var t,u=r.getElementsByTagName("script"),n=0,f=u.length;n<f;n++)if(t=u[n].getAttribute("data-headjs-load"),!!t){i.load(t);return}}function yt(n,t){var v,p,e;return n===r?(o?f(t):d.push(t),i):(s(n)&&(t=n,n="ALL"),a(n))?(v={},u(n,function(n){v[n]=c[n];i.ready(n,function(){y(v)&&f(t)})}),i):typeof n!="string"||!s(t)?i:(p=c[n],p&&p.state===l||n==="ALL"&&y()&&o)?(f(t),i):(e=h[n],e?e.push(t):e=h[n]=[t],i)}function e(){if(!r.body){n.clearTimeout(i.readyTimeout);i.readyTimeout=n.setTimeout(e,50);return}o||(o=!0,vt(),u(d,function(n){f(n)}))}function k(){r.addEventListener?(r.removeEventListener("DOMContentLoaded",k,!1),e()):r.readyState==="complete"&&(r.detachEvent("onreadystatechange",k),e())}var r=n.document,d=[],h={},c={},ut="async"in r.createElement("script")||"MozAppearance"in r.documentElement.style||n.opera,o,g=n.head_conf&&n.head_conf.head||"head",i=n[g]=n[g]||function(){i.ready.apply(null,arguments)},nt=1,ft=2,tt=3,l=4,p;if(r.readyState==="complete")e();else if(r.addEventListener)r.addEventListener("DOMContentLoaded",k,!1),n.addEventListener("load",e,!1);else{r.attachEvent("onreadystatechange",k);n.attachEvent("onload",e);p=!1;try{p=!n.frameElement&&r.documentElement}catch(wt){}p&&p.doScroll&&function pt(){if(!o){try{p.doScroll("left")}catch(t){n.clearTimeout(i.readyTimeout);i.readyTimeout=n.setTimeout(pt,50);return}e()}}()}i.load=i.js=ut?lt:ct;i.test=ot;i.ready=yt;i.ready(r,function(){y()&&u(h.ALL,function(n){f(n)});i.feature&&i.feature("domloaded",!0)})})(window);$('html').addClass('js');var BOM=BOM||{};BOM.config=BOM.config?BOM.config:{"enabledModules":[],"trads":{}};BOM.namespace=function(){var a=arguments,o=null,i,j,d;for(i=0;i<a.length;i=i+1){d=(""+a[i]).split(".");o=BOM;for(j=(d[0]==="BOM")?1:0;j<d.length;j=j+1){o[d[j]]=o[d[j]]||{};o=o[d[j]]}}return o};BOM.UI={'oTabs':[],'oCarousels':[],'oDropdowns':[],'oToggleLayerCtls':[],'oDialog':[]};BOM.namespace('BOM.User','BOM.AjaxDialog','BOM.AjaxDialogLogin','BOM.Utils','BOM.Toggle','BOM.BBCodeEditor','BOM.Markitup','BOM.SyntaxHighlighter','BOM.Forum','BOM.TechSupport','BOM.Spellchecker','BOM.Moderation','BOM.Xiti','BOM.Widget','BOM.TagPage','BOM.Tag','BOM.Follow','BOM.User.Dialog');BOM.config.culture='en';BOM.Metrics={setStartTime:function(){},setEndTime:function(){}};BOM.Utils.decode=function(sBase64){if((sBase64===undefined)||(sBase64=="")){return""}var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var output="";var i=0;sBase64=sBase64.replace(/-/g,"+").replace(/_/g,"=").replace(/\./g,"/");if(sBase64.match("/[^A-Za-z0-9+\\/=]/")){return""}do{enc1=keyStr.indexOf(sBase64.charAt(i++));enc2=keyStr.indexOf(sBase64.charAt(i++));enc3=keyStr.indexOf(sBase64.charAt(i++));enc4=keyStr.indexOf(sBase64.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output+=String.fromCharCode(chr1);if(enc3!==64){output+=String.fromCharCode(chr2)}if(enc4!==64){output+=String.fromCharCode(chr3)}chr1=chr2=chr3=enc1=enc2=enc3=enc4=""}while(i<sBase64.length);output=output.replace(/&amp;/gi,"&");return output};BOM=BOM||{};BOM.config=BOM.config||{};BOM.config.assets=BOM.Utils.decode('aHR0cDovL20uYmVzdG9mbWVkaWEuY29tL3NmcC8=');BOM.Utils.go=function(sUrl,bOpenInPopup,bEncoded){sUrl=((typeof bEncoded==='undefined')||bEncoded==true)?BOM.Utils.decode(sUrl):sUrl;if(bOpenInPopup){var op="scrollbars=yes,toolbar=yes,location=yes,directories=yes,menubar=yes,resizable=yes,status=yes,width=960,height=600";window.open(sUrl,"",op)}else{window.location.href=sUrl}};BOM.Utils.decodeLive=function(sUrl,elm){sUrl=BOM.Utils.decode(sUrl);var elt=$(elm);if(elt.attr('hash')){sUrl+=elt.attr('hash')}else{if(typeof $.fn.prop!=='undefined'&&elt.prop('hash')){sUrl+=elt.prop('hash')}}elt.attr('href',sUrl);elt.removeAttr('onmouseover')};BOM.Utils.decodeLiveAndWrap=function(sUrl,elm){sUrl=BOM.Utils.decode(sUrl);var $elt=$(elm);if($elt.attr('hash')){sUrl+=$elt.attr('hash')}else{if(typeof $.fn.prop!=='undefined'&&$elt.prop('hash')){sUrl+=$elt.prop('hash')}}var $a=$('<a/>');$elt.each(function(){var attributes=$.map(this.attributes,function(item){return{name:item.name,value:item.value}});var elt=$(this);$.each(attributes,function(i,item){if(item.name&&item.name!=="onmouseover"){$a.attr(item.name,item.value)}elt.removeAttr(item.name)})});$a.attr('href',sUrl);$elt.wrap($a)};BOM.Utils.userAgent=navigator.userAgent;BOM.Utils.loaded=(typeof(head)==='function'&&$('body.mobile').length===0&&$('body.tablet').length===0)?head.ready:$(window).load;BOM.Utils.loadScriptHeadJS=function(encodedUrl,callback){if(typeof(head)==='function'){if(typeof(BOM.Utils.loaded)==='function'){BOM.Utils.loaded(function(){head.js(BOM.Utils.decode(encodedUrl),function(){callback()})})}else{head.js(BOM.Utils.decode(encodedUrl),callback)}}};BOM.Utils.loadScript=(BOM.Utils.loadScript)?BOM.Utils.loadScript:BOM.Utils.loadScriptHeadJS;(function($){'use strict';BOM.namespace('BOM.Utils.addScript');BOM.utils={};BOM.Utils.addScript=function(sId,sUrl,sCallBack,sCallBackConf,async){var done=false;var script=BOM.Utils.createNewScriptNode(sId,sUrl,async);BOM.Utils.executeCallBack(script,sCallBack,sCallBackConf,done)};BOM.Utils.executeCallBack=function(script,sCallBack,sCallBackConf,done){if(typeof sCallBack==='function'){if($.browser.msie){script.onreadystatechange=function(){if(!done&&(script.readyState==='complete'||script.readyState==='loaded')){sCallBack(sCallBackConf);done=true}}}else{script.onload=function(){sCallBack(sCallBackConf)}}}};BOM.Utils.createNewScriptNode=function(sId,sUrl,async){var old=document.getElementById(sId);if(old !=null&&old.parentNode!=null){old.parentNode.removeChild(old)}var script=document.createElement('script');script.id=sId;script.type='text/javascript';script.src=sUrl;script.async=async?async:false;script.defer=false;var s=document.getElementsByTagName('script')[0];s.parentNode.appendChild(script);return script}}(jQuery));BOM.Utils.templating=new function(){var cache={};this.init=function(){this.cache={}};this.render=function(str,data){var fn=!(/\W/.test(str))?cache[str]=cache[str]||this.render(document.getElementById(str).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+str.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'").replace(/data-href/gm,'href')+"');}return p.join('');");return data?fn(data):fn}}();BOM.config.readyLoader=BOM.config.readyLoader||[];BOM.Utils.readyLoader=function(oConf){var self=this;self.init=function(oConf){this.add(oConf)};self.add=function(oConf){for(var i=0;i<oConf.length;i++){if('function'===typeof oConf[i][0]&&'undefined'!==typeof oConf[i][0]){if(1<oConf[i].length){oConf[i][0](oConf[i][1])}else{oConf[i][0]()}}}};self.init(oConf)};jQuery(document).ready(function(){BOM.Utils.readyLoader(BOM.config.readyLoader);if('function'===typeof jQuery.fn.lazyload){BOM.Utils.lazy()}if('function'===typeof BOM.Utils.lazyBom){BOM.Utils.lazyBom()}if(typeof BOM.Utils!=='undefined'&&typeof BOM.Utils.RefererIncluder!=='undefined'){new BOM.Utils.RefererIncluder()}});BOM.Utils.lazy=function(){if(jQuery('html.lt-ie8').length>0||jQuery('html.mobile').length>0||jQuery('body.mobile').length>0||jQuery('body.tablet').length>0){jQuery('.imgLz').each(function(){jQuery(this).removeClass('h').attr('src',jQuery(this).attr('data-src'))})}else{jQuery('.imgLz').lazyload({placeholder:"http://m.bestofmedia.com/sfp/images/design/beacons/lazy.png",effect:"fadeIn",threshold:200,failurelimit:50})}};templating=new function(){var cache={};this.init=function(el,userConfig){this.cache={}};this.render=function(str,data){return(data&&typeof str=='string')?this._render(str,data).replace(/data-href/gm,"href"):this._render(str,data)};this._render=function(str,data){var fn=!(/\W/.test(str))?cache[str]=cache[str]||this._render(document.getElementById(str).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+str.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return data?fn(data):fn}}();$(document).ready(function(){renderMTGam=function(){var templateDefault='<div class="sponsoredListing basicCentral clearfix">';templateDefault+='<ul class="simpleVison">';templateDefault+='<% for (i = 0; i < items.length; i++) { %>';templateDefault+='<li class="clearfix">';templateDefault+='<a href="<%= items[i].url %>" target="<%= items[i].targetLink %>" class="title3"><%= items[i].title %></a>';templateDefault+='<span class="dateElm"><%= items[i].date %> <%= items[i].time %></span>';templateDefault+='<a class="sponsoredTpl" href="<%= items[i].url %>" target="<%= items[i].targetLink %>"><img src="<%= items[i].img %>" border="0" alt="" /></a>';templateDefault+='<p> <%= items[i].description %> ';templateDefault+='<a href="<%= items[i].url %>" target="<%= items[i].targetLink %>"><%= items[i].more %></a>';templateDefault+='</p>';templateDefault+='</li>';templateDefault+='<% } %>';templateDefault+='</ul>';templateDefault+='</div>';if(typeof(Prototype)==='object'){var gamMt=$$('.gam-mt')}else{var gamMt=$(".gam-mt")}var y=0;var z=0;var l=gamMt.length-1;var blockGam={};var innerGam='';var c='';var mt='';var tpl='';var a=null;var infoByObject={};var item={};var data={};var items=new Array();this.init=function(){try{for(z=l;z>=0;z--){blockGam=gamMt[z];innerGam=blockGam.innerHTML;infoByObject={};items=new Array();a=innerGam.split("@@");for(y=0;y<a.length;y++){item={};item=this.decompose(a[y]);if(y==0){infoByObject=item}else{items.push(item)}}if(items.length==0){items.push(infoByObject)}data={};data={"items":items};if(typeof(data)==='object'){if(document.getElementById(infoByObject.template))tpl=infoByObject.template;else tpl=templateDefault;mt=templating.render(tpl,data);if(typeof(mt)==='string'){blockGam.innerHTML=mt;blockGam.style.display='block'}}}}catch(err){if('undefined'!=typeof console){console.log(err)}}};this.decompose=function(elements){var result={};var b=elements.split('|');for(var i=0;i<b.length;i++){var c=b[i].split('##');if(c[0]){result[c[0]]=c[1]}}return result};this.init()}()});(function(){'use strict';if(typeof BOM==='undefined'){BOM={}}if(typeof BOM.Utils==='undefined'){BOM.Utils={}}BOM.Utils.lazyBom=function(oConf){oConf=jQuery.extend({init:true,elementsAccessor:'.bomLz',offsetY:0,offsetX:0,delegateOn:false},oConf||{});var self=this;self.oConf=oConf;self.elements=jQuery(oConf.elementsAccessor);self.init=function(){jQuery(window).bind('scroll',self.scroll);if(oConf.delegateOn!==false&&(typeof jQuery.fn.on==='function')){jQuery(oConf.delegateOn).on('appear',oConf.elementsAccessor,self.retrieveData)}else{jQuery(oConf.elementsAccessor).bind('appear',self.retrieveData)}self.scroll()};self.refresh=function(){self.elements=jQuery(oConf.elementsAccessor)};self.refreshUnloaded=function(){self.elements=jQuery(oConf.elementsAccessor).not('.loaded')};self.scroll=function(){self.elements.each(function(i,elem){if(self.isInWindow(elem)){jQuery(elem).trigger('appear')}})};self.isInWindow=function(elem){return(self.topOfElementIsInWindow(elem)||self.bottomOfElementIsInWindow(elem)||self.elementJutsOutOnTopAndBottom(elem))&&(self.leftOfElementIsInWindow(elem)||self.rightOfElementIsInWindow(elem)||self.elementJutsOutOnLeftAndRight(elem))};self.isInWindowMiddleTop=function(elem){return self.isInWindow(elem)&&(self.getElementY(elem)<(self.getWindowY()+self.getWindowHeight()/2))};self.topOfElementIsInWindow=function(elem){var elementY=self.getElementY(elem),offsetY=self.oConf.offsetY,windowY=self.getWindowY(),windowHeight=self.getWindowHeight();return elementY>=windowY&&elementY-offsetY<windowY+windowHeight};self.leftOfElementIsInWindow=function(elem){var elementX=self.getElementX(elem),offsetX=self.oConf.offsetX,windowX=self.getWindowX(),windowWidth=self.getWindowWidth();return elementX>=windowX&&elementX-offsetX<windowX+windowWidth};self.bottomOfElementIsInWindow=function(elem){var elementY=self.getElementY(elem),elementHeight=self.getElementHeight(elem),offsetY=self.oConf.offsetY,windowY=self.getWindowY(),windowHeight=self.getWindowHeight();return elementY+elementHeight>windowY&&elementY+elementHeight+offsetY<=windowY+windowHeight};self.rightOfElementIsInWindow=function(elem){var elementX=self.getElementX(elem),elementWidth=self.getElementWidth(elem),offsetX=self.oConf.offsetX,windowX=self.getWindowX(),windowWidth=self.getWindowWidth();return elementX+elementWidth>windowX&&elementX+elementWidth+offsetX<=windowX+windowWidth};self.elementJutsOutOnLeftAndRight=function(elem){var elementY=self.getElementY(elem),elementHeight=self.getElementHeight(elem),windowY=self.getWindowY(),windowHeight=self.getWindowHeight();return elementY<windowY&&(elementY+elementHeight)>(windowY+windowHeight)};self.elementJutsOutOnTopAndBottom=function(elem){var elementX=self.getElementX(elem),elementWidth=self.getElementWidth(elem),windowX=self.getWindowX(),windowWidth=self.getWindowWidth();return elementX<windowX&&(elementX+elementWidth)>(windowX+windowWidth)};self.getWindowY=function(){return jQuery(window).scrollTop()};self.getWindowX=function(){return jQuery(window).scrollLeft()};self.getWindowHeight=function(){return self.getElementHeight(window)};self.getWindowWidth=function(){return self.getElementWidth(window)};self.getElementY=function(elem){return jQuery(elem).offset().top};self.getElementX=function(elem){return jQuery(elem).offset().left};self.getElementHeight=function(elem){return jQuery(elem).height()};self.getElementWidth=function(elem){return jQuery(elem).width()};self.injectScript=function($elem){var url=$elem.data('src');if(url!==null&&url!==''){jQuery.ajax({url:url,dataType:'script',cache:true,success:function(){self.refreshUnloaded()}})}};self.retrieveData=function(){if(typeof BOM.Utils.templating==='undefined'){return true}var $elem=jQuery(this),url=$elem.data('src');if($elem.hasClass('loaded')){return true}$elem.addClass('loaded');self.elements=self.elements.not($elem);if($elem.data('type')==='script'){self.injectScript($elem);return true}if($elem.data('type')==='callback'){oConf.onComplete($elem);return true}if(url!==null&&url!==''&&typeof url!=='undefined'){var qParams={url:url,type:'GET',context:this,dataType:$elem.data('tmpl')!==undefined?($elem.data('type')==='jsonp'?'jsonp':'json'):'html',success:self.injectData,error:oConf.onError||self.error,beforeSend:function(){$elem.addClass('loading');if(oConf.onLoad&&'function'===typeof oConf.onLoad){oConf.onLoad()}},complete:function(){$elem.removeClass('loading');if(oConf.onComplete&&'function'===typeof oConf.onComplete){oConf.onComplete()}}};if($elem.data('type')==='jsonp'){qParams.cache=true;qParams.jsonpCallback='callback_'+(function(str){var hash=0;if(str.length===0){return hash}for(var i=0;i<str.length;i++){var char=str.charCodeAt(i);hash=((hash<<5)-hash)+char;hash=hash&hash}return hash<0?(-1*hash):hash}(url))}jQuery.ajax(qParams)}return true};self.injectData=function(data){var $elem=jQuery(this);if(oConf.processData&&'function'===typeof oConf.processData){data=oConf.processData(data)}var template=(undefined!==oConf.template)?oConf.template:$elem.data('tmpl');if(template!==undefined&&template!==''){$elem.html(BOM.Utils.templating.render(template,data))}else{$elem.html(data)}self.refreshUnloaded();if(oConf.afterSuccess&&'function'===typeof oConf.afterSuccess){oConf.afterSuccess($elem,data)}$elem.trigger('lazybom.injectdata')};self.error=function(xhr){if(typeof console!=='undefined'){var errorMsg='LazyBom: '+xhr.status+' error';if(typeof console.error==='function'){console.error(errorMsg)}else if(typeof console.log==='function'){console.log(errorMsg)}}};self.enableElm=function($sel){jQuery($sel).removeClass('loaded');self.refreshUnloaded()};self.disableElm=function($sel){jQuery($sel).addClass('loaded');self.refreshUnloaded()};if(oConf.init){self.init()}return self};BOM.Utils.lazyBom.initModule=function(oConf){return new BOM.Utils.lazyBom(oConf)}}());BOM.buttonSet=function(formSelector){if(formSelector.is('form')){$('input[type="checkbox"]',formSelector).each(function(){if($(this).is(":checked")){$(this).siblings('label').addClass('ui-state-active')}$(this).addClass('h').siblings('label').addClass('ui-button ui-widget ui-state-default ui-button-text-only ui-corner-left').wrapInner('<span />').on('click',function(event){event.preventDefault();$(this).siblings(":checkbox").attr("checked",!$(this).siblings(":checkbox").is(":checked"));$(this).toggleClass('ui-state-active')})})}};(function($){'use strict';BOM=BOM||{};BOM.User=BOM.User||{};var BUA=BOM.User.AccountModule=function(oConf){oConf=oConf||{};this._conf=oConf;if(oConf.init!==false){this.init()}};BUA.prototype={init:function(){$.extend(this,{$module:$(this._conf.moduleSelector),$trigger:$(this._conf.triggerSelector),$content:$(this._conf.togglableContentSelector)});this.$triggerIcon=this.$trigger.find('.icon');this._conf.moduleExpandedCls=this._conf.moduleExpandedCls||'userAccountModuleExpanded';this._conf.toggleDuration=this._conf.toggleDuration!==undefined?this._conf.toggleDuration:400;this._conf.moduleExpandedCls=this._conf.moduleExpandedCls||'userAccountModuleExpanded';$(document).click($.proxy(this.collapse,this));this.$module.click($.proxy(this.onClick,this))},onClick:function(evt){var target=evt.target,$target=$(target),triggerSelector=this._conf.triggerSelector;if($target.is(triggerSelector)||$target.parents(triggerSelector).length>0){this.onTriggerClick();$target.parent().blur()}this._stopEvent=true},onTriggerClick:function(){if(this.$module.hasClass(this._conf.moduleExpandedCls)){this.hide()}else{this.show()}},show:function(){var that=this,targetHeight=0;this.$triggerIcon.removeClass('icon-btn-down').addClass('icon-btn-up');$.each(this.$content.children(),function(idx,child){targetHeight+=$(child).outerHeight()});this.$module.addClass(this._conf.moduleExpandedCls);this.$content.animate({height:targetHeight+'px'},this._conf.toggleDuration,function(){that.$content.css('height','auto')})},hide:function(){var that=this;this.$triggerIcon.removeClass('icon-btn-up').addClass('icon-btn-down');this.$content.animate({height:0},this._conf.toggleDuration,function(){that.$module.removeClass(that._conf.moduleExpandedCls)})},collapse:function(){if(!this._stopEvent&&this.$module.hasClass(this._conf.moduleExpandedCls)){this.hide()}this._stopEvent=false}};BUA.initModule=function(oConf){oConf=oConf||BOM.User.AccountModuleConf;new BUA(oConf)}})(jQuery);BOM.namespace('BOM.User.CommunicationSpot');BOM.User.CommunicationSpot=function(data){var self=this;self.init=function(data){if(self.ReadCookie('hideSelfPromotion')==='yes'){return false}self.render(data);$('.selfPromotion .more, .selfPromotion .expand').live('click',function(){$('.selfPromotion .more, .selfPromotion .expand').toggleClass('h')});$('.selfPromotion .close').live('click',function(){var date=new Date();date.setTime(date.getTime()+(7*24*60*60*1000));var expires="; expires="+date.toGMTString();if(!window.location.hostname.match(/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)&&window.location.hostname!=='localhost'){var domain=window.location.host;domain.substr(domain.indexOf('.')+1);document.cookie="hideSelfPromotion=yes"+expires+";domain=."+domain+";path=/;"}else{document.cookie="hideSelfPromotion=yes"+expires+";path=/;"}$('.selfPromotion').fadeOut(500)})};self.render=function(data){data=data[Math.floor(Math.random()*data.length)];$('#selfPromotion').html(BOM.Utils.templating.render('selfPromotionTpl',data));BOM.Xiti.xtClick()};self.ReadCookie=function(name){name+='=';var parts=document.cookie.split(/;\s*/);for(var i=0;i<parts.length;i++){var part=parts[i];if(part.indexOf(name)===0){return part.substring(name.length)}}return null};if(data.adblockUser||data.regularUser||data.homeUser){self.init(data.adblockUser||data.regularUser||data.homeUser)}return self};(function($){'use strict';BOM=BOM||{};BOM.Utils=BOM.Utils||{};BOM.Utils.RefererIncluder=function(oConf){this.conf=$.extend({selector:'.js-referer',refererParameter:'referer'},oConf||{});if(this.conf.init!==false){this.init()}};BOM.Utils.RefererIncluder._handlers=[];BOM.Utils.RefererIncluder.prototype={init:function(){if(typeof $.fn.on==='function'){$(document).on('click',this.conf.selector,$.proxy(this.clicked,this))}else{if(typeof $.fn.live==='function'){$(this.conf.selector).live('click',$.proxy(this.clicked,this))}}},clicked:function(e){var $link=$(e.target).closest(this.conf.selector),url;if($link.attr('href')){url=$link.attr('href');if(url.indexOf('?')!==-1){url+='&'}else{url+='?'}url+=this.conf.refererParameter+'='+encodeURIComponent(window.location.href)}this.callHandlers(url);return false},goto:function(url){window.location.href=url},callHandlers:function(arg){for(var i=0;i<BOM.Utils.RefererIncluder._handlers.length;i++){BOM.Utils.RefererIncluder._handlers[i].call(arg)}this.goto(arg)}};BOM.Utils.RefererIncluder.addHandler=function(f){BOM.Utils.RefererIncluder._handlers.push(f)};BOM.Utils.RefererIncluder.initModule=function(oConf){oConf=oConf||BOM.Utils.RefererIncluderConf||{};new BOM.Utils.RefererIncluder(oConf)}}(jQuery));(function($){'use strict';$(function(){BOM=BOM||{};BOM.UI=BOM.UI||{};BOM.UI.HeaderLinks=function(oConf){this.conf=$.extend({selector:'.js-headerLinks'},oConf||{});if(this.conf.init!==false){this.init()}};BOM.UI.HeaderLinks.prototype={init:function(){$(this.conf.selector).click(function(){$(this).toggleClass('expanded');if($(this).hasClass('expanded')===false){$(this).blur()}})}};BOM.UI.HeaderLinks.initModule=function(oConf){oConf=oConf||BOM.UI.HeaderLinksConf||{};new BOM.UI.HeaderLinks(oConf)};BOM.UI.HeaderLinks.initModule()})}(jQuery));(function($,global){'use strict';BOM=BOM||{};BOM.Utils=BOM.Utils||{};var urlRe=/\.js/,absoluteRe=/http[s]?:\/\//;BOM.Utils.require=function(){var args,modules,callback,headJsArgs=[],basePath=(BOM.config.assets+(BOM.config.assetsRevision||'')).replace(/\/$/,'');if(typeof arguments[arguments.length-1]==='function'){args=Array.prototype.slice.call(arguments);modules=args.splice(0,args.length-1);callback=args[0]}else{modules=arguments;callback=function(){}}for(var i=0,l=modules.length;i<l;i++){var module=modules[i];if(absoluteRe.test(module)){headJsArgs.push(module)}else{if(urlRe.test(module)){headJsArgs.push([basePath,'js',module].join('/'))}else{var segments=module.split('.'),obj=global['BOM'];segments.splice(0,1);for(var j=0,m=segments.length;j<m;j++){var segment=segments[j];if(typeof obj[segment]==='undefined'){headJsArgs.push([basePath,'js/testedJs','BOM'].concat(segments).join('/')+'.js');break}else{obj=obj[segment]}}}}}if(headJsArgs.length>0){head.js.apply(head,headJsArgs.concat(callback))}else{callback.call()}}}(jQuery,this));BOM.Xiti.xtClick=function(oConf){oConf=$.extend({init:true,selector:'.bomxtclick'},oConf||{});var self=this;self.oConf=oConf;self.xtTypeMap={'navigation':['C','N'],'download':['C','T'],'exit':['C','S'],'action':['C','A']};self.init=function(){self.log('BOM.Xiti.xtClick: enabled');if(typeof $.fn.off==='function'){$(document).off('click.xiti',this.oConf.selector)}if(typeof $.fn.on==='function'){$(document).on('click.xiti',this.oConf.selector,$.proxy(this.setXtClick,this))}else{$(this.oConf.selector).not('.bomxtclick-on').live('click.xiti',$.proxy(this.setXtClick,this)).addClass('bomxtclick-on')}};self.setXtClick=function(e){var el=this.getXtClickElement(e.target);if($(el).attr('href')===document.location.hash){return false}var type=self.getXtType(el);var params=this.getXtParams(el);var typeArray=self.xtTypeMap[type];self.log('Xt Type: '+type);self.log('Xt type of click: '+typeArray[1]);self.log('Xt Level2_ID: '+params[0]);self.log('Xt Click_label: '+params[1]);self.log('Xt SUCCESS executing: xt_click('+[typeArray[0],params[0],params[1],typeArray[1]].join(',')+')');return BOM.Xiti.xtClick.go(el,typeArray[0],params[0],params[1],typeArray[1])};self.getXtClickElement=function(el){var $el=$(el);return $el.is(this.oConf.selector)?$el.get():$el.closest(this.oConf.selector)};self.log=function(str){if('prod'!==BOM.config.env&&typeof console!=='undefined'&&'log'in console){console.log(str)}};self.getXtType=function(el){var type=$(el).data('xttype');if(typeof self.xtTypeMap[type]==='undefined'){throw{name:'Error',message:'xtType missing or unknown see BOM.Xiti.xtClick:'+type}}return type};self.getXtParams=function(el){var params=$(el).data('xtparams');if(typeof params==='undefined'){throw{name:'Error',message:'xtParams missing see BOM.Xiti.xtClick'}}params=params.split(',');if(params.length!==2){throw{name:'Error',message:'xtParams missing see BOM.Xiti.xtClick:'+params.length}}return params};if(self.oConf.init){self.init()}return self};BOM.Xiti.xtClick.go=function(el,p1,p2,p3,p4){if(typeof xt_click!=='undefined'){return xt_click(el,p1,p2,p3,p4)}else{console.error('xt_click is undefined')}};$(function(){BOM.Xiti.xtClick()});if(!jQuery.generateId){jQuery.generateId=function(){return arguments.callee.prefix+arguments.callee.count++};jQuery.generateId.prefix='bomObj';jQuery.generateId.count=0;jQuery.fn.generateId=function(){return this.each(function(){this.id=jQuery.generateId()})}}BOM.Utils=BOM.Utils?BOM.Utils:function(){};BOM.Utils.beaconLoaded=function(beaconName){if(beaconName){switch(beaconName){case'vibrant':if($('#beaconTwenga').length>0){$.getScript(BOM.Utils.decode($('#beaconTwenga').data('url')),function(){if(typeof affinitAD!=='undefined'){affinitAD.replace();BOM.Utils.beaconLoaded('twenga')}})}break;default:break}if('prod'!==BOM.config.env&&typeof console!=='undefined'&&typeof console.log!=='undefined'){console.log('beacon: '+beaconName)}}};BOM.Utils.trackPage=function(type,account,page){if(typeof account==='undefined'){return false}if(typeof page==='undefined'){page=location.href}switch(type){case'google':if(typeof(account)==='string'){_gaq.push(['_setAccount',account]);_gaq.push(['_trackPageview',page])}else{for(var i=0;i<account.length;i++){_gaq.push(['_setAccount',account[i]]);_gaq.push(['_trackPageview',page])}}break;default:break}return true};BOM.Utils.bwsr=function(){var bwsr='';if($.browser.msie){bwsr='ie'+$.browser.version.substr(0,1)}if($.browser.mozilla){bwsr='ff'}if($.browser.webkit){bwsr='webkit';if((navigator.userAgent.indexOf('iPhone')!==-1)){bwsr+=' iphone'}if((navigator.userAgent.indexOf('iPod')!==-1)){bwsr+=' ipod'}if((navigator.userAgent.indexOf('iPad')!==-1)){bwsr+=' ipad'}}if($.browser.opera){bwsr='opera'}return bwsr};$('html').addClass(BOM.Utils.bwsr);jQuery(document).bind('taberize',function(e,oConf){var oElt=jQuery(e.target);BOM.UI.oTabs[e.target.id]=oElt.tabs(oConf);if(oConf['iSelected']!=='undefined'){BOM.UI.oTabs[e.target.id].iSelected=oConf.iSelected}if(oConf.decode!=='undefined'){var aLinks=jQuery('.crLink',oElt);for(var i=aLinks.length-1;i>=0;i--){if(typeof(aLinks[i].onmouseover)==='function'){aLinks[i].onmouseover()}var item=jQuery(aLinks[i]);item.click(item,BOM.UI.selectTab)}}});BOM.UI.selectTab=function(e,ui){var url=e.currentTarget.href||$.data(ui.tab,'load.tabs');if(url){location.href=url;return false}if(BOM.UI.oTabs['navMenu'].iSelected!='undefined'){var oTab=BOM.UI.oTabs['navMenu'];var idx=BOM.UI.oTabs['navMenu'].iSelected;if(idx>=0){$(oTab.data().tabs.lis[idx]).removeClass('active');BOM.UI.oTabs['navMenu'].tabs('option','fx',{"opacity":"toggle","duration":200});if(ui.index==oTab.data().tabs.options.selected){BOM.UI.oTabs['navMenu'].tabs('option','fx',{"height":"toggle","duration":200});$(oTab.data().tabs.lis[idx]).addClass('active')}}}return true};BOM.UI.selectTab2=function(e,ui){var url=e.currentTarget.href||$.data(ui.tab,'load.tabs');if(url){location.href=url;return false}return true};$(document).bind('carouselize',function(e,oConf){var oElt=$(e.target);BOM.UI.oCarousels[e.target.id]=oElt.carousel(oConf)});$(document).bind('dropdownize',function(e,oConf){var oElt=$(e.target);oConf=$.extend({'oElt':oElt},oConf||{});BOM.UI.oDropdowns[e.target.id]=new BOM.Utils.dropDownize(oConf)});$(document).bind('toglayerize',function(e,oConf){var oElt=$(e.target);oConf=$.extend({'oElt':oElt},oConf||{});BOM.UI.oToggleLayerCtls[e.target.id]=new BOM.Utils.toggleLayerCtl(oConf)});BOM.Utils.datePickerize=function(oConf,datePickerOpts){var self=this;this.config=$.extend({},oConf||{});datePickerOpts=$.extend({},datePickerOpts||{});this.instanciate=function(){if(this.config.event==='ready'){$(this.config.inputClass).datepicker(datePickerOpts)}else{$(this.config.inputClass).live(this.config.event,function(e){$(e.target).datepicker(datePickerOpts)})}};this.init=function(){var localeFile,pathToFile;if("undefined"===typeof $.datepicker){localeFile='js/ui/datepicker.js';pathToFile=BOM.config.assets+localeFile;$.getScript(pathToFile,function(){self.init18N()})}else{this.init18N()}};this.init18N=function(){if(undefined===$.datepicker.regional[BOM.config.culture]){var localeFile='js/i18n/jquery.ui.datepicker-'+BOM.config.culture+'.js',pathToFile=BOM.config.assets+localeFile;$.getScript(pathToFile,function(){self.instanciate()})}else{this.instanciate()}};this.init()};BOM.Utils.pageRankDatePickerize=function(oConf){var self=this;self.month=self.selectedMonth=oConf.opts.currentMonth;self.year=self.selectedYear=oConf.opts.currentYear;oConf=$.extend({},oConf||{});var datePickerOpts=$.extend({defaultDate:"01/"+oConf.opts.currentMonth+"/"+oConf.opts.currentYear,maxDate:"+0M",showButtonPanel:true,onClose:function(){if(self.selectedMonth!==self.month||self.selectedYear!==self.year){var pageRankUrl=BOM.Utils.decode(oConf.opts.callbackUrl);pageRankUrl+='?month='+self.month;pageRankUrl+='&year='+self.year;pageRankUrl+='&category_id='+oConf.opts.catId;window.location=pageRankUrl}},onChangeMonthYear:function(year,month){self.month=month;self.year=year}},oConf.opts||{});$(oConf.trigger).click(function(){$(oConf.inputClass).focus()});BOM.Utils.datePickerize(oConf,datePickerOpts)};BOM.AjaxDialog=function(oConf,options){if($("div#modalDialog").length!==0){$("div#modalDialog").remove()}var targetElm=$('<div/>',{'id':'modalDialog'});targetElm.appendTo('body');$.each(oConf.trigger,function(index,triggerItem){var triggerElm=(0<$('#'+triggerItem).length)?$('#'+triggerItem):$('.'+triggerItem);triggerElm.live('click',function(e){if(triggerElm.attr('rel')){var reloadUrl=triggerElm.attr('rel')}targetElm.load($(e.target).attr('href'),function(response,textStatus,XMLHttpRequest){if(XMLHttpRequest.getResponseHeader("content-type")==='application/json; charset=utf-8'){response=$.parseJSON(response);if(!response.success){document.location.href=reloadUrl;return false}}else{targetElm.html(response);options=$.extend({width:450,height:'auto',minHeight:false,dialogClass:'modalDefault',modal:true,resizable:false,finalUrl:triggerElm.attr('rel'),close:function(){BOM.UI.oDialog.pop();var modale=$(this);$('.btAjaxSubmit, .bomdialog-follow, a, button').die('click');$(modale).remove()}},options||{});options=$.extend({open:function(){var modale=$(this);$(modale).find('.closeModal').live('click',function(e){e.preventDefault();$(modale).dialog('close')})},close:function(){var modale=$(this);$('.btAjaxSubmit, .bomdialog-follow').die('click');BOM.UI.oDialog.pop();$(modale).remove()}},options||{});if(oConf.ajaxForm){options=$.extend({open:function(){var modale=$(this);var form=$(this).children('form');$(form).bind('submit',function(e){e.preventDefault();var urlForm=$(e.target).attr('action');$.ajax({type:'POST',url:urlForm,data:$(e.target).serialize(),success:function(response){if(true===response.success&&options.finalUrl!==''){document.location.href=options.finalUrl}else{$(modale).html(e)}}})})},close:function(){var modale=$(this);$('.btAjaxSubmit, .bomdialog-follow').die('click');BOM.UI.oDialog.pop();$(modale).remove()}},options||{})}targetElm.dialog(options);BOM.UI.oDialog.push(targetElm)}});return false});return true});$('.ui-widget-overlay').live('click',function(){$(BOM.UI.oDialog[0]).dialog('close')})};BOM.AjaxDialogLogin=function(target){var loginField=$('#myLogin_login');var pwField=$('#myLogin_mdp');var submitBt=$('.submitForm');var actionForm=$('#connexion').attr('action');function doError(e){e.addClass('fieldNotOK').removeClass('fieldOK')}function doSuccess(e){e.addClass('fieldOK').removeClass('fieldNotOK')}function checkFieldSize(o,size){o.focusin(function(){if($(this).val().length<size){doError($(this))}});o.focusout(function(){if($(this).val().length>=size){doSuccess($(this))}});o.keyup(function(){if($(this).val().length>=size){doSuccess($(this))}else{doError($(this))}})}target.bind('dialogopen',function(){checkFieldSize(pwField,6);submitBt.click(function(){$.ajax({url:actionForm,type:'POST',data:{'login':loginField.val(),'mdp':pwField.val(),'action':'login_action','r':window.location.href}})})})};BOM.Utils.utf8Encode=function(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c)}else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128)}else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128)}}return utftext};BOM.Utils.encode=function(input){var _keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=BOM.Utils.utf8Encode(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64}else if(isNaN(chr3)){enc4=64}output=output+_keyStr.charAt(enc1)+_keyStr.charAt(enc2)+_keyStr.charAt(enc3)+_keyStr.charAt(enc4)}return output};(function(){BOM.Utils.NewPager=function(oConf){new BOM.Utils.Pager(oConf)}}());(function($){'use strict';BOM=BOM||{};BOM.Utils=BOM.Utils||{};BOM.Utils.Pager=function(oConf){oConf=$.extend({'id':'pager0'},oConf||{});var pButt=$('#'+oConf.id+' .more'),pLayer=$('#'+oConf.id+' .layer'),pLayerArrow=$('#'+oConf.id+' .layerArrow'),pButtArrow=$('#'+oConf.id+' .more .picto');var _self=this;this._collapsed=true;this._toggling=false;pButt.bind('mouseenter click',$.proxy(function(e){if(e.type==='mouseenter'&&this._collapsed&&!this._toggling){this.toggleLayer()}if(e.type==='click'&&!this._toggling){this.toggleLayer()}},_self));pLayer.mouseleave($.proxy(function(){if(!this._collapsed){this.toggleLayer()}},this));this.toggleLayer=function(){this._toggling=true;pLayer.slideToggle('',function(){pLayerArrow.toggle();pButtArrow.toggleClass("up");_self._collapsed=!_self._collapsed;_self._toggling=false})}};BOM.Utils.Pager.initModule=function(oConf){oConf=oConf||BOM.Utils.PagerConf||{};return new BOM.Utils.Pager(oConf)}}(jQuery));BOM.Utils.toggleLayerCtl=function(e){e.preventDefault();var togCtlElm=$(e.target).hasClass('togLayerCtl')?$(e.target):$(e.target).parents('.togLayerCtl');var togLayerElm=togCtlElm.parent().next();togCtlElm.toggleClass("toggled");if(togCtlElm.parent().hasClass('toggler')){togCtlElm.parent().toggleClass('bgg2');$('.moreDialog-dialog').remove()}togLayerElm.slideToggle(300,function(){togCtlElm.children('.picto').toggleClass("collapse")});return false};$('.togLayerCtl').live('click',BOM.Utils.toggleLayerCtl);BOM.Utils.moreDialog=function(){var self=this;self.init=function(){self.trigger=$('.moreDialog-trigger');$(self.trigger).live('click',function(e){e.preventDefault();self.closeBtText=$.trim($(e.currentTarget).text());self.dialogOptions={'width':'auto','dialogClass':'moreDialog-dialog','closeText':'',open:function(){self.closeBt=$('<a>',{'class':'moreDialog moreDialog-close ib','text':self.closeBtText}).append($('<span>',{'class':'picto pictoUp'}));$('.moreDialog-close').live('click',function(){$.data(self.closeBt,'modale').dialog('close')});self.closeBtTarget=$(self.layer).prev('.ui-dialog-titlebar');$.data(self.closeBt,'modale',$(self.layer));self.closeBt.appendTo(self.closeBtTarget)},close:function(){self.cleanup(self.layer)}};self.cleanup('.'+self.dialogOptions.dialogClass);self.builder(e)})};self.cleanup=function(elm){$(elm).dialog('destroy');$(elm).remove()};self.builder=function(e){if($('.moreDialog-layer').length>0){self.cleanup($('.moreDialog-layer'))}self.layer=$('<div>',{'class':'moreDialog-layer'}).append($('<div>',{'class':'moreDialog-content'}));var position=$(e.currentTarget).offset();$(self.layer).dialog(self.dialogOptions);$(self.layer).parent().css({left:position['left']-6,top:position['top']-5});self.content=$(self.layer).find(":nth-child(1)");self.content.addClass('ajaxLoader');self.updater(e)};self.updater=function(e){var urlAjax=BOM.Utils.decode($(e.currentTarget).attr('rel'));$.ajax({url:urlAjax,success:function(xhr){self.content.removeClass('ajaxLoader').html(xhr)}})};self.init()};BOM.Utils.toggleMoreListItem=function(e){e.preventDefault();var togCtlElm=$(e.target).closest('.togMoreCtl');var text=togCtlElm.html();togCtlElm.parents('li').siblings('.togMore').toggleClass('h');togCtlElm.html(togCtlElm.attr('tog'));togCtlElm.attr('tog',text);togCtlElm.siblings('.togMoreCtl-picto').toggleClass('togMoreCtl-picto-up');return false};$('.togMoreCtl').live('click',BOM.Utils.toggleMoreListItem);BOM.Utils.dropDownize=function(options){this.config=$.extend({collapseOnLeave:true,expandOnOver:false,slideDuration:300},options||{});this.dropdown=options.oElt;this.select=$('#'+this.dropdown[0].id+':not(.disabled) .select');this.dropper=$('#'+this.dropdown[0].id+' .dropper');this.menu=$('#'+this.dropdown[0].id+' ul');this._collapsed=true;this.init=function(){this.select.click($.proxy(function(){$.proxy(this.toggle(),this)},this));this.menu.css('top',(this.select.outerHeight()+this.select.position().top-parseInt(this.select.css('borderBottomWidth'),10)));if(this.config.collapseOnLeave){this.dropdown.mouseleave($.proxy(function(){if(!this._collapsed){$.proxy(this.toggle(),this)}},this))}if(this.config.expandOnOver){this.select.mouseover($.proxy(function(){if(this._collapsed){$.proxy(this.toggle(),this)}},this))}};this.toggle=function(){this.menu.slideToggle(this.config.slideDuration);this._collapsed=!this._collapsed};this.init()};BOM.Utils.popDropDown=function(options){this.config=$.extend({'selPopTrigger':'.dropDownTrigger','selPopLayer':'.dropDownLayer','event':'click','popdown':'auto','popdownTimer':3000},options||{});this.init=function(){if(0<$(this.config.selPopTrigger).length){$(this.config.selPopTrigger).bind(this.config.event,$.proxy(function(e){if('auto'===this.config.popdown){$.proxy(this.popUpDown(e),this);e.stopPropagation()}e.preventDefault();return false},this))}};this.popUpDown=function(e){var pddRoot=$(e.target).closest(this.config.selPopTrigger);$(pddRoot.children(this.config.selPopLayer)).toggle().delay(this.config.popdownTimer).fadeOut(600);return false};this.init()};jQuery("#tsb").live('mouseenter mouseleave',function(e){if(e.type=='mouseenter'){jQuery("#tsb").tabs("rotate",0,true)}else{jQuery("#tsb").tabs("rotate",5000,true)}});BOM.Utils.clearInputTxt=function(e){var elt=$(e.target);if(e.type==='focusout'){if(elt.val()===''){elt.val(elt.data().saved)}else{elt.data('saved',elt.val())}}else{if(elt.data('saved')==null){elt.val('')}}};$('.inputTxt, .inputText2').live('focusin blur',BOM.Utils.clearInputTxt);$('#ftNLForm').live('submit',function(e){e.preventDefault();e.stopPropagation();var msg=$('#ftMsg');if(!msg.length){msg=$('<div/>',{id:"ftMsg"});$(this).append(msg)}$.post($(this).attr('action'),$(e.target).serialize(),function(data){msg.html(data.message);var options={width:350,dialogClass:'modalDefault',modal:true,resizable:false,buttons:{Ok:function(){$(this).dialog('close')}}};msg.dialog(options)})});BOM.Utils.extendsPDD=function(text){var content=$('<div>',{'class':'tooltipContent h ui-dialog modalDefault','text':text});content.appendTo($('.tooltipTrigger'))};BOM.Utils.liveValidation=function(oConf){this.options=$.extend({'formValSel':'.v-validate'},oConf||{});this.init=function(){$(this.options.formValSel).each(function(){var $this=$(this);if(typeof $this.bomValidation==='function'){$this.bomValidation(oConf)}})};this.init()};if(typeof BOM.Utils.loadScript!=='function'){BOM.Utils.loadScript=function(urlBase64,callback,allowCache){allowCache=(typeof allowCache!=='undefined')?allowCache:false;if(allowCache){BOM.Utils.loadScriptAndAllowCache(urlBase64,{success:callback})}else{$.getScript(BOM.Utils.decode(urlBase64),function(){if(callback){callback()}})}}}BOM.Utils.loadScriptAndAllowCache=function(urlBase64,options){options=$.extend(options||{},{dataType:"script",cache:true,url:BOM.Utils.decode(urlBase64)});return $.ajax(options)};BOM.namespace('BOM.User');BOM.User.isConnected=false;BOM.User.displayCommunityBox=function(oConf){var options=$.extend({'show':true,'boxDisplaySel':'aside.rightCol','url':false},oConf||{});var url=options.url?BOM.Utils.decode(options.url):false;if(false==options.show||false==options.url){return}if(BOM.User.isConnected&&($(options.boxDisplaySel).length!==0)){var box=$('#communityBox');if(!box.length){box=$('<div/>',{id:"communityBox"});$(options.boxDisplaySel).prepend(box)}$.get(url,{},function(response){box.html(response)})}};$('#communityBox').find('.comunityBoxLink, .comunityBoxLink .picto, .comunityBoxLinkLess, .comunityBoxLinkLess .picto').live('click',function(e){e.preventDefault();var target=$(e.target);var url=$(target).closest('.comunityBoxLink, .comunityBoxLinkLess').attr('rel');if(url){$('#comunityBox .ajaxLoader').removeClass('h');BOM.User.displayCommunityBox({url:url})}});(function($){BOM.User.personalInformationForm=function(){var self=this,trigger=$('.usrModify');var init=function(){if($('.usrCancel:visible').length){trigger.each(function(){$(this).toggleClass('inactive')})}};init();self.classToggler=function(target,cls){$(target).each(function(){$(this).toggleClass(cls)})};trigger.click(function(e){if(false===$(e.target).hasClass('stopPropagation')&&false===$(e.target).hasClass('inactive')){$(this).parents('div.profileListingElm').hide().next('div.profileListingForm').show();self.classToggler('.usrModify','inactive btInactive')}});$('.usrCancel').click(function(){$(this).closest('form').each(function(){this.reset()});$(this).parents('div.profileListingForm').hide().prev('div.profileListingElm').show();self.classToggler('.usrModify','inactive btInactive')})};BOM.User.personalInformationForm.initModule=function(){return new BOM.User.personalInformationForm()}}(jQuery));BOM.User.toggler=function(oConf){if(undefined===oConf){return false}$(oConf.trigger).each(function(){$(this).click(function(e){var target=$(e.target).next(oConf.target);$(this).toggle();$(target).toggle()})});if(undefined!==oConf.rollBackBtn){$(oConf.rollBackBtn).each(function(){$(this).click(function(e){var parentForm=$(e.target).parents(oConf.target);var toggleHandler=$(parentForm).prev(oConf.trigger);$(parentForm).toggle();$(toggleHandler).toggle()})})}};(function($){'use strict';BOM=BOM||{};BOM.User=BOM.User||{};BOM.User.FormFocus=function(form){if($(form).find('input[type=text]').length){$('input[type=text]:first',form).focus(BOM.User.FormValidation(form))}}}(jQuery));BOM.User.toggleButton=function(elm,state){var self=this,oElm=$(elm);if(state===!oElm.hasClass('inactive')){return}this.init=function(){if(state){oElm.removeClass('btInactive inactive').unbind('click.BomUsertoggleButton')}else{oElm.addClass('btInactive inactive').unbind('click.BomUsertoggleButton').bind('click.BomUsertoggleButton',$.proxy(self,"clickHandler"))}};this.clickHandler=function(e){e.preventDefault();return false};self.init()};BOM.User.InputLimit=function(){var self=this;self.init=function(){$('.limited').bind('keyup keypress click blur focus change paste',function(){var target=$(this);self.limit(target)})};self.limit=function(target){var maxLength=$(target).attr('rel'),currentValue=$(target).val(),currentLength=currentValue.length;if(currentLength>maxLength){var newVal=currentValue.substring(0,maxLength);$(target).empty().val(newVal)}};self.init()};BOM.User=BOM.User||{};BOM.User.isOkElement=function(elm,valid,form){form=(form)?form:$(elm).parents('form');var bool=true;if(true===valid){if($(elm).hasClass('invalid')){$(elm).removeClass('invalid')}$(elm).nextAll('span.validator').removeClass('ajaxLoader').removeClass('pictoNotOk').addClass('pictoOk').addClass('picto');$(elm).nextAll('.formError').addClass('h');$.each($('.validator',form),function(key,value){if(!$(value).hasClass('pictoOk')){bool=false}})}else{$(elm).addClass('invalid');$(elm).next('span.validator').removeClass('ajaxLoader').removeClass('pictoOk').addClass('pictoNotOk').addClass('picto');if($('.validator').parent().hasClass('pictoNotOk')){BOM.User.toggleButton($('.btAjaxSubmit'),false)}bool=true;$.each($('.validator',form).parent(),function(key,value){if(!$(value).hasClass('pictoOk')){bool=false}})}BOM.User.toggleButton($('.btAjaxSubmit',form),bool)};BOM.User.FormValidation=function(form){var self=this,ajaxUsernameUrl=BOM.config.ajaxUsernameUrl,ajaxEmailUrl=BOM.config.ajaxEmailUrl,validatorArray=BOM.config.validatorArray;var checkUsernameMinimalCharacters=3;self.checkUsernameThresholdCrossed=false;self.cacheUsr={};self.init=function(form){BOM.User.toggleButton($('.btAjaxSubmit',form),false);if(typeof validatorArray!=="undefined"){$('#'+validatorArray[0]).one('focus',function(){self.username($('#'+validatorArray[0]))});$('#'+validatorArray[1]).one('focus',function(){self.password($('#'+validatorArray[1]))});$('#'+validatorArray[2]).one('focus',function(){self.email($('#'+validatorArray[2]))})}};self.checkSocialSignupInputs=function(usernameInput,emailInput){if(usernameInput.length&&usernameInput.val()!==''){self.checkUsername(usernameInput)}if(emailInput.length&&emailInput.val()!==''){self.checkEmail(emailInput)}};self.keepOnlyOneCheckUsernameRequest=function(){if(typeof self.currentCheckUsernameRequest!=="undefined"){self.currentCheckUsernameRequest.abort()}};self.keepOnlyOneCheckEmailRequest=function(){if(typeof self.currentCheckEmailRequest!=="undefined"){self.currentCheckEmailRequest.abort()}};self.checkUsername=function(elm){var usernameInput=$(elm);if(usernameInput.hasClass('noAjaxValidation')){self.isOkelement(elm,true)}else{self.keepOnlyOneCheckUsernameRequest();usernameInput.next('span.validator').addClass('ajaxLoader').removeClass('pictoNotOk , pictoOk , picto');self.ajaxCheckUsername(elm)}};self.username=function(elm){$(elm).bind('keyup',function(){if(!self.checkUsernameThresholdCrossed&&checkUsernameMinimalCharacters<=$(elm).val().length){self.checkUsernameThresholdCrossed=true}if(self.checkUsernameThresholdCrossed){self.checkUsername(elm)}});$(elm).bind('blur',function(){self.checkUsername(elm)})};self.checkPassword=function(elm,minLength){var passwordInput=$(elm);if(minLength<=passwordInput.val().length&&30>=passwordInput.val().length){self.isOkelement(elm,true)}else{self.isOkelement(elm,false)}};self.password=function(elm){var minLength=6;if($(elm).attr('min-length')){minLength=$(elm).attr('min-length')}$(elm).bind('keyup blur',function(){self.checkPassword(elm,minLength)})};self.checkEmail=function(elm){self.keepOnlyOneCheckEmailRequest();self.ajaxCheckEmail(elm)};self.ajaxCheckEmail=function(elm){var emailInput=$(elm);var data={email:emailInput.val()};if(emailInput.hasClass('checkFormat')){data.isOnlyCheck=true}self.currentCheckEmailRequest=$.ajax({url:ajaxEmailUrl,type:'post',data:data,success:function(response){self.valid(response,elm)}})};self.email=function(elm){$(elm).bind('keyup blur',function(){self.checkEmail(elm)})};self.valid=function(response,elm){if(!response.success){self.isOkelement(elm,false);var errorField=$(elm).nextAll('.formError');errorField.removeClass('h');for(var i in response.errors){if(response.errors.hasOwnProperty(i)){errorField.html(response.errors[i]);break}}}else{self.isOkelement(elm,true)}};self.isOkelement=function(elm,valid){BOM.User.isOkElement(elm,valid)};self.ajaxCheckUsername=function(elm){var currentUsername=$(elm).val();self.currentCheckUsernameRequest=$.ajax({url:ajaxUsernameUrl,type:'post',data:{username:currentUsername},success:function(response){self.valid(response,elm)}})};self.init(form)};function viewModal(url){return BOM.User.displayLogin(url)}BOM.User.displayLogin=function(url){var msg=$('#loginMsg');if(!msg.length){msg=$('<div/>',{id:"loginMsg"});$('body').append(msg)}$.post(url,function(response){msg.html(response);var options={width:410,dialogClass:'modalDefault',modal:true,resizable:false,draggable:false};msg.dialog(options)})};(function($){'use strict';BOM=BOM||{};BOM.User=BOM.User||{};BOM.User.Dialog=function(oConf,options){var self=this,modale;BOM.User.Dialog.Instance=self;var MAX_ZINDEX=9999990;self.options=$.extend({width:'auto',minHeight:false,dialogClass:'modalDefault',modal:true,resizable:false,close:function(){$('.btAjaxSubmit').die('click');$('.bomdialog-follow').die('click');BOM.UI.oDialog.pop();$('.modaleElm').remove();BOM.User.removeLoadingStatusOnPageButtons()},open:function(){$('.ui-widget-overlay').css("z-index",MAX_ZINDEX-1);$('.ui-dialog.modalDefault').css("z-index",MAX_ZINDEX)}},options||{});self.init=function(){if(typeof $.fn.on==='function'&&typeof $.fn.off==='function'){$(document).off('click','.bomdialog').on('click','.bomdialog',function(e){self.open(e)})}else{$(document).die('click','.bomdialog').live('click','.bomdialog',function(e){self.open(e)})}};self.request=function(url,options){options=$.extend({type:'GET',url:url,beforeSend:function(){$(self.modale).empty().addClass('ajaxLoader').dialog("option","position",'center')},success:function(response){if(response){$(self.modale).removeClass('ajaxLoader');self.updater(response)}else{BOM.Utils.reloadPage()}}},options||{});$.ajax(options)};self.updater=function(response){if(typeof response==='string'){var response2=response;try{response2=$.parseJSON(response2)}catch(er){}if(typeof response2==='object'){response=response2}}if(typeof response==='object'){if('undefined'!==typeof response.redirect){document.location.href=response.redirect;$(self.modale).dialog('close')}else if('undefined'!==typeof response.message){$(self.modale).empty().html('<p class="font123 bold cError">'+response.message+"</p>").dialog("option","position",'center')}}else{$(self.modale).empty().html(response).dialog("option","position",'center')}};self.openFromElement=function(selector){var trigger=$(selector);if(!trigger.size()){return false}self.open('',trigger)};self.openFromNewElement=function(eltConf){if(!eltConf||!eltConf.tag||!eltConf.attr){return false}var trigger=$(eltConf.tag,eltConf.attr).appendTo('body');self.open('',trigger)};self.open=function(e,trig){if(e){e.preventDefault()}var trigger=e?$(e.currentTarget):trig;if(!trigger.size()){return false}if($('#usrModal').length===0){modale=$('<div>',{'id':'usrModal'}).append('body');BOM.UI.oDialog.push(modale)}else{modale=$('#usrModal')}$(modale).html('');var dialogSize=self.getTriggerDialogSize(trigger);var defaultDialogClass=self.options.dialogClass;if(dialogSize&&dialogSize.className){self.options.dialogClass+=' '+dialogSize.className;self.options.width=dialogSize.pc}if(undefined!==self.options.buttons){delete self.options.buttons}if(trigger.hasClass('bomdialog-yesno')||trigger.hasClass('bomdialog-yes')){self.options.buttons={};self.options.buttons[trigger.attr('bomdialog-label-yes')?trigger.attr('bomdialog-label-yes'):'yes']=function(){if(trigger.hasClass('bomdialog-forward')){self.confirmForwardLoad(trigger)}else{self.confirmAjaxLoad(trigger)}};if(trigger.hasClass('bomdialog-yesno')){self.options.buttons[trigger.attr('bomdialog-label-no')?trigger.attr('bomdialog-label-no'):'no']=self.close}}self.modale=$(modale).dialog(self.options);if(trigger.attr('bomdialog-msg')){$(modale).html(trigger.attr('bomdialog-msg'))}else if(trigger.attr('bomdialog-img')){var img=$('<img src="'+$(trigger).attr('bomdialog-img')+'" class="inner15" /></div>');self.modale.html(img);img.bind('load',function(){self.modale.dialog("option","width",img.width()+60);self.modale.dialog("option","position",'center')})}else{var ajaxOptions={complete:function(){var form=$(self.modale).find('form');BOM.User.FormFocus(form);$('.bomdialog-follow').live('click',function(e){e.preventDefault();$.ajax({url:BOM.Utils.decode($(e.currentTarget).attr('rel')),beforeSend:function(){$(self.modale).html('');$(self.modale).addClass('ajaxLoader').removeClass('h')},success:function(response){$(self.modale).removeClass('ajaxLoader');$(self.modale).html(response);var followSize=self.getTriggerDialogSize(e.target);if(followSize&&followSize.className){$(self.modale).dialog('option','dialogClass',defaultDialogClass+' '+followSize.className);$(self.modale).dialog('option','width',followSize.pc)}else{$(self.modale).dialog('option','width','auto')}$(self.modale).dialog('option','position','center');form=$(self.modale).find('form');BOM.User.FormFocus(form)}})});$('.bomdialog-show').live('click',function(e){e.preventDefault();self.setTriggerDialogOptions(e.target,$(self.modale).dialog)});$('.btAjaxSubmit').live('click',function(e){BOM.User.Dialog.submitForm(e,$(e.target).parents('form'),trigger,self)});$('.ui-dialog-content .btClose').unbind('click').bind('click',function(){self.modale.dialog("close")})}};var getExtraDataHandler=$(e.currentTarget).attr('data-getExtraDataHandler');var extraData=false;if(getExtraDataHandler){try{var getExtraDataHandlerFunc=eval(getExtraDataHandler);extraData=getExtraDataHandlerFunc.apply()}catch(err){}}if(false!==extraData){ajaxOptions.data=extraData;ajaxOptions.type='POST'}self.request(BOM.Utils.decode($(trigger).attr('rel')),ajaxOptions)}$('.ui-widget-overlay').live('click',function(){$('.btAjaxSubmit').die('click');$('.bomdialog-follow').die('click');$(self.modale).remove()})};self.getTriggerDialogSize=function(trigger){var tClass=$(trigger).attr('class');if(!trigger||!/bomdialogSize/i.test(tClass)){return false}var cls=$(trigger).attr('class').match(/bomdialogSize(\d)+of(\d)+/i);var size={};size.className=cls[0].replace(/bomdialogSize/i,'size');var coeff=990/$(window).width();size.pc=Math.round((cls[1]*100/cls[2])*coeff*100)/100+'%';return size};self.close=function(){self.modale.dialog("close")};self.confirmForwardLoad=function(trigger){if(undefined!==$(trigger).attr('rel')){document.location.href=BOM.Utils.decode($(trigger).attr('rel'))}};self.confirmAjaxLoad=function(trigger){if(undefined!==$(trigger).attr('rel')){$.ajax({type:'GET',url:BOM.Utils.decode($(trigger).attr('rel')),success:function(response){if(typeof response==='string'){response=$.parseJSON(response)}if(response.success){if($(trigger).hasClass('bomdialog-redirect')){if($(trigger).attr('data-href')){self.request(BOM.Utils.decode($(trigger).attr('data-href')))}else{self.request($(trigger).attr('href'))}}else if($(trigger).hasClass('bomdialog-success')){$('.bomdialog-content').addClass('h');$('.bomdialog-content-success').removeClass('h')}else if('undefined'!==typeof response.redirect){document.location.href=response.redirect}else{if('undefined'!==typeof $(trigger).attr('data-href')&&0<$(trigger).attr('data-href').length){document.location.href=BOM.Utils.decode($(trigger).attr('data-href'))}else if('undefined'!==typeof $(trigger).attr('href')&&0<$(trigger).attr('href').length){document.location.href=$(trigger).attr('href')}else if($(trigger).is('input')||$(trigger).is('button')){$(trigger).parents('form').submit()}$(trigger).removeClass('bomdialog').unbind('click');self.modale.dialog("close")}}}})}};self.init()};BOM.User.Dialog.submitForm=function(e,form,trigger,self){e.preventDefault();BOM.User.addLoadingStatusOnElement(e.target);var urlForm=form.attr('action'),contentForm=form.serialize();$.ajax({type:'POST',url:urlForm,data:contentForm,success:function(response){if(typeof response==='string'){response=$.parseJSON(response)}if(response.success){BOM.User.isConnected=true;if($(trigger).hasClass('bomdialog-redirect')){if($(trigger).attr('data-href')){self.request(BOM.Utils.decode($(trigger).attr('data-href')))}else{self.request($(trigger).attr('href'))}}else if($(trigger).hasClass('bomdialog-success')){$('.bomdialog-content',form).addClass('h');$('.bomdialog-content-success',form).removeClass('h')}else if('undefined'!==typeof response.redirect){window.location=response.redirect}else{if($(trigger).hasClass('bomdialog-reloadPage')){window.location.reload()}else if('undefined'!==typeof $(trigger).attr('data-href')&&0<$(trigger).attr('data-href').length){document.location.href=BOM.Utils.decode($(trigger).attr('data-href'))}else if('undefined'!==typeof $(trigger).attr('href')&&0<$(trigger).attr('href').length){document.location.href=$(trigger).attr('href')}else if($(trigger).is('input')||$(trigger).is('button')){$(trigger).parents('form').submit()}$(trigger).removeClass('bomdialog').unbind('click');if('undefined'!==typeof self){self.modale.dialog("close")}}}},error:function(response){response=$.parseJSON(response.responseText);BOM.User.removeLoadingStatusOnPageButtons();for(var i in response.errors){if(response.errors.hasOwnProperty(i)){$('.'+i,form).addClass('invalid');$('.'+i,form).next('span.validator').removeClass('ajaxLoader').addClass('pictoNotOk');$('.'+i,form).nextAll('.formError').removeClass('h');if('undefined'!==typeof BOM.config.trads[response.errors[i]]){$('.'+i,form).nextAll('.formError').html(BOM.config.trads[response.errors[i]])}else{$('.'+i,form).nextAll('.formError').html(response.errors[i])}}}}})};BOM.User.Dialog.unAuthCallbackAfterFormSubmit=function(f,sel){if(!BOM.User.isConnected){BOM.User.Dialog.Instance.openFromElement(sel);BOM.User.removeLoadingStatusOnPageButtons();return false}return true};BOM.User.Dialog.initModule=function(oConf,options){if(!('Instance'in BOM.User.Dialog)){oConf=oConf||BOM.User.DialogConf||{};options=options||{};return new BOM.User.Dialog(oConf,options)}}}(jQuery));BOM.User.switchButtonToLoadingStatus=function(oConf){$(oConf.button).click(function(){BOM.User.addLoadingStatusOnElement(this)})};BOM.User.addLoadingStatusOnElement=function(element){var clickedButton=$(element);clickedButton.addClass('btLoading loading');var buttonParent=clickedButton.parent();var buttonAjaxLoader=$('.bomdialog-action-loader',buttonParent);if(buttonAjaxLoader.length===0){buttonParent.prepend('<div class="unit bomdialog-action-loader ajaxLoader spaceR10 spaceT10"></div>')}else{buttonAjaxLoader.addClass('ajaxLoader').removeClass('h')}};BOM.User.removeLoadingStatusOnPageButtons=function(){$('.btLoading.loading').removeClass('btLoading loading');$('.bomdialog-action-loader').addClass('h').removeClass('ajaxLoader')};BOM.Metrics=BOM.Metrics?BOM.Metrics:{};BOM.Metrics.setStartTime=function(componentName){BOM.Metrics[componentName]=BOM.Metrics[componentName]?BOM.Metrics[componentName]:{};BOM.Metrics[componentName].StartTime=new Date().getTime()};BOM.Metrics.sendLoadTime=function(componentName){BOM.Metrics[componentName]=BOM.Metrics[componentName]?BOM.Metrics[componentName]:{};BOM.Metrics[componentName].TimeSpent=BOM.Metrics[componentName].EndTime-BOM.Metrics[componentName].StartTime;if(typeof BOM.Metrics.GoogleAnalyticsEnabled!=='undefined'&&BOM.Metrics.GoogleAnalyticsEnabled){_gaq.push(['_setAccount',BOM.Metrics.GoogleAnalyticsAccount],['_trackTiming','Client load time',componentName,BOM.Metrics[componentName].TimeSpent])}else if(typeof console!=='undefined'&&typeof console.log!=='undefined'){console.log('Client load time spent on "'+componentName+'" = '+BOM.Metrics[componentName].TimeSpent+' ms')}};BOM.Metrics.setEndTime=function(componentName){BOM.Metrics[componentName]=BOM.Metrics[componentName]?BOM.Metrics[componentName]:{};BOM.Metrics[componentName].EndTime=new Date().getTime();BOM.Metrics.sendLoadTime(componentName)};BOM.UI.MultiValueAutocomplete=function(oConf){var self=this;this.sId=oConf.id;this.sField=oConf.field;this.sUrl=BOM.Utils.decode(oConf.url);this.params={};this.split=function(val){return val.split(/,\s*/)};this.extractLast=function(term){return self.split(term).pop()};this.init=function(){$('#'+this.sId).autocomplete({source:this.suggestSource,search:function(){var term=self.extractLast(this.value);if(term.length<2){return false}},focus:function(){return false},select:function(event,ui){var terms=self.split(this.value);terms.pop();terms.push(ui.item.value);terms.push("");this.value=terms.join(", ");return false}})};this.suggestSource=function(request,response){self.params[self.sField]=self.extractLast(request.term);$.getJSON(self.sUrl,self.params,response)};if(typeof oConf.noInit==="undefined"){this.init()}return this};BOM.UI.placeholder=function(){var $ph=$('[placeholder]');if(typeof $ph.placeholder==='function'){$ph.placeholder()}};BOM.UI.TagsSuggestedFromTitleAndDescription=function(oConf){var self=this;var sciencePredictUrl=BOM.Utils.decode(oConf.url);$('#'+oConf.title_id+', '+'#'+oConf.details_id+', '+'#'+oConf.categoryId).blur(function(){var titleElm=$('#'+oConf.title_id);var contentElm=$('#'+oConf.details_id);if((titleElm.val()!=''&&!titleElm.hasClass('invalid'))||(contentElm.val()!=''&&!contentElm.hasClass('invalid'))){self.extractTagsAndAddThemToTagField(titleElm.val(),contentElm.val())}});this.extractTagsAndAddThemToTagField=function(textTitle,textContent){var tagSuggestParams={docs:[{title:textTitle,content:textContent,createdAt:''}]};$.post(sciencePredictUrl,JSON.stringify(tagSuggestParams),function(tagsResult){var tags=tagsResult.tags[0];for(var i=0;i<tags.length;i++){$('[id$=_tags_labels][class*=post_tags]').each(function(){$(this).tokenInput("add",{name:tags[i]})})}},"json")};if(typeof oConf.tagOnLoad!=='undefined'&&oConf.tagOnLoad==true){var title=$('#'+oConf.title_id).val();var content=$('#'+oConf.details_id).val();if(title!=''&&content!=''){this.extractTagsAndAddThemToTagField(title,content)}}};BOM.UI.TagsSuggestAsYouType=function(oConf){var delayBeforePerformingSearch=0;var minCharactersNeededToPerformSearch=2;oConf.delay=delayBeforePerformingSearch;oConf.noInit=true;oConf.minLength=minCharactersNeededToPerformSearch;var autocomplete=BOM.UI.MultiValueAutocomplete(oConf);var self=autocomplete;autocomplete.keepOnlyOneScienceRequest=function(){if(typeof self.scienceRequest!=="undefined"){self.scienceRequest.abort()}};autocomplete.suggestSource=function(request,response){self.params[self.sField]=self.extractLast(request.term);self.keepOnlyOneScienceRequest();self.scienceRequest=$.getJSON(self.sUrl,self.params,function(scienceData){self.scienceResults=[];if(scienceData){self.scienceResults=scienceData.suggestions}response(self.scienceResults)})};autocomplete.closeAutocompletePanelOnComma=function(){var commaKeyCode=188;var tagSuggestInput=$('#'+this.sId);tagSuggestInput.keydown(function(e){if(e.keyCode===commaKeyCode){tagSuggestInput.autocomplete("close")}})};autocomplete.closeAutocompletePanelOnComma();autocomplete.selectFirstTagOnEnterOrTab=function(){var enterKeyCode=13;var tabKeyCode=9;var tagSuggestInput=$('#'+this.sId);tagSuggestInput.keydown(function(e){if(e.keyCode===enterKeyCode||e.keyCode===tabKeyCode){if(self.scienceResults.length&&$('#ui-active-menuitem').length===0){e.preventDefault();self.selectValue(tagSuggestInput,self.scienceResults[0].label)}}})};autocomplete.selectValue=function(tagSuggestInput,value){var terms=self.split(tagSuggestInput.val());terms.pop();terms.push(value);terms.push("");tagSuggestInput.val(terms.join(", "));tagSuggestInput.autocomplete("close")};autocomplete.selectFirstTagOnEnterOrTab();if(typeof oConf.initOnLinkClick!=='undefined'&&oConf.initOnLinkClick===true){$(document).one('click',"#tagTrigger",function(){autocomplete.init()})}else{autocomplete.init()}};BOM.UI.TokenizedTagsSuggestAsYouType=function(oConf){var delayBeforePerformingSearch=0;var minCharactersNeededToPerformSearch=2;var self=this;this.sId=oConf.id;this.sField=oConf.field;this.sUrl=BOM.Utils.decode(oConf.url);delete oConf.id;delete oConf.field;delete oConf.url;this.params=$.extend({queryParam:this.sField,searchDelay:delayBeforePerformingSearch,minChars:minCharactersNeededToPerformSearch,tokenValue:'name',theme:'tomsguide',deleteText:'&nbsp;',onResult:function(scienceData){self.scienceResults=[];if(scienceData){$.each(scienceData.suggestions,function(index,value){self.scienceResults.push({'name':value.label})})}return self.scienceResults}},oConf);this.init=function(){var $elem=$('#'+this.sId);if(typeof $elem.tokenInput==='function'){$elem.tokenInput(this.sUrl,this.params)}};this.init()};BOM.TechSupport.AddATag=function(oConf){var conf=$.extend({'tokenInputSel':'#tags','defaultTokenInPut':[]},oConf||{});var tokenInputElm=$(conf.tokenInputSel);this.init=function(){$('.tagsBlock .tagsView .tagsBlockTrigger').click(function(){$('.tagsBlock .tagsBlockElm').toggleClass('h');tokenInputElm.tokenInput("clear");$.each(conf.defaultTokenInPut,function(idx,val){tokenInputElm.tokenInput("add",val)})});$('.tagsBlock .tagsEdit .tagsBlockTrigger').click(function(){$('.tagsBlock .tagsBlockElm').toggleClass('h')})};this.init()};BOM.TechSupport.Pagination=function(oConf){var self=this;self.oConf=$.extend({positionSel:'.tcsAnswers + .greyDash',loaderType:''},oConf||{});$('.tcsPagination').live('click',function(event){var loader;event.preventDefault();if(self.oConf.loaderType==='css3'){loader='<span class="ajaxLoader"></span>'}else{loader='<span class="hLoader"></span>'}$(event.target).html(loader);$.get(BOM.Utils.decode($(event.target).attr('rel')),function(data){$(self.oConf.positionSel).last().after(data).slideDown();$(event.target).remove()})})};BOM.TechSupport.TrackTopicCreationError=function(inputId,gaAccount,gaErrorInputField,gaEventScope){$('#'+inputId).bind('invalid',function(){var failed=_gaq.push(['_setAccount',gaAccount],['_trackEvent',gaEventScope,'onError',gaErrorInputField]);if(typeof console!=='undefined'&&typeof console.log!=='undefined'){if(failed){console.log('TrackTopicCreationError failed on '+gaErrorInputField)}else{console.log('TrackTopicCreationError succeeded for '+gaErrorInputField)}}})};BOM.TechSupport.TrackTopicCreationFocus=function(inputId,gaAccount,gaFocusInputField,gaEventScope){$('#'+inputId).focus(function(){var failed=_gaq.push(['_setAccount',gaAccount],['_trackEvent',gaEventScope,'fieldfocus',gaFocusInputField]);if(typeof console!=='undefined'&&typeof console.log!=='undefined'){if(failed){console.log('TrackTopicCreationBlur failed on '+gaFocusInputField)}else{console.log('TrackTopicCreationBlur succeeded for '+gaFocusInputField)}}})};BOM.TechSupport.fillHiddenFormWithQuickResponseContentBeforeSubmitingFormToFullAnswer=function(oConf){$('#'+oConf.formId).submit(function(){var quickAnswerContent=$('#'+oConf.quickAnswerContentId).val();$('#'+oConf.hiddenInputId).val(quickAnswerContent)})};BOM.TechSupport.elastic=function(textareaSelector){var $textArea=$(textareaSelector);if(typeof $textArea.elastic==='function'){$textArea.elastic({'compactTextareaOnBlur':false})}};if(typeof BOM.Utils.toolTip==="undefined"){BOM.Utils.toolTip=function(){}}BOM.Utils.NewToolTip=function(options){new BOM.Utils.toolTip(options)};BOM.Utils.toolTip=function(options){var _self=this;_self.config=$.extend({'trigger':'.tTipTrigger','layer':'','event':'focusin','timer':3000,'fadeTimer':600,'offsetTop':0,'offsetLeft':0,'showOnClass':'','autoHide':true,'dynamicContent':false,'shared':false,'delegateOnSel':false},options||{});_self.init=function(){_self.bindTriggers();$('.infoTip').each(function(){var layer=$(this);if(!layer.hasClass('tooltip-on')){layer.addClass('tooltip-on').appendTo($('body'))}})};_self.onTrigger=function(e){this.toolTipShow(e.currentTarget);e.stopPropagation()};_self.bindTriggers=function(){if(_self.config.delegateOnSel){$(_self.config.delegateOnSel).delegate(_self.config.trigger,"mouseover",function(){var trigger=$(this);if(!trigger.hasClass('tooltip-on')){_self.initBind(trigger)}})}else{if(typeof _self.config.immediateBinding!=='undefined'&&_self.config.immediateBinding===true){$(_self.config.trigger).each(function(){var trigger=$(this);if(!trigger.hasClass('tooltip-on')){_self.initBind(trigger)}})}else{$(_self.config.trigger).bind("mouseover",function(){var trigger=$(this);if(!trigger.hasClass('tooltip-on')){_self.initBind(trigger)}})}}};_self.initBind=function(trigger){trigger.addClass('tooltip-on').bind(_self.config.event,$.proxy(_self,'onTrigger'));if(false===_self.config.autoHide){trigger.bind('mouseout',$.proxy(_self,'tooltipHide'))}};_self.tooltipHide=function(e){var elm=$(e.currentTarget);var layer=elm.data('toolTipLayer');if(typeof layer==='undefined'||!layer.is(':visible')){return}layer.hide();e.stopPropagation()};_self.toolTipShow=function(el){var elm=$(el);if(_self.config.showOnClass&&!(elm.hasClass(_self.config.showOnClass)||elm.children().hasClass(_self.config.showOnClass))){return}var layer=elm.data('toolTipLayer');if(!layer){var tipId=_self.config.shared?elm.attr('data-tipid'):elm.attr('id');layer=_self.config.layer?$(_self.config.layer):$('.'+tipId+'-tTipLayer');elm.data('toolTipLayer',layer)}if(layer.is(':visible')){return}if(false!==_self.config.dynamicContent){_self.setDynamicContent(elm,layer)}var layerPos=elm.data('layerPos');if(!layerPos){layerPos=elm.offset();var elmW=elm.outerWidth();var elmH=elm.outerHeight();var layerW=layer.outerWidth();var layerH=layer.outerHeight();switch(true){case layer.hasClass('infoTipLT'):layerPos.left+=elmW+_self.config.offsetLeft;layerPos.top+=_self.config.offsetTop;break;case layer.hasClass('infoTipLB'):layerPos.left+=elmW+_self.config.offsetLeft;layerPos.top+=-layerH+elmH;break;case layer.hasClass('infoTipRT'):layerPos.left+=-layerW-_self.config.offsetLeft;break;case layer.hasClass('infoTipRB'):layerPos.left+=-layerW-_self.config.offsetLeft;layerPos.top+=-layerH+elmH;break;case layer.hasClass('infoTipBL'):layerPos.left+=_self.config.offsetLeft;layerPos.top+=-layerH-_self.config.offsetTop;break;case layer.hasClass('infoTipBR'):layerPos.left+=elmW-layerW;layerPos.top+=-layerH-_self.config.offsetTop;break;case layer.hasClass('infoTipTL'):layerPos.left+=_self.config.offsetLeft;layerPos.top+=elmH+_self.config.offsetTop;break;case layer.hasClass('infoTipTR'):layerPos.left+=elmW-layerW;layerPos.top+=elmH+_self.config.offsetTop;break}elm.data('layerPos',layerPos)}layer.css(layerPos).toggle();if(true===_self.config.autoHide){layer.delay(_self.config.timer).fadeOut(_self.config.fadeTimer)}return false};_self.setDynamicContent=function(elm,layer){var content='';if(elm.attr('data-tipcontent')){content=elm.attr('data-tipcontent')}else if(elm.attr('data-tipcontentkey')&&('object'===typeof _self.config.dynamicContent)&&(elm.attr('data-tipcontentkey')in _self.config.dynamicContent)){content=_self.config.dynamicContent[elm.attr('data-tipcontentkey')]}layer.find('.infoTipContent').html(content)};_self.init()};(function($){$.fn.bomValidation=function(conf){if(this.is('.jquery-live-validation-on')){return}else{this.addClass('jquery-live-validation-on')}var _self=this;var config=$.extend({valid:'Valid',invalid:'Invalid',validClass:'valid',invalidClass:'invalid',errorClass:'error',isAjax:false,validators:{},validateOnDisplay:false,minWordValidator:2,eventsValidator:'keyup focusout',validateAllFrom:false},conf||{});this.validators=$.extend({'v-carac':/^\s*\S+\s*.*$/m,'v-word':/^(\b[^\s]{2,}\b)\s*$/m,'v-content':/^\s*((\S+)\s+){9,}(\w+|\S+)\s*$/m,'v-dimensions':/^\d+x\d+$/,'v-digit':/^\d+$/,'v-url':/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,'v-email':/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,'v-date-dmY-fr':/^\d{2}\/\d{2}\/(\d{2}|\d{4})$/,'v-date-dmY-de':/^\d{2}\.\d{2}\.(\d{2}|\d{4})$/,'v-date-dmY-en':/^\d{2}\/\d{2}\/(\d{2}|\d{4})$/},config.validators);if(config.minWordValidator){if(typeof config.minWordValidator==='object'){$.each(config.minWordValidator,function(k,v){_self.validators['v-minword'+v]=new RegExp('^\\s*((\\S+)\\s+){'+(parseInt(v,10)-1)+',}(\\w+|\\S+)\\s*$','m')})}else{this.validators['v-minword'+config.minWordValidator]=new RegExp('^\\s*((\\S+)\\s+){'+(parseInt(config.minWordValidator,10)-1)+',}(\\w+|\\S+)\\s*$','m')}}if(config.minCharsValidator){if(typeof config.minCharsValidator==='object'){$.each(config.minCharsValidator,function(k,v){_self.validators['v-minchars'+v]=new RegExp('^\\s*(?:\\S+\\s*){'+parseInt(v,10)+',}$','m')})}else{this.validators['v-minchars'+config.minCharsValidator]=new RegExp('^\\s*(\\S+\\s*){'+parseInt(config.minCharsValidator,10)+',}$','m')}}if(config.maxCharsValidator){if(typeof config.maxCharsValidator==='object'){$.each(config.maxCharsValidator,function(k,v){_self.validators['v-maxchars'+v]=new RegExp('^\\s*.{,'+parseInt(v,10)+'}$','m')})}else{this.validators['v-maxchars'+config.maxCharsValidator]=new RegExp('^\\s*.{3,'+parseInt(config.maxCharsValidator,10)+'}$','m')}}if(config.rangeCharsValidator){if(typeof config.rangeCharsValidator==='object'){if(typeof config.rangeCharsValidator[0]==='object'){$.each(config.rangeCharsValidator,function(k,v){if(typeof v==='array'&&v.length===2){_self.validators['v-rangechars'+v[0]+'-'+v[1]]=new RegExp('^\\s*.{'+parseInt(v[0],10)+','+parseInt(v[1],10)+'}$','m')}})}else{if(config.rangeCharsValidator.length===2){this.validators['v-rangechars'+config.rangeCharsValidator[0]+'-'+config.rangeCharsValidator[1]]=new RegExp('^\\s*.{'+parseInt(config.rangeCharsValidator[0],10)+','+parseInt(config.rangeCharsValidator[1],10)+'}$','m')}}}}this.fields={};this.required=[];this.init=function(){this.setValidators()};this.submitForm=function(form){var urlForm=form.attr('action'),contentForm=form.serialize();$.ajax({type:'POST',url:urlForm,data:contentForm,context:this,beforeSend:function(){_self.toggleSubmitButton(false);form.find('.invalid').removeClass('invalid');form.find('.formError').html('')},success:function(response){_self.response=response;_self.toggleSubmitButton(true);if(typeof response==='string'){var parsedResponse=response;try{parsedResponse=$.parseJSON(parsedResponse)}catch(er){}if(typeof parsedResponse==='object'){response=parsedResponse}}if((typeof response==='object')&&('success'in response)&&false===response.success){if('errors'in response){_self.setAjaxErrorMessages(response.errors)}_self.executeCallbackHandler('error')}else{this.executeCallbackHandler('success')}},error:function(response){_self.response=response;return _self.executeCallbackHandler('error')}})};this.setAjaxErrorMessages=function(errors){$.each(errors,function(cssKey,error){var oForm=$(_self._form);var field=$('.'+cssKey,oForm);var fvalidator=$(field.attr('v-validator'),oForm);var fmsger=$(field.attr('v-msger')?field.attr('v-msger'):'.formError',oForm);fvalidator.removeClass('v-picto-valid').addClass('v-picto-invalid').removeClass('h');fvalidator.attr('alt',config.invalid);field.removeClass(config.validClass).addClass(config.invalidClass);if(fmsger.size()){fmsger.removeClass('h');if('undefined'!==typeof BOM.config.trads[error]){fmsger.html(BOM.config.trads[error])}else{fmsger.html(error)}}})};this.toggleSubmitButton=function(state){var oForm=$(_self._form);if(true===state){$('.v-loader').addClass('h');BOM.User.toggleButton(oForm.find('*[type=submit]'),true)}else{BOM.User.toggleButton(oForm.find('*[type=submit]'),false);$('.v-loader').removeClass('h')}};this.setValidators=function(){$(this).find('.v-required').each(function(){var elm=$(this);var elmName=elm.attr('name');$.each(_self.validators,function(cls,reg){if(elm.hasClass(cls)){_self.fields[elmName]=reg}})})};this.validateAll=function(){$.each(_self.required,function(){if(this.validate&&typeof this.validate==='function'){this.validate()}})};this.executeCallbackHandler=function(cbType){var cbId=_self.attr('v-callback-'+cbType);var ret=true;if(config[cbId]){var param=config[cbId][1];ret=config[cbId][0].call('',_self,param)}return ret};this.init();this.toggleForm=function(){if($(_self).find('.v-picto-invalid:not(.h)').length===0){BOM.User.toggleButton(_self.find('*[type=submit]'),true)}else{BOM.User.toggleButton(_self.find('*[type=submit]'),false)}};this.initFields=function(){$('.v-required',this).bind('valid invalid',this.toggleForm);this.toggleForm();$(this).find('.v-required').each(function(){var t=$(this);var isOptional=false;if(t.is('.jquery-live-validation-on')){return}else{t.addClass('jquery-live-validation-on')}var status=isOptional?'valid':'invalid';var validator=$(t.attr('v-validator'),_self);validator=validator.length?validator:$('<span/>',{'class':"picto h"}).insertAfter(t);validator.attr('alt',status);var msger=$(t.attr('v-msger'),_self);var vmsg=t.attr('msg-data');if(vmsg){msger=msger.length?msger:$('<span/>',{'class':"h v-msger "+config.errorClass}).insertAfter(validator);msger.html(vmsg)}var vEvents=t.attr('v-events')?t.attr('v-events'):config.eventsValidator;var validate=function(){var key=t.attr('name');var val=t.val()||'';var tit=t.attr('title');var type=t.hasClass('v-check')?'check':'val';var id=t.attr('id');var validators=null;val=tit==val?'':val;var isOneOfGroupChecked=false;if(t.hasClass('v-group')){validators=$('*[name="'+key+'"]');$('*[name="'+key+'"]').each(function(){var box=$(this);if(box.is(':checked')){isOneOfGroupChecked=true}})}if('check'===type&&t.hasClass('v-group')&&true==isOneOfGroupChecked){validators.each(function(){$(this).removeClass(config.invalidClass).addClass(config.validClass)});if(validator.attr('alt')!=config.valid){validator.removeClass('v-picto-invalid').addClass('v-picto-valid').removeClass('h');validator.attr('alt',config.valid);if(null!=msger){msger.addClass('h')}if(typeof id!=='undefined'){$('#'+id).trigger('valid')}}}else if('check'===type&&t.is(':checked')){if(validator.attr('alt')!=config.valid){validator.removeClass('v-picto-invalid').addClass('v-picto-valid').removeClass('h');validator.attr('alt',config.valid);t.removeClass(config.invalidClass).addClass(config.validClass);if(null!=msger){msger.addClass('h')}if(typeof id!=='undefined'){$('#'+id).trigger('valid')}}}else{var checker=null;if(typeof _self.fields[key]==='function'){checker=function(){return _self.fields[key](val)}}else{checker=function(){return val.match(_self.fields[key])}}if(('val'===type)&&((isOptional&&val=='')||checker())){if(validator.attr('alt')!=config.valid){validator.removeClass('v-picto-invalid').addClass('v-picto-valid').removeClass('h');validator.attr('alt',config.valid);t.removeClass(config.invalidClass).addClass(config.validClass);if(null!=msger){msger.addClass('h')}if(typeof id!=='undefined'){$('#'+id).trigger('valid')}}}else{if(validator.attr('alt')!=config.invalid){validator.removeClass('v-picto-valid').addClass('v-picto-invalid').removeClass('h');validator.attr('alt',config.invalid);t.removeClass(config.validClass).addClass(config.invalidClass);if(null!=msger){msger.removeClass('h')}}if(typeof id!=='undefined'){$('#'+id).trigger('invalid')}}}if(t.hasClass('v-match-field')&&t.val()!=''){var regex=new RegExp('v-match-field-','g');var split=t.attr('class').split(regex);split=split[1].split(' ');var matchingField=$('#'+split[0]);if(matchingField!=null){if(matchingField.val()==t.val()){validator.removeClass('v-picto-invalid').addClass('v-picto-valid').removeClass('h');validator.attr('alt',config.valid);matchingField.removeClass(config.invalidClass).addClass(config.validClass);if(null!=msger){msger.addClass('h')}if(typeof id!=='undefined'){$('#'+id).trigger('valid')}}else{validator.removeClass('v-picto-valid').addClass('v-picto-invalid').removeClass('h');validator.attr('alt',config.invalid);matchingField.removeClass(config.validClass).addClass(config.invalidClass);if(null!=msger){msger.removeClass('h')}if(typeof id!=='undefined'){$('#'+id).trigger('invalid')}}}}};if(true===config.validateOnDisplay){validate()}t.bind(vEvents,function(){validate();if(false!==config.validateAllFrom&&true===t.is(config.validateAllFrom)){_self.validateAll()}});_self.required.push({'elm':t,'validate':validate})})};this.initFields();$(this).submit(function(){_self.setValidators();_self.initFields();_self._form=this;if(!config.validateOnDisplay){_self.validateAll()}_self.toggleSubmitButton(false);var errors=$(this).find('span[alt="'+config.invalid+'"]');if(errors.length){$(this).find('.v-required.invalid').first().focus()}if(config.isAjax&&!errors.length){_self.submitForm($(this));return false}BOM.User.addLoadingStatusOnElement($('button',this));var codeReturn=true;if(!errors.length){var cbReturn=_self.executeCallbackHandler('success');if(false===cbReturn){codeReturn=false}}else{codeReturn=false;BOM.User.removeLoadingStatusOnPageButtons()}return codeReturn})}}(jQuery));BOM=BOM||{};BOM.Forum=BOM.Forum||{};BOM.Forum.TopicCreation=BOM.Forum.TopicCreation||{};BOM.Forum.TopicCreation.CheckBoxesManager=function(oConf){oConf=$.extend({trigger:null,target:null,init:true},oConf||{});var self=this;self.oConf=oConf;self.init=function(){$(self.oConf.trigger).bind('change',self.toggle)};self.toggle=function(event){var isTriggerChecked=$(event.target).is(':checked');var $targetElements=$(self.oConf.target).filter(':checked');if(isTriggerChecked&&$targetElements.length>0){$targetElements.attr('checked',false);$targetElements.change()}};if(oConf.init){self.init()}return self};BOM.Forum.TopicCreation.PollMoreAnswer=function(oConf){oConf=$.extend({init:true,trigger:'.pollForm .moreAnswer',answers:'.pollForm .answers'},oConf||{});var self=this;self.oConf=oConf;self.init=function(){$(self.oConf.trigger).bind('click',self.moreAnswer)};self.moreAnswer=function(e){var hiddenChildren=$(self.oConf.answers).children('.h');var firstHiddenChild=hiddenChildren.first();if(hiddenChildren.length!==0){firstHiddenChild.removeClass('h')}if(hiddenChildren.length<=1){$(e.target).addClass('h')}e.preventDefault();return false};if(oConf.init){self.init()}return self};BOM.Forum.TopicCreation.xtClick=function(oConf){oConf=$.extend({init:true,selector:'.dynamic-bomxtclick',categorySelector:'#post_frm_category_id',mainService:null,questionCheckboxSelector:'#post_question'},oConf||{});var self=this;self.xt=null;self.oConf=oConf;self.l2RegExp=/xtService_(.*)_([0-9]+)/;self.init=function(){self.xt=new BOM.Xiti.xtClick({init:false,selector:null});self.xt.init.call(self)};self.getXtParams=function(el){var params=self.xt.getXtParams.call(self,el);params[0]=self.getDynamicL2();return params};self.getDynamicL2=function(){var option=self.getSelectedOption();var classesArray=self.getXitiL2ClassesFromOption(option);if(classesArray.length===0){throw{name:'Error',message:'Xiti error: option must have a xtService_[service]_[Level2 ID] class'}}if(classesArray.length===1){return self.getL2FromClass(classesArray[0])}else{if(self.oConf.mainService!==null){if($.inArray(self.oConf.mainService,classesArray)>-1){return self.getL2FromClass(self.oConf.mainService)}else{throw{name:'Error',message:'Xiti error: option should contain '+self.oConf.mainService+' class'}}}else{var service=self.isQuestionCheckboxChecked()?'tcs':'frm';var serviceClass=self.getServiceClass(classesArray,service);return self.getL2FromClass(serviceClass)}}};self.getSelectedOption=function(){return $(self.oConf.categorySelector).find('option:selected')};self.getXitiL2ClassesFromOption=function(option){return $.map($(option).attr('class').split(' '),function(n){if(n!==''&&self.l2RegExp.test(n)){return n}})};self.getL2FromClass=function(classname){var res=self.l2RegExp.exec(classname);if(res.length===3){return res[2]}};self.isQuestionCheckboxChecked=function(){return $(self.oConf.questionCheckboxSelector).is(':checked')};self.getServiceClass=function(classesArray,service){for(var i=0;i<classesArray.length;i++){var res=self.l2RegExp.exec(classesArray[i]);if(res.length===3&&res[1]===service){return classesArray[i]}}return null};self.setXtClick=function(e){return self.xt.setXtClick.call(self,e)};self.getXtClickElement=function(el){return self.xt.getXtClickElement.call(this,el)};if(self.oConf.init){self.init()}return self};BOM.Utils.moreDialog=function(){var self=this;self.init=function(){self.trigger=$('.moreDialog-trigger');$(self.trigger).live('click',function(e){e.preventDefault();self.closeBtText=$.trim($(e.currentTarget).text());self.dialogOptions={'width':'auto','dialogClass':'moreDialog-dialog','closeText':'',open:function(){self.closeBt=$('<a>',{'class':'moreDialog moreDialog-close ib','text':self.closeBtText}).append($('<span>',{'class':'picto pictoUp'}));$('.moreDialog-close').live('click',function(){$.data(self.closeBt,'modale').dialog('close')});self.closeBtTarget=$(self.layer).prev('.ui-dialog-titlebar');$.data(self.closeBt,'modale',$(self.layer));self.closeBt.appendTo(self.closeBtTarget)},close:function(){self.cleanup(self.layer)}};self.cleanup('.'+self.dialogOptions.dialogClass);self.builder(e)})};self.cleanup=function(elm){$(elm).dialog('destroy');$(elm).remove()};self.builder=function(e){if($('.moreDialog-layer').length>0){self.cleanup($('.moreDialog-layer'))}self.layer=$('<div>',{'class':'moreDialog-layer'}).append($('<div>',{'class':'moreDialog-content'}));var position=$(e.currentTarget).offset();$(self.layer).dialog(self.dialogOptions);$(self.layer).parent().css({left:position['left']-6,top:position['top']-5});self.content=$(self.layer).find(":nth-child(1)");self.content.addClass('ajaxLoader');self.updater(e)};self.updater=function(e){var urlAjax=BOM.Utils.decode($(e.currentTarget).attr('rel'));$.ajax({url:urlAjax,success:function(xhr){self.content.removeClass('ajaxLoader').html(xhr)}})};self.init()};head.ready("search",function(){jQuery(function(){if(typeof BOM.Ajaxy!='undefined'&&typeof BOM.Search!='undefined'){BOM.Ajaxy.init(BOM.Search.searchConf)}})});(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type=="mouseenter"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.bind('mouseenter',handleHover).bind('mouseleave',handleHover)}})(jQuery);head.ready("memberNotifications",function(){jQuery(function(){BOM.User.memberNotifications.initModule()})});head.js({ajaxCompleter:"http://m.bestofmedia.com/sfp/js/minified/utils/ajaxCompleter.min.js?r=d691037003c94a195e25afcc1624aa8f132ab156"},{ajaxDialog:"http://m.bestofmedia.com/sfp/js/minified/BOM/AjaxDialog.min.js?r=d691037003c94a195e25afcc1624aa8f132ab156"},{ajaxDialogLogin:"http://m.bestofmedia.com/sfp/js/minified/BOM/AjaxDialogLogin.min.js?r=d691037003c94a195e25afcc1624aa8f132ab156"},{html5:"http://m.bestofmedia.com/sfp/js/minified/lib/html5shiv.min.js?r=d691037003c94a195e25afcc1624aa8f132ab156"},{beacon:"http://m.bestofmedia.com/sfp/js/minified/testedJs/BOM/Tools/RefreshBeacons.min.js?r=d691037003c94a195e25afcc1624aa8f132ab156"},{ajaxy:"http://m.bestofmedia.com/sfp/js/minified/plugins/jquery.ajaxy.min.js?r=d691037003c94a195e25afcc1624aa8f132ab156"},{totop:"http://m.bestofmedia.com/sfp/js/minified/plugins/jquery.ui.totop.min.js?r=d691037003c94a195e25afcc1624aa8f132ab156"},{search:"http://m.bestofmedia.com/sfp/js/minified/sitesearch.min.js?r=d691037003c94a195e25afcc1624aa8f132ab156"},{memberNotifications:"http://m.bestofmedia.com/sfp/js/minified/testedJs/BOM/User/memberNotifications.min.js?r=d691037003c94a195e25afcc1624aa8f132ab156"},{askQuestion:"http://m.bestofmedia.com/sfp/js/minified/BOM/Forum/askQuestion.min.js?r=d691037003c94a195e25afcc1624aa8f132ab156"});head.ready(function(){head.js()});