/*! Build 2.6.12-mvt at Wed Jan 11 2017 10:46:33 GMT+0000 (UTC) for live */
define(function(){return function(t){function i(e){if(n[e])return n[e].exports;var o=n[e]={exports:{},id:e,loaded:!1};return t[e].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}var e=window.notifWebpackP;window.notifWebpackP=function(i,n,a){for(var r,s,c=0,u=[];c<i.length;c++)s=i[c],o[s]&&u.push(o[s][0]),o[s]=0;for(r in n)t[r]=n[r];for(e&&e(i,n);u.length;)u.shift()()};var n={},o={0:0};return i.e=function(t){function e(){a.onerror=a.onload=null,clearTimeout(r);var i=o[t];0!==i&&(i&&i[1](new Error("Loading chunk "+t+" failed.")),o[t]=void 0)}if(0===o[t])return Promise.resolve();if(o[t])return o[t][2];var n=document.getElementsByTagName("head")[0],a=document.createElement("script");a.type="text/javascript",a.charset="utf-8",a.async=!0,a.timeout=12e4,a.src=i.p+""+t+".NotificationsMain.js";var r=setTimeout(e,12e4);a.onerror=a.onload=e,n.appendChild(a);var s=new Promise(function(i,e){o[t]=[i,e]});return o[t][2]=s},i.m=t,i.c=n,i.oe=function(t){throw t},i.p="",i(i.s=30)}([function(t,i,e){var n;!function(o,a){"use strict";function r(t,i,e){var n={};return n[t.key]=i,t.pos&&(n[t.pos]=e),n}function s(t,i){for(var e,n=i.length,o=t.length;n>o;)e=i[--n],i.splice(n,1),e.unmount()}function c(t,i){Object.keys(t.tags).forEach(function(e){var n=t.tags[e];R(n)?v(n,function(t){M(t,e,i)}):M(n,e,i)})}function u(t,i,e){var n,o=t._root;for(t._virts=[];o;)n=o.nextSibling,e?i.insertBefore(o,e._root):i.appendChild(o),t._virts.push(o),o=n}function l(t,i,e,n){for(var o,a=t._root,r=0;r<n;r++)o=a.nextSibling,i.insertBefore(a,e._root),a=o}function d(t,i,e,n,o,a,r){W(i.root)||(t?a(i,n,e,r.childNodes.length):n.insertBefore(i.root,e.root))}function f(t,i,e){C(t,"each");var n,o=typeof x(t,"no-reorder")!==rt||C(t,"no-reorder"),a=L(t),f=it[a]||{tmpl:k(t)},h=ft.test(a),p=t.parentNode,m=document.createTextNode(""),b=O(t),y="option"===a.toLowerCase(),v=[],w=[],_="VIRTUAL"==t.tagName;e=yt.loopKeys(e),p.insertBefore(m,t),i.one("before-mount",function(){t.parentNode.removeChild(t),p.stub&&(p=i.root)}).on("update",function(){var k=yt(e.val,i),E=document.createDocumentFragment();R(k)||(n=k||!1,k=n?Object.keys(k).map(function(t){return r(e,t,k[t])}):[]);for(var T=0,C=k.length;T<C;T++){var P=k[T],x=o&&typeof P==st&&!n,S=w.indexOf(P),O=~S&&x?S:T,N=v[O];P=!n&&e.key?r(e,P,T):P,!x&&!N||x&&!~S||!N?(N=new g(f,{parent:i,isLoop:!0,hasImpl:!!it[a],root:h?p:t.cloneNode(),item:P},t.innerHTML),N.mount(),_&&(N._root=N.root.firstChild),T!=v.length&&v[T]?(d(_,N,v[T],p,v,u,t),w.splice(T,0,P)):_?u(N,E):E.appendChild(N.root),v.splice(T,0,N),O=T):N.update(P,!0),O!==T&&x&&v[T]&&(B(k,w[T])&&d(_,N,v[T],p,v,l,t),e.pos&&(N[e.pos]=T),v.splice(T,0,v.splice(O,1)[0]),w.splice(T,0,w.splice(O,1)[0]),!b&&N.tags&&c(N,T)),N._item=P,D(N,"_parent",i)}if(s(k,v),p.insertBefore(E,m),y&&mt&&!p.multiple)for(var M=0;M<p.length;M++)if(p[M].__riot1374){p.selectedIndex=M,delete p[M].__riot1374;break}b&&(i.tags[a]=v),w=k.slice()})}function h(t,i,e,n){H(t,function(t){if(1==t.nodeType){if(t.isLoop=t.isLoop||t.parentNode&&t.parentNode.isLoop||x(t,"each")?1:0,e){var o=O(t);o&&!t.isLoop&&e.push(I(o,{root:t,parent:i},t.innerHTML,i))}t.isLoop&&!n||J(t,i,[])}})}function p(t,i,e){function n(t,i,n){yt.hasExpr(i)&&e.push(j({dom:t,expr:i},n))}H(t,function(t){var e,o=t.nodeType;if(3==o&&"STYLE"!=t.parentNode.tagName&&n(t,t.nodeValue),1==o)return(e=x(t,"each"))?(f(t,i,e),!1):(v(t.attributes,function(i){var e=i.name,o=e.split("__")[1];if(n(t,i.value,{attr:o||e,bool:o}),o)return C(t,e),!1}),!O(t)&&void 0)})}function g(t,i,e){function n(){var t=m&&g?l:f||l;v(E.attributes,function(i){var e=i.value;d[P(i.name)]=yt.hasExpr(e)?yt(e,t):e}),v(Object.keys(O),function(i){d[P(i)]=yt(O[i],t)})}function o(t){for(var i in b)typeof l[i]!==ct&&U(l,i)&&(l[i]=t[i])}function r(t){v(Object.keys(t),function(i){var e=!ht.test(i)&&B(N,i);(typeof l[i]===ct||e)&&(e||N.push(i),l[i]=t[i])})}function s(t){l.update(t,!0)}function c(t){if(v(_,function(i){i[t?"mount":"unmount"]()}),f){var i=t?"on":"off";g?f[i]("unmount",l.unmount):f[i]("update",s)[i]("unmount",l.unmount)}}var u,l=Q.observable(this),d=z(i.opts)||{},f=i.parent,g=i.isLoop,m=i.hasImpl,b=F(i.item),k=[],_=[],E=i.root,x=E.tagName.toLowerCase(),O={},N=[];t.name&&E._tag&&E._tag.unmount(!0),this.isMounted=!1,E.isLoop=g,E._tag=this,D(this,"_riot_id",++Z),j(this,{parent:f,root:E,opts:d},b),D(this,"tags",{}),v(E.attributes,function(t){var i=t.value;yt.hasExpr(i)&&(O[t.name]=i)}),u=vt(t.tmpl,e,g),D(this,"update",function(t,i){return t=F(t),g&&r(l.parent),t&&T(b)&&(o(t),b=t),j(l,t),n(),l.trigger("update",t),y(k,l),i&&l.parent?l.parent.one("updated",function(){l.trigger("updated")}):kt(function(){l.trigger("updated")}),this}),D(this,"mixin",function(){return v(arguments,function(t){var i,e,n=[];t=typeof t===rt?Q.mixin(t):t,i=w(t)?new t:t;var o=Object.getPrototypeOf(i);do n=n.concat(Object.getOwnPropertyNames(e||i));while(e=Object.getPrototypeOf(e||i));v(n,function(t){if("init"!=t){var e=Object.getOwnPropertyDescriptor(i,t)||Object.getOwnPropertyDescriptor(o,t),n=e&&(e.get||e.set);!l.hasOwnProperty(t)&&n?Object.defineProperty(l,t,e):l[t]=w(i[t])?i[t].bind(l):i[t]}}),i.init&&i.init.bind(l)()}),this}),D(this,"mount",function(){n();var i=Q.mixin(et);if(i)for(var e in i)i.hasOwnProperty(e)&&l.mixin(i[e]);if(l._parent&&l._parent.root.isLoop&&r(l._parent),t.fn&&t.fn.call(l,d),p(u,l,k),c(!0),t.attrs&&G(t.attrs,function(t,i){S(E,t,i)}),(t.attrs||m)&&p(l.root,l,k),l.parent&&!g||l.update(b),l.trigger("before-mount"),g&&!m)E=u.firstChild;else{for(;u.firstChild;)E.appendChild(u.firstChild);E.stub&&(E=f.root)}D(l,"root",E),g&&h(l.root,l.parent,null,!0),!l.parent||l.parent.isMounted?(l.isMounted=!0,l.trigger("mount")):l.parent.one("mount",function(){W(l.root)||(l.parent.isMounted=l.isMounted=!0,l.trigger("mount"))})}),D(this,"unmount",function(t){var i,e=E,n=e.parentNode,o=tt.indexOf(l);if(l.trigger("before-unmount"),~o&&tt.splice(o,1),n){if(f)i=A(f),R(i.tags[x])?v(i.tags[x],function(t,e){t._riot_id==l._riot_id&&i.tags[x].splice(e,1)}):i.tags[x]=a;else for(;e.firstChild;)e.removeChild(e.firstChild);t?(C(n,at),C(n,ot)):n.removeChild(e)}this._virts&&v(this._virts,function(t){t.parentNode&&t.parentNode.removeChild(t)}),l.trigger("unmount"),c(),l.off("*"),l.isMounted=!1,delete E._tag}),h(u,this,_)}function m(t,i,e,n){e[t]=function(t){var a,r=n._parent,s=n._item;if(!s)for(;r&&!s;)s=r._item,r=r._parent;t=t||o.event,U(t,"currentTarget")&&(t.currentTarget=e),U(t,"target")&&(t.target=t.srcElement),U(t,"which")&&(t.which=t.charCode||t.keyCode),t.item=s,i.call(n,t)===!0||/radio|check/.test(e.type)||(t.preventDefault&&t.preventDefault(),t.returnValue=!1),t.preventUpdate||(a=s?A(r):n,a.update())}}function b(t,i,e){t&&(t.insertBefore(e,i),t.removeChild(i))}function y(t,i){v(t,function(t,e){var n=t.dom,o=t.attr,a=yt(t.expr,i),r=t.parent||t.dom.parentNode;if(t.bool?a=!!a:null==a&&(a=""),t.value!==a){if(t.value=a,!o)return a+="",void(r&&(t.parent=r,"TEXTAREA"===r.tagName?(r.value=a,gt||(n.nodeValue=a)):n.nodeValue=a));if("value"===o)return void(n.value!==a&&(n.value=a,S(n,o,a)));if(C(n,o),w(a))m(o,a,n,i);else if("if"==o){var s=t.stub,c=function(){b(s.parentNode,s,n)},u=function(){b(n.parentNode,n,s)};a?s&&(c(),n.inStub=!1,W(n)||H(n,function(t){t._tag&&!t._tag.isMounted&&(t._tag.isMounted=!!t._tag.trigger("mount"))})):(s=t.stub=s||document.createTextNode(""),n.parentNode?u():(i.parent||i).one("updated",u),n.inStub=!0)}else"show"===o?n.style.display=a?"":"none":"hide"===o?n.style.display=a?"none":"":t.bool?(n[o]=a,a&&S(n,o,o),mt&&"selected"===o&&"OPTION"===n.tagName&&(n.__riot1374=a)):(0===a||a&&typeof a!==st)&&(V(o,nt)&&o!=ot&&(o=o.slice(nt.length)),S(n,o,a))}})}function v(t,i){for(var e,n=t?t.length:0,o=0;o<n;o++)e=t[o],null!=e&&i(e,o)===!1&&o--;return t}function w(t){return typeof t===ut||!1}function k(t){if(t.outerHTML)return t.outerHTML;var i=q("div");return i.appendChild(t.cloneNode(!0)),i.innerHTML}function _(t,i){if(typeof t.innerHTML!=ct)t.innerHTML=i;else{var e=(new DOMParser).parseFromString(i,"application/xml");t.appendChild(t.ownerDocument.importNode(e.documentElement,!0))}}function E(t){return~pt.indexOf(t)}function T(t){return t&&typeof t===st}function C(t,i){t.removeAttribute(i)}function P(t){return t.replace(/-(\w)/g,function(t,i){return i.toUpperCase()})}function x(t,i){return t.getAttribute(i)}function S(t,i,e){var n=dt.exec(i);n&&n[1]?t.setAttributeNS(lt,n[1],e):t.setAttribute(i,e)}function O(t){return t.tagName&&it[x(t,at)||x(t,ot)||t.tagName.toLowerCase()]}function N(t,i,e){var n=e.tags[i];n?(R(n)||n!==t&&(e.tags[i]=[n]),B(e.tags[i],t)||e.tags[i].push(t)):e.tags[i]=t}function M(t,i,e){var n,o=t.parent;o&&(n=o.tags[i],R(n)?n.splice(e,0,n.splice(n.indexOf(t),1)[0]):N(t,i,o))}function I(t,i,e,n){var o=new g(t,i,e),a=L(i.root),r=A(n);return o.parent=r,o._parent=n,N(o,a,r),r!==n&&N(o,a,n),i.root.innerHTML="",o}function A(t){for(var i=t;!O(i.root)&&i.parent;)i=i.parent;return i}function D(t,i,e,n){return Object.defineProperty(t,i,j({value:e,enumerable:!1,writable:!1,configurable:!0},n)),t}function L(t){var i=O(t),e=x(t,"name"),n=e&&!yt.hasExpr(e)?e:i?i.name:t.tagName.toLowerCase();return n}function j(t){for(var i,e=arguments,n=1;n<e.length;++n)if(i=e[n])for(var o in i)U(t,o)&&(t[o]=i[o]);return t}function B(t,i){return~t.indexOf(i)}function R(t){return Array.isArray(t)||t instanceof Array}function U(t,i){var e=Object.getOwnPropertyDescriptor(t,i);return typeof t[i]===ct||e&&e.writable}function F(t){if(!(t instanceof g||t&&typeof t.trigger==ut))return t;var i={};for(var e in t)ht.test(e)||(i[e]=t[e]);return i}function H(t,i){if(t){if(i(t)===!1)return;for(t=t.firstChild;t;)H(t,i),t=t.nextSibling}}function G(t,i){for(var e,n=/([-\w]+) ?= ?(?:"([^"]*)|'([^']*)|({[^}]*}))/g;e=n.exec(t);)i(e[1].toLowerCase(),e[2]||e[3]||e[4])}function W(t){for(;t;){if(t.inStub)return!0;t=t.parentNode}return!1}function q(t,i){return i?document.createElementNS("http://www.w3.org/2000/svg","svg"):document.createElement(t)}function K(t,i){return(i||document).querySelectorAll(t)}function $(t,i){return(i||document).querySelector(t)}function z(t){return Object.create(t||null)}function Y(t){return x(t,"id")||x(t,"name")}function J(t,i,e){var n,o=Y(t),a=function(a){B(e,o)||(n=R(a),a?(!n||n&&!B(a,t))&&(n?a.push(t):i[o]=[a,t]):i[o]=t)};o&&(yt.hasExpr(o)?i.one("mount",function(){o=Y(t),a(i[o])}):a(i[o]))}function V(t,i){return t.slice(0,i.length)===i}function X(t,i,e){var n=it[i],o=t._innerHTML=t._innerHTML||t.innerHTML;return t.innerHTML="",n&&t&&(n=new g(n,{root:t,opts:e},o)),n&&n.mount&&(n.mount(),B(tt,n)||tt.push(n)),n}var Q={version:"v2.6.7",settings:{}},Z=0,tt=[],it={},et="__global_mixin",nt="riot-",ot=nt+"tag",at="data-is",rt="string",st="object",ct="undefined",ut="function",lt="http://www.w3.org/1999/xlink",dt=/^xlink:(\w+)/,ft=/^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?|opt(?:ion|group))$/,ht=/^(?:_(?:item|id|parent)|update|root|(?:un)?mount|mixin|is(?:Mounted|Loop)|tags|parent|opts|trigger|o(?:n|ff|ne))$/,pt=["altGlyph","animate","animateColor","circle","clipPath","defs","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","filter","font","foreignObject","g","glyph","glyphRef","image","line","linearGradient","marker","mask","missing-glyph","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","switch","symbol","text","textPath","tref","tspan","use"],gt=0|(o&&o.document||{}).documentMode,mt=o&&!!o.InstallTrigger;Q.observable=function(t){function i(t,i){for(var e=t.split(" "),n=e.length,o=0;o<n;o++){var a=e[o];a&&i(a,o)}}t=t||{};var e={},n=Array.prototype.slice;return Object.defineProperties(t,{on:{value:function(n,o){return"function"!=typeof o?t:(i(n,function(t,i){(e[t]=e[t]||[]).push(o),o.typed=i>0}),t)},enumerable:!1,writable:!1,configurable:!1},off:{value:function(n,o){return"*"!=n||o?i(n,function(t,i){if(o)for(var n,a=e[t],r=0;n=a&&a[r];++r)n==o&&a.splice(r--,1);else delete e[t]}):e={},t},enumerable:!1,writable:!1,configurable:!1},one:{value:function(i,e){function n(){t.off(i,n),e.apply(t,arguments)}return t.on(i,n)},enumerable:!1,writable:!1,configurable:!1},trigger:{value:function(o){for(var a,r=arguments.length-1,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c+1];return i(o,function(i,o){a=n.call(e[i]||[],0);for(var r,c=0;r=a[c];++c)r.busy||(r.busy=1,r.apply(t,r.typed?[i].concat(s):s),a[c]!==r&&c--,r.busy=0);e["*"]&&"*"!=i&&t.trigger.apply(t,["*",i].concat(s))}),t},enumerable:!1,writable:!1,configurable:!1}}),t},function(t){function i(t){return t.split(/[\/?#]/)}function e(t,i){var e=new RegExp("^"+i[T](/\*/g,"([^/?#]+?)")[T](/\.\./,".*")+"$"),n=t.match(e);if(n)return n.slice(1)}function n(t,i){var e;return function(){clearTimeout(e),e=setTimeout(t,i)}}function a(t){p=n(d,1),O[_](C,p),O[_](P,p),N[_](D,f),t&&d(!0)}function r(){this.$=[],t.observable(this),j.on("stop",this.s.bind(this)),j.on("emit",this.e.bind(this))}function s(t){return t[T](/^\/|\/$/,"")}function c(t){return"string"==typeof t}function u(t){return(t||I.href)[T](v,"")}function l(t){return"#"==g[0]?(t||I.href||"").split(g)[1]||"":(I?u(t):t||"")[T](g,"")}function d(t){var i,e=0==U;if(!(S<=U)&&(U++,R.push(function(){var i=l();(t||i!=m)&&(j[x]("emit",i),m=i)}),e)){for(;i=R.shift();)i();U=0}}function f(t){if(!(1!=t.which||t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)){for(var i=t.target;i&&"A"!=i.nodeName;)i=i.parentNode;!i||"A"!=i.nodeName||i[E]("download")||!i[E]("href")||i.target&&"_self"!=i.target||i.href.indexOf(I.href.match(v)[0])==-1||i.href!=I.href&&(i.href.split("#")[0]==I.href.split("#")[0]||"#"!=g[0]&&0!==u(i.href).indexOf(g)||"#"==g[0]&&i.href.split(g)[0]!=I.href.split(g)[0]||!h(l(i.href),i.title||N.title))||t.preventDefault()}}function h(t,i,e){return M?(t=g+s(t),i=i||N.title,e?M.replaceState(null,i,t):M.pushState(null,i,t),N.title=i,B=!1,d(),B):j[x]("emit",l(t))}var p,g,m,b,y,v=/^.+?\/\/+[^\/]+/,w="EventListener",k="remove"+w,_="add"+w,E="hasAttribute",T="replace",C="popstate",P="hashchange",x="trigger",S=3,O="undefined"!=typeof o&&o,N="undefined"!=typeof document&&document,M=O&&history,I=O&&(M.location||O.location),A=r.prototype,D=N&&N.ontouchstart?"touchstart":"click",L=!1,j=t.observable(),B=!1,R=[],U=0;A.m=function(t,i,e){!c(t)||i&&!c(i)?i?this.r(t,i):this.r("@",t):h(t,i,e||!1)},A.s=function(){this.off("*"),this.$=[]},A.e=function(t){this.$.concat("@").some(function(i){var e=("@"==i?b:y)(s(t),s(i));if("undefined"!=typeof e)return this[x].apply(null,[i].concat(e)),B=!0},this)},A.r=function(t,i){"@"!=t&&(t="/"+s(t),this.$.push(t)),this.on(t,i)};var F=new r,H=F.m.bind(F);H.create=function(){var t=new r,i=t.m.bind(t);return i.stop=t.s.bind(t),i},H.base=function(t){g=t||"#",m=l()},H.exec=function(){d(!0)},H.parser=function(t,n){t||n||(b=i,y=e),t&&(b=t),n&&(y=n)},H.query=function(){var t={},i=I.href||m;return i[T](/[?&](.+?)=([^&]*)/g,function(i,e,n){t[e]=n}),t},H.stop=function(){L&&(O&&(O[k](C,p),O[k](P,p),N[k](D,f)),j[x]("stop"),L=!1)},H.start=function(t){L||(O&&("complete"==document.readyState?a(t):O[_]("load",function(){setTimeout(function(){a(t)},1)})),L=!0)},H.base(),H.parser(),t.route=H}(Q);var bt=function(t){function i(t){return t}function e(t,i){return i||(i=v),new RegExp(t.source.replace(/{/g,i[2]).replace(/}/g,i[3]),t.global?u:"")}function n(t){if(t===m)return b;var i=t.split(" ");if(2!==i.length||h.test(t))throw new Error('Unsupported brackets "'+t+'"');return i=i.concat(t.replace(p,"\\").split(" ")),i[4]=e(i[1].length>1?/{[\S\s]*?}/:b[4],i),i[5]=e(t.length>3?/\\({|})/g:b[5],i),i[6]=e(b[6],i),i[7]=RegExp("\\\\("+i[3]+")|([[({])|("+i[3]+")|"+f,u),i[8]=t,i}function o(t){return t instanceof RegExp?s(t):v[t]}function a(t){(t||(t=m))!==v[8]&&(v=n(t),s=t===m?i:e,v[9]=s(b[9])),y=t}function r(t){var i;t=t||{},i=t.brackets,Object.defineProperty(t,"brackets",{set:a,get:function(){return y},enumerable:!0}),c=t,a(i)}var s,c,u="g",l=/\/\*[^*]*\*+(?:[^*\/][^*]*\*+)*\//g,d=/"[^"\\]*(?:\\[\S\s][^"\\]*)*"|'[^'\\]*(?:\\[\S\s][^'\\]*)*'/g,f=d.source+"|"+/(?:\breturn\s+|(?:[$\w\)\]]|\+\+|--)\s*(\/)(?![*\/]))/.source+"|"+/\/(?=[^*\/])[^[\/\\]*(?:(?:\[(?:\\.|[^\]\\]*)*\]|\\.)[^[\/\\]*)*?(\/)[gim]*/.source,h=RegExp("[\\x00-\\x1F<>a-zA-Z0-9'\",;\\\\]"),p=/(?=[[\]()*+?.^$|])/g,g={"(":RegExp("([()])|"+f,u),"[":RegExp("([[\\]])|"+f,u),"{":RegExp("([{}])|"+f,u)},m="{ }",b=["{","}","{","}",/{[^}]*}/,/\\([{}])/g,/\\({)|{/g,RegExp("\\\\(})|([[({])|(})|"+f,u),m,/^\s*{\^?\s*([$\w]+)(?:\s*,\s*(\S+))?\s+in\s+(\S.*)\s*}/,/(^|[^\\]){=[\S\s]*?}/],y=t,v=[];return o.split=function(t,i,e){function n(t){i||r?u.push(t&&t.replace(e[5],"$1")):u.push(t)}function o(t,i,e){var n,o=g[i];for(o.lastIndex=e,e=1;(n=o.exec(t))&&(!n[1]||(n[1]===i?++e:--e)););return e?t.length:o.lastIndex}e||(e=v);var a,r,s,c,u=[],l=e[6];for(r=s=l.lastIndex=0;a=l.exec(t);){if(c=a.index,r){if(a[2]){l.lastIndex=o(t,a[2],l.lastIndex);continue}if(!a[3])continue}a[1]||(n(t.slice(s,c)),s=l.lastIndex,l=e[6+(r^=1)],l.lastIndex=s)}return t&&s<t.length&&n(t.slice(s)),u},o.hasExpr=function(t){return v[4].test(t)},o.loopKeys=function(t){var i=t.match(v[9]);return i?{key:i[1],pos:i[2],val:v[0]+i[3].trim()+v[1]}:{val:t.trim()}},o.array=function(t){return t?n(t):v},Object.defineProperty(o,"settings",{set:r,get:function(){return c}}),o.settings="undefined"!=typeof Q&&Q.settings||{},o.set=a,o.R_STRINGS=d,o.R_MLCOMMS=l,o.S_QBLOCKS=f,o}(),yt=function(){function t(t,n){return t?(s[t]||(s[t]=e(t))).call(n,i):t}function i(i,e){t.errorHandler&&(i.riotData={tagName:e&&e.root&&e.root.tagName,_riot_id:e&&e._riot_id},t.errorHandler(i))}function e(t){var i=n(t);return"try{return "!==i.slice(0,11)&&(i="return "+i),new Function("E",i+";")}function n(t){var i,e=[],n=bt.split(t.replace(d,'"'),1);if(n.length>2||n[0]){var o,r,s=[];for(o=r=0;o<n.length;++o)i=n[o],i&&(i=1&o?a(i,1,e):'"'+i.replace(/\\/g,"\\\\").replace(/\r\n?|\n/g,"\\n").replace(/"/g,'\\"')+'"')&&(s[r++]=i);i=r<2?s[0]:"["+s.join(",")+'].join("")'}else i=a(n[1],0,e);return e[0]&&(i=i.replace(f,function(t,i){return e[i].replace(/\r/g,"\\r").replace(/\n/g,"\\n")})),i}function a(t,i,e){function n(i,e){var n,o=1,a=h[i];for(a.lastIndex=e.lastIndex;n=a.exec(t);)if(n[0]===i)++o;else if(!--o)break;e.lastIndex=o?t.length:a.lastIndex}if(t=t.replace(l,function(t,i){return t.length>2&&!i?c+(e.push(t)-1)+"~":t}).replace(/\s+/g," ").trim().replace(/\ ?([[\({},?\.:])\ ?/g,"$1")){for(var o,a=[],s=0;t&&(o=t.match(u))&&!o.index;){var d,f,p=/,|([[{(])|$/g;for(t=RegExp.rightContext,d=o[2]?e[o[2]].slice(1,-1).trim().replace(/\s+/g," "):o[1];f=(o=p.exec(t))[1];)n(f,p);f=t.slice(0,o.index),t=RegExp.rightContext,a[s++]=r(f,1,d)}t=s?s>1?"["+a.join(",")+'].join(" ").trim()':a[0]:r(t,i)}return t}function r(t,i,e){var n;return t=t.replace(g,function(t,i,e,o,a){return e&&(o=n?0:o+t.length,"this"!==e&&"global"!==e&&"window"!==e?(t=i+'("'+e+p+e,o&&(n="."===(a=a[o])||"("===a||"["===a)):o&&(n=!m.test(a.slice(o)))),t}),n&&(t="try{return "+t+"}catch(e){E(e,this)}"),e?t=(n?"function(){"+t+"}.call(this)":"("+t+")")+'?"'+e+'":""':i&&(t="function(v){"+(n?t.replace("return ","v="):"v=("+t+")")+';return v||v===0?v:""}.call(this)'),t}var s={};t.haveRaw=bt.hasRaw,t.hasExpr=bt.hasExpr,t.loopKeys=bt.loopKeys,t.clearCache=function(){s={}},t.errorHandler=null;var c=String.fromCharCode(8279),u=/^(?:(-?[_A-Za-z\xA0-\xFF][-\w\xA0-\xFF]*)|\u2057(\d+)~):/,l=RegExp(bt.S_QBLOCKS,"g"),d=/\u2057/g,f=/\u2057(\d+)~/g,h={"(":/[()]/g,"[":/[[\]]/g,"{":/[{}]/g},p='"in this?this:'+("object"!=typeof o?"global":"window")+").",g=/[,{][\$\w]+(?=:)|(^ *|[^$\w\.{])(?!(?:typeof|true|false|null|undefined|in|instanceof|is(?:Finite|NaN)|void|NaN|new|Date|RegExp|Math)(?![$\w]))([$_A-Za-z][$\w]*)/g,m=/^(?=(\.[$\w]+))\1(?:[^.[(]|$)/;return t.version=bt.version="v2.4.2",t}(),vt=function _t(){function _t(e,n,o){var a=e&&e.match(/^\s*<([-\w]+)/),r=a&&a[1].toLowerCase(),c=q("div",o&&E(r));return e=i(e,n),s.test(r)?c=t(c,e,r):_(c,e),c.stub=!0,c}function t(t,i,e){var n="o"===e[0],o=n?"select>":"table>";if(t.innerHTML="<"+o+i.trim()+"</"+o,o=t.firstChild,n)o.selectedIndex=-1;else{var a=r[e];a&&1===o.childElementCount&&(o=$(a,o))}return o}function i(t,i){if(!e.test(t))return t;var r={};return i=i&&i.replace(o,function(t,i,e){return r[i]=r[i]||e,""}).trim(),t.replace(a,function(t,i,e){return r[i]||e||""}).replace(n,function(t,e){return i||e||""})}var e=/<yield\b/i,n=/<yield\s*(?:\/>|>([\S\s]*?)<\/yield\s*>|>)/gi,o=/<yield\s+to=['"]([^'">]*)['"]\s*>([\S\s]*?)<\/yield\s*>/gi,a=/<yield\s+from=['"]?([-\w]+)['"]?\s*(?:\/>|>([\S\s]*?)<\/yield\s*>)/gi,r={tr:"tbody",th:"tr",td:"tr",col:"colgroup"},s=gt&&gt<10?ft:/^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?)$/;return _t}(),wt=function(t){if(!o)return{add:function(){},inject:function(){}};var i=function(){var t=q("style");S(t,"type","text/css");var i=$("style[type=riot]");return i?(i.id&&(t.id=i.id),i.parentNode.replaceChild(t,i)):document.getElementsByTagName("head")[0].appendChild(t),t}(),e=i.styleSheet,n="";return Object.defineProperty(t,"styleNode",{value:i,writable:!0}),{add:function(t){n+=t},inject:function(){n&&(e?e.cssText+=n:i.innerHTML+=n,n="")}}}(Q),kt=function(t){var i=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame;if(!i||/iP(ad|hone|od).*OS 6/.test(t.navigator.userAgent)){var e=0;i=function(t){var i=Date.now(),n=Math.max(16-(i-e),0);setTimeout(function(){t(e=i+n)},n)}}return i}(o||{});Q.util={brackets:bt,tmpl:yt},Q.mixin=function(){var t={},i=t[et]={},e=0;return function(n,o,a){if(T(n))return void Q.mixin("__unnamed_"+e++,n,!0);var r=a?i:t;if(!o){if(typeof r[n]===ct)throw new Error("Unregistered mixin: "+n);return r[n]}w(o)?(j(o.prototype,r[n]||{}),r[n]=o):r[n]=j(r[n]||{},o)}}(),Q.tag=function(t,i,e,n,o){return w(n)&&(o=n,/^[\w\-]+\s?=/.test(e)?(n=e,e=""):n=""),e&&(w(e)?o=e:wt.add(e)),t=t.toLowerCase(),it[t]={name:t,tmpl:i,attrs:n,fn:o},t},Q.tag2=function(t,i,e,n,o){return e&&wt.add(e),it[t]={name:t,tmpl:i,attrs:n,fn:o},t},Q.mount=function(t,i,e){function n(t){var i="";return v(t,function(t){/[^-\w]/.test(t)||(t=t.trim().toLowerCase(),i+=",["+at+'="'+t+'"],['+ot+'="'+t+'"]')}),i}function o(){var t=Object.keys(it);return t+n(t)}function a(t){if(t.tagName){var n=x(t,at)||x(t,ot);i&&n!==i&&(n=i,S(t,at,i),S(t,ot,i));var o=X(t,n||t.tagName.toLowerCase(),e);o&&c.push(o)}else t.length&&v(t,a)}var r,s,c=[];if(wt.inject(),T(i)&&(e=i,i=0),typeof t===rt?("*"===t?t=s=o():t+=n(t.split(/, */)),r=t?K(t):[]):r=t,"*"===i){if(i=s||o(),r.tagName)r=K(i,r);else{var u=[];v(r,function(t){u.push(K(i,t))}),r=u}i=0}return a(r),c},Q.update=function(){return v(tt,function(t){t.update()})},Q.vdom=tt,Q.Tag=g,typeof i===st?t.exports=Q:"function"===ut&&typeof e(41)!==ct?(n=function(){return Q}.call(i,e,i,t),!(n!==a&&(t.exports=n))):o.riot=Q}("undefined"!=typeof window?window:void 0)},function(t,i){"use strict";var e={feedBaseUrl:"//notifications.files.bbci.co.uk/",feedAggregatedInitialFeed:"latest.json",feedTopicInitialFeed:"latest.json",feedTopicMaxSubscriptions:12,preferencesUrls:{get:"https://preferences.notifications.api.bbc.co.uk/subscriptions",postPreference:"https://preferences.notifications.api.bbc.co.uk/preference",postPreferenceRelay:"https://preferences.notifications.api.bbc.co.uk/preference/relay",idcta:"https://ssl.bbc.co.uk/idcta/init"},under13s:{moreInfo:"http://www.bbc.co.uk/usingthebbc/account/what-are-child-permissions/"},idcta:{urls:{signin:"https://ssl.bbc.co.uk/id/signin",register:"https://ssl.bbc.co.uk/id/register"}},uas:{apiKey:"g1elnjronnmcc",env:"live"},aroundBBCUrls:{usingTheBBC:"http://www.bbc.co.uk/usingthebbc/",iplayer:"http://www.bbc.co.uk/iplayer",musicArtists:"http://www.bbc.co.uk/music/artists/popular/viewed",musicPlaylists:"http://www.bbc.co.uk/music/playlists/featured",myProgrammes:"http://www.bbc.co.uk/iplayer/added",myArtists:"https://www.bbc.co.uk/music/artists/my",myPlaylists:"https://www.bbc.co.uk/music/playlists/my"},notificationsPollingInterval:6e5,preferencesPollingInterval:6e5,lockExpiry:3e4,cacheTimeout:6e5,visibleChunkAmount:10,maxNotificationAge:5};t.exports={env:e}},function(t,i,e){"use strict";var n=void 0,o=e(5),a=new o;window.require&&window.require(["istats-1"],function(t){n=t}),t.exports={track:function(t){return a.each(t,function(t,i){n.track(i,t)}),this},log:function(t,i,e){n&&n.log(t,i,e)},serialiseTopic:function(t){var i=void 0;return i=t.slice(0,5).join("!").replace(/urn:bbc:/g,"").replace(/:/g,"-"),i=t.length>5?i.concat("!more than 5"):i}}},function(t,i,e){function n(t){if(t.status>=200&&t.status<400)return t;var i=new Error("HTTP request failed "+t.statusText);throw i.response=t,i}var o=e(32),a=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},r=e(2),s=e(11),c=e(1),u=void 0,l=["IPLAYER","MUSIC"],d={IPLAYER:"iPlayer",MUSIC:"Music"},f=["tv","music","radio","e2etest"],h=e(13);t.exports={friendlyProductNames:d,get:function(){return u},filterSubscriptionDomains:function(t){if(!t.topic)return!1;var i=t.topic.split(":");return!("urn"!==i[0]||"bbc"!==i[1]||!i[2])&&f.indexOf(i[2])!==-1},fetch:function(){var t=this;return o.refreshToken()["catch"](function(t){throw r.log("error-idcta-refresh-token","notifications-error"),t}).then(function(){return s(c.env.preferencesUrls.get,{credentials:"include"})})["catch"](function(t){throw t}).then(function(i){if(u=i,u.key)throw new Error(u);return u.preferences||(u.preferences={readFilter:"undefined"!=typeof h.filter?JSON.stringify(h.getCleanArray()):null}),u.preferences.productsEnabled||(u.preferences.productsEnabled=l.map(function(t){return{product:t,enabled:!0}})),u.subscriptions&&(u.subscriptions=u.subscriptions.filter(t.filterSubscriptionDomains)),u})},set:function(t){var i=this;if(!u)return!1;var e=a(u.preferences||{},t.preferences);return u.preferences=e,delete u.preferences.lastRead,delete u.preferences.currentDateTime,o.refreshToken()["catch"](function(t){throw t}).then(function(){return fetch(c.env.preferencesUrls.postPreference,{method:"POST",credentials:"include",headers:{Accept:"*/*","Content-Type":"application/json"},body:JSON.stringify(u.preferences)})}).then(n)["catch"](function(t){throw t}).then(function(){delete u.preferences.onboardingFlag,i.fetch()})},updateRead:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.set({preferences:{readFilter:"undefined"!=typeof h.filter?JSON.stringify(h.getCleanArray()):null,lastReadFlag:t}})},countActiveSubscriptions:function(){var t=0;return u.subscriptions&&u.subscriptions.forEach(function(i){i.enabled&&t++}),t},updateUserOnBoarding:function(t){var i=u.preferences||{};i||(i={lastReadFlag:!0,productsEnabled:[],readFilter:h.getCleanArray()},l.forEach(function(t){i.productsEnabled.push({product:t,enabled:!0})})),i.hasOnboarded=!0,i.onboardingFlag=!0,i.lastReadFlag=!0,this.set(u).then(t)["catch"](function(i){throw t(i),i})}}},function(t,i,e){var n,o;!function(a,r){n=[i,e(0)],o=function(t,i){r(a.i18n=t,i)}.apply(i,n),!(void 0!==o&&(t.exports=o))}(this,function(t,i){function e(){this._entities={},this._default=n,this._language=this._default;var t=i.observable();this.on=t.on,this.off=t.off,this.trigger=t.trigger,this.on("lang",this.setLanguage)}var n="en";e.prototype.dictionary=function(t){this._entities=t},e.prototype.defaultLanguage=function(t){this._default=t},e.prototype.localise=function(t,i){function e(t,i,n,o){o=o||"",i=i||{},n=n||0;var a=t&&!t.length,r=a?Object.keys(t).length:0;if(a&&r>0){var s;for(s in t)o.split(".").length>n&&(o=o.split(".").splice(0,n).join(".")),o=0==n?s:o+"."+s,i=e(t[s],i,n+1,o)}else i[o]=t;return i}var n,o;if(this._entities[this._language]||(n=t),n||(o=e(this._entities[this._language]),n=o[t]?o[t]:t),i){var a,r=e(i);for(a in r)n=n.replace(new RegExp("{"+a+"}","g"),r[a])}return n},e.prototype.setLanguage=function(t){this._language=t||this._default,this.trigger("update")},e.prototype.getLanguage=function(){return this._language};var o,a=new e;for(o in a)t[o]=a[o];i.mixin("i18n",{i18n:t}),i.tag2("i1-8n",'<span name="localised"></span> <span name="original" class="original"><yield></yield></span>','i1-8n,[riot-tag="i1-8n"] { display: inline-block; } i1-8n .original,[riot-tag="i1-8n"] .original { display: none; }',"",function(t){this.mixin("i18n"),this.i18n.on("update",function(){this.update()}.bind(this)),this.on("mount update",function(){this.localised.innerHTML=this.i18n.localise(this.original.innerHTML)})})})},function(t,i){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){};n.prototype={handledParse:function(t,i,e){try{return JSON.parse(t)}catch(n){return"function"==typeof e&&e(),i||null}},extend:function(){function t(t,e){i[o][e]=s.isObject(t)?s.extend(i[o][e],t,a):t}var i,e,n,o,a,r=Array.prototype.slice.call(arguments),s=this;if(0===r.length)return{};n=r[r.length-1],a=n===!0,"boolean"==typeof n&&r.pop();for(var c=0;c<r.length;c++)if(e=s.keys(r[c]),0!==e.length)for(var u in r[c])a&&!r[c].hasOwnProperty(u)||(i=i||{},s.isArray(r[c][u])&&a?"undefined"!=typeof i[u]&&s.isArray(i[u])?(o=u,s.forEach(r[c][u],t)):i[u]=r[c][u].slice():s.isObject(r[c][u])&&a?i[u]=s.isObject(i[u])?s.extend(i[u],r[c][u],a):s.extend(r[c][u],a):null!==r[c][u]&&void 0!==r[c][u]&&(i[u]=r[c][u]));return i},forEach:function(t,i,e){e=e||null;for(var n=0,o=t.length;n<o;n++)n in t&&i.call(e,t[n],n,t)},truncate:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,e=t.substring(0,i+1);return t.length>i?e.indexOf(" ")==-1?e.substring(0,e.length-1).trim()+"...":e.substr(0,Math.min(e.length,e.lastIndexOf(" "))).trim()+"...":t},each:function(t,i,e){e=e||null;if(this.isObject(t))for(var n in t)t.hasOwnProperty(n)&&i.call(e,t[n],n)},bind:function(t,i){if("function"==typeof t)return t.bind?t.bind(i):function(){t.apply(i,arguments)}},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},keys:function o(t){var o=[];for(var i in t)t.hasOwnProperty(i)&&o.push(i);return o},isObject:function(t){return"object"===("undefined"==typeof t?"undefined":e(t))&&null!==t}},t.exports=n},function(t,i){!function(t){"use strict";function i(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function e(t){return"string"!=typeof t&&(t=String(t)),t}function n(t){this.map={},t instanceof n?t.forEach(function(t,i){this.append(i,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(i){this.append(i,t[i])},this)}function o(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function a(t){return new Promise(function(i,e){t.onload=function(){i(t.result)},t.onerror=function(){e(t.error)}})}function r(t){var i=new FileReader;return i.readAsArrayBuffer(t),a(i)}function s(t){var i=new FileReader;return i.readAsText(t),a(i)}function c(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(p.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(p.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(t){if(!p.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t))throw new Error("unsupported BodyInit type")}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type&&this.headers.set("content-type",this._bodyBlob.type))},p.blob?(this.blob=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(r)},this.text=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return s(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");
return Promise.resolve(this._bodyText)}):this.text=function(){var t=o(this);return t?t:Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function u(t){var i=t.toUpperCase();return g.indexOf(i)>-1?i:t}function l(t,i){i=i||{};var e=i.body;if(l.prototype.isPrototypeOf(t)){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,i.headers||(this.headers=new n(t.headers)),this.method=t.method,this.mode=t.mode,e||(e=t._bodyInit,t.bodyUsed=!0)}else this.url=t;if(this.credentials=i.credentials||this.credentials||"omit",!i.headers&&this.headers||(this.headers=new n(i.headers)),this.method=u(i.method||this.method||"GET"),this.mode=i.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&e)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(e)}function d(t){var i=new FormData;return t.trim().split("&").forEach(function(t){if(t){var e=t.split("="),n=e.shift().replace(/\+/g," "),o=e.join("=").replace(/\+/g," ");i.append(decodeURIComponent(n),decodeURIComponent(o))}}),i}function f(t){var i=new n,e=(t.getAllResponseHeaders()||"").trim().split("\n");return e.forEach(function(t){var e=t.trim().split(":"),n=e.shift().trim(),o=e.join(":").trim();i.append(n,o)}),i}function h(t,i){i||(i={}),this.type="default",this.status=i.status,this.ok=this.status>=200&&this.status<300,this.statusText=i.statusText,this.headers=i.headers instanceof n?i.headers:new n(i.headers),this.url=i.url||"",this._initBody(t)}if(!t.fetch){n.prototype.append=function(t,n){t=i(t),n=e(n);var o=this.map[t];o||(o=[],this.map[t]=o),o.push(n)},n.prototype["delete"]=function(t){delete this.map[i(t)]},n.prototype.get=function(t){var e=this.map[i(t)];return e?e[0]:null},n.prototype.getAll=function(t){return this.map[i(t)]||[]},n.prototype.has=function(t){return this.map.hasOwnProperty(i(t))},n.prototype.set=function(t,n){this.map[i(t)]=[e(n)]},n.prototype.forEach=function(t,i){Object.getOwnPropertyNames(this.map).forEach(function(e){this.map[e].forEach(function(n){t.call(i,n,e,this)},this)},this)};var p={blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t},g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];l.prototype.clone=function(){return new l(this)},c.call(l.prototype),c.call(h.prototype),h.prototype.clone=function(){return new h(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new n(this.headers),url:this.url})},h.error=function(){var t=new h(null,{status:0,statusText:""});return t.type="error",t};var m=[301,302,303,307,308];h.redirect=function(t,i){if(m.indexOf(i)===-1)throw new RangeError("Invalid status code");return new h(null,{status:i,headers:{location:t}})},t.Headers=n,t.Request=l,t.Response=h,t.fetch=function(t,i){return new Promise(function(e,n){function o(){return"responseURL"in r?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):void 0}var a;a=l.prototype.isPrototypeOf(t)&&!i?t:new l(t,i);var r=new XMLHttpRequest;r.onload=function(){var t=1223===r.status?204:r.status;if(t<100||t>599)return void n(new TypeError("Network request failed"));var i={status:t,statusText:r.statusText,headers:f(r),url:o()},a="response"in r?r.response:r.responseText;e(new h(a,i))},r.onerror=function(){n(new TypeError("Network request failed"))},r.ontimeout=function(){n(new TypeError("Network request failed"))},r.open(a.method,a.url,!0),"include"===a.credentials&&(r.withCredentials=!0),"responseType"in r&&p.blob&&(r.responseType="blob"),a.headers.forEach(function(t,i){r.setRequestHeader(i,t)}),r.send("undefined"==typeof a._bodyInit?null:a._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(t,i,e){function n(t){var i="; "+document.cookie,e=i.split("; "+t+"=");if(2===e.length)return e.pop().split(";").shift()}function o(t,i){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"1",o=new Date;o.setFullYear(o.getFullYear()+1),document.cookie=encodeURIComponent(t)+"="+n+"; expires="+o.toGMTString()+(i?"; domain="+i:"")+(e?"; path="+e:"")}i.get=n,i.set=o},function(t,i){"use strict";t.exports={en:{copy:{noNotifications1:"No notifications right now. We'll let you know when something from your favourite programmes, artists and playlists is available for you.",noNotifications2:"If your notifications are turned off, you can always turn them back on. Just go to settings.",settings:"You can turn on and off any notifications you receive from iPlayer and Music. Turning notifications off will clear any you already have.",upsell:{title:"Never miss <br /> your favourites",body:"Get notifications about your favourite programmes, music and more."},onboardingInfo1:"This is the place to get notifications about your favourite programmes, music, radio and more.",onboardingInfo2:"We'll give you notifications about anything already in your favourites, and anything new you add. You can manage your notifications any time in Settings.",onboardingInfo3:"Notifications are based on things you&#146;ve added…",onboardingInfo4:"… like TV and radio programmes, music artists and playlists.",ok:"OK, I'm in",showMeMore:"Show me more",error:{somethingWentWrong:"Sorry, something has gone wrong.",hubDisplay:"There's been an error and your notifications <br />can't be displayed at the moment. Please try again later.",hubUpdate:"Sorry, something has gone wrong.<br/>&nbsp;Your notifications could not be updated. Please try again later.",settingsDisplay:"There's been an error and your notifications settings <br />cannot be retrieved. Please try again later.",settingsUpdate:"Sorry, something has gone wrong.<br/>&nbsp;Your settings could not be updated. Please try again later.",onboarding:"There's been an error and we are unable to get you <br /> started with notifications. Please try again later."},cutover:{title:"We’ve signed you out…",body:"Just to make a few upgrades. Please sign back in to get the best out of your BBC.","continue":"to continue"},under13:{moreInfo:"Find out more about child permissions",parentId:{title:"Want to hear about new stuff first?",body:"To get notifications about stuff you love, you need to link BBC accounts with your parent or guardian and get their permission.",button:"OK, ask for permission"},linkPending:{title:"You need permission from a parent or guardian to use notifications",body:"We've sent them an email that tells them what to do. Ask them to check their inbox and follow the steps. To send a new email, visit your BBC account settings."},permissionNotifications:{title:"You need permission from a parent or guardian to use notifications",body:"They can give permission by visiting the Child Permissions section in their BBC account settings."},done:"All done! You can now use your notifications."}}},cy:{Notifications:"Hysbysiadau","Notifications Settings":"Gosodiadau'r Hysbysiadau",Settings:"Gosodiadau","Here's a notification about a new clip from BBC Music.":"Dyma hysbysiad am glip newydd gan BBC Music.","Here's a notification about a new episode in iPlayer.":"Dyma hysbysiad am bennod newydd yn iPlayer.",Back:"Nôl","day ago":"dydd yn ôl","days ago":"o ddyddiau yn ôl","hour ago":"awr yn ôl","hours ago":"awr yn ôl","minute ago":"munud yn ôl","minutes ago":"o funudau yn ôl",Yesterday:"Ddoe","10 minutes ago":"10 munud yn ôl","Just now":"Eiliad yn ôl","{product} Notifications":"Gosodiadau {product}","Sign in":"Mewngofnodi",or:"neu",Register:"Gofrestru","Notifications are based on things you've added…":"Mae hysbysiadau wedi eu seilio ar bethau rydych chi wedi eu hychwanegu…","… like TV and radio programmes, music artists and playlists.":"… fel rhaglenni teledu a radio, cerddoriaeth, artistiaid a rhestrau chwarae.","You'll get notifications when there's something new…":"Byddwch yn cael eich hysbysu pan mae yna rywbeth newydd…","… like an interview with a music artist you've added. Or an episode of a show you've added on iPlayer.":"… fel cyfweliad ag artist rydych chi wedi ei ychwanegu. Neu bennod o sioe rydych chi wedi ei ychwanegu ar iPlayer.","You're in charge":"Yn eich dwylo chi","Visit your Settings any time to manage your notifications.":"Ewch i'ch Gosodiadau unrhyw bryd i reoli eich hysbysiadau.","Load More":"Llwytho mwy",Close:"Cau","Go to Next slide":"Mynd i'r sleid nesaf","Go to Previous slide":"Mynd i'r sleid flaenorol","Go to slide 1":"Mynd i sleid 1","Go to slide 2":"Mynd i sleid 2","Go to slide 3":"Mynd i sleid 3",copy:{noNotifications1:"Dim hysbysiadau ar hyn o bryd. Byddwn ni'n gadael i chi wybod pan mae rhywbeth gan eich hoff raglenni, artistiaid a rhestrau chwarae ar gael i chi.",noNotifications2:"Os ydy'ch hysbysiadau wedi eu diffodd, gallwch eu troi nôl ymlaen. Ewch i'r gosodiadau.",settings:"Gallwch droi hysbysiadau iPlayer a Music ymlaen neu eu diffodd. Bydd diffodd yr hysbysiadau yn cael gwared ar y rhai rydych chi wedi eu cael yn barod.",upsell:{title:"Peidiwch â methu eich ffefrynnau",body:"Hysbysiadau am eich hoff rhaglenni, cerddoriaeth a mwy."},onboardingInfo1:"Dyma'r lle i gael hysbysiadau am eich hoff raglenni, cerddoriaeth, radio a mwy. ",onboardingInfo2:"Byddwn yn eich hysbysu am unrhywbeth sydd yn eich ffefrynnau yn barod, ac unrhywbeth rydych chi'n ei ychwanegu. Gallwch reoli eich hysbysiadau unrhyw bryd yn y Gosodiadau.",onboardingInfo3:"Mae hysbysiadau wedi eu seilio ar bethau rydych chi wedi eu hychwanegu…",onboardingInfo4:"… fel rhaglenni teledu a radio, cerddoriaeth, artistiaid a rhestrau chwarae.",ok:"Iawn",showMeMore:"Dangos mwy",error:{somethingWentWrong:"Mae rhywbeth wedi mynd o'i le.",hubDisplay:"'Dyw hi ddim yn bosib dangos eich hysbysiadau ar hyn o bryd. Triwch eto nes ymlaen.",hubUpdate:"'Dyw eich hysbysiadau ddim yn gallu cael eu diweddaru. Triwch eto nes ymlaen.",settingsDisplay:"Mae yna broblem gyda'r gosodiadau ar hyn o bryd. Triwch eto nes ymlaen.",settingsUpdate:"'Dyw hi ddim yn bosib diweddaru eich gosodiadau. Triwch eto nes ymlaen.",onboarding:"'Dyw hi ddim yn bosib dechrau arni ar hyn o bryd. Triwch eto nes ymlaen."},cutover:{title:"Rydyn ni wedi eich allgofnodi...",body:"Er mwyn gwneud diweddariadau. Mewngofnodwch eto i gael y gorau o'r BBC.","continue":"i barhau"},under13:{moreInfo:"Dysgu mwy am ganiatâd i blant",parentId:{title:"Eisiau clywed am bethau newydd gyntaf?",body:"Er mwyn derbyn hysbysiadau am dy hoff bethau, rhaid i ti gysylltu cyfrifon BBC gyda dy riant neu warchodwr er mwyn cael eu caniatâd.",button:"Iawn, gofyn am ganiatâd"},linkPending:{title:"Rwyt ti angen caniatâd rhiant neu warchodwr i ddefnyddio hysbysiadau",body:"Rydyn ni wedi anfon e-bost atyn nhw sy’n egluro beth i’w wneud. Maen nhw angen edrych yn eu mewnflwch a dilyn y cyfarwyddiadau. Er mwyn cael e-bost newydd, cer i osodiadau dy gyfrif BBC."},permissionNotifications:{title:"Rwyt ti angen caniatâd rhiant neu warchodwr i ddefnyddio hysbysiadau",body:"Gallan nhw roi caniatâd drwy fynd i adran Caniatâd i Blant yng ngosodiadau eu cyfrif BBC."},done:"Barod! Nawr galli di ddefnyddio dy hysbysiadau."}}},gd:{Notifications:"Fiosan","Notifications Settings":"Seataidhean Fiosa",Settings:"Seataidhean","Here's a notification about a new clip from BBC Music.":"Seo fios mu chriomag ùr bho BBC Music.","Here's a notification about a new episode in iPlayer.":"Seo fios mu phrògram ùr ann an iPlayer.",Back:"Air ais","day ago":"latha air ais","days ago":"làithean air ais","hour ago":"uair air ais","hours ago":"uairean air ais","minute ago":"mhionaid air ais","minutes ago":"mionaidean air ais",Yesterday:"An-dè","10 minutes ago":"10 mionaidean air ais","Just now":"An-dràsta","{product} Notifications":"Fiosan {product}","Sign in":"Log a-steach",or:"no",Register:"Clàraich","Notifications are based on things you've added…":"Tha fiosan stèidhichte air rudan a chur thu ris...","… like TV and radio programmes, music artists and playlists.":"… mar phrògraman Tbh agus rèidio, luchd ciùil agus clàran-ciùil.","You'll get notifications when there's something new…":"Gheibh thu fiosan nuair a tha rudan ùra ann…","… like an interview with a music artist you've added. Or an episode of a show you've added on iPlayer.":"… mar agallamh le luchd ciùil a chur thu ris. No prògram a chur thu ris ann an iPlayer.","You're in charge":"'S tusa a tha os cionn chùisean!","Visit your Settings any time to manage your notifications.":"Thèid gu Seataidhean airson rian a chumail air d' fhiosan","Load More":"Faic tuilleadh",Close:"Dùin","Go to Next slide":"An ath slaighd","Go to Previous slide":"An slaighd roimhe","Go to slide 1":"Rach gu slaighd 1","Go to slide 2":"Rach gu slaighd 2","Go to slide 3":"Rach gu slaighd 3",copy:{noNotifications1:"Chan eil fiosan ann an-dràsta. Leigidh sinn fios nuair a bhios rudeigin ann bho na prògraman, luchd ciùil is clàran-ciùil as fheàrr leat.",noNotifications2:"Ma tha d’ fhiosan air an cur dheth, faodaidh tu an cur air a-rithist le bhith dol gu seataidhean.",settings:"Faodar brathan a tha thu a' faighinn bho iPlayer agus Music a chur air is dheth. Thèid an fheadhainn a th' agad mar-thà a dhubhadh às le bhith gan cuir dheth.",upsell:{title:"Na caill na rudan as fheàrr leat",body:"Faigh fiosan mu na prògraman 's an ceòl as fheàrr leat agus gu leòr eile."},onboardingInfo1:"Seo far am faighear fiosan mu na prògraman 's an ceòl as fheàrr leat agus gu leòr eile.",onboardingInfo2:"Cuiridh sinn fiosan thugad mu na rudan a tha nad roghainnean agus rud sam bith eile a chuireas tu ris. Faodaidh tu rian a chumail air iad seo ann an Seataidhean.",onboardingInfo3:"Tha fiosan stèidhichte air rudan a chur thu ris…",onboardingInfo4:"… mar phrògraman Tbh agus rèidio, luchd ciùil agus clàran-ciùil.",ok:"Ceart",showMeMore:"Seall tuilleadh",error:{somethingWentWrong:"Duilich, tha rudeigin air a dhol ceàrr.",hubDisplay:"Chaidh rudeigin ceàrr is chan urrainnear d’ fhiosan a shealltainn an-dràsta. Feuch a-rithist.",hubUpdate:"Duilich, tha rudeigin air a dhol ceàrr. Cha b’ urrainnear d' fhiosan ùrachadh. Feuch a-rithist.",settingsDisplay:"Chaidh rudeigin ceàrr is chan fhaighear do sheataidhean fiosa. Feuch a-rithist.",settingsUpdate:"Duilich, tha rudeigin air a dhol ceàrr. Cha b’ urrainnear do sheataidhean ùrachadh. Feuch a-rithist.",onboarding:"Chaidh rudeigin ceàrr is chan fhaigh sinn air d’ fhiosan a chur an sàs. Feuch a-rithist."},cutover:{title:"Log sinn a-mach thu…",body:"Tha sinn airson ùrachaidhean a dhèanamh. Log a-steach a-rithist airson a’ chuid as fheàrr fhaighinn bhon BhBC.","continue":"gus leantainn ort"},under13:{moreInfo:"Faigh a-mach tuilleadh mu cheadan cloinne",parentId:{title:"Airson cluinntinn mu rudan ùra an toiseach?",body:"Feumaidh tu cead fhaighinn bho do phàrant no do neach-cùraim agus do chunntas BBC a cheangal ris an fhear acasan airson fiosan fhaighinn mu na rudan a tha a’ còrdadh riut.",button:"Ceart, iarr cead"},linkPending:{title:"Feumar cead fhaighinn bho phàrant no neach-cùraim airson fiosan a chleachdadh",body:"Tha sinn air post-d a chur thuca le stiùireadh. Iarr orra sùil a thoirt air na puist-d aca agus na ceumannan a' leantainn. Tadhal air seataidhean cunntais a' BhBC airson post-d a chur air falbh."},permissionNotifications:{title:"Feumar cead fhaighinn bho phàrant no neach-cùraim airson fiosan a chleachdadh",body:"Faodaidh iadsan cead a thoirt le bhith tadhal air Ceadan Chloinne ann an seataidhean cunntais a' BhBC."},done:"Dèanta! Faodaidh tu na fiosan agad a chleachdadh."}}},ga:{Notifications:"Fógraí","Notifications Settings":"Socruithe na bhFógraí",Settings:"Socruithe","Here's a notification about a new clip from BBC Music.":"Seo fógra faoi ghearrthóg úr ó BBC Music.","Here's a notification about a new episode in iPlayer.":"Seo fógra faoi eagrán úr ar iPlayer.",Back:"Siar","day ago":"lá ó shin","days ago":"lá ó shin","hour ago":"uair ó shin","hours ago":"uair ó shin","minute ago":"nóiméad ó shin","minutes ago":"nóiméad ó shin",Yesterday:"Inné","10 minutes ago":"10 mbomaite ó shin","Just now":"Díreach ansin","{product} Notifications":"Fógraí {product}","Sign in":"Sínigh isteach",or:"nó",Register:"Cláraigh","Notifications are based on things you've added…":"Tá fógraí bunaithe ar rudaí a chuir tú leis…","… like TV and radio programmes, music artists and playlists.":"… mar shampla, cláir TV, raidió, ceoltóirí agus seinnliostaí.","You'll get notifications when there's something new…":"Gheobhaidh tú fógraí nuair atá rudaí úra ann.","… like an interview with a music artist you've added. Or an episode of a show you've added on iPlayer.":"… ar nós agallaimh le ceoltóir a chuir tú leis, nó eagrán de chlár a chuir tú le iPlayer.","You're in charge":"Tá tú i gceannas!","Visit your Settings any time to manage your notifications.":"Tabhair cuairt ar do chuid Socruithe le go dtig leat smacht a choinneáil orthu.","Load More":"Lódáil tuilleadh",Close:"Druid","Go to Next slide":"Téigh go céad sleamhnán eile","Go to Previous slide":"Téigh go sleamhnán roimhe","Go to slide 1":"Téigh go sleamhnán 1","Go to slide 2":"Téigh go sleamhnán 2","Go to slide 3":"Téigh go sleamhnán 3",copy:{noNotifications1:"Níl fógraí ann faoi láthair. Beidh muid i dteagmháil leat má bhíonn rud éigin ar fáil a bhaineann leis na cláir, na ceoltóirí nó na seinnliostaí is ansa leat.",noNotifications2:"Má tá do chuid fógraí múchta, thig leat iad a chur air arís. Téigh go socruithe.",settings:"Thig leat fógraí ó iPlayer agus Music a chur air nó as. Glanfaidh tú na fógraí atá agat cheana féin má mhúchann tú iad.",upsell:{title:"Ná caill do chianáin riamh",body:"Aimsigh fógraí faoi do chianáin, do cheol agus níos mó."},onboardingInfo1:"Is anseo a dtig leat fógraí a aimsiú faoi na cláir, faoin cheol, faoin raidió is ansa leat agus níos mó.",onboardingInfo2:"Cuirfidh muid fógraí ar fáil duit faoi rud ar bith atá i do chianáin cheana féin agus faoi rud ar bith úr a chuireann tú leo. Thig leat smacht a bheith agat ar do chuid fógraí am ar bith in Socruithe.",onboardingInfo3:"Fógraí bunaithe ar rudaí a chuir tú leis…",onboardingInfo4:"… mar shampla, cláir TV, raidió, ceoltóirí agus seinnliostaí.",ok:"Ceart go leor",showMeMore:"Taispeáin a thuilleadh",error:{somethingWentWrong:"Tá brón orainn, tá rud éigin cearr.",hubDisplay:"Tá rud éigin cearr agus ní féidir do chuid fógraí a fheiceáil faoi láthair. Triail arís níos moille, le do thoil.",hubUpdate:"Tá brón orainn, tá rud éigin cearr. Ní féidir do chuid fógraí a uasdátú. Triail arís níos moille, le do thoil.",settingsDisplay:"Tá fadhb le socruithe na bhfógraí s'agat agus níl fáil orthu. Triail arís níos moille, le do thoil.",settingsUpdate:"Tá brón orainn, tá rud éigin cearr. Ní féidir do chuid fógraí a uasdátú. Triail arís níos moille, le do thoil.",onboarding:"Tá fadhb éigin ann agus ní féidir do chuid fógraí a chur sa tsiúl. Triail arís níos moille, le do thoil."},cutover:{title:"Shínigh muid amach tú …",body:"Le huasghrádú nó dhó a dhéanamh. Sínigh isteach arís agus bain a oiread leasa agus is féidir as an BBC.","continue":"le leanúint ort"},under13:{moreInfo:"Tuilleadh eolais ar cheadanna páistí",parentId:{title:"Ar mhaith leat bheith ar an eolas faoin stuif úr ar dtús?",body:"Le fógraí a fháil ar an stuif is ansa leat, beidh ort cuntais BBC a nascadh le do thuismitheoir nó le do chaomhnóir agus a c(h)ead a fháil.",button:"Maith go leor, iarr cead."},linkPending:{title:"Tá cead tuismitheora nó caomhnóra de dhíth ort le fógraí a úsáid",body:"Sheol muid ríomhphost chucu a insíonn dóibh cad é atá le déanamh. Iarr orthu a mbosca isteach a sheiceáil agus na céimeanna a leanúint. Le ríomhphost úr a sheoladh, tabhair cuairt ar shocruithe do chuntais BBC."},permissionNotifications:{title:"Tá cead tuismitheora nó caomhnóra de dhíth ort le fógraí a úsáid",body:"Thig leo cead a thabhairt ach dul chuig Ceadanna Páistí i socruithe a c(h)untais BBC."},done:"Déanta! Thig leat d’fhógraí a úsáid anois."}}}}},function(t,i){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports={isMatchingKeyEvent:function(t,i,n){if(t.type===i||"any"===i){var o=t.which||t.charCode;return"object"!==("undefined"==typeof n?"undefined":e(n))&&(n=[n]),n.indexOf(o)!==-1}return!1},addEvent:function(t,i,e){t&&(t.addEventListener?t.addEventListener(i,e,!1):(t["e"+i+e]=e,t[i+e]=function(){t["e"+i+e](window.event)},t.attachEvent("on"+i,t[i+e])))},removeEvent:function(t,i,e){t&&(t.removeEventListener?t.removeEventListener(i,e,!1):(t.detachEvent("on"+i,t[i+e]),t[i+e]=null))},triggerEvent:function(t,i,e,n){var o=document.createEvent("Event");n=n||!1,""===o.type&&o.initEvent(i,!0,n),o.data=e||{},t.dispatchEvent(o)}}},function(t,i){"use strict";function e(t,i,e){if("function"==typeof Array.prototype.find)return t.find(i,e);e=e||this;var n,o=t.length;if("function"!=typeof i)throw new TypeError(i+" is not a function");for(n=0;n<o;n++)if(i.call(e,t[n],n,t))return t[n]}t.exports=e},function(t,i,e){"use strict";function n(t){try{JSON.parse(t)}catch(i){return!1}return!0}function o(t){if(!t)return null;if(n(t))return JSON.parse(t);var i=t;return i=i.substring(i.indexOf("(")+1),i=i.substring(0,i.length-1),JSON.parse(i)}function a(t){if(t.status>=200&&t.status<500)return t;var i=new Error("HTTP request failed "+t.statusText);throw i.response=t,i}e(6),t.exports=function(t,i){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n="bbc-notifications-"+t;return e&&sessionStorage.getItem(n)?new Promise(function(t){t(JSON.parse(sessionStorage.getItem(n)))}):fetch(t,i).then(a).then(function(t){return 404===t.status?null:t.text()}).then(function(t){var i=o(t);return e&&i&&sessionStorage.setItem(n,JSON.stringify(i)),i})["catch"](function(t){throw t})}},function(t,i,e){"use strict";function n(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),a=e(11),r=e(1),s=e(3),c=e(10),u=function(){function t(){n(this,t),this.MINIMUM_TO_DISPLAY=8;var i=s.get();this.topics=i.subscriptions.filter(function(t){return t.enabled}),this.topicKeys=this.topics.map(function(t){return t.topic})}return o(t,[{key:"dedupeData",value:function(t){var i=[],e=[];return t.forEach(function(t){i.indexOf(t.id)>=0||(e.push(t),i.push(t.id))}),e}},{key:"filterData",value:function(t){var i=this,e=s.get(),n=e.preferences.productsEnabled.filter(function(t){return t.enabled}).map(function(t){return t.product});return this.topics=e.subscriptions.filter(function(t){return t.enabled}),this.topicKeys=this.topics.map(function(t){return t.topic}),t.filter(function(t){return n.indexOf(t.product)!==-1&&t.topic.some(function(e){if(i.topicKeys&&i.topicKeys.indexOf(e)!==-1){var n=c(i.topics,function(t){return t.topic===e});if(n&&new Date(t.creationTimestamp)>new Date(n.lastSubscribed))return!0}return!1})})}},{key:"loadData",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"latest.json",e="https:"+r.env.feedBaseUrl+t+"/"+i,n=new Date;return a(e,null,"latest.json"!==i)["catch"](function(t){throw t}).then(function(t){var i=[];if(!t)return{list:i,next:null,reachedEnd:!0};var e=!1;t.notifications&&t.notifications.forEach(function(t){var o=new Date(t.creationTimestamp),a=Math.abs(n.getTime()-o.getTime()),s=Math.ceil(a/864e5);s>=r.env.maxNotificationAge&&(e=!0,s>r.env.maxNotificationAge)||i.push(t)});var o=t.next&&"false"!==t.next?t.next:null;return{list:i,next:o,reachedEnd:e}})}}]),t}();Object.defineProperty(i,"BaseCollection",{configurable:!1,enumerable:!0,get:function(){return u}})},function(t,i,e){var n=e(29);t.exports=new n.BloomFilterManager("readFilter")},function(t,i,e){function n(t,i){document.documentElement.classList&&a.indexOf(t)===-1&&(document.documentElement.classList.add("n-"+(i?"":"no-")+t),a.push(t))}function o(){var t="ontouchstart"in window;return n("touchevents",t),t}i.touchevents=o;var a=[]},function(t,i){"use strict";!function(){var t={};if(!Object.setPrototypeOf&&!t.__proto__){var i=Object.getPrototypeOf;Object.getPrototypeOf=function(t){return t.__proto__?t.__proto__:i.call(Object,t)}}}()},function(t,i,e){(function(t){t.tag2("bbc-id-cutover",'<div class="orb-panel-content b-g-p b-r orb-nav-sec"> <button class="orb-signin-upsell-banner--close" onclick="{this.close}">×</button> <div class="orb-signin-upsell-banner--layout"> <div class="orb-signin-upsell-banner--content"> <p class="notifications-trafalgar-bold"><i1-8n>copy.cutover.title</i1-8n></p> <p class="notifications-pica"><i1-8n>copy.cutover.body</i1-8n></p> <div id="orb-signin-upsell-banner--idcta"></div> </div> </div> </div>',"","",function(t){"use strict";function i(t){var i=document.querySelector('link[href="'+t+'"]');if(!i){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=t,document.getElementsByTagName("head")[0].appendChild(e)}}var n=this;e(6);var o=e(7),a=e(8),r=e(4),s=e(1),c="ckps_bbc_idv5_cutover",u=o.get("ckps_language"),l="en-GB";u&&a[u]&&(l=u+"-GB"),this.close=function(){var t=document.querySelector(".orb-signin-upsell-banner");t&&(t.parentNode.removeChild(t),o.set(c,".bbc.co.uk"),o.set(c,".bbc.com"))},this.on("mount",function(){document.getElementById("notification-link").addEventListener("click",n.close);var t=encodeURIComponent(window.location.href.replace(window.location.hash,""));fetch(s.env.preferencesUrls.idcta+"?purpose=continue&locale="+l+"&ptrt="+t,{credentials:"include"}).then(function(t){return t.json()}).then(function(t){t.css&&t.css.forEach(function(t){i(t)});var e=document.createElement("div");e.innerHTML=t.html;var o=e.querySelector("p > span"),a=[].slice.call(o.childNodes);a.slice(1).forEach(function(t){o.removeChild(t)});var s=document.createElement("span");s.style.fontWeight="normal",s.innerHTML=" "+r.localise("copy.cutover.continue"),o.appendChild(s),n.root.querySelector("#orb-signin-upsell-banner--idcta").appendChild(e)})})})}).call(i,e(0))},function(t,i,e){(function(t){t.tag2("bbc-notifications-add-topics",'<div class="notifications__container"> <header id="notifications__header" class="notifications__header notifications__header--js "> <h2 class="notifications-double-pica notification-title-variant">Start adding to get notifications</h2> </header> <p class="notifications-long-primer notifications--carousel-description">Here are some suggestions for things you can add from BBC Music and iPlayer.</p> <bbc-notifications-card-carousel cards="{this.suggestions}" base-path="{this.parent.basePath}"> <div class="notifications--card-carousel-row {refreshing ? \' notifications--card-carousel-row-refreshing\' : \'\'}"> <div class="notifications--card" each="{opts.cards}"> <a href="{link}" onclick="{parent.parent.logClick(\'clickImageLink\')}"><div class="notifications--card-img" riot-style="background-image:url({image});"></div></a> <div class="notifications--card-body"> <a href="{link}" onclick="{parent.parent.logClick(\'clickTitleLink\')}"><p class="notifications-pica-bold">{title}</p></a> <p class="notifications-brevier">{product + (category ? \' | \' + category : \'\')}</p> </div> <div class="{\'notifications--card-actions\': true, \'notifications--card-actions-is-loading\': loading}"> <span class="notifications--card-actions-loading"> <span class="notifications--card-actions-loading-icon"></span><span class="notifications--card-actions-loading-label">{added ? \'Removing\' : \'Adding\'}</span> </span> <button class="{\'notifications--card-action-added\': added}" onclick="{parent.parent.toggleItem}"> <span class="notifications--card-action-remove"> <span class="notifications--card-action-icon"></span><span class="notifications--card-action-label">Remove</span> </span> <span class="notifications--card-action-add"> <span class="notifications--card-action-icon"></span><span class="notifications--card-action-label">{added ? \'Added\' : \'Add\'} to {parent.parent.productAreas[product]}</span> </span> </button> </div> <div if="{followError}" class="notifications--popup-error"> <button class="notifications--popup-close" onclick="{parent.parent.dismissFollowError}"><img riot-src="{parent.opts.basePath + \'/svg/close_icon_black.svg\'}"></button> <p class="notifications-great-primer">Something\'s gone wrong.</p> <p class="notifications-long-primer">Please try again later.</p> <div class="notifications--popup__arrow"></div> </div> </div> </div> </bbc-notifications-card-carousel> <div class="notifications--add-topics-footer"> <button class="notifications--refresh-btn notifications-long-primer" onclick="{this.refreshSuggestions}"><img class="notifications--refresh-btn-icon" riot-src="{this.parent.basePath + \'/svg/refresh.svg\'}">Show more suggestions</button> <button class="notifications--done-btn notifications-long-primer" __disabled="{!this.adds.length}" onclick="{this.done}">Done</button> </div> </div>',"","",function(t){"use strict";var i=this,n=e(38),o=e(2),a=e(36);this.done=function(){o.log("complete","notifications-in-tray-brand"),i.parent.parent.updateSubscriptionCount(i.adds.length)},this.logClick=function(t){return function(){return o.log(t,"notifications-in-tray-brand"),!0}},this.productAreas={iPlayer:"My Programmes",Music:"My Music"},this.suggestions=a.load(),this.refreshSuggestions=function(){i.update({refreshing:!0}),setTimeout(function(){i.update({suggestions:a.load(),refreshing:!1})},250),o.log("refresh","notifications-in-tray-brand")},this.adds=this.suggestions.filter(function(t){return t.added}),this.addItem=function(t){t.item.loading=!0,i.adds=i.suggestions.filter(function(t){return t.added}),i.update(),n.addEvent(t.item,"followed").then(function(){t.item.added=!0,t.item.loading=!1,t.item.followError=!1,i.adds=i.suggestions.filter(function(t){return t.added}),i.update(),o.log("add","notifications-in-tray-brand",{notifications_card_product:t.item.product,notifications_card_title:t.item.title,notifications_card_position:i.suggestions.indexOf(t.item)})})["catch"](function(){i.failToUpdateItem(t)})},this.failToUpdateItem=function(t){t.item.loading=!1,i.adds=i.suggestions.filter(function(t){return t.added}),t.item.followError=!0,i.update()},this.removeItem=function(t){t.item.loading=!0,i.adds=i.suggestions.filter(function(t){return t.added}),i.update(),n.addEvent(t.item,"unfollowed").then(function(){t.item.added=!1,t.item.loading=!1,i.adds=i.suggestions.filter(function(t){return t.added}),t.item.followError=!1,i.update()})["catch"](function(){i.failToUpdateItem(t)})},this.toggleItem=function(t){t.item.added?i.removeItem(t):i.addItem(t)},this.dismissFollowError=function(t){t.item.followError=!1}})}).call(i,e(0))},function(t,i,e){(function(t){t.tag2("bbc-notifications-bell",'<a name="notificationLink" id="notification-link" class="js-notification-link animated three notifications-shown {swing: opts.alert, notifications-black-bell: this.enabled, notifications-grey-bell: !this.enabled}" href="#"> <span class="hidden-span" style="height: 1px; width: 1px; position: absolute; overflow: hidden; top: -10px;">Notifications</span> <div class="notification-link--triangle"></div> <div class="notification-link--triangle"></div> <span id="not-num" class="{\'new-notifications\': opts.alert}"></span> <span aria-live="polite" class="notification-link__live notification-link__live--js">{opts.alert ? this.getAlertText() : \'\'}</span> </a>',"","",function(t){"use strict";var i=this;"signed-in"===t.state||"on-boarding"===t.state?this.enabled=!0:this.enabled=!1,this.getAlertText=function(){var t=i.parent.opts.mainApp.getDrawerState();return"hidden"===t?'New Notification. To view open the "Notification Panel" link.':"New Notification available."}})}).call(i,e(0))},function(t,i,e){(function(t){t.tag2("bbc-notifications-card-carousel",'<div class="notifications--card-carousel"> <div class="notifications--card-carousel-arrows"> <button onclick="{this.scrollLeft}" class="notifications--card-carousel-arrow" __disabled="{this.scrollProgress <= 0}"><img class="notifications--card-carousel-arrow-svg" riot-src="{this.opts.basePath + \'/svg/arrow_left_black.svg\'}"></button> <button onclick="{this.scrollRight}" class="notifications--card-carousel-arrow" __disabled="{this.scrollProgress >= 1}"><img class="notifications--card-carousel-arrow-svg" riot-src="{this.opts.basePath + \'/svg/arrow_right_black.svg\'}"></button> </div> <div name="container" class="notifications--card-carousel-container" onscroll="{this.scroll}"> <yield></yield> </div> </div> <div class="notifications--card-carousel-scrollbar" name="scrollbar"> <div name="scrollbarProgress" class="notifications--card-carousel-scrollbar-progress" riot-style="width: {this.scrollWidth}%; left: {this.scrollOffset}px;"></div> </div>',"","",function(t){
"use strict";function i(t,i){function e(t,i,e){if(e<=t)return 0;if(e>=i)return 1;var n=(e-t)/(i-t);return n*n*(1*n)}function n(){if(t.scrollLeft===u){var i=Date.now(),o=e(a,r,i),l=Math.round(s+c*o);t.scrollLeft=l,i>=r||t.scrollLeft===u&&t.scrollLeft!==l||(u=t.scrollLeft,setTimeout(n,0))}}var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:250;if(i=Math.round(i),o=Math.round(o),!(o<0)){if(0===o)return void(t.scrollLeft=i);var a=Date.now(),r=a+o,s=t.scrollLeft,c=i-s,u=t.scrollLeft;setTimeout(n,0)}}var n=this,o=e(2);this.scrollWidth=0,this.scrollProgress=0,this.scrollOffset=0,this.scroll=function(){n.scrollProgress=n.container.scrollLeft/(n.container.scrollWidth-n.container.clientWidth),n.scrollOffset=(n.scrollbar.clientWidth-n.scrollbarProgress.clientWidth)*n.scrollProgress};var a=282;this.scrollLeft=function(){i(n.container,n.container.scrollLeft-a),o.log("paginate-left","notifications-in-tray-brand")},this.scrollRight=function(){i(n.container,n.container.scrollLeft+a),o.log("paginate-right","notifications-in-tray-brand")},this.on("updated",function(){if(n.container.clientWidth+n.container.scrollWidth!==0){var t=n.container.clientWidth/n.container.scrollWidth*100,i=void 0;t!==n.scrollWidth&&(n.scroll(),n.update({scrollWidth:t}),i||(o.log("carouselShown","notifications-in-tray-brand"),i=!0))}})})}).call(i,e(0))},function(t,i,e){(function(t){t.tag2("bbc-notifications-drawer",'<section class="notification-error__container"> <bbc-notifications-error main="{opts.error.main}" inner="{opts.error.inner}"></bbc-notifications-error> </section> <div if="{opts.error.main != \'hub\' && opts.error.main != \'onboarding\'}"> <bbc-notifications-onboarding-async if="{opts.onboarding && !opts.idctaData.policyCheck}"></bbc-notifications-onboarding-async> <bbc-notifications-onboarding-u13 if="{opts.idctaData.policyCheck}" idcta-data="{opts.idctaData}" main-app="{this.parent.opts.mainApp}"></bbc-notifications-onboarding-u13> <div if="{!opts.onboarding && !opts.idctaData.policyCheck}" class="{⁗notifications--no-subscriptions⁗: !opts.subscriptionCount}"> <bbc-notifications-onboarding-u13-success if="{this.showU13Success}"></bbc-notifications-onboarding-u13-success> <bbc-notifications-add-topics if="{opts.state === \'signed-in\'}"></bbc-notifications-add-topics> <div if="{opts.state === \'signed-in\'}" id="notifications-main" class="notifications__container notifications-{this.view} notifications-{this.view}--js notifications-main--css notification-signed-in"> <div if="{!opts.hasSetup}"> <div id="notifications-main"> <div class="spinner"> <img class="loader-icon notifications-image spinner__img--svg" riot-src="{this.basePath + \'/svg/loader.svg\'}" alt="Spinner"> </div> </div> </div> <div if="{opts.hasSetup}"> <div class="notifications--main-view"> <div if="{this.view == \'settings\'}"> <bbc-notifications-settings if="{opts.error.main != \'settings\'}"></bbc-notifications-settings> </div> <div if="{this.view !== \'settings\'}"> <header id="notifications__header" class="notifications__header notifications__header--js {\'shadowAdded\': shadowAdded}"> <h2 class="notification-title"><i1-8n>Notifications</i1-8n></h2> <ul class="notification-header-icons"> <li><a href="javascript:;" class="notifications__settings--js" onkeydown="{this.onSettingsKeydown}" onclick="{this.openSettings}"><img class="setting-icon notifications-image" riot-src="{this.basePath + \'/svg/setting.svg\'}" alt="Settings"><span class="notifications-brevier"><i1-8n>Settings</i1-8n></span></a></li> </ul> </header> <div id="notifications-wrapper" onmousewheel="{this.onListMouseWheel}" onscroll="{this.onListScroll}"> <div class="notification-panel" style="display: block;"> <bbc-notifications-list notifications="{opts.notifications}" reached-end="{opts.reachedEnd}" loading-more="{opts.loadingMore}" subscription-count="{opts.subscriptionCount}"></bbc-notifications-list> </div> </div> </div> </div> </div> </div> <div if="{opts.state === \'signed-out\'}" id="notifications-main" class="notifications-main--css notifications-main--js notification-signed-out"> <div class="notifications-no-scroll"> <div class="notifications-wide-spread"> <div class="notifications__container"> <div class="notifications-top-header"> <p class="notifications-main-header notifications-trafalgar"><i1-8n>copy.upsell.title</i1-8n></p> <p class="notifications-description notifications-pica"><i1-8n>copy.upsell.body</i1-8n></p> </div> <div class="notifications-cta notifications-cta--upsell"> <bbc-notifications-idcta-html html="{opts.idctaData.html}" html-js="{opts.idctaData.htmlJs}"></bbc-notifications-idcta-html> </div> </div> </div> </div> </div> </div> </div>',"","",function(t){"use strict";var i=this,n=e(2);this.basePath=this.parent.opts.mainApp.basePath,this.shadowAdded=!1,this.view="main";var o=0,a=50;"undefined"!=typeof localStorage&&("signed-in"===t.state&&localStorage.getItem("bbc-notifications-u13-pending-policy")?(this.update({showU13Success:!0}),localStorage.removeItem("bbc-notifications-u13-pending-policy")):"signed-out"===t.state&&localStorage.removeItem("bbc-notifications-u13-pending-policy")),this.hideU13Success=function(){i.update({showU13Success:!1})},this.openSettings=function(){n.log("click","notifications-settings"),i.update({view:"settings"})},this.closeSettings=function(t){return i.view="main",i.update(),!1},this.trackUpsellSignIn=function(){return n.log("sign-in","notifications-upsell"),!0},this.trackUpsellRegister=function(){return n.log("register","notifications-upsell"),!0},this.loadMore=function(){return(!document.activeElement||!document.activeElement.classList||!document.activeElement.classList.contains("notification-item--link")&&!document.activeElement.classList.contains("notifications-keyboard-access--btn"))&&void(i.opts.loadingMore||i.opts.reachedEnd||i.parent.fetchNotifications(!0))},this.onListMouseWheel=function(i){return i.preventUpdate=!0,!t.notifications.length||(i.currentTarget.offsetHeight>=i.currentTarget.scrollHeight||(i.deltaY>0?!(i.currentTarget.scrollTop>=i.currentTarget.scrollHeight-i.currentTarget.offsetHeight):!(0===i.currentTarget.scrollTop)))},this.onListScroll=function(t){t.preventUpdate=!0,!i.shadowAdded&&t.currentTarget.scrollTop>o?i.update({shadowAdded:!0}):i.shadowAdded&&t.currentTarget.scrollTop<=o&&i.update({shadowAdded:!1}),t.currentTarget.scrollTop>=t.currentTarget.scrollHeight-t.currentTarget.offsetHeight-a&&i.loadMore()},this.onSettingsKeydown=function(t){if(9===t.keyCode&&t.shiftKey){var e=document.querySelector(".notifications-keyboard-access--close");if(e)return e.focus(),!1;var n=document.querySelector(".notification-items .notification-item:last-child a");if(n)return n.focus(),!1}else 13===t.keyCode?i.updateFocus=".notifications__settings__back-btn--js":9!==t.keyCode||t.shiftKey||document.querySelectorAll("bbc-notifications-list .notification-item").length||i.update({showKeyboardAccess:!0});return!0},this.on("updated",function(){if(i.updateFocus){var t=document.querySelector(i.updateFocus);t&&t.focus(),i.updateFocus=null}i.parent.opts.mainApp.updateDrawerHeight()});var r=void 0;this.opts.componentApp.on("drawerStateChanged",function(t){"hidden"===t?r=!0:r&&(i.update({view:"main"}),r=!1)})})}).call(i,e(0))},function(t,i,e){(function(t){t.tag2("bbc-notifications-error",'<div if="{opts.main == \'hub\'}" class="notifications-error show" id="hub-error-main"> <div class="notifications-error__header"> <p class="notifications-error__header--text"><i1-8n>copy.error.somethingWentWrong</i1-8n></p> </div> <p class="notifications-pica notifications-error__body"><i1-8n>copy.error.hubDisplay</i1-8n></p> </div> <div if="{opts.inner == \'hub\'}" class="notifications-error--inner show" id="hub-error-inner"> <p class="notifications-error--inner__body notifications-10/12"><i1-8n>copy.error.hubUpdate</i1-8n> </p> <div class="notifications-error--inner__container"> <div aria-label="Close notification error message" class="notifications-error--inner__close" aria-action="close" onclick="{this.closeInner}">&nbsp;</div> </div> </div> <div if="{opts.main == \'settings\'}" class="notifications-error show" id="settings-error-main"> <div class="notifications-error__header"> <p class="notifications-error__header--text"><i1-8n>copy.error.somethingWentWrong</i1-8n></p> </div> <p class="notifications-pica notifications-error__body"><i1-8n>copy.error.settingsDisplay</i1-8n></p> <div class="notifications-error__back" aria-action="close"> <div class="notifications-error__back__arrow"> </div> <div class="notifications-error__back__text"><i1-8n>Back</i1-8n> </div> </div> </div> <div if="{opts.inner == \'settings\'}" class="notifications-error--inner show" id="settings-error-inner"> <p class=" notifications-error--inner__body notifications-10/12"><i1-8n>copy.error.settingsUpdate</i1-8n></p> <div class="notifications-error--inner__container"> <div aria-label="Close notification error message" class="notifications-error--inner__close" aria-action="close" onclick="{this.closeInner}">&nbsp;</div> </div> </div> <div if="{opts.main == \'onboarding\'}" class="notifications-error show" id="onboarding-error-main"> <div class="notifications-error__header"> <p class="notifications-error__header--text"><i1-8n>copy.error.somethingWentWrong</i1-8n></p> </div> <p class="notifications-pica notifications-error__body"><i1-8n>copy.error.onboarding</i1-8n></p> </div>',"","",function(t){"use strict";var i=this;this.closeInner=function(){i.parent.parent.error.inner=null,i.parent.parent.update()}})}).call(i,e(0))},function(t,i,e){(function(t){t.tag2("bbc-notifications-idcta-html","<span></span>","","",function(t){"use strict";function i(t){var i=decodeURI(t);if(n.indexOf(i)===-1){var e=document.getElementsByTagName("head")[0]||document.documentElement,o=document.createElement("script");o.type="text/javascript",o.appendChild(document.createTextNode(i)),e.insertBefore(o,e.firstChild),e.removeChild(o),n.push(i)}}var e=this,n=[];this.on("mount",function(){e.root.innerHTML=t.html,t.htmlJs&&i(t.htmlJs)})})}).call(i,e(0))},function(t,i,e){(function(t){t.tag2("bbc-notifications-list",'<div if="{!opts.notifications.length}" id="no-notifications" class="no-notifications"> <div class="noVariant--element"> <p class="notifications-long-primer"><i1-8n>copy.noNotifications1</i1-8n></p> <p class="notifications-long-primer"><i1-8n>copy.noNotifications2</i1-8n></p> </div> <div class="variantProductLinks--element variantAddTopic--element"> <div id="no-notifications-no-subscriptions" if="{!opts.subscriptionCount}"> <p class="notifications-long-primer">Start adding to get notifications. Here are some places to add stuff you love.</p> <ul class="notifications-long-primer"> <li><a class="notifications-long-primer" href="{this.links.iplayer}" onclick="{this.logClickUpsell(\'iplayer\')}">iPlayer</a></li> <li>|</li> <li><a class="notifications-long-primer" href="{this.links.musicArtists}" onclick="{this.logClickUpsell(\'music-artists\')}">Music Artists</a></li> <li>|</li> <li><a class="notifications-long-primer" href="{this.links.musicPlaylists}" onclick="{this.logClickUpsell(\'music-playlists\')}">Music Playlists</a></li> </ul> </div> <div id="no-notifications-subscriptions" if="{opts.subscriptionCount}"> <p class="notifications-long-primer">There will be something here for you soon.</p> <p class="notifications-long-primer">To see what you\'ve already added, go to:</p> <ul class="notifications-long-primer"> <li><a class="notifications-long-primer" href="{this.links.myProgrammes}" onclick="{this.logClickEmptyState(\'iplayer\')}">My Programmes</a></li> <li>|</li> <li><a class="notifications-long-primer" href="{this.links.myArtists}" onclick="{this.logClickEmptyState(\'music-artists\')}">My Artists</a></li> <li>|</li> <li><a class="notifications-long-primer" href="{this.links.myPlaylists}" onclick="{this.logClickEmptyState(\'music-playlists\')}">My Playlists</a></li> </ul> </div> </div> </div> <ul if="{opts.notifications.length}" class="notification-items" aria-live="polite" aria-relevant="additions" aria-atomic="true"> <li class="notification-item notification__item--js {status ? \'notification-\' + status : \'\'}" each="{opts.notifications}"> <a class="notification-item--link" href="{notification.url}" onclick="{this.onLinkClick}" onkeydown="{this.onLinkKeyDown}"> <div class="notification-icon-and-dot notification-{product.toLowerCase()}"> <span class="notification-dot {status ? \'notification-\' + status : \'\'}"></span> <div class="notifications-image notification-{product.toLowerCase()}-icon"> </div> </div> <div class="notification-text {status ? \'notification-\' + status : \'\'}"> <div class="notification-title-items"> <div> <p class="notification-text-body notifications-long-primer">{this.title(notification)}</p> </div> <div class="notification-item--info"> <span class="notification-episode-name notifications-brevier">{this.label(notification.episode, product)}</span> <span class="notification-time notifications-brevier">{sampleWhen ? sampleWhen : this.timeago(creationTimestamp)}</span> </div> </div> </div> </a> </li> </ul> <div class="spinner" if="{opts.loadingMore}"> <img class="loader-icon notifications-image spinner__img--svg" riot-src="{this.parent.basePath + \'/svg/loader.svg\'}" alt="Spinner"> </div> <div class="notifications-keyboard-access" if="{this.showKeyboardAccess}"> <button class="notifications-keyboard-access--btn notifications-keyboard-access--more" onclick="{this.keyboardLoadMore}" __disabled="{opts.reachedEnd}"><i1-8n>Load More</i1-8n></button> <button name="notificationsKeyboardClose" class="notifications-keyboard-access--btn notifications-keyboard-access--close" onclick="{this.closeDrawer}" onkeydown="{this.onKeyboardCloseDown}"><i1-8n>Close</i1-8n></button> </div>',"","",function(t){"use strict";var i=this,n=e(5),o=e(2),a=e(1);this.timeago=e(40),this.utils=new n,this.links={usingTheBBC:a.env.aroundBBCUrls.usingTheBBC,iplayer:a.env.aroundBBCUrls.iplayer,musicArtists:a.env.aroundBBCUrls.musicArtists,musicPlaylists:a.env.aroundBBCUrls.musicPlaylists,myProgrammes:a.env.aroundBBCUrls.myProgrammes,myArtists:a.env.aroundBBCUrls.myArtists,myPlaylists:a.env.aroundBBCUrls.myPlaylists},this.capitalizeFirstLetter=function(t){return"iplayer"===t.toLowerCase()?"iPlayer":t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()},this.closeDrawer=function(){document.getElementById("notification-link").click(),document.activeElement&&document.querySelector(".orb-nav-news a").focus()},this.logClickUpsell=function(t){return function(){return o.log(t,"notifications-product-upsell"),!0}},this.logClickEmptyState=function(t){return function(){return o.log(t,"notifications-empty-state"),!0}},this.onLinkClick=function(t){var e=t.item.notification.url,n=i.getAnalyticsNotificationStatus(t.item.status);return o.log("click","notifications-item",{notifications_id:t.item.id,notifications_state:n,notifications_priority:(t.item.priority||"normal").toLowerCase(),notifications_product:t.item.product.toLowerCase(),notifications_type:t.item.type.toLowerCase(),notifications_title:t.item.notification.title,topic_name:o.serialiseTopic(t.item.topic)}),i.parent.parent.notificationsModel.markRead(t.item).then(function(){window.location.assign(e)}),t.preventDefault&&t.preventDefault(),!1},this.getAnalyticsNotificationStatus=function(t){switch(t){case"new":return"blueDot";case"unread":return"new";default:return"read"}},this.onLinkKeyDown=function(t){if(9===t.keyCode){var e=document.activeElement.parentNode.nextSibling,n=!(e.classList&&e.classList.contains("notification-item"));n&&i.update({showKeyboardAccess:!0})}return!0},this.onKeyboardCloseDown=function(t){return!(9===t.keyCode&&!t.shiftKey)||(document.querySelector(".notifications__settings--js").focus(),!1)},this.keyboardLoadMore=function(){var t=document.querySelectorAll(".notification-items .notification-item").length;i.parent.parent.fetchNotifications(!0).then(function(){var e=document.querySelector(".notification-items\n                    .notification-item:nth-child("+(t+1)+") a");e?e.focus():i.notificationsKeyboardClose.focus()})},this.title=function(t){var i="–";return t.title+(t.episode?" "+i+" "+t.episode:"")},this.label=function(t,e){return i.capitalizeFirstLetter(e)}})}).call(i,e(0))},function(t,i,e){(function(t){t.tag2("bbc-notifications-onboarding-async",'<div class="spinner"> <img class="loader-icon notifications-image spinner__img--svg" riot-src="{this.parent.basePath + \'/svg/loader.svg\'}" alt="Spinner"> </div>',"","",function(i){"use strict";var e=this;this.on("mount",function(){e.parent.parent.opts.mainApp.loadOnboarding(function(i){var n={onboard:i,mainApp:e.parent.parent.opts.mainApp,componentApp:e.parent.parent};t.mount(e.root,"bbc-notifications-onboarding",n)})})})}).call(i,e(0))},function(t,i,e){(function(t){t.tag2("bbc-notifications-onboarding-u13-success",'<div class="notifications__container"> <div class="notifications-banner--row"> <span><i1-8n>copy.under13.done</i1-8n></span> <button class="notifications-banner--close" onclick="{parent.hideU13Success}"> <img riot-src="{this.parent.basePath + \'/svg/close_icon.svg\'}" alt="Close"> </button> </div> </div>',"","",function(t){})}).call(i,e(0))},function(t,i,e){(function(t){t.tag2("bbc-notifications-onboarding-u13",'<div class="notifications-full notifications-u13--onboarding-image"> <div class="notifications__container"> <div class="notifications-u13--close-drawer" onclick="{close}"></div> <div class="notifications-u13--content"> <div class="notifications-layout"> <div class="notifications-layout__item gel-bp-s-8/12 gel-bp-m-6/12"> <div if="{opts.idctaData.policyCheck.parentId}"> <p class="notifications-trafalgar-bold"><i1-8n>copy.under13.parentId.title</i1-8n></p> <p class="notifications-pica"><i1-8n>copy.under13.parentId.body</i1-8n></p> </div> <div if="{opts.idctaData.policyCheck.linkPending}"> <p class="notifications-trafalgar-bold"><i1-8n>copy.under13.linkPending.title</i1-8n></p> <p class="notifications-pica"><i1-8n>copy.under13.linkPending.body</i1-8n></p> </div> <div if="{opts.idctaData.policyCheck.permissionNotifications}"> <p class="notifications-trafalgar-bold"><i1-8n>copy.under13.permissionNotifications.title</i1-8n></p> <p class="notifications-pica"><i1-8n>copy.under13.permissionNotifications.body</i1-8n></p> </div> </div> </div> <div class="notifications-layout"> <div class="notifications-20/24 notifications-layout__item notifications-u13--options"> <div if="{opts.idctaData.policyCheck.parentId}"> <a href="{buttonLink}" class="notifications-u13--ok-button notifications-pica-bold"><span><i1-8n>copy.under13.parentId.button</i1-8n></span></a> </div> <div class="notifications-u13--more"> <a href="{this.moreInfoLink}" class="notifications-pica-bold"><span class="notifications-u13--info-icon"></span><i1-8n>copy.under13.moreInfo</i1-8n></a> </div> </div> </div> </div> <div class="notifications-u13--overlay"></div> </div> </div>',"","",function(t){"use strict";var i=this,n=e(1);this.moreInfoLink=n.env.under13s.moreInfo,this.close=function(){t.mainApp.navNotificationElement.click()},this.on("mount",function(){if(t.idctaData&&t.idctaData.policyCheck&&t.idctaData.policyCheck.parentId){var e=t.idctaData.html.match(/<a\s+(?:[^>]*?\s+)?href="([^"]*)"/);e[1]&&i.update({buttonLink:e[1]})}"undefined"!=typeof localStorage&&localStorage.setItem("bbc-notifications-u13-pending-policy",!0)})})}).call(i,e(0))},function(t,i,e){(function(t){t.tag2("bbc-notifications-settings",'<header id="notifications__header" class="notifications__header notifications__header--js"> <h2 class="notification-title notification-title--js"><i1-8n>Notifications Settings</i1-8n></h2> <ul class="notification-header-icons"> <li> <a href="javascript:;" class="notifications__settings__back-btn--js" onkeydown="{this.onBackKeydown}" onclick="{this.parent.closeSettings}" role="link" title="Go back" alt="Go back" aria-label="Go back"><img class="setting-icon notifications-image" riot-src="{this.parent.basePath + \'/svg/arrow_left_black.svg\'}" alt="back"><span class="notifications-brevier"><i1-8n>Back</i1-8n></span></a> </li> </ul> </header> <div class="notifications-settings-description"> <p class="notifications-long-primer"><i1-8n>copy.settings</i1-8n></p> </div> <div each="{this.products}" class="notifications-settings-item notifications-settings-product--js" role="checkbox" aria-checked="{enabled}"> <label tabindex="0" onkeydown="{this.onLabelKeydown}"> <div class="notifications-long-primer notifications-settings-text">{this.getProductSettingLabel(product)}</div> <input type="checkbox" name="checkbox" id="{product}-settings-checkbox" class="notifications-settings-tickbox" value="{product}" __checked="{enabled}" onchange="{this.productChange}"> <div class="notifications-settings-checkbox-hold"></div> </label> </div>',"","",function(t){"use strict";var i=this,n=e(2),o=e(3),a=e(4);this.friendlyProductNames=o.friendlyProductNames,this.getProductSettingLabel=function(t){return a.localise("{product} Notifications",{product:i.friendlyProductNames[t]})},this.updatePref=function(t,e){t.enabled=e.checked,o.set({preferences:{lastReadFlag:!1,productsEnabled:i.products}})["catch"](function(o){throw e.checked=!e.checked,t.enabled=e.checked,i.parent.parent.error.inner="settings",i.parent.parent.update(),n.log("error4-settings-fail","notifications-error"),o}).then(function(){n.log(t.enabled?"opt-in":"opt-out","notifications-settings",{nots_product:t.product.toLowerCase()}),i.parent.parent.resetNotifications()})},this.productChange=function(t){i.updatePref(t.item,t.currentTarget)},this.onBackKeydown=function(t){return 9===t.keyCode&&t.shiftKey?(document.querySelector(".notifications-settings-product--js:last-child label").focus(),!1):(13===t.keyCode&&(i.parent.updateFocus=".notifications__settings--js"),!0)},this.onLabelKeydown=function(t){if(9!==t.keyCode||t.shiftKey){if(13===t.keyCode){var e=t.currentTarget.querySelector("input");return e.checked=!e.checked,i.updatePref(t.item,e),!1}}else{var n=document.activeElement.parentNode.nextSibling,o=!(n.classList&&n.classList.contains("notifications-settings-product--js"));if(o)return document.querySelector(".notifications__settings__back-btn--js").focus(),!1}return!0},this.on("mount",function(){var t=o.get();i.products=t.preferences.productsEnabled})})}).call(i,e(0))},function(t,i,e){(function(t){t.tag2("bbc-notifications",'<bbc-notifications-bell alert="{this.alert}" state="{this.state}"></bbc-notifications-bell> <bbc-notifications-drawer name="drawer" class="variantAddTopic" component-app="{this}" state="{this.state}" onboarding="{this.onboarding}" idcta-data="{this.idctaData}" notifications="{this.notifications}" reached-end="{this.reachedEnd}" loading-more="{this.loadingMore}" error="{this.error}" has-setup="{this.hasSetup}" subscription-count="{this.subscriptionCount}"></bbc-notifications-drawer>',"","",function(t){"use strict";var i=this;e(6);var n=e(1),o=e(2),a=e(33).NotificationsModel,r=e(3),s="notifications";this.state=t.mainApp.idcta.hasCookie()?"signed-in":"signed-out",this.alert=!1,this.onboarding=!1,this.notifications=[],this.reachedEnd=!1,this.loadingMore=!1,this.error={},this.hasSetup=!1,this.ptrt=encodeURIComponent(window.location.href.replace(window.location.hash,"")),this.fetchIdctaData=function(){return new Promise(function(e,o){var a=t.mainApp.idcta.getUserDetailsFromCookie()||{};return"signed-in"===i.state&&"u13"!==a.ab?(i.update({idctaData:{}}),e()):void fetch(n.env.preferencesUrls.idcta+"?buttonColour=white&policy=notification&ptrt="+i.ptrt,{credentials:"include"}).then(function(t){return t.json()}).then(function(t){var e=void 0,n=t.html.replace(/<script[\s\S]*?>[\s\S]*?<\/script>/gi,function(t){var i=t.substring(t.indexOf(">")+1);return i=i.slice(0,i.indexOf("</script")),e=i,""});t.html=n,e&&(t.htmlJs=encodeURI(e)),i.update({idctaData:t})})["catch"](function(t){return o(t)}).then(function(){return e()})})},this.isUserOnBoarded=function(){var e=t.mainApp.idcta.getUserDetailsFromCookie();if(e&&"u13"===e.ab&&i.idctaData&&!i.idctaData.policyCheck)return!0;var n=r.get();if(!n)return null;var o=n.preferences;return null!==o&&"undefined"!=typeof o.hasOnboarded&&o.hasOnboarded},this.setOnboarding=function(t){t||(i.update({alert:!1}),i.initModel()),i.update({onboarding:t})},this.drawerStateChangedCallback=function(t){if(i.update({alert:!1}),"hidden"===t){if(i.notificationsModel){var e=i.notificationsModel.markAllAsSeen();i.update({notifications:e})}}else i.logNewNotifications(),document.activeElement&&document.activeElement.classList&&document.activeElement.classList.contains("js-notification-link")&&document.querySelector(".notifications__settings--js").focus();if("signed-in"===i.state){if("undefined"!=typeof app)return;i.isUserOnBoarded()===!0?r.updateRead(!0):i.onboarding||i.errorState||i.setOnboarding(!0)}else"hidden"===t?o.log("close-pane","notifications-icon"):o.log("upsell","notifications-icon");i.trigger("drawerStateChanged",t)},this.fetchPreferences=function(){r.fetch()["catch"](function(t){throw o.log("error-fetch-preferences","notifications-error"),i.setError("main","hub"),t}).then(function(){i.removeError("main")})},this.fetchNotifications=function(t){t&&i.update({loadingMore:!0});var e=i.notifications.length;return i.notificationsModel.fetch(t)["catch"](function(t){throw o.log("error-fetch-notifications","notifications-error"),i.setError("main","hub"),t}).then(function(t){if(t){var n=t.notifications,o=t.reachedEnd;i.notifications=n,o&&(i.reachedEnd=o),i.loadingMore=!1;var a=!1;n.forEach(function(t){"new"===t.status&&(a=!0)}),a&&(i.logNewNotifications(),n.length>e&&(i.alert=!0)),i.removeError("main"),i.update()}})},this.setError=function(t,e){i.logError(),i.error[t]=e,i.update()},this.logError=function(){var t="error1-retrieve-fail";i.hasSetup&&(t="error2-update-fail"),o.log(t,"notifications-error")},this.removeError=function(t){delete i.error[t],i.update()},this.resetNotifications=function(){i.update({notifications:[],reachedEnd:!1}),i.notificationsModel.reset(),i.fetchNotifications()},this.initModel=function(){i.notificationsModel||i.error.main||(i.notificationsModel=new a,i.fetchNotifications(),window.setInterval(i.fetchNotifications,n.env.notificationsPollingInterval),window.setInterval(i.fetchPreferences,n.env.preferencesPollingInterval))},this.updateSubscriptionCount=function(t){i.update({subscriptionCount:t||r.countActiveSubscriptions()})},this.setup=function(){i.fetchIdctaData()["catch"](function(t){throw o.log("error-setup-fetch-idcta","notifications-error"),i.setError("main","hub"),t}).then(function(){"signed-in"===i.state&&r.fetch()["catch"](function(t){throw o.log("error-setup-fetch-preferences","notifications-error"),i.setError("main","hub"),t}).then(function(){i.subscriptionCount=r.countActiveSubscriptions(),i.isUserOnBoarded()===!1?i.update({alert:!0}):i.initModel(),i.removeError("main"),i.update({hasSetup:!0}),i.trigger("finishedSetup")})});var e=document.createElement("div");e.className="orb-panel",e.appendChild(i.drawer),t.orb.addDrawer(s,document.querySelector(".js-notification-link"),e,i.drawerStateChangedCallback),t.mainApp.setNotificationIcon()};var c=[];this.logNewNotifications=function(){"shown"===t.mainApp.getDrawerState()&&i.notifications.forEach(function(t){"new"===t.status&&c.indexOf(t.id)===-1&&(o.log("seen","notifications-item",{notifications_id:t.id,notifications_state:"blueDot",notifications_priority:(t.priority||"normal").toLowerCase(),notifications_product:t.product.toLowerCase(),notifications_type:t.type.toLowerCase(),notifications_title:t.notification.title,topic_name:o.serialiseTopic(t.topic)}),c.push(t.id))})},this.on("mount",this.setup),this.on("updated",function(){t.mainApp.updateWrapperMaxHeight()})})}).call(i,e(0))},function(t,i,e){"use strict";function n(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),a=e(39),r=e(5),s=new r,c=8192,u=function(){function t(i){n(this,t),this.filterName=i,this.filter=new a(c,16)}return o(t,[{key:"override",value:function(t){"string"==typeof t&&""!==t&&(t=s.handledParse(t,[])),s.isArray(t)&&0===t.length&&(t=c),this.filter=new a(t,16)}},{key:"add",value:function(t){t&&""!==t&&this.filter.add(t)}},{key:"getCleanArray",value:function(){return[].slice.call(this.filter.buckets)}},{key:"contains",value:function(t){return!(!t||""===t)&&this.filter.test(t)}},{key:"checkOrAdd",value:function(t){t&&""!==t&&(this.contains(t)||this.add(t))}}]),t}();Object.defineProperty(i,"BloomFilterManager",{configurable:!1,enumerable:!0,get:function(){return u}})},function(t,i,e){function n(){var t=navigator.userAgent.toLowerCase();return t.indexOf("msie")!==-1&&parseInt(t.split("msie")[1],10)<=9}var o=e(14);e(15);var a={run:function(){}};n()||!function(){e(18),e(20),e(23),e(27),e(24),e(26),e(25),e(21),e(22),e(17),e(19),e(28),e(16);var t=e(4),i=e(8),n=e(7);t.dictionary(i);var r=n.get("ckps_language");r&&i[r]&&t.setLanguage(r);var s=e(9),c=e(5),u=new c,l=e(0),d=e(3),f=void 0,h=void 0;a={name:"mainApp",drawerName:"notifications",errorState:!1,notificationPanelCreated:!1,run:function(t,i){var o=this;window.require&&window.require(["orb/nav","idcta/id-config"],function(a,r){o.basePath=i||"",e.p=o.basePath+"js/",o.orb=a,o.setIdcta(t,r);var c=document.getElementById("mybbc-wrapper"),u=document.getElementById("notification-link");if(u){c.removeChild(u);var d=document.createElement("bbc-notifications");c.appendChild(d)}l.mount("bbc-notifications",{orb:a,mainApp:o});var f="ckps_bbc_idv5_cutover",h=n.get(f),p=n.get("IDENTITY");if(!t.hasCookie()&&"RED"!==r["bbcid-v5"]&&p&&!h){var g=document.getElementById("orb-banner"),m=document.createElement("div");m.className="orb-signin-upsell-banner",g.appendChild(m),l.mount(m,"bbc-id-cutover",{mainApp:o})}s.addEvent(document,"ready",o._setHubResizeEvent())})},_setHubResizeEvent:function(){var t=this,i=void 0;["resize","orientationchange"].forEach(function(e){s.addEvent(window,e,function(){i&&clearTimeout(i),i=setTimeout(u.bind(t.updateWrapperMaxHeight,t),100)})}),this.updateWrapperMaxHeight()},setIdcta:function(t,i){"function"==typeof t.getInstance?this.idcta=t.getInstance():this.idcta=t,this.idConfig=i},isWindowsPhone:function(){return navigator.appVersion.indexOf("Win")!==-1&&"undefined"!=typeof window.navigator.pointerEnabled&&null!==navigator.userAgent.match(/.+windows.+(touch|phone).+/i)},updateWrapperMaxHeight:function(){var t=420,i=o.touchevents()||this.isWindowsPhone()?.75:.65,e=document.querySelector(".orb-nav-pri-container"),n=null!==e?e.offsetHeight:0,a=44,r=document.documentElement.clientHeight||window.innerHeight,s=r*i-n-a;o.touchevents()||this.isWindowsPhone()||(s=Math.min(s,t));var c=document.querySelector("#notifications-wrapper");c&&(c.style.maxHeight=s+"px"),this.orb.updateDrawerHeight(this.drawerName)},updateDrawerHeight:function(){return this.orb.updateDrawerHeight(this.drawerName)},isUserOnBoarded:function(){var t=d.get(),i=t.preferences;return null!==i&&"undefined"!=typeof i.hasOnboarded&&i.hasOnboarded},loadOnboarding:function(t){this.loadOnboardingStyles(),e.e(1).then(e.bind(null,37)).then(t)},loadOnboardingStyles:function(){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=this.basePath+"css/onboarding.min.css",document.getElementsByTagName("head")[0].appendChild(t)},getOnboardingParams:function(t){return{mainElSelector:".notifications-on-boarding--js",app:this,componentApp:t,isIE:this.isIE(),errorView:h,resizeEvent:u.bind(this._setHubResizeEvent,this)}},setNotificationIcon:function(){var t=this;this.navNotificationElement=document.querySelector(".js-notification-link"),this.navNotificationElement.onkeydown=function(i){var e=i.which||i.charCode;13===e&&(t.lastEnterPress=Date.now())},this.orb.refresh()},getNavNotificationEl:function(){return this.navNotificationElement;
},getDrawerState:function(){return this.orb.getDrawerState(this.drawerName)},resetOnboarding:function(){f.resetOnboarding(),f.init(this.getOnboardingParams())},getUserPreferencesModel:function(){return d},isIE:function(){if(document.documentMode)return document.documentMode;for(var t=7;t>0;t--){var i=document.createElement("div");if(i.innerHTML="<!--[if IE "+t+"]><span></span><![endif]-->",i.getElementsByTagName("span").length)return t}},removeCustomHeights:function(){f.removeCustomHeights()}}}(),t.exports=a},function(t,i){"use strict";t.exports=[{domain:"tv",type:"brand",id:"p0118t80",title:"Call the Midwife",product:"iPlayer",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p02gcyjn.jpg",link:"http://www.bbc.co.uk/programmes/p0118t80"},{domain:"tv",type:"brand",id:"p04cm25y",title:"Let It Shine",product:"iPlayer",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p04cm7r4.jpg",link:"http://www.bbc.co.uk/programmes/p04cm25y"},{domain:"music",type:"playlist",id:"zzzz48",title:"Hottest Records in the World",product:"Music",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p03vfgl3.jpg",link:"http://www.bbc.co.uk/music/playlists/zzzz48"},{domain:"tv",type:"brand",id:"b007t575",title:"Who Do You Think You Are?",product:"iPlayer",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p01lchcf.jpg",link:"http://www.bbc.co.uk/programmes/b007t575"},{domain:"music",type:"artist",id:"5441c29d-3602-4898-b1a1-b77fa23b8e50",title:"David Bowie",product:"Music",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p03f55xz.jpg",link:"http://www.bbc.co.uk/music/artists/5441c29d-3602-4898-b1a1-b77fa23b8e50"},{domain:"tv",type:"brand",id:"b052ql4f",title:"Uncle",product:"iPlayer",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p04lcjvr.jpg",link:"http://www.bbc.co.uk/programmes/b052ql4f"},{domain:"tv",type:"brand",id:"b006ml0g",title:"QI",product:"iPlayer",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p04bq261.jpg",link:"http://www.bbc.co.uk/programmes/b006ml0g"},{domain:"music",type:"artist",id:"130c2184-14f2-4180-a216-04b5a333be57",title:"Sampha",product:"Music",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p01l0xpw.jpg",link:"http://www.bbc.co.uk/music/artists/130c2184-14f2-4180-a216-04b5a333be57"},{domain:"tv",type:"brand",id:"b088s45m",title:"Taboo",product:"iPlayer",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p04m9ybh.jpg",link:"http://www.bbc.co.uk/programmes/b088s45m"},{domain:"tv",type:"brand",id:"b006m86d",title:"Eastenders",product:"iPlayer",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p01vg679.jpg",link:"http://www.bbc.co.uk/programmes/b006m86d"},{domain:"music",type:"playlist",id:"zzzzx2",title:"Radio 2 Playlist",product:"Music",image:"https://ichef.bbc.co.uk/images/ic/$recipe/p038b58w.jpg",link:"http://www.bbc.co.uk/music/playlists/zzzzx2"},{domain:"tv",type:"brand",id:"b00lskhg",title:"Only Connect",product:"iPlayer",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p02l7xz8.jpg",link:"http://www.bbc.co.uk/programmes/b00lskhg"},{domain:"music",type:"playlist",id:"zzzz8v",title:"BBC 6 Music Recommends",product:"Music",image:"https://ichef.bbc.co.uk/images/ic/$recipe/p038b76r.jpg",link:"http://www.bbc.co.uk/music/playlists/zzzz8v"},{domain:"tv",type:"brand",id:"b006t14n",title:"Panorama",product:"iPlayer",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p01lyn5j.jpg",link:"http://www.bbc.co.uk/programmes/b006t14n"},{domain:"tv",type:"brand",id:"b01pvmf6",title:"Death in Paradise",product:"iPlayer",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p03dmn8l.jpg",link:"http://www.bbc.co.uk/programmes/b01pvmf6"},{domain:"music",type:"artist",id:"5b6ebfe0-f72b-4902-bba9-74c8af0f1af0",title:"The 1975",product:"Music",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p03l2j94.jpg",link:"http://www.bbc.co.uk/music/artists/5b6ebfe0-f72b-4902-bba9-74c8af0f1af0"},{domain:"tv",type:"brand",id:"b006xnzc",title:"The Graham Norton Show",product:"iPlayer",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p048ldpl.jpg",link:"http://www.bbc.co.uk/programmes/b006xnzc"},{domain:"tv",type:"brand",id:"b007t9y1",title:"Match of the Day",product:"iPlayer",image:"https://ichef.bbci.co.uk/images/ic/$recipe/p03y6jf1.jpg",link:"http://www.bbc.co.uk/programmes/b007t9y1"}]},function(t,i,e){function n(){return new Promise(function(t,i){window.require(["idcta/idcta-1"],function(e){e.initiateTokenRefresh(void 0,void 0,!0).then(function(i){t(i)})["catch"](function(t){i(t)})})})}i.refreshToken=n},function(t,i,e){function n(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var o=e(34),a=e(35),r=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),s=e(1),c=e(3),u=e(13),l=e(10),d=s.env.feedTopicMaxSubscriptions,f=function(){function t(){n(this,t);var i=c.countActiveSubscriptions();this.notifications=[],i>d?this.modelInterface=new o.AggregatedCollection:this.modelInterface=new a.TopicCollection;var e=c.get();if(e.preferences)this.lastRead=new Date(e.preferences.lastRead),u.override(e.preferences.readFilter);else{var r=new Date;r.setDate(r.getDate()-5),this.lastRead=r}}return r(t,[{key:"populateReadStatus",value:function(t){var i=this;return t.forEach(function(t){u.contains(t.id)?t.status=null:new Date(i.lastRead)<new Date(t.creationTimestamp)?t.status="new":t.status="unread"}),t}},{key:"markRead",value:function(t){return u.checkOrAdd(t.id),c.updateRead(),t.status=null,c.updateRead()}},{key:"markAllAsSeen",value:function(){return this.notifications.forEach(function(t){"new"===t.status&&(t.status="unread")}),this.notifications}},{key:"reset",value:function(){return this.notifications=[],this.fetch()}},{key:"fetch",value:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.modelInterface.fetch(i).then(function(e){var n=e.data,o=e.reachedEnd;n.sort(function(t,i){return new Date(t.creationTimestamp)>=new Date(i.creationTimestamp)?1:-1});var a=t.populateReadStatus(n),r=i?a.reverse():a;return r.forEach(function(e){l(t.notifications,function(t){return t.id===e.id})||t.notifications[i?"push":"unshift"](e)}),{notifications:t.notifications,reachedEnd:o}})}}]),t}();Object.defineProperty(i,"NotificationsModel",{configurable:!1,enumerable:!0,get:function(){return f}})},function(t,i,e){function n(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function o(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}function a(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}var r=e(12),s=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),c=function l(t,i,e){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,i);if(void 0===n){var o=Object.getPrototypeOf(t);return null===o?void 0:l(o,i,e)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(e)},u=function(t){function i(){return n(this,i),o(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return a(i,t),s(i,[{key:"fetch",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t?this.NEXT_DISPLAY_PAGE:"latest.json",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return c(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"loadData",this).call(this,"aggregated",n).then(function(n){var a=n.list,r=n.next,s=n.reachedEnd;if(!a)return{data:[],reachedEnd:s};r||(s=!0);var u=o.concat(a),l=c(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"filterData",e).call(e,u),d=c(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"dedupeData",e).call(e,l);return d.length>=e.MINIMUM_TO_DISPLAY||s?((!e.NEXT_DISPLAY_PAGE||t&&!s&&r)&&(e.NEXT_DISPLAY_PAGE=r),{data:d,reachedEnd:s}):e.fetch(t,r,d)})}}]),i}(r.BaseCollection);Object.defineProperty(i,"AggregatedCollection",{configurable:!1,enumerable:!0,get:function(){return u}})},function(t,i,e){function n(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function o(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}function a(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}var r=e(12),s=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),c=function l(t,i,e){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,i);if(void 0===n){var o=Object.getPrototypeOf(t);return null===o?void 0:l(o,i,e)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(e)},u=function(t){function i(){n(this,i);var t=o(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return t.TOPIC_NEXT_DISPLAY_PAGE={},t.TOPIC_REACHED_END={},t.notifications=[],t}return a(i,t),s(i,[{key:"loadTopicPage",value:function(t,e,n){var o=this;return c(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"loadData",this).call(this,t.topic,n).then(function(n){var a=n.list,r=n.next,s=n.reachedEnd;if(!a)return{data:[],reachedEnd:s,topic:t};(!o.TOPIC_NEXT_DISPLAY_PAGE[t.topic]||e&&!s&&r)&&(o.TOPIC_NEXT_DISPLAY_PAGE[t.topic]=r);var u=c(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"filterData",o).call(o,a);return!s&&u.length&&r&&"false"!==r||(o.TOPIC_REACHED_END[t.topic]=!0),{data:u,reachedEnd:s,topic:t}})}},{key:"fetch",value:function(t){var e=this;this.perTopicNotifications={};var n=[];return t||(this.notifications=[]),this.topics.forEach(function(i){e.TOPIC_REACHED_END[i.topic]&&t||n.push(e.loadTopicPage(i,t,t?e.TOPIC_NEXT_DISPLAY_PAGE[i.topic]:"latest.json").then(function(t){return e.notifications=e.notifications.concat(t.data),t}))}),Promise.all(n).then(function(t){var n=t.every(function(t){return t.reachedEnd}),o=c(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"dedupeData",e).call(e,e.notifications);return o.length>=e.MINIMUM_TO_DISPLAY||n?{data:o,reachedEnd:n}:e.fetch(!0)})}}]),i}(r.BaseCollection);Object.defineProperty(i,"TopicCollection",{configurable:!1,enumerable:!0,get:function(){return u}})},function(t,i,e){function n(){var t=c.slice(u,u+l);return u+l>=c.length?u=0:u+=l,t}i.load=n;var o={"1x":"288x162","2x":"576x324"},a=window.devicePixelRatio||1,r=a>=2?"2x":"1x",s=o[r],c=e(31);c.forEach(function(t){t.image=t.image.replace("$recipe",s)});var u=0,l=6},,function(t,i,e){function n(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function o(t){if(t.status>=200&&t.status<300)return t;var i=new Error(t.statusText);throw i.response=t,i}function a(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"followed";return l.create({activityType:"follows",resourceDomain:t.domain,resourceType:t.type,resourceId:t.id,action:i,metaData:{source:"notifications"}})}var r=e(1),s=r&&r.__esModule?function(){return r["default"]}:function(){return r};Object.defineProperty(s,"a",{get:s}),i.addEvent=a;var c=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),u=function(){function t(){n(this,t),this.apiKey=s.a.env.uas.apiKey,this.env=s.a.env.uas.env,this.domainSuffix="co.uk"}return c(t,[{key:"create",value:function(t){var i=t.activityType;delete t.activityType;var e=["activity"];return"live"!==this.env&&e.push(this.env),"unfollowed"===t.action&&"tv"===t.resourceDomain?fetch("https://"+e.join(".")+".api.bbc."+this.domainSuffix+"/my/"+i+"/urn:bbc:tv:"+t.resourceType+":"+t.resourceId,{method:"DELETE",credentials:"include",headers:{"X-API-KEY":this.apiKey,"Content-Type":"application/json"}}).then(o):fetch("https://"+e.join(".")+".api.bbc."+this.domainSuffix+"/my/"+i,{method:"POST",credentials:"include",headers:{"X-API-KEY":this.apiKey,"Content-Type":"application/json"},body:JSON.stringify(t)}).then(o)}}]),t}(),l=new u},function(t,i){"use strict";function e(t,i){var e;"number"!=typeof t&&(e=t,t=32*e.length);var n=Math.ceil(t/32),o=-1;if(this.m=t=32*n,this.k=i,r){var a=1<<Math.ceil(Math.log(Math.ceil(Math.log(t)/Math.LN2/8))/Math.LN2),s=1===a?Uint8Array:2===a?Uint16Array:Uint32Array,c=new ArrayBuffer(a*i),u=this.buckets=new Int32Array(n);if(e)for(;++o<n;)u[o]=e[o];this._locations=new s(c)}else{var u=this.buckets=[];if(e)for(;++o<n;)u[o]=e[o];else for(;++o<n;)u[o]=0;this._locations=[]}}function n(t){return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24}function o(t){for(var i,e,n=t.length,o=2166136261,a=-1;++a<n;)i=t.charCodeAt(a),(e=4278190080&i)&&(o^=e>>24,o+=(o<<1)+(o<<4)+(o<<7)+(o<<8)+(o<<24)),(e=16711680&i)&&(o^=e>>16,o+=(o<<1)+(o<<4)+(o<<7)+(o<<8)+(o<<24)),(e=65280&i)&&(o^=e>>8,o+=(o<<1)+(o<<4)+(o<<7)+(o<<8)+(o<<24)),o^=255&i,o+=(o<<1)+(o<<4)+(o<<7)+(o<<8)+(o<<24);return o+=o<<13,o^=o>>7,o+=o<<3,o^=o>>17,o+=o<<5,4294967295&o}function a(t){return t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24),t+=t<<13,t^=t>>7,t+=t<<3,t^=t>>17,t+=t<<5,4294967295&t}var r="undefined"!=typeof ArrayBuffer;e.prototype.locations=function(t){for(var i=this.k,e=this.m,n=this._locations,r=o(t),s=a(r),c=-1,u=r%e;++c<i;)n[c]=u<0?u+e:u,u=(u+s)%e;return n},e.prototype.add=function(t){for(var i=this.locations(t+""),e=-1,n=this.k,o=this.buckets;++e<n;)o[Math.floor(i[e]/32)]|=1<<i[e]%32},e.prototype.test=function(t){for(var i,e=this.locations(t+""),n=-1,o=this.k,a=this.buckets;++n<o;)if(i=e[n],0===(a[Math.floor(i/32)]&1<<i%32))return!1;return!0},e.prototype.size=function(){for(var t=this.buckets,i=0,e=0,o=t.length;e<o;++e)i+=n(t[e]);return-this.m*Math.log(1-i/this.m)/this.k},t.exports=e},function(t,i,e){"use strict";var n=e(4);t.exports=function(t){var i=new Date(t),e=new Date,o=Math.floor(Math.abs(e-i)/36e5),a=Math.floor(Math.abs(e-i)/6e4);return o>23&&o<48?n.localise("Yesterday"):o>=48&&o<168?(o/24).toFixed(0)+" "+n.localise("days ago"):o>0?o+" "+n.localise("hour"+(1===o?"":"s")+" ago"):a>0?a+" "+n.localise("minute"+(1===a?"":"s")+" ago"):n.localise("Just now")}},function(t,i){(function(i){t.exports=i}).call(i,{})}])});
//# sourceMappingURL=NotificationsMain.js.map