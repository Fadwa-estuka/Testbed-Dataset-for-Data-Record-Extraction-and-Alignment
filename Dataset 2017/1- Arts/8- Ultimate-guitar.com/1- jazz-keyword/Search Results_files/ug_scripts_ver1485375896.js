function getValue(){var inputs=$("#sb input:text:visible"),val="",cb="title";return 2==inputs.length?(val=inputs.eq(0).val(),inputs.eq(0).val()&&inputs.eq(1).val()&&(val+=" "),val+=inputs.eq(1).val()):(val=inputs.val(),$("#sb select:visible[name=search_type]").length&&(cb=$("#sb select:visible[name=search_type]").val())),{text:val,cb:cb}}function setValue(val){var inputs=$("#sb input:text:visible");2==inputs.length?"title"==val.cb?(inputs.eq(0).val(""),inputs.eq(1).val(val.text)):(inputs.eq(1).val(""),inputs.eq(0).val(val.text)):inputs.val(val.text)}function SwitchSearch(){var val=getValue(),advanced=document.getElementById("search_bar_advanced"),simple=document.getElementById("search_bar_simple"),expanded=""==advanced.style.display;advanced.style.display=expanded?"none":"",simple.style.display=expanded?"":"none",document.getElementById("expand_search_link").className=expanded?"expa expand_icon":"expa colapse_icon",document.getElementById("expand_search_link").innerHTML=expanded?"<b></b>Expand":"<b></b>Collapse",$(".search-main").toggleClass("search_b_adv"),setValue(val);var ug_search_cookie_name="ug_search_exp";return expanded?document.cookie=ug_search_cookie_name+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;":$.cookie(ug_search_cookie_name,"1"),!1}function SwitchAdvancedForm(){var val=getValue();return $(".adv_one_field").toggleClass("dn"),$(".adv_two_fields").toggleClass("dn"),$(".adv_one_field input").attr("disabled",!1),$(".adv_one_field.dn input").attr("disabled",!0),$(".adv_two_fields input").attr("disabled",!1),$(".adv_two_fields.dn input").attr("disabled",!0),setValue(val),!1}function getURLParameter(name){return decodeURIComponent((location.search.match(RegExp("[?|&]"+name+"=(.+?)(&|$)"))||[,null])[1])}function getTabsHistory(){var tabs_history=$.cookie("tabs_history",new Array);try{null!=tabs_history&&tabs_history.length>2&&(tabs_history=JSON.parse(tabs_history)),null==tabs_history&&(tabs_history=new Array)}catch(err){tabs_history=new Array,$.cookie("tabs_history",JSON.stringify(tabs_history),{expires:365,path:"/",domain:"."+ug_serv})}return tabs_history}function renderTabHistoryItem(history_item){$("#history-tooltip .no-tabs").length>0&&$("#history-tooltip .no-tabs").remove(),$("#history-tooltip .history-items").append('<div class="nowrap">'+history_item.artist+' - <a href="'+document.location.protocol+"//tabs."+main_server_name+history_item.url+'">'+history_item.name+(1==history_item.v?"":" (ver "+history_item.v+")")+"</a></div>")}function switch_auth_blocks(enabled_block_names,not_hide_msg){$("#a_layer .a_block").hide();for(var key=0;key<enabled_block_names.length;key++)$("#a_layer ."+enabled_block_names[key]).show();not_hide_msg!==!0&&remove_all_auth_messages()}function remove_all_auth_messages(){$("#a_layer .a_msg").removeClass("success").hide(),$("#a_layer .a_msg ul li").remove(),$("#a_layer input").removeClass("wrong")}function show_auth_message(type,position,text,msg_class){$(".a_msg").show(),"success"==type?$(".a_msg").addClass("success"):($(".a_msg").hasClass("success")&&($(".a_msg").removeClass("success"),$(".a_msg ul li").remove()),$("#a_layer input[name="+msg_class+"]").addClass("wrong")),$(".a_msg li."+msg_class_prefix+msg_class).length>0?$(".a_msg li."+msg_class_prefix+msg_class).html(text):$(".a_msg ul."+position).append("<li class="+msg_class_prefix+msg_class+">"+text+"</li>")}function remove_auth_msg(msg_class){$(".a_msg ul li."+msg_class_prefix+msg_class).remove(),$("#a_layer input[name="+msg_class+"]").removeClass("wrong"),0==$(".a_msg ul li").length&&$(".a_msg").hide()}function get_random_string(string_length){for(var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",randomstring="",i=0;i<string_length;i++){var rnum=Math.floor(Math.random()*chars.length);randomstring+=chars.substring(rnum,rnum+1)}return randomstring}function auth_on_sign_in(data){auth_fill_user_info(data),close_auth_layer(),data.user_id&&(window.user_id=data.user_id,window.UGAPP.config.user.id=data.user_id),"function"==typeof window.auth_callback_function?window.auth_callback_function.apply(auth_callback_function,auth_callback_params):"function"==typeof window[auth_callback_function]&&window[auth_callback_function].apply(auth_callback_function,auth_callback_params)}function redirect_after_login(url){window.location=url}function auth_fill_user_info(data){var user_iq=data.iq||"";$("#login_user_guest").hide(),$("#login_user_auth").removeClass("dn"),header_fill_user_info($.cookie("bbuserid"),$.cookie("bbusername"),user_iq)}function check_exist_user_by_param(user_param_name,user_param_value,message_position){$.jsonp({callbackParameter:"callback",url:document.location.protocol+"//www."+main_server_name+"/user/auth/check",data:{action_type:"register",name:user_param_name,value:user_param_value},timeout:1e5,success:function(data){return"error"==data.result?(show_auth_message("error",message_position,user_param_name.charAt(0).toUpperCase()+user_param_name.slice(1)+auth_msg.verify_user_exist,user_param_name),!0):(remove_auth_msg(user_param_name),!1)}})}function send_reset_password_email_to_user(email_to_send,success_msg){$("#a_layer .a_msg").is(":visible")&&!$("#a_layer .a_msg").hasClass("success")||$.jsonp({url:document.location.protocol+"//www."+main_server_name+"/user/security/sendResetPasswordMail",callbackParameter:"callback",data:{email:email_to_send},timeout:4e4,success:function(json){"error"==json.result?(show_auth_message("error","r",auth_msg.verify_email,"email"),ga("send","event","LoginRegister PopUp","LoginRegister SignIn","LoginRegister ForgotPassword False")):(show_auth_message("success","r",success_msg,"email"),ga("send","event","LoginRegister PopUp","LoginRegister SignIn","LoginRegister ForgotPassword Success"))},error:function(){show_auth_message("error","r",auth_msg.something_happens,"email")}})}function send_activation_email_to_user(email_to_send,success_msg){$("#a_layer .a_msg").is(":visible")&&!$("#a_layer .a_msg").hasClass("success")||$.jsonp({url:document.location.protocol+"//www."+main_server_name+"/user/security/sendActivationLetter",callbackParameter:"callback",data:{email:email_to_send},timeout:4e4,success:function(json){"error"==json.result?(show_auth_message("error","r",auth_msg.verify_email,"email"),ga("send","event","LoginRegister PopUp","LoginRegister Activation","Activation Resend False")):(show_auth_message("success","r",success_msg,"email"),ga("send","event","LoginRegister PopUp","LoginRegister Activation","Activation Resend Success"))},error:function(){show_auth_message("error","r",auth_msg.something_happens,"email")}})}function show_auth_layer_on_registration(callback){if(window.register_callback=callback,!ug_load_recaptcha)if(ug_load_recaptcha=!0,"object"!=typeof grecaptcha)$.getScript("https://www.google.com/recaptcha/api.js",function(data,textStatus){});else{var $$recaptcha=document.querySelector(".register .recaptcha2"),sitekey=$$recaptcha.getAttribute("data-sitekey"),size=$$recaptcha.getAttribute("data-size");grecaptcha.render($$recaptcha,{sitekey:sitekey,callback:onUgRegisterRepachaSuccess,size:size})}switch_auth_blocks(new Array("register")),show_auth_layer(auth_callback_function),ga("send","event","LoginRegister PopUp","LoginRegister SignUp","SignUp Show")}function show_auth_layer_for_blocked_users(){show_auth_layer(""),switch_auth_blocks(new Array("a_blocked"))}function show_auth_layer_for_non_activ_users(){""==$("#a_layer .a_block.activ input[name=email]").val()&&$.jsonp({url:document.location.protocol+"//www."+main_server_name+"/user/auth/getEmail",callbackParameter:"callback",timeout:4e4,success:function(json){$("#a_layer .a_block.activ input[name=email]").val(json.email)}}),show_auth_layer(""),$("#a_layer .a_block.activ").addClass("again"),switch_auth_blocks(["activ_none","activ"])}function show_auth_layer_create_username(avatar_path,message,again,url,username){$("#a_layer").show(),switch_auth_blocks(["username_exist","create_username"]),$(".a_block.create_username").attr("data",url),$(".a_block.username_exist font").html(username),""!=avatar_path&&$(".a_block.create_username .log_ico").show().prepend('<img src="'+avatar_path+'" />'),1==again?show_auth_message("error","r",message,"username"):ga("send","event","LoginRegister PopUp","LoginRegister ChangeUsername","ChangeUsername Show")}function show_auth_layer(callback_name){auth_callback_function=callback_name,$("#a_layer").show(),ga("send","event","LoginRegister PopUp","LoginRegister SignIn","LoginRegister Show")}function show_forgot_password(){switch_auth_blocks(["sign_in","forgot"]),ga("send","event","LoginRegister PopUp","LoginRegister SignIn","LoginRegister ForgotPassword Show")}function close_auth_layer(){$("#a_layer").hide(),switch_auth_blocks(["sign_in","sign_up"])}function prepare_auth_layer(){auth_callback_params=[],auth_callback_need_activ=!0}function get_avatar_url(user_id){for(full_user_id=user_id;full_user_id.length<3;)full_user_id="0"+full_user_id;return document.location.protocol+"//"+js_img_domain+"/users/"+full_user_id[full_user_id.length-1]+"/"+full_user_id[full_user_id.length-2]+"/"+full_user_id[full_user_id.length-3]+"/"+user_id+".gif?d=d"}function header_fill_user_info(user_id,user_name,user_iq){var username_header=document.getElementById("username_header"),user_iq_container=document.querySelector(".ug-iq--rating__main-header");username_header.href="http://profile."+main_server_name+"/"+encodeURIComponent(user_name)+"/",username_header.innerHTML='<b class="f-left"></b>'+user_name,user_iq_container.innerHTML=user_iq,user_iq_container.href="/user/activity/iq?user_id="+user_id,document.getElementById("login_user_auth").className="",document.getElementById("login_user_guest").className="dn";var header_login_ava=document.getElementById("header_login_ava");header_login_ava.innerHTML='<img src="'+get_avatar_url(user_id)+'" />'}function onUgRegisterRepachaSuccess(){remove_auth_msg("capcha")}function auth_input_validate($input,not_check_visibility){if(not_check_visibility||$input.parents(".a_block").is(":visible")){var input_name=$input.attr("name");switch(input_name){case"username":var message_position="l";if($("#a_layer .a_block.create_username").is(":visible")&&(message_position="r"),0==$input.val().length)show_auth_message("error",message_position,input_name.charAt(0).toUpperCase()+input_name.slice(1)+auth_msg.verify_empty,input_name);else if($input.val().length<=3&&"none"==$("#a_layer .a_block.sign_in").css("display"))show_auth_message("error",message_position,auth_msg.verify_username,input_name);else if($("#a_layer .a_block.register").is(":visible")||$("#a_layer .a_block.create_username").is(":visible")){var username_regexp=/^[a-zA-Z0-9_-]+$/;username_regexp.test($input.val())?check_exist_user_by_param(input_name,$input.val(),message_position):show_auth_message("error",message_position,auth_msg.verify_not_allowed_symbols,input_name)}else remove_auth_msg(input_name);break;case"email":var email_regexp=/^[a-z0-9_\.\-]*@[a-z0-9\.\-]+\.[a-z]{2,4}$/i,email_val=$input.val();0==$input.val().length?show_auth_message("error",$input.parents(".a_block.register").is(":visible")?"l":"r",input_name.charAt(0).toUpperCase()+input_name.slice(1)+auth_msg.verify_empty,input_name):email_regexp.test(email_val)?$("#a_layer .a_block.register").is(":visible")?check_exist_user_by_param(input_name,$input.val(),"l"):remove_auth_msg(input_name):show_auth_message("error",$input.parents(".a_block.register").is(":visible")?"l":"r",auth_msg.verify_email,input_name);break;case"pass":0==$input.val().length?show_auth_message("error","l","Password"+auth_msg.verify_empty,input_name):remove_auth_msg(input_name);break;case"capcha":grecaptcha.getResponse()||show_auth_message("error","r",auth_msg.verify_capcha,"capcha")}}}function trackMetricaEvent(event_name){if("complete"==document.readyState)try{yaCounter18746557.reachGoal(event_name)}catch(e){}else window.addEventListener("load",function(){trackMetricaEvent(event_name)})}function ratingToggle(event){event.preventDefault(),$(event.currentTarget).hasClass("active")&&($(".js-rating-toggle:not(.active)").toggleClass("active"),$(event.currentTarget).removeClass("active"),$(".js-rating-weekly").toggleClass("hide"),$(".js-rating-all-time").toggleClass("hide"))}function switchElementVisibility(id,show){var element=document.getElementById(id);void 0===show&&(show="none"==element.style.display),show?element.style.display="block":element.style.display="none"}function setSearchTooltipPosition(e){var target=e.currentTarget,rect=target.getBoundingClientRect(),tooltip=target.querySelector(".js-tooltip-content"),action="removeClass";tooltip&&(rect.top<tooltip.offsetHeight&&(action="addClass"),$(tooltip)[action]("bottom"))}function expandActivityFeedItems(){for(i=0;i<activity_feed_expand.length;i++)activity_feed_expand[i].querySelector(".js-activity-feed-trigger").addEventListener("click",function(e){var el_current=$(e.currentTarget),el_parent=$(el_current).closest(".js-activity-feed-expand"),el_stack=el_parent.find(".js-activity-feed-stack");el_current.hasClass("open")||0!=el_stack.children().length?expandGroup(el_current):($.ajax({url:"/main/feedgroups",type:"GET",dataType:"html",data:{timestamp:el_stack.attr("data-timestamp"),type:el_stack.attr("data-type")},success:function(data){el_stack.html(data),expandGroup(el_current)}}),trackMetricaEvent("AUTHOR_FEED_EXPAND_STACK"))})}function expandGroup(el_current){el_current.toggleClass("open"),el_current.parent().toggleClass("open")}jQuery.fn.putCursorAtEnd=function(){return this.each(function(){if($(this).focus(),this.setSelectionRange){var len=2*$(this).val().length;this.setSelectionRange(len,len)}else $(this).val($(this).val());this.scrollTop=999999})},jQuery.autocomplete=function(U,aa,R){function type(){if("title"!=Z.parents("form").find(":input[name=search_type]").val())return!0;if(46==N||N>8&&N<32)return Y.hide();var e=Z.val().toLowerCase();return e!=A&&(A=e,e.length?q(e):Y.hide()),!0}function moveCursor(f){var e=$("li",T).not(".in_artist_title");if(e){W+=f,W<0?W=0:W>=e.size()&&(W=e.size()-1),e.removeClass("ac_over"),$(e[W]).addClass("ac_over");var newSuggestionChunk=$(e[W]).text();Z.val(newSuggestionChunk)}}function pasteSuggestion(){var text=$("li.ac_over",T)[0];return!!text&&(_doPasteSuggestion(text),!0)}function _doPasteSuggestion(text){text&&(text=$(text).text()+" ",A=U.lastSelected=text,Y.html(""),Z.val(text),hideSuggestionsList(),Z.putCursorAtEnd())}function m(){var e={width:$(".searchinp").outerWidth()-2,top:$(".searchinp").offset().top+$(".searchinp").outerHeight(),left:$(".searchinp").offset().left};$(".searchsel").length&&(e.left-=1,e.width+=1,e.top-=1),$(".searchinp").length||(e.left=Z.offset().left,e.width=Z.outerWidth(),e.top=Z.offset().top+Z.outerHeight()),Y.css(e).show()}function z(){X&&clearTimeout(X),X=setTimeout(hideSuggestionsList,200)}function hideSuggestionsList(){X&&clearTimeout(X),Y.is(":visible")&&Y.hide()}function d(f,e){if(e){if(T.innerHTML="",!t||0==e.length)return hideSuggestionsList();$.browser.msie&&Y.append(document.createElement("iframe")),T.appendChild(c(f,e)),m()}else hideSuggestionsList();return!1}function c(p,l){var i,j=document.createElement("ul"),k=!0;aa&&"@"==l[0].substr(-1,1)&&(i=document.createElement("li"),i.innerHTML="In "+R+":",$(i).addClass("in_artist_title"),j.appendChild(i));for(var h=0;h<l.length;h++){if(i=document.createElement("li"),"@"==l[h].substr(-1,1)){var r=p.split(" ");i.selectValue=l[h].substr(0,l[h].length-1);for(var g=i.selectValue.split(" "),e=0;e<r.length;e++)for(var f=0;f<g.length;f++)0===g[f].toLowerCase().indexOf(r[e].toLowerCase())&&(g[f]="<span>"+g[f].slice(0,r[e].length)+"</span>"+g[f].slice(r[e].length));i.innerHTML=g.join(" ")}else aa&&k&&(k=!1,$(i).addClass("not_art")),i.selectValue=i.innerHTML=l[h];j.appendChild(i),$(i).hover(function(){$("li",j).removeClass("ac_over"),$(this).addClass("ac_over"),W=$("li",j).indexOf($(this).get(0))},function(){$(this).removeClass("ac_over")}).click(function(s){s.preventDefault(),s.stopPropagation(),_doPasteSuggestion(this),Z.parents("form").submit()})}return j}function q(f){var e=b(f);if(e)d(f,e);else{var max_results=10,filtered_data=[];if(aa&&Q.artist_suggestion){var regex=new RegExp("\\s("+f+"[^\\s]*)|^("+f+"[^\\s]*)","gi");$.each(Q.artist_suggestion,function(i,suggestion){if(suggestion.match(regex)&&(filtered_data.push(suggestion+"@"),filtered_data.length==max_results))return!1})}var max_gen_js=5;f.length<=max_gen_js?$.ajax({url:document.location.protocol+"//"+js_img_domain+"/article/suggestions/"+f.slice(0,1)+"/"+encodeURI(f.replace(/\s+/g,"_"))+".js",dataType:"json",type:"GET",data:{},success:function(json){json&&json.suggestions&&json.suggestions.length&&(json=json.suggestions,json=filterSugReq(json,f,!0),auto.receiveData("r",filtered_data.concat(json).slice(0,max_results)))},error:function(){auto.receiveData("r",filtered_data)}}):(V.allData.length>0&&(filtered_data=filtered_data.concat(filterSugReq(V.allData,f,!1)).slice(0,max_results)),auto.receiveData("r",filtered_data))}}function filterSugReq(data,filter,need_to_push){need_to_push&&(V.allData=[]);for(var j=0,filtered_data=[],i=0;i<data.length;i++)0==data[i].indexOf(filter)&&(j<=10&&filtered_data.push(data[i]),need_to_push&&V.allData.push(data[i]),j++);return filtered_data}function b(f){if(V.data[f])return V.data[f];for(var e=!1,h=f;h.length>1&&!V.data[h];)h=h.slice(0,-1),V.data[h]&&(e=V.data[h].length<10);if(e){e=V.data[h],h=[];for(var g=0;g<e.length;g++)"@"==e[g].charAt(e[g].length-1)?a(f,e[g])&&(h[h.length]=e[g]):0==e[g].toLowerCase().indexOf(f)&&(h[h.length]=e[g]);return h}return null}function a(f,e){f=f.split(" "),e=" "+e;for(var g=0;g<f.length;g++)if(e.indexOf(" "+f[g])<0)return!1;return!0}var Q=this,Z=$(U).attr("autocomplete","off"),T=document.createElement("div"),Y=$(T);Y.hide().addClass("ac_results").css("position","absolute"),$("body").append(T),U.autocompleter=Q;var X=null,A="",W=-1,V={},t=!0,N=null;V.data={},V.allData=[],Z.keydown(function(e){switch(N=e.keyCode,e.keyCode){case 38:e.preventDefault(),moveCursor(-1);break;case 40:e.preventDefault(),moveCursor(1);break;case 9:e.preventDefault(),pasteSuggestion();break;case 13:pasteSuggestion();break;default:W=-1,X&&clearTimeout(X),X=setTimeout(function(){type()},1)}}).focus(function(){t=!0,aa&&!Q.artist_suggestion&&$.ajax({url:document.location.protocol+"//"+js_img_domain+"/article/artist_suggestions/"+aa.toString().slice(0,1)+"/"+encodeURI(aa.toString())+".json",type:"GET",dataType:"json",data:{},success:function(json){Q.artist_suggestion=json}})}).blur(function(){t=!1,z()}),hideSuggestionsList();this.receiveData=function(f,e){d(f,e),V.data[f]=e}},jQuery.fn.autocomplete=function(a,b){return this.each(function(){window.auto=new jQuery.autocomplete(this,a,b)}),this},jQuery.fn.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1},$(document).ready(function(){function url_query(query){query=query.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var expr="[\\?&]"+query+"=([^&#]*)",regex=new RegExp(expr),results=regex.exec(window.location.href);return null!==results&&results[1]}var show_menu=1;$(document).bind("click",function(e){show_menu&&$(".selwin").hide(),show_menu=1}),$(".searchsel").click(function(){$(".selwin").toggle(),show_menu=0}),$(".selwin a").bind("click",function(event){$(".selcurr").html('<b class="f-right"></b>'+$(this).text()),$("#w").val($(this).attr("value")),"news"==$(this).attr("value")?$("#search-order").val("date"):$("#search-order").val("");var form=document.querySelector(".js-search-form");"forum"==$(this).attr("value")?(form.action=form.dataset.searchforum,form.querySelector(".search_input").name="SearchForm[search_keyword]"):(form.action=form.dataset.searchsite,form.querySelector(".search_input").name="value"),event.preventDefault()}),$(".search_input").autocomplete(void 0!==artist_id&&artist_id,void 0!==name_art&&name_art),0==$("#a_layer").length&&$("body").append(auth_html);var is_soc_login=url_query("login_via_soc_networks");is_soc_login&&$("#a_layer form").removeClass("a_classic"),function(a){a.placeHeld=function(c,b){var d=this;d.$el=a(c),d.el=c,d.$el.data("placeHeld",d),d.placeholderText=d.$el.attr("placeholder"),d.init=function(){d.options=a.extend({},a.placeHeld.defaultOptions,b),d.$el.bind("blur",d.holdPlace).bind("focus",d.releasePlace).trigger("blur"),d.$el.parents("form").bind("submit",d.clearPlace)},d.holdPlace=function(){var e=d.$el.val();e||d.$el.val(d.placeholderText).addClass(d.options.className)},d.releasePlace=function(){var e=d.$el.val();e==d.placeholderText&&d.$el.val("").removeClass(d.options.className)},d.clearPlace=function(){var e=d.$el.val();e==d.placeholderText&&d.$el.hasClass(d.options.className)&&d.$el.val("")},d.init()},a.placeHeld.defaultOptions={className:"placeheld"},a.fn.placeHeld=function(b){if(!("placeholder"in a("<input>")[0]))return this.each(function(){new a.placeHeld(this,b)})}}(jQuery),$("input[placeholder]").placeHeld({className:"a_ph"}),$("input").live("touchend",function(){$(this).mouseout()}),navigator.userAgent.toLowerCase().indexOf("android")>-1&&$("#a_layer").addClass("a_android"),tabs_history=getTabsHistory();for(var i=0;i<tabs_history.length;i++)renderTabHistoryItem(tabs_history[i]);var tabHistoryTimeout=null;if($(".js-tabs-history").hover(function(){tabHistoryTimeout=setTimeout(function(){$(".js-tabs-history-tooltip").addClass("show")},150)},function(){clearTimeout(tabHistoryTimeout),$(".js-tabs-history-tooltip").removeClass("show")}),$(".js-contrib-msg").live("click",function(){var $parent=$(this).parent().parent();return $parent.animate({opacity:.05},400,function(){$.get("/contribution/award/read",{id:$parent.attr("data-id")}),$parent.remove(),0==$(".js-contrib-msg").length&&$(".js-message-wrapper").remove()}),!1}),$(".js-popup-review").length>0&&(navigator.userAgent.indexOf("Win")!=-1||navigator.userAgent.indexOf("Mac")&&navigator.userAgent.indexOf("iPad")==-1&&navigator.userAgent.indexOf("iPhone")==-1)&&(js_popup_review_top=$(".ar-reviews").first(".update_item").offset().top,$(window).scroll(function(){js_popup_review_top<$(window).scrollTop()?$(".js-popup-review").addClass("open"):$(".js-popup-review").removeClass("open")})),$(".js-ug-alert-cookie").click(function(){$(".js-ug-alert-cookie").addClass("hide")}),$(".js-track-metrica-click").click(function(){var event_name=$(this).attr("data-metrica-click");trackMetricaEvent(event_name)}),""==document.referrer&&"/"==location.pathname&&$.cookie("ug_hats_group",1,{expires:365,path:"/",domain:main_server_name}),$.cookie("__ugVisit","",{expires:-1,path:"/",domain:main_server_name}),user_id>0&&$.cookie("__ugVisit2",Math.floor((new Date).getTime()/1e3),{expires:30,path:"/",domain:main_server_name}),$(".js-remove-artist-follower").click(function(){return $(this).parents(".js-artist-follower").hide(),$.get($(this).attr("href")),!1}),$('.js-tp-link[data-source="search"]').length>0||$('.js-tp-link[data-source="artist"]').length>0){var tooltipTimers={};$('.js-tp-link[data-source="search"], .js-tp-link[data-source="artist"]').on("mouseenter",function(e){var id=$(e.currentTarget).data("id");tooltipTimers[id]?clearTimeout(tooltipTimers[id]):$(e.currentTarget).find(".js-tp-tooltip").removeClass("hide")}),$('.js-tp-link[data-source="search"], .js-tp-link[data-source="artist"]').on("mouseleave",function(e){var id=$(e.currentTarget).data("id");tooltipTimers[id]=setTimeout(function(){$(e.currentTarget).find(".js-tp-tooltip").addClass("hide"),tooltipTimers[id]=null},0)})}}),jQuery.cookie=function(key,value,options){if(arguments.length>1&&(null===value||"object"!=typeof value)){if(options=jQuery.extend({},options),null===value&&(options.expires=-1),"number"==typeof options.expires){var days=options.expires,t=options.expires=new Date;t.setDate(t.getDate()+days)}return document.cookie=[encodeURIComponent(key),"=",options.raw?String(value):encodeURIComponent(String(value)),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("")}options=value||{};var result,decode=options.raw?function(s){return s}:decodeURIComponent;return(result=new RegExp("(?:^|; )"+encodeURIComponent(key)+"=([^;]*)").exec(document.cookie))?decode(result[1]):null};var user_id=null==$.cookie("bbuserid")?0:$.cookie("bbuserid"),user_name=$.cookie("bbusername");!function(a,z){function B(){}function r(C){A=[C]}function i(C){b.insertBefore(C,b.firstChild)}function h(D,E,C){return D&&D.apply(E.context||E,C)}function g(C){return/\?/.test(C)?"&":"?"}function o(Q){function L(S){!I++&&z(function(){F(),H&&(s[R]={s:[S]}),C&&(S=C.apply(Q,[S])),h(Q.success,Q,[S,t]),h(O,Q,[Q,t])},0)}function D(S){!I++&&z(function(){F(),H&&S!=w&&(s[R]=S),h(Q.error,Q,[Q,S]),h(O,Q,[Q,S])},0)}Q=a.extend({},d,Q);var M,O=Q.complete,C=Q.dataFilter,K=Q.callbackParameter,P=Q.callback,E=Q.cache,H=Q.pageCache,G=Q.charset,R=Q.url,J=Q.data,N=Q.timeout,I=0,F=B;return Q.abort=function(){!I++&&F()},h(Q.beforeSend,Q,[Q])===!1||I?Q:(R=R||n,J=J?"string"==typeof J?J:a.param(J,Q.traditional):n,R+=J?g(R)+J:n,K&&(R+=g(R)+encodeURIComponent(K)+"=?"),!E&&!H&&(R+=g(R)+"_"+(new Date).getTime()+"="),R=R.replace(/=\?(&|$)/,"="+P+"$1"),H&&(M=s[R])?M.s?L(M.s[0]):D(M):z(function(T,S,U){function V(W){(T[k]||B)(),W=A,A=void 0,W?L(W[0]):D(m)}I||(U=N>0&&z(function(){D(w)},N),F=function(){U&&clearTimeout(U),T[e]=T[k]=T[y]=T[l]=null,b[x](T),S&&b[x](S)},window[P]=r,T=a(c)[0],T.id=p+f++,G&&(T[q]=G),v.msie?(T.event=k,T.htmlFor=T.id,T[e]=function(){/loaded|complete/.test(T.readyState)&&V()}):(T[l]=T[y]=V,v.opera?(S=a(c)[0]).text="jQuery('#"+T.id+"')[0]."+l+"()":T[j]=j),T.src=R,i(T),S&&i(S))},0),Q)}var A,j="async",q="charset",n="",m="error",p="_jqjsp",u="on",k=u+"click",l=u+m,y=u+"load",e=u+"readystatechange",x="removeChild",c="<script/>",t="success",w="timeout",v=a.browser,b=a("head")[0]||document.documentElement,s={},f=0,d={callback:p,url:location.href};o.setup=function(C){a.extend(d,C)},a.jsonp=o}(jQuery,setTimeout);var auth_msg={verify_user_not_exist:"Incorrect username",verify_sign_in:"Incorrect password",verify_user_exist:" has already been taken",verify_email:"Invalid email address",verify_username:"Username is too short",verify_not_allowed_symbols:"Username contains invalid characters. Please use letters (A-Z) or digits (0-9) only.",verify_empty:" not entered",verify_capcha:"Re-enter text from image",verify_reset_pass:"Please check your email for further instructions",something_happens:"Network error",activ_mail_sended:"Activation email has been sent once more",reset_pass:"Your password has been reset.<br>Check your email for futher instructions"},msg_class_prefix="m",auth_imagehash="",auth_callback_function="",register_callback="",auth_callback_params=new Array,auth_callback_need_activ=!0,ug_load_recaptcha=!1;$(function(){$("#a_layer .sign_in span").live("click",function(){show_forgot_password()}),$("#a_layer .sign_up .create").live("click",function(){show_auth_layer_on_registration(),ga("send","event","LoginRegister PopUp","LoginRegister SignIn","LoginRegister CreateAccount")}),$("#a_layer .shw_pswd").live("click",function(){"display password"==$(this).text()?($(this).text("hide password"),$("#a_layer .a_block.register input[name=pass]").get(0).type="text",ga("send","event","LoginRegister PopUp","LoginRegister SignUp","SignUp DisplayPassword On")):($(this).text("display password"),$("#a_layer .a_block.register input[name=pass]").get(0).type="password",ga("send","event","LoginRegister PopUp","LoginRegister SignUp","SignUp DisplayPassword Off"))}),$("#a_layer .a_block.register .back").live("click",function(){switch_auth_blocks(new Array("sign_in","sign_up"))}),$("#a_layer .a_close").live("click",function(){close_auth_layer(),$("#a_layer .sign_in").is(":visible")?ga("send","event","LoginRegister PopUp","LoginRegister SignIn","LoginRegister Close"):$("#a_layer .register").is(":visible")?ga("send","event","LoginRegister PopUp","LoginRegister SignUp","SignUp Close"):$("#a_layer .activ").is(":visible")?ga("send","event","LoginRegister PopUp","LoginRegister Activation","Activation Close"):$("#a_layer .a_blocked").is(":visible")&&ga("send","event","LoginRegister PopUp","LoginRegister Banned","Banned Close")}),$("a.auth_sign_up").live("click",function(){if(!user_id)return show_auth_layer_on_registration(),!1}),$("a.auth_sign_in").live("click",function(){if(!user_id)return prepare_auth_layer(),callback_name="",$(this).hasClass("auth_continue")&&(callback_name="redirect_after_login",auth_callback_params.push($(this).attr("href"))),show_auth_layer(callback_name),!1}),$("#a_layer .a_block.activ .create").live("click",function(){send_activation_email_to_user($("#a_layer .a_block.activ input[name=email]").val(),auth_msg.activ_mail_sended)}),$("#a_layer .a_block.forgot .create").live("click",function(){send_reset_password_email_to_user($("#a_layer .a_block.forgot input[name=email]").val(),auth_msg.reset_pass)}),$("#a_layer .sign_in input").live("focus",function(){$("#a_layer .a_block.forgot").is(":visible")&&switch_auth_blocks(new Array("sign_in","sign_up"))}),$("#a_layer .a_block.forgot input").live("focus",function(){$("#a_layer .a_block.sign").is(":visible")&&show_forgot_password()}),$("#check").live("change",function(){$(this).is(":checked")?ga("send","event","LoginRegister PopUp","LoginRegister SignUp","SignUp Subscribe On"):ga("send","event","LoginRegister PopUp","LoginRegister SignUp","SignUp Subscribe Off")}),$("#a_layer .a_block.create_username .create").live("click",function(){if(ga("send","event","LoginRegister PopUp","LoginRegister ChangeUsername","SignIn Click"),auth_input_validate($("#a_layer .a_block.create_username input[name=username]")),"none"==$("#a_layer .a_msg").css("display")||$("#a_layer .a_msg").hasClass("success")){var custom_username=$("#a_layer .a_block.create_username input[name=username]").val(),url=document.location.protocol+"//"+main_server_name+"/"+$("#a_layer .a_block.create_username").attr("data")+"?service&again=1&custom_username="+custom_username;social_auth_for_change_username=window.open(url,"ug_auth_popup","width=350px,height=350px,left=500px,top=500px,resizable=yes,scrollbars=no,toolbar=no,menubar=no,location=no,directories=no,status=yes"),social_auth_for_change_username.focus()}}),$("#js-user-logout").live("click",function(){return $.ajax({url:document.location.protocol+"//www."+main_server_name+"/user/auth/logout",type:"GET",xhrFields:{withCredentials:!0},success:function(){location.reload(!1)}}),!1})}),$(function(){$("#a_layer input[name=username]").live("focusout",function(){$(this).val($(this).val().trim()),auth_input_validate($(this),!1)}),$("#a_layer input[name=email]").live("focusout",function(){auth_input_validate($(this),!1)}),$("#a_layer input[name=pass]").live("focusout",function(){auth_input_validate($(this),!1)}),$("#a_layer form").live("submit",function(){if("none"!=$("#a_layer .a_block.sign_in").css("display")&&switch_auth_blocks(new Array("sign_in","sign_up"),!0),$("#a_layer .a_block:visible input").each(function(){auth_input_validate($(this))}),"none"==$("#a_layer .a_msg").css("display")||$("#a_layer .a_msg").hasClass("success")){if(remove_all_auth_messages(),"none"!=$("#a_layer .a_block.sign_in").css("display"))var form_url=document.location.protocol+"//www."+main_server_name+"/user/auth/processSignIn",username=$("#a_layer .a_block.sign_in input[name=username]").val(),data={username:username,password:$("#a_layer .a_block.sign_in input[name=pass]").val()};else if("none"!=$("#a_layer .a_block.register").css("display"))var form_url=document.location.protocol+"//www."+main_server_name+"/user/auth/processSignUp",pass=$("#a_layer .a_block.register input[name=pass]").val(),data={username:$("#a_layer .a_block.register input[name=username]").val(),password:pass,"g-recaptcha-response":grecaptcha.getResponse(),email:$("#a_layer .a_block.register input[name=email]").val(),subscribe_to_newsletter:$("#a_layer .a_block.register input[name=check]").is(":checked")?"true":"false"};$.ajax({url:form_url,type:"POST",
data:data,dataType:"json",timeout:4e4,xhrFields:{withCredentials:!0},success:function(json){if("none"!=$("#a_layer .a_block.sign_in").css("display"))if("error"==json.result)ga("send","event","LoginRegister PopUp","LoginRegister SignIn","LoginRegister SignIn False"),show_auth_layer(auth_callback_function),"password"==json.info?show_auth_message("error","l",auth_msg.verify_sign_in,"pass"):show_auth_message("error","l",auth_msg.verify_user_not_exist,"username");else switch(auth_on_sign_in(json.info),json.info.user_status){case"not_activated":show_auth_layer_for_non_activ_users(),ga("send","event","LoginRegister PopUp","LoginRegister Activation","Activation Show");break;case"blocked":show_auth_layer_for_blocked_users(),ga("send","event","LoginRegister PopUp","LoginRegister Banned","Banned Show");break;default:ga("send","event","LoginRegister PopUp","LoginRegister SignIn","LoginRegister SignIn")}else if("none"!=$("#a_layer .a_block.register").css("display"))if("error"==json.result)switch(ga("send","event","LoginRegister PopUp","LoginRegister SignUp","SignUp Join False"),json.info){case"username_exist":case"username_short":case"username_long":case"username_invalid_symbols":case"username_sensored":show_auth_message("error","l","Username"+auth_msg.verify_user_exist,"username");break;case"email_invalid":case"email_banned":case"email_exist":show_auth_message("error","l",auth_msg.verify_email,"email");break;case"capcha_failed":grecaptcha.reset(),show_auth_message("error","r",auth_msg.verify_capcha,"capcha");break;case"internal_error":close_auth_layer()}else $("#a_layer .a_block.activ input[name=email]").val(json.info.email).removeClass(".a_ph"),ga("send","event","LoginRegister PopUp","LoginRegister SignUp","SignUp Join"),auth_callback_need_activ?(switch_auth_blocks(new Array("register_success","activ")),auth_fill_user_info(json.info),"function"==typeof window.register_callback&&window.register_callback()):auth_on_sign_in()},error:function(){show_auth_message("error","l",auth_msg.something_happens,"username")}})}else $("#a_layer").show();return!1})});var auth_html='\n<div id="a_layer" style="display: none;">\n<div class="shtorki"></div>\n    <form action="'+document.location.protocol+"//www."+main_server_name+'/user/auth/processSignUp" method="post" class="a_window">\n        <div class="a_close">&times;</div>\n        <div class="a_block sign_in">\n            <div class="a_line"></div>\n            <h2>Sign in</h2>\n            <input type="text" name="username" maxlength="120" placeholder="Username or e-mail" >\n            <input type="password" name="pass" maxlength="25" placeholder="Password">\n            <div class="span_holder"><span>Forgot username or password?</span></div>\n            <input type="submit" value="Sign in" class="sign">\n            <div class="soc_login">\n                <a href="'+document.location.protocol+"//www."+main_server_name+'/user/auth/oauth?service=facebook" class="fb auth_s"><i><b></b></i>Sign in with Facebook</a>\n                <a href="'+document.location.protocol+"//www."+main_server_name+'/user/auth/oauth?service=google" class="gplus auth_g auth_s"><i><b></b></i>Sign in with Google</a>\n                <p class="cb">Don\'t worry, we won\'t post anything without asking.</p>\n                <div></div>\n                <span>or</span>\n            </div>\n        </div>\n        <div class="a_block sign_up">\n            <h2>Join Ultimate Guitar</h2>\n            <p>You\'re just two steps away from<br>getting access to all the awesome<br>features of Ultimate-Guitar.com</p>\n            <input type="button" value="Join Ultimate Guitar" class="create">\n        </div>\n        <div class="a_block forgot" style="display: none;">\n            <h2>Forgot password?</h2>\n            <p>Enter the email address you used<br> when joining and we\'ll send you<br> the instructions to reset your password.</p>\n            <input type="text" name="email" maxlength="50"  placeholder="Email">\n            <input type="button" value="Send reset instruction" class="create">\n        </div>\n        <div class="a_block register"  style="display: none;">\n            <div class="back">&larr;&nbsp;<span>back</span></div>\n            <div class="a_line"></div>\n            <h2>Sign up</h2>\n            <input type="text" name="username" maxlength="15" placeholder="Username">\n            <input type="text" name="email"  maxlength="50"  placeholder="Email">\n            <input type="checkbox" name="check" id="check"><label for="check" class="a_check">Subscribe to UG Weekly Newsletter</label>\n            <input type="password" name="pass" maxlength="25"  placeholder="Password">\n            <span class="shw_pswd">display password</span>\n        </div>\n        <div class="a_block register"  style="display: none;">\n            <input name="capcha" type="hidden">\n            <div class="g-recaptcha recaptcha2" data-size="compact" data-callback="onUgRegisterRepachaSuccess" data-sitekey="6LfCo_8SAAAAALEMHnlK18j8IemlAdvmxwRnQe2v" style="margin-top: 30px;"></div>\n            <input type="submit" value="Join Ultimate Guitar" class="create">\n            <p>By clicking Join you agree<br>to the <a href="'+document.location.protocol+'//www.ultimate-guitar.com/about/tos.htm" target="_blank">Terms Of Service</a></p>\n        </div>\n        <div class="a_block register_success"  style="display: none;">\n            <span></span>\n            <div><h2>Thank You!</h2><br>Registration<br> almost completed</div>\n            <p>A confirmation email has been sent.<br>Please check your inbox now and <br>follow the instructions provided in <br>the email.</p>\n        </div>\n        <div class="a_block activ_none" style="display: none;">\n            <span></span>\n            <div><h2>Clank!</h2><br>Your account has<br> not been activated.</div>\n        </div>\n        <div class="a_block activ"  style="display: none;">\n            <div class="a_line"></div>\n            <h2>Account activation</h2>\n            <p>If you haven\'t received activation <br>email, please use form below.</p>\n            <b style="display: none">Enter your email below,<br> to receive account activation instruction.</b>\n            <input type="text" name="email" maxlength="50" placeholder="Email">\n            <input type="button" value="Resend activation email" class="create">\n        </div>\n        <div class="a_block username_exist" style="display: none;">\n            <span></span>\n            <div><h2>Oops!</h2><br><font></font> username<br>is already in use.</div>\n        </div>\n        <div class="a_block create_username" style="display: none;" data="">\n            <div class="a_line"></div>\n            <div class="ov-h cont_ico_t"><div class="log_ico f-left" style="display: none;"><span></span></div><p>Please enter a different username to complete sign in proccess.</p></div>\n            <div>\n                <input type="text" name="username" maxlength="50" placeholder="New username">\n                <input type="button" value="Sign in" class="create">\n            </div>\n        </div>\n        <div class="a_blocked" style="display: none;">\n            <span class="angry"></span>\n            <div><h2>Clank!</h2><br>Your account<br>is blocked!</div>\n        </div>\n        <div class="a_msg" style="display: none;">\n            <ul class="l">\n            </ul>\n            <ul class="r">\n            </ul>\n        </div>\n    </form>\n</div>';document.domain=main_server_name;var social_auth_popup_width=450,social_auth_popup_height=550,social_auth_popup;$(function(){$("a.auth_s").live("click",function(){var soc_network_name="Facebook";$(this).attr("class").indexOf("auth_g")!=-1&&(soc_network_name="Google");var login_from="PopUp ";$(this).parent().attr("class").indexOf("s_up")!=-1&&(login_from="Header "),ga("send","event","LoginRegister PopUp","LoginRegister SocialNetworks",login_from+soc_network_name+" Button Click"),void 0!==social_auth_popup&&social_auth_popup.close();var redirect_uri,url=redirect_uri=this.href;url+=url.indexOf("?")>=0?"&":"?",url.indexOf("redirect_uri=")===-1&&(url+="redirect_uri="+encodeURIComponent(redirect_uri)+"&"),url+="js";var centerWidth=(window.screen.width-social_auth_popup_width)/2,centerHeight=(window.screen.height-social_auth_popup_height)/2;return social_auth_popup=window.open(url,"ug_auth_popup","width="+social_auth_popup_width+",height="+social_auth_popup_height+",left="+centerWidth+",top="+centerHeight+",resizable=yes,scrollbars=no,toolbar=no,menubar=no,location=no,directories=no,status=yes"),social_auth_popup.focus(),!1})}),$(function(){$(".js-btn-submit-news").bind("click",function(){return user_id?(ga("send","event","Links","Submit News Story","Click (Authorized)",1,{nonInteraction:1}),!0):(ga("send","event","Links","Submit News Story","Click (Not Authorized)",1,{nonInteraction:1}),prepare_auth_layer(),callback_name="redirect_after_login",auth_callback_params.push($(this).attr("href")),show_auth_layer(callback_name),!1)})}),function(){function CustomEvent(event,params){params=params||{bubbles:!1,cancelable:!1,detail:void 0};var evt=document.createEvent("CustomEvent");return evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail),evt}return"function"!=typeof window.CustomEvent&&(CustomEvent.prototype=window.Event.prototype,void(window.CustomEvent=CustomEvent))}(),function(window){var FuckAdBlock=function(options){this._options={checkOnLoad:!1,resetOnEnd:!1,loopCheckTime:50,loopMaxNumber:5,baitClass:"pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links",baitStyle:"width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;",debug:!1},this._var={version:"3.2.0",bait:null,checking:!1,loop:null,loopNumber:0,event:{detected:[],notDetected:[]}},void 0!==options&&this.setOption(options);var self=this,eventCallback=function(){setTimeout(function(){self._options.checkOnLoad===!0&&(self._options.debug===!0&&self._log("onload->eventCallback","A check loading is launched"),null===self._var.bait&&self._creatBait(),setTimeout(function(){self.check()},1))},1)};void 0!==window.addEventListener?window.addEventListener("load",eventCallback,!1):window.attachEvent("onload",eventCallback)};FuckAdBlock.prototype._options=null,FuckAdBlock.prototype._var=null,FuckAdBlock.prototype._bait=null,FuckAdBlock.prototype._log=function(method,message){},FuckAdBlock.prototype.setOption=function(options,value){if(void 0!==value){var key=options;options={},options[key]=value}for(var option in options)this._options[option]=options[option],this._options.debug===!0&&this._log("setOption",'The option "'+option+'" he was assigned to "'+options[option]+'"');return this},FuckAdBlock.prototype._creatBait=function(){var bait=document.createElement("div");bait.setAttribute("class",this._options.baitClass),bait.setAttribute("style",this._options.baitStyle),this._var.bait=window.document.body.appendChild(bait),this._var.bait.offsetParent,this._var.bait.offsetHeight,this._var.bait.offsetLeft,this._var.bait.offsetTop,this._var.bait.offsetWidth,this._var.bait.clientHeight,this._var.bait.clientWidth,this._options.debug===!0&&this._log("_creatBait","Bait has been created")},FuckAdBlock.prototype._destroyBait=function(){window.document.body.removeChild(this._var.bait),this._var.bait=null,this._options.debug===!0&&this._log("_destroyBait","Bait has been removed")},FuckAdBlock.prototype.check=function(loop){if(void 0===loop&&(loop=!0),this._options.debug===!0&&this._log("check","An audit was requested "+(loop===!0?"with a":"without")+" loop"),this._var.checking===!0)return this._options.debug===!0&&this._log("check","A check was canceled because there is already an ongoing"),!1;this._var.checking=!0,null===this._var.bait&&this._creatBait();var self=this;return this._var.loopNumber=0,loop===!0&&(this._var.loop=setInterval(function(){self._checkBait(loop)},this._options.loopCheckTime)),setTimeout(function(){self._checkBait(loop)},1),this._options.debug===!0&&this._log("check","A check is in progress ..."),!0},FuckAdBlock.prototype._checkBait=function(loop){var detected=!1;if(null===this._var.bait&&this._creatBait(),null===window.document.body.getAttribute("abp")&&null!==this._var.bait.offsetParent&&0!=this._var.bait.offsetHeight&&0!=this._var.bait.offsetLeft&&0!=this._var.bait.offsetTop&&0!=this._var.bait.offsetWidth&&0!=this._var.bait.clientHeight&&0!=this._var.bait.clientWidth||(detected=!0),void 0!==window.getComputedStyle){var baitTemp=window.getComputedStyle(this._var.bait,null);"none"!=baitTemp.getPropertyValue("display")&&"hidden"!=baitTemp.getPropertyValue("visibility")||(detected=!0)}this._options.debug===!0&&this._log("_checkBait","A check ("+(this._var.loopNumber+1)+"/"+this._options.loopMaxNumber+" ~"+(1+this._var.loopNumber*this._options.loopCheckTime)+"ms) was conducted and detection is "+(detected===!0?"positive":"negative")),loop===!0&&(this._var.loopNumber++,this._var.loopNumber>=this._options.loopMaxNumber&&this._stopLoop()),detected===!0?(this._stopLoop(),this._destroyBait(),this.emitEvent(!0),loop===!0&&(this._var.checking=!1)):null!==this._var.loop&&loop!==!1||(this._destroyBait(),this.emitEvent(!1),loop===!0&&(this._var.checking=!1))},FuckAdBlock.prototype._stopLoop=function(detected){clearInterval(this._var.loop),this._var.loop=null,this._var.loopNumber=0,this._options.debug===!0&&this._log("_stopLoop","A loop has been stopped")},FuckAdBlock.prototype.emitEvent=function(detected){this._options.debug===!0&&this._log("emitEvent","An event with a "+(detected===!0?"positive":"negative")+" detection was called");var fns=this._var.event[detected===!0?"detected":"notDetected"];for(var i in fns)this._options.debug===!0&&this._log("emitEvent","Call function "+(parseInt(i)+1)+"/"+fns.length),fns.hasOwnProperty(i)&&fns[i]();return this._options.resetOnEnd===!0&&this.clearEvent(),this},FuckAdBlock.prototype.clearEvent=function(){this._var.event.detected=[],this._var.event.notDetected=[],this._options.debug===!0&&this._log("clearEvent","The event list has been cleared")},FuckAdBlock.prototype.on=function(detected,fn){return this._var.event[detected===!0?"detected":"notDetected"].push(fn),this._options.debug===!0&&this._log("on",'A type of event "'+(detected===!0?"detected":"notDetected")+'" was added'),this},FuckAdBlock.prototype.onDetected=function(fn){return this.on(!0,fn)},FuckAdBlock.prototype.onNotDetected=function(fn){return this.on(!1,fn)},window.FuckAdBlock=FuckAdBlock,void 0===window.fuckAdBlock&&(window.fuckAdBlock=new FuckAdBlock({checkOnLoad:!0,resetOnEnd:!0})),window.fuckAdBlock.on(!0,function(){window.dispatchEvent(new CustomEvent("adblock_detected"))}),window.fuckAdBlock.on(!1,function(){window.dispatchEvent(new CustomEvent("adblock_not_detected"))})}(window),window.addEventListener("adblock_detected",function(e){ga("set",{dimension6:"on"})}),window.addEventListener("adblock_not_detected",function(e){ga("set",{dimension6:"off"})});var searchTooltipContainer=document.querySelectorAll(".js-tooltip");if(searchTooltipContainer.length)for(var i=0;i<searchTooltipContainer.length;i++)searchTooltipContainer[i].addEventListener("mouseover",setSearchTooltipPosition);$(document).bind("yacounter18746557inited",function(){var links=$(".for-approval .result-link");links.each(function(){trackMetricaEvent("NOT_APPROVED_TAB_LINK_SHOW")}),links.bind("click",function(e){if(trackMetricaEvent("NOT_APPROVED_TAB_LINK_CLICK"),1===e.which){e.preventDefault();var link=$(this);setTimeout(function(){document.location=link.attr("href")},300)}})}),$(window).bind("adblock_detected",function(){var $criteo=$(".criteo_block"),$native=$("#native_wrapper");if($(".js-ab-regular").addClass("hide"),$(".js-ab-partners").length&&$(".js-ab-partners").removeClass("hide"),$(".js-guitartricks").length&&$(".js-guitartricks").removeClass("hide"),$criteo.length){var script=document.createElement("script");script.onload=function(){$criteo.removeClass("hide"),document.getElementById("cto_160x600")&&Criteo.DisplayAcceptableAdIfAdblocked({zoneid:441358,containerid:"cto_160x600"}),document.getElementById("cto_300x600")&&Criteo.DisplayAcceptableAdIfAdblocked({zoneid:470979,containerid:"cto_300x600",overrideZoneFloor:!1}),document.getElementById("cto_728x90")&&Criteo.DisplayAcceptableAdIfAdblocked({zoneid:470978,containerid:"cto_728x90",overrideZoneFloor:!1}),setTimeout(function(){$native.length&&($("#cto_160x600").length&&$("#cto_160x600").html().length&&!/disable_criteo/.test(window.location.search)||($("#cto_160x600").addClass("hide"),$native.removeClass("hide"),$native.length&&$native.is(":visible")&&1==Math.round(100*Math.random())&&ga("send","event","native","Whole Block","impress")))},1e3)},script.src="//static.criteo.net/js/ld/publishertag.js",document.getElementsByTagName("head")[0].appendChild(script)}}),window.addEventListener("load",function(){var list_links=document.querySelectorAll(".js-h-t-list a"),forum_link=document.querySelector(".js-h-t-forum");if(list_links)for(var i=0;i<list_links.length;i++)list_links[i].addEventListener("click",function(){trackMetricaEvent("H_T_LIST")});forum_link&&forum_link.addEventListener("click",function(){trackMetricaEvent("H_T_FORUM")})}),$(function(){function closeAd(){$(".js-interstitial_overlay, .js-interstitial").addClass("hide")}function trackInterView(id,ug_from,container){try{var img=document.createElement("img");img.setAttribute("src","/components/tracker/inter-show?id="+encodeURIComponent(id)+"&ug_from="+encodeURIComponent(ug_from)+"&cb="+(Math.floor(1e7*Math.random())+1)),img.width="1",img.height="1",container.appendChild(img)}catch(e){}}function setInterCookie(){var d=new Date;d.setTime(d.getTime()+864e5),document.cookie="mojo_takeover=1;expires="+d.toUTCString()+";path=/"}function dec(){var $time_left=$(".js-interstitial_left"),left=$time_left.text();--left?($time_left.text(left),setTimeout(dec,1e3)):closeAd()}if($(".js-interstitial_overlay").length&&!/mojo_takeover/.test(document.cookie)){$(".js-interstitial_close").on("click",closeAd),$(".js-interstitial_overlay, .js-interstitial").removeClass("hide"),setInterCookie();var $inter=$(".js-interstitial");trackInterView($inter.attr("data-id"),$inter.attr("data-from"),$inter[0]),setTimeout(dec,1e3)}}),$(".js-sponsor-top-iq").click(function(){trackMetricaEvent("SPONSOR_IQ_CLICK")}),$(".js-sponsor-top-iq-main-page").click(function(){trackMetricaEvent("SPONSOR_IQ_CLICK_MAIN_PAGE")}),$(".js-contest-takeover").length&&($.get("/user/contest/link?to=tab_show"),trackMetricaEvent("TAKEOVER_TAB_SHOW"),$(".js-takeover-track-event").click(function(e){target=$(this).data("takeover"),trackMetricaEvent("TAKEOVER_"+target.toUpperCase()),$.get("/user/contest/link?to="+target)})),$(".js-sponsor-top-iq").click(function(){trackMetricaEvent("SPONSOR_IQ_CLICK")});var activity_feed_expand=document.querySelectorAll(".js-activity-feed-expand");activity_feed_expand&&expandActivityFeedItems();var metrica_objects=[{selector:".js-author-feed .js-tpa_comment a",action:"click",metrica_name:"AUTHOR_FEED_COMMENT_TPA_CLICK"},{selector:".js-more-stories a",action:"click",metrica_name:"MORE_STORY"},{selector:".js-author-feed a",action:"click",metrica_name:"AUTHOR_FEED_LINK_CLICK"},{selector:".js-special-series",action:"click",metrica_name:"SPECIAL_SERIES"},{selector:".js-hot-discussions-toggle",action:"click",metrica_name:"HOT_DISCUSSIONS_TOGGLE"},{selector:".js-hot-discussions a",action:"click",metrica_name:"HOT_DISCUSSIONS_LINK_CLICK"},{selector:".js-history-toggle",action:"click",metrica_name:"HISTORY_TOGGLE"},{selector:".js-suggest-correction-comment",action:"click",metrica_name:"SUGGEST_CORRECTION_FROM_COMMENT"},{selector:".js-forum-on-artist-user",action:"click",metrica_name:"FORUM_ON_ARTIST_USER"},{selector:".js-forum-on-artist-link",action:"click",metrica_name:"FORUM_ON_ARTIST_LINK"},{selector:".js-forum-on-review-user",action:"click",metrica_name:"FORUM_ON_REVIEW_USER"},{selector:".js-forum-on-review-link",action:"click",metrica_name:"FORUM_ON_REVIEW_LINK"},{selector:".js-wrong-search-link",action:"click",metrica_name:"WRONG_SEARCH_LINK_CLICK"},{selector:".js-submit-tab-btn",action:"click",metrica_name:"SUBMIT_TAB_BTN_CLICK"}];metrica_objects.map(function(item){Array.prototype.slice.call(document.querySelectorAll(item.selector),0).map(function(el){el.addEventListener(item.action,function(){trackMetricaEvent(item.metrica_name)})})}),window.addEventListener("load",function(){document.querySelector(".js-forum-on-review")&&trackMetricaEvent("FORUM_ON_REVIEW_SHOW"),document.querySelector(".js-forum-on-artist")&&trackMetricaEvent("FORUM_ON_ARTIST_SHOW"),document.querySelector(".js-author-feed")&&trackMetricaEvent("AUTHOR_FEED_SHOW"),document.querySelector(".js-wrong-search-link")&&trackMetricaEvent("WRONG_SEARCH_LINK_SHOW")}),"undefined"==typeof window.trackCorrected&&(window.trackCorrected=function(event_name){return!0});