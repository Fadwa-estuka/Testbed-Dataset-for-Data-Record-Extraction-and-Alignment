var h,aa=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b},ba=function(a,b){function c(){}c.prototype=b.prototype;a.Vb=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Sb=function(a,c,g){for(var d=Array(arguments.length-2),e=2;e<arguments.length;e++)d[e-2]=arguments[e];return b.prototype[c].apply(a,d)}};var k={},n={},p,ca=!1,q=function(a){try{ca&&window.console&&window.console.log&&window.console.log(a)}catch(b){}},r=function(a,b){if(!a)return-1;if(a.indexOf)return a.indexOf(b,void 0);for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},t=function(a,b){function c(){}if(!a)throw"Child class cannot be empty.";if(!b)throw"Parent class cannot be empty.";c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a},da=function(a){var b=[],c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];
if(null===d||void 0===d)d="";b.push(encodeURIComponent(c)+"="+encodeURIComponent(d))}return b.join("&")},ea=function(a){a=(new RegExp("[&#]"+a+"=([^&]*)")).exec(window.location.hash);return null==a?"":decodeURIComponent(a[1].replace(/\+/g," "))},fa=function(a,b,c){if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent)a.attachEvent("on"+b,c);else throw"Add event handler for "+b+" failed.";},ga=function(a,b){a=(a||"").split(" ");b=(b||"").split(" ");for(var c=0;c<b.length;c++)if(b[c]&&
0>r(a,b[c]))return!1;return!0},ha=function(){if("undefined"!=typeof p)return p;var a;a=window.localStorage?window.localStorage:void 0;if(!a)return p=!1;try{a.setItem("test","test"),a.removeItem("test"),p=!0}catch(b){p=!1}return p},ia=function(){var a=navigator.userAgent.toLowerCase();return-1!=a.indexOf("msie")&&8==parseInt(a.split("msie")[1],10)},u=function(){return Object.hasOwnProperty.call(window,"ActiveXObject")&&!window.ActiveXObject},ja=function(){var a=navigator.userAgent;return!!a&&/Edge\/\d+/.test(a)},
ka=function(){var a=navigator.userAgent,b;if(b=!!a&&-1!=a.indexOf("CriOS"))b=-1,(a=a.match(/CriOS\/(\d+)/))&&a[1]&&(b=parseInt(a[1],10)||-1),b=48>b;return b},la=function(){var a=navigator.userAgent.toLowerCase();return-1<a.indexOf("safari/")&&0>a.indexOf("chrome/")&&0>a.indexOf("crios/")&&0>a.indexOf("android")},v=function(a){this.Ua=a||[];this.F={}};
v.prototype.addEventListener=function(a,b){if(!(0<=r(this.Ua,a)))throw"Unrecognized event type: "+a;if("[object Function]"!==Object.prototype.toString.call(b))throw"The listener for event '"+a+"' is not a function.";this.F[a]||(this.F[a]=[]);0>r(this.F[a],b)&&this.F[a].push(b)};v.prototype.dispatchEvent=function(a){var b=a.type;if(!(b&&0<=r(this.Ua,b)))throw"Failed to dispatch unrecognized event type: "+b;if(this.F[b]&&this.F[b].length)for(var c=0,d=this.F[b].length;c<d;c++)this.F[b][c](a)};
n=n||{};n.H=function(a){a=encodeURIComponent(a);var b=n.Ka();if(b&&(a=b.match("(^|;) ?"+a+"=([^;]*)(;|$)"))&&2<a.length&&(a=a[2]))return decodeURIComponent(a)};n.mb=function(a){var b;(a=n.H(a))&&(b=String(ma(a)));return b};n.Ka=function(){return document.cookie};n.Mb=function(a){document.cookie=a};k=k||{};
k.ub=function(a){if(!0===k.pa)a();else{var b=function(){k.pa=!0;a()};switch(na()){case "sessionStorage":k.da=new x;k.da.D();break;case "inMemoryStorage":k.da=new y;k.da.D();break;default:throw"Unsupported storage type: "+na();}switch(oa()){case "localStorage":k.N=new z;k.N.D();b();break;case "indexedDb":k.N=new A;k.N.D(b);break;case "cookieStorage":k.N=new B;k.N.D();b();break;default:throw"Unsupported storage type: "+oa();}}};
k.Ma=function(){if(!k.pa)throw Error("Storages are not initialized yet!");return k.N};k.sb=function(){if(!k.pa)throw Error("Storages are not initialized yet!");return k.da};var C=function(){};C.prototype.Z=function(){throw Error("unimplemented abstract method");};C.prototype.getItem=function(a,b){b(this.Z(a))};C.prototype.setItem=function(){throw Error("unimplemented abstract method");};C.prototype.removeItem=function(){throw Error("unimplemented abstract method");};var z=function(){};t(z,C);
z.prototype.D=function(a){this.aa=a||window.localStorage};z.prototype.Z=function(a){return this.aa.getItem(a)};z.prototype.setItem=function(a,b,c){void 0===b||null===b?this.aa.removeItem(a):this.aa.setItem(a,b);c&&c()};z.prototype.removeItem=function(a,b){this.aa.removeItem(a);b&&b()};var A=function(){};A.prototype.D=function(a){var b=this,c=window.indexedDB.open("oauth");c.onsuccess=function(c){b.ka=c.target.result;a()};c.onupgradeneeded=function(a){a.target.result.createObjectStore("oauth")}};
A.prototype.getItem=function(a,b){var c=this.ka.transaction("oauth","readwrite").objectStore("oauth").get(a);c.onsuccess=function(){b(c.result)}};A.prototype.setItem=function(a,b,c){var d=this.ka.transaction("oauth","readwrite").objectStore("oauth");if(void 0===b||null===b)d["delete"](a);else d.put(b,a);d.transaction.oncomplete=function(){c&&c()}};
A.prototype.removeItem=function(a,b){var c=this.ka.transaction("oauth","readwrite").objectStore("oauth");c["delete"](a);c.transaction.oncomplete=function(){b&&b()}};var y=function(){};t(y,C);y.prototype.D=function(){this.wa={}};y.prototype.Z=function(a){return this.wa[a]||null};y.prototype.setItem=function(a,b,c){this.wa[a]=b;c&&c()};y.prototype.removeItem=function(a,b){delete this.wa[a];b&&b()};var x=function(){};t(x,C);x.prototype.D=function(a){this.ca=a||window.sessionStorage};x.prototype.Z=function(a){return this.ca.getItem(a)};
x.prototype.setItem=function(a,b,c){void 0===b||null===b?this.ca.removeItem(a):this.ca.setItem(a,b);c&&c()};x.prototype.removeItem=function(a,b){this.ca.removeItem(a);b&&b()};var B=function(){};t(B,C);B.prototype.D=function(a){this.zb=a||D.Xa};B.prototype.Z=function(a){for(var b=pa(a),c=0;c<b.length;c++)if(b[c].key==a)return b[c].value;return null};
B.prototype.setItem=function(a,b,c){var d=D.ma(a.split(D.i)[0]);if(d){var e=qa(d);b={key:a,value:b};for(var g=0;g<e.length;g++)if(e[g].key==a){e.splice(g,1);break}e.push(b);ra(this,d,e)}c&&c()};B.prototype.removeItem=function(a,b){for(var c=pa(a),d=0;d<c.length;d++)if(c[d].key==a){c.splice(d,1);break}(a=D.ma(a.split(D.i)[0]))&&ra(this,a,c);b&&b()};
var pa=function(a){return(a=D.ma(a.split(D.i)[0]))?qa(a):[]},qa=function(a){a=n.H(a);return k.fb(a||null)},ra=function(a,b,c){var d=k.hb(c);d.length>a.zb?(c.splice(0,1),0<c.length?ra(a,b,c):q("Failed to write Cookie based cache due to the big size.")):k.Ta(b,d)};k.eb=function(a){try{return atob(a)}catch(b){return a}};k.gb=function(a){try{return btoa(a)}catch(b){return a}};
k.fb=function(a){if(!a)return[];a=k.eb(a);try{return JSON.parse(a).items||[]}catch(b){return q("Error while parsing items from cookie:"+b.message),[]}};k.hb=function(a){return k.gb(JSON.stringify({items:a}))};k.Ta=function(a,b){var c=window.location.pathname;a=encodeURIComponent(a)+"="+encodeURIComponent(b)+"; domain="+window.location.hostname+";";-1!=navigator.userAgent.toLowerCase().indexOf("msie")||u()||(a+=" path="+c+";");"https:"==window.location.protocol&&(a+=" secure;");n.Mb(a)};
k.Ub=function(a){var b=n.Ka();if(b)for(var b=b.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),c=0;c<b.length;c++){var d=decodeURIComponent(b[c]);0==d.indexOf(a)&&k.Ta(d,"")}};var E=function(a){this.Pa=a;v.call(this,["storageValueChanged"])};t(E,v);var sa=function(a,b){k.Ma().getItem(a.Pa,b)};E.prototype.addListener=function(a){this.addEventListener("storageValueChanged",a)};
E.prototype.start=function(){var a=this;sa(this,function(b){a.Db=b;a.Qa=0;a.qa=window.setInterval(ta(a),200)})};E.prototype.stop=function(){void 0!==this.qa&&(clearInterval(this.qa),this.qa=void 0)};
var ta=function(a){return function(){a.Qa++;sa(a,function(b){b!=a.Db?(a.dispatchEvent({type:"storageValueChanged",key:a.Pa,newValue:b}),a.stop()):1500<=a.Qa&&a.stop()})}},ma=function(a){var b=0,c,d,e;if(a)for(c=0,e=a.length;c<e;c++)d=a.charCodeAt(c),b=(b<<5)-b+d,b|=0;return b},F=function(a){return!!a&&0<=a.indexOf(D.i)},ua=function(a,b){if(!a&&!b)return!0;if(!a||!b)return!1;a=a.extraQueryParams;b=b.extraQueryParams;if(!a&&!b)return!0;if(!a||!b||Object.keys&&Object.keys(a).length!=Object.keys(b).length)return!1;
for(var c in a)if(a[c]!==b[c])return!1;if(!Object.keys)for(c in b)if(a[c]!==b[c])return!1;return!0},D=D||{};D.ia="SID";D.Fa="SSID";D.Wa=100;D.Ha="/oauth2/sessionstate/action/updateState";D.za="/oauth2/sessionstate/action/checkOrigin";D.Ea="/oauth2/permission/action/refresh";D.Da="/oauth2/permission/action/code";D.ha="/oauth2/permission/action/listSessions";D.$a="/o/oauth2/revoke";D.i="::";D.ga="_ss_";D.Ca="_tr_";D.T="oauth2_ss";D.Aa="oauth2_cs";D.Ga="oauth2_tr";D.Ya="oauth2_is";D.S="oauth2_ar";
D.Ba="oauth2c_";D.Xa=1500;D.Rb=function(){var a={ga:1,Ca:2,T:3,Aa:4,Ga:5,S:6},b;for(b in a)if(a=D[b],!a||0<=a.indexOf(D.i))throw"Invalid value for 'oauth2.spi."+b+"'.";};D.Rb();D.Za=512;D.ab=function(a){var b;(b=void 0===a.hint)||(b=a.hint,b=(""===b?!0:b?"string"==typeof b||"object"==typeof b&&b.constructor===String:!1)&&a.hint.length<=D.Za);return!a.id&&b};D.qb=function(){return"https:"==window.location.protocol?D.Fa:D.ia};
D.ma=function(a){switch(a){case D.S:return D.Ba+D.S;case D.T:return D.Ba+D.T;default:return null}};var oa=function(){return la()&&!ha()?"cookieStorage":u()||ja()?"indexedDb":"localStorage"},na=function(){return la()&&!ha()?"inMemoryStorage":"sessionStorage"},n=n||{};n.fa="cookieValueChanged";var va=function(a,b){this.Ja=a;this.vb=b;v.call(this,[n.fa])};t(va,v);va.prototype.H=function(){return n.H(this.Ja)};var G=function(a){return n.mb(a.Ja)};
va.prototype.addListener=function(a){this.addEventListener(n.fa,a)};
var xa=function(a){void 0!==a.xa&&(window.clearInterval(a.xa),a.xa=void 0,q("IDP Session Cookie monitor is stoped."));a.ba=a.H();a.xa=window.setInterval(wa(a),a.vb);q("IDP Session Cookie monitor is started.")},wa=function(a){return function(){var b=a.H();if(a.ba!=b){var c={type:n.fa,newHash:b&&ma(b),oldHash:a.ba&&ma(a.ba)};a.ba=b;a.dispatchEvent(c)}}},ya=function(a,b){this.b=a;this.Va=b},za=function(a,b,c){var d=D.$a,e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var a;
e.responseText&&(a=window.JSON.parse(e.responseText));c(a)}};e.open("POST",d,!0);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");var g="xsrfToken=";a.Va&&(g+=a.Va);if(b)for(var f in b)f&&b[f]&&(g+="&"+f+"="+encodeURIComponent(b[f]));q("Call "+d+" with postData: "+g);e.send(g)},H=function(a,b,c,d,e){var g=new XMLHttpRequest;g.onreadystatechange=function(){if(4==g.readyState&&200==g.status){var a;g.responseText&&(a=window.JSON.parse(g.responseText));d(a)}};if(b=da(b))a+=0>a.indexOf("?")?
"?":"&",a+=b;g.open("GET",a,!0);e&&(g.withCredentials=!0);if(c)for(var f in c)if(c.hasOwnProperty(f)){e=c[f];if(null===e||void 0===e)e="";g.setRequestHeader(f,e)}q("Call "+a+" with Get method.");g.send()},Aa=function(a,b,c){H(D.za,{origin:a.b,client_id:b},null,c,!1)},Ba=function(a,b,c){b&&b.length?H(D.Ha,{login_hint:b.join(" "),origin:a.b},null,c,!1):c({activeHints:{}})},Ca=function(a,b,c){b.origin=a.b;delete b.redirect_uri;delete b.app_package_name;H(D.Ea,b,null,c,!1)},Da=function(a,b,c){b.origin=
a.b;delete b.redirect_uri;delete b.app_package_name;delete b.response_type;H(D.Da,b,null,c,!1)},Ea=function(a,b,c){b.origin=a.b;b.redirect_uri=void 0;b.response_type=void 0;b.app_package_name=void 0;H(D.ha,b,null,c,!1)},Fa=function(a,b,c){za(a,{token:b},c)},k=k||{},Ga=function(){};Ga.prototype.w=function(){return!1};var Ha={};k.Fb=function(){var a=new I;if(!a)throw"policy cannot be empty.";if(k.Na("DEFAULT"))throw"Duplicate policyName [DEFAULT].";Ha.DEFAULT=a};
k.Na=function(a){for(var b in Ha)if(a==b)return!0;return!1};k.La=function(a){return a&&k.Na(a)?a:"DEFAULT"};k.nb=function(a){return Ha[k.La(a)]};k.w=function(a,b,c,d){return k.nb(d).w(a,b,c)};k.Tb=function(a,b,c,d){if(!k.w(a,b,c,d))throw"permission_error";};var Ia=function(){};t(Ia,Ga);Ia.prototype.w=function(a,b,c){a=c?this.na(a):this.oa(a);return 0<=r(a,b)};
Ia.prototype.oa=function(a){var b=[];if(a&&(b.push(a),"http://"==a.substring(0,7)||"https://"==a.substring(0,8))){var c=document.createElement("a");c.href=a;a!=c.protocol+"//"+c.hostname&&b.push(c.protocol+"//"+c.hostname);"https:"==c.protocol&&b.push("http://"+c.hostname)}return b};
Ia.prototype.na=function(a){var b=[];if(a){b.push(a);var c=document.createElement("a");c.href=a;if("http:"==c.protocol||"https:"==c.protocol)for(a=c.hostname.split(".");1<a.length;)b.push(c.protocol+"//"+a.join(".")),"https:"==c.protocol&&b.push("http://"+a.join(".")),a.shift()}return b};var I=function(){};t(I,Ga);I.prototype.w=function(a,b,c){a=c?this.na(a):this.oa(a);return 0<=r(a,b)};
I.prototype.oa=function(a){var b=[];if(a&&(b.push(a),"https://"==a.substring(0,8))){var c=document.createElement("a");c.href=a;""!=c.port&&0!=c.port&&443!=c.port||b.push("http://"+c.hostname)}return b};
I.prototype.na=function(a){var b=[];if(a){var c=document.createElement("a");c.href=a;if("https:"==c.protocol&&(""==c.port||0==c.port||443==c.port)||"http:"==c.protocol&&(""==c.port||0==c.port||80==c.port))for(a=c.hostname.split(".");1<a.length;)b.push(c.protocol+"//"+a.join(".")),"https:"==c.protocol&&b.push("http://"+a.join(".")),a.shift();else b.push(a)}return b};k.Fb();var J=function(){};J.prototype.sa=function(){return!0};var K=function(a){return a.sa()?k.sb():k.Ma()};
J.prototype.h=function(){throw Error("unimplemented abstract method");};J.prototype.G=function(){throw Error("unimplemented abstract method");};J.prototype.l=function(){throw Error("unimplemented abstract method");};J.prototype.j=function(){throw Error("unimplemented abstract method");};var L=function(){};t(L,J);
L.prototype.l=function(a,b,c){var d=this,e=this.h(a);K(this).getItem(e,function(a){var f;if(a)try{var g=window.JSON.parse(a);if(g.cookieHash!=b){K(d).removeItem(e,function(){c(void 0)});return}f=g&&g.cachedValue}catch(m){}c(f)})};L.prototype.j=function(a,b,c,d){a=this.h(a);void 0===b||null===b?K(this).removeItem(a,d):(b=JSON.stringify({cookieHash:c,cachedValue:b}),K(this).setItem(a,b,d))};var M=function(){};t(M,J);
M.prototype.l=function(a,b,c){K(this).getItem(this.h(a),function(a){var b;if(a)try{var d=window.JSON.parse(a);b=d&&d.cachedValue}catch(f){}c(b)})};M.prototype.j=function(a,b,c,d){a=this.h(a);void 0===b||null===b?K(this).removeItem(a,d):(b=JSON.stringify({cachedValue:b}),K(this).setItem(a,b,d))};var N=function(){};t(N,M);N.prototype.sa=function(){return!1};N.prototype.h=function(a){return[D.S,a.origin,a.a,a.id].join(D.i)};
N.prototype.G=function(a){var b={};a&&(a=a.split(D.i),4==a.length&&(b.origin=a[1],b.a=a[2],b.id=a[3]));return b};var Ja=function(){};t(Ja,L);Ja.prototype.h=function(a){return[D.Aa,a.origin,a.a].join(D.i)};Ja.prototype.G=function(a){a=a.split(D.i);var b={};3==a.length&&(b.origin=a[1],b.a=a[2]);return b};var O=function(){};t(O,L);O.prototype.h=function(a){return[D.Ya,a.origin,a.a].join(D.i)};
O.prototype.l=function(a,b,c){var d=this;L.prototype.l.call(this,a,b,function(b){b&&b.expires_at?6E4>b.expires_at-(new Date).getTime()?K(d).removeItem(d.h(a),c):ga(b.scope,a.scope)&&ga(a.scope,b.scope)?(b.expires_in=Math.floor((b.expires_at-(new Date).getTime())/1E3),c&&c(b)):K(d).removeItem(d.h(a),c):c&&c(void 0)})};O.prototype.j=function(a,b,c,d){var e;b&&b.expires_at&&18E4<b.expires_at-(new Date).getTime()&&(e=b);L.prototype.j.call(this,a,e,c,d)};var P=function(){};t(P,M);P.prototype.sa=function(){return!1};
P.prototype.h=function(a){return[D.T,a.domain,a.V?"1":"0",k.La(a.I),a.id||D.ga].join(D.i)};P.prototype.G=function(a){a=a.split(D.i);var b={};5==a.length&&(b.domain=a[1],b.V="1"==a[2],b.I=a[3],b.id=a[4]);"DEFAULT"==b.I&&delete b.I;b.id==D.ga&&delete b.id;return b};var Q=function(a){this.Cb=a||D.Ga};t(Q,L);Q.prototype.h=function(a){return[this.Cb,a.origin,a.a,a.id||D.Ca].join(D.i)};
Q.prototype.l=function(a,b,c){var d=this;L.prototype.l.call(this,a,b,function(b){b&&b.P&&b.P.expires_at?a.yb!=b.P.login_hint?K(d).removeItem(d.h(a),c):6E4>b.P.expires_at-(new Date).getTime()?K(d).removeItem(d.h(a),c):ga(b.P.scope,a.scope)?ga(b.responseType,a.responseType)?(b=b.P,b.expires_in=Math.floor((b.expires_at-(new Date).getTime())/1E3),c&&c(b)):K(d).removeItem(d.h(a),c):K(d).removeItem(d.h(a),c):c&&c(void 0)})};
Q.prototype.j=function(a,b,c,d){var e;b&&b.expires_at&&18E4<b.expires_at-(new Date).getTime()&&(e={P:b,responseType:a.responseType});L.prototype.j.call(this,a,e,c,d)};var Ka=function(a,b){this.b=a;this.ua=b;this.Y={};this.X={}},La=function(a,b){if(!b)throw"message object cannot be null.";b.rpcToken=a.ua;b=JSON.stringify(b);q("IDP IFrame sends message: "+b);window.parent.postMessage(b,a.b)},R=function(a,b,c){b&&La(a,{id:b,result:c})};
Ka.prototype.Eb=function(a){if(a.source==window.parent&&a.origin==this.b){q("IDP Session State IFrame receive message:"+a.data);try{var b=window.JSON.parse(a.data)}catch(c){return}(b.rpcToken||this.ua)&&b.rpcToken!=this.ua?q("RPC token mismatch."):b&&b.method&&this.Y[b.method]?(a=this.Y[b.method],a.rpcIdRequired&&!b.id?q("Bad request."):a.validator&&!a.validator(b)?(q("Bad request."),La(this,{id:b.id,error:"bad_request"})):a.handler(b)):q("Bad request.")}};
var S=function(a,b){if(b&&b.type&&a.X[b.type]){var c=a.X[b.type].filter;c&&!c(b)||La(a,{method:"fireIdpEvent",params:b})}else q("Invalid event type.")},Ma=function(a,b){a.Y={};a.X={};if(b){if(b.rpcs)for(var c=0;c<b.rpcs.length;c++){var d=b.rpcs[c];if(!d.method||!d.handler)throw"Error in RPC policy: method or handler is empty.";if(a.Y[d.method])throw"Error in RPC policy: duplicate entry for RPC '"+d.method+"'.";a.Y[d.method]={handler:d.handler,rpcIdRequired:d.rpcIdRequired,validator:d.validator}}if(b.events)for(c=
0;c<b.events.length;c++){d=b.events[c];if(!d.type)throw"Error in Event policy: type is empty.";if(a.X[d.type])throw"Error in Event policy: duplicate entry for type '"+d.type+"'.";a.X[d.type]={filter:d.filter}}}},Na=function(a,b,c,d){S(a,{type:"sessionStateChanged",clientId:b,user:c,sessionState:d})},Oa=function(a){var b=new P,c=D.T+D.i;return function(d){if(d.key&&0===d.key.indexOf(c)){var e=b.G(d.key);if(k.w(a.b,e.domain,e.V,e.I)){var g;if(d.newValue)try{var f=JSON.parse(d.newValue);f&&(g=f.cachedValue)}catch(l){return}S(a,
{type:"sessionSelectorChanged",newValue:g,crossSubDomains:e.V,domain:e.domain,policy:e.I,id:e.id})}}}},Pa=function(a){var b=new N,c=[D.S,a.b].join(D.i)+D.i;return function(d){if(!d.key&&ia()){var e,g=null,f=[];for(d=0;d<window.localStorage.length;d++){var l=window.localStorage.key(d);if(0===l.indexOf(c))if(g)f.push(l);else{var m=window.localStorage.getItem(l);f.push(l);if(m){try{e=window.JSON.parse(m)}catch(w){continue}e&&e.cachedValue&&(g=b.G(l),g={type:"authResult",clientId:g.a,id:g.id,authResult:e.cachedValue})}}}for(d=
0;d<f.length;d++)window.localStorage.removeItem(f[d]);(e=g)&&S(a,e)}else if(d.key&&0===d.key.indexOf(c)&&d.newValue){try{f=window.JSON.parse(d.newValue)}catch(w){return}f&&f.cachedValue&&(e=b.G(d.key),e={type:"authResult",clientId:e.a,id:e.id,authResult:f.cachedValue},S(a,e))}}},Qa=function(a,b){this.b=a;this.u=b;this.Ia=new Ja;this.Ra=new P;this.ya=new Q;this.M=new O},Ra=function(a,b,c,d,e){a.Ia.j({origin:a.b,a:b},{user:c.B,session:c.B?c.J:void 0},d,e)},Sa=function(a,b,c){a.Ia.l({origin:a.b,a:b},
G(a.u),c)},Ta=function(a,b,c,d,e,g,f){a.ya.l({yb:b,origin:a.b,a:c,responseType:d,scope:e,id:g},G(a.u),f)},Ua=function(a,b,c,d,e,g,f){a.ya.j({origin:a.b,a:c,responseType:d,id:g},e,b,f)},Va=function(a,b,c){var d=a.ya;a={origin:a.b,a:b};K(d).removeItem(d.h(a),c)},Wa=function(a,b,c,d,e,g){if(!a.w(b,c,e))throw"Permission denied for '"+a.b+"' to read session selector for domain '"+b+"'.";a.Ra.l({domain:b,V:c,I:e,id:d},void 0,function(a){g&&g(a)})},Xa=function(a,b,c,d,e,g,f){if(!a.w(b,c,g))throw"Permission denied for '"+
a.b+"' to write session selector for domain '"+b+"'.";a.Ra.j({domain:b,V:c,I:g,id:e},d,void 0,f)};Qa.prototype.w=function(a,b,c){return k.w(this.b,a,b,c)};
var Ya=function(a,b,c,d){a.M.l({origin:a.b,a:b,scope:c},G(a.u),d)},Za=function(a,b,c,d,e){a.M.j({origin:a.b,a:c},d,b,e)},$a=function(a,b,c){this.L=a;this.c=b;this.g=c},ab=function(a,b,c){a.B?c&&void 0!==c[a.B]?(c=c[a.B],ua(a.J,c)||(a.J=c,Ra(a.g,a.L,a,b,function(){Na(a.c,a.L,a.B,a.J)}))):a.J&&(a.J=void 0,Ra(a.g,a.L,a,b,function(){Na(a.c,a.L,a.B,void 0)})):b&&Na(a.c,a.L,a.B,void 0)},cb=function(a,b,c,d){this.u=a;this.c=b;this.f=c;this.g=d;this.W=void 0;this.v={};this.va=[];var e=this;this.u.addListener(function(a){bb(e,
a)})},db=function(a){var b=[],c;for(c in a.v){var d=a.v[c].B;d&&b.push(d)}return b},bb=function(a,b){if(b.newHash)Ba(a.f,db(a),function(c){for(var d in a.v)ab(a.v[d],b.newHash,c&&c.activeHints)});else for(var c in a.v)ab(a.v[c],b.newHash,void 0)},eb=function(a,b,c,d,e){var g=a.v[b];g||(g=new $a(b,a.c,a.g),a.v[b]=g);a=g;b=c.login_hint;c=c.session_state;a.B!=b?(a.B=b,a.J=b?c:void 0,Ra(a.g,a.L,a,d,e)):e&&e()},fb=function(a,b,c){var d=a.v[b];d?c(!0):Sa(a.g,b,function(e){e?(d=new $a(b,a.c,a.g),a.v[b]=
d,d.B=e.user,d.J=e.session,c(!0)):Aa(a.f,b,function(d){d&&d.valid?(d=new $a(b,a.c,a.g),a.v[b]=d,Ra(a.g,b,d,G(a.u),function(){c(!0)})):c(!1)})})},gb=function(a,b){u()||ja()||ka()?a.va.push(b):fa(ia()?document:window,"storage",b)},T=function(a,b,c){this.b=a;this.c=new Ka(a,b);this.u=new va(D.ia,D.Wa);this.f=new ya(a,c);this.g=new Qa(a,this.u);this.C=new cb(this.u,this.c,this.f,this.g)};h=T.prototype;
h.start=function(){Ma(this.c,this.ja());var a=this;fa(window,"message",function(){a.c.Eb.apply(a.c,arguments)});gb(this.C,Oa(this.c));gb(this.C,Pa(this.c));xa(this.u);k.ub(function(){S(a.c,{type:"idpReady"});q("Initialize IDP IFrame successfully.")})};h.Ab=function(a){var b=this;fb(this.C,(a.params||{}).clientId,function(c){R(b.c,a.id,c)})};
h.jb=function(a){var b=a.params||{},c=this,d=function(b){R(c.c,a.id,b)},e=b.clientId,g=b.loginHint,f=b.request,l=b.sessionSelector;f.client_id=e;f.login_hint=g;f.ss_domain=l.domain;var m=G(this.u);if(m){var w=function(a){a&&!a.error&&a.login_hint?(a.first_issued_at=(new Date).getTime(),a.expires_at=a.first_issued_at+1E3*a.expires_in,a.session_state||(a.session_state={}),a.scope||(a.scope=f.scope),b.skipCache?eb(c.C,e,a,m,function(){d(a)}):Ua(c.g,m,e,f.response_type,a,b.id,function(){eb(c.C,e,a,m,
function(){d(a)})})):(a=a||{},d(a))};b.forceRefresh?Ca(this.f,f,w):Ta(this.g,g,e,f.response_type,f.scope,b.id,function(a){a&&18E4<a.expires_at-(new Date).getTime()?eb(c.C,e,a,m,function(){d(a)}):Ca(c.f,f,w)})}else R(c.c,a.id,{error:"user_logged_out"})};h.ob=function(a){var b=this,c=function(c){R(b.c,a.id,c)};if(G(this.u)){var d=a.params||{},e=d.request,g=d.sessionSelector;e.client_id=d.clientId;e.login_hint=d.loginHint;e.ss_domain=g.domain;Da(this.f,e,c)}else c({error:"user_logged_out"})};
h.Gb=function(a){var b=a.params||{},c=b.clientId,d=this;Fa(this.f,b.token,function(b){Va(d.g,c,function(){R(d.c,a.id,b)})})};h.Pb=function(a){if(u()||ja()||ka()){var b=a.params||{},c=(new N).h({a:b.clientId,id:b.id,origin:b.origin}),b=this.C;if(u()||ja()||ka()){b.W&&b.W.stop();b.W=new E(c);for(c=0;c<b.va.length;c++)b.W.addListener(b.va[c]);b.W.start()}}R(this.c,a.id,!0)};h.ib=function(a){var b=this,c=a.params||{};Wa(this.g,c.domain,c.crossSubDomains,c.id,c.policy,function(c){R(b.c,a.id,c)})};
h.Nb=function(a){var b=a.params||{},c=b.hint,d=!!b.disabled,e=b.domain,g=b.crossSubDomains,f=b.id,l=b.policy,m=this,w;if(c||d)w={hint:c,disabled:d};Xa(this.g,e,g,w,f,l,function(){S(m.c,{type:"sessionSelectorChanged",newValue:w,domain:e,crossSubDomains:g,id:f,policy:l});R(m.c,a.id,!0)})};
h.wb=function(a){var b=a.params||{},c=this,d=function(b){R(c.c,a.id,b)},e=b.clientId,g=b.request,f=b.sessionSelector;g.client_id=e;g.response_type="id_token";g.ss_domain=f.domain;var l=G(this.u);if(l){var m=function(a){a&&!a.error?(a.first_issued_at=(new Date).getTime(),a.expires_at=a.first_issued_at+1E3*a.expires_in,a.scope=g.scope,Za(c.g,l,e,a,function(){d(a)})):(a=a||{error:"No response returned from Server."},d(a))};b.forceRefresh?Ea(this.f,g,m):Ya(this.g,e,g.scope,function(a){a?d(a):Ea(c.f,g,
m)})}else d({scope:g.scope,sessions:[]})};h.Bb=function(a){a=a&&a.params||{};return a.clientId&&!F(a.clientId)};h.tb=function(a){var b=a&&a.params||{};a=b.loginHint;var c=!F(b.id),d=b.clientId&&!F(b.clientId),e=!!b.request,g=e&&b.request.scope;(b=(e=e&&b.request.response_type)&&0<=b.request.response_type.indexOf("code"))&&q("Bad request: 'code' response_type is not supported.");return a&&c&&d&&g&&e&&!b};
h.pb=function(a){a=a&&a.params||{};var b=!F(a.id),c=a.clientId&&!F(a.clientId),d=!!a.request&&a.request.scope;return a.loginHint&&b&&c&&d};h.rb=function(a){a=a&&a.params||{};var b=a.domain&&!F(a.domain),c=!F(a.policy);return!F(a.id)&&b&&c&&this.g.w(a.domain,!!a.crossSubDomains,a.policy)};h.Ob=function(a){a=a&&a.params||{};var b=a.domain&&!F(a.domain),c=!F(a.policy);return!F(a.id)&&b&&c&&this.g.w(a.domain,!!a.crossSubDomains,a.policy)&&D.ab(a)};
h.xb=function(a){a=a&&a.params||{};var b=a.clientId&&!F(a.clientId),c=!!a.request&&a.request.scope;return!F(a.id)&&b&&c};h.Jb=function(a){a=a&&a.params||{};var b=!!a.token,c=a.clientId&&!F(a.clientId);return!F(a.id)&&b&&c};h.Qb=function(a){a=a&&a.params||{};var b=a.origin&&!F(a.origin),c=a.id&&!F(a.id);return a.clientId&&!F(a.clientId)&&b&&c};h.Lb=function(a){var b;if(b=a.clientId)a=a.clientId,b=!(!a||!this.C.v[a]);return b};
h.bb=function(a){var b;if(b=a.clientId)b=a.clientId,b=!(!b||!this.C.v[b]);return b&&a.id&&a.authResult};h.Kb=function(a){return a.domain&&this.g.w(a.domain,a.crossSubDomains,a.policy)};var U=function(a,b){return function(){return b.apply(a,arguments)}};T.prototype.ja=function(){var a={rpcs:[],events:[]};hb(this,a);return a};
var hb=function(a,b){b.rpcs.push({method:"monitorClient",handler:U(a,a.Ab),rpcIdRequired:!1,validator:U(a,a.Bb)});b.rpcs.push({method:"getTokenResponse",handler:U(a,a.jb),rpcIdRequired:!0,validator:U(a,a.tb)});b.rpcs.push({method:"getOnlineCode",handler:U(a,a.ob),rpcIdRequired:!0,validator:U(a,a.pb)});b.rpcs.push({method:"getSessionSelector",handler:U(a,a.ib),rpcIdRequired:!0,validator:U(a,a.rb)});b.rpcs.push({method:"setSessionSelector",handler:U(a,a.Nb),rpcIdRequired:!1,validator:U(a,a.Ob)});b.rpcs.push({method:"listIdpSessions",
handler:U(a,a.wb),rpcIdRequired:!0,validator:U(a,a.xb)});b.rpcs.push({method:"revoke",handler:U(a,a.Gb),validator:U(a,a.Jb)});b.rpcs.push({method:"startPolling",handler:U(a,a.Pb),validator:U(a,a.Qb)});b.events.push({type:"idpReady"});b.events.push({type:"sessionStateChanged",filter:U(a,a.Lb)});b.events.push({type:"sessionSelectorChanged",filter:U(a,a.Kb)});b.events.push({type:"authResult",filter:U(a,a.bb)})};var ib=function(a){if(Error.captureStackTrace)Error.captureStackTrace(this,ib);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))};ba(ib,Error);var jb=function(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")};var kb=function(a,b){b.unshift(a);ib.call(this,jb.apply(null,b));b.shift()};ba(kb,ib);var lb=function(a,b,c){if(!a){var d="Assertion failed";if(b)var d=d+(": "+b),e=Array.prototype.slice.call(arguments,2);throw new kb(""+d,e||[]);}};var mb=function(a){for(var b=[],c=0,d=0;d<a.length;d++){for(var e=a.charCodeAt(d);255<e;)b[c++]=e&255,e>>=8;b[c++]=e}return b};var nb=null;var ob=function(){this.s=-1};var V=function(a,b,c){this.s=-1;this.A=a;this.s=c||a.s||16;this.Oa=Array(this.s);this.ta=Array(this.s);a=b;a.length>this.s&&(this.A.update(a),a=this.A.digest(),this.A.reset());for(c=0;c<this.s;c++)b=c<a.length?a[c]:0,this.Oa[c]=b^92,this.ta[c]=b^54;this.A.update(this.ta)};ba(V,ob);V.prototype.reset=function(){this.A.reset();this.A.update(this.ta)};V.prototype.update=function(a,b){this.A.update(a,b)};
V.prototype.digest=function(){var a=this.A.digest();this.A.reset();this.A.update(this.Oa);this.A.update(a);return this.A.digest()};var pb=function(){this.s=64;this.m=Array(4);this.cb=Array(this.s);this.ea=this.U=0;this.reset()};ba(pb,ob);pb.prototype.reset=function(){this.m[0]=1732584193;this.m[1]=4023233417;this.m[2]=2562383102;this.m[3]=271733878;this.ea=this.U=0};
var qb=function(a,b,c){c||(c=0);var d=Array(16);if("string"==typeof b)for(var e=0;16>e;++e)d[e]=b.charCodeAt(c++)|b.charCodeAt(c++)<<8|b.charCodeAt(c++)<<16|b.charCodeAt(c++)<<24;else for(e=0;16>e;++e)d[e]=b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24;b=a.m[0];c=a.m[1];var e=a.m[2],g=a.m[3],f;f=b+(g^c&(e^g))+d[0]+3614090360&4294967295;b=c+(f<<7&4294967295|f>>>25);f=g+(e^b&(c^e))+d[1]+3905402710&4294967295;g=b+(f<<12&4294967295|f>>>20);f=e+(c^g&(b^c))+d[2]+606105819&4294967295;e=g+(f<<17&4294967295|f>>>15);
f=c+(b^e&(g^b))+d[3]+3250441966&4294967295;c=e+(f<<22&4294967295|f>>>10);f=b+(g^c&(e^g))+d[4]+4118548399&4294967295;b=c+(f<<7&4294967295|f>>>25);f=g+(e^b&(c^e))+d[5]+1200080426&4294967295;g=b+(f<<12&4294967295|f>>>20);f=e+(c^g&(b^c))+d[6]+2821735955&4294967295;e=g+(f<<17&4294967295|f>>>15);f=c+(b^e&(g^b))+d[7]+4249261313&4294967295;c=e+(f<<22&4294967295|f>>>10);f=b+(g^c&(e^g))+d[8]+1770035416&4294967295;b=c+(f<<7&4294967295|f>>>25);f=g+(e^b&(c^e))+d[9]+2336552879&4294967295;g=b+(f<<12&4294967295|
f>>>20);f=e+(c^g&(b^c))+d[10]+4294925233&4294967295;e=g+(f<<17&4294967295|f>>>15);f=c+(b^e&(g^b))+d[11]+2304563134&4294967295;c=e+(f<<22&4294967295|f>>>10);f=b+(g^c&(e^g))+d[12]+1804603682&4294967295;b=c+(f<<7&4294967295|f>>>25);f=g+(e^b&(c^e))+d[13]+4254626195&4294967295;g=b+(f<<12&4294967295|f>>>20);f=e+(c^g&(b^c))+d[14]+2792965006&4294967295;e=g+(f<<17&4294967295|f>>>15);f=c+(b^e&(g^b))+d[15]+1236535329&4294967295;c=e+(f<<22&4294967295|f>>>10);f=b+(e^g&(c^e))+d[1]+4129170786&4294967295;b=c+(f<<
5&4294967295|f>>>27);f=g+(c^e&(b^c))+d[6]+3225465664&4294967295;g=b+(f<<9&4294967295|f>>>23);f=e+(b^c&(g^b))+d[11]+643717713&4294967295;e=g+(f<<14&4294967295|f>>>18);f=c+(g^b&(e^g))+d[0]+3921069994&4294967295;c=e+(f<<20&4294967295|f>>>12);f=b+(e^g&(c^e))+d[5]+3593408605&4294967295;b=c+(f<<5&4294967295|f>>>27);f=g+(c^e&(b^c))+d[10]+38016083&4294967295;g=b+(f<<9&4294967295|f>>>23);f=e+(b^c&(g^b))+d[15]+3634488961&4294967295;e=g+(f<<14&4294967295|f>>>18);f=c+(g^b&(e^g))+d[4]+3889429448&4294967295;c=
e+(f<<20&4294967295|f>>>12);f=b+(e^g&(c^e))+d[9]+568446438&4294967295;b=c+(f<<5&4294967295|f>>>27);f=g+(c^e&(b^c))+d[14]+3275163606&4294967295;g=b+(f<<9&4294967295|f>>>23);f=e+(b^c&(g^b))+d[3]+4107603335&4294967295;e=g+(f<<14&4294967295|f>>>18);f=c+(g^b&(e^g))+d[8]+1163531501&4294967295;c=e+(f<<20&4294967295|f>>>12);f=b+(e^g&(c^e))+d[13]+2850285829&4294967295;b=c+(f<<5&4294967295|f>>>27);f=g+(c^e&(b^c))+d[2]+4243563512&4294967295;g=b+(f<<9&4294967295|f>>>23);f=e+(b^c&(g^b))+d[7]+1735328473&4294967295;
e=g+(f<<14&4294967295|f>>>18);f=c+(g^b&(e^g))+d[12]+2368359562&4294967295;c=e+(f<<20&4294967295|f>>>12);f=b+(c^e^g)+d[5]+4294588738&4294967295;b=c+(f<<4&4294967295|f>>>28);f=g+(b^c^e)+d[8]+2272392833&4294967295;g=b+(f<<11&4294967295|f>>>21);f=e+(g^b^c)+d[11]+1839030562&4294967295;e=g+(f<<16&4294967295|f>>>16);f=c+(e^g^b)+d[14]+4259657740&4294967295;c=e+(f<<23&4294967295|f>>>9);f=b+(c^e^g)+d[1]+2763975236&4294967295;b=c+(f<<4&4294967295|f>>>28);f=g+(b^c^e)+d[4]+1272893353&4294967295;g=b+(f<<11&4294967295|
f>>>21);f=e+(g^b^c)+d[7]+4139469664&4294967295;e=g+(f<<16&4294967295|f>>>16);f=c+(e^g^b)+d[10]+3200236656&4294967295;c=e+(f<<23&4294967295|f>>>9);f=b+(c^e^g)+d[13]+681279174&4294967295;b=c+(f<<4&4294967295|f>>>28);f=g+(b^c^e)+d[0]+3936430074&4294967295;g=b+(f<<11&4294967295|f>>>21);f=e+(g^b^c)+d[3]+3572445317&4294967295;e=g+(f<<16&4294967295|f>>>16);f=c+(e^g^b)+d[6]+76029189&4294967295;c=e+(f<<23&4294967295|f>>>9);f=b+(c^e^g)+d[9]+3654602809&4294967295;b=c+(f<<4&4294967295|f>>>28);f=g+(b^c^e)+d[12]+
3873151461&4294967295;g=b+(f<<11&4294967295|f>>>21);f=e+(g^b^c)+d[15]+530742520&4294967295;e=g+(f<<16&4294967295|f>>>16);f=c+(e^g^b)+d[2]+3299628645&4294967295;c=e+(f<<23&4294967295|f>>>9);f=b+(e^(c|~g))+d[0]+4096336452&4294967295;b=c+(f<<6&4294967295|f>>>26);f=g+(c^(b|~e))+d[7]+1126891415&4294967295;g=b+(f<<10&4294967295|f>>>22);f=e+(b^(g|~c))+d[14]+2878612391&4294967295;e=g+(f<<15&4294967295|f>>>17);f=c+(g^(e|~b))+d[5]+4237533241&4294967295;c=e+(f<<21&4294967295|f>>>11);f=b+(e^(c|~g))+d[12]+1700485571&
4294967295;b=c+(f<<6&4294967295|f>>>26);f=g+(c^(b|~e))+d[3]+2399980690&4294967295;g=b+(f<<10&4294967295|f>>>22);f=e+(b^(g|~c))+d[10]+4293915773&4294967295;e=g+(f<<15&4294967295|f>>>17);f=c+(g^(e|~b))+d[1]+2240044497&4294967295;c=e+(f<<21&4294967295|f>>>11);f=b+(e^(c|~g))+d[8]+1873313359&4294967295;b=c+(f<<6&4294967295|f>>>26);f=g+(c^(b|~e))+d[15]+4264355552&4294967295;g=b+(f<<10&4294967295|f>>>22);f=e+(b^(g|~c))+d[6]+2734768916&4294967295;e=g+(f<<15&4294967295|f>>>17);f=c+(g^(e|~b))+d[13]+1309151649&
4294967295;c=e+(f<<21&4294967295|f>>>11);f=b+(e^(c|~g))+d[4]+4149444226&4294967295;b=c+(f<<6&4294967295|f>>>26);f=g+(c^(b|~e))+d[11]+3174756917&4294967295;g=b+(f<<10&4294967295|f>>>22);f=e+(b^(g|~c))+d[2]+718787259&4294967295;e=g+(f<<15&4294967295|f>>>17);f=c+(g^(e|~b))+d[9]+3951481745&4294967295;a.m[0]=a.m[0]+b&4294967295;a.m[1]=a.m[1]+(e+(f<<21&4294967295|f>>>11))&4294967295;a.m[2]=a.m[2]+e&4294967295;a.m[3]=a.m[3]+g&4294967295};
pb.prototype.update=function(a,b){void 0===b&&(b=a.length);for(var c=b-this.s,d=this.cb,e=this.U,g=0;g<b;){if(0==e)for(;g<=c;)qb(this,a,g),g+=this.s;if("string"==typeof a)for(;g<b;){if(d[e++]=a.charCodeAt(g++),e==this.s){qb(this,d);e=0;break}}else for(;g<b;)if(d[e++]=a[g++],e==this.s){qb(this,d);e=0;break}}this.U=e;this.ea+=b};
pb.prototype.digest=function(){var a=Array((56>this.U?this.s:2*this.s)-this.U);a[0]=128;for(var b=1;b<a.length-8;++b)a[b]=0;for(var c=8*this.ea,b=a.length-8;b<a.length;++b)a[b]=c&255,c/=256;this.update(a);a=Array(16);for(b=c=0;4>b;++b)for(var d=0;32>d;d+=8)a[c++]=this.m[b]>>>d&255;return a};var rb=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(a[c]&&b[d]&&a[c].toLowerCase()===b[d].toLowerCase())return!0;return!1};var tb=function(a,b,c){b.origin=a.b;b.privileged=!0;b.redirect_uri=void 0;b.response_type=void 0;H(D.ha,b,sb(a),c,!1)},ub=function(a,b,c,d){H((window.NOW_SERVER_BASE_URL||"https://clients1.google.com")+"/nowapi/webauth",{origin:a.b,client_id:b,user_ids:c.join(";")},sb(a),d,!0)},vb=function(a,b,c){H("/o/oauth2/auth",{origin:a.b,client_id:b.client_id,login_hint:b.login_hint,response_type:"code",access_type:"offline",scope:"https://www.googleapis.com/auth/googlenow.publish",redirect_uri:"xhr",timestamp:b.timestamp,
signature:b.signature,signed_by:"google_now"},sb(a),c,!1)},W=function(a,b,c){H((window.NOW_SERVER_BASE_URL||"https://clients1.google.com")+"/nowapi/webAuthApiAnalytics",{origin:a.b,client_id:b,status:c},sb(a),function(){},!0)},sb=function(a){var b={},c=n.H(D.qb());if(c){a=a.b;if(!a||!c)throw Error("RP origin and session cookie value cannot be empty.");c=new V(new pb,mb(c));a=mb(a);c.reset();c.update(a);c=c.digest();a=aa(c);lb("array"==a||"object"==a&&"number"==typeof c.length,"encodeByteArray takes an array as a parameter");
if(!nb)for(nb={},a=0;65>a;a++)nb[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a);a=nb;for(var d=[],e=0;e<c.length;e+=3){var g=c[e],f=e+1<c.length,l=f?c[e+1]:0,m=e+2<c.length,w=m?c[e+2]:0,Ab=g>>2,g=(g&3)<<4|l>>4,l=(l&15)<<2|w>>6,w=w&63;m||(w=64,f||(l=64));d.push(a[Ab],a[g],a[l],a[w])}b["X-Csrf-Token"]=d.join("")}return b};var X=function(){};t(X,M);X.prototype.h=function(a){return["now_as",a.R,a.a||"ALL_CLIENTS"].join(D.i)};X.prototype.G=function(a){var b={};if(a){a=a.split(D.i);if("now_as"!==a[0]||3!=a.length)throw Error("Invalid assertion cache key.");b.R=a[1];b.a="ALL_CLIENTS"==a[2]?void 0:a[2]}return b};X.prototype.l=function(a,b,c){var d=this;M.prototype.l.call(this,a,b,function(b){b&&b.e?b.e<(new Date).getTime()?K(d).removeItem(d.h(a),c):c&&c(b.o):c&&c(void 0)})};
X.prototype.j=function(a,b,c,d){if(void 0!==b){var e=!!b;if(e&&!a.a)throw Error("Cannot cache all clients enabled for a user.");b={};b.o=e;b.e=(new Date).getTime()+864E5}M.prototype.j.call(this,a,b,c,d)};var wb=function(a,b,c,d){var e={R:b,a:c};a.l({R:b},void 0,function(b){!1===b?d(!1):a.l(e,void 0,d)})},xb=function(a,b,c,d){a.j({R:b},void 0,void 0,function(){a.j({R:b,a:c},!0,void 0,d)})},yb=function(a,b,c,d,e){a.j({R:b,a:d?void 0:c},!1,void 0,e)};var zb=function(){};t(zb,L);zb.prototype.h=function(a){return["now_gs",a.origin,a.a].join(D.i)};zb.prototype.l=function(a,b,c){var d=this;L.prototype.l.call(this,a,b,function(b){var e;b&&b.expires_at&&(b.expires_at<=(new Date).getTime()?K(d).removeItem(d.h(a),function(){c&&c(e)}):(b.expires_at=void 0,e=b));c&&c(e)})};zb.prototype.j=function(a,b,c,d){b&&(b.expires_at=(new Date).getTime()+864E5);L.prototype.j.call(this,a,b,c,d)};T.prototype.kb=function(a){var b=this;if(!Bb(this,"getCode",a.id)){var c=Cb(this,a);if(3<c.la.length)Y(c,"THROTTLED","At most 3 email addresses can be used."),W(this.f,c.a,1);else if(c.$){var d=function(a){a.length?Db(b,c,a,function(a){Eb(b,c,a.auth_request)}):(Y(c,"DISABLED"),W(b.f,c.a,4))},e=function(a){"AUTH_EXISTS"==a.message&&(Y(c,"AUTHORIZATION_EXISTS","Authorization already granted for the user."),W(b.f,c.a,3))};Fb(this,c,!1,function(a){Gb(b,c,a,void 0,d,e)})}else Y(c,"DISABLED"),W(this.f,
c.a,2)}};T.prototype.Hb=function(a){var b=this;if(!Bb(this,"revokeNow",a.id)){var c=Cb(this,a);3<c.la.length&&Y(c,"THROTTLED","At most 3 email addresses can be used.");if(c.$){var d=function(a){if(a.length)for(var d=a.length,e=0;e<a.length;e++)Hb(b,c.a,a[e],function(a){(a=a&&a.access_token)?Fa(b.f,a,function(){d--;d||c.O({})}):(d--,d||c.O({}))});else c.O({})},e=function(){};Fb(this,c,!0,function(a){Gb(b,c,a,!0,d,e)})}else c.O({})}};
var Bb=function(a,b,c){a.ra=a.ra||{};if(!a.ra[b])return a.ra[b]=!0,!1;R(a.c,c,{error:"THROTTLED",detail:"The "+b+"() method has already been invoked."});return!0},Cb=function(a,b){var c=b.params||{},d={a:c.clientId,la:c.emails,O:function(c){R(a.c,b.id,c)}};d.$=G(a.u);d.Sa={origin:a.b,a:c.clientId};return d},Fb=function(a,b,c,d){a.M||(a.M=new zb);var e=function(c){c&&c.sessions?a.M.j(b.Sa,c,b.$,function(){d(c)}):Y(b,"OTHER","Failed to get Google session information.")},g={client_id:b.a,scope:"https://www.googleapis.com/auth/googlenow.publish"};
c?tb(a.f,g,e):a.M.l(b.Sa,b.$,function(b){b?d(b):tb(a.f,g,e)})},Gb=function(a,b,c,d,e,g){a.K||(a.K=new X);var f=function(a){e&&e(a)},l=function(){var a=Error("AUTH_EXISTS");g&&g(a)};if(c.sessions&&c.sessions.length){var m=function(c,e){if(0==c.length)f(e);else{var g=c.shift();g.emails&&rb(b.la,g.emails)?d&&g.login_hint?(e.push(g.login_hint),m(c,e)):d?m(c,e):g.login_hint?l():g.obfuscatedGaiaId?wb(a.K,g.obfuscatedGaiaId,b.a,function(a){a?l():(void 0===a&&e.push(g.obfuscatedGaiaId),m(c,e))}):m(c,e):m(c,
e)}};m(c.sessions.slice(0),[])}else f([])},Db=function(a,b,c,d){a.K||(a.K=new X);ub(a.f,b.a,c,function(e){if(e&&"DISABLED"!=e.status)"THROTTLED"==e.status?(Y(b,"THROTTLED","Throttled by Google Now server."),W(a.f,b.a,7)):"OK"==e.status&&Ib(a,b,e,c)?xb(a.K,e.auth_request.login_hint,b.a,function(){d(e)}):(Y(b,"OTHER","Unexpected response from Google Now server."),W(a.f,b.a,8));else{var g=!1,f=!1;if(e.users&&e.users.length){var l=function(c,d){if(0==c.length)d();else{var e=c.shift();e.user_id?yb(a.K,
e.user_id,b.a,e.disabled_for_all_clients,function(){e.disabled_for_all_clients?f=!0:g=!0;l(c,d)}):l(c,d)}};l(e.users.slice(0),function(){Y(b,"DISABLED");W(a.f,b.a,f&&!g?5:6)})}else Y(b,"DISABLED"),W(a.f,b.a,f&&!g?5:6)}})},Ib=function(a,b,c,d){c=c.auth_request;return!!c&&c.origin==a.b&&c.client_id==b.a&&0<c.timestamp&&!!c.signature&&"google_now"==c.signed_by&&0<=r(d,c.login_hint)},Eb=function(a,b,c){vb(a.f,c,function(c){c&&c.code?(b.O({code:c.code}),W(a.f,b.a,9)):c&&"immediate_failed"==c.error&&"policy_enforced"==
c.error_subtype?(Y(b,"AUTHORIZATION_EXISTS","Failed to issue code due to existing authorization."),W(a.f,b.a,10)):(Y(b,"OTHER",c.error||"Failed to get code."),W(a.f,b.a,11))})},Hb=function(a,b,c,d){Ca(a.f,{client_id:b,login_hint:c,response_type:"token",scope:"https://www.googleapis.com/auth/googlenow.publish"},d)},Y=function(a,b,c){a.O({error:b,detail:c})};T.prototype.lb=function(a){a=a&&a.params||{};var b=a.emails,b=b&&b.length&&"[object Array]"===Object.prototype.toString.call(b);return a.clientId&&!F(a.clientId)&&b};T.prototype.Ib=function(a){a=a&&a.params||{};var b=a.emails,b=b&&b.length&&"[object Array]"===Object.prototype.toString.call(b);return a.clientId&&!F(a.clientId)&&b};T.prototype.ja=function(){var a={rpcs:[],events:[]};Jb(this,a);return a};
var Jb=function(a,b){b.rpcs.push({method:"now:getCode",handler:U(a,a.kb),rpcIdRequired:!0,validator:U(a,a.lb)});b.rpcs.push({method:"now:revoke",handler:U(a,a.Hb),rpcIdRequired:!0,validator:U(a,a.Ib)})};T.prototype.ja=function(){var a={rpcs:[],events:[]};hb(this,a);Jb(this,a);return a};D.ia="APISID";D.Fa="SAPISID";D.Ha="/o/oauth2/iframerpc?action=sessionState";D.za="/o/oauth2/iframerpc?action=checkOrigin";D.Ea="/o/oauth2/iframerpc?action=issueToken";D.Da="/o/oauth2/iframerpc?action=issueOnlineCode";D.ha="/o/oauth2/iframerpc?action=listSessions";
var Kb=function(){var a=ea("origin");if(!a)throw"Failed to get parent origin from URL hash!";var b=ea("rpcToken");if(!b)throw"Failed to get rpcToken from URL hash!";var c=ea("debug");ca="0"!=c&&!!c;(new T(a,b)).start()},Lb=["lso","startIdpIFrame"],Z=this;Lb[0]in Z||!Z.execScript||Z.execScript("var "+Lb[0]);for(var Mb;Lb.length&&(Mb=Lb.shift());)Lb.length||void 0===Kb?Z=Z[Mb]?Z[Mb]:Z[Mb]={}:Z[Mb]=Kb;
