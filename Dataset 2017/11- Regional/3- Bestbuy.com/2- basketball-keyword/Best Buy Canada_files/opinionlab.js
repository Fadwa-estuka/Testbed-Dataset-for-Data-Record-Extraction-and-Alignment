$.extend({opinionLab:function(g){var h={pageUrl:document.URL.toLowerCase(),triggerEvent:env.triggerevent?env.triggerevent:"click"},b=$.extend({},h,env.feedback,g),d=[],c=null,e=null,f=function(a){var b=!1;a&&null===c?(c=window.open,window.open=k,b=!0):null!==c&&(window.open=c,c=null,b=!0);return b},k=function(a,b,d){null!==e&&void 0!==e&&e.close();null!==c&&(window.open=c,e=window.open(a,b,d))};return{pageChecker:{isPdp:function(){return-1<b.pageUrl.indexOf("desktop"===env.platform?"/product/":"/catalog/productdetails")?
!0:!1},isCart:function(){return-1<b.pageUrl.indexOf("/order/basket.aspx")?!0:!1},isCheckout:function(){return-1<b.pageUrl.indexOf("/order/")&&-1===b.pageUrl.indexOf("/order/basket.aspx")?!0:!1},isReservationStoreLocator:function(){return-1<b.pageUrl.indexOf("/order/reservationstorelocator.aspx")?!0:!1},isReservationDetails:function(){return-1<b.pageUrl.indexOf("/order/reservationdetails.aspx")?!0:!1},isSelectCheckoutMethod:function(){return-1<b.pageUrl.indexOf("/order/selectcheckoutmethod.aspx")?
!0:!1},isReservationReceived:function(){return-1<b.pageUrl.indexOf("/order/reservationreceived.aspx")?!0:!1}},mapCardName:function(a){"generic"===a&&this.pageChecker.isPdp()&&(a="pdp");return b.cardsMapping[a+"-"+env.lang]},feedbackObject:function(a){"undefined"===typeof d[a]&&(d[a]=new OOo.Ocode({referrerRewrite:{replacePattern:a}}));return d[a]},displayFeedbackPopup:function(a){"desktop"===env.platform&&f(!0);this.feedbackObject(a).show("event");"desktop"===env.platform&&f(!1)},bindCardLinks:function(){var a=
this;$("[data-feedback]").bind(b.triggerEvent,function(b){b.preventDefault();b=a.mapCardName($(this).data("feedback"));a.displayFeedbackPopup(b)})},checkoutInit:function(){this.pageChecker.isCart()&&(-1<b.pageUrl.indexOf("fromcheckout=true")?($(".feedback-rpu").hide(),$(".feedback-checkout").show()):$(".feedback-checkout").hide())},rpuCookie:{create:function(){$.cookie("feedbackRPU","inProgress",{path:"/",domain:env.cookieDomain})},exist:function(){return $.cookie("feedbackRPU")?!0:!1},destroy:function(){$.cookie("feedbackRPU",
null,{path:"/",domain:env.cookieDomain})}},rpuIsAbandoned:function(){return this.rpuCookie.exist()},displayRpuMessage:function(){var a=this;if("desktop"===env.platform&&this.pageChecker.isPdp())$(document).on("click",".ui-lightbox-mvc-close",function(){a.rpuIsAbandoned()&&a.pageChecker.isPdp()?($(".feedback-checkout").hide(),$(".feedback-rpu").show(),a.rpuCookie.destroy()):$(".feedback-rpu").hide()});if(this.pageChecker.isPdp()||this.pageChecker.isCart())a.rpuIsAbandoned()?($(".feedback-checkout").hide(),
$(".feedback-rpu").show(),a.rpuCookie.destroy()):$(".feedback-rpu").hide()},rpuDesktop:function(){var a=this;$(document).on("RPU:start",function(b){a.rpuCookie.create()});$(document).on("RPU:end",function(b){a.rpuCookie.destroy()});$(".reserve-more-mode-trigger").on("click",function(){a.rpuCookie.destroy()})},rpuMobile:function(){var a=this;(this.pageChecker.isReservationStoreLocator()||this.pageChecker.isReservationDetails()||this.pageChecker.isSelectCheckoutMethod())&&a.rpuCookie.create();this.pageChecker.isReservationReceived()&&
a.rpuCookie.destroy();$("#ctl00_CP_BtnReserveMoreItems").bind(b.triggerEvent,function(){a.rpuCookie.destroy()});$(".btnMenu.btn-home").bind(b.triggerEvent,function(){a.rpuCookie.destroy()});$(".glb-header .btn-logo").bind(b.triggerEvent,function(){a.rpuCookie.destroy()})},rpuInit:function(){this.displayRpuMessage();"desktop"===env.platform?this.rpuDesktop():"mobile"===env.platform&&this.rpuMobile()},init:function(){env.feedback.enabled&&(this.bindCardLinks(),this.checkoutInit(),this.rpuInit())}}}});