(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory();else if(typeof define==="function"&&define.amd)define([],factory);else{var a=factory();for(var i in a)(typeof exports==="object"?exports:root)[i]=a[i]}})(this,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.i=function(value){return value};__webpack_require__.d=function(exports,name,getter){Object.defineProperty(exports,name,{configurable:false,enumerable:true,get:getter})};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=8)}([function(module,exports){"use strict";"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=window.DM},function(module,exports,__webpack_require__){"use strict";"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _jsCookie=__webpack_require__(3);var _jsCookie2=_interopRequireDefault(_jsCookie);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}exports["default"]={getItem:function getItem(name){return _jsCookie2["default"].get(name)},removeItem:function removeItem(name){return _jsCookie2["default"].remove(name)},setItem:function setItem(name,val,options){return _jsCookie2["default"].set(name,val,options)}}},function(module,exports,__webpack_require__){"use strict";"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _config=__webpack_require__(4);var _config2=_interopRequireDefault(_config);var _store=__webpack_require__(5);var _store2=_interopRequireDefault(_store);var _cookieStorage=__webpack_require__(1);var _cookieStorage2=_interopRequireDefault(_cookieStorage);var _getPageMetadata=__webpack_require__(7);var _getPageMetadata2=_interopRequireDefault(_getPageMetadata);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var getRandomSegmentWeight=function getRandomSegmentWeight(){var segmentsConfig=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var totalWeight=Object.keys(segmentsConfig).reduce(function(result,segment){return result+segmentsConfig[segment].weight},0);return Math.random()*totalWeight};var getRandomSegmentFromConfig=function getRandomSegmentFromConfig(){var sConfig=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var segmentsConfig=sConfig.segments;var randomSegment=void 0;if(segmentsConfig){(function(){var randomWeight=getRandomSegmentWeight(segmentsConfig);var runningSum=void 0;runningSum=0;randomSegment=Object.keys(segmentsConfig).find(function(segment){runningSum+=segmentsConfig[segment].weight;return randomWeight<runningSum})})()}return randomSegment};var storedConfigIsOutdated=function storedConfigIsOutdated(storedConfig,proposedConfig){return storedConfig.shuffleNumber!==proposedConfig.shuffleNumber&&Number(storedConfig.shuffleNumber||-Infinity)<Number(proposedConfig.shuffleNumber||Infinity)};var run=function run(){var storedConfig=_store2["default"].getItem(_config2["default"].storageKey)||{};var proposedConfig=((0,_getPageMetadata2["default"])()||{})[_config2["default"].DMPageMetadataKey]||{};var configIsOutdated=storedConfigIsOutdated(storedConfig,proposedConfig);var cookieClientSegment=_cookieStorage2["default"].getItem(_config2["default"].cookieClientSegment);if(configIsOutdated||!cookieClientSegment){var segmentsConfig=configIsOutdated?proposedConfig:storedConfig;var segment=getRandomSegmentFromConfig(segmentsConfig);if(segment){_cookieStorage2["default"].setItem(_config2["default"].cookieClientSegment,segment,{expires:1e3})}else{_cookieStorage2["default"].removeItem(_config2["default"].cookieClientSegment)}if(segmentsConfig!==storedConfig){_store2["default"].setItem(_config2["default"].storageKey,segmentsConfig)}}};exports["default"]={getRandomSegmentFromConfig:getRandomSegmentFromConfig,getRandomSegmentWeight:getRandomSegmentWeight,run:run,storedConfigIsOutdated:storedConfigIsOutdated}},function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};(function(factory){var registeredInModuleLoader=false;if(true){!(__WEBPACK_AMD_DEFINE_FACTORY__=factory,__WEBPACK_AMD_DEFINE_RESULT__=typeof __WEBPACK_AMD_DEFINE_FACTORY__==="function"?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__));registeredInModuleLoader=true}if((false?"undefined":_typeof(exports))==="object"){module.exports=factory();registeredInModuleLoader=true}if(!registeredInModuleLoader){var OldCookies=window.Cookies;var api=window.Cookies=factory();api.noConflict=function(){window.Cookies=OldCookies;return api}}})(function(){function extend(){var i=0;var result={};for(;i<arguments.length;i++){var attributes=arguments[i];for(var key in attributes){result[key]=attributes[key]}}return result}function init(converter){function api(key,value,attributes){var result;if(typeof document==="undefined"){return}if(arguments.length>1){attributes=extend({path:"/"},api.defaults,attributes);if(typeof attributes.expires==="number"){var expires=new Date;expires.setMilliseconds(expires.getMilliseconds()+attributes.expires*864e5);attributes.expires=expires}try{result=JSON.stringify(value);if(/^[\{\[]/.test(result)){value=result}}catch(e){}if(!converter.write){value=encodeURIComponent(String(value)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)}else{value=converter.write(value,key)}key=encodeURIComponent(String(key));key=key.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent);key=key.replace(/[\(\)]/g,escape);return document.cookie=[key,"=",value,attributes.expires?"; expires="+attributes.expires.toUTCString():"",attributes.path?"; path="+attributes.path:"",attributes.domain?"; domain="+attributes.domain:"",attributes.secure?"; secure":""].join("")}if(!key){result={}}var cookies=document.cookie?document.cookie.split("; "):[];var rdecode=/(%[0-9A-Z]{2})+/g;var i=0;for(;i<cookies.length;i++){var parts=cookies[i].split("=");var cookie=parts.slice(1).join("=");if(cookie.charAt(0)==='"'){cookie=cookie.slice(1,-1)}try{var name=parts[0].replace(rdecode,decodeURIComponent);cookie=converter.read?converter.read(cookie,name):converter(cookie,name)||cookie.replace(rdecode,decodeURIComponent);if(this.json){try{cookie=JSON.parse(cookie)}catch(e){}}if(key===name){result=cookie;break}if(!key){result[name]=cookie}}catch(e){}}return result}api.set=api;api.get=function(key){return api.call(api,key)};api.getJSON=function(){return api.apply({json:true},[].slice.call(arguments))};api.defaults={};api.remove=function(key,attributes){api(key,"",extend(attributes,{expires:-1}))};api.withConverter=init;return api}return init(function(){})})},function(module,exports){"use strict";"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]={cookieClientSegment:"dm_clientsegment",DMPageMetadataKey:"clientSegmentation",storageKey:"mol-fe-segmentation.data"}},function(module,exports,__webpack_require__){"use strict";"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _cookieStorage=__webpack_require__(1);var _cookieStorage2=_interopRequireDefault(_cookieStorage);var _localStorage=__webpack_require__(6);var _localStorage2=_interopRequireDefault(_localStorage);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var storageAvailable=function storageAvailable(){try{var storage=window.localStorage;var val="__storage_test__";storage.setItem(val,val);storage.removeItem(val);return true}catch(err){return false}};var store=storageAvailable()?_localStorage2["default"]:_cookieStorage2["default"];exports["default"]=store},function(module,exports){"use strict";"use strict";Object.defineProperty(exports,"__esModule",{value:true});var localStorage=window.localStorage;var serialise=function serialise(val){return JSON.stringify(val)};var deSerialise=function deSerialise(val){try{return JSON.parse(val)}catch(err){return val}};exports["default"]={getItem:function getItem(name){return deSerialise(localStorage.getItem(name))},removeItem:function removeItem(name){return localStorage.removeItem(name)},setItem:function setItem(name,val){return localStorage.setItem(name,serialise(val))}}},function(module,exports,__webpack_require__){"use strict";"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=getPageMetadata;var _DM=__webpack_require__(0);var _DM2=_interopRequireDefault(_DM);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function getPageMetadata(){return _DM2["default"]&&_DM2["default"].getPageMetadata&&_DM2["default"].getPageMetadata()}},function(module,exports,__webpack_require__){"use strict";"use strict";var _DM=__webpack_require__(0);var _DM2=_interopRequireDefault(_DM);var _manager=__webpack_require__(2);var _manager2=_interopRequireDefault(_manager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}_DM2["default"].later("PAGE_METADATA_SET",function(){return _manager2["default"].run()})}])});!function(e){function t(r){if(n[r])return n[r].exports;var u=n[r]={exports:{},id:r,loaded:!1};return e[r].call(u.exports,u,u.exports,t),u.loaded=!0,u.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(6)},function(e,t,n){var r=n(2),u=n(4);e.exports=function(e){return function t(n,i){switch(arguments.length){case 0:return t;case 1:return u(n)?t:r(function(t){return e(n,t)});default:return u(n)&&u(i)?t:u(n)?r(function(t){return e(t,i)}):u(i)?r(function(t){return e(n,t)}):e(n,i)}}}},function(e,t,n){var r=n(4);e.exports=function(e){return function t(n){return 0===arguments.length||r(n)?t:e.apply(this,arguments)}}},function(e,t){e.exports=function(e,t){return Object.prototype.hasOwnProperty.call(t,e)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e&&e["@@functional/placeholder"]===!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var u=n(10),i=r(u),o=n(12),a=r(o),c=n(8),f=r(c),l=n(7),s=r(l),A="data:image/png;base64,"+f.default,p="data:image/png;base64,"+s.default,d="mol-fe-favicon-new-content-indicator/articleIds",g=1e3,v=/\/article-([0-9]+)\//,h=function(){var e=document.head.querySelectorAll('link[rel="icon"]');(0,a.default)(function(e){e.parentNode.removeChild(e)},e)},b=function(e){h();var t=document.createElement("link");t.setAttribute("rel","icon"),t.setAttribute("href",e),document.head.appendChild(t)},E=function(){var e=document.querySelectorAll(".article a[href]"),t=[];return(0,a.default)(function(e){var n=e.href,r=n.match(v),u=r?parseInt(r[1],10):null;u&&t.indexOf(u)===-1&&t.push(u)},e),t},I=function(){return(window.sessionStorage.getItem(d)||"").split(",").filter(Boolean).map(function(e){return parseInt(e,10)})},m=function(){return(0,i.default)(E(),I())},y=function(e){var t=I();(0,a.default)(function(e){t.indexOf(e)===-1&&t.push(e)},e);var n=t.slice(-1*g);window.sessionStorage.setItem(d,n.join(","))},x=function(){var e=m();"visible"===document.visibilityState?(b(A),y(e)):b(e.length?p:A)},O=window.DM=window.DM||{};O.FaviconNewContentIndicator=function(){var e=function(){x()};"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",e),document.addEventListener("visibilitychange",x)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var u=n(9),i=r(u),o=(0,i.default)();(!o||o>=10)&&n(5)},function(e,t){e.exports="iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyppVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTMyIDc5LjE1OTI4NCwgMjAxNi8wNC8xOS0xMzoxMzo0MCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUuNSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBOTNDODE3OTUwMUMxMUU2QkREQThCODU0NUE4M0VCMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBOTNDODE3QTUwMUMxMUU2QkREQThCODU0NUE4M0VCMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkE5M0M4MTc3NTAxQzExRTZCRERBOEI4NTQ1QTgzRUIwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkE5M0M4MTc4NTAxQzExRTZCRERBOEI4NTQ1QTgzRUIwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+ekPTRAAAA7hJREFUeNrsV2tQTHEU/93dstuuNIlSm6WtTDEIMZIx1TAegykZTAafSBqvfCgzPngMY+QLkRoj78d4hPBBTTSxajxqKIWhWFqKnYRWr7vX2aXHdm9q7y6++M/89977/99zzu+e//mdc5ZRRF/h8BeH8Uo00/VZgn88/gMQBNBf7tSjgEs/qWUKDYVMiuChruIBeLrJkJ4YgppTs3F4/XgM91J07IUGuiMtYSyqjs5EReYMbIgOsBg0D5mzBIlzNXiaMQMP90fhbPJEBPn2DQjTzgKzwpRFI+Dq4tyx2dpmQvY9PUYPH4CR6gE84Y8Nzbhw5x1ipvjAe6CL1Z7JxOFc4TtsPVWBGkNT7yyo1H1B/ddWKyXOThIsnuaLQzeqkHCgFE0trNX+YPLY0kg1srV6PKlusHathEFcxFDEz9H07QhultRhwrpbOFPwlvfS92YWJ/J1iEgutHx119HUyiK3pBZhSQWI2VEEluXEx4CRDOUUv+e91K6y7PUX6OqMVntSSadHc+kjjC1tf5eGEoaxS57HNyF93C8XmCN7iLucR70F4SqM8XNDda0RDBj7AHCcEAAOSrkU51ImQTXIOtrllBNWTB9mCdBIihEO3B/wAM20hBAEqvoLa2ljcXJ1FpJytVDmpAEfPpkpBKg8Md3XD7e+eaHA069vAASTBc03FHx7Lr7Asig1cb7zGFqu30VjfCpW6vnBi4ZvGFtRhRt0q/VQY+OYmXjQWxAKHQHlFGw7XWmZesP3zo3dx+E8LwnuQsa7jXCDDrcLj5E3J8//LQDhIBRAlXkZ2HzQppBTsuZEx14gEOE9AlDK+IVG/qv4BPgof7Lg2RtgbapY5vUjEOc5zFPwYmDhVBUy1o7jSRxcE0JxxsHfWwk3JdWKVenmQmEP/X2A2o103cl0b8mmBA/EptgRmDXBq2Mtr7QO289UouTlZ2icWvH40l5IOJOdKYypZnBfw/TUE45Su2I58fuStgb3n9d3rC95W44jj646qB2RjuyRhk91X5GcVc5b1zTWO7AfMvnbXAs8mo2O7Mg8bAZgkCkcCcBgM4AqpbsjW9JXTraK5Hn6g6X0IYUjWFBcKaqYc5iUTb8xdgLYQjTcKRJAWBCVwCfmtlGkdT0wJJDBNaPodoa8EE+/GSJEW4j/UeR+bXulhXgQE1PosssGPY1kPI6M53Qt9bAPxOTZlFD20V1gL2d+h4wnMigq695rwH4QEcSmpliqctGkMpRWfMz/a+i+hq6F9HyRwYN8IdkfAgwA/jMyQHny3foAAAAASUVORK5CYII="},function(e,t){e.exports="iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAC00lEQVRYhe2WW0hUURSGv+OMjvdreUtNMShTCYwudsOKhCIlI4kwlLyQSQwlYvlcCFJZSWpIhj4UhL0JIkJmhURKiY6oJIXmXTOvjLdppocY6XTO5IyVBvk/rv/stT72XnuvIxBTaWAVZbWaxdcA1gCWBFjvYiMbt7NRkBUXTFZcMCprcQp3J2seqrfRXXqY+L0+SwIIctfQ2V7JjXNbSYsOoLy2h6vlHQyNz2ElCCQe8uNawmb81tkC0DWs5UpZBxX1/Zw5sIE7qaEi8OeaUdQlrbR2T5kHELvTi+KMcHzdbRdjk1odhVVdHN/hRfhGJ9lEA2Nz+LipZL2vegPpRRoe1HySeJIjOL3fV1TcuCM5pzbR2DkumwTAQaUgs7SNp/UDEk9hJRBmAlwCkHCribP5TUzP6iQfa7omSbvXwp7sekan5kWeARibXiA+7y2x1xtli5kFAPCoro/M0jaTi153jNH7edakX9kw9HsAAAu6lRkRyuUs8nFT4eIgXmqtEAjxd+TEbm+mZ6TH98cABAEeZ0UQ6GkviturFGSfDAYgo1hjdj6LX8KMY4FEhXuY9GuaRrhf3f33APKSQkx6E1odyQXNGCxoH4sBwi6+ICi1lvaeaVF8akaHuqSVvlHTt0NOFvWA3vD96QWY1+kl3qTW/OYzyqIdWE4Bo1RK+VImAVwdpJvj6qDEShCI3OK2OIyMcrZTknjQTzIdjYrd5YWbo7V5AJdig8hPCZXEb6eGknzEn9ToANwdxaNaECAu0ps3N/cR6GmP5qfp5+tuS11upHkARVXdqEtaGRybE8WHJ+aY1+lJKWgm4vJLqt+NiPzZeT1PXvXT/2WWnPJ29D9ch4+DWs4XSt8H2f8BoxxtlahjAlHHBFH2rJfcik5JH0SFe5CXFMLkjI70whY+DGoXvaPbPbmbFkrD+3EuFGuYknkhfwmwEvq3/wnXANYA/guAb/gI7S5qh2F9AAAAAElFTkSuQmCC"},function(e,t){var n=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var n=e.indexOf("Trident/");if(n>0){var r=e.indexOf("rv:");return parseInt(e.substring(r+3,e.indexOf(".",r)),10)}var u=e.indexOf("Edge/");return u>0&&parseInt(e.substring(u+5,e.indexOf(".",u)),10)};e.exports=n},function(e,t,n){var r=n(16),u=n(1);e.exports=u(function(e,t){for(var n=[],u=0,i=e.length;u<i;)r(e[u],t)||r(e[u],n)||(n[n.length]=e[u]),u+=1;return n})},function(e,t,n){var r=n(1),u=n(17);e.exports=r(function(e,t){return u(e,t,[],[])})},function(e,t,n){var r=n(15),u=n(1);e.exports=u(r("forEach",function(e,t){for(var n=t.length,r=0;r<n;)e(t[r]),r+=1;return t}))},function(e,t,n){var r=n(1);e.exports=r(function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t})},function(e,t){e.exports=function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}},function(e,t,n){var r=n(21),u=n(22);e.exports=function(e,t){return function(){var n=arguments.length;if(0===n)return t();var i=arguments[n-1];return r(i)||"function"!=typeof i[e]?t.apply(this,arguments):i[e].apply(i,u(arguments,0,n-1))}}},function(e,t,n){var r=n(19);e.exports=function(e,t){return r(t,e,0)>=0}},function(e,t,n){var r=n(14),u=n(18),i=n(3),o=n(13),a=n(23),c=n(24);e.exports=function f(e,t,n,l){if(o(e,t))return!0;if(c(e)!==c(t))return!1;if(null==e||null==t)return!1;if("function"==typeof e.equals||"function"==typeof t.equals)return"function"==typeof e.equals&&e.equals(t)&&"function"==typeof t.equals&&t.equals(e);switch(c(e)){case"Arguments":case"Array":case"Object":if("function"==typeof e.constructor&&"Promise"===u(e.constructor))return e===t;break;case"Boolean":case"Number":case"String":if(typeof e!=typeof t||!o(e.valueOf(),t.valueOf()))return!1;break;case"Date":if(!o(e.valueOf(),t.valueOf()))return!1;break;case"Error":return e.name===t.name&&e.message===t.message;case"RegExp":if(e.source!==t.source||e.global!==t.global||e.ignoreCase!==t.ignoreCase||e.multiline!==t.multiline||e.sticky!==t.sticky||e.unicode!==t.unicode)return!1;break;case"Map":case"Set":if(!f(r(e.entries()),r(t.entries()),n,l))return!1;break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":break;case"ArrayBuffer":break;default:return!1}var s=a(e);if(s.length!==a(t).length)return!1;for(var A=n.length-1;A>=0;){if(n[A]===e)return l[A]===t;A-=1}for(n.push(e),l.push(t),A=s.length-1;A>=0;){var p=s[A];if(!i(p,t)||!f(t[p],e[p],n,l))return!1;A-=1}return n.pop(),l.pop(),!0}},function(e,t){e.exports=function(e){var t=String(e).match(/^function (\w*)/);return null==t?"":t[1]}},function(e,t,n){var r=n(11);e.exports=function(e,t,n){var u,i;if("function"==typeof e.indexOf)switch(typeof t){case"number":if(0===t){for(u=1/t;n<e.length;){if(i=e[n],0===i&&1/i===u)return n;n+=1}return-1}if(t!==t){for(;n<e.length;){if(i=e[n],"number"==typeof i&&i!==i)return n;n+=1}return-1}return e.indexOf(t,n);case"string":case"boolean":case"function":case"undefined":return e.indexOf(t,n);case"object":if(null===t)return e.indexOf(t,n)}for(;n<e.length;){if(r(e[n],t))return n;n+=1}return-1}},function(e,t,n){var r=n(3);e.exports=function(){var e=Object.prototype.toString;return"[object Arguments]"===e.call(arguments)?function(t){return"[object Arguments]"===e.call(t)}:function(e){return r("callee",e)}}()},function(e,t){e.exports=Array.isArray||function(e){return null!=e&&e.length>=0&&"[object Array]"===Object.prototype.toString.call(e)}},function(e,t){e.exports=function n(e,t,r){switch(arguments.length){case 1:return n(e,0,e.length);case 2:return n(e,t,e.length);default:for(var u=[],i=0,o=Math.max(0,Math.min(e.length,r)-t);i<o;)u[i]=e[t+i],i+=1;return u}}},function(e,t,n){var r=n(2),u=n(3),i=n(20);e.exports=function(){var e=!{toString:null}.propertyIsEnumerable("toString"),t=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],n=function(){"use strict";return arguments.propertyIsEnumerable("length")}(),o=function(e,t){for(var n=0;n<e.length;){if(e[n]===t)return!0;n+=1}return!1};return r("function"!=typeof Object.keys||n?function(r){if(Object(r)!==r)return[];var a,c,f=[],l=n&&i(r);for(a in r)!u(a,r)||l&&"length"===a||(f[f.length]=a);if(e)for(c=t.length-1;c>=0;)a=t[c],u(a,r)&&!o(f,a)&&(f[f.length]=a),c-=1;return f}:function(e){return Object(e)!==e?[]:Object.keys(e)})}()},function(e,t,n){var r=n(2);e.exports=r(function(e){return null===e?"Null":void 0===e?"Undefined":Object.prototype.toString.call(e).slice(8,-1)})}]);!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(7)},function(e,t){var n=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var n=e.indexOf("Trident/");if(n>0){var o=e.indexOf("rv:");return parseInt(e.substring(o+3,e.indexOf(".",o)),10)}var i=e.indexOf("Edge/");return i>0&&parseInt(e.substring(i+5,e.indexOf(".",i)),10)};e.exports=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=/^(?:input|select|textarea)$/i;document.addEventListener("keydown",function(o){if(!(n.test(document.activeElement.nodeName)||document.body.classList.contains("video-js-fullscreen")||document.body.classList.contains("mobile-gallery-open"))){var i=o.key||o.keyCode;e.includes(i)&&t()}})}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){window.adverts.on("rendered",function(t){e({element:document.getElementById(t.slot.molAd.parentId),height:t.size[1],positionName:t.slot.molAd.pos,width:t.size[0]})})}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=document.createElement("div");return n.setAttribute("class",e),n.addEventListener("click",function(){t()}),document.body.appendChild(n),n}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=window.adverts.getRendered();return e.map(function(e){var t=document.getElementById(e.parentId);return{element:t,height:t.offsetHeight,positionName:e.pos,width:t.offsetWidth}})}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t="none"===e.style.display;t&&(e.style.display="block");var n=e.offsetWidth;return t&&(e.style.display="none"),n}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var i=n(1),r=o(i),u=(0,r.default)();(!u||u>=10)&&n(10)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.height/e.width>=3}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){"block"===t.style.display&&(window.location.href=e)}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var i=n(1),r=o(i),u=n(2),a=o(u),s=n(3),d=o(s),f=n(4),l=o(f),c=n(5),p=o(c),v=n(6),g=o(v),h=n(8),m=o(h),b=n(9),x=o(b);n(14);var y=window.DM=window.DM||{};y.PrevNextNav=function(e){if(e.prevArticle||e.nextArticle){(0,r.default)()>=10&&document.body.classList.add("ie10");var t=void 0,n=void 0,o=void 0,i=function(){var e=window.innerWidth,n=document.getElementById("content").offsetWidth,o=20;return e-n-2*(o+t)},u=function(e){n&&(n.style.display=e?"block":"none"),o&&(o.style.display=e?"block":"none")},s=function(){var e=(0,p.default)().map(function(e){return e.element.id.toLowerCase()});return e.indexOf("billboard-oop")!==-1},f=function(){return document.body.clientWidth>=1485},c=function(){if(e.forceOnTopOfAds)return void u(f());var t=s(),r=i()/2,a=(0,g.default)(n||o),d=r>=a;u(d&&!t)};if(e.prevArticle){var v=[37,"ArrowLeft","Left"],h=function(){(0,x.default)(e.prevArticle.url,n)};n=(0,l.default)("mol-previous-next-navigation_previous-button",h),(0,a.default)(v,h)}if(e.nextArticle){var b=[39,"ArrowRight","Right"],y=function(){(0,x.default)(e.nextArticle.url,o)};o=(0,l.default)("mol-previous-next-navigation_next-button",y),(0,a.default)(b,y)}t=0;var w=function(e){(0,m.default)(e)&&e.width>t&&(t=e.width)};(0,d.default)(function(e){w(e),c()}),(0,p.default)().forEach(w),c(),window.addEventListener("resize",function(){(0,p.default)().forEach(w),c()})}}},function(e,t,n){t=e.exports=n(12)(),t.push([e.id,'.mol-previous-next-navigation_next-button,.mol-previous-next-navigation_previous-button{width:40px;height:136px;background:#fff;position:fixed;top:50%;margin-top:-68px;cursor:pointer;border:1px solid #eee;z-index:2147483646}.mobile-gallery-open .mol-previous-next-navigation_next-button,.mobile-gallery-open .mol-previous-next-navigation_previous-button{z-index:1}.mol-previous-next-navigation_next-button:after,.mol-previous-next-navigation_previous-button:after{content:"";width:40px;height:40px;position:absolute;top:50%;margin-top:-20px;background-size:auto 100%;background-repeat:no-repeat;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg height="40" viewBox="0 0 48 48" width="40" xmlns="http://www.w3.org/2000/svg"><path d="M17.17 32.92l9.17-9.17-9.17-9.17L20 11.75l12 12-12 12z"/><path d="M0-.25h48v48H0z" fill="none"/></svg>\')}.mol-previous-next-navigation_previous-button:after{background-position:0 0;transform:rotate(180deg)}.mol-previous-next-navigation_next-button:after{background-position:100% 0}.ie10 .mol-previous-next-navigation_next-button:after,.ie10 .mol-previous-next-navigation_previous-button:after{background-image:url("http://i.mol.im/i/furniture/articles/spt_socialicons_40x40eachbttn8.png");background-size:auto}.ie10 .mol-previous-next-navigation_previous-button:after{background-position:-591px 15px;transform:rotate(270deg)}.ie10 .mol-previous-next-navigation_next-button:after{background-position:-591px 12px;transform:rotate(90deg)}.mol-previous-next-navigation_next-button:hover,.mol-previous-next-navigation_previous-button:hover{background-color:#f4f4f4}.mol-previous-next-navigation_previous-button{left:0;border-left:0}.mol-previous-next-navigation_next-button{right:0;border-right:0}',""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var o={},i=0;i<this.length;i++){var r=this[i][0];"number"==typeof r&&(o[r]=!0)}for(i=0;i<t.length;i++){var u=t[i];"number"==typeof u[0]&&o[u[0]]||(n&&!u[2]?u[2]=n:n&&(u[2]="("+u[2]+") and ("+n+")"),e.push(u))}},e}},function(e,t,n){function o(e,t){for(var n=0;n<e.length;n++){var o=e[n],i=p[o.id];if(i){i.refs++;for(var r=0;r<i.parts.length;r++)i.parts[r](o.parts[r]);for(;r<o.parts.length;r++)i.parts.push(d(o.parts[r],t))}else{for(var u=[],r=0;r<o.parts.length;r++)u.push(d(o.parts[r],t));p[o.id]={id:o.id,refs:1,parts:u}}}}function i(e){for(var t=[],n={},o=0;o<e.length;o++){var i=e[o],r=i[0],u=i[1],a=i[2],s=i[3],d={css:u,media:a,sourceMap:s};n[r]?n[r].parts.push(d):t.push(n[r]={id:r,parts:[d]})}return t}function r(e,t){var n=h(),o=x[x.length-1];if("top"===e.insertAt)o?o.nextSibling?n.insertBefore(t,o.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),x.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function u(e){e.parentNode.removeChild(e);var t=x.indexOf(e);t>=0&&x.splice(t,1)}function a(e){var t=document.createElement("style");return t.type="text/css",r(e,t),t}function s(e){var t=document.createElement("link");return t.rel="stylesheet",r(e,t),t}function d(e,t){var n,o,i;if(t.singleton){var r=b++;n=m||(m=a(t)),o=f.bind(null,n,r,!1),i=f.bind(null,n,r,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(t),o=c.bind(null,n),i=function(){u(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(t),o=l.bind(null,n),i=function(){u(n)});return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else i()}}function f(e,t,n,o){var i=n?"":o.css;if(e.styleSheet)e.styleSheet.cssText=y(t,i);else{var r=document.createTextNode(i),u=e.childNodes;u[t]&&e.removeChild(u[t]),u.length?e.insertBefore(r,u[t]):e.appendChild(r)}}function l(e,t){var n=t.css,o=t.media;if(o&&e.setAttribute("media",o),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function c(e,t){var n=t.css,o=t.sourceMap;o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var i=new Blob([n],{type:"text/css"}),r=e.href;e.href=URL.createObjectURL(i),r&&URL.revokeObjectURL(r)}var p={},v=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},g=v(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),h=v(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,b=0,x=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=g()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=i(e);return o(n,t),function(e){for(var r=[],u=0;u<n.length;u++){var a=n[u],s=p[a.id];s.refs--,r.push(s)}if(e){var d=i(e);o(d,t)}for(var u=0;u<r.length;u++){var s=r[u];if(0===s.refs){for(var f=0;f<s.parts.length;f++)s.parts[f]();delete p[s.id]}}}};var y=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){var o=n(11);"string"==typeof o&&(o=[[e.id,o,""]]),n(13)(o,{}),o.locals&&(e.exports=o.locals)}]);!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,t,n){Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=6)}([function(e,t){"use strict";function n(e){var t=e.cb,n=e.throwError,r=void 0!==n&&n,i="undefined"==typeof t?"undefined":o(t);if("function"!==i){if(r)throw new Error('onDocumentLoad: expected function, but received "'+i+'"');return!1}return!0}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=n},function(e,t,n){"use strict";function o(e){return r({cb:e,throwError:!0}),{isRemoved:!1,remove:function(){this.isRemoved=!0,e()}}}var r=n(0);e.exports=o},function(e,t,n){"use strict";var o=n(4),r=n(5);e.exports={onDocumentLoad:o,onOrientationChange:r}},function(e,t){},function(e,t,n){"use strict";function o(e){function t(){u.isRemoved||(u.remove(),e())}r({cb:e,throwError:!0});var n=["DOMContentLoaded",t],o=["load",t],u=i(function(){var e,t;(e=document).removeEventListener.apply(e,n),(t=window).removeEventListener.apply(t,o)});if(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)t();else{var c,d;(c=document).addEventListener.apply(c,n),(d=window).addEventListener.apply(d,o)}return u}var r=n(0),i=n(1);e.exports=o},function(e,t,n){"use strict";function o(e){function t(t){clearInterval(f),
clearTimeout(p),t&&(f=null,p=null,e(t))}function n(e){t(),f=setInterval(function(){window.innerWidth===s&&window.innerHeight===l?(v++,v===d&&t(e)):(s=window.innerWidth,l=window.innerHeight,v=0)},c),p=setTimeout(function(){t(e)},u)}var o,a;r({cb:e,throwError:!0});var f=void 0,p=void 0,s=void 0,l=void 0,v=void 0,m=["resize",n],y=["orientationchange",n];return(o=window).addEventListener.apply(o,m),(a=window).addEventListener.apply(a,y),i(function(){var e,t;(e=window).removeEventListener.apply(e,m),(t=window).removeEventListener.apply(t,y)})}var r=n(0),i=n(1),u=1e3,c=100,d=3;e.exports=o},function(e,t,n){"use strict";n(3);var o=n(2);(0,o.onDocumentLoad)(function(){var e=window.DM.pageEvents;Array.from(document.querySelectorAll(".mol-product")).forEach(function(t){var n=t.querySelector(".mol-product-header"),o=t.querySelector(".mol-product-footer"),r=t.querySelector(".mol-product-cta"),i=t.getAttribute("data-product-title")||n.textConent||n.innerText||"",u=i.toLowerCase().trim().replace(/\s/g,"_").replace(/[^0-9a-zA-Z_]/g,"").substring(0,215);n.addEventListener("click",function(){return e.fireEvent(e.PRODUCT_TITLE_LINK,{productName:u})}),o.addEventListener("click",function(){return e.fireEvent(e.PRODUCT_PRICE_LINK,{productName:u})}),r.addEventListener("click",function(){return e.fireEvent(e.PRODUCT_BUTTON_LINK,{productName:u})})})})}])});window.undefined=window.undefined;Ext={version:"3.1.0-MOL"};Ext.apply=function(o,c,defaults){if(defaults){Ext.apply(o,defaults)}if(o&&c&&typeof c=="object"){for(var p in c){o[p]=c[p]}}return o};(function(){var idSeed=0,toString=Object.prototype.toString,ua=navigator.userAgent.toLowerCase(),check=function(r){return r.test(ua)},DOC=document,isStrict=DOC.compatMode=="CSS1Compat",isOpera=check(/opera/),isChrome=check(/chrome/),isWebKit=check(/webkit/),isSafari=!isChrome&&check(/safari/),isSafari2=isSafari&&check(/applewebkit\/4/),isSafari3=isSafari&&check(/version\/3/),isSafari4=isSafari&&check(/version\/4/),isIE=!isOpera&&check(/msie/),isIE7=isIE&&check(/msie 7/),isIE8=isIE&&check(/msie 8/),isIE6=isIE&&!isIE7&&!isIE8,isGecko=!isWebKit&&check(/gecko/),isGecko2=isGecko&&check(/rv:1\.8/),isGecko3=isGecko&&check(/rv:1\.9/),isBorderBox=isIE&&!isStrict,isWindows=check(/windows|win32/),isMac=check(/macintosh|mac os x/),isAir=check(/adobeair/),isLinux=check(/linux/),isSecure=/^https/i.test(window.location.protocol);if(isIE6){try{DOC.execCommand("BackgroundImageCache",false,true)}catch(e){}}Ext.apply(Ext,{SSL_SECURE_URL:isSecure&&isIE?'javascript:""':"about:blank",isStrict:isStrict,isSecure:isSecure,isReady:false,enableGarbageCollector:true,enableListenerCollection:false,enableNestedListenerRemoval:false,USE_NATIVE_JSON:false,applyIf:function(o,c){if(o){for(var p in c){if(!Ext.isDefined(o[p])){o[p]=c[p]}}}return o},id:function(el,prefix){return(el=Ext.getDom(el)||{}).id=el.id||(prefix||"ext-gen")+ ++idSeed},extend:function(){var io=function(o){for(var m in o){this[m]=o[m]}};var oc=Object.prototype.constructor;return function(sb,sp,overrides){if(Ext.isObject(sp)){overrides=sp;sp=sb;sb=overrides.constructor!=oc?overrides.constructor:function(){sp.apply(this,arguments)}}var F=function(){},sbp,spp=sp.prototype;F.prototype=spp;sbp=sb.prototype=new F;sbp.constructor=sb;sb.superclass=spp;if(spp.constructor==oc){spp.constructor=sp}sb.override=function(o){Ext.override(sb,o)};sbp.superclass=sbp.supr=function(){return spp};sbp.override=io;Ext.override(sb,overrides);sb.extend=function(o){return Ext.extend(sb,o)};return sb}}(),override:function(origclass,overrides){if(overrides){var p=origclass.prototype;Ext.apply(p,overrides);if(Ext.isIE&&overrides.hasOwnProperty("toString")){p.toString=overrides.toString}}},namespace:function(){var o,d;Ext.each(arguments,function(v){d=v.split(".");o=window[d[0]]=window[d[0]]||{};Ext.each(d.slice(1),function(v2){o=o[v2]=o[v2]||{}})});return o},urlEncode:function(o,pre){var empty,buf=[],e=encodeURIComponent;Ext.iterate(o,function(key,item){empty=Ext.isEmpty(item);Ext.each(empty?key:item,function(val){buf.push("&",e(key),"=",!Ext.isEmpty(val)&&(val!=key||!empty)?Ext.isDate(val)?Ext.encode(val).replace(/"/g,""):e(val):"")})});if(!pre){buf.shift();pre=""}return pre+buf.join("")},urlDecode:function(string,overwrite){if(Ext.isEmpty(string)){return{}}var obj={},pairs=string.split("&"),d=decodeURIComponent,name,value;Ext.each(pairs,function(pair){pair=pair.split("=");name=d(pair[0]);value=d(pair[1]);obj[name]=overwrite||!obj[name]?value:[].concat(obj[name]).concat(value)});return obj},urlAppend:function(url,s){if(!Ext.isEmpty(s)){return url+(url.indexOf("?")===-1?"?":"&")+s}return url},toArray:function(){return isIE?function(a,i,j,res){res=[];for(var x=0,len=a.length;x<len;x++){res.push(a[x])}return res.slice(i||0,j||res.length)}:function(a,i,j){return Array.prototype.slice.call(a,i||0,j||a.length)}}(),isIterable:function(v){if(Ext.isArray(v)||v.callee){return true}if(/NodeList|HTMLCollection/.test(toString.call(v))){return true}return(typeof v.nextNode!="undefined"||v.item)&&Ext.isNumber(v.length)},each:function(array,fn,scope){if(Ext.isEmpty(array,true)){return}if(!Ext.isIterable(array)||Ext.isPrimitive(array)){array=[array]}for(var i=0,len=array.length;i<len;i++){if(fn.call(scope||array[i],array[i],i,array)===false){return i}}},iterate:function(obj,fn,scope){if(Ext.isEmpty(obj)){return}if(Ext.isIterable(obj)){Ext.each(obj,fn,scope);return}else if(Ext.isObject(obj)){for(var prop in obj){if(obj.hasOwnProperty(prop)){if(fn.call(scope||obj,prop,obj[prop],obj)===false){return}}}}},getDom:function(el){if(!el||!DOC){return null}return el.dom?el.dom:Ext.isString(el)?DOC.getElementById(el):el},getBody:function(){return Ext.get(DOC.body||DOC.documentElement)},removeNode:isIE&&!isIE8?function(){var d;return function(n){if(n&&n.tagName!="BODY"){Ext.enableNestedListenerRemoval?Ext.EventManager.purgeElement(n,true):Ext.EventManager.removeAll(n);d=d||DOC.createElement("div");d.appendChild(n);d.innerHTML="";delete Ext.elCache[n.id]}}}():function(n){if(n&&n.parentNode&&n.tagName!="BODY"){Ext.enableNestedListenerRemoval?Ext.EventManager.purgeElement(n,true):Ext.EventManager.removeAll(n);n.parentNode.removeChild(n);delete Ext.elCache[n.id]}},isEmpty:function(v,allowBlank){return v===null||v===undefined||Ext.isArray(v)&&!v.length||(!allowBlank?v==="":false)},isArray:function(v){return toString.apply(v)==="[object Array]"},isDate:function(v){return toString.apply(v)==="[object Date]"},isObject:function(v){return!!v&&Object.prototype.toString.call(v)==="[object Object]"},isPrimitive:function(v){return Ext.isString(v)||Ext.isNumber(v)||Ext.isBoolean(v)},isFunction:function(v){return toString.apply(v)==="[object Function]"},isNumber:function(v){return typeof v==="number"&&isFinite(v)},isString:function(v){return typeof v==="string"},isBoolean:function(v){return typeof v==="boolean"},isElement:function(v){return!!v&&v.tagName},isDefined:function(v){return typeof v!=="undefined"},isOpera:isOpera,isWebKit:isWebKit,isChrome:isChrome,isSafari:isSafari,isSafari3:isSafari3,isSafari4:isSafari4,isSafari2:isSafari2,isIE:isIE,isIE6:isIE6,isIE7:isIE7,isIE8:isIE8,isGecko:isGecko,isGecko2:isGecko2,isGecko3:isGecko3,isBorderBox:isBorderBox,isLinux:isLinux,isWindows:isWindows,isMac:isMac,isAir:isAir});Ext.ns=Ext.namespace})();Ext.ns("Ext.util","Ext.lib","Ext.data");Ext.elCache={};Ext.apply(Function.prototype,{createInterceptor:function(fcn,scope){var method=this;return!Ext.isFunction(fcn)?this:function(){var me=this,args=arguments;fcn.target=me;fcn.method=method;return fcn.apply(scope||me||window,args)!==false?method.apply(me||window,args):null}},createCallback:function(){var args=arguments,method=this;return function(){return method.apply(window,args)}},createDelegate:function(obj,args,appendArgs){var method=this;return function(){var callArgs=args||arguments;if(appendArgs===true){callArgs=Array.prototype.slice.call(arguments,0);callArgs=callArgs.concat(args)}else if(Ext.isNumber(appendArgs)){callArgs=Array.prototype.slice.call(arguments,0);var applyArgs=[appendArgs,0].concat(args);Array.prototype.splice.apply(callArgs,applyArgs)}return method.apply(obj||window,callArgs)}},defer:function(millis,obj,args,appendArgs){var fn=this.createDelegate(obj,args,appendArgs);if(millis>0){return setTimeout(fn,millis)}fn();return 0}});Ext.applyIf(String,{format:function(format){var args=Ext.toArray(arguments,1);return format.replace(/\{(\d+)\}/g,function(m,i){return args[i]})}});Ext.applyIf(Array.prototype,{indexOf:function(o,from){var len=this.length;from=from||0;from+=from<0?len:0;for(;from<len;++from){if(this[from]===o){return from}}return-1},remove:function(o){var index=this.indexOf(o);if(index!=-1){this.splice(index,1)}return this}});Ext.util.TaskRunner=function(interval){interval=interval||10;var tasks=[],removeQueue=[],id=0,running=false,stopThread=function(){running=false;clearInterval(id);id=0},startThread=function(){if(!running){running=true;id=setInterval(runTasks,interval)}},removeTask=function(t){removeQueue.push(t);if(t.onStop){t.onStop.apply(t.scope||t)}},runTasks=function(){var rqLen=removeQueue.length,now=(new Date).getTime();if(rqLen>0){for(var i=0;i<rqLen;i++){tasks.remove(removeQueue[i])}removeQueue=[];if(tasks.length<1){stopThread();return}}for(var i=0,t,itime,rt,len=tasks.length;i<len;++i){t=tasks[i];itime=now-t.taskRunTime;if(t.interval<=itime){rt=t.run.apply(t.scope||t,t.args||[++t.taskRunCount]);t.taskRunTime=now;if(rt===false||t.taskRunCount===t.repeat){removeTask(t);return}}if(t.duration&&t.duration<=now-t.taskStartTime){removeTask(t)}}};this.start=function(task){tasks.push(task);task.taskStartTime=(new Date).getTime();task.taskRunTime=0;task.taskRunCount=0;startThread();return task};this.stop=function(task){removeTask(task);return task};this.stopAll=function(){stopThread();for(var i=0,len=tasks.length;i<len;i++){if(tasks[i].onStop){tasks[i].onStop()}}tasks=[];removeQueue=[]}};Ext.TaskMgr=new Ext.util.TaskRunner;Ext.util.DelayedTask=function(fn,scope,args){var me=this,id,call=function(){clearInterval(id);id=null;fn.apply(scope,args||[])};me.delay=function(delay,newFn,newScope,newArgs){me.cancel();fn=newFn||fn;scope=newScope||scope;args=newArgs||args;id=setInterval(call,delay)};me.cancel=function(){if(id){clearInterval(id);id=null}}};(function(){var libFlyweight;function fly(el){if(!libFlyweight){libFlyweight=new Ext.Element.Flyweight}libFlyweight.dom=el;return libFlyweight}(function(){var doc=document,isCSS1=doc.compatMode=="CSS1Compat",MAX=Math.max,ROUND=Math.round,PARSEINT=parseInt;Ext.lib.Dom={isAncestor:function(p,c){var ret=false;p=Ext.getDom(p);c=Ext.getDom(c);if(p&&c){if(p.contains){return p.contains(c)}else if(p.compareDocumentPosition){return!!(p.compareDocumentPosition(c)&16)}else{while(c=c.parentNode){ret=c==p||ret}}}return ret},getViewWidth:function(full){return full?this.getDocumentWidth():this.getViewportWidth()},getViewHeight:function(full){return full?this.getDocumentHeight():this.getViewportHeight()},getDocumentHeight:function(){return MAX(!isCSS1?doc.body.scrollHeight:doc.documentElement.scrollHeight,this.getViewportHeight())},getDocumentWidth:function(){return MAX(!isCSS1?doc.body.scrollWidth:doc.documentElement.scrollWidth,this.getViewportWidth())},getViewportHeight:function(){return Ext.isIE?Ext.isStrict?doc.documentElement.clientHeight:doc.body.clientHeight:self.innerHeight},getViewportWidth:function(){return!Ext.isStrict&&!Ext.isOpera?doc.body.clientWidth:Ext.isIE?doc.documentElement.clientWidth:self.innerWidth},getY:function(el){return this.getXY(el)[1]},getX:function(el){return this.getXY(el)[0]},getXY:function(el){var p,pe,b,bt,bl,dbd,x=0,y=0,scroll,hasAbsolute,bd=doc.body||doc.documentElement,ret=[0,0];el=Ext.getDom(el);if(el!=bd){if(el.getBoundingClientRect){b=el.getBoundingClientRect();scroll=fly(document).getScroll();ret=[ROUND(b.left+scroll.left),ROUND(b.top+scroll.top)]}else{p=el;hasAbsolute=fly(el).isStyle("position","absolute");while(p){pe=fly(p);x+=p.offsetLeft;y+=p.offsetTop;hasAbsolute=hasAbsolute||pe.isStyle("position","absolute");if(Ext.isGecko){y+=bt=PARSEINT(pe.getStyle("borderTopWidth"),10)||0;x+=bl=PARSEINT(pe.getStyle("borderLeftWidth"),10)||0;if(p!=el&&!pe.isStyle("overflow","visible")){x+=bl;y+=bt}}p=p.offsetParent}if(Ext.isSafari&&hasAbsolute){x-=bd.offsetLeft;y-=bd.offsetTop}if(Ext.isGecko&&!hasAbsolute){dbd=fly(bd);x+=PARSEINT(dbd.getStyle("borderLeftWidth"),10)||0;y+=PARSEINT(dbd.getStyle("borderTopWidth"),10)||0}p=el.parentNode;while(p&&p!=bd){if(!Ext.isOpera||p.tagName!="TR"&&!fly(p).isStyle("display","inline")){x-=p.scrollLeft;y-=p.scrollTop}p=p.parentNode}ret=[x,y]}}return ret},setXY:function(el,xy){(el=Ext.fly(el,"_setXY")).position();var pts=el.translatePoints(xy),style=el.dom.style,pos;for(pos in pts){if(!isNaN(pts[pos]))style[pos]=pts[pos]+"px"}},setX:function(el,x){this.setXY(el,[x,false])},setY:function(el,y){this.setXY(el,[false,y])}}})();Ext.lib.Event=function(){var loadComplete=false,unloadListeners={},retryCount=0,onAvailStack=[],_interval,locked=false,win=window,doc=document,POLL_RETRYS=200,POLL_INTERVAL=20,EL=0,TYPE=0,FN=1,WFN=2,OBJ=2,ADJ_SCOPE=3,SCROLLLEFT="scrollLeft",SCROLLTOP="scrollTop",UNLOAD="unload",MOUSEOVER="mouseover",MOUSEOUT="mouseout",doAdd=function(){var ret;if(win.addEventListener){ret=function(el,eventName,fn,capture){if(eventName=="mouseenter"){fn=fn.createInterceptor(checkRelatedTarget);el.addEventListener(MOUSEOVER,fn,capture)}else if(eventName=="mouseleave"){fn=fn.createInterceptor(checkRelatedTarget);el.addEventListener(MOUSEOUT,fn,capture)}else{el.addEventListener(eventName,fn,capture)}return fn}}else if(win.attachEvent){ret=function(el,eventName,fn,capture){el.attachEvent("on"+eventName,fn);return fn}}else{ret=function(){}}return ret}(),doRemove=function(){var ret;if(win.removeEventListener){ret=function(el,eventName,fn,capture){if(eventName=="mouseenter"){eventName=MOUSEOVER}else if(eventName=="mouseleave"){eventName=MOUSEOUT}el.removeEventListener(eventName,fn,capture)}}else if(win.detachEvent){ret=function(el,eventName,fn){el.detachEvent("on"+eventName,fn)}}else{ret=function(){}}return ret}();function checkRelatedTarget(e){return!elContains(e.currentTarget,pub.getRelatedTarget(e))}function elContains(parent,child){if(parent&&parent.firstChild){while(child){if(child===parent){return true}child=child.parentNode;if(child&&child.nodeType!=1){child=null}}}return false}function _tryPreloadAttach(){var ret=false,notAvail=[],element,i,len,v,tryAgain=!loadComplete||retryCount>0;if(!locked){locked=true;for(i=0,len=onAvailStack.length;i<len;i++){v=onAvailStack[i];if(v&&(element=doc.getElementById(v.id))){if(!v.checkReady||loadComplete||element.nextSibling||doc&&doc.body){element=v.override?v.override===true?v.obj:v.override:element;v.fn.call(element,v.obj);onAvailStack.remove(v)}else{notAvail.push(v)}}}retryCount=notAvail.length===0?0:retryCount-1;if(tryAgain){startInterval()}else{clearInterval(_interval);_interval=null}ret=!(locked=false)}return ret}function startInterval(){if(!_interval){var callback=function(){_tryPreloadAttach()};_interval=setInterval(callback,POLL_INTERVAL)}}function getScroll(){var dd=doc.documentElement,db=doc.body;if(dd&&(dd[SCROLLTOP]||dd[SCROLLLEFT])){return[dd[SCROLLLEFT],dd[SCROLLTOP]]}else if(db){return[db[SCROLLLEFT],db[SCROLLTOP]]}else{return[0,0]}}function getPageCoord(ev,xy){ev=ev.browserEvent||ev;var coord=ev["page"+xy];if(!coord&&coord!==0){coord=ev["client"+xy]||0;if(Ext.isIE){coord+=getScroll()[xy=="X"?0:1]}}return coord}var pub={extAdapter:true,onAvailable:function(p_id,p_fn,p_obj,p_override){onAvailStack.push({id:p_id,fn:p_fn,obj:p_obj,override:p_override,checkReady:false});retryCount=POLL_RETRYS;startInterval()},addListener:function(el,eventName,fn){el=Ext.getDom(el);if(el&&fn){if(eventName==UNLOAD){if(unloadListeners[el.id]===undefined){unloadListeners[el.id]=[]}unloadListeners[el.id].push([eventName,fn]);return fn}return doAdd(el,eventName,fn,false)}return false},removeListener:function(el,eventName,fn){el=Ext.getDom(el);var i,len,li,lis;if(el&&fn){if(eventName==UNLOAD){if((lis=unloadListeners[el.id])!==undefined){for(i=0,len=lis.length;i<len;i++){if((li=lis[i])&&li[TYPE]==eventName&&li[FN]==fn){unloadListeners[id].splice(i,1)}}}return}doRemove(el,eventName,fn,false)}},getTarget:function(ev){ev=ev.browserEvent||ev;return this.resolveTextNode(ev.target||ev.srcElement)},resolveTextNode:Ext.isGecko?function(node){if(!node){return}var s=HTMLElement.prototype.toString.call(node);if(s=="[xpconnect wrapped native prototype]"||s=="[object XULElement]"){return}return node.nodeType==3?node.parentNode:node}:function(node){return node&&node.nodeType==3?node.parentNode:node},getRelatedTarget:function(ev){ev=ev.browserEvent||ev;return this.resolveTextNode(ev.relatedTarget||(ev.type==MOUSEOUT?ev.toElement:ev.type==MOUSEOVER?ev.fromElement:null))},getPageX:function(ev){return getPageCoord(ev,"X")},getPageY:function(ev){return getPageCoord(ev,"Y")},getXY:function(ev){return[this.getPageX(ev),this.getPageY(ev)]},stopEvent:function(ev){this.stopPropagation(ev);this.preventDefault(ev)},stopPropagation:function(ev){ev=ev.browserEvent||ev;if(ev.stopPropagation){ev.stopPropagation()}else{ev.cancelBubble=true}},preventDefault:function(ev){ev=ev.browserEvent||ev;if(ev.preventDefault){ev.preventDefault()}else{ev.returnValue=false}},getEvent:function(e){e=e||win.event;if(!e){var c=this.getEvent.caller;while(c){e=c.arguments[0];if(e&&Event==e.constructor){break}c=c.caller}}return e},getCharCode:function(ev){ev=ev.browserEvent||ev;return ev.charCode||ev.keyCode||0},getListeners:function(el,eventName){Ext.EventManager.getListeners(el,eventName)},purgeElement:function(el,recurse,eventName){Ext.EventManager.purgeElement(el,recurse,eventName)},_load:function(e){loadComplete=true;var EU=Ext.lib.Event;if(Ext.isIE&&e!==true){doRemove(win,"load",arguments.callee)}},_unload:function(e){var EU=Ext.lib.Event,i,j,l,v,ul,id,len,index,scope;for(id in unloadListeners){ul=unloadListeners[id];for(i=0,len=ul.length;i<len;i++){v=ul[i];if(v){try{scope=v[ADJ_SCOPE]?v[ADJ_SCOPE]===true?v[OBJ]:v[ADJ_SCOPE]:win;v[FN].call(scope,EU.getEvent(e),v[OBJ])}catch(ex){}}}}unloadListeners=null;Ext.EventManager._unload();doRemove(win,UNLOAD,EU._unload)}};pub.on=pub.addListener;pub.un=pub.removeListener;if(doc&&doc.body){pub._load(true)}else{doAdd(win,"load",pub._load)}doAdd(win,UNLOAD,pub._unload);_tryPreloadAttach();return pub}();Ext.lib.Ajax=function(){var activeX=["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],CONTENTTYPE="Content-Type";function setHeader(o){var conn=o.conn,prop;function setTheHeaders(conn,headers){for(prop in headers){if(headers.hasOwnProperty(prop)){conn.setRequestHeader(prop,headers[prop])}}}if(pub.defaultHeaders){setTheHeaders(conn,pub.defaultHeaders)}if(pub.headers){setTheHeaders(conn,pub.headers);delete pub.headers}}function createExceptionObject(tId,callbackArg,isAbort,isTimeout){return{tId:tId,status:isAbort?-1:0,statusText:isAbort?"transaction aborted":"communication failure",isAbort:isAbort,isTimeout:isTimeout,argument:callbackArg}}function initHeader(label,value){(pub.headers=pub.headers||{})[label]=value}function createResponseObject(o,callbackArg){var headerObj={},headerStr,conn=o.conn,t,s;try{headerStr=o.conn.getAllResponseHeaders();Ext.each(headerStr.replace(/\r\n/g,"\n").split("\n"),function(v){t=v.indexOf(":");if(t>=0){s=v.substr(0,t).toLowerCase();if(v.charAt(t+1)==" "){++t}headerObj[s]=v.substr(t+1)}})}catch(e){}return{tId:o.tId,status:conn.status,statusText:conn.statusText,getResponseHeader:function(header){return headerObj[header.toLowerCase()]},getAllResponseHeaders:function(){return headerStr},responseText:conn.responseText,responseXML:conn.responseXML,argument:callbackArg}}function releaseObject(o){o.conn=null;o=null}function handleTransactionResponse(o,callback,isAbort,isTimeout){if(!callback){releaseObject(o);return}var httpStatus,responseObject;try{if(o.conn.status!==undefined&&o.conn.status!=0){httpStatus=o.conn.status}else{httpStatus=13030}}catch(e){httpStatus=13030}if(httpStatus>=200&&httpStatus<300||Ext.isIE&&httpStatus==1223){responseObject=createResponseObject(o,callback.argument);if(callback.success){if(!callback.scope){callback.success(responseObject)}else{callback.success.apply(callback.scope,[responseObject])}}}else{switch(httpStatus){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:responseObject=createExceptionObject(o.tId,callback.argument,isAbort?isAbort:false,isTimeout);if(callback.failure){if(!callback.scope){callback.failure(responseObject)}else{callback.failure.apply(callback.scope,[responseObject])}}break;default:responseObject=createResponseObject(o,callback.argument);if(callback.failure){if(!callback.scope){callback.failure(responseObject)}else{callback.failure.apply(callback.scope,[responseObject])}}}}releaseObject(o);responseObject=null}function handleReadyState(o,callback){callback=callback||{};var conn=o.conn,tId=o.tId,poll=pub.poll,cbTimeout=callback.timeout||null;if(cbTimeout){pub.timeout[tId]=setTimeout(function(){pub.abort(o,callback,true)},cbTimeout)}poll[tId]=setInterval(function(){if(conn&&conn.readyState==4){clearInterval(poll[tId]);poll[tId]=null;if(cbTimeout){clearTimeout(pub.timeout[tId]);pub.timeout[tId]=null}handleTransactionResponse(o,callback)}},pub.pollInterval)}function asyncRequest(method,uri,callback,postData){var o=getConnectionObject()||null;if(o){o.conn.open(method,uri,true);if(pub.useDefaultXhrHeader){initHeader("X-Requested-With",pub.defaultXhrHeader)}if(postData&&pub.useDefaultHeader&&(!pub.headers||!pub.headers[CONTENTTYPE])){initHeader(CONTENTTYPE,pub.defaultPostHeader)}if(pub.defaultHeaders||pub.headers){setHeader(o)}handleReadyState(o,callback);o.conn.send(postData||null)}return o}function getConnectionObject(){var o;try{if(o=createXhrObject(pub.transactionId)){pub.transactionId++}}catch(e){}finally{return o}}function createXhrObject(transactionId){var http;try{http=new XMLHttpRequest}catch(e){for(var i=0;i<activeX.length;++i){try{http=new ActiveXObject(activeX[i]);break}catch(e){}}}finally{return{conn:http,tId:transactionId}}}var pub={request:function(method,uri,cb,data,options){if(options){var me=this,xmlData=options.xmlData,jsonData=options.jsonData,hs;Ext.applyIf(me,options);if(xmlData||jsonData){hs=me.headers;if(!hs||!hs[CONTENTTYPE]){initHeader(CONTENTTYPE,xmlData?"text/xml":"application/json")}data=xmlData||(!Ext.isPrimitive(jsonData)?Ext.encode(jsonData):jsonData)}}return asyncRequest(method||options.method||"POST",uri,cb,data)},serializeForm:function(form){var fElements=form.elements||(document.forms[form]||Ext.getDom(form)).elements,hasSubmit=false,encoder=encodeURIComponent,element,options,name,val,data="",type;Ext.each(fElements,function(element){name=element.name;type=element.type;if(!element.disabled&&name){if(/select-(one|multiple)/i.test(type)){Ext.each(element.options,function(opt){if(opt.selected){data+=String.format("{0}={1}&",encoder(name),encoder((opt.hasAttribute?opt.hasAttribute("value"):opt.getAttribute("value")!==null)?opt.value:opt.text))}})}else if(!/file|undefined|reset|button/i.test(type)){if(!(/radio|checkbox/i.test(type)&&!element.checked)&&!(type=="submit"&&hasSubmit)){data+=encoder(name)+"="+encoder(element.value)+"&";hasSubmit=/submit/i.test(type)}}}});return data.substr(0,data.length-1)},useDefaultHeader:true,defaultPostHeader:"application/x-www-form-urlencoded; charset=UTF-8",useDefaultXhrHeader:true,defaultXhrHeader:"XMLHttpRequest",poll:{},timeout:{},pollInterval:50,transactionId:0,abort:function(o,callback,isTimeout){var me=this,tId=o.tId,isAbort=false;if(me.isCallInProgress(o)){o.conn.abort();clearInterval(me.poll[tId]);me.poll[tId]=null;clearTimeout(pub.timeout[tId]);me.timeout[tId]=null;handleTransactionResponse(o,callback,isAbort=true,isTimeout)}return isAbort},isCallInProgress:function(o){return o.conn&&!{0:true,4:true}[o.conn.readyState]}};return pub}();(function(){var EXTLIB=Ext.lib,noNegatives=/width|height|opacity|padding/i,offsetAttribute=/^((width|height)|(top|left))$/,defaultUnit=/width|height|top$|bottom$|left$|right$/i,offsetUnit=/\d+(em|%|en|ex|pt|in|cm|mm|pc)$/i,isset=function(v){return typeof v!=="undefined"},now=function(){return new Date};EXTLIB.Anim={motion:function(el,args,duration,easing,cb,scope){return this.run(el,args,duration,easing,cb,scope,Ext.lib.Motion)},run:function(el,args,duration,easing,cb,scope,type){type=type||Ext.lib.AnimBase;if(typeof easing=="string"){easing=Ext.lib.Easing[easing]}var anim=new type(el,args,duration,easing);anim.animateX(function(){if(Ext.isFunction(cb)){cb.call(scope)}});return anim}};EXTLIB.AnimBase=function(el,attributes,duration,method){if(el){this.init(el,attributes,duration,method)}};EXTLIB.AnimBase.prototype={doMethod:function(attr,start,end){var me=this;return me.method(me.curFrame,start,end-start,me.totalFrames)},setAttr:function(attr,val,unit){if(noNegatives.test(attr)&&val<0){val=0}Ext.fly(this.el,"_anim").setStyle(attr,val+unit)},getAttr:function(attr){var el=Ext.fly(this.el),val=el.getStyle(attr),a=offsetAttribute.exec(attr)||[];if(val!=="auto"&&!offsetUnit.test(val)){return parseFloat(val)}return!!a[2]||el.getStyle("position")=="absolute"&&!!a[3]?el.dom["offset"+a[0].charAt(0).toUpperCase()+a[0].substr(1)]:0},getDefaultUnit:function(attr){return defaultUnit.test(attr)?"px":""},animateX:function(callback,scope){var me=this,f=function(){me.onComplete.removeListener(f);if(Ext.isFunction(callback)){callback.call(scope||me,me)}};me.onComplete.addListener(f,me);me.animate()},setRunAttr:function(attr){var me=this,a=this.attributes[attr],to=a.to,by=a.by,from=a.from,unit=a.unit,ra=this.runAttrs[attr]={},end;if(!isset(to)&&!isset(by)){return false}var start=isset(from)?from:me.getAttr(attr);if(isset(to)){end=to}else if(isset(by)){if(Ext.isArray(start)){end=[];for(var i=0,len=start.length;i<len;i++){end[i]=start[i]+by[i]}}else{end=start+by}}Ext.apply(ra,{start:start,end:end,unit:isset(unit)?unit:me.getDefaultUnit(attr)})},init:function(el,attributes,duration,method){var me=this,actualFrames=0,mgr=EXTLIB.AnimMgr;Ext.apply(me,{isAnimated:false,startTime:null,el:Ext.getDom(el),attributes:attributes||{},duration:duration||1,method:method||EXTLIB.Easing.easeNone,useSec:true,curFrame:0,totalFrames:mgr.fps,runAttrs:{},animate:function(){var me=this,d=me.duration;if(me.isAnimated){return false}me.curFrame=0;me.totalFrames=me.useSec?Math.ceil(mgr.fps*d):d;mgr.registerElement(me)},stop:function(finish){var me=this;if(finish){me.curFrame=me.totalFrames;me._onTween.fire()}mgr.stop(me)}});var onStart=function(){var me=this,attr;me.onStart.fire();me.runAttrs={};for(attr in this.attributes){this.setRunAttr(attr)}me.isAnimated=true;me.startTime=now();actualFrames=0};var onTween=function(){var me=this;me.onTween.fire({duration:now()-me.startTime,curFrame:me.curFrame});var ra=me.runAttrs;for(var attr in ra){this.setAttr(attr,me.doMethod(attr,ra[attr].start,ra[attr].end),ra[attr].unit)}++actualFrames};var onComplete=function(){var me=this,actual=(now()-me.startTime)/1e3,data={duration:actual,frames:actualFrames,fps:actualFrames/actual};me.isAnimated=false;actualFrames=0;me.onComplete.fire(data)};me.onStart=new Ext.util.Event(me);me.onTween=new Ext.util.Event(me);me.onComplete=new Ext.util.Event(me);(me._onStart=new Ext.util.Event(me)).addListener(onStart);(me._onTween=new Ext.util.Event(me)).addListener(onTween);(me._onComplete=new Ext.util.Event(me)).addListener(onComplete)}};Ext.lib.AnimMgr=new function(){var me=this,thread=null,queue=[],tweenCount=0;Ext.apply(me,{fps:1e3,delay:1,registerElement:function(tween){queue.push(tween);++tweenCount;tween._onStart.fire();me.start()},unRegister:function(tween,index){tween._onComplete.fire();index=index||getIndex(tween);if(index!=-1){queue.splice(index,1)}if(--tweenCount<=0){me.stop()}},start:function(){if(thread===null){thread=setInterval(me.run,me.delay)}},stop:function(tween){if(!tween){clearInterval(thread);for(var i=0,len=queue.length;i<len;++i){if(queue[0].isAnimated){me.unRegister(queue[0],0)}}queue=[];thread=null;tweenCount=0}else{me.unRegister(tween)}},run:function(){var tf,i,len,tween;for(i=0,len=queue.length;i<len;i++){tween=queue[i];if(tween&&tween.isAnimated){tf=tween.totalFrames;if(tween.curFrame<tf||tf===null){++tween.curFrame;if(tween.useSec){correctFrame(tween)}tween._onTween.fire()}else{me.stop(tween)}}}}});var getIndex=function(anim){var i,len;for(i=0,len=queue.length;i<len;i++){if(queue[i]===anim){return i}}return-1};var correctFrame=function(tween){var frames=tween.totalFrames,frame=tween.curFrame,duration=tween.duration,expected=frame*duration*1e3/frames,elapsed=now()-tween.startTime,tweak=0;if(elapsed<duration*1e3){tweak=Math.round((elapsed/expected-1)*frame)}else{tweak=frames-(frame+1)}if(tweak>0&&isFinite(tweak)){if(tween.curFrame+tweak>=frames){tweak=frames-(frame+1)}tween.curFrame+=tweak}}};EXTLIB.Bezier=new function(){this.getPosition=function(points,t){var n=points.length,tmp=[],c=1-t,i,j;for(i=0;i<n;++i){tmp[i]=[points[i][0],points[i][1]]}for(j=1;j<n;++j){for(i=0;i<n-j;++i){tmp[i][0]=c*tmp[i][0]+t*tmp[parseInt(i+1,10)][0];tmp[i][1]=c*tmp[i][1]+t*tmp[parseInt(i+1,10)][1]}}return[tmp[0][0],tmp[0][1]]}};EXTLIB.Easing={easeNone:function(t,b,c,d){return c*t/d+b},easeIn:function(t,b,c,d){return c*(t/=d)*t+b},easeOut:function(t,b,c,d){return-c*(t/=d)*(t-2)+b}};(function(){EXTLIB.Motion=function(el,attributes,duration,method){if(el){EXTLIB.Motion.superclass.constructor.call(this,el,attributes,duration,method)}};Ext.extend(EXTLIB.Motion,Ext.lib.AnimBase);var superclass=EXTLIB.Motion.superclass,proto=EXTLIB.Motion.prototype,pointsRe=/^points$/i;Ext.apply(EXTLIB.Motion.prototype,{setAttr:function(attr,val,unit){var me=this,setAttr=superclass.setAttr;if(pointsRe.test(attr)){unit=unit||"px";setAttr.call(me,"left",val[0],unit);setAttr.call(me,"top",val[1],unit)}else{setAttr.call(me,attr,val,unit)}},getAttr:function(attr){var me=this,getAttr=superclass.getAttr;return pointsRe.test(attr)?[getAttr.call(me,"left"),getAttr.call(me,"top")]:getAttr.call(me,attr)},doMethod:function(attr,start,end){var me=this;return pointsRe.test(attr)?EXTLIB.Bezier.getPosition(me.runAttrs[attr],me.method(me.curFrame,0,100,me.totalFrames)/100):superclass.doMethod.call(me,attr,start,end)},setRunAttr:function(attr){if(pointsRe.test(attr)){var me=this,el=this.el,points=this.attributes.points,control=points.control||[],from=points.from,to=points.to,by=points.by,DOM=EXTLIB.Dom,start,i,end,len,ra;if(control.length>0&&!Ext.isArray(control[0])){control=[control]}else{}Ext.fly(el,"_anim").position();DOM.setXY(el,isset(from)?from:DOM.getXY(el));start=me.getAttr("points");if(isset(to)){end=translateValues.call(me,to,start);for(i=0,len=control.length;i<len;++i){control[i]=translateValues.call(me,control[i],start)}}else if(isset(by)){end=[start[0]+by[0],start[1]+by[1]];for(i=0,len=control.length;i<len;++i){control[i]=[start[0]+control[i][0],start[1]+control[i][1]]}}ra=this.runAttrs[attr]=[start];if(control.length>0){ra=ra.concat(control)}ra[ra.length]=end}else{superclass.setRunAttr.call(this,attr)}}});var translateValues=function(val,start){var pageXY=EXTLIB.Dom.getXY(this.el);return[val[0]-pageXY[0]+start[0],val[1]-pageXY[1]+start[1]]}})()})();(function(){var abs=Math.abs,pi=Math.PI,asin=Math.asin,pow=Math.pow,sin=Math.sin,EXTLIB=Ext.lib;Ext.apply(EXTLIB.Easing,{easeBoth:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},easeInStrong:function(t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutStrong:function(t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},easeBothStrong:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t+b:-c/2*((t-=2)*t*t*t-2)+b},elasticIn:function(t,b,c,d,a,p){if(t==0||(t/=d)==1){return t==0?b:b+c}p=p||d*.3;var s;if(a>=abs(c)){s=p/(2*pi)*asin(c/a)}else{a=c;s=p/4}return-(a*pow(2,10*(t-=1))*sin((t*d-s)*(2*pi)/p))+b},elasticOut:function(t,b,c,d,a,p){if(t==0||(t/=d)==1){return t==0?b:b+c}p=p||d*.3;var s;if(a>=abs(c)){s=p/(2*pi)*asin(c/a)}else{a=c;s=p/4}return a*pow(2,-10*t)*sin((t*d-s)*(2*pi)/p)+c+b},elasticBoth:function(t,b,c,d,a,p){if(t==0||(t/=d/2)==2){return t==0?b:b+c}p=p||d*(.3*1.5);
var s;if(a>=abs(c)){s=p/(2*pi)*asin(c/a)}else{a=c;s=p/4}return t<1?-.5*(a*pow(2,10*(t-=1))*sin((t*d-s)*(2*pi)/p))+b:a*pow(2,-10*(t-=1))*sin((t*d-s)*(2*pi)/p)*.5+c+b},backIn:function(t,b,c,d,s){s=s||1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},backOut:function(t,b,c,d,s){if(!s){s=1.70158}return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},backBoth:function(t,b,c,d,s){s=s||1.70158;return(t/=d/2)<1?c/2*(t*t*(((s*=1.525)+1)*t-s))+b:c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b},bounceIn:function(t,b,c,d){return c-EXTLIB.Easing.bounceOut(d-t,0,c,d)+b},bounceOut:function(t,b,c,d){if((t/=d)<1/2.75){return c*(7.5625*t*t)+b}else if(t<2/2.75){return c*(7.5625*(t-=1.5/2.75)*t+.75)+b}else if(t<2.5/2.75){return c*(7.5625*(t-=2.25/2.75)*t+.9375)+b}return c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},bounceBoth:function(t,b,c,d){return t<d/2?EXTLIB.Easing.bounceIn(t*2,0,c,d)*.5+b:EXTLIB.Easing.bounceOut(t*2-d,0,c,d)*.5+c*.5+b}})})();(function(){var EXTLIB=Ext.lib;EXTLIB.Anim.color=function(el,args,duration,easing,cb,scope){return EXTLIB.Anim.run(el,args,duration,easing,cb,scope,EXTLIB.ColorAnim)};EXTLIB.ColorAnim=function(el,attributes,duration,method){EXTLIB.ColorAnim.superclass.constructor.call(this,el,attributes,duration,method)};Ext.extend(EXTLIB.ColorAnim,EXTLIB.AnimBase);var superclass=EXTLIB.ColorAnim.superclass,colorRE=/color$/i,transparentRE=/^transparent|rgba\(0, 0, 0, 0\)$/,rgbRE=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,hexRE=/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,hex3RE=/^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i,isset=function(v){return typeof v!=="undefined"};function parseColor(s){var pi=parseInt,base,out=null,c;if(s.length==3){return s}Ext.each([hexRE,rgbRE,hex3RE],function(re,idx){base=idx%2==0?16:10;c=re.exec(s);if(c&&c.length==4){out=[pi(c[1],base),pi(c[2],base),pi(c[3],base)];return false}});return out}Ext.apply(EXTLIB.ColorAnim.prototype,{getAttr:function(attr){var me=this,el=me.el,val;if(colorRE.test(attr)){while(el&&transparentRE.test(val=Ext.fly(el).getStyle(attr))){el=el.parentNode;val="fff"}}else{val=superclass.getAttr.call(me,attr)}return val},doMethod:function(attr,start,end){var me=this,val,floor=Math.floor,i,len,v;if(colorRE.test(attr)){val=[];for(i=0,len=start.length;i<len;i++){v=start[i];val[i]=superclass.doMethod.call(me,attr,v,end[i])}val="rgb("+floor(val[0])+","+floor(val[1])+","+floor(val[2])+")"}else{val=superclass.doMethod.call(me,attr,start,end)}return val},setRunAttr:function(attr){var me=this,a=me.attributes[attr],to=a.to,by=a.by,ra;superclass.setRunAttr.call(me,attr);ra=me.runAttrs[attr];if(colorRE.test(attr)){var start=parseColor(ra.start),end=parseColor(ra.end);if(!isset(to)&&isset(by)){end=parseColor(by);for(var i=0,len=start.length;i<len;i++){end[i]=start[i]+end[i]}}ra.start=start;ra.end=end}}})})();(function(){var EXTLIB=Ext.lib;EXTLIB.Anim.scroll=function(el,args,duration,easing,cb,scope){return EXTLIB.Anim.run(el,args,duration,easing,cb,scope,EXTLIB.Scroll)};EXTLIB.Scroll=function(el,attributes,duration,method){if(el){EXTLIB.Scroll.superclass.constructor.call(this,el,attributes,duration,method)}};Ext.extend(EXTLIB.Scroll,EXTLIB.ColorAnim);var superclass=EXTLIB.Scroll.superclass,SCROLL="scroll";Ext.apply(EXTLIB.Scroll.prototype,{doMethod:function(attr,start,end){var val,me=this,curFrame=me.curFrame,totalFrames=me.totalFrames;if(attr==SCROLL){val=[me.method(curFrame,start[0],end[0]-start[0],totalFrames),me.method(curFrame,start[1],end[1]-start[1],totalFrames)]}else{val=superclass.doMethod.call(me,attr,start,end)}return val},getAttr:function(attr){var me=this;if(attr==SCROLL){return[me.el.scrollLeft,me.el.scrollTop]}else{return superclass.getAttr.call(me,attr)}},setAttr:function(attr,val,unit){var me=this;if(attr==SCROLL){me.el.scrollLeft=val[0];me.el.scrollTop=val[1]}else{superclass.setAttr.call(me,attr,val,unit)}}})})();if(Ext.isIE){function fnCleanUp(){var p=Function.prototype;delete p.createSequence;delete p.defer;delete p.createDelegate;delete p.createCallback;delete p.createInterceptor;window.detachEvent("onunload",fnCleanUp)}window.attachEvent("onunload",fnCleanUp)}})();(function(){var EXTUTIL=Ext.util,TOARRAY=Ext.toArray,EACH=Ext.each,ISOBJECT=Ext.isObject,TRUE=true,FALSE=false;EXTUTIL.Observable=function(){var me=this,e=me.events;if(me.listeners){me.on(me.listeners);delete me.listeners}me.events=e||{}};EXTUTIL.Observable.prototype={filterOptRe:/^(?:scope|delay|buffer|single)$/,fireEvent:function(){var a=TOARRAY(arguments),ename=a[0].toLowerCase(),me=this,ret=TRUE,ce=me.events[ename],q,c;if(me.eventsSuspended===TRUE){if(q=me.eventQueue){q.push(a)}}else if(ISOBJECT(ce)&&ce.bubble){if(ce.fire.apply(ce,a.slice(1))===FALSE){return FALSE}c=me.getBubbleTarget&&me.getBubbleTarget();if(c&&c.enableBubble){if(!c.events[ename]||!Ext.isObject(c.events[ename])||!c.events[ename].bubble){c.enableBubble(ename)}return c.fireEvent.apply(c,a)}}else{if(ISOBJECT(ce)){a.shift();ret=ce.fire.apply(ce,a)}}return ret},addListener:function(eventName,fn,scope,o){var me=this,e,oe,isF,ce;if(ISOBJECT(eventName)){o=eventName;for(e in o){oe=o[e];if(!me.filterOptRe.test(e)){me.addListener(e,oe.fn||oe,oe.scope||o.scope,oe.fn?oe:o)}}}else{eventName=eventName.toLowerCase();ce=me.events[eventName]||TRUE;if(Ext.isBoolean(ce)){me.events[eventName]=ce=new EXTUTIL.Event(me,eventName)}ce.addListener(fn,scope,ISOBJECT(o)?o:{})}},removeListener:function(eventName,fn,scope){var ce=this.events[eventName.toLowerCase()];if(ISOBJECT(ce)){ce.removeListener(fn,scope)}},purgeListeners:function(){var events=this.events,evt,key;for(key in events){evt=events[key];if(ISOBJECT(evt)){evt.clearListeners()}}},addEvents:function(o){var me=this;me.events=me.events||{};if(Ext.isString(o)){var a=arguments,i=a.length;while(i--){me.events[a[i]]=me.events[a[i]]||TRUE}}else{Ext.applyIf(me.events,o)}},hasListener:function(eventName){var e=this.events[eventName];return ISOBJECT(e)&&e.listeners.length>0},suspendEvents:function(queueSuspended){this.eventsSuspended=TRUE;if(queueSuspended&&!this.eventQueue){this.eventQueue=[]}},resumeEvents:function(){var me=this,queued=me.eventQueue||[];me.eventsSuspended=FALSE;delete me.eventQueue;EACH(queued,function(e){me.fireEvent.apply(me,e)})}};var OBSERVABLE=EXTUTIL.Observable.prototype;OBSERVABLE.on=OBSERVABLE.addListener;OBSERVABLE.un=OBSERVABLE.removeListener;EXTUTIL.Observable.releaseCapture=function(o){o.fireEvent=OBSERVABLE.fireEvent};function createTargeted(h,o,scope){return function(){if(o.target==arguments[0]){h.apply(scope,TOARRAY(arguments))}}}function createBuffered(h,o,l,scope){l.task=new EXTUTIL.DelayedTask;return function(){l.task.delay(o.buffer,h,scope,TOARRAY(arguments))}}function createSingle(h,e,fn,scope){return function(){e.removeListener(fn,scope);return h.apply(scope,arguments)}}function createDelayed(h,o,l,scope){return function(){var task=new EXTUTIL.DelayedTask;if(!l.tasks){l.tasks=[]}l.tasks.push(task);task.delay(o.delay||10,h,scope,TOARRAY(arguments))}}EXTUTIL.Event=function(obj,name){this.name=name;this.obj=obj;this.listeners=[]};EXTUTIL.Event.prototype={addListener:function(fn,scope,options){var me=this,l;scope=scope||me.obj;if(!me.isListening(fn,scope)){l=me.createListener(fn,scope,options);if(me.firing){me.listeners=me.listeners.slice(0)}me.listeners.push(l)}},createListener:function(fn,scope,o){o=o||{},scope=scope||this.obj;var l={fn:fn,scope:scope,options:o},h=fn;if(o.target){h=createTargeted(h,o,scope)}if(o.delay){h=createDelayed(h,o,l,scope)}if(o.single){h=createSingle(h,this,fn,scope)}if(o.buffer){h=createBuffered(h,o,l,scope)}l.fireFn=h;return l},findListener:function(fn,scope){var list=this.listeners,i=list.length,l,s;while(i--){l=list[i];if(l){s=l.scope;if(l.fn==fn&&(s==scope||s==this.obj)){return i}}}return-1},isListening:function(fn,scope){return this.findListener(fn,scope)!=-1},removeListener:function(fn,scope){var index,l,k,me=this,ret=FALSE;if((index=me.findListener(fn,scope))!=-1){if(me.firing){me.listeners=me.listeners.slice(0)}l=me.listeners[index];if(l.task){l.task.cancel();delete l.task}k=l.tasks&&l.tasks.length;if(k){while(k--){l.tasks[k].cancel()}delete l.tasks}me.listeners.splice(index,1);ret=TRUE}return ret},clearListeners:function(){var me=this,l=me.listeners,i=l.length;while(i--){me.removeListener(l[i].fn,l[i].scope)}},fire:function(){var me=this,args=TOARRAY(arguments),listeners=me.listeners,len=listeners.length,i=0,l;if(len>0){me.firing=TRUE;for(;i<len;i++){l=listeners[i];if(l&&l.fireFn.apply(l.scope||me.obj||window,args)===FALSE){return me.firing=FALSE}}}me.firing=FALSE;return TRUE}}})();Ext.DomHelper=function(){var tempTableEl=null,emptyTags=/^(?:br|frame|hr|img|input|link|meta|range|spacer|wbr|area|param|col)$/i,tableRe=/^table|tbody|tr|td$/i,pub,afterbegin="afterbegin",afterend="afterend",beforebegin="beforebegin",beforeend="beforeend",ts="<table>",te="</table>",tbs=ts+"<tbody>",tbe="</tbody>"+te,trs=tbs+"<tr>",tre="</tr>"+tbe;function doInsert(el,o,returnElement,pos,sibling,append){var newNode=pub.insertHtml(pos,Ext.getDom(el),createHtml(o));return returnElement?Ext.get(newNode,true):newNode}function createHtml(o){var b="",attr,val,key,keyVal,cn;if(Ext.isString(o)){b=o}else if(Ext.isArray(o)){for(var i=0;i<o.length;i++){if(o[i]){b+=createHtml(o[i])}}}else{b+="<"+(o.tag=o.tag||"div");Ext.iterate(o,function(attr,val){if(!/tag|children|cn|html$/i.test(attr)){if(Ext.isObject(val)){b+=" "+attr+'="';Ext.iterate(val,function(key,keyVal){b+=key+":"+keyVal+";"});b+='"'}else{b+=" "+({cls:"class",htmlFor:"for"}[attr]||attr)+'="'+val+'"'}}});if(emptyTags.test(o.tag)){b+="/>"}else{b+=">";if(cn=o.children||o.cn){b+=createHtml(cn)}else if(o.html){b+=o.html}b+="</"+o.tag+">"}}return b}function ieTable(depth,s,h,e){tempTableEl.innerHTML=[s,h,e].join("");var i=-1,el=tempTableEl,ns;while(++i<depth){el=el.firstChild}if(ns=el.nextSibling){var df=document.createDocumentFragment();while(el){ns=el.nextSibling;df.appendChild(el);el=ns}el=df}return el}function insertIntoTable(tag,where,el,html){var node,before;tempTableEl=tempTableEl||document.createElement("div");if(tag=="td"&&(where==afterbegin||where==beforeend)||!/td|tr|tbody/i.test(tag)&&(where==beforebegin||where==afterend)){return}before=where==beforebegin?el:where==afterend?el.nextSibling:where==afterbegin?el.firstChild:null;if(where==beforebegin||where==afterend){el=el.parentNode}if(tag=="td"||tag=="tr"&&(where==beforeend||where==afterbegin)){node=ieTable(4,trs,html,tre)}else if(tag=="tbody"&&(where==beforeend||where==afterbegin)||tag=="tr"&&(where==beforebegin||where==afterend)){node=ieTable(3,tbs,html,tbe)}else{node=ieTable(2,ts,html,te)}el.insertBefore(node,before);return node}pub={markup:function(o){return createHtml(o)},applyStyles:function(el,styles){if(styles){var i=0,len,style;el=Ext.fly(el);if(Ext.isFunction(styles)){styles=styles.call()}if(Ext.isString(styles)){styles=styles.trim().split(/\s*(?::|;)\s*/);for(len=styles.length;i<len;){el.setStyle(styles[i++],styles[i++])}}else if(Ext.isObject(styles)){el.setStyle(styles)}}},insertHtml:function(where,el,html){var hash={},hashVal,setStart,range,frag,rangeEl,rs;where=where.toLowerCase();hash[beforebegin]=["BeforeBegin","previousSibling"];hash[afterend]=["AfterEnd","nextSibling"];if(el.insertAdjacentHTML){if(tableRe.test(el.tagName)&&(rs=insertIntoTable(el.tagName.toLowerCase(),where,el,html))){return rs}hash[afterbegin]=["AfterBegin","firstChild"];hash[beforeend]=["BeforeEnd","lastChild"];if(hashVal=hash[where]){el.insertAdjacentHTML(hashVal[0],html);return el[hashVal[1]]}}else{range=el.ownerDocument.createRange();setStart="setStart"+(/end/i.test(where)?"After":"Before");if(hash[where]){range[setStart](el);frag=range.createContextualFragment(html);el.parentNode.insertBefore(frag,where==beforebegin?el:el.nextSibling);return el[(where==beforebegin?"previous":"next")+"Sibling"]}else{rangeEl=(where==afterbegin?"first":"last")+"Child";if(el.firstChild){range[setStart](el[rangeEl]);frag=range.createContextualFragment(html);if(where==afterbegin){el.insertBefore(frag,el.firstChild)}else{el.appendChild(frag)}}else{el.innerHTML=html}return el[rangeEl]}}throw'Illegal insertion point -> "'+where+'"'},insertBefore:function(el,o,returnElement){return doInsert(el,o,returnElement,beforebegin)},insertAfter:function(el,o,returnElement){return doInsert(el,o,returnElement,afterend,"nextSibling")},insertFirst:function(el,o,returnElement){return doInsert(el,o,returnElement,afterbegin,"firstChild")},append:function(el,o,returnElement){return doInsert(el,o,returnElement,beforeend,"",true)},overwrite:function(el,o,returnElement){el=Ext.getDom(el);el.innerHTML=createHtml(o);return returnElement?Ext.get(el.firstChild):el.firstChild},createHtml:createHtml};return pub}();Ext.Template=function(html){var me=this,a=arguments,buf=[];if(Ext.isArray(html)){html=html.join("")}else if(a.length>1){Ext.each(a,function(v){if(Ext.isObject(v)){Ext.apply(me,v)}else{buf.push(v)}});html=buf.join("")}me.html=html;if(me.compiled){me.compile()}};Ext.Template.prototype={re:/\{([\w-]+)\}/g,applyTemplate:function(values){var me=this;return me.compiled?me.compiled(values):me.html.replace(me.re,function(m,name){return values[name]!==undefined?values[name]:""})},set:function(html,compile){var me=this;me.html=html;me.compiled=null;return compile?me.compile():me},compile:function(){var me=this,sep=Ext.isGecko?"+":",";function fn(m,name){name="values['"+name+"']";return"'"+sep+"("+name+" == undefined ? '' : "+name+")"+sep+"'"}eval("this.compiled = function(values){ return "+(Ext.isGecko?"'":"['")+me.html.replace(/\\/g,"\\\\").replace(/(\r\n|\n)/g,"\\n").replace(/'/g,"\\'").replace(this.re,fn)+(Ext.isGecko?"';};":"'].join('');};"));return me},insertFirst:function(el,values,returnElement){return this.doInsert("afterBegin",el,values,returnElement)},insertBefore:function(el,values,returnElement){return this.doInsert("beforeBegin",el,values,returnElement)},insertAfter:function(el,values,returnElement){return this.doInsert("afterEnd",el,values,returnElement)},append:function(el,values,returnElement){return this.doInsert("beforeEnd",el,values,returnElement)},doInsert:function(where,el,values,returnEl){el=Ext.getDom(el);var newNode=Ext.DomHelper.insertHtml(where,el,this.applyTemplate(values));return returnEl?Ext.get(newNode,true):newNode},overwrite:function(el,values,returnElement){el=Ext.getDom(el);el.innerHTML=this.applyTemplate(values);return returnElement?Ext.get(el.firstChild,true):el.firstChild}};Ext.Template.prototype.apply=Ext.Template.prototype.applyTemplate;Ext.Template.from=function(el,config){el=Ext.getDom(el);return new Ext.Template(el.value||el.innerHTML,config||"")};Ext.DomQuery=function(){var cache={},simpleCache={},valueCache={},nonSpace=/\S/,trimRe=/^\s+|\s+$/g,tplRe=/\{(\d+)\}/g,modeRe=/^(\s?[\/>+~]\s?|\s|$)/,tagTokenRe=/^(#)?([\w-\*]+)/,nthRe=/(\d*)n\+?(\d*)/,nthRe2=/\D/,isIE=window.ActiveXObject?true:false,key=30803;eval("var batch = 30803;");function child(p,index){var i=0,n=p.firstChild;while(n){if(n.nodeType==1){if(++i==index){return n}}n=n.nextSibling}return null}function next(n){while((n=n.nextSibling)&&n.nodeType!=1);return n}function prev(n){while((n=n.previousSibling)&&n.nodeType!=1);return n}function children(d){var n=d.firstChild,ni=-1,nx;while(n){nx=n.nextSibling;if(n.nodeType==3&&!nonSpace.test(n.nodeValue)){d.removeChild(n)}else{n.nodeIndex=++ni}n=nx}return this}function byClassName(c,a,v){if(!v){return c}var r=[],ri=-1,cn;for(var i=0,ci;ci=c[i];i++){if((" "+ci.className+" ").indexOf(v)!=-1){r[++ri]=ci}}return r}function attrValue(n,attr){if(!n.tagName&&typeof n.length!="undefined"){n=n[0]}if(!n){return null}if(attr=="for"){return n.htmlFor}if(attr=="class"||attr=="className"){return n.className}return n.getAttribute(attr)||n[attr]}function getNodes(ns,mode,tagName){var result=[],ri=-1,cs;if(!ns){return result}tagName=tagName||"*";if(typeof ns.getElementsByTagName!="undefined"){ns=[ns]}if(!mode){for(var i=0,ni;ni=ns[i];i++){cs=ni.getElementsByTagName(tagName);for(var j=0,ci;ci=cs[j];j++){result[++ri]=ci}}}else if(mode=="/"||mode==">"){var utag=tagName.toUpperCase();for(var i=0,ni,cn;ni=ns[i];i++){cn=ni.childNodes;for(var j=0,cj;cj=cn[j];j++){if(cj.nodeName==utag||cj.nodeName==tagName||tagName=="*"){result[++ri]=cj}}}}else if(mode=="+"){var utag=tagName.toUpperCase();for(var i=0,n;n=ns[i];i++){while((n=n.nextSibling)&&n.nodeType!=1);if(n&&(n.nodeName==utag||n.nodeName==tagName||tagName=="*")){result[++ri]=n}}}else if(mode=="~"){var utag=tagName.toUpperCase();for(var i=0,n;n=ns[i];i++){while(n=n.nextSibling){if(n.nodeName==utag||n.nodeName==tagName||tagName=="*"){result[++ri]=n}}}}return result}function concat(a,b){if(b.slice){return a.concat(b)}for(var i=0,l=b.length;i<l;i++){a[a.length]=b[i]}return a}function byTag(cs,tagName){if(cs.tagName||cs==document){cs=[cs]}if(!tagName){return cs}var r=[],ri=-1;tagName=tagName.toLowerCase();for(var i=0,ci;ci=cs[i];i++){if(ci.nodeType==1&&ci.tagName.toLowerCase()==tagName){r[++ri]=ci}}return r}function byId(cs,attr,id){if(cs.tagName||cs==document){cs=[cs]}if(!id){return cs}var r=[],ri=-1;for(var i=0,ci;ci=cs[i];i++){if(ci&&ci.id==id){r[++ri]=ci;return r}}return r}function byAttribute(cs,attr,value,op,custom){var r=[],ri=-1,st=custom=="{",f=Ext.DomQuery.operators[op],a,ih;for(var i=0,ci;ci=cs[i];i++){if(ci.nodeType!=1){continue}ih=ci.innerHTML;if(ih!==null&&ih!==undefined){if(st){a=Ext.DomQuery.getStyle(ci,attr)}else if(attr=="class"||attr=="className"){a=ci.className}else if(attr=="for"){a=ci.htmlFor}else if(attr=="href"){a=ci.getAttribute("href",2)}else{a=ci.getAttribute(attr)}}else{a=ci.getAttribute(attr)}if(f&&f(a,value)||!f&&a){r[++ri]=ci}}return r}function byPseudo(cs,name,value){return Ext.DomQuery.pseudos[name](cs,value)}function nodupIEXml(cs){var d=++key,r;cs[0].setAttribute("_nodup",d);r=[cs[0]];for(var i=1,len=cs.length;i<len;i++){var c=cs[i];if(!c.getAttribute("_nodup")!=d){c.setAttribute("_nodup",d);r[r.length]=c}}for(var i=0,len=cs.length;i<len;i++){cs[i].removeAttribute("_nodup")}return r}function nodup(cs){if(!cs){return[]}var len=cs.length,c,i,r=cs,cj,ri=-1;if(!len||typeof cs.nodeType!="undefined"||len==1){return cs}if(isIE&&typeof cs[0].selectSingleNode!="undefined"){return nodupIEXml(cs)}var d=++key;cs[0]._nodup=d;for(i=1;c=cs[i];i++){if(c._nodup!=d){c._nodup=d}else{r=[];for(var j=0;j<i;j++){r[++ri]=cs[j]}for(j=i+1;cj=cs[j];j++){if(cj._nodup!=d){cj._nodup=d;r[++ri]=cj}}return r}}return r}function quickDiffIEXml(c1,c2){var d=++key,r=[];for(var i=0,len=c1.length;i<len;i++){c1[i].setAttribute("_qdiff",d)}for(var i=0,len=c2.length;i<len;i++){if(c2[i].getAttribute("_qdiff")!=d){r[r.length]=c2[i]}}for(var i=0,len=c1.length;i<len;i++){c1[i].removeAttribute("_qdiff")}return r}function quickDiff(c1,c2){var len1=c1.length,d=++key,r=[];if(!len1){return c2}if(isIE&&typeof c1[0].selectSingleNode!="undefined"){return quickDiffIEXml(c1,c2)}for(var i=0;i<len1;i++){c1[i]._qdiff=d}for(var i=0,len=c2.length;i<len;i++){if(c2[i]._qdiff!=d){r[r.length]=c2[i]}}return r}function quickId(ns,mode,root,id){if(ns==root){var d=root.ownerDocument||root;return d.getElementById(id)}ns=getNodes(ns,mode,"*");return byId(ns,null,id)}return{getStyle:function(el,name){return Ext.fly(el).getStyle(name)},compile:function(path,type){type=type||"select";var fn=["var f = function(root){\n var mode; ++batch; var n = root || document;\n"],q=path,mode,lq,tk=Ext.DomQuery.matchers,tklen=tk.length,mm,lmode=q.match(modeRe);if(lmode&&lmode[1]){fn[fn.length]='mode="'+lmode[1].replace(trimRe,"")+'";';q=q.replace(lmode[1],"")}while(path.substr(0,1)=="/"){path=path.substr(1)}while(q&&lq!=q){lq=q;var tm=q.match(tagTokenRe);if(type=="select"){if(tm){if(tm[1]=="#"){fn[fn.length]='n = quickId(n, mode, root, "'+tm[2]+'");'}else{fn[fn.length]='n = getNodes(n, mode, "'+tm[2]+'");'}q=q.replace(tm[0],"")}else if(q.substr(0,1)!="@"){fn[fn.length]='n = getNodes(n, mode, "*");'}}else{if(tm){if(tm[1]=="#"){fn[fn.length]='n = byId(n, null, "'+tm[2]+'");'}else{fn[fn.length]='n = byTag(n, "'+tm[2]+'");'}q=q.replace(tm[0],"")}}while(!(mm=q.match(modeRe))){var matched=false;for(var j=0;j<tklen;j++){var t=tk[j];var m=q.match(t.re);if(m){fn[fn.length]=t.select.replace(tplRe,function(x,i){return m[i]});q=q.replace(m[0],"");matched=true;break}}if(!matched){throw'Error parsing selector, parsing failed at "'+q+'"'}}if(mm[1]){fn[fn.length]='mode="'+mm[1].replace(trimRe,"")+'";';q=q.replace(mm[1],"")}}fn[fn.length]="return nodup(n);\n}";eval(fn.join(""));return f},select:function(path,root,type){if(!root||root==document){root=document}if(typeof root=="string"){root=document.getElementById(root)}var paths=path.split(","),results=[];for(var i=0,len=paths.length;i<len;i++){var p=paths[i].replace(trimRe,"");if(!cache[p]){cache[p]=Ext.DomQuery.compile(p);if(!cache[p]){throw p+" is not a valid selector"}}var result=cache[p](root);if(result&&result!=document){results=results.concat(result)}}if(paths.length>1){return nodup(results)}return results},selectNode:function(path,root){return Ext.DomQuery.select(path,root)[0]},selectValue:function(path,root,defaultValue){path=path.replace(trimRe,"");if(!valueCache[path]){valueCache[path]=Ext.DomQuery.compile(path,"select")}var n=valueCache[path](root),v;n=n[0]?n[0]:n;if(typeof n.normalize=="function")n.normalize();v=n&&n.firstChild?n.firstChild.nodeValue:null;return v===null||v===undefined||v===""?defaultValue:v},selectNumber:function(path,root,defaultValue){var v=Ext.DomQuery.selectValue(path,root,defaultValue||0);return parseFloat(v)},is:function(el,ss){if(typeof el=="string"){el=document.getElementById(el)}var isArray=Ext.isArray(el),result=Ext.DomQuery.filter(isArray?el:[el],ss);return isArray?result.length==el.length:result.length>0},filter:function(els,ss,nonMatches){ss=ss.replace(trimRe,"");if(!simpleCache[ss]){simpleCache[ss]=Ext.DomQuery.compile(ss,"simple")}var result=simpleCache[ss](els);return nonMatches?quickDiff(result,els):result},matchers:[{re:/^\.([\w-]+)/,select:'n = byClassName(n, null, " {1} ");'},{re:/^\:([\w-]+)(?:\(((?:[^\s>\/]*|.*?))\))?/,select:'n = byPseudo(n, "{1}", "{2}");'},{re:/^(?:([\[\{])(?:@)?([\w-]+)\s?(?:(=|.=)\s?['"]?(.*?)["']?)?[\]\}])/,select:'n = byAttribute(n, "{2}", "{4}", "{3}", "{1}");'},{re:/^#([\w-]+)/,select:'n = byId(n, null, "{1}");'},{re:/^@([\w-]+)/,select:'return {firstChild:{nodeValue:attrValue(n, "{1}")}};'}],operators:{"=":function(a,v){return a==v},"!=":function(a,v){return a!=v},"^=":function(a,v){return a&&a.substr(0,v.length)==v},"$=":function(a,v){return a&&a.substr(a.length-v.length)==v},"*=":function(a,v){return a&&a.indexOf(v)!==-1},"%=":function(a,v){return a%v==0},"|=":function(a,v){return a&&(a==v||a.substr(0,v.length+1)==v+"-")},"~=":function(a,v){return a&&(" "+a+" ").indexOf(" "+v+" ")!=-1}},pseudos:{"first-child":function(c){var r=[],ri=-1,n;for(var i=0,ci;ci=n=c[i];i++){while((n=n.previousSibling)&&n.nodeType!=1);if(!n){r[++ri]=ci}}return r},"last-child":function(c){var r=[],ri=-1,n;for(var i=0,ci;ci=n=c[i];i++){while((n=n.nextSibling)&&n.nodeType!=1);if(!n){r[++ri]=ci}}return r},"nth-child":function(c,a){var r=[],ri=-1,m=nthRe.exec(a=="even"&&"2n"||a=="odd"&&"2n+1"||!nthRe2.test(a)&&"n+"+a||a),f=(m[1]||1)-0,l=m[2]-0;for(var i=0,n;n=c[i];i++){var pn=n.parentNode;if(batch!=pn._batch){var j=0;for(var cn=pn.firstChild;cn;cn=cn.nextSibling){if(cn.nodeType==1){cn.nodeIndex=++j}}pn._batch=batch}if(f==1){if(l==0||n.nodeIndex==l){r[++ri]=n}}else if((n.nodeIndex+l)%f==0){r[++ri]=n}}return r},"only-child":function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(!prev(ci)&&!next(ci)){r[++ri]=ci}}return r},empty:function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var cns=ci.childNodes,j=0,cn,empty=true;while(cn=cns[j]){++j;if(cn.nodeType==1||cn.nodeType==3){empty=false;break}}if(empty){r[++ri]=ci}}return r},contains:function(c,v){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if((ci.textContent||ci.innerText||"").indexOf(v)!=-1){r[++ri]=ci}}return r},nodeValue:function(c,v){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(ci.firstChild&&ci.firstChild.nodeValue==v){r[++ri]=ci}}return r},checked:function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(ci.checked==true){r[++ri]=ci}}return r},not:function(c,ss){return Ext.DomQuery.filter(c,ss,true)},any:function(c,selectors){var ss=selectors.split("|"),r=[],ri=-1,s;for(var i=0,ci;ci=c[i];i++){for(var j=0;s=ss[j];j++){if(Ext.DomQuery.is(ci,s)){r[++ri]=ci;break}}}return r},odd:function(c){return this["nth-child"](c,"odd")},even:function(c){return this["nth-child"](c,"even")},nth:function(c,a){return c[a-1]||[]},first:function(c){return c[0]||[]},last:function(c){return c[c.length-1]||[]},has:function(c,ss){var s=Ext.DomQuery.select,r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(s(ss,ci).length>0){r[++ri]=ci}}return r},next:function(c,ss){var is=Ext.DomQuery.is,r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var n=next(ci);if(n&&is(n,ss)){r[++ri]=ci}}return r},prev:function(c,ss){var is=Ext.DomQuery.is,r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var n=prev(ci);if(n&&is(n,ss)){r[++ri]=ci}}return r}}}}();Ext.query=Ext.DomQuery.select;Ext.EventManager=function(){var docReadyEvent,docReadyProcId,docReadyState=false,E=Ext.lib.Event,D=Ext.lib.Dom,DOC=document,WINDOW=window,IEDEFERED="ie-deferred-loader",DOMCONTENTLOADED="DOMContentLoaded",propRe=/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate)$/,specialElCache=[];function getId(el){var id=false,i=0,len=specialElCache.length,id=false,skip=false,o;if(el){if(el.getElementById||el.navigator){for(;i<len;++i){o=specialElCache[i];if(o.el===el){id=o.id;break}}if(!id){id=Ext.id(el);specialElCache.push({id:id,el:el});skip=true}}else{id=Ext.id(el)}if(!Ext.elCache[id]){Ext.Element.addToCache(new Ext.Element(el),id);if(skip){Ext.elCache[id].skipGC=true}}}return id}function addListener(el,ename,fn,task,wrap,scope){el=Ext.getDom(el);var id=getId(el),es=Ext.elCache[id].events,wfn;wfn=E.on(el,ename,wrap);es[ename]=es[ename]||[];es[ename].push([fn,wrap,scope,wfn,task]);if(ename=="mousewheel"&&el.addEventListener){var args=["DOMMouseScroll",wrap,false];el.addEventListener.apply(el,args);Ext.EventManager.addListener(WINDOW,"unload",function(){el.removeEventListener.apply(el,args)})}if(ename=="mousedown"&&el==document){Ext.EventManager.stoppedMouseDownEvent.addListener(wrap)}}function fireDocReady(){if(!docReadyState){Ext.isReady=docReadyState=true;if(docReadyProcId){clearInterval(docReadyProcId)}if(Ext.isGecko||Ext.isOpera){DOC.removeEventListener(DOMCONTENTLOADED,fireDocReady,false)}if(Ext.isIE){var defer=DOC.getElementById(IEDEFERED);if(defer){defer.onreadystatechange=null;defer.parentNode.removeChild(defer)}}if(docReadyEvent){docReadyEvent.fire();docReadyEvent.listeners=[]}}}function initDocReady(){var COMPLETE="complete";docReadyEvent=new Ext.util.Event;if(Ext.isGecko||Ext.isOpera){DOC.addEventListener(DOMCONTENTLOADED,fireDocReady,false)}else if(Ext.isIE){var s=DOC.createElement("script");s.setAttribute("defer","defer");s.setAttribute("src","//:");DOC.getElementsByTagName("head")[0].appendChild(s);s.onreadystatechange=function(){if(this.readyState==COMPLETE){fireDocReady()}}}else if(Ext.isWebKit){docReadyProcId=setInterval(function(){if(DOC.readyState==COMPLETE){fireDocReady()}},10)}E.on(WINDOW,"load",fireDocReady)}function createTargeted(h,o){return function(){var args=Ext.toArray(arguments);if(o.target==Ext.EventObject.setEvent(args[0]).target){h.apply(this,args)}}}function createBuffered(h,o,task){return function(e){task.delay(o.buffer,h,null,[new Ext.EventObjectImpl(e)])}}function createSingle(h,el,ename,fn,scope){return function(e){Ext.EventManager.removeListener(el,ename,fn,scope);h(e)}}function createDelayed(h,o,fn){return function(e){var task=new Ext.util.DelayedTask(h);if(!fn.tasks){fn.tasks=[]}fn.tasks.push(task);task.delay(o.delay||10,h,null,[new Ext.EventObjectImpl(e)])}}function listen(element,ename,opt,fn,scope){var o=!Ext.isObject(opt)?{}:opt,el=Ext.getDom(element),task;fn=fn||o.fn;scope=scope||o.scope;if(!el){throw'Error listening for "'+ename+'". Element "'+element+"\" doesn't exist."}function h(e){if(!Ext){return}e=Ext.EventObject.setEvent(e);var t;if(o.delegate){if(!(t=e.getTarget(o.delegate,el))){return}}else{t=e.target}if(o.stopEvent){e.stopEvent()}if(o.preventDefault){e.preventDefault()}if(o.stopPropagation){e.stopPropagation()}if(o.normalized){e=e.browserEvent}fn.call(scope||el,e,t,o)}if(o.target){h=createTargeted(h,o)}if(o.delay){h=createDelayed(h,o,fn)}if(o.single){h=createSingle(h,el,ename,fn,scope)}if(o.buffer){task=new Ext.util.DelayedTask(h);h=createBuffered(h,o,task)}addListener(el,ename,fn,task,h,scope);return h}var pub={addListener:function(element,eventName,fn,scope,options){if(Ext.isObject(eventName)){var o=eventName,e,val;for(e in o){val=o[e];if(!propRe.test(e)){if(Ext.isFunction(val)){listen(element,e,o,val,o.scope)}else{listen(element,e,val)}}}}else{listen(element,eventName,options,fn,scope)}},removeListener:function(el,eventName,fn,scope){el=Ext.getDom(el);var id=getId(el),f=el&&Ext.elCache[id].events[eventName]||[],wrap,i,l,k,wf,len,fnc;for(i=0,len=f.length;i<len;i++){if(Ext.isArray(fnc=f[i])&&fnc[0]==fn&&(!scope||fnc[2]==scope)){if(fnc[4]){fnc[4].cancel()}k=fn.tasks&&fn.tasks.length;if(k){while(k--){fn.tasks[k].cancel()}delete fn.tasks}wf=wrap=fnc[1];if(E.extAdapter){wf=fnc[3]}E.un(el,eventName,wf);f.splice(i,1);if(f.length===0){delete Ext.elCache[id].events[eventName]}for(k in Ext.elCache[id].events){return false}Ext.elCache[id].events={};return false}}if(eventName=="mousewheel"&&el.addEventListener&&wrap){el.removeEventListener("DOMMouseScroll",wrap,false)}if(eventName=="mousedown"&&el==DOC&&wrap){Ext.EventManager.stoppedMouseDownEvent.removeListener(wrap)}},removeAll:function(el){el=Ext.getDom(el);var id=getId(el),ec=Ext.elCache[id]||{},es=ec.events||{},f,i,len,ename,fn,k;for(ename in es){if(es.hasOwnProperty(ename)){f=es[ename];for(i=0,len=f.length;i<len;i++){fn=f[i];if(fn[4]){fn[4].cancel()}if(fn[0].tasks&&(k=fn[0].tasks.length)){while(k--){fn[0].tasks[k].cancel()}delete fn.tasks}E.un(el,ename,E.extAdapter?fn[3]:fn[1])}}}if(Ext.elCache[id]){Ext.elCache[id].events={}}},getListeners:function(el,eventName){el=Ext.getDom(el);var id=getId(el),ec=Ext.elCache[id]||{},es=ec.events||{},results=[];if(es&&es[eventName]){return es[eventName]}else{return null}},purgeElement:function(el,recurse,eventName){el=Ext.getDom(el);var id=getId(el),ec=Ext.elCache[id]||{},es=ec.events||{},i,f,len;if(eventName){if(es&&es.hasOwnProperty(eventName)){f=es[eventName];for(i=0,len=f.length;i<len;i++){Ext.EventManager.removeListener(el,eventName,f[i][0])}}}else{Ext.EventManager.removeAll(el)}if(recurse&&el&&el.childNodes){for(i=0,len=el.childNodes.length;i<len;i++){Ext.EventManager.purgeElement(el.childNodes[i],recurse,eventName)}}},_unload:function(){var el;for(el in Ext.elCache){Ext.EventManager.removeAll(el)}},onDocumentReady:function(fn,scope,options){if(docReadyState){docReadyEvent.addListener(fn,scope,options);docReadyEvent.fire();docReadyEvent.listeners=[]}else{if(!docReadyEvent)initDocReady();options=options||{};options.delay=options.delay||1;docReadyEvent.addListener(fn,scope,options)}}};pub.on=pub.addListener;pub.un=pub.removeListener;pub.stoppedMouseDownEvent=new Ext.util.Event;return pub}();Ext.onReady=Ext.EventManager.onDocumentReady;(function(){var initExtCss=function(){var bd=document.body||document.getElementsByTagName("body")[0];if(!bd){return false}var cls=[" ",Ext.isIE?"ext-ie "+(Ext.isIE6?"ext-ie6":Ext.isIE7?"ext-ie7":"ext-ie8"):Ext.isGecko?"ext-gecko "+(Ext.isGecko2?"ext-gecko2":"ext-gecko3"):Ext.isOpera?"ext-opera":Ext.isWebKit?"ext-webkit":""];if(Ext.isSafari){cls.push("ext-safari "+(Ext.isSafari2?"ext-safari2":Ext.isSafari3?"ext-safari3":"ext-safari4"))}else if(Ext.isChrome){cls.push("ext-chrome")}if(Ext.isMac){cls.push("ext-mac")}if(Ext.isLinux){cls.push("ext-linux")}if(Ext.isStrict||Ext.isBorderBox){var p=bd.parentNode;if(p){p.className+=Ext.isStrict?" ext-strict":" ext-border-box"}}bd.className+=cls.join(" ");return true};if(!initExtCss()){Ext.onReady(initExtCss)}})();Ext.EventObject=function(){var E=Ext.lib.Event,safariKeys={3:13,63234:37,63235:39,63232:38,
63233:40,63276:33,63277:34,63272:46,63273:36,63275:35},btnMap=Ext.isIE?{1:0,4:1,2:2}:Ext.isWebKit?{1:0,2:1,3:2}:{0:0,1:1,2:2};Ext.EventObjectImpl=function(e){if(e){this.setEvent(e.browserEvent||e)}};Ext.EventObjectImpl.prototype={setEvent:function(e){var me=this;if(e==me||e&&e.browserEvent){return e}me.browserEvent=e;if(e){me.button=e.button?btnMap[e.button]:e.which?e.which-1:-1;if(e.type=="click"&&me.button==-1){me.button=0}me.type=e.type;me.shiftKey=e.shiftKey;me.ctrlKey=e.ctrlKey||e.metaKey||false;me.altKey=e.altKey;me.keyCode=e.keyCode;me.charCode=e.charCode;me.target=E.getTarget(e);me.xy=E.getXY(e)}else{me.button=-1;me.shiftKey=false;me.ctrlKey=false;me.altKey=false;me.keyCode=0;me.charCode=0;me.target=null;me.xy=[0,0]}return me},stopEvent:function(){var me=this;if(me.browserEvent){if(me.browserEvent.type=="mousedown"){Ext.EventManager.stoppedMouseDownEvent.fire(me)}E.stopEvent(me.browserEvent)}},preventDefault:function(){if(this.browserEvent){E.preventDefault(this.browserEvent)}},stopPropagation:function(){var me=this;if(me.browserEvent){if(me.browserEvent.type=="mousedown"){Ext.EventManager.stoppedMouseDownEvent.fire(me)}E.stopPropagation(me.browserEvent)}},getCharCode:function(){return this.charCode||this.keyCode},getKey:function(){return this.normalizeKey(this.keyCode||this.charCode)},normalizeKey:function(k){return Ext.isSafari?safariKeys[k]||k:k},getPageX:function(){return this.xy[0]},getPageY:function(){return this.xy[1]},getXY:function(){return this.xy},getTarget:function(selector,maxDepth,returnEl){return selector?Ext.fly(this.target).findParent(selector,maxDepth,returnEl):returnEl?Ext.get(this.target):this.target},getRelatedTarget:function(){return this.browserEvent?E.getRelatedTarget(this.browserEvent):null},getWheelDelta:function(){var e=this.browserEvent;var delta=0;if(e.wheelDelta){delta=e.wheelDelta/120}else if(e.detail){delta=-e.detail/3}return delta},within:function(el,related,allowEl){if(el){var t=this[related?"getRelatedTarget":"getTarget"]();return t&&((allowEl?t==Ext.getDom(el):false)||Ext.fly(el).contains(t))}return false}};return new Ext.EventObjectImpl}();(function(){var DOC=document;Ext.Element=function(element,forceNew){var dom=typeof element=="string"?DOC.getElementById(element):element,id;if(!dom)return null;id=dom.id;if(!forceNew&&id&&Ext.elCache[id]){return Ext.elCache[id].el}this.dom=dom;this.id=id||Ext.id(dom)};var D=Ext.lib.Dom,DH=Ext.DomHelper,E=Ext.lib.Event,A=Ext.lib.Anim,El=Ext.Element,EC=Ext.elCache;El.prototype={set:function(o,useSet){var el=this.dom,attr,val,useSet=useSet!==false&&!!el.setAttribute;for(attr in o){if(o.hasOwnProperty(attr)){val=o[attr];if(attr=="style"){DH.applyStyles(el,val)}else if(attr=="cls"){el.className=val}else if(useSet){el.setAttribute(attr,val)}else{el[attr]=val}}}return this},defaultUnit:"px",is:function(simpleSelector){return Ext.DomQuery.is(this.dom,simpleSelector)},focus:function(defer,dom){var me=this,dom=dom||me.dom;try{if(Number(defer)){me.focus.defer(defer,null,[null,dom])}else{dom.focus()}}catch(e){}return me},blur:function(){try{this.dom.blur()}catch(e){}return this},getValue:function(asNumber){var val=this.dom.value;return asNumber?parseInt(val,10):val},addListener:function(eventName,fn,scope,options){Ext.EventManager.on(this.dom,eventName,fn,scope||this,options);return this},removeListener:function(eventName,fn,scope){Ext.EventManager.removeListener(this.dom,eventName,fn,scope||this);return this},removeAllListeners:function(){Ext.EventManager.removeAll(this.dom);return this},purgeAllListeners:function(){Ext.EventManager.purgeElement(this,true);return this},addUnits:function(size){if(size===""||size=="auto"||size===undefined){size=size||""}else if(!isNaN(size)||!unitPattern.test(size)){size=size+(this.defaultUnit||"px")}return size},load:function(url,params,cb){Ext.Ajax.request(Ext.apply({params:params,url:url.url||url,callback:cb,el:this.dom,indicatorText:url.indicatorText||""},Ext.isObject(url)?url:{}));return this},isBorderBox:function(){return noBoxAdjust[(this.dom.tagName||"").toLowerCase()]||Ext.isBorderBox},remove:function(){var me=this,dom=me.dom;if(dom){delete me.dom;Ext.removeNode(dom)}},hover:function(overFn,outFn,scope,options){var me=this;me.on("mouseenter",overFn,scope||me.dom,options);me.on("mouseleave",outFn,scope||me.dom,options);return me},contains:function(el){return!el?false:Ext.lib.Dom.isAncestor(this.dom,el.dom?el.dom:el)},getAttributeNS:function(ns,name){return this.getAttribute(name,ns)},getAttribute:Ext.isIE?function(name,ns){var d=this.dom,type=typeof d[ns+":"+name];if(["undefined","unknown"].indexOf(type)==-1){return d[ns+":"+name]}return d[name]}:function(name,ns){var d=this.dom;return d.getAttributeNS(ns,name)||d.getAttribute(ns+":"+name)||d.getAttribute(name)||d[name]},update:function(html){if(this.dom){this.dom.innerHTML=html}return this}};var ep=El.prototype;El.addMethods=function(o){Ext.apply(ep,o)};ep.on=ep.addListener;ep.un=ep.removeListener;ep.autoBoxAdjust=true;var unitPattern=/\d+(px|em|%|en|ex|pt|in|cm|mm|pc)$/i,docEl;El.get=function(el){var ex,elm,id;if(!el){return null}if(typeof el=="string"){if(!(elm=DOC.getElementById(el))){return null}if(EC[el]&&EC[el].el){ex=EC[el].el;ex.dom=elm}else{ex=El.addToCache(new El(elm))}return ex}else if(el.tagName){if(!(id=el.id)){id=Ext.id(el)}if(EC[id]&&EC[id].el){ex=EC[id].el;ex.dom=el}else{ex=El.addToCache(new El(el))}return ex}else if(el instanceof El){if(el!=docEl){el.dom=DOC.getElementById(el.id)||el.dom}return el}else if(el.isComposite){return el}else if(Ext.isArray(el)){return El.select(el)}else if(el==DOC){if(!docEl){var f=function(){};f.prototype=El.prototype;docEl=new f;docEl.dom=DOC}return docEl}return null};El.addToCache=function(el,id){id=id||el.id;EC[id]={el:el,data:{},events:{}};return el};El.data=function(el,key,value){el=El.get(el);if(!el){return null}var c=EC[el.id].data;if(arguments.length==2){return c[key]}else{return c[key]=value}};function garbageCollect(){if(!Ext.enableGarbageCollector){clearInterval(El.collectorThreadId)}else{var eid,el,d,o;for(eid in EC){o=EC[eid];if(o.skipGC){continue}el=o.el;d=el.dom;if(!d||!d.parentNode||!d.offsetParent&&!DOC.getElementById(eid)){if(Ext.enableListenerCollection){Ext.EventManager.removeAll(d)}delete EC[eid]}}if(Ext.isIE){var t={};for(eid in EC){t[eid]=EC[eid]}EC=Ext.elCache=t}}}El.collectorThreadId=setInterval(garbageCollect,3e4);var flyFn=function(){};flyFn.prototype=El.prototype;El.Flyweight=function(dom){this.dom=dom};El.Flyweight.prototype=new flyFn;El.Flyweight.prototype.isFlyweight=true;El._flyweights={};El.fly=function(el,named){var ret=null;named=named||"_global";if(el=Ext.getDom(el)){(El._flyweights[named]=El._flyweights[named]||new El.Flyweight).dom=el;ret=El._flyweights[named]}return ret};Ext.get=El.get;Ext.fly=El.fly;var noBoxAdjust=Ext.isStrict?{select:1}:{input:1,select:1,textarea:1};if(Ext.isIE||Ext.isGecko){noBoxAdjust["button"]=1}Ext.EventManager.on(window,"unload",function(){delete EC;delete El._flyweights})})();Ext.Element.addMethods(function(){var PARENTNODE="parentNode",NEXTSIBLING="nextSibling",PREVIOUSSIBLING="previousSibling",DQ=Ext.DomQuery,GET=Ext.get;return{findParent:function(simpleSelector,maxDepth,returnEl){var p=this.dom,b=document.body,depth=0,stopEl;if(Ext.isGecko&&Object.prototype.toString.call(p)=="[object XULElement]"){return null}maxDepth=maxDepth||50;if(isNaN(maxDepth)){stopEl=Ext.getDom(maxDepth);maxDepth=Number.MAX_VALUE}while(p&&p.nodeType==1&&depth<maxDepth&&p!=b&&p!=stopEl){if(DQ.is(p,simpleSelector)){return returnEl?GET(p):p}depth++;p=p.parentNode}return null},findParentNode:function(simpleSelector,maxDepth,returnEl){var p=Ext.fly(this.dom.parentNode,"_internal");return p?p.findParent(simpleSelector,maxDepth,returnEl):null},up:function(simpleSelector,maxDepth){return this.findParentNode(simpleSelector,maxDepth,true)},select:function(selector){return Ext.Element.select(selector,this.dom)},query:function(selector){return DQ.select(selector,this.dom)},child:function(selector,returnDom){var n=DQ.selectNode(selector,this.dom);return returnDom?n:GET(n)},down:function(selector,returnDom){var n=DQ.selectNode(" > "+selector,this.dom);return returnDom?n:GET(n)},parent:function(selector,returnDom){return this.matchNode(PARENTNODE,PARENTNODE,selector,returnDom)},next:function(selector,returnDom){return this.matchNode(NEXTSIBLING,NEXTSIBLING,selector,returnDom)},prev:function(selector,returnDom){return this.matchNode(PREVIOUSSIBLING,PREVIOUSSIBLING,selector,returnDom)},first:function(selector,returnDom){return this.matchNode(NEXTSIBLING,"firstChild",selector,returnDom)},last:function(selector,returnDom){return this.matchNode(PREVIOUSSIBLING,"lastChild",selector,returnDom)},matchNode:function(dir,start,selector,returnDom){var n=this.dom[start];while(n){if(n.nodeType==1&&(!selector||DQ.is(n,selector))){return!returnDom?GET(n):n}n=n[dir]}return null}}}());Ext.Element.addMethods(function(){var GETDOM=Ext.getDom,GET=Ext.get,DH=Ext.DomHelper;return{appendChild:function(el){return GET(el).appendTo(this)},appendTo:function(el){GETDOM(el).appendChild(this.dom);return this},insertBefore:function(el){(el=GETDOM(el)).parentNode.insertBefore(this.dom,el);return this},insertAfter:function(el){(el=GETDOM(el)).parentNode.insertBefore(this.dom,el.nextSibling);return this},insertFirst:function(el,returnDom){el=el||{};if(el.nodeType||el.dom||typeof el=="string"){el=GETDOM(el);this.dom.insertBefore(el,this.dom.firstChild);return!returnDom?GET(el):el}else{return this.createChild(el,this.dom.firstChild,returnDom)}},replace:function(el){el=GET(el);this.insertBefore(el);el.remove();return this},replaceWith:function(el){var me=this;if(el.nodeType||el.dom||typeof el=="string"){el=GETDOM(el);me.dom.parentNode.insertBefore(el,me.dom)}else{el=DH.insertBefore(me.dom,el)}delete Ext.elCache[me.id];Ext.removeNode(me.dom);me.id=Ext.id(me.dom=el);Ext.Element.addToCache(me.isFlyweight?new Ext.Element(me.dom):me);return me},createChild:function(config,insertBefore,returnDom){config=config||{tag:"div"};return insertBefore?DH.insertBefore(insertBefore,config,returnDom!==true):DH[!this.dom.firstChild?"overwrite":"append"](this.dom,config,returnDom!==true)},wrap:function(config,returnDom){var newEl=DH.insertBefore(this.dom,config||{tag:"div"},!returnDom);newEl.dom?newEl.dom.appendChild(this.dom):newEl.appendChild(this.dom);return newEl},insertHtml:function(where,html,returnEl){var el=DH.insertHtml(where,this.dom,html);return returnEl?Ext.get(el):el}}}());Ext.Element.addMethods(function(){var propCache={},camelRe=/(-[a-z])/gi,classReCache={},view=document.defaultView,propFloat=Ext.isIE?"styleFloat":"cssFloat",opacityRe=/alpha\(opacity=(.*)\)/i,trimRe=/^\s+|\s+$/g,EL=Ext.Element,PADDING="padding",MARGIN="margin",BORDER="border",LEFT="-left",RIGHT="-right",TOP="-top",BOTTOM="-bottom",WIDTH="-width",MATH=Math,HIDDEN="hidden",ISCLIPPED="isClipped",OVERFLOW="overflow",OVERFLOWX="overflow-x",OVERFLOWY="overflow-y",ORIGINALCLIP="originalClip",borders={l:BORDER+LEFT+WIDTH,r:BORDER+RIGHT+WIDTH,t:BORDER+TOP+WIDTH,b:BORDER+BOTTOM+WIDTH},paddings={l:PADDING+LEFT,r:PADDING+RIGHT,t:PADDING+TOP,b:PADDING+BOTTOM},margins={l:MARGIN+LEFT,r:MARGIN+RIGHT,t:MARGIN+TOP,b:MARGIN+BOTTOM},data=Ext.Element.data;function camelFn(m,a){return a.charAt(1).toUpperCase()}function chkCache(prop){return propCache[prop]||(propCache[prop]=prop=="float"?propFloat:prop.replace(camelRe,camelFn))}return{adjustWidth:function(width){var me=this;var isNum=Ext.isNumber(width);if(isNum&&me.autoBoxAdjust&&!me.isBorderBox()){width-=me.getBorderWidth("lr")+me.getPadding("lr")}return isNum&&width<0?0:width},adjustHeight:function(height){var me=this;var isNum=Ext.isNumber(height);if(isNum&&me.autoBoxAdjust&&!me.isBorderBox()){height-=me.getBorderWidth("tb")+me.getPadding("tb")}return isNum&&height<0?0:height},addClass:function(className){var me=this,i,len,v;className=Ext.isArray(className)?className:[className];for(i=0,len=className.length;i<len;i++){v=className[i];if(v){me.dom.className+=!me.hasClass(v)&&v?" "+v:""}}return me},radioClass:function(className){var cn=this.dom.parentNode.childNodes,v;className=Ext.isArray(className)?className:[className];for(var i=0,len=cn.length;i<len;i++){v=cn[i];if(v&&v.nodeType==1){Ext.fly(v,"_internal").removeClass(className)}}return this.addClass(className)},removeClass:function(className){var me=this,v;className=Ext.isArray(className)?className:[className];if(me.dom&&me.dom.className){for(var i=0,len=className.length;i<len;i++){v=className[i];if(v){me.dom.className=me.dom.className.replace(classReCache[v]=classReCache[v]||new RegExp("(?:^|\\s+)"+v+"(?:\\s+|$)","g")," ")}}}return me},toggleClass:function(className){return this.hasClass(className)?this.removeClass(className):this.addClass(className)},hasClass:function(className){return className&&(" "+this.dom.className+" ").indexOf(" "+className+" ")!=-1},replaceClass:function(oldClassName,newClassName){return this.removeClass(oldClassName).addClass(newClassName)},isStyle:function(style,val){return this.getStyle(style)==val},getStyle:function(){return view&&view.getComputedStyle?function(prop){var el=this.dom,v,cs,out,display,wk=Ext.isWebKit,display;if(el==document){return null}prop=chkCache(prop);if(wk&&/marginRight/.test(prop)){display=this.getStyle("display");el.style.display="inline-block"}out=(v=el.style[prop])?v:(cs=view.getComputedStyle(el,""))?cs[prop]:null;if(wk){if(out=="rgba(0, 0, 0, 0)"){out="transparent"}else if(display){el.style.display=display}}return out}:function(prop){var el=this.dom,m,cs;if(el==document)return null;if(prop=="opacity"){if(el.style.filter.match){if(m=el.style.filter.match(opacityRe)){var fv=parseFloat(m[1]);if(!isNaN(fv)){return fv?fv/100:0}}}return 1}prop=chkCache(prop);return el.style[prop]||((cs=el.currentStyle)?cs[prop]:null)}}(),getColor:function(attr,defaultValue,prefix){var v=this.getStyle(attr),color=Ext.isDefined(prefix)?prefix:"#",h;if(!v||/transparent|inherit/.test(v)){return defaultValue}if(/^r/.test(v)){Ext.each(v.slice(4,v.length-1).split(","),function(s){h=parseInt(s,10);color+=(h<16?"0":"")+h.toString(16)})}else{v=v.replace("#","");color+=v.length==3?v.replace(/^(\w)(\w)(\w)$/,"$1$1$2$2$3$3"):v}return color.length>5?color.toLowerCase():defaultValue},setStyle:function(prop,value){var tmp,style,camel;if(!Ext.isObject(prop)){tmp={};tmp[prop]=value;prop=tmp}for(style in prop){value=prop[style];style=="opacity"?this.setOpacity(value):this.dom.style[chkCache(style)]=value}return this},setOpacity:function(opacity,animate){var me=this,s=me.dom.style;if(!animate||!me.anim){if(Ext.isIE){var opac=opacity<1?"alpha(opacity="+opacity*100+")":"",val=s.filter.replace(opacityRe,"").replace(trimRe,"");s.zoom=1;s.filter=val+(val.length>0?" ":"")+opac}else{s.opacity=opacity}}else{me.anim({opacity:{to:opacity}},me.preanim(arguments,1),null,.35,"easeIn")}return me},clearOpacity:function(){var style=this.dom.style;if(Ext.isIE){if(!Ext.isEmpty(style.filter)){style.filter=style.filter.replace(opacityRe,"").replace(trimRe,"")}}else{style.opacity=style["-moz-opacity"]=style["-khtml-opacity"]=""}return this},getHeight:function(contentHeight){var me=this,dom=me.dom,hidden=Ext.isIE&&me.isStyle("display","none"),h=MATH.max(dom.offsetHeight,hidden?0:dom.clientHeight)||0;h=!contentHeight?h:h-me.getBorderWidth("tb")-me.getPadding("tb");return h<0?0:h},getWidth:function(contentWidth){var me=this,dom=me.dom,hidden=Ext.isIE&&me.isStyle("display","none"),w=MATH.max(dom.offsetWidth,hidden?0:dom.clientWidth)||0;w=!contentWidth?w:w-me.getBorderWidth("lr")-me.getPadding("lr");return w<0?0:w},setWidth:function(width,animate){var me=this;width=me.adjustWidth(width);!animate||!me.anim?me.dom.style.width=me.addUnits(width):me.anim({width:{to:width}},me.preanim(arguments,1));return me},setHeight:function(height,animate){var me=this;height=me.adjustHeight(height);!animate||!me.anim?me.dom.style.height=me.addUnits(height):me.anim({height:{to:height}},me.preanim(arguments,1));return me},getBorderWidth:function(side){return this.addStyles(side,borders)},getPadding:function(side){return this.addStyles(side,paddings)},clip:function(){var me=this,dom=me.dom;if(!data(dom,ISCLIPPED)){data(dom,ISCLIPPED,true);data(dom,ORIGINALCLIP,{o:me.getStyle(OVERFLOW),x:me.getStyle(OVERFLOWX),y:me.getStyle(OVERFLOWY)});me.setStyle(OVERFLOW,HIDDEN);me.setStyle(OVERFLOWX,HIDDEN);me.setStyle(OVERFLOWY,HIDDEN)}return me},unclip:function(){var me=this,dom=me.dom;if(data(dom,ISCLIPPED)){data(dom,ISCLIPPED,false);var o=data(dom,ORIGINALCLIP);if(o.o){me.setStyle(OVERFLOW,o.o)}if(o.x){me.setStyle(OVERFLOWX,o.x)}if(o.y){me.setStyle(OVERFLOWY,o.y)}}return me},addStyles:function(sides,styles){var val=0,m=sides.match(/\w/g),s;for(var i=0,len=m.length;i<len;i++){s=m[i]&&parseInt(this.getStyle(styles[m[i]]),10);if(s){val+=MATH.abs(s)}}return val},margins:margins}}());(function(){var D=Ext.lib.Dom,LEFT="left",RIGHT="right",TOP="top",BOTTOM="bottom",POSITION="position",STATIC="static",RELATIVE="relative",AUTO="auto",ZINDEX="z-index";Ext.Element.addMethods({getX:function(){return D.getX(this.dom)},getY:function(){return D.getY(this.dom)},getXY:function(){return D.getXY(this.dom)},getOffsetsTo:function(el){var o=this.getXY(),e=Ext.fly(el,"_internal").getXY();return[o[0]-e[0],o[1]-e[1]]},setX:function(x,animate){return this.setXY([x,this.getY()],this.animTest(arguments,animate,1))},setY:function(y,animate){return this.setXY([this.getX(),y],this.animTest(arguments,animate,1))},setLeft:function(left){this.setStyle(LEFT,this.addUnits(left));return this},setTop:function(top){this.setStyle(TOP,this.addUnits(top));return this},setRight:function(right){this.setStyle(RIGHT,this.addUnits(right));return this},setBottom:function(bottom){this.setStyle(BOTTOM,this.addUnits(bottom));return this},setXY:function(pos,animate){var me=this;if(!animate||!me.anim){D.setXY(me.dom,pos)}else{me.anim({points:{to:pos}},me.preanim(arguments,1),"motion")}return me},setLocation:function(x,y,animate){return this.setXY([x,y],this.animTest(arguments,animate,2))},moveTo:function(x,y,animate){return this.setXY([x,y],this.animTest(arguments,animate,2))},getLeft:function(local){return!local?this.getX():parseInt(this.getStyle(LEFT),10)||0},getRight:function(local){var me=this;return!local?me.getX()+me.getWidth():me.getLeft(true)+me.getWidth()||0},getTop:function(local){return!local?this.getY():parseInt(this.getStyle(TOP),10)||0},getBottom:function(local){var me=this;return!local?me.getY()+me.getHeight():me.getTop(true)+me.getHeight()||0},position:function(pos,zIndex,x,y){var me=this;if(!pos&&me.isStyle(POSITION,STATIC)){me.setStyle(POSITION,RELATIVE)}else if(pos){me.setStyle(POSITION,pos)}if(zIndex){me.setStyle(ZINDEX,zIndex)}if(x||y)me.setXY([x||false,y||false])},clearPositioning:function(value){value=value||"";this.setStyle({left:value,right:value,top:value,bottom:value,"z-index":"",position:STATIC});return this},getPositioning:function(){var l=this.getStyle(LEFT);var t=this.getStyle(TOP);return{position:this.getStyle(POSITION),left:l,right:l?"":this.getStyle(RIGHT),top:t,bottom:t?"":this.getStyle(BOTTOM),"z-index":this.getStyle(ZINDEX)}},setPositioning:function(pc){var me=this,style=me.dom.style;me.setStyle(pc);if(pc.right==AUTO){style.right=""}if(pc.bottom==AUTO){style.bottom=""}return me},translatePoints:function(x,y){y=isNaN(x[1])?y:x[1];x=isNaN(x[0])?x:x[0];var me=this,relative=me.isStyle(POSITION,RELATIVE),o=me.getXY(),l=parseInt(me.getStyle(LEFT),10),t=parseInt(me.getStyle(TOP),10);l=!isNaN(l)?l:relative?0:me.dom.offsetLeft;t=!isNaN(t)?t:relative?0:me.dom.offsetTop;return{left:x-o[0]+l,top:y-o[1]+t}},animTest:function(args,animate,i){return!!animate&&this.preanim?this.preanim(args,i):false}})})();Ext.Element.addMethods({isScrollable:function(){var dom=this.dom;return dom.scrollHeight>dom.clientHeight||dom.scrollWidth>dom.clientWidth},scrollTo:function(side,value){this.dom["scroll"+(/top/i.test(side)?"Top":"Left")]=value;return this},getScroll:function(){var d=this.dom,doc=document,body=doc.body,docElement=doc.documentElement,l,t,ret;if(d==doc||d==body){if(Ext.isIE&&Ext.isStrict){l=docElement.scrollLeft;t=docElement.scrollTop}else{l=window.pageXOffset;t=window.pageYOffset}ret={left:l||(body?body.scrollLeft:0),top:t||(body?body.scrollTop:0)}}else{ret={left:d.scrollLeft,top:d.scrollTop}}return ret}});Ext.Element.VISIBILITY=1;Ext.Element.DISPLAY=2;Ext.Element.addMethods(function(){var VISIBILITY="visibility",DISPLAY="display",HIDDEN="hidden",NONE="none",ORIGINALDISPLAY="originalDisplay",VISMODE="visibilityMode",ELDISPLAY=Ext.Element.DISPLAY,data=Ext.Element.data,getDisplay=function(dom){var d=data(dom,ORIGINALDISPLAY);if(d===undefined){data(dom,ORIGINALDISPLAY,d="")}return d},getVisMode=function(dom){var m=data(dom,VISMODE);if(m===undefined){data(dom,VISMODE,m=1)}return m};return{originalDisplay:"",visibilityMode:1,setVisibilityMode:function(visMode){data(this.dom,VISMODE,visMode);return this},animate:function(args,duration,onComplete,easing,animType){this.anim(args,{duration:duration,callback:onComplete,easing:easing},animType);return this},anim:function(args,opt,animType,defaultDur,defaultEase,cb){animType=animType||"run";opt=opt||{};var me=this,anim=Ext.lib.Anim[animType](me.dom,args,opt.duration||defaultDur||.35,opt.easing||defaultEase||"easeOut",function(){if(cb)cb.call(me);if(opt.callback)opt.callback.call(opt.scope||me,me,opt)},me);opt.anim=anim;return anim},preanim:function(a,i){return!a[i]?false:Ext.isObject(a[i])?a[i]:{duration:a[i+1],callback:a[i+2],easing:a[i+3]}},isVisible:function(){return!this.isStyle(VISIBILITY,HIDDEN)&&!this.isStyle(DISPLAY,NONE)},setVisible:function(visible,animate){var me=this,dom=me.dom,isDisplay=getVisMode(this.dom)==ELDISPLAY;if(!animate||!me.anim){if(isDisplay){me.setDisplayed(visible)}else{me.fixDisplay();dom.style.visibility=visible?"visible":HIDDEN}}else{if(visible){me.setOpacity(.01);me.setVisible(true)}me.anim({opacity:{to:visible?1:0}},me.preanim(arguments,1),null,.35,"easeIn",function(){if(!visible){dom.style[isDisplay?DISPLAY:VISIBILITY]=isDisplay?NONE:HIDDEN;Ext.fly(dom).setOpacity(1)}})}return me},toggle:function(animate){var me=this;me.setVisible(!me.isVisible(),me.preanim(arguments,0));return me},setDisplayed:function(value){if(typeof value=="boolean"){value=value?getDisplay(this.dom):NONE}this.setStyle(DISPLAY,value);return this},fixDisplay:function(){var me=this;if(me.isStyle(DISPLAY,NONE)){me.setStyle(VISIBILITY,HIDDEN);me.setStyle(DISPLAY,getDisplay(this.dom));if(me.isStyle(DISPLAY,NONE)){me.setStyle(DISPLAY,"block")}}},hide:function(animate){this.setVisible(false,this.preanim(arguments,0));return this},show:function(animate){this.setVisible(true,this.preanim(arguments,0));return this}}}());(function(){var NULL=null,UNDEFINED=undefined,TRUE=true,FALSE=false,SETX="setX",SETY="setY",SETXY="setXY",LEFT="left",BOTTOM="bottom",TOP="top",RIGHT="right",HEIGHT="height",WIDTH="width",POINTS="points",HIDDEN="hidden",ABSOLUTE="absolute",VISIBLE="visible",MOTION="motion",POSITION="position",EASEOUT="easeOut",flyEl=new Ext.Element.Flyweight,queues={},getObject=function(o){return o||{}},fly=function(dom){flyEl.dom=dom;flyEl.id=Ext.id(dom);return flyEl},getQueue=function(id){if(!queues[id]){queues[id]=[]}return queues[id]},setQueue=function(id,value){queues[id]=value};Ext.enableFx=TRUE;Ext.Fx={switchStatements:function(key,fn,argHash){return fn.apply(this,argHash[key])},slideIn:function(anchor,o){o=getObject(o);var me=this,dom=me.dom,st=dom.style,xy,r,b,wrap,after,st,args,pt,bw,bh;anchor=anchor||"t";me.queueFx(o,function(){xy=fly(dom).getXY();fly(dom).fixDisplay();r=fly(dom).getFxRestore();b={x:xy[0],y:xy[1],0:xy[0],1:xy[1],width:dom.offsetWidth,height:dom.offsetHeight};b.right=b.x+b.width;b.bottom=b.y+b.height;fly(dom).setWidth(b.width).setHeight(b.height);wrap=fly(dom).fxWrap(r.pos,o,HIDDEN);st.visibility=VISIBLE;st.position=ABSOLUTE;function after(){fly(dom).fxUnwrap(wrap,r.pos,o);st.width=r.width;st.height=r.height;fly(dom).afterFx(o)}pt={to:[b.x,b.y]};bw={to:b.width};bh={to:b.height};function argCalc(wrap,style,ww,wh,sXY,sXYval,s1,s2,w,h,p){var ret={};fly(wrap).setWidth(ww).setHeight(wh);if(fly(wrap)[sXY]){fly(wrap)[sXY](sXYval)}style[s1]=style[s2]="0";if(w){ret.width=w}if(h){ret.height=h}if(p){ret.points=p}return ret}args=fly(dom).switchStatements(anchor.toLowerCase(),argCalc,{t:[wrap,st,b.width,0,NULL,NULL,LEFT,BOTTOM,NULL,bh,NULL],l:[wrap,st,0,b.height,NULL,NULL,RIGHT,TOP,bw,NULL,NULL],r:[wrap,st,b.width,b.height,SETX,b.right,LEFT,TOP,NULL,NULL,pt],b:[wrap,st,b.width,b.height,SETY,b.bottom,LEFT,TOP,NULL,bh,pt],tl:[wrap,st,0,0,NULL,NULL,RIGHT,BOTTOM,bw,bh,pt],bl:[wrap,st,0,0,SETY,b.y+b.height,RIGHT,TOP,bw,bh,pt],br:[wrap,st,0,0,SETXY,[b.right,b.bottom],LEFT,TOP,bw,bh,pt],tr:[wrap,st,0,0,SETX,b.x+b.width,LEFT,BOTTOM,bw,bh,pt]});st.visibility=VISIBLE;fly(wrap).show();arguments.callee.anim=fly(wrap).fxanim(args,o,MOTION,.5,EASEOUT,after)});return me},slideOut:function(anchor,o){o=getObject(o);var me=this,dom=me.dom,st=dom.style,xy=me.getXY(),wrap,r,b,a,zero={to:0};anchor=anchor||"t";me.queueFx(o,function(){r=fly(dom).getFxRestore();b={x:xy[0],y:xy[1],0:xy[0],1:xy[1],width:dom.offsetWidth,height:dom.offsetHeight};b.right=b.x+b.width;b.bottom=b.y+b.height;fly(dom).setWidth(b.width).setHeight(b.height);wrap=fly(dom).fxWrap(r.pos,o,VISIBLE);st.visibility=VISIBLE;st.position=ABSOLUTE;fly(wrap).setWidth(b.width).setHeight(b.height);function after(){o.useDisplay?fly(dom).setDisplayed(FALSE):fly(dom).hide();fly(dom).fxUnwrap(wrap,r.pos,o);st.width=r.width;st.height=r.height;fly(dom).afterFx(o)}function argCalc(style,s1,s2,p1,v1,p2,v2,p3,v3){var ret={};style[s1]=style[s2]="0";ret[p1]=v1;if(p2){ret[p2]=v2}if(p3){ret[p3]=v3}return ret}a=fly(dom).switchStatements(anchor.toLowerCase(),argCalc,{t:[st,LEFT,BOTTOM,HEIGHT,zero],l:[st,RIGHT,TOP,WIDTH,zero],r:[st,LEFT,TOP,WIDTH,zero,POINTS,{to:[b.right,b.y]}],b:[st,LEFT,TOP,HEIGHT,zero,POINTS,{to:[b.x,b.bottom]}],tl:[st,RIGHT,BOTTOM,WIDTH,zero,HEIGHT,zero],bl:[st,RIGHT,TOP,WIDTH,zero,HEIGHT,zero,POINTS,{to:[b.x,b.bottom]}],br:[st,LEFT,TOP,WIDTH,zero,HEIGHT,zero,POINTS,{to:[b.x+b.width,b.bottom]}],tr:[st,LEFT,BOTTOM,WIDTH,zero,HEIGHT,zero,POINTS,{to:[b.right,b.y]}]});arguments.callee.anim=fly(wrap).fxanim(a,o,MOTION,.5,EASEOUT,after)});return me},puff:function(o){o=getObject(o);var me=this,dom=me.dom,st=dom.style,width,height,r;me.queueFx(o,function(){width=fly(dom).getWidth();height=fly(dom).getHeight();fly(dom).clearOpacity();fly(dom).show();r=fly(dom).getFxRestore();function after(){o.useDisplay?fly(dom).setDisplayed(FALSE):fly(dom).hide();fly(dom).clearOpacity();fly(dom).setPositioning(r.pos);st.width=r.width;st.height=r.height;st.fontSize="";fly(dom).afterFx(o)}arguments.callee.anim=fly(dom).fxanim({width:{to:fly(dom).adjustWidth(width*2)},height:{to:fly(dom).adjustHeight(height*2)},points:{by:[-width*.5,-height*.5]},opacity:{to:0},fontSize:{to:200,unit:"%"}},o,MOTION,.5,EASEOUT,after)});return me},switchOff:function(o){o=getObject(o);var me=this,dom=me.dom,st=dom.style,r;me.queueFx(o,function(){fly(dom).clearOpacity();fly(dom).clip();r=fly(dom).getFxRestore();function after(){o.useDisplay?fly(dom).setDisplayed(FALSE):fly(dom).hide();fly(dom).clearOpacity();fly(dom).setPositioning(r.pos);st.width=r.width;st.height=r.height;fly(dom).afterFx(o)}fly(dom).fxanim({opacity:{to:.3}},NULL,NULL,.1,NULL,function(){fly(dom).clearOpacity();(function(){fly(dom).fxanim({height:{to:1},points:{by:[0,fly(dom).getHeight()*.5]}},o,MOTION,.3,"easeIn",after)}).defer(100)})});return me},highlight:function(color,o){o=getObject(o);var me=this,dom=me.dom,attr=o.attr||"backgroundColor",a={},restore;me.queueFx(o,function(){fly(dom).clearOpacity();fly(dom).show();function after(){dom.style[attr]=restore;fly(dom).afterFx(o)}restore=dom.style[attr];a[attr]={from:color||"ffff9c",to:o.endColor||fly(dom).getColor(attr)||"ffffff"};arguments.callee.anim=fly(dom).fxanim(a,o,"color",1,"easeIn",after)});return me},frame:function(color,count,o){o=getObject(o);var me=this,dom=me.dom,proxy,active;me.queueFx(o,function(){color=color||"#C3DAF9";if(color.length==6){color="#"+color}count=count||1;fly(dom).show();var xy=fly(dom).getXY(),b={x:xy[0],y:xy[1],0:xy[0],1:xy[1],width:dom.offsetWidth,height:dom.offsetHeight},queue=function(){proxy=fly(document.body||document.documentElement).createChild({style:{position:ABSOLUTE,"z-index":35e3,border:"0px solid "+color}});return proxy.queueFx({},animFn)};arguments.callee.anim={isAnimated:true,stop:function(){count=0;proxy.stopFx()}};function animFn(){var scale=Ext.isBorderBox?2:1;active=proxy.anim({top:{from:b.y,to:b.y-20},left:{from:b.x,to:b.x-20},borderWidth:{from:0,to:10},opacity:{from:1,to:0},height:{from:b.height,to:b.height+20*scale},width:{from:b.width,to:b.width+20*scale}},{duration:o.duration||1,callback:function(){proxy.remove();--count>0?queue():fly(dom).afterFx(o)}});arguments.callee.anim={isAnimated:true,stop:function(){active.stop()}}}queue()});return me},pause:function(seconds){var dom=this.dom,t;this.queueFx({},function(){t=setTimeout(function(){fly(dom).afterFx({})},seconds*1e3);arguments.callee.anim={isAnimated:true,stop:function(){clearTimeout(t);fly(dom).afterFx({})}}});return this},fadeIn:function(o){o=getObject(o);var me=this,dom=me.dom,to=o.endOpacity||1;me.queueFx(o,function(){fly(dom).setOpacity(0);fly(dom).fixDisplay();dom.style.visibility=VISIBLE;arguments.callee.anim=fly(dom).fxanim({opacity:{to:to}},o,NULL,.5,EASEOUT,function(){if(to==1){fly(dom).clearOpacity()}fly(dom).afterFx(o)})});return me},fadeOut:function(o){o=getObject(o);var me=this,dom=me.dom,style=dom.style,to=o.endOpacity||0;me.queueFx(o,function(){arguments.callee.anim=fly(dom).fxanim({opacity:{to:to}},o,NULL,.5,EASEOUT,function(){if(to==0){Ext.Element.data(dom,"visibilityMode")==Ext.Element.DISPLAY||o.useDisplay?style.display="none":style.visibility=HIDDEN;fly(dom).clearOpacity()}fly(dom).afterFx(o)})});return me},scale:function(w,h,o){this.shift(Ext.apply({},o,{width:w,height:h}));return this},shift:function(o){o=getObject(o);var dom=this.dom,a={};this.queueFx(o,function(){for(var prop in o){if(o[prop]!=UNDEFINED){a[prop]={to:o[prop]}}}a.width?a.width.to=fly(dom).adjustWidth(o.width):a;a.height?a.height.to=fly(dom).adjustWidth(o.height):a;if(a.x||a.y||a.xy){a.points=a.xy||{to:[a.x?a.x.to:fly(dom).getX(),a.y?a.y.to:fly(dom).getY()]}}arguments.callee.anim=fly(dom).fxanim(a,o,MOTION,.35,EASEOUT,function(){fly(dom).afterFx(o)})});return this},ghost:function(anchor,o){o=getObject(o);var me=this,dom=me.dom,st=dom.style,a={opacity:{to:0},points:{}},pt=a.points,r,w,h;anchor=anchor||"b";me.queueFx(o,function(){r=fly(dom).getFxRestore();w=fly(dom).getWidth();h=fly(dom).getHeight();function after(){o.useDisplay?fly(dom).setDisplayed(FALSE):fly(dom).hide();fly(dom).clearOpacity();fly(dom).setPositioning(r.pos);st.width=r.width;st.height=r.height;fly(dom).afterFx(o)}pt.by=fly(dom).switchStatements(anchor.toLowerCase(),function(v1,v2){return[v1,v2]},{t:[0,-h],l:[-w,0],r:[w,0],b:[0,h],tl:[-w,-h],bl:[-w,h],br:[w,h],tr:[w,-h]});arguments.callee.anim=fly(dom).fxanim(a,o,MOTION,.5,EASEOUT,after)});return me},syncFx:function(){var me=this;me.fxDefaults=Ext.apply(me.fxDefaults||{},{block:FALSE,concurrent:TRUE,stopFx:FALSE});return me},sequenceFx:function(){var me=this;me.fxDefaults=Ext.apply(me.fxDefaults||{},{block:FALSE,concurrent:FALSE,stopFx:FALSE});return me},nextFx:function(){var ef=getQueue(this.dom.id)[0];if(ef){ef.call(this)}},hasActiveFx:function(){return getQueue(this.dom.id)[0]},stopFx:function(finish){var me=this,id=me.dom.id;if(me.hasActiveFx()){var cur=getQueue(id)[0];if(cur&&cur.anim){if(cur.anim.isAnimated){setQueue(id,[cur]);cur.anim.stop(finish!==undefined?finish:TRUE)}else{setQueue(id,[])}}}return me},beforeFx:function(o){if(this.hasActiveFx()&&!o.concurrent){if(o.stopFx){this.stopFx();return TRUE}return FALSE}return TRUE},hasFxBlock:function(){var q=getQueue(this.dom.id);return q&&q[0]&&q[0].block},queueFx:function(o,fn){var me=fly(this.dom);if(!me.hasFxBlock()){Ext.applyIf(o,me.fxDefaults);if(!o.concurrent){var run=me.beforeFx(o);fn.block=o.block;
getQueue(me.dom.id).push(fn);if(run){me.nextFx()}}else{fn.call(me)}}return me},fxWrap:function(pos,o,vis){var dom=this.dom,wrap,wrapXY;if(!o.wrap||!(wrap=Ext.getDom(o.wrap))){if(o.fixPosition){wrapXY=fly(dom).getXY()}var div=document.createElement("div");div.style.visibility=vis;wrap=dom.parentNode.insertBefore(div,dom);fly(wrap).setPositioning(pos);if(fly(wrap).isStyle(POSITION,"static")){fly(wrap).position("relative")}fly(dom).clearPositioning("auto");fly(wrap).clip();wrap.appendChild(dom);if(wrapXY){fly(wrap).setXY(wrapXY)}}return wrap},fxUnwrap:function(wrap,pos,o){var dom=this.dom;fly(dom).clearPositioning();fly(dom).setPositioning(pos);if(!o.wrap){var pn=fly(wrap).dom.parentNode;pn.insertBefore(dom,wrap);fly(wrap).remove()}},getFxRestore:function(){var st=this.dom.style;return{pos:this.getPositioning(),width:st.width,height:st.height}},afterFx:function(o){var dom=this.dom,id=dom.id;if(o.afterStyle){fly(dom).setStyle(o.afterStyle)}if(o.afterCls){fly(dom).addClass(o.afterCls)}if(o.remove==TRUE){fly(dom).remove()}if(o.callback){o.callback.call(o.scope,fly(dom))}if(!o.concurrent){getQueue(id).shift();fly(dom).nextFx()}},fxanim:function(args,opt,animType,defaultDur,defaultEase,cb){animType=animType||"run";opt=opt||{};var anim=Ext.lib.Anim[animType](this.dom,args,opt.duration||defaultDur||.35,opt.easing||defaultEase||EASEOUT,cb,this);opt.anim=anim;return anim}};Ext.Fx.resize=Ext.Fx.scale;Ext.Element.addMethods(Ext.Fx)})();Ext.CompositeElementLite=function(els,root){this.elements=[];this.add(els,root);this.el=new Ext.Element.Flyweight};Ext.CompositeElementLite.prototype={isComposite:true,getElement:function(el){var e=this.el;e.dom=el;e.id=el.id;return e},transformElement:function(el){return Ext.getDom(el)},getCount:function(){return this.elements.length},add:function(els,root){var me=this,elements=me.elements;if(!els){return this}if(Ext.isString(els)){els=Ext.Element.selectorFunction(els,root)}else if(els.isComposite){els=els.elements}else if(!Ext.isIterable(els)){els=[els]}for(var i=0,len=els.length;i<len;++i){elements.push(me.transformElement(els[i]))}return me},invoke:function(fn,args){var me=this,els=me.elements,len=els.length,e,i;for(i=0;i<len;i++){e=els[i];if(e){Ext.Element.prototype[fn].apply(me.getElement(e),args)}}return me},item:function(index){var me=this,el=me.elements[index],out=null;if(el){out=me.getElement(el)}return out},addListener:function(eventName,handler,scope,opt){var els=this.elements,len=els.length,i,e;for(i=0;i<len;i++){e=els[i];if(e){Ext.EventManager.on(e,eventName,handler,scope||e,opt)}}return this},each:function(fn,scope){var me=this,els=me.elements,len=els.length,i,e;for(i=0;i<len;i++){e=els[i];if(e){e=this.getElement(e);if(fn.call(scope||e,e,me,i)){break}}}return me},fill:function(els){var me=this;me.elements=[];me.add(els);return me},filter:function(selector){var els=[],me=this,elements=me.elements,fn=Ext.isFunction(selector)?selector:function(el){return el.is(selector)};me.each(function(el,self,i){if(fn(el,i)!==false){els[els.length]=me.transformElement(el)}});me.elements=els;return me},indexOf:function(el){return this.elements.indexOf(this.transformElement(el))},replaceElement:function(el,replacement,domReplace){var index=!isNaN(el)?el:this.indexOf(el),d;if(index>-1){replacement=Ext.getDom(replacement);if(domReplace){d=this.elements[index];d.parentNode.insertBefore(replacement,d);Ext.removeNode(d)}this.elements.splice(index,1,replacement)}return this},clear:function(){this.elements=[]}};Ext.CompositeElementLite.prototype.on=Ext.CompositeElementLite.prototype.addListener;(function(){var fnName,ElProto=Ext.Element.prototype,CelProto=Ext.CompositeElementLite.prototype;for(fnName in ElProto){if(Ext.isFunction(ElProto[fnName])){(function(fnName){CelProto[fnName]=CelProto[fnName]||function(){return this.invoke(fnName,arguments)}}).call(CelProto,fnName)}}})();if(Ext.DomQuery){Ext.Element.selectorFunction=Ext.DomQuery.select}Ext.Element.select=function(selector,root){var els;if(typeof selector=="string"){els=Ext.Element.selectorFunction(selector,root)}else if(selector.length!==undefined){els=selector}else{throw"Invalid selector"}return new Ext.CompositeElementLite(els)};Ext.select=Ext.Element.select;(function(){var BEFOREREQUEST="beforerequest",REQUESTCOMPLETE="requestcomplete",REQUESTEXCEPTION="requestexception",UNDEFINED=undefined,LOAD="load",POST="POST",GET="GET",WINDOW=window;Ext.data.Connection=function(config){Ext.apply(this,config);this.addEvents(BEFOREREQUEST,REQUESTCOMPLETE,REQUESTEXCEPTION);Ext.data.Connection.superclass.constructor.call(this)};Ext.extend(Ext.data.Connection,Ext.util.Observable,{timeout:3e4,autoAbort:false,disableCaching:true,disableCachingParam:"_dc",request:function(o){var me=this;if(me.fireEvent(BEFOREREQUEST,me,o)){if(o.el){if(!Ext.isEmpty(o.indicatorText)){me.indicatorText='<div class="loading-indicator">'+o.indicatorText+"</div>"}if(me.indicatorText){Ext.getDom(o.el).innerHTML=me.indicatorText}o.success=(Ext.isFunction(o.success)?o.success:function(){}).createInterceptor(function(response){Ext.getDom(o.el).innerHTML=response.responseText})}var p=o.params,url=o.url||me.url,method,cb={success:me.handleResponse,failure:me.handleFailure,scope:me,argument:{options:o},timeout:o.timeout||me.timeout},form,serForm;if(Ext.isFunction(p)){p=p.call(o.scope||WINDOW,o)}p=Ext.urlEncode(me.extraParams,Ext.isObject(p)?Ext.urlEncode(p):p);if(Ext.isFunction(url)){url=url.call(o.scope||WINDOW,o)}if(form=Ext.getDom(o.form)){url=url||form.action;if(o.isUpload||/multipart\/form-data/i.test(form.getAttribute("enctype"))){return me.doFormUpload.call(me,o,p,url)}serForm=Ext.lib.Ajax.serializeForm(form);p=p?p+"&"+serForm:serForm}method=o.method||me.method||(p||o.xmlData||o.jsonData?POST:GET);if(method===GET&&(me.disableCaching&&o.disableCaching!==false)||o.disableCaching===true){var dcp=o.disableCachingParam||me.disableCachingParam;url=Ext.urlAppend(url,dcp+"="+(new Date).getTime())}o.headers=Ext.apply(o.headers||{},me.defaultHeaders||{});if(o.autoAbort===true||me.autoAbort){me.abort()}if((method==GET||o.xmlData||o.jsonData)&&p){url=Ext.urlAppend(url,p);p=""}return me.transId=Ext.lib.Ajax.request(method,url,cb,p,o)}else{return o.callback?o.callback.apply(o.scope,[o,UNDEFINED,UNDEFINED]):null}},isLoading:function(transId){return transId?Ext.lib.Ajax.isCallInProgress(transId):!!this.transId},abort:function(transId){if(transId||this.isLoading()){Ext.lib.Ajax.abort(transId||this.transId)}},handleResponse:function(response){this.transId=false;var options=response.argument.options;response.argument=options?options.argument:null;this.fireEvent(REQUESTCOMPLETE,this,response,options);if(options.success){options.success.call(options.scope,response,options)}if(options.callback){options.callback.call(options.scope,options,true,response)}},handleFailure:function(response,e){this.transId=false;var options=response.argument.options;response.argument=options?options.argument:null;this.fireEvent(REQUESTEXCEPTION,this,response,options,e);if(options.failure){options.failure.call(options.scope,response,options)}if(options.callback){options.callback.call(options.scope,options,false,response)}},doFormUpload:function(o,ps,url){var id=Ext.id(),doc=document,frame=doc.createElement("iframe"),form=Ext.getDom(o.form),hiddens=[],hd,encoding="multipart/form-data",buf={target:form.target,method:form.method,encoding:form.encoding,enctype:form.enctype,action:form.action};Ext.fly(frame).set({id:id,name:id,cls:"x-hidden"});doc.body.appendChild(frame);Ext.fly(frame).set({src:Ext.SSL_SECURE_URL});if(Ext.isIE){document.frames[id].name=id}Ext.fly(form).set({target:id,method:POST,enctype:encoding,encoding:encoding,action:url||buf.action});Ext.iterate(Ext.urlDecode(ps,false),function(k,v){hd=doc.createElement("input");Ext.fly(hd).set({type:"hidden",value:v,name:k});form.appendChild(hd);hiddens.push(hd)});function cb(){var me=this,r={responseText:"",responseXML:null,argument:o.argument},doc,firstChild;try{doc=frame.contentWindow.document||frame.contentDocument||WINDOW.frames[id].document;if(doc){if(doc.body){if(/textarea/i.test((firstChild=doc.body.firstChild||{}).tagName)){r.responseText=firstChild.value}else{r.responseText=doc.body.innerHTML}}r.responseXML=doc.XMLDocument||doc}}catch(e){}Ext.EventManager.removeListener(frame,LOAD,cb,me);me.fireEvent(REQUESTCOMPLETE,me,r,o);function runCallback(fn,scope,args){if(Ext.isFunction(fn)){fn.apply(scope,args)}}runCallback(o.success,o.scope,[r,o]);runCallback(o.callback,o.scope,[o,true,r]);if(!me.debugUploads){setTimeout(function(){Ext.removeNode(frame)},100)}}Ext.EventManager.on(frame,LOAD,cb,this);form.submit();Ext.fly(form).set(buf);Ext.each(hiddens,function(h){Ext.removeNode(h)})}})})();Ext.Ajax=new Ext.data.Connection({autoAbort:false,serializeForm:function(form){return Ext.lib.Ajax.serializeForm(form)}});Ext.util.JSON=new function(){var useHasOwn=!!{}.hasOwnProperty,isNative=function(){var useNative=null;return function(){if(useNative===null){useNative=Ext.USE_NATIVE_JSON&&window.JSON&&JSON.toString()=="[object JSON]"}return useNative}}(),pad=function(n){return n<10?"0"+n:n},doDecode=function(json){return eval("("+json+")")},doEncode=function(o){if(!Ext.isDefined(o)||o===null){return"null"}else if(Ext.isArray(o)){return encodeArray(o)}else if(Ext.isDate(o)){return Ext.util.JSON.encodeDate(o)}else if(Ext.isString(o)){return encodeString(o)}else if(typeof o=="number"){return isFinite(o)?String(o):"null"}else if(Ext.isBoolean(o)){return String(o)}else{var a=["{"],b,i,v;for(i in o){if(!o.getElementsByTagName){if(!useHasOwn||o.hasOwnProperty(i)){v=o[i];switch(typeof v){case"undefined":case"function":case"unknown":break;default:if(b){a.push(",")}a.push(doEncode(i),":",v===null?"null":doEncode(v));b=true}}}}a.push("}");return a.join("")}},m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},encodeString=function(s){if(/["\\\x00-\x1f]/.test(s)){return'"'+s.replace(/([\x00-\x1f\\"])/g,function(a,b){var c=m[b];if(c){return c}c=b.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+s+'"'},encodeArray=function(o){var a=["["],b,i,l=o.length,v;for(i=0;i<l;i+=1){v=o[i];switch(typeof v){case"undefined":case"function":case"unknown":break;default:if(b){a.push(",")}a.push(v===null?"null":Ext.util.JSON.encode(v));b=true}}a.push("]");return a.join("")};this.encodeDate=function(o){return'"'+o.getFullYear()+"-"+pad(o.getMonth()+1)+"-"+pad(o.getDate())+"T"+pad(o.getHours())+":"+pad(o.getMinutes())+":"+pad(o.getSeconds())+'"'};this.encode=function(){var ec;return function(o){if(!ec){ec=isNative()?JSON.stringify:doEncode}return ec(o)}}();this.decode=function(){var dc;return function(json){if(!dc){dc=isNative()?JSON.parse:doDecode}return dc(json)}}()};Ext.encode=Ext.util.JSON.encode;Ext.decode=Ext.util.JSON.decode;(function(window,undefined){var readyList,rootjQuery,core_strundefined=typeof undefined,location=window.location,document=window.document,docElem=document.documentElement,_jQuery=window.jQuery,_$=window.$,class2type={},core_deletedIds=[],core_version="1.10.2",core_concat=core_deletedIds.concat,core_push=core_deletedIds.push,core_slice=core_deletedIds.slice,core_indexOf=core_deletedIds.indexOf,core_toString=class2type.toString,core_hasOwn=class2type.hasOwnProperty,core_trim=core_version.trim,jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery)},core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,core_rnotwhite=/\S+/g,rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rvalidchars=/^[\],:{}\s]*$/,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rvalidescape=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,rvalidtokens=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()},completed=function(event){if(document.addEventListener||event.type==="load"||document.readyState==="complete"){detach();jQuery.ready()}},detach=function(){if(document.addEventListener){document.removeEventListener("DOMContentLoaded",completed,false);window.removeEventListener("load",completed,false)}else{document.detachEvent("onreadystatechange",completed);window.detachEvent("onload",completed)}};jQuery.fn=jQuery.prototype={jquery:core_version,constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem;if(!selector){return this}if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null]}else{match=rquickExpr.exec(selector)}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(jQuery.isFunction(this[match])){this[match](context[match])}else{this.attr(match,context[match])}}}return this}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2]){return rootjQuery.find(selector)}this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}}else if(!context||context.jquery){return(context||rootjQuery).find(selector)}else{return this.constructor(context).find(selector)}}else if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}else if(jQuery.isFunction(selector)){return rootjQuery.ready(selector)}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)},selector:"",length:0,toArray:function(){return core_slice.call(this)},get:function(num){return num==null?this.toArray():num<0?this[this.length+num]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret},each:function(callback,args){return jQuery.each(this,callback,args)},ready:function(fn){jQuery.ready.promise().done(fn);return this},slice:function(){return this.pushStack(core_slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},end:function(){return this.prevObject||this.constructor(null)},push:core_push,sort:[].sort,splice:[].splice};jQuery.fn.init.prototype=jQuery.fn;jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(typeof target!=="object"&&!jQuery.isFunction(target)){target={}}if(length===i){target=this;--i}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else{clone=src&&jQuery.isPlainObject(src)?src:{}}target[name]=jQuery.extend(deep,clone,copy)}else if(copy!==undefined){target[name]=copy}}}}return target};jQuery.extend({expando:"jQuery"+(core_version+Math.random()).replace(/\D/g,""),noConflict:function(deep){if(window.$===jQuery){window.$=_$}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery}return jQuery},isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++}else{jQuery.ready(true)}},ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return}if(!document.body){return setTimeout(jQuery.ready)}jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return}readyList.resolveWith(document,[jQuery]);if(jQuery.fn.trigger){jQuery(document).trigger("ready").off("ready")}},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array"},isWindow:function(obj){return obj!=null&&obj==obj.window},isNumeric:function(obj){return!isNaN(parseFloat(obj))&&isFinite(obj)},type:function(obj){if(obj==null){return String(obj)}return typeof obj==="object"||typeof obj==="function"?class2type[core_toString.call(obj)]||"object":typeof obj},isPlainObject:function(obj){var key;if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false}try{if(obj.constructor&&!core_hasOwn.call(obj,"constructor")&&!core_hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false}}catch(e){return false}if(jQuery.support.ownLast){for(key in obj){return core_hasOwn.call(obj,key)}}for(key in obj){}return key===undefined||core_hasOwn.call(obj,key)},isEmptyObject:function(obj){var name;for(name in obj){return false}return true},error:function(msg){throw new Error(msg)},parseHTML:function(data,context,keepScripts){if(!data||typeof data!=="string"){return null}if(typeof context==="boolean"){keepScripts=context;context=false}context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])]}parsed=jQuery.buildFragment([data],context,scripts);if(scripts){jQuery(scripts).remove()}return jQuery.merge([],parsed.childNodes)},parseJSON:function(data){if(window.JSON&&window.JSON.parse){return window.JSON.parse(data)}if(data===null){return data}if(typeof data==="string"){data=jQuery.trim(data);if(data){if(rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))){return new Function("return "+data)()}}}jQuery.error("Invalid JSON: "+data)},parseXML:function(data){var xml,tmp;if(!data||typeof data!=="string"){return null}try{if(window.DOMParser){tmp=new DOMParser;xml=tmp.parseFromString(data,"text/xml")}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data)}}catch(e){xml=undefined}if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data)}return xml},noop:function(){},globalEval:function(data){if(data&&jQuery.trim(data)){(window.execScript||function(data){window["eval"].call(window,data)})(data)}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray){for(;i<length;i++){value=callback.apply(obj[i],args);if(value===false){break}}}else{for(i in obj){value=callback.apply(obj[i],args);if(value===false){break}}}}else{if(isArray){for(;i<length;i++){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}else{for(i in obj){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}}return obj},trim:core_trim&&!core_trim.call("\ufeff ")?function(text){return text==null?"":core_trim.call(text)}:function(text){return text==null?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArraylike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr)}else{core_push.call(ret,arr)}}return ret},inArray:function(elem,arr,i){var len;if(arr){if(core_indexOf){return core_indexOf.call(arr,elem,i)}len=arr.length;i=i?i<0?Math.max(0,len+i):i:0;for(;i<len;i++){if(i in arr&&arr[i]===elem){return i}}}return-1},merge:function(first,second){var l=second.length,i=first.length,j=0;if(typeof l==="number"){for(;j<l;j++){first[i++]=second[j]}}else{while(second[j]!==undefined){first[i++]=second[j++]}}first.length=i;return first},grep:function(elems,callback,inv){var retVal,ret=[],i=0,length=elems.length;inv=!!inv;for(;i<length;i++){retVal=!!callback(elems[i],i);if(inv!==retVal){ret.push(elems[i])}}return ret},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret[ret.length]=value}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret[ret.length]=value}}}return core_concat.apply([],ret)},guid:1,proxy:function(fn,context){var args,proxy,tmp;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp}if(!jQuery.isFunction(fn)){return undefined}args=core_slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(core_slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy},access:function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=key==null;if(jQuery.type(key)==="object"){chainable=true;for(i in key){jQuery.access(elems,fn,i,key[i],true,emptyGet,raw)}}else if(value!==undefined){chainable=true;if(!jQuery.isFunction(value)){raw=true}if(bulk){if(raw){fn.call(elems,value);fn=null}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value)}}}if(fn){for(;i<length;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)))}}}return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},now:function(){return(new Date).getTime()},swap:function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name]}ret=callback.apply(elem,args||[]);for(name in options){elem.style[name]=old[name]}return ret}});jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if(document.readyState==="complete"){setTimeout(jQuery.ready)}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",completed,false);window.addEventListener("load",completed,false)}else{document.attachEvent("onreadystatechange",completed);window.attachEvent("onload",completed);var top=false;try{top=window.frameElement==null&&document.documentElement}catch(e){}if(top&&top.doScroll){(function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}detach();jQuery.ready()}})()}}}return readyList.promise(obj)};jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);if(jQuery.isWindow(obj)){return false}if(obj.nodeType===1&&length){return true}return type==="array"||type!=="function"&&(length===0||typeof length==="number"&&length>0&&length-1 in obj)}rootjQuery=jQuery(document);(function(window,undefined){var i,support,cachedruns,Expr,getText,isXML,compile,outermostContext,sortInput,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),hasDuplicate=false,sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}return 0},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){var i=0,len=this.length;for(;i<len;i++){if(this[i]===elem){return i}}return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rsibling=new RegExp(whitespace+"*[+~]"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){var j=target.length,i=0;while(target[j++]=els[i++]){}target.length=j-1}}}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context)}context=context||document;results=results||[];if(!selector||typeof selector!=="string"){return results}if((nodeType=context.nodeType)!==1&&nodeType!==9){return[]}if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector)){if(m=match[1]){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results}}else{return results}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results}else if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results}}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType===9&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if(old=context.getAttribute("id")){nid=old.replace(rescape,"\\$&")}else{context.setAttribute("id",nid)}nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i])}newContext=rsibling.test(selector)&&context.parentNode||context;newSelector=groups.join(",")}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results}catch(qsaError){}finally{if(!old){context.removeAttribute("id")}}}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){var keys=[];function cache(key,value){if(keys.push(key+=" ")>Expr.cacheLength){delete cache[keys.shift()]}return cache[key]=value}return cache}function markFunction(fn){fn[expando]=true;return fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return false}finally{if(div.parentNode){div.parentNode.removeChild(div)}div=null}}function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler}}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff}if(cur){while(cur=cur.nextSibling){if(cur===b){return-1}}}return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[j=matchIndexes[i]]){seed[j]=!(matches[j]=seed[j])}}})})}isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};support=Sizzle.support={};setDocument=Sizzle.setDocument=function(node){var doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document}document=doc;docElem=doc.documentElement;documentIsHTML=!isXML(doc);if(parent&&parent.attachEvent&&parent!==parent.top){parent.attachEvent("onbeforeunload",function(){setDocument()})}support.attributes=assert(function(div){div.className="i";return!div.getAttribute("className")});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return!div.getElementsByTagName("*").length});support.getElementsByClassName=assert(function(div){div.innerHTML="<div class='a'></div><div class='a i'></div>";div.firstChild.className="i";return div.getElementsByClassName("i").length===2});support.getById=assert(function(div){docElem.appendChild(div).id=expando;return!doc.getElementsByName||!doc.getElementsByName(expando).length});if(support.getById){Expr.find["ID"]=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}};Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}}else{delete Expr.find["ID"];Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}}Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag)}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while(elem=results[i++]){if(elem.nodeType===1){tmp.push(elem)}}return tmp}return results};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!==strundefined&&documentIsHTML){return context.getElementsByClassName(className)}};rbuggyMatches=[];rbuggyQSA=[];if(support.qsa=rnative.test(doc.querySelectorAll)){assert(function(div){div.innerHTML="<select><option selected=''></option></select>";if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")")}if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked")}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("t","");if(div.querySelectorAll("[t^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")")}if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled")}div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:")})}if(support.matchesSelector=rnative.test(matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos)})}rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));
contains=rnative.test(docElem.contains)||docElem.compareDocumentPosition?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))}:function(a,b){if(b){while(b=b.parentNode){if(b===a){return true}}}return false};sortOrder=docElem.compareDocumentPosition?function(a,b){if(a===b){hasDuplicate=true;return 0}var compare=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b);if(compare){if(compare&1||!support.sortDetached&&b.compareDocumentPosition(a)===compare){if(a===doc||contains(preferredDoc,a)){return-1}if(b===doc||contains(preferredDoc,b)){return 1}return sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0}return compare&4?-1:1}return a.compareDocumentPosition?-1:1}:function(a,b){var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(a===b){hasDuplicate=true;return 0}else if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0}else if(aup===bup){return siblingCheck(a,b)}cur=a;while(cur=cur.parentNode){ap.unshift(cur)}cur=b;while(cur=cur.parentNode){bp.unshift(cur)}while(ap[i]===bp[i]){i++}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0};return doc};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem)}expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret}}catch(e){}}return Sizzle(expr,document,null,[elem]).length>0};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context)}return contains(context,elem)};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem)}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val===undefined?support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null:val};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while(elem=results[i++]){if(elem===results[i]){j=duplicates.push(i)}}while(j--){results.splice(duplicates[j],1)}}return results};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){for(;node=elem[i];i++){ret+=getText(node)}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else if(nodeType===3||nodeType===4){return elem.nodeValue}return ret};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" "}return match.slice(0,4)},CHILD:function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0])}match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+(match[7]+match[8]||match[3]==="odd")}else if(match[3]){Sizzle.error(match[0])}return match},PSEUDO:function(match){var excess,unquoted=!match[5]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null}if(match[3]&&match[4]!==undefined){match[2]=match[4]}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess)}return match.slice(0,3)}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!="}if(!operator){return true}result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false}},CHILD:function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while(node=node[dir]){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false}}start=dir=type==="only"&&!start&&"nextSibling"}return true}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1]}else{while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff]}if(node===elem){break}}}}diff-=last;return diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument)}if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf.call(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i])}}):function(elem){return fn(elem,0,args)}}return fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if(elem=unmatched[i]){seed[i]=!(matches[i]=elem)}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);return!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang)}lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang")){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0}}while((elem=elem.parentNode)&&elem.nodeType===1);return false}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===false},disabled:function(elem){return elem.disabled===true},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName==="input"&&!!elem.checked||nodeName==="option"&&!!elem.selected},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeName>"@"||elem.nodeType===3||elem.nodeType===4){return false}}return true},parent:function(elem){return!Expr.pseudos["empty"](elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},text:function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()===elem.type)},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i)}return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i)}return matchIndexes})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i)}for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i)}function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters;function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0)}soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar}groups.push(tokens=[])}matched=false;if(match=rcombinators.exec(soFar)){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length)}for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length)}}if(!matched){break}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)}function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value}return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml)}}}:function(elem,context,xml){var data,cache,outerCache,dirkey=dirruns+" "+doneName;if(xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true}}}}else{while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((cache=outerCache[dir])&&cache[0]===dirkey){if((data=cache[1])===true||data===cachedruns){return data===true}}else{cache=outerCache[dir]=[dirkey];cache[1]=matcher(elem,context,xml)||cachedruns;if(cache[1]===true){return true}}}}}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false}}return true}:matchers[0]}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if(elem=unmatched[i]){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i)}}}}return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter)}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector)}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml)}if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if(elem=temp[i]){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if(elem=matcherOut[i]){temp.push(matcherIn[i]=elem)}}postFinder(null,matcherOut=[],temp,xml)}i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem)}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml)}else{push.apply(results,matcherOut)}}})}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,true),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];for(;i<len;i++){if(matcher=Expr.relative[tokens[i].type]){matchers=[addCombinator(elementMatcher(matchers),matcher)]}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var matcherCachedRuns=0,bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,expandContext){var elem,j,matcher,setMatched=[],matchedCount=0,i="0",unmatched=seed&&[],outermost=expandContext!=null,contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",expandContext&&context.parentNode||context),dirrunsUnique=dirruns+=contextBackup==null?1:Math.random()||.1;if(outermost){outermostContext=context!==document&&context;cachedruns=matcherCachedRuns}for(;(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while(matcher=elementMatchers[j++]){if(matcher(elem,context,xml)){results.push(elem);break}}if(outermost){dirruns=dirrunsUnique;cachedruns=++matcherCachedRuns}}if(bySet){if(elem=!matcher&&elem){matchedCount--}if(seed){unmatched.push(elem)}}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while(matcher=setMatchers[j++]){matcher(unmatched,setMatched,context,xml)}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results)}}}setMatched=condense(setMatched)}push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1){Sizzle.uniqueSort(results)}}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup}return unmatched};return bySet?markFunction(superMatcher):superMatcher}compile=Sizzle.compile=function(selector,group){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!group){group=tokenize(selector)}i=group.length;while(i--){cached=matcherFromTokens(group[i]);if(cached[expando]){setMatchers.push(cached)}else{elementMatchers.push(cached)}}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))}return cached};function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results)}return results}function select(selector,context,results,seed){var i,tokens,token,type,find,match=tokenize(selector);if(!seed){if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results}selector=selector.slice(tokens.shift().value.length)}i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[type=token.type]){break}if(find=Expr.find[type]){if(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&context.parentNode||context)){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results}break}}}}}compile(selector,match)(seed,context,!documentIsHTML,results,rsibling.test(selector));return results}support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#"})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2)}})}if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")===""})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue}})}if(!assert(function(div){return div.getAttribute("disabled")==null})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return(val=elem.getAttributeNode(name))&&val.specified?val.value:elem[name]===true?name.toLowerCase():null}})}jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains})(window);var optionsCache={};function createOptions(options){var object=optionsCache[options]={};jQuery.each(options.match(core_rnotwhite)||[],function(_,flag){object[flag]=true});return object}jQuery.Callbacks=function(options){options=typeof options==="string"?optionsCache[options]||createOptions(options):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){memory=options.memory&&data;fired=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;firing=true;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){memory=false;break}}firing=false;if(list){if(stack){if(stack.length){fire(stack.shift())}}else if(memory){list=[]}else{self.disable()}}},self={add:function(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);if(type==="function"){if(!options.unique||!self.has(arg)){list.push(arg)}}else if(arg&&arg.length&&type!=="string"){add(arg)}})})(arguments);if(firing){firingLength=list.length}else if(memory){firingStart=start;fire(memory)}}return this},remove:function(){if(list){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(firing){if(index<=firingLength){firingLength--}if(index<=firingIndex){firingIndex--}}}})}return this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length)},empty:function(){list=[];firingLength=0;return this},disable:function(){list=stack=memory=undefined;return this},disabled:function(){return!list},lock:function(){stack=undefined;if(!memory){self.disable()}return this},locked:function(){return!stack},fireWith:function(context,args){if(list&&(!fired||stack)){args=args||[];args=[context,args.slice?args.slice():args];if(firing){stack.push(args)}else{fire(args)}}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return!!fired}};return self};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){deferred.done(arguments).fail(arguments);return this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var action=tuple[0],fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify)}else{newDefer[action+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)}})});fns=null}).promise()},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString},tuples[i^1][2].disable,tuples[2][2].lock)}deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);return this};deferred[tuple[0]+"With"]=list.fireWith});promise.promise(deferred);if(func){func.call(deferred,deferred)}return deferred},when:function(subordinate){var i=0,resolveValues=core_slice.call(arguments),length=resolveValues.length,remaining=length!==1||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?core_slice.call(arguments):value;if(values===progressValues){deferred.notifyWith(contexts,values)}else if(!--remaining){deferred.resolveWith(contexts,values)}}},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;i<length;i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues))}else{--remaining}}}if(!remaining){deferred.resolveWith(resolveContexts,resolveValues)}return deferred.promise()}});jQuery.support=function(support){var all,a,input,select,fragment,opt,eventName,isSupported,i,div=document.createElement("div");div.setAttribute("className","t");div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";all=div.getElementsByTagName("*")||[];a=div.getElementsByTagName("a")[0];if(!a||!a.style||!all.length){return support}select=document.createElement("select");opt=select.appendChild(document.createElement("option"));input=div.getElementsByTagName("input")[0];a.style.cssText="top:1px;float:left;opacity:.5";support.getSetAttribute=div.className!=="t";support.leadingWhitespace=div.firstChild.nodeType===3;support.tbody=!div.getElementsByTagName("tbody").length;support.htmlSerialize=!!div.getElementsByTagName("link").length;support.style=/top/.test(a.getAttribute("style"));support.hrefNormalized=a.getAttribute("href")==="/a";support.opacity=/^0.5/.test(a.style.opacity);support.cssFloat=!!a.style.cssFloat;support.checkOn=!!input.value;support.optSelected=opt.selected;support.enctype=!!document.createElement("form").enctype;support.html5Clone=document.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>";support.inlineBlockNeedsLayout=false;support.shrinkWrapBlocks=false;support.pixelPosition=false;support.deleteExpando=true;support.noCloneEvent=true;support.reliableMarginRight=true;support.boxSizingReliable=true;input.checked=true;support.noCloneChecked=input.cloneNode(true).checked;select.disabled=true;support.optDisabled=!opt.disabled;try{delete div.test}catch(e){support.deleteExpando=false}input=document.createElement("input");input.setAttribute("value","");support.input=input.getAttribute("value")==="";input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t";input.setAttribute("checked","t");input.setAttribute("name","t");fragment=document.createDocumentFragment();fragment.appendChild(input);support.appendChecked=input.checked;support.checkClone=fragment.cloneNode(true).cloneNode(true).lastChild.checked;if(div.attachEvent){div.attachEvent("onclick",function(){support.noCloneEvent=false});div.cloneNode(true).click()}for(i in{submit:true,change:true,focusin:true}){div.setAttribute(eventName="on"+i,"t");support[i+"Bubbles"]=eventName in window||div.attributes[eventName].expando===false}div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";for(i in jQuery(support)){break}support.ownLast=i!=="0";jQuery(function(){var container,marginDiv,tds,divReset="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",body=document.getElementsByTagName("body")[0];if(!body){return}container=document.createElement("div");container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";body.appendChild(container).appendChild(div);div.innerHTML="<table><tr><td></td><td>t</td></tr></table>";tds=div.getElementsByTagName("td");tds[0].style.cssText="padding:0;margin:0;border:0;display:none";isSupported=tds[0].offsetHeight===0;tds[0].style.display="";tds[1].style.display="none";support.reliableHiddenOffsets=isSupported&&tds[0].offsetHeight===0;div.innerHTML="";div.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";jQuery.swap(body,body.style.zoom!=null?{zoom:1}:{},function(){support.boxSizing=div.offsetWidth===4});if(window.getComputedStyle){support.pixelPosition=(window.getComputedStyle(div,null)||{}).top!=="1%";support.boxSizingReliable=(window.getComputedStyle(div,null)||{width:"4px"}).width==="4px";marginDiv=div.appendChild(document.createElement("div"));marginDiv.style.cssText=div.style.cssText=divReset;marginDiv.style.marginRight=marginDiv.style.width="0";div.style.width="1px";support.reliableMarginRight=!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight)}if(typeof div.style.zoom!==core_strundefined){div.innerHTML="";div.style.cssText=divReset+"width:1px;padding:1px;display:inline;zoom:1";support.inlineBlockNeedsLayout=div.offsetWidth===3;div.style.display="block";div.innerHTML="<div></div>";div.firstChild.style.width="5px";support.shrinkWrapBlocks=div.offsetWidth!==3;if(support.inlineBlockNeedsLayout){body.style.zoom=1}}body.removeChild(container);container=div=tds=marginDiv=null});all=select=fragment=opt=a=input=null;return support}({});var rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rmultiDash=/([A-Z])/g;function internalData(elem,name,data,pvt){if(!jQuery.acceptData(elem)){return}var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if((!id||!cache[id]||!pvt&&!cache[id].data)&&data===undefined&&typeof name==="string"){return}if(!id){if(isNode){id=elem[internalKey]=core_deletedIds.pop()||jQuery.guid++}else{id=internalKey}}if(!cache[id]){cache[id]=isNode?{}:{toJSON:jQuery.noop}}if(typeof name==="object"||typeof name==="function"){if(pvt){cache[id]=jQuery.extend(cache[id],name)}else{cache[id].data=jQuery.extend(cache[id].data,name)}}thisCache=cache[id];if(!pvt){if(!thisCache.data){thisCache.data={}}thisCache=thisCache.data}if(data!==undefined){thisCache[jQuery.camelCase(name)]=data}if(typeof name==="string"){ret=thisCache[name];if(ret==null){ret=thisCache[jQuery.camelCase(name)]}}else{ret=thisCache}return ret}function internalRemoveData(elem,name,pvt){if(!jQuery.acceptData(elem)){return}var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(!cache[id]){return}if(name){thisCache=pvt?cache[id]:cache[id].data;if(thisCache){if(!jQuery.isArray(name)){if(name in thisCache){name=[name]}else{name=jQuery.camelCase(name);if(name in thisCache){name=[name]}else{name=name.split(" ")}}}else{name=name.concat(jQuery.map(name,jQuery.camelCase))}i=name.length;while(i--){delete thisCache[name[i]]}if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache)){return}}}if(!pvt){delete cache[id].data;if(!isEmptyDataObject(cache[id])){return}}if(isNode){jQuery.cleanData([elem],true)}else if(jQuery.support.deleteExpando||cache!=cache.window){delete cache[id]}else{cache[id]=null}}jQuery.extend({cache:{},noData:{applet:true,embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data){return internalData(elem,name,data)},removeData:function(elem,name){return internalRemoveData(elem,name)},_data:function(elem,name,data){return internalData(elem,name,data,true)},_removeData:function(elem,name){return internalRemoveData(elem,name,true)},acceptData:function(elem){if(elem.nodeType&&elem.nodeType!==1&&elem.nodeType!==9){return false}var noData=elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()];return!noData||noData!==true&&elem.getAttribute("classid")===noData}});jQuery.fn.extend({data:function(key,value){var attrs,name,data=null,i=0,elem=this[0];if(key===undefined){if(this.length){data=jQuery.data(elem);if(elem.nodeType===1&&!jQuery._data(elem,"parsedAttrs")){attrs=elem.attributes;for(;i<attrs.length;i++){name=attrs[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name])}
}jQuery._data(elem,"parsedAttrs",true)}}return data}if(typeof key==="object"){return this.each(function(){jQuery.data(this,key)})}return arguments.length>1?this.each(function(){jQuery.data(this,key,value)}):elem?dataAttr(elem,key,jQuery.data(elem,key)):null},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}});function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else{data=undefined}}return data}function isEmptyDataObject(obj){var name;for(name in obj){if(name==="data"&&jQuery.isEmptyObject(obj[name])){continue}if(name!=="toJSON"){return false}}return true}jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=jQuery._data(elem,type);if(data){if(!queue||jQuery.isArray(data)){queue=jQuery._data(elem,type,jQuery.makeArray(data))}else{queue.push(data)}}return queue||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};if(fn==="inprogress"){fn=queue.shift();startLength--}if(fn){if(type==="fx"){queue.unshift("inprogress")}delete hooks.stop;fn.call(elem,next,hooks)}if(!startLength&&hooks){hooks.empty.fire()}},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue");jQuery._removeData(elem,key)})})}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--}if(arguments.length<setter){return jQuery.queue(this[0],type)}return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)}})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},delay:function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!--count){defer.resolveWith(elements,[elements])}};if(typeof type!=="string"){obj=type;type=undefined}type=type||"fx";while(i--){tmp=jQuery._data(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve)}}resolve();return defer.promise(obj)}});var nodeHook,boolHook,rclass=/[\t\r\n\f]/g,rreturn=/\r/g,rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=jQuery.support.getSetAttribute,getSetInput=jQuery.support.input;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})},prop:function(name,value){return jQuery.access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name]}catch(e){}})},addClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed=typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(core_rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ");if(cur){j=0;while(clazz=classes[j++]){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" "}}elem.className=jQuery.trim(cur)}}}return this},removeClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed=arguments.length===0||typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(core_rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"");if(cur){j=0;while(clazz=classes[j++]){while(cur.indexOf(" "+clazz+" ")>=0){cur=cur.replace(" "+clazz+" "," ")}}elem.className=value?jQuery.trim(cur):""}}}return this},toggleClass:function(value,stateVal){var type=typeof value;if(typeof stateVal==="boolean"&&type==="string"){return stateVal?this.addClass(value):this.removeClass(value)}if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)})}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),classNames=value.match(core_rnotwhite)||[];while(className=classNames[i++]){if(self.hasClass(className)){self.removeClass(className)}else{self.addClass(className)}}}else if(type===core_strundefined||type==="boolean"){if(this.className){jQuery._data(this,"__className__",this.className)}this.className=this.className||value===false?"":jQuery._data(this,"__className__")||""}})},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){return true}}return false},val:function(value){var ret,hooks,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret}return}isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return}if(isFunction){val=value.call(this,i,jQuery(this).val())}else{val=value}if(val==null){val=""}else if(typeof val==="number"){val+=""}else if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""})}hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){this.value=val}})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:elem.text}},select:{get:function(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&(jQuery.support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value}values.push(value)}}return values},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if(option.selected=jQuery.inArray(jQuery(option).val(),values)>=0){optionSet=true}}if(!optionSet){elem.selectedIndex=-1}return values}}},attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}if(typeof elem.getAttribute===core_strundefined){return jQuery.prop(elem,name,value)}if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name)}else if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{elem.setAttribute(name,value+"");return value}}else if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret}else{ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(core_rnotwhite);if(attrNames&&elem.nodeType===1){while(name=attrNames[i++]){propName=jQuery.propFix[name]||name;if(jQuery.expr.match.bool.test(name)){if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem[propName]=false}else{elem[jQuery.camelCase("default-"+name)]=elem[propName]=false}}else{jQuery.attr(elem,name,"")}elem.removeAttribute(getSetAttribute?name:propName)}}},attrHooks:{type:{set:function(elem,value){if(!jQuery.support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val}return value}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}if(value!==undefined){return hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:elem[name]=value}else{return hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name]}},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}}});boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name)}else if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name)}else{elem[jQuery.camelCase("default-"+name)]=elem[name]=true}return name}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=jQuery.expr.attrHandle[name]||jQuery.find.attr;jQuery.expr.attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var fn=jQuery.expr.attrHandle[name],ret=isXML?undefined:(jQuery.expr.attrHandle[name]=undefined)!=getter(elem,name,isXML)?name.toLowerCase():null;jQuery.expr.attrHandle[name]=fn;return ret}:function(elem,name,isXML){return isXML?undefined:elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null}});if(!getSetInput||!getSetAttribute){jQuery.attrHooks.value={set:function(elem,value,name){if(jQuery.nodeName(elem,"input")){elem.defaultValue=value}else{return nodeHook&&nodeHook.set(elem,value,name)}}}}if(!getSetAttribute){nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(!ret){elem.setAttributeNode(ret=elem.ownerDocument.createAttribute(name))}ret.value=value+="";return name==="value"||value===elem.getAttribute(name)?value:undefined}};jQuery.expr.attrHandle.id=jQuery.expr.attrHandle.name=jQuery.expr.attrHandle.coords=function(elem,name,isXML){var ret;return isXML?undefined:(ret=elem.getAttributeNode(name))&&ret.value!==""?ret.value:null};jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);return ret&&ret.specified?ret.value:undefined},set:nodeHook.set};jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,value===""?false:value,name)}};jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value}}}})}if(!jQuery.support.hrefNormalized){jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)}}})}if(!jQuery.support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||undefined},set:function(elem,value){return elem.style.cssText=value+""}}}if(!jQuery.support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex}}return null}}}jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});if(!jQuery.support.enctype){jQuery.propFix.enctype="encoding"}jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value)){return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0}}};if(!jQuery.support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value}}});var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;function returnTrue(){return true}function returnFalse(){return false}function safeActiveElement(){try{return document.activeElement}catch(err){}}jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(!elemData){return}if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector}if(!handler.guid){handler.guid=jQuery.guid++}if(!(events=elemData.events)){events=elemData.events={}}if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!==core_strundefined&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.dispatch.apply(eventHandle.elem,arguments):undefined};eventHandle.elem=elem}types=(types||"").match(core_rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false)}else if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle)}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid}}if(selector){handlers.splice(handlers.delegateCount++,0,handleObj)}else{handlers.push(handleObj)}jQuery.event.global[type]=true}elem=null},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(!elemData||!(events=elemData.events)){return}types=(types||"").match(core_rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true)}continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--}if(special.remove){special.remove.call(elem,handleObj)}}}if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle)}delete events[type]}}if(jQuery.isEmptyObject(events)){delete elemData.handle;jQuery._removeData(elem,"events")}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=core_hasOwn.call(event,"type")?event.type:event,namespaces=core_hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return}if(rfocusMorph.test(type+jQuery.event.triggered)){return}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem}data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return}if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode}for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur}if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window)}}i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");if(handle){handle.apply(cur,data)}handle=ontype&&cur[ontype];if(handle&&jQuery.acceptData(cur)&&handle.apply&&handle.apply(cur,data)===false){event.preventDefault()}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&jQuery.acceptData(elem)){if(ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null}jQuery.event.triggered=type;try{elem[type]()}catch(e){}jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp}}}}return event.result},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=core_slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return}handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation()}}}}}if(special.postDispatch){special.postDispatch.call(this,event)}return event.result},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){for(;cur!=this;cur=cur.parentNode||this){if(cur.nodeType===1&&(cur.disabled!==true||event.type!=="click")){matches=[];for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matches[sel]===undefined){matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length}if(matches[sel]){matches.push(handleObj)}}if(matches.length){handlerQueue.push({elem:cur,handlers:matches})}}}}if(delegateCount<handlers.length){handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)})}return handlerQueue},fix:function(event){if(event[jQuery.expando]){return event}var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];if(!fixHook){this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}}copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;while(i--){prop=copy[i];event[prop]=originalEvent[prop]}if(!event.target){event.target=originalEvent.srcElement||document}if(event.target.nodeType===3){event.target=event.target.parentNode}event.metaKey=!!event.metaKey;return fixHook.filter?fixHook.filter(event,originalEvent):event},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode}return event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(!event.relatedTarget&&fromElement){event.relatedTarget=fromElement===event.target?original.toElement:fromElement}if(!event.which&&button!==undefined){event.which=button&1?1:button&2?3:button&4?2:0}return event}},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){try{this.focus();return false}catch(e){}}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(jQuery.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();return false}},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){if(event.result!==undefined){event.originalEvent.returnValue=event.result}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem)}else{jQuery.event.dispatch.call(elem,e)}if(e.isDefaultPrevented()){event.preventDefault()}}};jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false)}}:function(elem,type,handle){var name="on"+type;if(elem.detachEvent){if(typeof elem[name]===core_strundefined){elem[name]=null}elem.detachEvent(name,handle)}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props)}if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.returnValue===false||src.getPreventDefault&&src.getPreventDefault()?returnTrue:returnFalse}else{this.type=src}if(props){jQuery.extend(this,props)}this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true};jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(!e){return}if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(!e){return}if(e.stopPropagation){e.stopPropagation()}e.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation()}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||related!==target&&!jQuery.contains(target,related)){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});if(!jQuery.support.submitBubbles){jQuery.event.special.submit={setup:function(){if(jQuery.nodeName(this,"form")){return false}jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;if(form&&!jQuery._data(form,"submitBubbles")){jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=true});jQuery._data(form,"submitBubbles",true)}})},postDispatch:function(event){if(event._submit_bubble){delete event._submit_bubble;if(this.parentNode&&!event.isTrigger){jQuery.event.simulate("submit",this.parentNode,event,true)}}},teardown:function(){if(jQuery.nodeName(this,"form")){return false}jQuery.event.remove(this,"._submit")}}}if(!jQuery.support.changeBubbles){jQuery.event.special.change={setup:function(){if(rformElems.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){jQuery.event.add(this,"propertychange._change",function(event){if(event.originalEvent.propertyName==="checked"){this._just_changed=true}});jQuery.event.add(this,"click._change",function(event){if(this._just_changed&&!event.isTrigger){this._just_changed=false}jQuery.event.simulate("change",this,event,true)})}return false}jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;if(rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")){jQuery.event.add(elem,"change._change",function(event){if(this.parentNode&&!event.isSimulated&&!event.isTrigger){jQuery.event.simulate("change",this.parentNode,event,true)}});jQuery._data(elem,"changeBubbles",true)}})},handle:function(event){var elem=event.target;if(this!==elem||event.isSimulated||event.isTrigger||elem.type!=="radio"&&elem.type!=="checkbox"){return event.handleObj.handler.apply(this,arguments)}},teardown:function(){jQuery.event.remove(this,"._change");return!rformElems.test(this.nodeName)}}}if(!jQuery.support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0,handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true)};jQuery.event.special[fix]={setup:function(){if(attaches++===0){document.addEventListener(orig,handler,true)}},teardown:function(){if(--attaches===0){document.removeEventListener(orig,handler,true)}}}})}jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined}for(type in types){this.on(type,selector,data,types[type],one)}return this}if(data==null&&fn==null){fn=selector;data=selector=undefined}else if(fn==null){if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}}if(fn===false){fn=returnFalse}else if(!fn){return this}if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this}if(typeof types==="object"){for(type in types){this.off(type,selector,types[type])}return this}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined}if(fn===false){fn=returnFalse}return this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true)}}});var isSimple=/^.[^:#\[\.,]*$/,rparentsprev=/^(?:parents|prev(?:Until|All))/,rneedsContext=jQuery.expr.match.needsContext,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true}}}))}for(i=0;i<len;i++){jQuery.find(selector,self[i],ret)}ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret},has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;i<len;i++){if(jQuery.contains(this,targets[i])){return true}}})},not:function(selector){return this.pushStack(winnow(this,selector||[],true))},filter:function(selector){return this.pushStack(winnow(this,selector||[],false))},is:function(selector){return!!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length},closest:function(selectors,context){var cur,i=0,l=this.length,ret=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){cur=ret.push(cur);break}}}return this.pushStack(ret.length>1?jQuery.unique(ret):ret)},index:function(elem){if(!elem){return this[0]&&this[0].parentNode?this.first().prevAll().length:-1}if(typeof elem==="string"){return jQuery.inArray(this[0],jQuery(elem))}return jQuery.inArray(elem.jquery?elem[0]:elem,this)},add:function(selector,context){var set=typeof selector==="string"?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(jQuery.unique(all))},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}});function sibling(cur,dir){do{cur=cur[dir]}while(cur&&cur.nodeType!==1);return cur}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until}if(selector&&typeof selector==="string"){ret=jQuery.filter(selector,ret)}if(this.length>1){if(!guaranteedUnique[name]){ret=jQuery.unique(ret)}if(rparentsprev.test(name)){ret=ret.reverse()}}return this.pushStack(ret)}});jQuery.extend({filter:function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")"}return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1;
}))},dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1){matched.push(cur)}cur=cur[dir]}return matched},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){r.push(n)}}return r}});function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not})}if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return elem===qualifier!==not})}if(typeof qualifier==="string"){if(isSimple.test(qualifier)){return jQuery.filter(qualifier,elements,not)}qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return jQuery.inArray(elem,qualifier)>=0!==not})}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement){while(list.length){safeFrag.createElement(list.pop())}}return safeFrag}var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|"+"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,manipulation_rcheckableType=/^(?:checkbox|radio)$/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;jQuery.fn.extend({text:function(value){return jQuery.access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this)}})},after:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling)}})},remove:function(selector,keepData){var elem,elems=selector?jQuery.filter(selector,this):this,i=0;for(;(elem=elems[i])!=null;i++){if(!keepData&&elem.nodeType===1){jQuery.cleanData(getAll(elem))}if(elem.parentNode){if(keepData&&jQuery.contains(elem.ownerDocument,elem)){setGlobalEval(getAll(elem,"script"))}elem.parentNode.removeChild(elem)}}return this},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false))}while(elem.firstChild){elem.removeChild(elem.firstChild)}if(elem.options&&jQuery.nodeName(elem,"select")){elem.options.length=0}}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return jQuery.access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined){return elem.nodeType===1?elem.innerHTML.replace(rinlinejQuery,""):undefined}if(typeof value==="string"&&!rnoInnerhtml.test(value)&&(jQuery.support.htmlSerialize||!rnoshimcache.test(value))&&(jQuery.support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value}}elem=0}catch(e){}}if(elem){this.empty().append(value)}},null,value,arguments.length)},replaceWith:function(){var args=jQuery.map(this,function(elem){return[elem.nextSibling,elem.parentNode]}),i=0;this.domManip(arguments,function(elem){var next=args[i++],parent=args[i++];if(parent){if(next&&next.parentNode!==parent){next=this.nextSibling}jQuery(this).remove();parent.insertBefore(elem,next)}},true);return i?this:this.remove()},detach:function(selector){return this.remove(selector,true)},domManip:function(args,callback,allowIntersection){args=core_concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||!(l<=1||typeof value!=="string"||jQuery.support.checkClone||!rchecked.test(value))){return this.each(function(index){var self=set.eq(index);if(isFunction){args[0]=value.call(this,index,self.html())}self.domManip(args,callback,allowIntersection)})}if(l){fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,!allowIntersection&&this);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first}if(first){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"))}}callback.call(this[i],node,i)}if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src){jQuery._evalUrl(node.src)}else{jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,""))}}}}fragment=first=null}}return this}});function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType===1?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){elem.type=(jQuery.find.attr(elem,"type")!==null)+"/"+elem.type;return elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);if(match){elem.type=match[1]}else{elem.removeAttribute("type")}return elem}function setGlobalEval(elems,refElements){var elem,i=0;for(;(elem=elems[i])!=null;i++){jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))}}function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src)){return}var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle;curData.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i])}}}if(curData.data){curData.data=jQuery.extend({},curData.data)}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(dest.nodeType!==1){return}nodeName=dest.nodeName.toLowerCase();if(!jQuery.support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events){jQuery.removeEvent(dest,e,data.handle)}dest.removeAttribute(jQuery.expando)}if(nodeName==="script"&&dest.text!==src.text){disableScript(dest).text=src.text;restoreScript(dest)}else if(nodeName==="object"){if(dest.parentNode){dest.outerHTML=src.outerHTML}if(jQuery.support.html5Clone&&(src.innerHTML&&!jQuery.trim(dest.innerHTML))){dest.innerHTML=src.innerHTML}}else if(nodeName==="input"&&manipulation_rcheckableType.test(src.type)){dest.defaultChecked=dest.checked=src.checked;if(dest.value!==src.value){dest.value=src.value}}else if(nodeName==="option"){dest.defaultSelected=dest.selected=src.defaultSelected}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue}}jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);core_push.apply(ret,elems.get())}return this.pushStack(ret)}});function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==core_strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==core_strundefined?context.querySelectorAll(tag||"*"):undefined;if(!found){for(found=[],elems=context.childNodes||context;(elem=elems[i])!=null;i++){if(!tag||jQuery.nodeName(elem,tag)){found.push(elem)}else{jQuery.merge(found,getAll(elem,tag))}}}return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found}function fixDefaultChecked(elem){if(manipulation_rcheckableType.test(elem.type)){elem.defaultChecked=elem.checked}}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(jQuery.support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")){clone=elem.cloneNode(true)}else{fragmentDiv.innerHTML=elem.outerHTML;fragmentDiv.removeChild(clone=fragmentDiv.firstChild)}if((!jQuery.support.noCloneEvent||!jQuery.support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0;(node=srcElements[i])!=null;++i){if(destElements[i]){fixCloneNodeIssues(node,destElements[i])}}}if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0;(node=srcElements[i])!=null;i++){cloneCopyEvent(node,destElements[i])}}else{cloneCopyEvent(elem,clone)}}destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"))}destElements=srcElements=node=null;return clone},buildFragment:function(elems,context,scripts,selection){var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(jQuery.type(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem)}else if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem))}else{tmp=tmp||safe.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild}if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem)){nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0]))}if(!jQuery.support.tbody){elem=tag==="table"&&!rtbody.test(elem)?tmp.firstChild:wrap[1]==="<table>"&&!rtbody.test(elem)?tmp:0;j=elem&&elem.childNodes.length;while(j--){if(jQuery.nodeName(tbody=elem.childNodes[j],"tbody")&&!tbody.childNodes.length){elem.removeChild(tbody)}}}jQuery.merge(nodes,tmp.childNodes);tmp.textContent="";while(tmp.firstChild){tmp.removeChild(tmp.firstChild)}tmp=safe.lastChild}}}if(tmp){safe.removeChild(tmp)}if(!jQuery.support.appendChecked){jQuery.grep(getAll(nodes,"input"),fixDefaultChecked)}i=0;while(elem=nodes[i++]){if(selection&&jQuery.inArray(elem,selection)!==-1){continue}contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(safe.appendChild(elem),"script");if(contains){setGlobalEval(tmp)}if(scripts){j=0;while(elem=tmp[j++]){if(rscriptType.test(elem.type||"")){scripts.push(elem)}}}}tmp=null;return safe},cleanData:function(elems,acceptData){var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=jQuery.support.deleteExpando,special=jQuery.event.special;for(;(elem=elems[i])!=null;i++){if(acceptData||jQuery.acceptData(elem)){id=elem[internalKey];data=id&&cache[id];if(data){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type)}else{jQuery.removeEvent(elem,type,data.handle)}}}if(cache[id]){delete cache[id];if(deleteExpando){delete elem[internalKey]}else if(typeof elem.removeAttribute!==core_strundefined){elem.removeAttribute(internalKey)}else{elem[internalKey]=null}core_deletedIds.push(id)}}}}},_evalUrl:function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:false,global:false,"throws":true})}});jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))})}if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0])}wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1){elem=elem.firstChild}return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))})}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html)}else{self.append(html)}})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes)}}).end()}});var iframe,getStyles,curCSS,ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rposition=/^(top|right|bottom|left)$/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rmargin=/^margin/,rnumsplit=new RegExp("^("+core_pnum+")(.*)$","i"),rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rrelNum=new RegExp("^([+-])=("+core_pnum+")","i"),elemdisplay={BODY:"block"},cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssExpand=["Top","Right","Bottom","Left"],cssPrefixes=["Webkit","O","Moz","ms"];function vendorPropName(style,name){if(name in style){return name}var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name}}return origName}function isHidden(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem)}function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue}values[index]=jQuery._data(elem,"olddisplay");display=elem.style.display;if(show){if(!values[index]&&display==="none"){elem.style.display=""}if(elem.style.display===""&&isHidden(elem)){values[index]=jQuery._data(elem,"olddisplay",css_defaultDisplay(elem.nodeName))}}else{if(!values[index]){hidden=isHidden(elem);if(display&&display!=="none"||!hidden){jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))}}}}for(index=0;index<length;index++){elem=elements[index];if(!elem.style){continue}if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none"}}return elements}jQuery.fn.extend({css:function(name,value){return jQuery.access(this,function(elem,name,value){var len,styles,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles)}return map}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,true)},hide:function(){return showHide(this)},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide()}return this.each(function(){if(isHidden(this)){jQuery(this).show()}else{jQuery(this).hide()}})}});jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret}}}},cssNumber:{columnCount:true,fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return}var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));type="number"}if(value==null||type==="number"&&isNaN(value)){return}if(type==="number"&&!jQuery.cssNumber[origName]){value+="px"}if(!jQuery.support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit"}if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined){try{style[name]=value}catch(e){}}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret}return style[name]}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get"in hooks){val=hooks.get(elem,true,extra)}if(val===undefined){val=curCSS(elem,name,styles)}if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name]}if(extra===""||extra){num=parseFloat(val);return extra===true||jQuery.isNumeric(num)?num||0:val}return val}});if(window.getComputedStyle){getStyles=function(elem){return window.getComputedStyle(elem,null)};curCSS=function(elem,name,_computed){var width,minWidth,maxWidth,computed=_computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:undefined,style=elem.style;if(computed){if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name)}if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth}}return ret}}else if(document.documentElement.currentStyle){getStyles=function(elem){return elem.currentStyle};curCSS=function(elem,name,_computed){var left,rs,rsLeft,computed=_computed||getStyles(elem),ret=computed?computed[name]:undefined,style=elem.style;if(ret==null&&style&&style[name]){ret=style[name]}if(rnumnonpx.test(ret)&&!rposition.test(name)){left=style.left;rs=elem.runtimeStyle;rsLeft=rs&&rs.left;if(rsLeft){rs.left=elem.currentStyle.left}style.left=name==="fontSize"?"1em":ret;ret=style.pixelLeft+"px";style.left=left;if(rsLeft){rs.left=rsLeft}}return ret===""?"auto":ret}}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],true,styles)}if(isBorderBox){if(extra==="content"){val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles)}if(extra!=="margin"){val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}else{val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(extra!=="padding"){val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}}return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=true,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=jQuery.support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box";if(val<=0||val==null){val=curCSS(elem,name,styles);if(val<0||val==null){val=elem.style[name]}if(rnumnonpx.test(val)){return val}valueIsBorderBox=isBorderBox&&(jQuery.support.boxSizingReliable||val===elem.style[name]);val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function css_defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if(display==="none"||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(doc.documentElement);doc=(iframe[0].contentWindow||iframe[0].contentDocument).document;doc.write("<!doctype html><html><body>");doc.close();display=actualDisplay(nodeName,doc);iframe.detach()}elemdisplay[nodeName]=display}return display}function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=jQuery.css(elem[0],"display");elem.remove();return display}jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){return elem.offsetWidth===0&&rdisplayswap.test(jQuery.css(elem,"display"))?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra)}},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,jQuery.support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",styles):0)}}});if(!jQuery.support.opacity){jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1;if((value>=1||value==="")&&jQuery.trim(filter.replace(ralpha,""))===""&&style.removeAttribute){style.removeAttribute("filter");if(value===""||currentStyle&&!currentStyle.filter){return}}style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity}}}jQuery(function(){if(!jQuery.support.reliableMarginRight){jQuery.cssHooks.marginRight={get:function(elem,computed){if(computed){return jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"])}}}}if(!jQuery.support.pixelPosition&&jQuery.fn.position){jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]={get:function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed}}}})}});if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||!jQuery.support.reliableHiddenOffsets&&(elem.style&&elem.style.display||jQuery.css(elem,"display"))==="none"};jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)}}jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0]}return expanded}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber}});var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!manipulation_rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():value==null?"":value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional}if(jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a)){jQuery.each(a,function(){add(this.name,this.value)})}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add)}}return s.join("&").replace(r20,"+")};function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add)}})}else if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)}}else{add(prefix,obj)}}jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}});jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var ajaxLocParts,ajaxLocation,ajax_nonce=jQuery.now(),ajax_rquery=/\?/,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_load=jQuery.fn.load,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(core_rnotwhite)||[];if(jQuery.isFunction(func)){while(dataType=dataTypes[i++]){if(dataType[0]==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func)}else{(structure[dataType]=structure[dataType]||[]).push(func)}}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=structure===transports;function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false}else if(seekingTransport){return!(selected=dataTypeOrTransport)}});return selected}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:deep||(deep={}))[key]=src[key]}}if(deep){jQuery.extend(true,target,deep)}return target}jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments)}var selector,response,type,self=this,off=url.indexOf(" ");if(off>=0){selector=url.slice(off,url.length);url=url.slice(0,off)}if(jQuery.isFunction(params)){callback=params;params=undefined}else if(params&&typeof params==="object"){type="POST"}if(self.length>0){jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])})}return this};jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}});jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while(match=rheaders.exec(responseHeadersString)){responseHeaders[match[1].toLowerCase()]=match[2]}}match=responseHeaders[key.toLowerCase()]}return match==null?null:match},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},overrideMimeType:function(type){if(!state){s.mimeType=type}return this},statusCode:function(map){var code;if(map){if(state<2){for(code in map){statusCode[code]=[statusCode[code],map[code]]}}else{jqXHR.always(map[jqXHR.status])}}return this},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText)}done(0,finalText);return this}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(core_rnotwhite)||[""];
if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?"80":"443"))!==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443"))))}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return jqXHR}fireGlobals=s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")}s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=s.url+=(ajax_rquery.test(cacheURL)?"&":"?")+s.data;delete s.data}if(s.cache===false){s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+ajax_nonce++):cacheURL+(ajax_rquery.test(cacheURL)?"&":"?")+"_="+ajax_nonce++}}if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL])}if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){return jqXHR.abort()}strAbort="abort";for(i in{success:1,error:1,complete:1}){jqXHR[i](s[i])}transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport")}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])}if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout)}try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<2){done(-1,e)}else{throw e}}}function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(state===2){return}state=2;if(timeoutTimer){clearTimeout(timeoutTimer)}transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses)}response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified}modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified}}if(status===204||s.type==="HEAD"){statusText="nocontent"}else if(status===304){statusText="notmodified"}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0}}}jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])}jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error])}completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!--jQuery.active){jQuery.event.trigger("ajaxStop")}}}return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}});function ajaxHandleResponses(s,jqXHR,responses){var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type")}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}}}if(dataTypes[0]in responses){finalDataType=dataTypes[0]}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType){firstDataType=type}}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)}return responses[finalDataType]}}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv]}}current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response}if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType)}prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev}else if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2]}else if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1])}break}}}}if(conv!==true){if(conv&&s["throws"]){response=conv(response)}else{try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}}}}}return{state:"success",data:response}}jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false}if(s.crossDomain){s.type="GET";s.global=false}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async=true;if(s.scriptCharset){script.charset=s.scriptCharset}script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(script.parentNode){script.parentNode.removeChild(script)}script=null;if(!isAbort){callback(200,"success")}}};head.insertBefore(script,head.firstChild)},abort:function(){if(script){script.onload(undefined,true)}}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+ajax_nonce++;this[callback]=true;return callback}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName)}else if(s.jsonp!==false){s.url+=(ajax_rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName}s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called")}return responseContainer[0]};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments};jqXHR.always(function(){window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName)}if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0])}responseContainer=overwritten=undefined});return"script"}});var xhrCallbacks,xhrSupported,xhrId=0,xhrOnUnloadAbort=window.ActiveXObject&&function(){var key;for(key in xhrCallbacks){xhrCallbacks[key](undefined,true)}};function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return!this.isLocal&&createStandardXHR()||createActiveXHR()}:createStandardXHR;xhrSupported=jQuery.ajaxSettings.xhr();jQuery.support.cors=!!xhrSupported&&"withCredentials"in xhrSupported;xhrSupported=jQuery.support.ajax=!!xhrSupported;if(xhrSupported){jQuery.ajaxTransport(function(s){if(!s.crossDomain||jQuery.support.cors){var callback;return{send:function(headers,complete){var handle,i,xhr=s.xhr();if(s.username){xhr.open(s.type,s.url,s.async,s.username,s.password)}else{xhr.open(s.type,s.url,s.async)}if(s.xhrFields){for(i in s.xhrFields){xhr[i]=s.xhrFields[i]}}if(s.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(s.mimeType)}if(!s.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}try{for(i in headers){xhr.setRequestHeader(i,headers[i])}}catch(err){}xhr.send(s.hasContent&&s.data||null);callback=function(_,isAbort){var status,responseHeaders,statusText,responses;try{if(callback&&(isAbort||xhr.readyState===4)){callback=undefined;if(handle){xhr.onreadystatechange=jQuery.noop;if(xhrOnUnloadAbort){delete xhrCallbacks[handle]}}if(isAbort){if(xhr.readyState!==4){xhr.abort()}}else{responses={};status=xhr.status;responseHeaders=xhr.getAllResponseHeaders();if(typeof xhr.responseText==="string"){responses.text=xhr.responseText}try{statusText=xhr.statusText}catch(e){statusText=""}if(!status&&s.isLocal&&!s.crossDomain){status=responses.text?200:404}else if(status===1223){status=204}}}}catch(firefoxAccessException){if(!isAbort){complete(-1,firefoxAccessException)}}if(responses){complete(status,statusText,responses,responseHeaders)}};if(!s.async){callback()}else if(xhr.readyState===4){setTimeout(callback)}else{handle=++xhrId;if(xhrOnUnloadAbort){if(!xhrCallbacks){xhrCallbacks={};jQuery(window).unload(xhrOnUnloadAbort)}xhrCallbacks[handle]=callback}xhr.onreadystatechange=callback}},abort:function(){if(callback){callback(undefined,true)}}}}})}var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+core_pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3];parts=parts||[];start=+target||1;do{scale=scale||".5";start=start/scale;jQuery.style(tween.elem,prop,start+unit)}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations)}if(parts){start=tween.start=+start||+target||0;tween.unit=unit;tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]}return tween}]};function createFxNow(){setTimeout(function(){fxNow=undefined});return fxNow=jQuery.now()}function createTween(value,prop,animation){var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if(tween=collection[index].call(animation,prop,value)){return tween}}}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped){return false}var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent)}deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining}else{deferred.resolveWith(elem,[animation]);return false}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this}stopped=true;for(;index<length;index++){animation.tweens[index].run(1)}if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd])}else{deferred.rejectWith(elem,[animation,gotoEnd])}return this}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);if(result){return result}}jQuery.map(props,createTween,animation);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation)}jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0]}if(index!==name){props[name]=value;delete props[index]}hooks=jQuery.cssHooks[name];if(hooks&&"expand"in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing}}}else{specialEasing[name]=easing}}}jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"]}else{props=props.split(" ")}var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];tweeners[prop]=tweeners[prop]||[];tweeners[prop].unshift(callback)}},prefilter:function(callback,prepend){if(prepend){animationPrefilters.unshift(callback)}else{animationPrefilters.push(callback)}}});function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire()}}}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire()}})})}if(elem.nodeType===1&&("height"in props||"width"in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];if(jQuery.css(elem,"display")==="inline"&&jQuery.css(elem,"float")==="none"){if(!jQuery.support.inlineBlockNeedsLayout||css_defaultDisplay(elem.nodeName)==="inline"){style.display="inline-block"}else{style.zoom=1}}}if(opts.overflow){style.overflow="hidden";if(!jQuery.support.shrinkWrapBlocks){anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2]})}}for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){continue}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}}if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden"in dataShow){hidden=dataShow.hidden}}else{dataShow=jQuery._data(elem,"fxshow",{})}if(toggle){dataShow.hidden=!hidden}if(hidden){jQuery(elem).show()}else{anim.done(function(){jQuery(elem).hide()})}anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop])}});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0}}}}}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||"swing";this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration)}else{this.pos=eased=percent}this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(hooks&&hooks.set){hooks.set(this)}else{Tween.propHooks._default.set(this)}return this}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop]}result=jQuery.css(tween.elem,tween.prop,"");return!result||result==="auto"?0:result},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween)}else if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}else{tween.elem[tween.prop]=tween.now}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now}}};jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback)}});jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||jQuery._data(this,"finish")){anim.stop(true)}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd)};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}if(clearQueue&&type!==false){this.queue(type||"fx",[])}return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index])}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index])}}}for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1)}}if(dequeue||!gotoEnd){jQuery.dequeue(this,type)}})},finish:function(type){if(type!==false){type=type||"fx"}return this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true)}for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1)}}for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this)}}delete data.finish})}});function genFx(type,includeWidth){var which,attrs={height:type},i=0;includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type}if(includeWidth){attrs.opacity=attrs.width=type}return attrs}jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx"}opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this)}if(opt.queue){jQuery.dequeue(this,opt.queue)}};return opt};jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}};jQuery.timers=[];jQuery.fx=Tween.prototype.init;jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1)}}if(!timers.length){jQuery.fx.stop()}fxNow=undefined};jQuery.fx.timer=function(timer){if(timer()&&jQuery.timers.push(timer)){jQuery.fx.start()}};jQuery.fx.interval=13;jQuery.fx.start=function(){if(!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval)}};jQuery.fx.stop=function(){clearInterval(timerId);timerId=null};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fx.step={};if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length}}jQuery.fn.offset=function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)})}var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(!doc){return}docElem=doc.documentElement;if(!jQuery.contains(docElem,elem)){return box}if(typeof elem.getBoundingClientRect!==core_strundefined){box=elem.getBoundingClientRect()}win=getWindow(doc);return{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}};jQuery.offset={setOffset:function(elem,options,i){var position=jQuery.css(elem,"position");if(position==="static"){elem.style.position="relative"}var curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={},curTop,curLeft;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset)}if(options.top!=null){props.top=options.top-curOffset.top+curTop}if(options.left!=null){props.left=options.left-curOffset.left+curLeft}if("using"in options){options.using.call(elem,props)}else{curElem.css(props)}}};jQuery.fn.extend({position:function(){if(!this[0]){return}var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect()}else{offsetParent=this.offsetParent();offset=this.offset();if(!jQuery.nodeName(offsetParent[0],"html")){parentOffset=offsetParent.offset()}parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true)}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||docElem;while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent}return offsetParent||docElem})}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return jQuery.access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?prop in win?win[prop]:win.document.documentElement[method]:elem[method]}if(win){win.scrollTo(!top?val:jQuery(win).scrollLeft(),top?val:jQuery(win).scrollTop())}else{elem[method]=val}},method,val,arguments.length,null)}});function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false}jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return jQuery.access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name]}if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])}return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})});jQuery.fn.size=function(){return this.length};jQuery.fn.andSelf=jQuery.fn.addBack;if(typeof module==="object"&&module&&typeof module.exports==="object"){module.exports=jQuery}else{window.jQuery=window.$=jQuery;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery})}}})(window);(function(global,loc,$){var adBlockQueue=global.adBlockQueue=global.adBlockQueue||[];$.support.cors=true;var ABE=global.ABE=global.ABE||{};var queryParams={};if(!ABE.startTime){ABE.startTime=(new Date).getTime()}if(!ABE.elapsedTime){ABE.elapsedTime=function(){return(new Date).getTime()-ABE.startTime}}try{loc.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(str,key,value){queryParams[key]=value})}catch(e){console.log("Error while parsing query parameters",e)}if(/^localhost:\d+$/.test(queryParams.wc)){ABE.wcserver="http://"+queryParams.wc+"/gb/desktop"+loc.pathname+loc.search}adBlockQueue.push(prepare);function prepare(blocked){if(!blocked)return;$.ajax({url:ABE.wcserver,method:"POST",crossDomain:true,xhrFields:{withCredentials:true},headers:{"mola-method":"init"},dataType:"json",data:{elapsed:ABE.elapsedTime()}}).then(init)}function init(payload){$.globalEval(payload.js);ABE.init&&ABE.init(payload.params)}})(window,window.location,jQuery);(function(root,factory){if(typeof define==="function"&&define.amd){define(["jquery","mol-page-events/page-events"],factory)}else{factory(root.jQuery,root.DM.pageEvents)}})(this,function($,pageEvents){var hasPlaceholder=function(){return"placeholder"in document.createElement("input")}();var hasAutofocus=function(){return"autofocus"in document.createElement("input")}();function placeholder(inputsOrSelector,context){var attributesToCopy=["font-size","font-weight"];if(hasPlaceholder)return;var inputs=inputsOrSelector.jquery?inputsOrSelector:context?$(inputsOrSelector,context.jquery?context:$(context)):$(inputsOrSelector);inputs.each(function(){var input=$(this);var placeholderText=input.attr("placeholder");if(!placeholderText)return;if(input.next().is("span.placeholder")){input.trigger("change");return}var placeholder=$('<span class="placeholder">'+placeholderText+"</span>");placeholder.css(input.css(attributesToCopy));placeholder.css({"line-height":input.outerHeight()+"px","margin-left":input.css("padding-left")});var parent=input.parent();var parentPosition=parent.css("position");if(parentPosition!=="absolute"&&parentPosition!=="relative")parent.css("position","relative");input.after(placeholder);placeholder.css({position:"absolute",top:input.position().top+"px",left:input.position().left+"px"});input.on("change keyup",function(){placeholder[input.val()?"hide":"show"]()});input.trigger("change");placeholder.on("click",function(){input.focus()})})}pageEvents.listen(pageEvents.FRAGMENT_LOADED,function(obs,type,node){if(!hasAutofocus){$("input[autofocus]",node).eq(0).focus()}placeholder("input[placeholder]",node)});$(document).ready(function(){pageEvents.fireEvent(pageEvents.FRAGMENT_LOADED,this)})});DM.m={};DM.has=function(id,type,params){type=type||id;if(!this.m[type]){this.m[type]=[]}this.m[type].push({id:id,params:params})};DM.setCookie=function(szName,szValue,szExpires,szPath,szDomain,bSecure){var szCookieText=escape(szName)+"="+escape(szValue);szCookieText+=szExpires?";expires="+szExpires.toGMTString():"";szCookieText+=szPath?";path="+szPath:"";szCookieText+=szDomain?";domain="+szDomain:"";szCookieText+=bSecure?";secure":"";document.cookie=szCookieText};DM.getCookie=function(szName){var szValue=null;if(document.cookie){var arr=document.cookie.split(escape(szName)+"=");if(2<=arr.length){szValue=unescape(arr[1].split(";")[0]);if(szValue.length>1&&szValue.charAt(0)==='"'&&szValue.charAt(szValue.length-1)==='"'){szValue=szValue.substring(1,szValue.length-1)}}}return szValue};DM.deleteCookie=function(szName){var tmp=DM.getCookie(szName);if(tmp)DM.setCookie(szName,tmp,new Date(1))};DM.popup=function(url,w,h){var _popupFeatures="menubar=false,location=false,statusbar=false,toolbar=false,resizable=false",_popupfpFeatures="resizable=1,scrollbars=1",nw=window.open(url,"_blank","width="+w+",height="+h+","+_popupFeatures+","+_popupfpFeatures);nw.focus();return nw};(function($){var windowMessaging=function(){return{postMessage:function(message,target_url,target){target_url=target_url||"*";target=target||window.parent;if(window["postMessage"]){target["postMessage"](message,target_url.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}},receiveMessage:function(callback){if(window["postMessage"]){if(window["addEventListener"]){window[callback?"addEventListener":"removeEventListener"]("message",callback,!1)}else{window[callback?"attachEvent":"detachEvent"]("onmessage",callback)}}}}}();$.iframely=$.iframely||{};$.iframely.iframes=$.iframely.iframes||{};windowMessaging.receiveMessage(function(e){var $iframe;try{var data=JSON.parse(e.data)}catch(e){var data={}}if(data&&data.windowId&&($iframe=$.iframely.iframes[data.windowId])){if($.iframely.setIframeHeight&&data.method=="resize"&&data.height){$.iframely.setIframeHeight($iframe,data.height)}}});$.iframely.setIframeHeight=function($iframe,height){var $parent=$iframe.parents(".iframely-widget-container");if($parent.length>0){$parent.css("padding-bottom","").css("height",height)}else{$iframe.css("height",height)}};$.iframely.registerIframesIn=function($parent){$parent.find("iframe.iframely-iframe").each(function(){var $iframe=$(this);if($iframe.attr("iframely-registered")){return}$iframe.attr("iframely-registered",true);var iframesCounter=$.iframely.iframesCounter=($.iframely.iframesCounter||0)+1;$.iframely.iframes[iframesCounter]=$iframe;windowMessaging.postMessage(JSON.stringify({method:"register",windowId:iframesCounter}),"*",this.contentWindow)})};$(function(){var iframelyContainer=$("#content");$.iframely.registerIframesIn(iframelyContainer)})})(jQuery);DM.Tabs=Ext.extend(Ext.util.Observable,{linkHk:".js-links",activeHk:".js-active",tabIdPrefix:"t-",tabsQuery:".dm-tab",panesQuery:".dm-tab-pane",tabOffClass:null,tabOnClass:null,
paneOffClass:"dm-tab-pane-hidden",_onLoadCallBack:null,constructor:function(id,config){DM.Tabs.superclass.constructor.call(this);config&&Ext.apply(this,config);this.el=Ext.get(id);this.tabCnt=Ext.get(this.el.query(this.linkHk)[0]);if(!this.tabCnt)return;this.tabCnt.on("click",this._clickHandler,this);this._tabs=this.el.query(this.tabsQuery);this._panes=this.el.query(this.panesQuery);this._onLoadCallBack&&this._onLoadCallBack();this.currentTab=Ext.get(Ext.query(this.activeHk,this.el.dom)[0]);this.addEvents(["b4change","change"])},_clickHandler:function(e){var trg=Ext.get(e.getTarget(this.tabsQuery,3));if(trg){e.preventDefault();if(!trg.hasClass(this.activeHk)){var id=trg.dom.id.split(this.tabIdPrefix)[1];this._selectTab(id);this.fireEvent("change",this.currentTab)}}},_selectTab:function(id){this.fireEvent("b4change",this.currentTab);this.reset();this.tab(id)},reset:function(){var tab,pane;var l=this._panes.length;while(l>0){--l;tab=Ext.get(this._tabs[l]);pane=Ext.get(this._panes[l]);tab.addClass(this.tabOffClass).removeClass(this.tabOnClass);pane.addClass(this.paneOffClass)}},tab:function(id){this.currentTab=Ext.get(this.tabIdPrefix+id);this.currentTab.removeClass(this.tabOffClass).addClass(this.tabOnClass);Ext.fly(id).removeClass(this.paneOffClass)}});(function(root,factory){if(typeof define==="function"&&define.amd){define(["jquery"],function($){factory($,root.DM,root.MobileUtils,root.PageCriteria)})}else{factory($,root.DM,root.MobileUtils,root.PageCriteria)}})(this,function($,DM,MobileUtils,PageCriteria){if(!DM||!MobileUtils||!PageCriteria||PageCriteria.pageType!=="channel"&&PageCriteria.pageType!=="article"||typeof PageCriteria.timestamp!=="number")return;var loaded=PageCriteria.timestamp,interval=PageCriteria.refreshDesktop,redirect=PageCriteria.pageType==="article";var intervalOverwrite=function(){var r=new RegExp(/(\?|&)msgRefresh=(\d+)/i),s=window.location.search;return parseInt(r.exec(s)&&r.exec(s)[2])};var msg=function(s){var el,r=new RegExp(/(\?|&)msgRefresh(=|&|$)/i);if(!r.test(window.location.search))return;el=$("#msgRefresh");if(el.length<=0){el=$('<div id="msgRefresh" style="position: fixed; top: 200px; left: 0; color:red; background:#fff; width:100px; padding:5px; border: 1px solid red;" />');$("body").append(el)}el.html(s)};var formatDate=function(t){var d=new Date(t*1e3);return d.getHours()+":"+d.getMinutes()+":"+d.getSeconds()};var reload=function(){document.cookie="autorefresh="+PageCriteria.pageType+"; path=/";document.cookie="cs_autorefresh="+PageCriteria.pageType+"; path=/";if(redirect){window.location.replace("/")}else{window.location.reload(true)}};if(MobileUtils.isMobile()&&typeof PageCriteria.refresh==="number"&&PageCriteria.refresh>0){var hidden,visibilityChange,isReloading=false,isCriOS=navigator.userAgent.match(/crios/i),heartbeat,lastBeat;if(typeof document.hidden!=="undefined"){hidden="hidden";visibilityChange="visibilitychange"}else if(typeof document.mozHidden!=="undefined"){hidden="mozHidden";visibilityChange="mozvisibilitychange"}else if(typeof document.msHidden!=="undefined"){hidden="msHidden";visibilityChange="msvisibilitychange"}else if(typeof document.webkitHidden!=="undefined"){hidden="webkitHidden";visibilityChange="webkitvisibilitychange"}var timeToReload=function(){return interval-Math.floor((new Date).getTime()/1e3)+loaded};var forcedReload=function(){isReloading=true;if(isCriOS){$.ajax({url:redirect?"/":window.location.href,headers:{Pragma:"no-cache",Expires:new Date(0),"Cache-Control":"no-cache"}}).done(function(){reload()}).fail(function(){msg("crios reloading fail");isReloading=false})}else{reload()}};var refresh=function(e){var delta=timeToReload();msg(e.type+"<br/> loaded > "+formatDate(loaded)+"<br/> reload in > "+delta);if(!isReloading&&!document[hidden]&&delta<=0){msg("reloading on > "+e.type);forcedReload()}};interval=intervalOverwrite()||PageCriteria.refresh;if(timeToReload()<=0)window.setTimeout(refresh,200,{type:"timer"});$(document).on(visibilityChange,refresh);$(window).on("pageshow",refresh);if(isCriOS){lastBeat=(new Date).getTime();heartbeat=setInterval(function(){var now=(new Date).getTime();if(now-lastBeat>1e4)refresh({type:"heartbeat"});lastBeat=now},500)}}if(!MobileUtils.isMobile()&&typeof PageCriteria.refreshDesktop==="number"&&PageCriteria.refreshDesktop>0){interval=intervalOverwrite()||PageCriteria.refreshDesktop;$(function(){window.setTimeout(reload,interval*1e3)})}});var DMS=function(){var domain=window.location.protocol+"//"+window.location.host.replace("dailymail.com","dailymail.co.uk");function buildUrlParameters(parameters,host){var url="";$.each(parameters,function(key,value){if(value)url+=key+"="+encodeURIComponent(value)+"&"});return(host||"")+url.slice(0,-1)}function getWindowDimensions(width,height){return["resizable=1,scrollbars=1,status=1",",width=",width,",height=",height,",top=",(window.outerHeight-height)/2,",left=",(window.outerWidth-width)/2].join("")}function socialClick(site,placement,options){DM.pageEvents.fireEvent(DM.pageEvents.SOCIAL_SHARE_CLICKED,$.extend(options,{pageMetadata:DM.getPageMetadata(),site:site,placement:placement}))}return{buildUrlParameters:buildUrlParameters,getWindowDimensions:getWindowDimensions,socialClick:socialClick,domain:domain}}();DMS.Facebook=function($,window){var WINDOW_WIDTH=1050,WINDOW_HEIGHT=650,defaults={app_id:$('meta[property="fb:app_id"]').attr("content"),caption:DMS.domain,link:window.url,redirect_uri:"http://i.dailymail.co.uk/i/pix/facebook/close.html",picture:"http://f.dailymail.co.uk/i/furniture/comments/articles/m_logo.png"};function getSharingUrl(shareObject){if(!shareObject){return"http://www.facebook.com/sharer/sharer.php?u="+($('meta[property="og:url"]').attr("content")||window.url||window.location.href)}try{var params=$.extend({},defaults,$.isPlainObject(shareObject)?shareObject:$.parseJSON(shareObject));return DMS.buildUrlParameters(params,"https://www.facebook.com/dialog/feed?")}catch(e){console.log("Unable to parse JSON",e)}}function loadAsyncScript(data){(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/en_GB/all.js#xfbml=1&appId="+data.facebookAppId+"&channelUrl="+data.facebookChannelUrl+"&status=1&cookie=1&oauth=1";fjs.parentNode.insertBefore(js,fjs)})(document,"script","facebook-jssdk")}function attachFbAsyncInitToWindow(channel){window.fbAsyncInit=function(){FB.Event.subscribe("edge.create",function(response){DM.pageEvents.fireEvent(DM.pageEvents.SOCIAL_SHARE_CLICKED,{pageMetadata:DM.getPageMetadata(),type:"facebook-like",placement:"header",site:"facebook",channel:channel})})}}return{postToFB:function postToFB(placement,shareObject,trackingOptions){DMS.socialClick("facebook",placement,$.extend({},trackingOptions));window.open(getSharingUrl(shareObject),"",DMS.getWindowDimensions(WINDOW_WIDTH,WINDOW_HEIGHT))},loadAsyncScript:loadAsyncScript,attachFbAsyncInitToWindow:attachFbAsyncInitToWindow}}(jQuery,window);DMS.Google=function(window){window.___gcfg={lang:"en-GB"};function loadAsyncScript(){var po=document.createElement("script");po.type="text/javascript";po.async=true;po.src="https://apis.google.com/js/plusone.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(po,s)}function attachPlusoneVoteToWindow(channel){window.plusone_vote=function(obj){DM.later("bundle",function(){DM.pageEvents.fireEvent(DM.pageEvents.SOCIAL_BUTTON_CLICKED,{pageMetadata:DM.getPageMetadata(),type:"plusone-vote",channel:channel,link:obj.href})})}}function postToGPlus(placement,shareObject){var url=shareObject&&shareObject.url;url&&DMS.postToURL("https://plus.google.com/share?",{url:url});DMS.socialClick("plusone",placement)}function renderInteractivePost(el,placement,shareObject,trackingOptions){if(!el||!shareObject||!shareObject.url)return;if(window.gapi){window.gapi.interactivepost.render(el,{contenturl:shareObject.url,contentdeeplinkid:"/pages",clientid:window.feGoogleClientId,cookiepolicy:"single_host_origin",prefilltext:shareObject.title||"",calltoactionlabel:"VIEW",calltoactionurl:shareObject.url,calltoactiondeeplinkid:"/pages/create",onshare:function(response){DMS.socialClick("plusone",placement,trackingOptions)}})}}return{loadAsyncScript:loadAsyncScript,attachPlusoneVoteToWindow:attachPlusoneVoteToWindow,postToGPlus:postToGPlus,renderInteractivePost:renderInteractivePost}}(window);DMS.Pinterest=function(){var PINTEREST_LINK="http://www.pinterest.com/pin/create/button/";function type(shareObject){return shareObject?shareObject.type||"article":"article"}function currentUrl(shareObject){return $('meta[property="og:url"]').attr("content")||shareObject&&shareObject.url||window.url||window.location.href}function getShareObjectUrl(shareObject){return shareObject.url}function url(shareObject){var urls={article:currentUrl,comment:function(shareObject){return $.trim(shareObject.commentData.shortUrl)||currentUrl()},factbox:getShareObjectUrl,fff:getShareObjectUrl,image:currentUrl,text:currentUrl,email:currentUrl,poll:getShareObjectUrl};return"url="+encodeURIComponent(urls[type(shareObject)](shareObject))}function articleMedia(){return $("meta[property=og\\:image]").first().attr("content")||$(".image-wrap img").first().attr("src")}function objectMedia(shareObject){return shareObject.media||""}function media(shareObject){var medias={article:articleMedia,comment:function commentMedia(){return"http://f.dailymail.co.uk/i/furniture/comments/articles/m_logo.png"},factbox:objectMedia,fff:objectMedia,image:objectMedia,text:articleMedia,email:objectMedia,poll:objectMedia};return"media="+encodeURIComponent(medias[type(shareObject)](shareObject))}function objectDescription(shareObject){return shareObject.description}function getObjectCaptionAndDescription(shareObject){return shareObject.caption+" "+shareObject.description}function description(shareObject){var descriptions={comment:function(shareObject){var body=shareObject.commentData.commentBody?$.trim(shareObject.commentData.commentBody):"";var name=$.trim(shareObject.commentData.commenterName)||"";return body+(name?" by "+(name.substring(name.length-1,name.length)===","?name.substring(0,name.length-1):name):"")},article:function articleDescription(){return $("meta[property=og\\:title]").first().attr("content")},factbox:getObjectCaptionAndDescription,fff:objectDescription,image:objectDescription,text:getObjectCaptionAndDescription,email:objectDescription,poll:objectDescription};return"description="+encodeURIComponent(descriptions[type(shareObject)](shareObject))}function postToPinterest(placement,shareObject,trackingOptions){var actions={article:articleAction,comment:function commentAction(shareObject){shareObject.commentData.pinterestWindow.location=PINTEREST_LINK+"?"+url(shareObject)+"&"+description(shareObject)+"&"+media(shareObject)},fff:articleAction,image:articleAction,text:articleAction,email:articleAction,poll:articleAction,factbox:articleAction};actions[type(shareObject)](shareObject);if(type(shareObject)!="fff")DMS.socialClick("pinterest",placement,$.extend({},trackingOptions))}function articleAction(shareObject){window.open(PINTEREST_LINK+"?"+url(shareObject)+"&"+description(shareObject)+"&"+media(shareObject),"",DMS.getWindowDimensions(800,320))}function loadAsyncScript(){if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){attachAsyncScript(window,document,["//assets.pinterest.com/js/pinit.js"])}}function attachAsyncScript(w,d,load){var script,first=d.getElementsByTagName("SCRIPT")[0],n=load.length,i=0,go=function(){for(i=0;i<n;i=i+1){script=d.createElement("SCRIPT");script.type="text/javascript";script.async=true;script.src=load[i];first.parentNode.insertBefore(script,first)}};if(w.attachEvent){w.attachEvent("onload",go)}else{w.addEventListener("load",go,false)}}function bindNavigationClick(){$("html").on("click",".pinterest-follow-button a",navigationClickedCallback)}function navigationClickedCallback(){DM.pageEvents.fireEvent(DM.pageEvents.SOCIAL_SHARE_CLICKED,{pageMetadata:DM.getPageMetadata(),site:"pinterest",placement:"header"})}return{postToPinterest:postToPinterest,loadAsyncScript:loadAsyncScript,bindNavigationClick:bindNavigationClick}}();DMS.Twitter=function(){var TWITTER_URL="https://twitter.com/intent/tweet?",WINDOW_WIDTH=575,WINDOW_HEIGHT=400,MESSAGE_URL_LENGTH=23,WRAPPERS={text:'"'},MESSAGE_MAX_LENGTH=140;var articleVia,wrapper;$(function(){articleVia=window.twitterVia||"MailOnline"});function truncateText(params,options){options=$.extend({},options);wrapper=WRAPPERS[options.type]||"";var text=params.text,url=params.url,via=params.via,hasVia=via&&options.via!==false,rest=MESSAGE_MAX_LENGTH-(hasVia?" via @"+via:"").length-(url?MESSAGE_URL_LENGTH+1:0)-wrapper.length*2;rest=text.length>rest?rest-3:rest;text=text.length>rest?wrap(text.substring(0,text.substring(0,rest).lastIndexOf(" "))+" ..."):wrap(text);return text+" "+url+(hasVia?" via @"+via:"")}function wrap(text){return wrapper+text+wrapper}function truncateTextAndEscape(params,options){return encodeURIComponent(truncateText(params,options))}function getShareObjectParams(shareObject){var parsedShareObject=$.isPlainObject(shareObject)?shareObject:JSON.parse(shareObject);return DMS.buildUrlParameters({text:truncateText({text:parsedShareObject.text,url:parsedShareObject.url,via:parsedShareObject.via},{type:parsedShareObject.type}),related:parsedShareObject.related,hashtags:parsedShareObject.hashtags},TWITTER_URL)}function getArticleParams(){return DMS.buildUrlParameters({text:truncateText({url:window.articleShortUrl,via:articleVia,text:$('meta[property="twitter:title"]').attr("content")||""}),related:articleVia+",MailOnline"},TWITTER_URL)}function getTwitterWindowUrl(shareObject){return shareObject?getShareObjectParams(shareObject):getArticleParams()}function postToTWTTR(placement,shareObject,trackingOptions){DMS.socialClick("twitter",placement,$.extend({},trackingOptions));window.open(getTwitterWindowUrl(shareObject),"",DMS.getWindowDimensions(WINDOW_WIDTH,WINDOW_HEIGHT))}function loadAsyncScript(){window.twttr=function(d,s,id){var t,js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);return window.twttr||(t={_e:[],ready:function(f){t._e.push(f)}})}(document,"script","twitter-wjs")}function bindClickToFollowButton(channel){window.twttr.ready(function(twttr){twttr.events.bind("click",twitterCallback)});function twitterCallback(intent_event){DM.later("bundle",function(){var placement,$button=$(intent_event.target);if($button.is(".twitter-follow-author")){placement="author"}else if($button.is(".twitter-follow-header")){placement="header"}if(placement==="header"){DM.pageEvents.fireEvent(DM.pageEvents.SOCIAL_SHARE_CLICKED,{pageMetadata:DM.getPageMetadata(),type:"twitter-follow",site:"twitter",placement:placement})}else if(placement==="author"){DM.pageEvents.fireEvent(DM.pageEvents.SOCIAL_SHARE_CLICKED,{pageMetadata:DM.getPageMetadata(),type:"twitter-follow",channel:channel,link:intent_event.target.baseURI,site:"twitter-follow",placement:"author"})}})}}return{truncateText:truncateText,truncateTextAndEscape:truncateTextAndEscape,postToTWTTR:postToTWTTR,loadAsyncScript:loadAsyncScript,bindClickToFollowButton:bindClickToFollowButton}}();DMS.Navigation=function($){var socialData;function initializeGooglePlus(){DMS.Google.loadAsyncScript();DMS.Google.attachPlusoneVoteToWindow(socialData.channel)}function initializeFacebook(){DMS.Facebook.loadAsyncScript(socialData);DMS.Facebook.attachFbAsyncInitToWindow(socialData.channel)}function initializePinterest(){DMS.Pinterest.loadAsyncScript();DMS.Pinterest.bindNavigationClick()}function initializeTwitter(){DMS.Twitter.loadAsyncScript();DMS.Twitter.bindClickToFollowButton(socialData.channel)}function extendSocialData(data){socialData=$.extend({},data)}return{init:function init(data){extendSocialData(data);initializeFacebook();initializePinterest();initializeTwitter();initializeGooglePlus()}}}(jQuery);DMS.Puff=function(){var $puffContainer;var channel=PageCriteria.channel||"home";var subChannel=PageCriteria.subchannel||"home";var geo=(PageCriteria.geo||"GB")!="GB"?PageCriteria.geo:"";var channelGeo=channel+geo;var subChannelGeo=subChannel+geo;var socials=["facebook","twitter","pinterest","gplus"];var trackingSite={gplus:"plusone"};var windowSizes={facebook:{width:1100,height:600},twitter:{width:760,height:500},gplus:{width:1100,height:600},pinterest:{width:1100,height:600}};var data={facebook:{home:{text:"Daily Mail",account:"DailyMail"},extratime:{text:"Extra Time",bold:"Share",link:["https://www.facebook.com/dialog/feed?app_id=146202712090395","&name=",encodeURIComponent("Enjoy all the latest and exclusive celebrity sports news from MailOnline"),"&caption= ","&link=",encodeURIComponent("http://www.dailymail.co.uk/sport/extratime/index.html"),"&redirect_uri=",encodeURIComponent("http://www.dailymail.co.uk/sport/extratime/index.html"),"&description=",encodeURIComponent("Find out what celebrity sports stars get up to away from the action with the latest news, photos and videos in MailOnline’s dedicated sports showbiz page."),"&picture=",encodeURIComponent("http://i.mol.im/i/sport/154x154_extra_time.png")].join("")},transfernews:{text:"Transfer News",bold:"Share",link:["https://www.facebook.com/dialog/feed?app_id=146202712090395","&name=",encodeURIComponent("Read all the latest and exclusive transfer news from MailOnline"),"&caption= ","&link=",encodeURIComponent("http://www.dailymail.co.uk/sport/transfernews/index.html"),"&redirect_uri=",encodeURIComponent("http://www.dailymail.co.uk/sport/extratime/index.html"),"&description=",encodeURIComponent("Be the first to find out who’s moving where and for how much with MailOnline’s dedicated transfer news page."),"&picture=",encodeURIComponent("http://i.mol.im/i/sport/154x154_transfer_news.png")].join("")},tvshowbiz:{text:"Daily Mail Celeb",account:"DailyMailCeleb"},sport:{text:"Daily Mail Sport",account:"DailyMailSport"},money:{text:"This is Money",link:"https://www.facebook.com/pages/This-is-Money/310555847252"}},twitter:{home:{text:"@MailOnline",account:"MailOnline"},news:{text:"@dailymailuk",account:"dailymailuk"},newsUS:{text:"@dailymailus",account:"dailymailus"},sport:{text:"@MailSport",account:"MailSport"},tvshowbiz:{text:"@DailyMailCeleb",account:"DailyMailCeleb"},femail:{text:"@Femail",account:"Femail"},money:{text:"@thisismoney",account:"thisismoney"},travel:{text:"@travelmail",account:"travelmail"},newspictures:{text:"@dailymailpics",account:"dailymailpics"},sciencetech:{text:"@dailymailtech",account:"dailymailtech"},extratime:{text:"Extra Time",bold:"Share",link:"https://twitter.com/intent/tweet?related=MailSport,MailOnline&text="+function(){return encodeURIComponent("Find out what celebrity sports stars get up to away from the action with MailOnline’s dedicated sports showbiz page. http://dailym.ai/1krSwk2")}()},transfernews:{text:"Transfer News",bold:"Share",link:"https://twitter.com/intent/tweet?related=MailSport,MailOnline&text="+function(){return encodeURIComponent("Be the first to find out which players are on the move with MailOnline’s dedicated transfer news page. http://dailym.ai/1krSwk2")}()}},gplus:{home:{text:"Daily Mail",account:"DailyMail"},tvshowbiz:{text:"Daily Mail Celeb",account:"DailyMailCeleb",link:"https://plus.google.com/112881868727711378095/posts"},sport:{text:"Daily Mail Sport",account:"DailyMailSport",link:"https://plus.google.com/+MailOnlineSport/posts"}},pinterest:{home:{text:"Daily Mail",account:"DailyMail"},tvshowbiz:{text:"Daily Mail Celeb",account:"dailymailceleb"}}};function getProperty(social,property){return getNestedFromData(subChannelGeo)||getNestedFromData(subChannel)||getNestedFromData(channelGeo)||getNestedFromData(channel)||getNestedFromData("home");function getNestedFromData(middle){return nestedProperty(data,social+"."+middle+"."+property)}}function getAccount(social){return getProperty(social,"account")}function getText(social){return getProperty(social,"text")}function getBold(social){return getProperty(social,"bold")}function getUrl(social){return getProperty(social,"link")||getDefault(social);function getDefault(social){var account=getAccount(social);var socialLinks={facebook:"https://www.facebook.com/"+account,twitter:"http://twitter.com/intent/user?screen_name="+account+"&related="+getTwitterVia(),pinterest:"https://pinterest.com/"+account,gplus:"https://plus.google.com/+DailyMail/posts"};return socialLinks[social]}}function getTwitterVia(){return twitterVia||"MailOnline"}function bindButtons(){for(var i=0,len=socials.length;i<len;i++)bindSocial(socials[i]);function bindSocial(social){$puffContainer.find("."+social).unbind("click").bind("click",function(e){e.preventDefault();tracking(social);window.open(getUrl(social),"",DMS.getWindowDimensions(windowSizes[social].width,windowSizes[social].height))})}}function setTexts(){var bold;for(var i=0,length=socials.length;i<length;i++){$puffContainer.find("."+socials[i]+" span").text(getText(socials[i]));bold=getBold(socials[i]);if(bold)$puffContainer.find("."+socials[i]+" b").text(bold)}}function tracking(social){DM.pageEvents.fireEvent(DM.pageEvents.SOCIAL_SHARE_CLICKED,{pageMetadata:DM.getPageMetadata({articleId:"non-article"}),site:trackingSite[social]||social,placement:"non-native"})}function nestedProperty(obj){var a=arguments,b=a.callee;if(a[1]&&~a[1].indexOf("."))return b.apply(this,[obj].concat(a[1].split(".")));return a.length==1?a[0]:obj[a[1]]&&b.apply(this,[obj[a[1]]].concat([].slice.call(a,2)))}return{init:function(opt){data=$.extend(true,data,opt);$puffContainer=$("ul.dms-puff");bindButtons();setTexts()}}}();(function(root,factory){function polluteGlobal(share){root.postToFB=root.postToFB||share.postToFB;root.postToTWTTR=root.postToTWTTR||share.postToTWTTR;root.postToGPlus=root.postToGPlus||share.postToGPlus;root.postToPinterest=root.postToPinterest||share.postToPinterest;root.postToReddit=root.postToReddit||share.postToReddit;root.postToStumbleUpon=root.postToStumbleUpon||share.postToStumbleUpon;root.postToFark=root.postToFark||share.postToFark;root.postToDiggit=root.postToDiggit||share.postToDiggit;root.postToLinkedIn=root.postToLinkedIn||share.postToLinkedIn;root.emailArticle=root.emailArticle||share.emailArticle;return share}if(typeof define==="function"&&define.amd){define(["mol-dm/DM","mol-page-events/page-events"],function(DM,pageEvents){return polluteGlobal(factory(root,DM,pageEvents))})}else{polluteGlobal(factory(root,root.DM,root.pageEvents))}})(this,function(root,DM,pageEvents){var WINDOW_WIDTH=1050,WINDOW_HEIGHT=650;function postToURL(baseurl,params){window.open(DMS.buildUrlParameters(params,baseurl),"",DMS.getWindowDimensions(WINDOW_WIDTH,WINDOW_HEIGHT))}function postToReddit(placement,shareObject,trackingOptions){var url=shareObject&&shareObject.url,title=shareObject&&shareObject.title;if(url&&title){postToURL("http://reddit.com/submit?",{url:url,title:title})}DMS.socialClick("reddit",placement,trackingOptions)}function postToStumbleUpon(placement,shareObject,trackingOptions){var url=shareObject&&shareObject.url,title=shareObject&&shareObject.title;if(url&&title){postToURL("http://www.stumbleupon.com/badge/?",{url:url,title:title})}DMS.socialClick("stumbleupon",placement,trackingOptions)}function postToFark(placement,shareObject,trackingOptions){var u=shareObject&&shareObject.u,h=shareObject&&shareObject.h;if(u&&h){postToURL("http://cgi.fark.com/cgi/fark/farkit.pl?",{u:u,h:h})}DMS.socialClick("fark",placement,trackingOptions)}function postToDiggit(placement,shareObject,trackingOptions){var url=shareObject&&shareObject.url,title=shareObject&&shareObject.title;if(url&&title){postToURL("http://digg.com/submit?phase=2&",{url:url,title:title})}DMS.socialClick("diggit",placement,trackingOptions)}function postToLinkedIn(placement,shareObject,trackingOptions){var url=shareObject&&shareObject.url,title=shareObject&&shareObject.title;if(url&&title){postToURL("http://www.linkedin.com/shareArticle?mini=true&",{url:url,title:title})}DMS.socialClick("linkedin",placement,trackingOptions)}function emailArticle(placement){DMS.socialClick("email",placement)}$.extend(DMS,{Reddit:{postToReddit:postToReddit},StumbleUpon:{postToStumbleUpon:postToStumbleUpon},Fark:{postToFark:postToFark},Diggit:{postToDiggit:postToDiggit},LinkedIn:{postToLinkedIn:postToLinkedIn},Email:{emailArticle:emailArticle},postToURL:postToURL});return{postToFB:DMS.Facebook.postToFB,postToGPlus:DMS.Google.postToGPlus,postToTWTTR:DMS.Twitter.postToTWTTR,postToPinterest:DMS.Pinterest.postToPinterest,postToReddit:DMS.Reddit.postToReddit,postToStumbleUpon:DMS.StumbleUpon.postToStumbleUpon,postToFark:DMS.Fark.postToFark,postToDiggit:DMS.Diggit.postToDiggit,postToLinkedIn:DMS.LinkedIn.postToLinkedIn,emailArticle:DMS.Email.emailArticle}});DMS.PollShare=function(){function getSelectedPollAnswer(pollId,answerId){var $answer=$("#poll-"+pollId).find("[for='answer-"+pollId+"-"+answerId+"']");return $answer?$.trim($answer.text()):""}function getSelectedPollAnswerPercent(elementId,pollId,answerId){var $answerPct=$("."+elementId).find("li.results-"+pollId+"-"+answerId+" span.results-score span.results-pct");return $answerPct?$.trim($answerPct.text()):""}function getShareDescription(elementId,pollId){var answerId=$("#poll-"+pollId).find("input:radio[name='answer']:checked").val();return" I said "+getSelectedPollAnswer(pollId,answerId)+". "+getSelectedPollAnswerPercent(elementId,pollId,answerId)+" of others agreed with me. What do you think?"}function getTwitterDescription(elementId,pollId){var answerId=$("#poll-"+pollId).find("input:radio[name='answer']:checked").val();var answer=getSelectedPollAnswer(pollId,answerId);return" I said "+(answer.length>17?answer.substring(0,14)+"...":answer+". ")+"Do you agree?"}function bindShareEvents(id,conf){var $pollResultsShareContainer=$(".poll-"+conf.pollId+".poll-results .dms-poll ul"),pollQuestion="POLL: "+conf.question,sharePlacement=conf.pollStyle=="sponsored-poll"?"sponsored-poll":"post_poll";$.each({facebook:function facebook(event){postPollToFb("poll-share-"+conf.pollId,conf.fbAppId,pollQuestion,conf.pollImage||conf.articleImage||conf.defaultImage,getShareDescription(id,conf.pollId),sharePlacement)},twitter:function twitter(){postPollToTwitter("poll-share-"+conf.pollId,conf.question,conf.twitterVia,window.articleShortUrl||DMS.domain+window.location.pathname,"",sharePlacement)},pinterest:function pinterest(){postPollToPinterest("poll-share-"+conf.pollId,conf.pollImage||conf.articleImage||conf.defaultImage,pollQuestion+getShareDescription(id,conf.pollId),sharePlacement)}},function(key,callback){$pollResultsShareContainer.find("li."+key).bind("click",callback)})}function renderPollsGoogleInteractive(elementId,gplusClientId,pollId,prefillText,sharePlacement){var options={contenturl:DMS.domain+window.location.pathname+"#poll-share-"+pollId,contentdeeplinkid:"/pages",clientid:gplusClientId,cookiepolicy:"single_host_origin",prefilltext:prefillText,calltoactionlabel:"VIEW",calltoactionurl:DMS.domain+window.location.pathname+"#poll-share-"+pollId,onshare:function(response){DMS.socialClick("google",sharePlacement)}};if(window.gapi){window.gapi.interactivepost.render(elementId,options)}}function postPollToFb(id,fbAppId,pollQuestion,pollImage,shareDescription,sharePlacement){var fbLink=["https://www.facebook.com/dialog/feed?app_id=",fbAppId,"&link=",DMS.domain,window.location.pathname,"%23",id,"&redirect_uri=http://i.dailymail.co.uk/i/pix/facebook/close.html","&name=",pollQuestion,"&description=",shareDescription,"&picture=",pollImage,"&u=",$('meta[property="og:url"]').attr("content")||window.url||window.location.href].join("");DMS.socialClick("facebook",sharePlacement);window.open(fbLink,"",DMS.getWindowDimensions(1e3,500))}function postPollToTwitter(id,pollQuestion,twitterVia,pollUrl,shareDescription,sharePlacement){var shareObject=JSON.stringify({text:(pollQuestion.length>105?pollQuestion.substring(0,101)+"...?":pollQuestion)+shareDescription,via:twitterVia,url:decodeURIComponent(pollUrl)+"#"+id});DMS.Twitter.postToTWTTR(sharePlacement,shareObject)}function postPollToPinterest(id,pollImage,shareDescription,sharePlacement){var shareObject={description:shareDescription,media:pollImage,type:"poll",url:DMS.domain+window.location.pathname+"#"+id};DMS.Pinterest.postToPinterest(sharePlacement,shareObject)}return{init:function init(id,config){bindShareEvents(id,config)},renderPollsGoogleInteractive:renderPollsGoogleInteractive,getShareDescription:getShareDescription}}();DMS.Article=function(){function top(){var $top=$("#articleIconLinksContainer"),position="top";$top.find(".share-facebook").on("click",function(){DMS.Facebook.postToFB(position)}).end().find(".share-twitter").on("click",function(){DMS.Twitter.postToTWTTR(position)}).end().find(".share-pinterest").on("click",function(){DMS.Pinterest.postToPinterest(position)}).end().find(".share-gplus a").on("click",function(){DMS.Google.postToGPlus(position)})}function bottom(){var $bottom=$("#socialLinks"),position="bottom";$bottom.find(".facebook a").on("click",function(){DMS.Facebook.postToFB(position)}).end().find(".twitter a").on("click",function(){DMS.Twitter.postToTWTTR(position)}).end().find(".pinterest a").on("click",function(){DMS.Pinterest.postToPinterest(position)}).end().find(".googleplus a").on("click",function(){DMS.Google.postToGPlus(position)})}var positions={top:top,bottom:bottom};return{init:function init(position){if(positions[position]){positions[position]()}}}}();$(function(){if(MobileUtils.isMobile())return;init();var bottomShareLinks,leftOffset,topShareLinksBottom,topShareLinks,minimumWidthToShowSidebar=1350,menuId,menuEl,currentVisibilityState=false,previousVisibilityState;function init(){Ext.onReady(function(){menuId="floatingMenu";menuEl=Ext.get(menuId);if(menuEl){initializeFloating();Ext.EventManager.on(window,"resize",doResize)}});Ext.EventManager.on(window,"scroll",handleScroll)}function getPageYPos(){return typeof window.pageYOffset=="number"?window.pageYOffset:document.documentElement.scrollTop}function shouldShowFloatingMenu(){var pageYPos=getPageYPos(),href=document.location.href;if(Ext.get("sky-left")!==null||Ext.getBody().getStyle("background-image")!="none"){return false}return!(Ext.getBody().getWidth()<minimumWidthToShowSidebar||window.retina||window.devicePixelRatio>1||href.indexOf("email-article.html")>-1||href.indexOf("Privacy-Policy-Cookies.html")>-1||href.indexOf("reportAbuseInComment.html")>-1||pageYPos>bottomShareLinks.getY()-15-Ext.get("floatingMenu").getHeight()||pageYPos<topShareLinksBottom)}function initializeFloating(){topShareLinks=Ext.get("articleIconLinksContainer");if(topShareLinks===null){return}bottomShareLinks=Ext.get("socialLinks");leftOffset=Ext.get("content").getX();topShareLinksBottom=topShareLinks.getY()+topShareLinks.getHeight()-(topShareLinks.getPadding("b")||0)-(parseInt(topShareLinks.getStyle("margin-bottom"))||0);if(menuEl&&shouldShowFloatingMenu()){menuEl.setStyle("visibility","visible")}previousVisibilityState=shouldShowFloatingMenu();handleScroll()}function handleScroll(){if(!menuEl)return;if(!Ext.isReady){Ext.onReady(handleScroll,null,{single:true});return}menuEl.setLeft(Ext.get("content").getX()-50);if(!bottomShareLinks)return;currentVisibilityState=shouldShowFloatingMenu();if(currentVisibilityState!=previousVisibilityState){var duration={duration:.1};if(currentVisibilityState){menuEl.fadeIn(duration)}else{menuEl.fadeOut(duration)}}previousVisibilityState=currentVisibilityState}function doResize(){leftOffset=Ext.get("content").getX();if(menuEl){if(menuEl.getStyle("position")=="fixed"){menuEl.setLeft(leftOffset-50)}if(shouldShowFloatingMenu()){if(!menuEl.isVisible()){menuEl.show()}}else{if(menuEl.isVisible()){menuEl.hide()}}}}bind("facebook",function(e){DMS.Facebook.postToFB("body")});bind("twitter",function(e){DMS.Twitter.postToTWTTR("body")});bind("gplus",function(e){DMS.Google.postToGPlus("body");
});bind("pinterest",function(e){postToPinterest("body")});bind("mail",function(e){DM.ted.tedEvent("social-event",{"social-event":"email-article"});emailArticle("body")});function bind(provider,fn){if(PageCriteria&&!PageCriteria.mailtoEmailLinks){$("#floatingShare").find("."+provider+" a").on("click",fn)}}});(function(root,factory){if(typeof define==="function"&&define.amd){define("mol-gallery/ImageShare",["jquery"],function($){return factory(root,$)})}else{root.ImageShare=factory(root,root.jQuery)}})(this,function(root,$){function imageFromTarget(target){return $(target).closest(".image-wrap").find("img")[0]}function imageLink(id){return($('meta[property="og:url"]').attr("content")||window.location.href)+"#"+id}function imageLinkShort(id){return window.articleShortUrl+"#"+id}function viaLink(){return window.currentChannelTwitterFollow?window.currentChannelTwitterFollow:""}function scImageOptions(image,overlay){return{id:image.id,nthPosition:overlay.attr("id").split("-")[2]}}function postImageToFb(event,overlay){var image=imageFromTarget(event.target);var src=image.src;var alt=image.alt;var shareObject=JSON.stringify({picture:src,redirect_uri:"http://i.dailymail.co.uk/i/pix/facebook/close.html",description:alt,link:imageLink(image.id)});DMS.Facebook.postToFB("image-share",shareObject,scImageOptions(image,$(overlay)))}function postImageToTwitter(event,overlay){var image=imageFromTarget(event.target),shareObject={text:image.alt,via:viaLink(),url:imageLinkShort(image.id)};DMS.Twitter.postToTWTTR("image-share",shareObject,scImageOptions(image,$(overlay)))}function postImageToPinterest(event,overlay){var image=imageFromTarget(event.target);var text=image.alt.substring(0,90)+"...";var shareObject={description:text,via:viaLink(),media:image.src,type:"image",url:imageLinkShort(image.id)};postToPinterest("image-share",shareObject,scImageOptions(image,$(overlay)))}function bindGoogleData(overlay){var elementId="google-share"+Math.random();overlay.find(".google-share").attr("id",elementId);var image=imageFromTarget(overlay);var iLink=imageLink(image.id);renderGoogleInteractive(elementId,iLink,iLink,image.alt,scImageOptions(image,overlay))}function renderGoogleInteractive(elementId,contentUrl,callToActionUrl,prefillText,imgTrackingOpts){var options={contenturl:contentUrl,contentdeeplinkid:"/pages",clientid:root.feGoogleClientId,cookiepolicy:"single_host_origin",prefilltext:prefillText,calltoactionlabel:"VIEW",calltoactionurl:callToActionUrl,calltoactiondeeplinkid:"/pages/create",onshare:function(response){DMS.socialClick("google","image-share",imgTrackingOpts)}};if(window.gapi){window.gapi.interactivepost.render(elementId,options)}}function showUrlLightbox(event,overlay){var image,location,shareUrl,element=$(event.currentTarget.parentNode.parentNode),lightbox=element.find(".image-share-url-lightbox"),is_visible=!lightbox.is(":visible");lightbox.toggle();event.stopPropagation();if(is_visible){location=($('meta[property="og:url"]').attr("content")||window.location.href).split("#")[0];image=imageFromTarget(event.target);shareUrl=location+"#"+image.id;DMS.socialClick("email","image-share",scImageOptions(image,overlay));var el=element.find("#share-url-input");el.val(shareUrl);if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1){var hideImageShare=true;el.on("contextmenu mouseleave",function(e){hideImageShare=true;e.stopPropagation()});$(".image-wrap").on("mouseenter",function(e){hideImageShare=false});$("body").on("mouseenter",function(e){$(".image-share-url-lightbox").hide();if(hideImageShare)$(".share-pictures-links").hide()})}setTimeout(function(){el.select().focus()},100)}}function hideImageLightbox(){$(".image-share-url-lightbox").hide()}function bindShareEvents(overlay){overlay.find(".share-pictures-icon.email").click(function(e){ImageShare.showUrlLightbox(e,overlay)});overlay.find(".share-pictures-icon.facebook").click(function(e){ImageShare.postImageToFb(e,overlay);hideImageLightbox()});overlay.find(".share-pictures-icon.twitter").click(function(e){ImageShare.postImageToTwitter(e,overlay);hideImageLightbox()});overlay.find(".share-pictures-icon.google").click(function(e){hideImageLightbox()});overlay.find(".share-pictures-icon.pinterest").click(function(e){ImageShare.postImageToPinterest(e,overlay);hideImageLightbox()});$(overlay).click(function(e){e.stopPropagation();e.preventDefault();if(e.target.parentNode.parentNode.className!="image-share-url-lightbox"){var links=$("#"+overlay[0].id+" .share-pictures-links");if(!links.is(":visible"))$("#"+overlay[0].id+" .image-share-url-lightbox").hide()}})}function bindUnclickEvent(overlay){$(document).mousedown(function(e){var container=$(overlay);if(!container.is($(e.target))&&container.has($(e.target)).length===0){$("#"+container[0].id+" .image-share-url-lightbox").hide()}})}function showHideOnHover($imageWrap){var showShare=_.throttle(function(element){element.find(".share-pictures-links:not(.image-share-hide)").fadeIn({duration:200})},400);var hideShare=_.throttle(function(element){element.find(".share-pictures-links:not(.image-share-hide)").fadeOut({duration:200})},400);$imageWrap.on("mouseenter",function(e){showShare($(this))});$imageWrap.on("mouseleave",function(e){hideShare($(this))})}function initOnImage(overlay,container){bindShareEvents(overlay);bindUnclickEvent(overlay);showHideOnHover($(container));bindGoogleData(overlay)}var _ImageShare={postImageToFb:postImageToFb,bindGoogleData:bindGoogleData,postImageToTwitter:postImageToTwitter,postImageToPinterest:postImageToPinterest,showUrlLightbox:showUrlLightbox,bindShareEvents:bindShareEvents,bindUnclickEvent:bindUnclickEvent,showHideOnHover:showHideOnHover,initOnImage:initOnImage};DMS.ImageShare=_ImageShare;return _ImageShare});$(function(){$.fn.shareSelectedText=function(options){var $this=$(this),selectors=options.selectors||["p"],notSelectors=options.notSelectors||[],TEXT_SHARE_ID="dms-txt",selection="",$textShare=null,sharable=false,topOffset,leftOffset;initialize();function initialize(){$("body").prepend('<div id="'+TEXT_SHARE_ID+'">'+"<ul>"+'<li class="share">SHARE SELECTION</li>'+'<li class="facebook"></li>'+'<li class="twitter"></li>'+'<li class="mail"></li>'+"</ul>"+"</div>");$textShare=$("#"+TEXT_SHARE_ID);bindEvents()}function bindEvents(){$textShare.find("li").on("click",function(){var quoteSelection=selection;var caption=quoteSelection.length>1e3?quoteSelection.substring(0,996)+'..."':quoteSelection;var name=$("meta[property=twitter\\:title]").first().attr("content");var shareObject={name:name,headline:$(".article-text h1").first().text()||name,message:" ",caption:caption,description:"www.dailymail.co.uk",title:" ",redirect_uri:"http://i.dailymail.co.uk/i/pix/facebook/close.html",picture:$("meta[property=og\\:image]").first().attr("content"),link:$('meta[property="og:url"]').attr("content")||window.location.href||"",url:window.articleShortUrl||$('meta[property="og:url"]').attr("content")||window.location.href||"",text:selection,via:(window.twitterVia&&window.twitterVia!=="MailOnline"?window.twitterVia:currentChannelTwitterFollow)||"MailOnline",type:"text"};var actions={facebook:function(shareObject){DMS.Facebook.postToFB("text",JSON.stringify(shareObject))},twitter:function(shareObject){DMS.Twitter.postToTWTTR("text",JSON.stringify(shareObject))},mail:function(shareObject){DMS.socialClick("email","text");if(PageCriteria.mailtoEmailLinks){window.location.href="mailto:?subject=Read this: "+encodeURIComponent(shareObject.headline)+"&body="+encodeURIComponent(quoteSelection+"\n"+shareObject.link+"?ito=email_share_article-text")}else{window.location.href="mailto:?subject=DailyMail%20article&body="+encodeURIComponent(quoteSelection+" "+shareObject.link)}}};var provider=$(this).attr("class");if(actions[provider])actions[provider](shareObject);$textShare.hide()});$this.on("mouseup",debounce(function(e){selection=$.trim(getSelectedText());sharable=sharable&&isShareable(e);if(selection&&sharable){$textShare.css("top",e.pageY>topOffset?e.pageY:topOffset);$textShare.css("left",e.pageY>topOffset?e.pageX:leftOffset);$textShare.css("display","inline")}},500));$this.on("mousedown",function(e){topOffset=e.pageY;leftOffset=e.pageX;sharable=isShareable(e);$textShare.hide()});$textShare.on("mousedown",function(e){e.stopPropagation()})}function isShareable(e){var $target=$(e.target);for(var i=0,count=selectors.length;i<count;i++){if($target.is(selectors[i])||$target.is(selectors[i]+" *")&&checkNotSelectors($target))return true}return false}function checkNotSelectors($target){for(var i=0,count=notSelectors.length;i<count;i++){if($target.is(notSelectors[i])||$target.is(notSelectors[i]+" *"))return false}return true}function debounce(fn,delay){var timer=null;return function(){var context=this,args=arguments;clearTimeout(timer);timer=setTimeout(function(){fn.apply(context,args)},delay)}}function getSelectedText(){if(window.getSelection){return window.getSelection().toString()}else if(document.getSelection){return document.getSelection()}else if(document.selection){return document.selection.createRange().text}}};if(PageCriteria.pageType==="article"&&!MobileUtils.isMobile()&&!DM.getPageMetadata().textBased){$(".article-text").shareSelectedText({selectors:["p","ul","h1","h2",".mol-article-quote"],notSelectors:[".share-pictures-links","#most-read-news-wrapper","a","input"]})}});$(function(){$.fn.mailtoShares=function(options){var $this=$(this);initialize();function initialize(){bindEvents()}function bindEvents(){$this.on("click",function(e){var ess=$(e.target).data("email-share-style");var clickStyle=ess.replace(/email_share_article-/,"");DMS.socialClick("email",clickStyle);setTimeout(function(){window.location.href="mailto:?subject=Read%20this%3A%20"+encodeURIComponent($this.data("headline"))+"&body="+encodeURIComponent($(e.target).data("url")+"?ito="+ess)},100)})}};if(PageCriteria.pageType==="article"&&!MobileUtils.isMobile()&&!DM.getPageMetadata().textBased){$("a.mailto.js-email").mailtoShares({})}});DMS.RC=DMS.RC||{};(function(){var siteName=window.location.host.indexOf("thisismoney")!=-1?"This is Money":"MailOnline.co.uk",updateShareOptionsTimeout;DMS.RC.SOCIAL_ELEMENTS_HTML='<a class="fShareComment"></a>'+'<a class="tShareComment"></a>'+'<span class="pShareComment"></span>'+'<span class="gShareComment"></span>';DMS.RC.SHARE_ELEMENTS_HTML='<div class="shareComment">'+DMS.RC.SOCIAL_ELEMENTS_HTML+'<span class="copyCommentLink"></span>'+'<span class="shareExpansionAnchor"></span>'+"</div>";DMS.RC.fShareComment=function fShareComment(commentLink,commenterName,commentBody){var fbLink=DMS.buildUrlParameters({app_id:0x84f878b8271b,link:commentLink,redirect_uri:"http://i.dailymail.co.uk/i/pix/facebook/close.html",name:$('meta[property="og:title"]').attr("content"),caption:"Comment by "+commenterName+": "+commentBody,description:DMS.domain,picture:$('meta[property="og:image"]').attr("content")||"http://f.dailymail.co.uk/i/furniture/comments/articles/m_logo.png"},"https://www.facebook.com/dialog/feed?");window.open(fbLink,"",DMS.getWindowDimensions(1e3,500))};DMS.RC.tShareComment=function tShareComment(twitterWindow,shortUrl,commentBody){var twitterMessage=shortUrl+"\n";if(isMessageTooLong(commentBody,twitterMessage)){commentBody=truncateCommentBody(twitterMessage,commentBody)}twitterWindow.location="http://twitter.com/intent/tweet?text="+encodeURIComponent(commentBody+"\n"+shortUrl)};DMS.RC.pShareComment=function pShareComment(pinterestWindow,shortUrl,commentData){var commentBody=commentData.commentBody,pinterestMessage=shortUrl+"\n";if(isMessageTooLong(commentBody,pinterestMessage)){commentData.commentBody=truncateCommentBody(pinterestMessage,commentBody)}commentData.pinterestWindow=pinterestWindow;DMS.Pinterest.postToPinterest("comment",{type:"comment",commentData:commentData})};function isMessageTooLong(commentBody,twitterMessage){return commentBody.length>140-twitterMessage.length}function truncateCommentBody(message,commentBody){var maxIndex=Math.max(commentBody.lastIndexOf(" ",140-message.length-3-1),commentBody.lastIndexOf("\n",140-message.length-3-1));return commentBody.substring(0,maxIndex)+"..."}DMS.RC.gPlusEnhance=function gPlusEnhance(shareCommentElement,cData){var commentData=cData?cData:DM.RC.getCommentData(shareCommentElement);if(!commentData)return;if(gapi.interactivepost){gapiInteractivePostAvailable()}else{noGapiInteractivePostAvailable()}function gapiInteractivePostAvailable(){gapi.interactivepost.render(shareCommentElement.child(".gShareComment").dom,{contenturl:commentData.commentLink,contentdeeplinkid:"/pages",clientid:DMS.RC.gplusClientId,cookiepolicy:"single_host_origin",prefilltext:getCommentText(),calltoactionlabel:"COMMENT",calltoactionurl:commentData.commentLink});function getCommentText(){return commentData.commenterName+" commented on "+siteName+": "+commentData.commentBody}}function noGapiInteractivePostAvailable(){var gShareCommentElement=shareCommentElement.child(".gShareComment");if(gShareCommentElement)gShareCommentElement.remove()}};function getShortUrl(commentId,commentLink,next){Ext.Ajax.request({disableCaching:false,url:"/reader-comments/p/comment/shorturl/"+commentId,success:success,failure:failure});function success(response,options){var shortUrlResponse=Ext.decode(response.responseText,true);if(!shortUrlResponse||shortUrlResponse.code!="200"||!shortUrlResponse.payload)return next(commentLink);return next(shortUrlResponse.payload)}function failure(response,options){return next(commentLink)}}DMS.RC.shareComment=function shareComment(eventObj,target,cData){var commentData=cData&&cData.commentId?cData:DM.RC.getCommentData(target);if(Ext.fly(target).hasClass("gShareComment")){trackSharing("plusone","comment");DM.ted.tedEvent("social-event",{"social-event":"plusone-share-comment"})}else if(Ext.fly(target).hasClass("fShareComment")){trackSharing("facebook","comment");DM.ted.tedEvent("social-event",{"social-event":"facebook-share-comment"});DMS.RC.fShareComment(commentData.commentLink,commentData.commenterName,commentData.commentBody)}else if(Ext.fly(target).hasClass("tShareComment")){trackSharing("twitter","comment");DM.ted.tedEvent("social-event",{"social-event":"twitter-tweet-comment"});var twitterWindow=window.open("about:blank","",DMS.getWindowDimensions(575,400));getShortUrl(commentData.commentId,commentData.commentLink,function(shortUrl){DMS.RC.tShareComment(twitterWindow,shortUrl,commentData.commentBody)})}else if(Ext.fly(target).hasClass("pShareComment")){var pinterestWindow=window.open("about:blank","",DMS.getWindowDimensions(800,320,true));DM.ted.tedEvent("social-event",{"social-event":"pinterest-share-comment"});getShortUrl(commentData.commentId,commentData.commentLink,function(shortUrl){commentData.shortUrl=shortUrl;DMS.RC.pShareComment(pinterestWindow,shortUrl,commentData)})}function trackSharing(socialNetwork,type){if(typeof DMS.socialClick=="function")DMS.socialClick(socialNetwork,type)}};DMS.RC.updateHoverElements=function updateHoverElements(){if(updateShareOptionsTimeout){clearTimeout(updateShareOptionsTimeout)}updateShareOptionsTimeout=setTimeout(function(){var hoveredReply=Ext.query(".reply.hovered",Ext.getDom("js-comment"))[0];if(hoveredReply){enableCommentFeatures(hoveredReply);updateShareOptionsTimeout=undefined;return}var hoveredComment=Ext.query(".comment.hovered",Ext.getDom("js-comment"))[0];if(hoveredComment){enableCommentFeatures(hoveredComment);updateShareOptionsTimeout=undefined}},10)};function enableCommentFeatures(comment){if(!comment)return;var commentExt=Ext.get(comment);commentExt.child(".shareComment").show();commentExt.child(".reportAbuseLink").show()}})();(function(Ext){var arrowEl,overlayEl,overlayId="dms-drawer",arrowId="dms-drawer-arrow",closeButtonEl,imageHost="http://i.dailymail.co.uk";DM.ShareLinks={init:function(o){var el=Ext.get(o.id);if(!el){return}el.on("click",this.onClick,this,{stopEvent:true,delegate:"a.js-sl",params:o.params})},tpl:null,onClose:function(e){if(e.getTarget("#"+overlayId)&&!Ext.get(e.getTarget()).hasClass("close")){return}Ext.getBody().un("click",DM.ShareLinks.onClose,this);Ext.EventManager.removeListener(window,"resize",DM.ShareLinks.onClose,this);arrowEl=Ext.get(arrowId);if(arrowEl)arrowEl.hide();this.dom.innerHTML="";this.setStyle("display","none")},onClick:function(e,t,o){var el=Ext.get(t),params=o.params,elPos=el.getOffsetsTo(Ext.getBody()),artEl,artLinkEl,url,articleId,title,articleChannelFollowButton,shortUrl,twitterStatus,arrowEl,isChannel=params?params.isChannel?params.isChannel:false:false,showGoogle=params?params.showGoogle?params.showGoogle:false:false,hideEmail=params?params.hideEmail?params.hideEmail:false:false,shareSize=getShareSize(isChannel,showGoogle,hideEmail),leftOffset=0,topOffset=0,topArrowOffset=0,articleImage="",pageTitle="",emailShareStyle=params&&params.emailShareStyle||el.getAttribute("data-email-share-style"),headline=params&&params.headline||el.getAttribute("data-headline");function getShareSize(isChannel,showGoogle,hideEmail){if(isChannel)return{width:288,height:129};var width=332;var height=60;var iconWidth=50;if(showGoogle)width+=iconWidth;if(hideEmail)width-=iconWidth;return{width:width,height:height}}if(params&&params.title){url=params.url;articleChannelFollowButton=params.articleChannelFollowButton;articleId=params.id;title=params.title;twitterStatus=params.eTwitterStatus}else{artEl=e.getTarget(".article",7,true)||e.getTarget(".js-article",7,true);if(artEl){artLinkEl=artEl.child("h2 a")||artEl.child(".title");pageTitle=artEl.getAttribute("data-original-title")}if(!artEl||!artLinkEl){return}var defaultArticleImage="http://f.dailymail.co.uk/i/furniture/comments/articles/m_logo.png";articleImage=artEl.child(".share-link")?addImageHost(artEl.child(".share-link").getAttribute("data-article-image"))||defaultArticleImage:defaultArticleImage;url=artLinkEl.dom.href.replace(/\?.*$/,"");url=swap_domain(url);articleId=/article-(\d+)/.exec(url)[1];var socialHeadlineEl=artEl.child(".social-headline");title=socialHeadlineEl&&socialHeadlineEl.dom.childNodes[0]?socialHeadlineEl.dom.childNodes[0].nodeValue:artLinkEl.dom.childNodes[0].nodeValue;shortUrl=AND.getParams(el.dom)[0]||url;articleChannelFollowButton=$.trim(artEl.select(".article-icon-links-container",7,true).elements[0].getAttribute("data-followbutton"));if(!articleChannelFollowButton){articleChannelFollowButton=$.trim(artEl.getAttribute("data-followbutton"))||"MailOnline"}twitterStatus=DMS.Twitter.truncateTextAndEscape({text:title,url:shortUrl,via:articleChannelFollowButton})}function swap_domain(url){var og=$('meta[property="og:url"]').attr("content"),ogDomain=og.match(/^http:\/\/[^\/]+/);return url.replace(/^http:\/\/[^\/]+/,ogDomain)}function addImageHost(url){if(!url)return;if(url.indexOf("http://")===-1||url.indexOf("http://")>0){url=imageHost+url}return url}overlayEl=Ext.get(overlayId);arrowEl=Ext.get(arrowId);if(overlayEl){overlayEl.removeClass("open")}else{overlayEl=Ext.getBody().insertHtml("beforeEnd",'<div id="'+overlayId+'"></div>',true);arrowEl=Ext.getBody().insertHtml("beforeEnd",'<div id="'+arrowId+'">&nbsp</div>',true)}if(params.inside){leftOffset=showGoogle?-390:-340;topOffset=-112;topArrowOffset=-30;arrowEl.setStyle({backgroundPosition:"-600px 48px"})}else{leftOffset=0;topOffset=0;topArrowOffset=0;arrowEl.setStyle({backgroundPosition:"-600px 0px"})}overlayEl.setStyle({display:"block",width:""+shareSize.width+"px",height:""+shareSize.height+"px",left:elPos[0]-15+leftOffset+"px",top:elPos[1]+30+topOffset+"px"});arrowEl.setStyle({display:"block",position:"absolute",left:elPos[0]+"px",top:elPos[1]+20+topArrowOffset+"px"});this.tpl=new Ext.Template('<div class="wrapper">'+"<ul>"+(showGoogle?'<li class="googleplus"><a target="_new" title="Share this story on Google +" href="https://plus.google.com/share?url={eUrl}" class="js-tl">'+"<span>Google+</span></a></li>":"")+(isChannel?'<li class="facebook"><a target="_new" title="Share this story on Facebook" href="http://www.facebook.com/sharer.php?u={eUrl}" class="js-tl">'+"<span>Facebook</span></a></li>"+'<li class="twitter"><a target="_new" title="Share this story on Twitter" href="http://twitter.com/intent/tweet?related={articleChannelFollowButton},'+twitterVia+'&text={eTwitterStatus}" class="js-tl">'+"<span>Twitter</span></a></li>"+'<li class="pinterest"><a target="_new" title="Share this story on Pinterest" href="http://www.pinterest.com/pin/create/button/?url={eUrl}&description={eTitle}%20%23DailyMail&media={eArticleImage}" '+'class="js-tl">'+"<span>Pinterest</span></a></li>"+'<li class="googleplus"><a target="_new" title="Share this story on Google +" href="https://plus.google.com/share?url={eUrl}" class="js-tl">'+"<span>Google+</span></a></li>":"")+'<li class="reddit"><a target="_new" title="Share this story on Reddit" href="http://reddit.com/submit?url={eUrl}&title={eTitle}" '+(isChannel?"":"onclick=\"postToReddit('{placement}');\"")+'class="js-tl">'+"<span>Reddit</span></a></li>"+'<li class="stumbleupon"><a target="_new" title="Share this story on Stumble Upon" href="http://www.stumbleupon.com/badge/?url={eUrl}&title={eTitle}" '+(isChannel?"":"onclick=\"postToStumbleUpon('{placement}');\"")+'class="js-tl">'+"<span>Stumble Upon</span></a></li>"+'<li class="digg"><a target="_new" title="Share this story on Digg" href="http://digg.com/submit?phase=2&url={eUrl}&title={eTitle}" '+(isChannel?"":"onclick=\"postToDiggit('{placement}');\"")+'class="js-tl">'+"<span>Digg it</span></a></li>"+'<li class="linkedin"><a target="_new" title="Share this story on LinkedIn" href="http://www.linkedin.com/shareArticle?mini=true&url={eUrl}&title={eTitle}" '+(isChannel?"":"onclick=\"postToLinkedIn('{placement}');\"")+'class="js-tl">'+"<span>LinkedIn</span></a></li>"+'<li class="print"><a href="{printUrl}" title="Print this article" onclick="DM.popup(\'{printUrl}\', 600, 600); return false;">'+"<span>Print</span></a></li>"+(!hideEmail?emailShareStyle?'<li class="email"><a href="mailto:?subject={mailtoSubject}&body={mailtoBody}" data-on-mobile="mailto:?subject={eTitle}&body={mobileEmailBody}" title="Email to a friend">'+"<span>Email</span></a></li>":'<li class="email"><a href="{newEmailUrl}" data-target="/email-article.html?id={eId}" data-modal-id="email-modal-overlay" data-modal-type="email-overlay" data-ajax-refresh-everytime="true" data-toggle="modal"'+(isChannel?"":' data-placement="{placement}"')+' data-on-mobile="mailto:?subject={eTitle}&body={mobileEmailBody}" title="Email to a friend">'+"<span>Email</span></a></li>":"")+"</ul>"+"</div>"+'<div class="close">&nbsp;</div>').compile();overlayEl.dom.innerHTML=this.tpl.apply({eTitle:encodeURIComponent(title),eUrl:encodeURIComponent(url),mailtoSubject:encodeURIComponent("Read this: "+headline),mailtoBody:encodeURIComponent(url+"?ito="+emailShareStyle),newEmailUrl:url+"#email",mobileEmailBody:url+"%0D%0A%0D%0AGet the MailOnline App: %0D%0A"+/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i.exec(url)[0]+"mobile",eId:articleId,printUrl:getPrintUrl(url)+"?printingPage=true",eTwitterStatus:twitterStatus,articleChannelFollowButton:encodeURIComponent(articleChannelFollowButton),placement:params.placement,eArticleImage:encodeURIComponent(articleImage)});if(isChannel)bindTrackingForDrawer(articleId,pageTitle||title);if(!overlayEl.dom.getAttribute("data-ready")){overlayEl.dom.setAttribute("data-ready","true")}arrowEl=Ext.get(arrowId);if(!params.inside){if(arrowEl)arrowEl.show()}if(params.zIndex){arrowEl.setStyle("z-index",params.zIndex);overlayEl.setStyle("z-index",params.zIndex)}overlayEl.slideIn(params.anchor,{scope:overlayEl,duration:.3,callback:function(){var el=this.child(".wrapper");this.addClass("open");if(params.inside){if(arrowEl)arrowEl.show()}if(!el){return}el.fadeIn({duration:.4})}});function getPrintUrl(url){return url.replace(/^http:\/\/[^\/]+/,"http://"+window.location.host)}Ext.getBody().on("click",this.onClose,overlayEl);closeButtonEl=overlayEl.child(".close");closeButtonEl.on("click",this.onClose,overlayEl,{single:true});Ext.EventManager.addListener(window,"resize",this.onClose,overlayEl,{single:true});function bindTrackingForDrawer(articleId,title){$("#"+overlayId+" li").unbind("click");$("#"+overlayId+" li").on("click",function(){var social=$(this).attr("class");if($.inArray(social,["print"])>-1)return;DM.pageEvents.fireEvent(DM.pageEvents.SOCIAL_SHARE_CLICKED,{site:social,placement:"drawer",pageMetadata:{articleId:articleId,articleTitle:title,contentType:"social-share",pageName:DM.getPageMetadata().pageName}})})}}}})(Ext);(function(){function handleAccordionClick(e){var row=e.target.parentNode;var rowClasses=row.getAttribute("class")||"";var accClass="mol-accordion-open wocc";if(!row.getAttribute("data-accordion-controller"))return;if(rowClasses.indexOf(accClass)!==-1)row.setAttribute("class",rowClasses.replace(accClass,""));else row.setAttribute("class",rowClasses+" "+accClass)}if(document.addEventListener)document.addEventListener("click",handleAccordionClick,false);else document.attachEvent("onclick",handleAccordionClick)})();AND={log:function(str){if(typeof console!=="undefined"){console.log(str)}else{alert(str)}},BLANK_IMAGE_URL:"/1x1.gif",getParams:function(el){return AND.gt(el.className,"|")},getHrefParams:function(el){return AND.gt(el.href,"#")[1]},gt:function(x,c){if(x){if(x.indexOf(c)!=-1){var arr=x.split(c);return arr}else{return""}}else{return""}},fixImage:function(i){if(i){if(i.tagName!=="IMG")i=i.getElementsByTagName("IMG")[0];if(i){if(i&&i.src.indexOf(this.BLANK_IMAGE_URL)!=-1)i.src=AND.getParams(i)[0]}}},fixImages:function(el){var ar=Ext.query("img",el);for(var i=0,len=ar.length;i<len;i++){if(ar[i].src.indexOf(this.BLANK_IMAGE_URL)!=-1)ar[i].src=AND.getParams(ar[i])[0]}},clickToURL:function(id,url){var el=Ext.get(id);if(el){el.on("click",function(e,t){if(t==el.dom)document.location.href=url},this)}},trackClickInline:function(id,url){var el=Ext.get(id);if(el){el.on("click",function(){Ext.DomHelper.append(Ext.getBody().dom,'<img src="'+url+'" width="0" height="0" alt="trackClick" />')},this)}},repaintDOM:function(el){if(Ext.isIE){if(typeof el==="string")el=Ext.fly(el).dom;el.className=el.className}},randNum:function(){return Math.floor(Math.random()*1e3+1)},extendObject:function(destination,source){for(var property in source){destination[property]=source[property]}return destination},getUrlParameter:function(p){p=p.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+p+"=([^&#]*)");var results=regex.exec(window.location.href);return results==null?"":results[1]},getPageSize:function(){var xScroll,yScroll;if(window.innerHeight&&window.scrollMaxY){xScroll=document.body.scrollWidth;yScroll=window.innerHeight+window.scrollMaxY}else if(document.body.scrollHeight>document.body.offsetHeight){xScroll=document.body.scrollWidth;yScroll=document.body.scrollHeight}else{xScroll=document.body.offsetWidth;yScroll=document.body.offsetHeight}var windowWidth,windowHeight;if(self.innerHeight){windowWidth=self.innerWidth;windowHeight=self.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){windowWidth=document.documentElement.clientWidth;windowHeight=document.documentElement.clientHeight}else if(document.body){windowWidth=document.body.clientWidth;windowHeight=document.body.clientHeight}return[xScroll,yScroll,windowWidth,windowHeight]},competitions:{getRegUrl:function(strDomain){return"/registration"},dologon:function(doc,strDomain){doc.action=AND.competitions.getRegUrl(strDomain)+"/login";doc.redirectPath.value=document.URL;doc.submit()},doregister:function(doc,strDomain){doc.action=AND.competitions.getRegUrl(strDomain)+"/login";doc.redirectPath.value=document.URL;doc.submit()},dologout:function(in_redirect_url){DM.deleteCookie("userid","/",".dailymail.co.uk");DM.deleteCookie("authid","/",".dailymail.co.uk");DM.deleteCookie("subuserid","/",".dailymail.co.uk");DM.deleteCookie("email","/",".dailymail.co.uk");DM.deleteCookie("userid","/",".mailonsunday.co.uk");DM.deleteCookie("subuserid","/",".mailonsunday.co.uk");DM.deleteCookie("email","/",".mailonsunday.co.uk");DM.deleteCookie("userid","/",".anl.dmgt.net");DM.deleteCookie("authid","/",".anl.dmgt.net");DM.deleteCookie("userid","/",".thisismoney.co.uk");DM.deleteCookie("subuserid","/",".thisismoney.co.uk");DM.deleteCookie("email","/",".thisismoney.co.uk");window.location=in_redirect_url},docomplogon:function(doc,comp_id,strDomain){doc.action=AND.competitions.getRegUrl(strDomain)+"/loginCompetition";doc.EntryPath.value="https://register.anm.co.uk/register/comp.htm";if(doc.CompId.value==""){doc.CompId.value=comp_id}doc.submit()},doedit:function(doc,strDomain){doc.action=AND.competitions.getRegUrl(strDomain)+"/login";doc.Email.value=DM.getCookie("email");doc.redirectPath.value=document.URL;doc.Update.value="Y";doc.submit()}},getScrollXY:function(){var scrOfX=0,scrOfY=0;if(typeof window.pageYOffset==="number"){scrOfY=window.pageYOffset;scrOfX=window.pageXOffset}else if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){scrOfY=document.body.scrollTop;scrOfX=document.body.scrollLeft}else if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){scrOfY=document.documentElement.scrollTop;scrOfX=document.documentElement.scrollLeft}return[scrOfX,scrOfY]},setCookie:function(szName,szValue,szExpires,szPath,szDomain,bSecure){var szCookieText=escape(szName)+"="+escape(szValue);szCookieText+=szExpires?";expires="+szExpires.toGMTString():"";szCookieText+=szPath?";path="+szPath:"";szCookieText+=szDomain?";domain="+szDomain:"";szCookieText+=bSecure?";secure":"";document.cookie=szCookieText},getCookie:function(szName){var szValue=null;if(document.cookie){var arr=document.cookie.split(escape(szName)+"=");if(2<=arr.length){var szValue=unescape(arr[1].split(";")[0]);if(szValue.length>1&&szValue.charAt(0)=='"'&&szValue.charAt(szValue.length-1)=='"'){szValue=szValue.substring(1,szValue.length-1)}}}return szValue},deleteCookie:function(szName){var tmp=AND.getCookie(szName);if(tmp)AND.setCookie(szName,tmp,new Date(1))},loggedIn:function(){if(this.getCookie("authid")){Ext.getBody().addClass("logged-in")}},midas:{refresh:function(){var rUrl=document.URL.toString();if(rUrl.indexOf("mpp=")>0){window.location=rUrl.substring(0,rUrl.indexOf("mpp="))}else{window.location=window.location}},logon:function(){var rPath=document.URL.toString();if(rPath.indexOf("mpp=")>0){rPath=rPath.substring(0,rPath.indexOf("mpp="))}window.location=AND.competitions.getRegUrl(rPath)+"/login.html?targetUrl="+escape(rPath)},checkLogon:function(){if(DM.getCookie("authid")){AND.midas.refresh()}else{AND.midas.logon()}},subscribe:function(){var sUrl="/money/subscribe.html",rPath=document.URL;if(rPath.indexOf("mpp=")>0){rPath=rPath.substring(0,rPath.indexOf("mpp="))}rPath=escape(rPath);window.location=sUrl+"?redirect="+rPath}},addScript:function(document){var loaded={},inflight={};function loadAsync(src,options){var options=options||{},callback=typeof options==="function"?options:options.success;if(loaded[src])return callback&&callback();if(addInflightCallback(src,callback))return;var ready=false,inflightCallbacks=inflight[src],script=document.createElement("script"),container=options.cId&&document.getElementById(options.cId)||document.head||document.getElementsByTagName("head")[0];script.type="text/javascript";script.src=src;script.onload=script.onreadystatechange=function(){if(!ready&&(!this.readyState||this.readyState==="complete"||this.readyState==="loaded")){ready=true;loaded[src]=true;for(var i=0;i<inflightCallbacks.length;i++){inflightCallbacks[i]()}}};container.appendChild(script)}function addInflightCallback(src,callback){var inflightCallbacks=inflight[src],exists=inflightCallbacks!==undefined;if(!exists)inflightCallbacks=inflight[src]=[];if(callback)inflightCallbacks.push(callback);return exists}return loadAsync}(document)};DM.Rotator=Ext.extend(Ext.util.Observable,{animDuration:1.2,animEasing:"easeOut",pageSize:3,pageCount:4,activePage:1,activeClass:"link-wocc",rotate:true,imagesRequested:false,constructor:function(elId,config){var container=Ext.get(elId);
if(!container){return null}config=config||{};Ext.apply(this,config);DM.Rotator.superclass.constructor.call(this,config);this.container=container;if(config.video){this.panels=this.container.child(config.video.panels);this.pages=this.container.child(config.video.pages)}else{this.panels=this.container.child(".rotator-panels");this.pages=this.container.child(".rotator-pages")}this._setActivePageClass(1);var item=this.panels.child("li");var itemWidth=item.getWidth();if(!itemWidth&&!this.container.isVisible()){this.container.dom.style.display="block";itemWidth=item.getWidth();this.container.dom.style.display=""}this.itemWidth=itemWidth+Number(/(\d+)/.exec(item.getStyle("margin-right"))[0]);this._initEvents()},_setActivePageClass:function(page){this.pages.select("li,div").each(function(li,idx){var data=li.child("a").dom.getAttribute("data-page");if(data==page)li.addClass(this.activeClass);else li.removeClass(this.activeClass);if(!this.rotate&&(data=="prev"&&page==1||data=="next"&&page==this.pageCount)||this.pageCount==1)li.addClass("disabled");else li.removeClass("disabled")},this)},_initEvents:function(){this.pages.on("click",function(evt){evt.preventDefault();var page=evt.target.getAttribute("data-page");if(page=="prev")this.previous();else if(page=="next")this.next();else if(page>0)this.scrollTo(page*1)},this)},_requestImages:function(){if(!!DM.LazyLoad&&!this.imagesRequested){this.panels.select("[data-src]").each(function(o){DM.LazyLoad(o.dom)});this.imagesRequested=true}},scrollTo:function(page){this._requestImages();this.activePage=page;this._setActivePageClass(page);var offset=this.itemWidth*this.pageSize*(page-1)*-1;this.panels.stopFx(false);this.panels.anim({left:{to:offset}},{duration:this.animDuration,easing:this.animEasing})},next:function(){var page=this.activePage>=this.pageCount?this.rotate?1:this.activePage:this.activePage+1;this.scrollTo(page)},previous:function(){var page=this.activePage<=1?this.rotate?this.pageCount:this.activePage:this.activePage-1;this.scrollTo(page)}});DM.Rotator.initMiniCarousel=function(){DM.later("bundle",function(){var elId="mini-carousel-wrapper",config={pageSize:6,pageCount:4,rotate:false};new DM.Rotator(elId,config)})};DM.Rotator.initMiniCarouselExt=function(elId,ps,pc){DM.later("bundle",function(){var config={pageSize:ps,pageCount:pc,rotate:false};new DM.Rotator(elId,config)})};jQuery(function($){$.fn.simplemarquee=function(options){var settings=$.extend({speed:5e3,direction:"rtl",pause:true,wrapclass:"sections"},options);var html="";var width=0;var animation;return this.each(function(){if($(this).length){html='<div class="section">'+$(this).html()+"</div>";$(this).html('<div class="'+settings.wrapclass+'">'+html+"</div>");width=$("."+settings.wrapclass,this).width();if($(this).css("height")=="0px"){$(this).height($(".section:eq(0)",this).height())}var n=0;for(i=0;i<30;i++){$("."+settings.wrapclass,this).append(html);if($("."+settings.wrapclass,this).width()>$(this).width()){n++}if(n>1){break}}$("."+settings.wrapclass,this).width("9999px");animateit($("."+settings.wrapclass,this),true)}if(settings.pause){$("."+settings.wrapclass,this).mouseover(function(){animation.stop()});$("."+settings.wrapclass,this).mouseout(function(){animateit($(this),false)})}});function animateit(obj,rst){var position=0;var speed=settings.speed;if(settings.direction=="ltr"){if(rst)obj.css("left","-"+width*2+"px");position=width-2}else{position=width+2;if(rst)obj.css("left","0px")}if(!rst){var left=parseInt(obj.css("left"),10);var percentageComplete=Math.abs(left)/width*100;speed=Math.round(settings.speed/100*(100-percentageComplete))}animation=obj.animate({left:"-"+position+"px"},speed,"linear",function(){animateit(obj,true)})}}});$(document).ready(function(){if(navigator.userAgent.indexOf("MSIE")!=-1){initializeConsole()}$("#js-ticker-rotator").simplemarquee({speed:4e4,direction:"rtl",pause:true});$(document).on("click",".lb-tabs > li",function(){var $this=$(this);if($this.attr("data-href"))handle_tab_selection($this)});$(document).on("click",".lb-tabbed-pane .lb-tabs > li",function(evt){var $this=$(this);if(!$this.attr("data-href"))handle_tabbed_pane_selection($this,evt)});$(document).on("change",".tabbed-article-list .dropdown",function(evt){var $this=$(this),selectedOption=$(this[this.selectedIndex]);if(selectedOption.data("url")){handle_dropdown_selection(selectedOption,evt)}else{handle_legacy_dropdown_selection($this)}});$(document).on("click",".rotator-pages a",function(evt){var $this=$(this);evt.preventDefault();if($this.attr("data-href"))handle_page_rotation($this)})});function handle_dropdown_selection(selectedOption,evt){var module=selectedOption.closest(".tabbed-article-list"),parent=module.parent(),tabs=module.find(".lb-tabs>li"),selectedTab=module.find(".lb-tabs>li.selected-tab"),index=$.inArray(selectedTab[0],tabs);parent.load(selectedOption.data("url"),function(){var panes=parent.find(".lb-panes").children(),tabs=parent.find(".lb-tabs>li");select_tab(index,tabs,panes)})}function handle_tabbed_pane_selection(selectedTab,event){var module=selectedTab.closest(".lb-tabbed-pane"),tabs=selectedTab.parent().children(),index=$.inArray(selectedTab[0],tabs),panes=module.find(".lb-panes").children();select_tab(index,tabs,panes)}function select_tab(index,tabs,panes){tabs.removeClass("selected-tab");$(tabs[index]).addClass("selected-tab");panes.removeClass("selected-pane");$(panes[index]).addClass("selected-pane")}function handle_tab_selection(selectedTab){attr_list=selectedTab.attr("data-href").match(/^cc-([0-9]+)-tab-([0-9]+)-country-(GB|US)/);$("#slot-for-"+attr_list[1]).load(url_prefix+"update/tabbed-list?id="+attr_list[1]+"&tab="+attr_list[2]+"&country_code="+attr_list[3])}function handle_legacy_dropdown_selection(selectedChannel){selectedTab=selectedChannel.closest(".slot").find("li.selected-tab");attr_list=selectedTab.attr("data-href").match(/^cc-([0-9]+)-tab-([0-9]+)-country-(GB|US)/);$("#slot-for-"+attr_list[1]).load(url_prefix+"update/tabbed-list-channel?id="+attr_list[1]+"&tab="+attr_list[2]+"&country_code="+attr_list[3]+"&channel="+selectedChannel.val())}function handle_page_rotation(link){attr_list=link.attr("data-href").match(/^cc-([0-9]+)-page-([0-9]+)-country-(GB|US)/);$("#slot-for-"+attr_list[1]).load(url_prefix+"update/paginated-list?id="+attr_list[1]+"&page="+attr_list[2]+"&country_code="+attr_list[3])}function initializeConsole(){if(!window.console)window.console={};if(!window.console.log)window.console.log=function(){}}(function($){"use strict";function transitionEnd(){var el=document.createElement("bootstrap");var transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames){if(el.style[name]!==undefined){return{end:transEndEventNames[name]}}}}$.fn.emulateTransitionEnd=function(duration){var called=false,$el=this;$(this).one($.support.transition.end,function(){called=true});var callback=function(){if(!called)$($el).trigger($.support.transition.end)};setTimeout(callback,duration);return this};$.support.transition=transitionEnd();var NS="ez-modal";var numberOfModals=0;var methods={init:function(options){var defaults={container:"body",closeOnBackgroundClick:true,triggerOnClick:false,toggleButtons:false,autoOpen:false,closeKeyCodes:"27",center:false,ajaxUrl:false,ajaxRefreshEverytime:true,ajaxLoadOnInit:false,ajaxErrorMessage:"Sorry, but something went wrong. Please come back later and try again."};options=$.extend(defaults,options);return this.each(function(){var o=options,showModal,hideModal,showBackdrop,loadHTML,ui={},evtNS="."+NS+"-"+numberOfModals++,alreadyLoaded=false,toBeCentered=o.center,centerModal,closeKeyCodes=$.map(o.closeKeyCodes.split(" "),function(el){if(el&&el.length){return parseInt(el,10)}});ui.container=$(o.container);ui.backdrop=ui.container.children("."+NS+"-backdrop");if(!ui.backdrop.length){ui.backdrop=$("<div class="+NS+"-backdrop></div>").appendTo(ui.container)}ui.modal=$(this).addClass(NS);ui.modal.data("modal","active");showBackdrop=function(){ui.backdrop.show();setTimeout(function(){ui.backdrop.addClass(NS+"-backdrop-on")},30)};showModal=function(){ui.modal.show();centerModal();setTimeout(function(){ui.container.addClass(NS+"-container-on");ui.modal.addClass(NS+"-on");ui.modal.attr("aria-hidden","false");ui.modal.focus();ui.modal.trigger({type:NS+"-after-open",ui:ui,opt:o})},30)};hideModal=function(){ui.container.removeClass(NS+"-container-on");ui.backdrop.removeClass(NS+"-backdrop-on");ui.modal.removeClass(NS+"-on");ui.modal.attr("aria-hidden","true");if($.support.transition){ui.container.addClass(NS+"-container-off").one($.support.transition.end,function(){ui.container.removeClass(NS+"-container-off")}).emulateTransitionEnd(600);ui.backdrop.addClass(NS+"-backdrop-off").one($.support.transition.end,function(){ui.backdrop.removeClass(NS+"-backdrop-off").hide()}).emulateTransitionEnd(600);ui.modal.addClass(NS+"-off").one($.support.transition.end,function(){ui.modal.removeClass(NS+"-off").hide();ui.modal.trigger({type:NS+"-after-close",ui:ui,opt:o})}).emulateTransitionEnd(600)}else{ui.backdrop.hide();ui.modal.hide();ui.modal.trigger({type:NS+"-after-close",ui:ui,opt:o})}};centerModal=function(){if(toBeCentered){ui.modal.css("margin-left",0);ui.modal.css("margin-left","-"+ui.modal.outerWidth(true)/2+"px");ui.modal.css("margin-top",0);ui.modal.css("margin-top","-"+ui.modal.outerHeight(true)/2+"px")}toBeCentered=false};loadHTML=o.ajaxUrl&&function(cb){if(!alreadyLoaded||o.ajaxRefreshEverytime){ui.modal.trigger({type:NS+"-before-load",ui:ui,opt:o});ui.modal.load($.isFunction(o.ajaxUrl)&&o.ajaxUrl()||o.ajaxUrl,function(response,status,req){if(status==="error"){ui.modal.html('<div class="'+NS+"-error "+NS+'-close" >'+o.ajaxErrorMessage+"</div>")}else{alreadyLoaded=true;toBeCentered=o.center}ui.modal.trigger({type:NS+"-after-load",ui:ui,opt:o});cb()})}else{cb()}}||function(cb){cb()};if(o.ajaxLoadOnInit){loadHTML(function(){})}ui.modal.on(NS+"-open"+evtNS,function(){showBackdrop();ui.modal.trigger({type:NS+"-before-open",ui:ui,opt:o});loadHTML(function(){showModal()})});ui.modal.on(NS+"-close"+evtNS,function(){ui.modal.trigger({type:NS+"-before-close",ui:ui,opt:o});hideModal()});if(o.autoOpen){ui.modal.trigger(NS+"-open")}if(closeKeyCodes){$(document).on("keydown"+evtNS,function(e){if(ui.modal.is("."+NS+"-on")){if($.inArray(e.keyCode,closeKeyCodes)!==-1){ui.modal.trigger(NS+"-close");return false}}})}if(o.triggerOnClick){$(document).on("click"+evtNS,o.triggerOnClick,function(evt){ui.modal.trigger(NS+"-open");return false})}if(o.toggleButtons){$(o.toggleButtons).each(function(){$(this).data("modal",ui.modal)})}ui.modal.on("click"+evtNS,"."+NS+"-close",function(evt){ui.modal.trigger(NS+"-close");return false});if(o.closeOnBackgroundClick){ui.backdrop.on("click"+evtNS,function(){ui.modal.trigger(NS+"-close");return false})}ui.modal.bind(NS+"-destroy"+evtNS,function(){ui.backdrop.off(evtNS);ui.modal.off(evtNS);$(document).off(evtNS);hideModal();ui.modal.removeData("modal")})})},open:function(){this.trigger(NS+"-open")},close:function(){this.trigger(NS+"-close")},destroy:function(){this.trigger(NS+"-destroy")}};$.fn.ezmodal=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}if(typeof method==="object"||!method){return methods.init.apply(this,arguments)}$.error("Method "+method+" does not exist on jQuery.ezmodal")};$(document).on("click."+NS,'[data-toggle="modal"]',function(e){var $this=$(this);if($this.attr("data-on-mobile")&&(MobileUtils.isMobile()||MobileUtils.isKindleSilk())){$(this).attr("href",$this.attr("data-on-mobile"));return}var href=$this.attr("href"),target=$this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,""),modalId=$this.data("modal-id"),$target;if(target.indexOf("#")===0){$target=$(target);if(!$target.data("modal")){$target.ezmodal($.extend($target.data(),$this.data()))}}else{if(modalId){$target=$("#"+modalId)}else{$target=$this.data("modal")}if(!$target||$target.length==0){$target=$('<div class="'+NS+'" aria-hidden="true" role="dialog"></div>');modalId&&$target.attr("id",modalId);$target.ezmodal($.extend({ajaxUrl:target,toggleButtons:$this},$this.data())).appendTo("body")}}$target.ezmodal("open");e.preventDefault()})})(jQuery);var G_IMG_SRV="http://i.mol.im";DM.Fn=function(){var initClass=function(type,items){var cls,initFn,scope,l=items.length;if(typeof DM[type]==="undefined"){type=type.charAt(0).toUpperCase()+type.slice(1);if(typeof DM[type]==="undefined"){return}}cls=DM[type];if(typeof cls==="function"){while(l>0){--l;new cls(items[l].id,items[l].params)}}else if(typeof cls==="object"){if(typeof cls.getInstance==="function"){initFn=cls.getInstance().init;scope=cls.getInstance()}else{initFn=cls.init;scope=cls}while(l>0){--l;initFn.call(scope,items[l])}}};return{init:function(){var type;if(self!=top)AND.FixIFrame();for(type in DM.m){initClass(type,DM.m[type])}}}}();var swfobject=function(){var D="undefined",r="object",S="Shockwave Flash",W="ShockwaveFlash.ShockwaveFlash",q="application/x-shockwave-flash",R="SWFObjectExprInst",x="onreadystatechange",O=window,j=document,t=navigator,T=false,U=[h],o=[],N=[],I=[],l,Q,E,B,J=false,a=false,n,G,m=true,M=function(){var aa=typeof j.getElementById!=D&&typeof j.getElementsByTagName!=D&&typeof j.createElement!=D,ah=t.userAgent.toLowerCase(),Y=t.platform.toLowerCase(),ae=Y?/win/.test(Y):/win/.test(ah),ac=Y?/mac/.test(Y):/mac/.test(ah),af=/webkit/.test(ah)?parseFloat(ah.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,X=!+"\x0B1",ag=[0,0,0],ab=null;if(typeof t.plugins!=D&&typeof t.plugins[S]==r){ab=t.plugins[S].description;if(ab&&!(typeof t.mimeTypes!=D&&t.mimeTypes[q]&&!t.mimeTypes[q].enabledPlugin)){T=true;X=false;ab=ab.replace(/^.*\s+(\S+\s+\S+$)/,"$1");ag[0]=parseInt(ab.replace(/^(.*)\..*$/,"$1"),10);ag[1]=parseInt(ab.replace(/^.*\.(.*)\s.*$/,"$1"),10);ag[2]=/[a-zA-Z]/.test(ab)?parseInt(ab.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof O.ActiveXObject!=D){try{var ad=new ActiveXObject(W);if(ad){ab=ad.GetVariable("$version");if(ab){X=true;ab=ab.split(" ")[1].split(",");ag=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]}}}catch(Z){}}}return{w3:aa,pv:ag,wk:af,ie:X,win:ae,mac:ac}}(),k=function(){if(!M.w3){return}if(typeof j.readyState!=D&&j.readyState=="complete"||typeof j.readyState==D&&(j.getElementsByTagName("body")[0]||j.body)){f()}if(!J){if(typeof j.addEventListener!=D){j.addEventListener("DOMContentLoaded",f,false)}if(M.ie&&M.win){j.attachEvent(x,function(){if(j.readyState=="complete"){j.detachEvent(x,arguments.callee);f()}});if(O==top){(function(){if(J){return}try{j.documentElement.doScroll("left")}catch(X){setTimeout(arguments.callee,0);return}f()})()}}if(M.wk){(function(){if(J){return}if(!/loaded|complete/.test(j.readyState)){setTimeout(arguments.callee,0);return}f()})()}s(f)}}();function f(){if(J){return}try{var Z=j.getElementsByTagName("body")[0].appendChild(C("span"));Z.parentNode.removeChild(Z)}catch(aa){return}J=true;var X=U.length;for(var Y=0;Y<X;Y++){U[Y]()}}function K(X){if(J){X()}else{U[U.length]=X}}function s(Y){if(typeof O.addEventListener!=D){O.addEventListener("load",Y,false)}else{if(typeof j.addEventListener!=D){j.addEventListener("load",Y,false)}else{if(typeof O.attachEvent!=D){i(O,"onload",Y)}else{if(typeof O.onload=="function"){var X=O.onload;O.onload=function(){X();Y()}}else{O.onload=Y}}}}}function h(){if(T){V()}else{H()}}function V(){var X=j.getElementsByTagName("body")[0];var aa=C(r);aa.setAttribute("type",q);var Z=X.appendChild(aa);if(Z){var Y=0;(function(){if(typeof Z.GetVariable!=D){var ab=Z.GetVariable("$version");if(ab){ab=ab.split(" ")[1].split(",");M.pv=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]}}else{if(Y<10){Y++;setTimeout(arguments.callee,10);return}}X.removeChild(aa);Z=null;H()})()}else{H()}}function H(){var ag=o.length;if(ag>0){for(var af=0;af<ag;af++){var Y=o[af].id;var ab=o[af].callbackFn;var aa={success:false,id:Y};if(M.pv[0]>0){var ae=c(Y);if(ae){if(F(o[af].swfVersion)&&!(M.wk&&M.wk<312)){w(Y,true);if(ab){aa.success=true;aa.ref=z(Y);ab(aa)}}else{if(o[af].expressInstall&&A()){var ai={};ai.data=o[af].expressInstall;ai.width=ae.getAttribute("width")||"0";ai.height=ae.getAttribute("height")||"0";if(ae.getAttribute("class")){ai.styleclass=ae.getAttribute("class")}if(ae.getAttribute("align")){ai.align=ae.getAttribute("align")}var ah={};var X=ae.getElementsByTagName("param");var ac=X.length;for(var ad=0;ad<ac;ad++){if(X[ad].getAttribute("name").toLowerCase()!="movie"){ah[X[ad].getAttribute("name")]=X[ad].getAttribute("value")}}P(ai,ah,Y,ab)}else{p(ae);if(ab){ab(aa)}}}}}else{w(Y,true);if(ab){var Z=z(Y);if(Z&&typeof Z.SetVariable!=D){aa.success=true;aa.ref=Z}ab(aa)}}}}}function z(aa){var X=null;var Y=c(aa);if(Y&&Y.nodeName=="OBJECT"){if(typeof Y.SetVariable!=D){X=Y}else{var Z=Y.getElementsByTagName(r)[0];if(Z){X=Z}}}return X}function A(){return!a&&F("6.0.65")&&(M.win||M.mac)&&!(M.wk&&M.wk<312)}function P(aa,ab,X,Z){a=true;E=Z||null;B={success:false,id:X};var ae=c(X);if(ae){if(ae.nodeName=="OBJECT"){l=g(ae);Q=null}else{l=ae;Q=X}aa.id=R;if(typeof aa.width==D||!/%$/.test(aa.width)&&parseInt(aa.width,10)<310){aa.width="310"}if(typeof aa.height==D||!/%$/.test(aa.height)&&parseInt(aa.height,10)<137){aa.height="137"}j.title=j.title.slice(0,47)+" - Flash Player Installation";var ad=M.ie&&M.win?"ActiveX":"PlugIn",ac="MMredirectURL="+O.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ad+"&MMdoctitle="+j.title;if(typeof ab.flashvars!=D){ab.flashvars+="&"+ac}else{ab.flashvars=ac}if(M.ie&&M.win&&ae.readyState!=4){var Y=C("div");X+="SWFObjectNew";Y.setAttribute("id",X);ae.parentNode.insertBefore(Y,ae);ae.style.display="none";(function(){if(ae.readyState==4){ae.parentNode.removeChild(ae)}else{setTimeout(arguments.callee,10)}})()}u(aa,ab,X)}}function p(Y){if(M.ie&&M.win&&Y.readyState!=4){var X=C("div");Y.parentNode.insertBefore(X,Y);X.parentNode.replaceChild(g(Y),X);Y.style.display="none";(function(){if(Y.readyState==4){Y.parentNode.removeChild(Y)}else{setTimeout(arguments.callee,10)}})()}else{Y.parentNode.replaceChild(g(Y),Y)}}function g(ab){var aa=C("div");if(M.win&&M.ie){aa.innerHTML=ab.innerHTML}else{var Y=ab.getElementsByTagName(r)[0];if(Y){var ad=Y.childNodes;if(ad){var X=ad.length;for(var Z=0;Z<X;Z++){if(!(ad[Z].nodeType==1&&ad[Z].nodeName=="PARAM")&&!(ad[Z].nodeType==8)){aa.appendChild(ad[Z].cloneNode(true))}}}}}return aa}function u(ai,ag,Y){var X,aa=c(Y);if(M.wk&&M.wk<312){return X}if(aa){if(typeof ai.id==D){ai.id=Y}if(M.ie&&M.win){var ah="";for(var ae in ai){if(ai[ae]!=Object.prototype[ae]){if(ae.toLowerCase()=="data"){ag.movie=ai[ae]}else{if(ae.toLowerCase()=="styleclass"){ah+=' class="'+ai[ae]+'"'}else{if(ae.toLowerCase()!="classid"){ah+=" "+ae+'="'+ai[ae]+'"'}}}}}var af="";for(var ad in ag){if(ag[ad]!=Object.prototype[ad]){af+='<param name="'+ad+'" value="'+ag[ad]+'" />'}}aa.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ah+">"+af+"</object>";N[N.length]=ai.id;X=c(ai.id)}else{var Z=C(r);Z.setAttribute("type",q);for(var ac in ai){if(ai[ac]!=Object.prototype[ac]){if(ac.toLowerCase()=="styleclass"){Z.setAttribute("class",ai[ac])}else{if(ac.toLowerCase()!="classid"){Z.setAttribute(ac,ai[ac])}}}}for(var ab in ag){if(ag[ab]!=Object.prototype[ab]&&ab.toLowerCase()!="movie"){e(Z,ab,ag[ab])}}aa.parentNode.replaceChild(Z,aa);X=Z}}return X}function e(Z,X,Y){var aa=C("param");aa.setAttribute("name",X);aa.setAttribute("value",Y);Z.appendChild(aa)}function y(Y){var X=c(Y);if(X&&X.nodeName=="OBJECT"){if(M.ie&&M.win){X.style.display="none";(function(){if(X.readyState==4){b(Y)}else{setTimeout(arguments.callee,10)}})()}else{X.parentNode.removeChild(X)}}}function b(Z){var Y=c(Z);if(Y){for(var X in Y){if(typeof Y[X]=="function"){Y[X]=null}}Y.parentNode.removeChild(Y)}}function c(Z){var X=null;try{X=j.getElementById(Z)}catch(Y){}return X}function C(X){return j.createElement(X)}function i(Z,X,Y){Z.attachEvent(X,Y);I[I.length]=[Z,X,Y]}function F(Z){var Y=M.pv,X=Z.split(".");X[0]=parseInt(X[0],10);X[1]=parseInt(X[1],10)||0;X[2]=parseInt(X[2],10)||0;return Y[0]>X[0]||Y[0]==X[0]&&Y[1]>X[1]||Y[0]==X[0]&&Y[1]==X[1]&&Y[2]>=X[2]?true:false}function v(ac,Y,ad,ab){if(M.ie&&M.mac){return}var aa=j.getElementsByTagName("head")[0];if(!aa){return}var X=ad&&typeof ad=="string"?ad:"screen";if(ab){n=null;G=null}if(!n||G!=X){var Z=C("style");Z.setAttribute("type","text/css");Z.setAttribute("media",X);n=aa.appendChild(Z);if(M.ie&&M.win&&typeof j.styleSheets!=D&&j.styleSheets.length>0){n=j.styleSheets[j.styleSheets.length-1]}G=X}if(M.ie&&M.win){if(n&&typeof n.addRule==r){n.addRule(ac,Y)}}else{if(n&&typeof j.createTextNode!=D){n.appendChild(j.createTextNode(ac+" {"+Y+"}"))}}}function w(Z,X){if(!m){return}var Y=X?"visible":"hidden";if(J&&c(Z)){c(Z).style.visibility=Y}else{v("#"+Z,"visibility:"+Y)}}function L(Y){var Z=/[\\\"<>\.;]/;var X=Z.exec(Y)!=null;return X&&typeof encodeURIComponent!=D?encodeURIComponent(Y):Y}var d=function(){if(M.ie&&M.win){window.attachEvent("onunload",function(){var ac=I.length;for(var ab=0;ab<ac;ab++){I[ab][0].detachEvent(I[ab][1],I[ab][2])}var Z=N.length;for(var aa=0;aa<Z;aa++){y(N[aa])}for(var Y in M){M[Y]=null}M=null;for(var X in swfobject){swfobject[X]=null}swfobject=null})}}();return{registerObject:function(ab,X,aa,Z){if(M.w3&&ab&&X){var Y={};Y.id=ab;Y.swfVersion=X;Y.expressInstall=aa;Y.callbackFn=Z;o[o.length]=Y;w(ab,false)}else{if(Z){Z({success:false,id:ab})}}},getObjectById:function(X){if(M.w3){return z(X)}},embedSWF:function(ab,ah,ae,ag,Y,aa,Z,ad,af,ac){var X={success:false,id:ah};if(M.w3&&!(M.wk&&M.wk<312)&&ab&&ah&&ae&&ag&&Y){w(ah,false);K(function(){ae+="";ag+="";var aj={};if(af&&typeof af===r){for(var al in af){aj[al]=af[al]}}aj.data=ab;aj.width=ae;aj.height=ag;var am={};if(ad&&typeof ad===r){for(var ak in ad){am[ak]=ad[ak]}}if(Z&&typeof Z===r){for(var ai in Z){if(typeof am.flashvars!=D){am.flashvars+="&"+ai+"="+Z[ai]}else{am.flashvars=ai+"="+Z[ai]}}}if(F(Y)){var an=u(aj,am,ah);if(aj.id==ah){w(ah,true)}X.success=true;X.ref=an}else{if(aa&&A()){aj.data=aa;P(aj,am,ah,ac);return}else{w(ah,true)}}if(ac){ac(X)}})}else{if(ac){ac(X)}}},switchOffAutoHideShow:function(){m=false},ua:M,getFlashPlayerVersion:function(){return{major:M.pv[0],minor:M.pv[1],release:M.pv[2]}},hasFlashPlayerVersion:F,createSWF:function(Z,Y,X){if(M.w3){return u(Z,Y,X)}else{return undefined}},showExpressInstall:function(Z,aa,X,Y){if(M.w3&&A()){P(Z,aa,X,Y)}},removeSWF:function(X){if(M.w3){y(X)}},createCSS:function(aa,Z,Y,X){if(M.w3){v(aa,Z,Y,X)}},addDomLoadEvent:K,addLoadEvent:s,getQueryParamValue:function(aa){var Z=j.location.search||j.location.hash;if(Z){if(/\?/.test(Z)){Z=Z.split("?")[1]}if(aa==null){return L(Z)}var Y=Z.split("&");for(var X=0;X<Y.length;X++){if(Y[X].substring(0,Y[X].indexOf("="))==aa){return L(Y[X].substring(Y[X].indexOf("=")+1))}}}return""},expressInstallCallback:function(){if(a){var X=c(R);if(X&&l){X.parentNode.replaceChild(l,X);if(Q){w(Q,true);if(M.ie&&M.win){l.style.display="block"}}if(E){E(B)}}a=false}}}}();AND.FixIFrame=function(){var fn=function(e){var t=e.getTarget("A");if(!t||window.location.pathname.indexOf("/embed/video")>=0)return;if(t.target==""){top.location.replace(t.href)}};Ext.getBody().on("click",fn,this);var forms=document.getElementsByTagName("form"),l=forms.length;while(l>0){--l;forms[l].setAttribute("target","_top")}setTimeout(function(){var params=window.location.search.substring(1).split("&");for(var i=0,len=params.length;i<len;i++){var param=params[i].split("=");if(param[0]=="dmproxy"){var iFrameId="";if(window.location.search.indexOf("betaonly")!=-1){iFrameId="dmbeta"}else if(window.location.search.indexOf("headeronly")!=-1){iFrameId="dmheader"}else if(window.location.search.indexOf("footeronly")!=-1){iFrameId="dmfooter"}if(iFrameId!=""){var iFrame=document.createElement("iframe");iFrame.style.border="0px";iFrame.style.width="0px";iFrame.style.height="0px";var windowHeight=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);iFrame.src=param[1]+"?command=updateIFrame&id="+iFrameId+"&attribute=height&value="+windowHeight;document.body.appendChild(iFrame)}}}},1e3)};AND.JSONscriptRequestManager=function(){var head=document.getElementsByTagName("head").item(0),scriptTag=null,cache={},queue=[],processing=false;var request=function(){this.scope=this};request.prototype={scriptUrl:"",callback:null,useCache:true,id:null,params:null,callbackParam:"callback"};var processQueue=function(){if(queue.length>0){processing=true;var strCallback="jsonCallback"+(new Date).getTime();window[strCallback]=callback;strCallback=queue[0].callbackParam+"="+strCallback;if(queue[0].scriptUrl.indexOf("?")==-1){strCallback="?"+strCallback}else if(queue[0].scriptUrl[queue[0].scriptUrl.length-1]!="?"){strCallback="&"+strCallback}scriptTag=document.createElement("script");scriptTag.setAttribute("type","text/javascript");scriptTag.setAttribute("src",queue[0].scriptUrl+strCallback);head.appendChild(scriptTag)}};var callback=function(data){if(data){if(queue[0].useCache)cache[queue[0].id]=data;queue[0].callback.call(queue[0].scope,data,queue[0].params)}else{queue[0].callback.call(queue[0].scope,cache[queue[0].id],queue[0].params)}queue[0]=null;queue.shift();head.removeChild(scriptTag);processing=false;processQueue()};return{getScript:function(config){if(!config.scriptUrl&&typeof config.scriptUrl!="string"&&!config.callback&&typeof config.callback!="object")return false;var req=AND.extendObject(new request,config);req.id=req.scriptUrl.replace(/[^a-z]/gi,"");if(req.useCache&&cache[req.id]){callback(null)}else{queue.push(req);if(!processing)processQueue()}}}}();DM.FormValidator=function(id,conf){Ext.apply(this,conf);this.init({id:id})};DM.FormValidator.prototype={form:null,rules:{mandatory:{"if":{value1:"value",method:"empty",value2:""},then:'error("Please provide a value for this field.")'},email:{"if":{value1:"value",method:"matches",value2:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i},"else":'error("Please provide a valid email address.")'}},types:{text:"blur focus",password:"blur",textarea:"blur focus keyup",radio:"click",checkbox:"click","select-one":"change",form:"submit reset mouseover mouseout"},init:function(form){this.form=Ext.get(form.id);if(!this.form)return;var that=this;this.rules=Ext.apply(this.rules,this.custom_rules||{});this.form.dom.rules=[];var els=Ext.query(".js-validate",this.form.dom);for(var i=0,l=els.length;i<l;i++){var el=els[i];var elE=Ext.get(el);el.rules=[];var keys=el.className.split("|");for(var j=0,m=keys.length-1;j<m;j++){if(this.rules[keys[j]]){var rule=Ext.apply({field:els[i],"if":"",then:"","else":"",onstart:false},this.rules[keys[j]]);el.rules.push(rule);this.form.dom.rules.push(rule);if(rule.onstart){this.runRule(rule)}}}if(elE.hasClass("js-defaultvalue")&&el.title&&el.title!=""){el.defaultvalue=true;if(el.value==""){el.value=el.title}}if(elE.hasClass("js-countdown")){var counter=Ext.get([this.form.id,el["name"],"countdown"].join("-"));if(counter&&parseInt(counter.dom.innerHTML)!=NaN){el.counter=parseInt(counter.dom.innerHTML)}}if(elE.hasClass("js-expand")&&el.rows){el.expand=true}if(elE.hasClass("js-submit")){el.submit=true}var evs=this.types[el.type].split(" ");for(var j=0,m=evs.length;j<m;j++){elE.on(evs[j],this.eHandler,that)}}var evs=this.types["form"].split(" ");for(var i=0,l=evs.length;i<l;i++){that.form.on(evs[i],this.eHandler,that)}},eHandler:function(e,t){var target=Ext.get(e.target);var that=this;switch(e.type){case"mouseover":if(target.hasClass("js-tooltip")){Ext.fly(target.dom.parentNode).addClass("tooltip-on")}break;case"mouseout":if(target.hasClass("js-tooltip")){Ext.fly(target.dom.parentNode).removeClass("tooltip-on")}break;case"reset":setTimeout(function(){that.runRules(target.dom,true)},10);break;case"submit":if(!that.runRules(target.dom)){e.stopEvent()}else{if(that.form.dom.submitextras){that.form.dom.submitextras(that.form)}}break;case"focus":if(target.dom.defaultvalue&&target.dom.value==target.dom.title){target.dom.value=""}if(target.dom.expand){target.dom.rows=target.dom.rows*2;target.dom.expand=false}case"keyup":if(target.dom.counter){var counter=Ext.get([this.form.id,target.dom["name"],"countdown"].join("-"));if(target.dom.counter<target.dom.value.length){target.dom.value=target.dom.value.substring(0,target.dom.counter)}counter.dom.innerHTML=target.dom.counter-target.dom.value.length}break;case"change":if(target.dom.submit){this.form.dom.submit()}else{if(!target.dom.suspendrules){this.runRules(target.dom)}}break;case"blur":if(target.dom.defaultvalue&&target.dom.value==""){target.dom.value=target.dom.title}default:if(!target.dom.suspendrules){this.runRules(target.dom)}}if(e.type!="focus"&&target.suspendrules){target.suspendrules=null}},runRules:function(el,onstart){var valid=true;var container=el.tagName==="FORM"?el:this.field(el);var errs=Ext.query(".errors",container);for(var i=0,l=errs.length;i<l;i++){errs[i].innerHTML="";errs[i].style.display="none"}var failed=Ext.query(".failed",container);for(var i=0,l=failed.length;i<l;i++){Ext.fly(failed[i]).removeClass("failed")}var rules=el.rules;for(var i=0,l=rules.length;i<l;i++){if(!onstart||onstart&&rules[i].onstart){valid=this.runRule(rules[i])&&valid}}return valid},runRule:function(rule){var el=rule.field;var err=Ext.query(".errors",this.field(el))[0];var result;var value1=this[rule["if"].value1](el);var value2=rule["if"].value2;if(typeof value2==="number"){Number(value1)}var method=rule["if"].method;switch(method){case"matches":result=new RegExp(value2).test(value1);break;case"empty":result=value1==""||el.defaultvalue&&value1==el.title;break;default:eval("result =  value1"+method+"value2");break}var error=function(param){if(!Ext.fly(el).hasClass("failed")){var msg=document.createElement("span");msg.innerHTML=param;err.appendChild(msg);err.style.display="";Ext.fly(el).addClass("failed")}return false};var show=function(param){Ext.fly(param).dom.style.display="";return true};var hide=function(param){Ext.fly(param).dom.style.display="none";return true};if(result&&rule["then"]!=""){return eval(rule["then"])}if(!result&&rule["else"]!=""){return eval(rule["else"])}return true},field:function(param){return Ext.get([this.form.id,param["name"],"field"].join("-")).dom},value:function(param){if(param.type=="checkbox"||param.type=="radio"){var values=[];var els=this.field(param).getElementsByTagName("input");for(var i=0,l=els.length;i<l;i++){if(els[i].checked){values.push(els[i].value)}}return values.join(",")}return param.value},length:function(param){return this.value(param).length}};DM.Headlines=Ext.extend(DM.Tabs,{tabOffClass:["ow-igr2-bx","link-ccogr2","js-unactive"],tabOnClass:["link-wocc","js-active"],constructor:function(id){DM.Headlines.superclass.constructor.call(this,id)},_onLoadCallBack:function(){var heighMain=Ext.fly(this._panes[0]).getHeight();var paneMore=Ext.get(this._panes[1]);var amount=Ext.isIE6||Ext.isIE7?0:10;if(paneMore.query("li").length>1){amount=0}paneMore.setHeight(heighMain-amount)}});DM.PictureSwap=Ext.extend(Ext.util.Observable,{constructor:function(id){this.el=Ext.get(id);if(!this.el)return;this.el.on("mouseover",this._mouseOverHandler,this);var image=Ext.get(id+"-img");this._img=image?image.dom:null;this.addEvents(["change"])},_swap:function(src){if(this._img){this._img.src=src;this.fireEvent("change")}},_mouseOverHandler:function(e){var trg=e.getTarget("a",3),imgSrc;if(!trg){return}imgSrc=AND.getParams(trg)[0];imgSrc&&this._swap(imgSrc)}});DM.Showcase=Ext.extend(Ext.util.Observable,{constructor:function(id){this.el=Ext.get(id);this._showables=this.el.select(".mainImages li");this.el.on("click",this._clickHandler,this);this._prodElX=Ext.fly(this.el.query(".products")[0]).getX();this._prodElY=Ext.fly(this.el.query(".products")[0]).getY();this.addEvents(["startAnim","endAnim"])},_resetShowable:function(el){el.setStyle("visibility","hidden");
el.select(".js-product-container").setStyle("opacity",0)},_showShowable:function(el,pos){var h,value=el.getStyle("height");if(value==="0px"||value==="auto"){h=el.dom.offsetHeight-6}else{h=value.substring(0,value.length-2)}el.setStyle({top:pos.top-this._prodElY-11+"px",left:pos.left+"px",width:"0px",height:"0px",visibility:"visible"});this.fireEvent("startAnim");var onEndAnim=this.fireEvent.createDelegate(this,["endAnim"]);el.animate({width:{to:251},height:{to:h}},.3,function(){el.select(".js-product-container").item(0).animate({opacity:{to:1}},.3,function(){onEndAnim()})})},_clickHandler:function(e){var parent=trg=Ext.get(e.getTarget());!trg.hasClass("buy-link")&&!trg.hasClass("promo")&&e.preventDefault();var liContainer=trg.parent("li");var childIndex=AND.getParams(liContainer.dom)[1];var leftPos;if(childIndex%2===0){leftPos=148}else{leftPos=10}if(trg.is("a")&&trg.hasClass("revealProductMain")||(parent=trg.parent("a.revealProductMain"))){this._showables.each(function(el){this._resetShowable(el)},this);this._showShowable(Ext.get(AND.getHrefParams(parent.dom)),{top:parent.getY()+10,left:leftPos})}else if(trg.is("img.close")){this._resetShowable(trg.parent("li"))}}});DM.MirrorMirror=Ext.extend(Ext.util.Observable,{_blockAction:false,constructor:function(id,params){this.el=Ext.get(id);this._galleryId=params.galleryId;this._showables=this.el.select(".js-mm-overlay");this.el.on("click",this._clickHandler,this,{preventDefault:true});this.addEvents(["startAnim","endAnim"]);this.on("endAnim",this._showShowable)},_getTwin:function(el){var id=el.dom.id;var match=id.match(/[0-9]{1,2}$/gi)[0];match%2?++match:--match;return Ext.get("MM_overlay_thumb_overlay_"+this._galleryId+"_"+match)},_resetShowable:function(el,fromUserClick){el.setStyle("visibility","hidden");el.select("div").setStyle("opacity",0);fromUserClick&&arguments.callee(this._getTwin(el))},_showShowable:function(el,fromUserClick){var h=el.getHeight()-26;el.setStyle({width:"0px",height:"0px",visibility:"visible"});this.fireEvent("startAnim");var onEndAnim=fromUserClick?this.fireEvent.createDelegate(this,["endAnim",this._getTwin(el)]):false;var removeBlock=function(){this._blockAction=false}.createDelegate(this);el.animate({width:{to:180},height:{to:h}},.3,function(){el.select("div").animate({opacity:{to:1,from:0}},.3,function(){onEndAnim&&onEndAnim()||removeBlock()})})},_clickHandler:function(e){var parent=trg=Ext.get(e.getTarget());if(trg.is("a")&&trg.hasClass("js-mm-image-link")||(parent=trg.parent("a.js-mm-image-link"))){if(!this._blockAction){this._blockAction=true;this._showables.each(function(el){this._resetShowable(el)},this);this._showShowable(parent.next(),true)}}else if(trg.is("img.closebutton")){this._resetShowable(trg.parent("div.js-mm-overlay"),true)}}});DM.Poll=Ext.extend(Ext.util.Observable,{_classes:{pollDiv:"js-poll",pollQuestion:"js-poll-question",pollResults:"js-poll-results",pollResultsData:"js-poll-content",voteButton:"js-vote-button",radio:"js-radio",selectedRadio:"selected",closeButton:"js-close",showYesterdays:"js-show-yesterdays",showAll:"js-show-all",pollWide:"poll-wide"},constructor:function(id,conf){this.el=Ext.get(id);if(!this.el)return;this.el.on("click",this._clickHandler,this);this._spanRadios=this.el.select("."+this._classes.radio);this._checkedRadio=null;this._pollId=conf.pollId;this._questionId=conf.questionId;this._channelId=conf.channelId;this._pollResults=this.el.select("."+this._classes.pollResults).item(0);this._pollQuestion=this.el.select("."+this._classes.pollQuestion).item(0);this._pollResultsData=this._pollResults.select("."+this._classes.pollResultsData).item(0);this._showAll=this.el.select("."+this._classes.showAll).item(0);this._showYesterdays=this.el.select("."+this._classes.showYesterdays).item(0);this.addEvents(["onVote"])},_toggleRelatedRadio:function(el,checked){var radio=el.next().dom;if(checked){radio.checked="checked";this._checkedRadio=radio}else{radio.checked=""}},_resultsTemplate:function(){return new Ext.Template('<li class="cleared">','<span class="results-text">{answer}</span>','<span class="results-bar" style="width: {barLength}px;"></span>','<span class="results-score">{percentage}%</span>',"</li>").compile()}(),_endTemplate:new Ext.Template("</ul><span>{message}</span></div>").compile(),_callBack:function(m,showYesterdayLink){var startTemplate;if(this.el.hasClass("poll-wide")){startTemplate=new Ext.Template('<div class="poll-results-graph box cleared">','<a class="js-close close" href="#">','<span class="close-btn">&nbsp;</span>Close',"</a><p>POLL RESULTS</p><ul>").compile()}else{startTemplate=new Ext.Template("<p>{question}</p><ul>").compile()}if(m){var html=startTemplate.applyTemplate({question:m.poll.pollQuestions[0]["question"]});for(var i=0;i<m.poll.pollQuestions[0].answers.length;i++){html+=this._resultsTemplate.applyTemplate({answer:m.poll.pollQuestions[0].answers[i]["answer"],barLength:m.poll.pollQuestions[0].answers[i]["barLength"],percentage:m.poll.pollQuestions[0].answers[i]["percentage"]})}var tmp={};if(m.pollAnswered||showYesterdayLink){m.pollAnswered?tmp.message="Oops! You have already voted on this topic":tmp.message=""}else{tmp.message="Thank you for voting"}html+=this._endTemplate.applyTemplate({message:tmp.message});this._pollResultsData.dom.innerHTML=html;this._pollQuestion.addClass("hidden");this._pollResults.removeClass("hidden");this._switchFootLink(showYesterdayLink)}this.fireEvent("onVote")},_vote:function(){if(this._checkedRadio){AjaxPoll.vote(this._pollId,this._checkedRadio.value,this._questionId,this._callBack.createDelegate(this,[false],true))}},_close:function(){this._pollQuestion.removeClass("hidden");this._pollResults.addClass("hidden");this._switchFootLink(true)},_switchFootLink:function(showAll){if(!this._showAll){return}if(showAll){this._showAll.removeClass("hidden");this._showYesterdays.addClass("hidden")}else{this._showAll.addClass("hidden");this._showYesterdays.removeClass("hidden")}},_toggleTicked:function(spanRadio){this._spanRadios.each(function(el){if(el!==spanRadio){el.removeClass(this._classes.selectedRadio);this._toggleRelatedRadio(el,false)}},this);spanRadio.addClass(this._classes.selectedRadio);this._toggleRelatedRadio(spanRadio,true)},_clickHandler:function(e,t){var trg=Ext.get(e.getTarget());!trg.hasClass(this._classes.showAll)&&e.preventDefault();if(trg.hasClass(this._classes.radio)){this._toggleTicked(trg)}else if(trg.hasClass(this._classes.voteButton)||trg.parent("button")){if(this._spanRadios.elements.length>0){this._vote()}else{window.location.href="/columnists/polls/poll.html?pollId="+this._pollId}}else if(trg.hasClass(this._classes.closeButton)||trg.parent("."+this._classes.closeButton)){this._close()}else if(trg.hasClass(this._classes.showYesterdays)){AjaxPoll.getYesterdaysPoll(this._channelId,this._pollId,this._callBack.createDelegate(this,[true],true))}}});var Polls=function(){function getVotesPercentage(votes,totalVotes){return totalVotes>0?Math.round(votes/totalVotes*100):0}function getBarLength(pollId,votes,maxVotes){var maxWidth=Math.round($(".poll-"+pollId+".poll-results").innerWidth()*.65);return maxVotes>0?Math.round(votes/maxVotes*maxWidth):0}function getTotalVotes($pollAnswers,alreadyVoted){var total=alreadyVoted?0:1;$pollAnswers.filter(function(index){total+=parseInt($(this).find("input[name*='votes']").val())});return total}function numberWithCommas(x){var parts=x.toString().split(".");parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return parts.join(".")}function getMaxVotes($pollAnswers,selectedAnswer,alreadyVoted){var max=0;$pollAnswers.filter(function(index){var votesForThisAnswer=parseInt($(this).find("input[name*='votes']").val());votesForThisAnswer=!alreadyVoted&&parseInt($(this).find("input[name*='answer']").val())==selectedAnswer?votesForThisAnswer+1:votesForThisAnswer;max=votesForThisAnswer>max?votesForThisAnswer:max});return max}function readCookie(name){var regex=new RegExp("(?:^|;)\\s?"+name+"=(.*?)(?:;|$)","i"),match=document.cookie.match(regex);return match&&unescape(match[1])}function getPollAnswerIdFromCookie(pollId){var cookieValue=readCookie("poll");if(cookieValue){var pollsCookies=cookieValue.split("_");for(var i=0;i<pollsCookies.length;i++){if(pollsCookies[i].indexOf(pollId)!=-1){return pollsCookies[i].split("-")[1]}}}}function createPollCookie(pollId,answerId){var cookieValue=readCookie("poll");if(!cookieValue){document.cookie="poll="+pollId+"-"+answerId+"; path=/"}else if(!getPollAnswerIdFromCookie(pollId)){document.cookie="poll="+cookieValue+"_"+pollId+"-"+answerId+"; path=/"}}function showPollResults(conf,answerId,alreadyVoted){var $pollAnswers=$("#poll-"+conf.params.pollId).find("div.poll-answer");var $results=$("."+conf.id).find(".poll-results .poll-answers li");var sharePlacement=conf.params.pollStyle=="sponsored-poll"?"sponsored-poll":"post_poll";updatePollResults(conf.params.pollId,answerId,$pollAnswers,$results,alreadyVoted);$("#poll-"+conf.params.pollId).css("display","none");$("."+conf.id).find("div.poll-results").css("display","block");DMS.PollShare.renderPollsGoogleInteractive("gSharePoll-"+conf.params.pollId,conf.params.gplusClientId,conf.params.pollId,"POLL: "+conf.params.question+DMS.PollShare.getShareDescription(conf.id,conf.params.pollId),sharePlacement)}function vote(event,$answer,conf){var pollPagePositionId=conf.id;var pollId=conf.params.pollId;var questionId=conf.params.questionId;var channelId=conf.params.channelId;$("#poll-"+pollId+" #"+$answer.prop("for")).attr("checked",true);var answerId=$("#poll-"+pollId).find("input:radio[name='answer']:checked").val();if(answerId){var pollObj={"question-id":questionId,"poll-id":pollId,"answer-id":answerId};$.ajax({type:"POST",url:"/polls/answer",data:JSON.stringify(pollObj),contentType:"application/json",success:function(data){createPollCookie(conf.params.pollId,answerId);showPollResults(conf,answerId,false);if(conf.params.isMobile){updatePollQuestionOnMobile(conf.params.pollId,answerId,false)}}})}}function updatePollResults(pollId,selectedAnswer,$pollAnswers,$results,alreadyVoted){var maxVotes=getMaxVotes($pollAnswers,selectedAnswer,alreadyVoted);var totalVotes=getTotalVotes($pollAnswers,alreadyVoted);var pollResults=[];$pollAnswers.filter(function(index){var result={};var n=parseInt($(this).find("input[name*='votes']").val());var answerId=parseInt($(this).find("input[name*='answer']").val());if(answerId==selectedAnswer&&!alreadyVoted){result.votes=n+1}else{result.votes=n}result.percentage=getVotesPercentage(result.votes,totalVotes)+"%";result.barLength=getBarLength(pollId,result.votes,maxVotes);pollResults.push(result)});$results.filter(function(index){$(this).find("span.results-score span:first-of-type").html(pollResults[index].percentage);$(this).find("span.vote-results-bar").css("width",pollResults[index].barLength+"px");if(pollResults[index].votes==1){$(this).find("span.results-votes").html(Math.floor(pollResults[index].votes)+" vote")}else{$(this).find("span.results-votes").html(numberWithCommas(Math.floor(pollResults[index].votes))+" votes")}})}function bindEvents(conf){if(conf.params.isMobile){bindEventsForMobileContent(conf)}$("#poll-"+conf.params.pollId+" .answer-label").on("click",function(event){vote(event,$(this),conf)});setTimeout(function(){checkCookieAndShowResults(conf)},100)}function bindEventsForMobileContent(conf){$(".poll .poll-mini-"+conf.params.pollId+" li.question").width($(".poll ul").width()-135+"px");$(".poll .poll-mini-"+conf.params.pollId).on("click",function(event){var oldVideoEl,wrapEl,videoEl,sourceEl,videoTitleEl,videoTitleParEl;$("#mobile-poll-"+conf.params.pollId).addClass("show");$("#poll-content").html($("#mobile-poll-"+conf.params.pollId).html());$("#poll-content").addClass("active");$("#mobile-poll-"+conf.params.pollId).empty();$("#poll-"+conf.params.pollId+" .answer-label").on("click",function(event){vote(event,$(this),conf)});DMS.PollShare.init(conf.id,conf.params.mobilePollShare);$("#poll-content .poll-single .close").on("click",function(event){$("#mobile-poll-"+conf.params.pollId).html($("#poll-content").html());$("#mobile-poll-"+conf.params.pollId).removeClass("show");$("#poll-content").empty();$("#poll-content").removeClass("active");$("#poll-"+conf.params.pollId+" .answer-label, #poll-content .poll-single .close").unbind("click");$("#poll-content .facebook, #poll-content .twitter").unbind("click")});if(document.getElementById("sponsored-poll-mobile")){oldVideoEl=$("#sponsored-poll-mobile video").clone();$("#sponsored-poll-mobile").remove();wrapEl=document.createElement("div");wrapEl.className="vjs-video-container vjs-responsive news";videoEl=document.createElement("video");videoEl.className="video-js vjs-default-skin";videoEl.setAttribute("id",oldVideoEl.attr("id"));videoEl.setAttribute("controls","");videoEl.setAttribute("width","640");videoEl.setAttribute("height","264");videoEl.setAttribute("preload","none");videoEl.setAttribute("data-opts",JSON.stringify(oldVideoEl.data("opts")));sourceEl=document.createElement("source");$(sourceEl).attr("type",oldVideoEl.children().attr("type"));$(sourceEl).attr("src",oldVideoEl.data("opts").src);videoTitleEl=document.createElement("div");videoTitleParEl=document.createElement("p");videoTitleEl.className="video-fake-title";videoTitleParEl.innerText=oldVideoEl.data("opts").title;setTimeout(function(){$(wrapEl).append(videoEl);$(videoEl).append(sourceEl);$(videoTitleEl).append(videoTitleParEl);$("#poll-content .poll-single .poll-sponsored-mobile").append(videoTitleEl);$("#poll-content .poll-single .poll-sponsored-mobile").append(wrapEl);DM.setupMolVideoJsPlayers(videoEl)},1)}})}function checkCookieAndShowResults(conf){var cookieAnswerId=getPollAnswerIdFromCookie(conf.params.pollId);if(cookieAnswerId){$("#poll-"+conf.params.pollId+" #answer-"+conf.params.pollId+"-"+cookieAnswerId).attr("checked",true);showPollResults(conf,cookieAnswerId,true);updatePollQuestionOnMobile(conf.params.pollId,cookieAnswerId,true)}}function updatePollQuestionOnMobile(pollId,answerId,alreadyVoted){if($(".poll").length>0&&$(".poll-mini-"+pollId+" ul li .poll-question .answer").length==0){var label=$('label[for="answer-'+pollId+"-"+answerId+'"]');var $pollAnswers=$("#poll-"+pollId).find("div.poll-answer");var totalVotes=getTotalVotes($pollAnswers,alreadyVoted);var votes=$("input#answer-"+pollId+"-"+answerId+"-votes").val();var votePct=getVotesPercentage(alreadyVoted?parseInt(votes):parseInt(votes)+1,totalVotes);$("ul.poll-mini-"+pollId+" li .poll-question").append('<br/><span class="answer">You said <b>'+label.text()+'</b>. <span class="ccox"><b>'+votePct+"%</b></span> of others agreed with you.</span>");$("ul.poll-mini-"+pollId).css("height",$("ul.poll-mini-"+pollId+" li.question").height()+"px")}}return{init:function init(conf){bindEvents(conf)}}}();DM=window.DM||{};DM.Polls=Polls;DM.ExpansionArticlePage=Ext.extend(Ext.util.Observable,{constructor:function(id){var el=Ext.get(id),first;if(!el){return}this._panels=el.select(".js-headers");first=this._panels.item(0);if(!first){return}el.on("click",this._clickHandler,this);this._current=null;this._expand(first)},_clickHandler:function(e,t){var link=Ext.get(e.getTarget("a.js-more-link",2));if(link){e.preventDefault();var header=link.parent(".js-headers");if(this._current!==link&&!(this._current===null&&Ext.fly(t).hasClass("js-firstLink"))){this._current=link;this._resetAll();this._expand(header)}else{header.hasClass("collapsed")?this._collapse(header):this._expand(header)}var header=link.parent("div.js-headers");header.hasClass("collapsed")?this._expand(header):this._collapse(header)}},_expand:function(el){el.addClass("collapsed")},_collapse:function(el){el.removeClass("collapsed")},_resetAll:function(){this._panels.each(function(el){this._collapse(el)},this)}});DM.ExpansionMyStoriesPage=Ext.extend(Ext.util.Observable,{constructor:function(id){this.el=Ext.get(id).on("click",this._clickHandler,this)},_clickHandler:function(e,t){var link=Ext.get(e.getTarget(".columnist-archive-heading",3))||Ext.get(e.getTarget("a.js-more-link",3));if(link){e.preventDefault();var header=link.hasClass("js-columnist-archive-group")?link:link.parent(".js-my-stories-group")||link.parent(".js-columnist-archive-group");!header.hasClass("collapsed")?this._collapse(header):this._expand(header)}},_collapse:function(el){el.addClass("collapsed")},_expand:function(el){el.removeClass("collapsed")}});(function($){var fired=false;$(document).one("bottom-page ready",function(){if(fired)return;fired=true;$("img.blkBorder").parent().not(".image-wrap").find("img.blkBorder").wrap('<div class="image-wrap">')})})(jQuery);DM.Carousel=Ext.extend(Ext.util.Observable,{_cssProp:"left",step:138,speed:.7,ulCls:".js-itemList",direction:"horizontal",imagesRequested:false,constructor:function(id,conf){this.el=Ext.get(id);if(!this.el)return;conf&&Ext.apply(this,conf);if(this.direction==="vertical"){this._cssProp="top"}this._slider=Ext.get(this.el.query(this.ulCls)[0]);var next=this.el.query(".js-move-next")[0];if(!next)return;Ext.fly(next).on("click",this._move,this,{preventDefault:true});Ext.fly(this.el.query(".js-move-prev")[0]).on("click",this._move,this,{preventDefault:true});this._slider.on("click",this._clickHandler,this);this._slider.on("mouseover",this._mouseOverHandler,this);this.addEvents(["changeBegin","changeEnd"])},_mouseOverHandler:function(e,t){},_clickHandler:function(e,t){},_animInstance:null,_isRunning:false,_onEndAnim:function(direction){this._slider.setStyle(this._cssProp,"0");this._isRunning=false;this._shift(direction)},_move:function(e){if(this._isRunning){this._animInstance.stop()}this._isRunning=true;if(e.getTarget(".js-move-prev")){this.anim("+")}else{this.anim("-")}},anim:function(direction){var par1={};par1[this._cssProp]={to:direction+this.step};this._animInstance=this._slider.anim(par1,{duration:this.speed,callback:this._onEndAnim.createDelegate(this,[direction]),scope:this});this.fireEvent("changeBegin",{direction:direction})},_shift:function(direction){if(direction==="+"){var last=this._slider.last();var thirdFromLastClone=last.prev().prev().dom.cloneNode(true);this._slider.insertFirst(thirdFromLastClone);last.remove();this.fireEvent("changeEnd",{cloned:thirdFromLastClone})}else{var first=this._slider.first();var thirdFromFirstClone=Ext.get(first.next().next().dom.cloneNode(true));thirdFromFirstClone.insertAfter(this._slider.last());first.remove();this.fireEvent("changeEnd",{cloned:thirdFromFirstClone.dom})}},_requestImages:function(){if(!!DM.LazyLoad&&!this.imagesRequested){this.panels.select("[data-src]").each(function(o){DM.LazyLoad(o.dom)});this.imagesRequested=true}}});DM.RolloverCarousel=Ext.extend(DM.Carousel,{step:176,_getPanel:function(el){return el.getElementsByTagName("SPAN")[0]},constructor:function(id){var that=this;DM.RolloverCarousel.superclass.constructor.call(this,id);var lis=this.el.query("li");var l=lis.length;var li;while(l>0){--l;li=lis[l];Ext.fly(li).addListener("mouseover",function(el){return function(e,t){Ext.fly(that._getPanel(el)).animate({top:{to:0}},.45)}}(li));Ext.fly(li).addListener("mouseout",function(el){return function(e,t){Ext.fly(that._getPanel(el)).animate({top:{to:110}},.45)}}(li))}this.on("changeEnd",function(o){var el=o.cloned;var span=el.getElementsByTagName("SPAN")[0];Ext.fly(el).addListener("mouseover",function(e,t){Ext.fly(span).animate({top:{to:0}},.45)});Ext.fly(el).addListener("mouseout",function(e,t){Ext.fly(span).animate({top:{to:110}},.45)})})}});DM.ImageSwapCarousel=Ext.extend(DM.Carousel,{speed:1.3,step:90,constructor:function(id){DM.ImageSwapCarousel.superclass.constructor.call(this,id);this._bigLink=this.el.query(".js-link")[0];this._bigImg=this.el.query(".js-placeholder")[0];this._caption=this.el.query(".js-caption")[0];this._buyLink=this.el.query(".js-buy-link")[0];this.on("changeBegin",function(o){var el;if(o.direction==="-"){el=this._slider.select("li").item(2).query("a")[0]}else{el=this._slider.first().query("a")[0]}this._changeBigPic(el)})},_mouseOverHandler:function(e,t){var root=e.getTarget("a",2);root&&this._changeBigPic(root)},_changeBigPic:function(el){if(!this._bigImg){return}var hrefBigImg=el.href;var srcBigImg=el.rel.split("|")[0];this._bigLink.href=hrefBigImg;this._bigImg.src=srcBigImg;var desc=el.getElementsByTagName("IMG")[0].alt;this._caption.innerHTML=desc;var buyLink=Ext.get(el).next(".js-buy-link");if(this._buyLink){this._buyLink.href=buyLink===null?"#":buyLink.dom.href}Ext.get(this._bigLink).on("click",this._clickHandler,this)}});DM.PopUpCarousel=Ext.extend(DM.Carousel,{step:149,_popUpDisplayed:false,constructor:function(id){DM.PopUpCarousel.superclass.constructor.call(this,id);this._popUpWin=this.el.select(".popup-window").item(0);this._popUp=this.el.select(".popup-container").item(0);this._popUpWin.on("click",this._clickHandlerPopUp,this);this.on("changeBegin",function(o){if(this._popUpDisplayed){var dir=o.direction;if(dir==="+"){this._popUpDisplayed=Ext.fly(this._popUpDisplayed).prev().dom}else{this._popUpDisplayed=Ext.fly(this._popUpDisplayed).next().dom}this._popUp.setStyle("opacity",0);this._popUp.setStyle("height","auto");this._populatePopUp(this._popUpDisplayed.id);this._fadeIn()}})},_resetPopUp:function(){this._popUp.setStyle("opacity",0);this._popUp.setStyle("width",0);this._popUp.setStyle("height","auto")},_clickHandler:function(e,t){e.preventDefault();var trg=e.getTarget("li");if(!trg){return}this._popUpDisplayed=trg;this._populatePopUp(trg.id);this._resetPopUp();var h=this._popUp.getHeight();this._popUp.setStyle("height",0);this._popUpWin.setStyle("visibility","visible");this._popUp.anim({width:{to:202},height:{to:h}},{duration:.4,callback:this._fadeIn,scope:this})},_populatePopUp:function(id){this._popUp.dom.innerHTML=Ext.fly(id+"_container").dom.innerHTML;var img=this._popUp.dom.getElementsByTagName("img")[0];img.src=img.className.split("|")[0]},_fadeIn:function(){this._popUp.animate({opacity:{from:0,to:1}},.3)},_clickHandlerPopUp:function(e,t){var trg=e.getTarget(".x-closebutton");if(trg){this._popUpWin.setStyle("visibility","hidden");this._popUpDisplayed=false}}});DM.LightBoxCarousel=Ext.extend(DM.ImageSwapCarousel,{speed:.8,step:104,constructor:function(id){DM.LightBoxCarousel.superclass.constructor.call(this,id);this._numCols=this.el.query("li.js-column").length;this._inPolePosition=2;this._nextButt=Ext.get(this.el.query(".js-move-next")[0]);this._prevButt=Ext.get(this.el.query(".js-move-prev")[0]);this._nextButt.setStyle("visibility","hidden");this._prevButt.setStyle("visibility","hidden");if(this._numCols===3){this._inPolePosition=1;this._slider.setStyle("left","104px")}this._handleController();this._universe=this.el.parent(".lightbox-gallery");this._overlay=null},_handleController:function(){if(this._numCols===3){this._prevButt.setStyle("visibility","hidden");this._nextButt.setStyle("visibility","hidden");return}if(this._inPolePosition===1){this._prevButt.setStyle("visibility","hidden");this._nextButt.setStyle("visibility","visible")}else if(this._inPolePosition===this._numCols-2){this._nextButt.setStyle("visibility","hidden");this._prevButt.setStyle("visibility","visible")}else{this._prevButt.setStyle("visibility","visible");this._nextButt.setStyle("visibility","visible")}},_increment:function(x){return(x-2)*-this.step},_onEndAnim:function(direction){},_getColFirstItem:function(){},anim:function(direction){if((this._inPolePosition>1||direction==="-")&&(this._inPolePosition<this._numCols-2||direction==="+")){if(direction==="+"){this._inPolePosition--}else{this._inPolePosition++}this._handleController();var par1={};par1[this._cssProp]={to:this._increment(this._inPolePosition)};this._animInstance=this._slider.anim(par1,{duration:this.speed,callback:this._onEndAnim.createDelegate(this,[direction]),scope:this})}this.fireEvent("changeBegin",{direction:direction})}});DM.LightBoxCarouselMain=Ext.extend(DM.LightBoxCarousel,{constructor:function(id){DM.LightBoxCarouselMain.superclass.constructor.call(this,id);this._changeBigPic(this.el.query("li.js-column a")[0]);this.on("changeBegin",function(o){var col=this._slider.query("li.js-column")[this._inPolePosition-1];var innerCol=Ext.fly(col).query("li")[0];var link=Ext.fly(innerCol).query("a")[0];this._changeBigPic(link)});this.addEvents(["itemClick"])},_clickHandler:function(e,t){e.stopEvent();var root=e.getTarget("a",2);var buyLink=Ext.get(root).next(".js-buy-link");!this._docHeight&&(this._docHeight=Ext.fly(document.getElementsByTagName("BODY")[0]).getHeight()+"px");if(this._overlay===null){this._overlay=Ext.get("overlay")}this._overlay.setStyle({display:"block",height:this._docHeight});this.fireEvent("itemClick",{href:root.href,alt:t.alt,pos:this._inPolePosition,buyHref:buyLink===null?"#":buyLink.dom.href})}});DM.LightBoxCarouselSub=Ext.extend(DM.LightBoxCarousel,{constructor:function(id){this._target=Ext.get("lightbox-target");var movable=Ext.fly(id).parent("div.js-movable");movable.appendTo(this._target);DM.LightBoxCarouselSub.superclass.constructor.call(this,id);this._gallery=this._universe.select(".wrap_"+id).item(0);this._bigPicHolder=this._gallery.select(".main-image-holder").item(0);this._bigPic=this._gallery.select(".main-overlayimage").item(0);this._picDescContainer=this._gallery.select(".messages").item(0);this._picDesc=this._gallery.select(".mainText").item(0);this._closeButt=this._gallery.select(".x-closebutton").item(0);this._closeButt.on("click",this._closeHandler,this);this._buyLink=this._gallery.query(".buy-link")[0]},showUp:function(href,alt,pos,buyHref){var left=function(){var wTop=Ext.get("top").getWidth();var wWin=Ext.getBody().getWidth();var left=(wWin-wTop)/2+wTop;return left}();this._target.setStyle({display:"block",top:AND.getScrollXY()[1]+68+"px",left:left+"px"});var moreL=this._gallery.query(".more-link")[0];moreL.style.display="none";this._gallery.setStyle("display","block");this._animBigPic(href,alt,buyHref);this._inPolePosition=pos;this._slider.setStyle("left",this._increment(pos)+"px");this._handleController()},_clickHandler:function(e,t){e.stopEvent();var link=Ext.get(e.getTarget("a",2));var buyLink=Ext.get(link).next(".js-buy-link");link&&this._animBigPic(link.dom.href,t.alt,buyLink===null?"#":buyLink.dom.href)},_mouseOverHandler:function(e,t){},_closeHandler:function(e,t){e.stopEvent();if(this._overlay===null){this._overlay=Ext.get("overlay")}this._overlay.setStyle({display:"none",height:"0px"});this._gallery.setStyle({display:"none"});this._resetStage()},_getDimensions:function(str){var res=new RegExp("([0-9]+)x([0-9]+).(jpg|png)","gi").exec(str);return[res[1],res[2]]},_resetStage:function(){this._bigPic.setStyle({width:"0px",height:"0px"});this._bigPicHolder.dom.style.opacity="0";this._picDescContainer.setStyle("width","0px");this._picDesc.dom.innerHTML=""},_animBigPic:function(src,desc,buyHref){this._dilate&&this._dilate.stop();var size=this._getDimensions(src);this._fadeIn&&this._fadeIn.stop();this._resetStage();this._bigPic.dom.src=src;if(buyHref===""||buyHref.indexOf("#")!==-1){this._buyLink.href="";this._buyLink.style.display="none"}else{this._buyLink.href=buyHref;this._buyLink.style.display="block"}this._dilate=this._bigPic.anim({width:{to:size[0]},height:{to:size[1]}},{duration:.6,callback:function(){this._picDescContainer.setStyle("width",size[0]+"px");this._picDesc.dom.innerHTML=desc;this._fadeIn=this._bigPicHolder.anim({opacity:{to:1}},{duration:.4})},scope:this})}});DM.LightBoxCarouselWrapper=Ext.extend(Ext.util.Observable,{constructor:function(id,config){this.mainC=new DM.LightBoxCarouselMain(id);this.subC=new DM.LightBoxCarouselSub(config.idSubCarousel);this.mainC.on("itemClick",function(o){this.subC.showUp(o.href,o.alt,o.pos,o.buyHref)}.createDelegate(this));this.subC.on("changeBegin",function(o){this.mainC.anim(o.direction)}.createDelegate(this))}});DM.FootballFeeds=Ext.extend(DM.Tabs,{tabsQuery:".ff-tab",panesQuery:".ff-tab-content",tabOffClass:["wocc","link-wox","js-unactive"],tabOnClass:["link-ccox","selected","js-active"],paneOffClass:"hiddenPane",constructor:function(id){DM.FootballFeeds.superclass.constructor.call(this,id);this._nameMap=[];this._selectedTabId="t-football_1";this._currentPageIndex=0;this._currentCompId="4";this._currentTeamId=null;this._currentMonthId=null;this._hoverTrCl="ff-row-hover";PL=null;SPL=null;this._comboComp=Ext.get("competitionId");this._comboComp.on("change",this._comboCompChangeHandler,this);this._comboTeam=Ext.get("teamId");this._comboTeam.on("change",this._comboTeamChangeHandler,this);this._comboMonth=Ext.get("month");this._comboMonth.on("change",this._comboMonthChangeHandler,this);this._btnGo=Ext.get("ff-submit");this._btnGo.on("click",this._btnGoClickHandler,this);this._pagination=Ext.get("ff-pagination");this._pagination.on("click",this._paginatorClickHandler,this);this._setCompSelectedIndex(0);this._setTeamSelectedIndex(0);this._setMonthSelectedIndex(0);Ext.fly("tabsContainer").on("mouseover",this._tableMOverHandler,this);Ext.fly("tabsContainer").on("mouseout",this._tableMOutHandler,this);this._table_1=Ext.get("football_1_table");this._table_1.on("click",this._teamsTabClickHandler,this);this._table_2=Ext.get("football_2_table");this._table_3=Ext.get("football_3_table");this._loaderEl=Ext.get("ff-loader");this._errorMsgEl=Ext.get("ff-error-msg");this._instructionEl=Ext.get("ff-instruction");this.on("change",this._onChangeTabCallBack,this)},_tamplates:{table:"<table style='width: 290px'>"+"<thead>"+"<tr>"+"<th colspan='2' style='width: 100px'>Teams</th>"+"<th class='align-r numeric'>P</th>"+"<th class='align-r numeric'>GD</th>"+"<th class='align-r numeric'>PTS</th>"+"</tr>"+"</thead>"+"<tbody>",fixtures:"<table style='width: 290px'>"+"<thead>"+"<tr>"+"<th class='align-c' style='width: 115px'>HOME</th>"+"<th class='align-c numeric'>&nbsp;</th>"+"<th class='align-c' style='width: 115px'>AWAY</th>"+"<th class='align-c numeric'>TIME</th>"+"</tr>"+"</thead>"+"<tbody id='football_2_table_body'>",results:"<table style='width: 290px'>"+"<thead>"+"<tr>"+"<th class='align-c' style='width: 110px'>HOME</th>"+"<th class='align-c numeric'>&nbsp;</th>"+"<th class='align-c' style='width: 110px'>AWAY</th>"+"</tr>"+"</thead>"+"<tbody id='football_3_table_body'>"},_showError:function(bool){if(bool){this._errorMsgEl.dom.innerHTML="No Fixtures Found";this._errorMsgEl.setStyle("display","block")}else{this._errorMsgEl.dom.innerHTML="";this._errorMsgEl.setStyle("display","none")}},_generatePaginator:function(o){var pageSize=20;var maxPages=4;var map=function(a,fn){a||(a=[]);fn||(fn=function(x){return x});var len=a.length,res=new Array(len);for(var i=0;i<len;i++)res[i]=fn(a[i],i);return res};var vo={page:Math.round(o.index/pageSize),pages:Math.ceil(o.total/pageSize)};vo.index=o.index;vo.total=o.total;var res=[vo.pages,' pages: page <strong class="ff-pg-current">',vo.page,"</strong> "];var len=vo.page+maxPages<vo.pages?maxPages:vo.pages-vo.page;len>-1||(len=0);res.push(map(new Array(len),function(j,i){var n=vo.page+i+1;return n>vo.pages?"":[i==0?"| ":"",'<span class="ff-pg-page" data-index="',(n-1)*pageSize,'">',n,"</span>"].join("")}).join(" | "));res.unshift("[");res.push("]");if(vo.page>1)res=['<span class="ff-pg-left"><span class="ff-pg-first" data-index="0">&laquo;</span> '].concat(['<span class="ff-pg-prev" data-index="',(vo.page-2)*pageSize,'">&lt;</span></span> ']).concat(res);if(vo.page<vo.pages)res=res.concat([' <span class="ff-pg-right"><span class="ff-pg-next" data-index="',vo.page*pageSize,'">&gt;</span>']).concat(['<span class="ff-pg-last" data-index="',(vo.pages-1)*pageSize,'">&raquo;</span></span>']);return res.join("")},_formatDate:function(){dateMap={day:{0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},month:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}};return function(d,m,y){var d=new Date(Date.parse([d," ",dateMap.month[m],", ",y," 12:00:00 GMT"].join("")));return dateMap.day[d.getUTCDay()]+", "+d.getUTCDate()+" "+dateMap.month[d.getUTCMonth()+1]+" "+d.getUTCFullYear()}}(),_comboCompChangeHandler:function(e){
this._currentPageIndex=0;this._selectedTabId==="t-football_1"&&this._getTables();this._getTeamList()},_comboTeamChangeHandler:function(e){this._currentTeamId=this._getTeamSelected().value},_paginatorClickHandler:function(e){var trg=e.getTarget("span");if(!trg){return}var index=trg.getAttribute("data-index");if(index){this._currentPageIndex=parseInt(index);if(this._selectedTabId==="t-football_2"){this._getFixtures()}else if(this._selectedTabId==="t-football_3"){this._getResults()}}},_teamsTabClickHandler:function(e){e.preventDefault();var trg=e.getTarget("tr");if(trg){var a=Ext.fly(trg).query("a")[0];if(a.className==="generated"){var teamId=parseInt(a.id.substring(3));var urlName=null;if(PL&&PL[teamId]){urlName=PL[teamId]}else if(SPL&&SPL[teamId]){urlName=SPL[teamId]}urlName&&(window.location.href="/sport/teampages/"+urlName+".html")}else{window.location.href=a.href}}},_tableMOverHandler:function(e){var trg=e.getTarget("tr");if(trg){Ext.fly(trg).addClass(this._hoverTrCl)}},_tableMOutHandler:function(e){var trg=e.getTarget("tr");if(trg){Ext.fly(trg).removeClass(this._hoverTrCl)}},_btnGoClickHandler:function(e){e.preventDefault();if(this._selectedTabId==="t-football_2"){this._getFixtures()}else if(this._selectedTabId==="t-football_3"){this._getResults()}},_comboMonthChangeHandler:function(e){this._currentMonthId=this._getMonthSelected().value},_onChangeTabCallBack:function(currentTab){this._selectedTabId=currentTab.dom.id;this._currentPageIndex=0;this._loaderEl.setStyle("display","block");if(currentTab.dom.id!=="t-football_1"){this._comboTeam.setStyle("display","block");this._comboMonth.setStyle("display","block");this._btnGo.setStyle("display","block");if(currentTab.dom.id==="t-football_2"){this._getFixtures()}else if(currentTab.dom.id==="t-football_3"){this._getResults()}}else{this._comboTeam.setStyle("display","none");this._comboMonth.setStyle("display","none");this._btnGo.setStyle("display","none");this._getTables();this._showError(false)}},_setCompSelectedIndex:function(index){this._comboComp.dom.selectedIndex=index},_getCompSelected:function(){var dom=this._comboComp.dom;var o=dom.options[dom.selectedIndex];return o},_setTeamSelectedIndex:function(index){this._comboTeam.dom.selectedIndex=index},_getTeamSelected:function(){var dom=this._comboTeam.dom;var o=dom.options[dom.selectedIndex];return o},_setMonthSelectedIndex:function(index){this._comboMonth.dom.selectedIndex=index},_getMonthSelected:function(){var dom=this._comboMonth.dom;var o=dom.options[dom.selectedIndex];return o},_getTables:function(){if(this._selectedTabId!=="t-football_1"){return}this._loaderEl.setStyle("display","block");this._table_1.setStyle("display","none");var o=this._getCompSelected();AjaxFeedsFacade.getTable({competitionId:o.value,compType:o.getAttribute("rel"),feedType:"table"},this._setTables.createDelegate(this))},_setTables:function(r){this._pagination.setStyle("display","none");var HTML=this._createTable(r);this._loaderEl.setStyle("display","none");this._table_1.dom.innerHTML=HTML;this._table_1.setStyle("display","block");if(this._selectedTabId==="t-football_1"&&(this._currentCompId==="4"||this._currentCompId==="17")){this._table_1.dom.className="";this._instructionEl.setStyle("display","block")}else{this._table_1.dom.className="noClick";this._instructionEl.setStyle("display","none")}},_createTable:function(data){var teamList=data.teamList;var namesMap=data.teamNamesMap;var HTML=this._tamplates.table;for(var i=0,len=teamList.length;i<len;i++){var item=teamList[i];if(i%2===0){HTML+="<tr class='clickable-row bow'>"}else{HTML+="<tr class='clickable-row'>"}HTML+="<td class='ccox numeric bdr-l'>"+(i+1)+"</td>";HTML+="<td class='ff-team link-box linkro-wox'>";HTML+="<a id='ft-"+item.id+"' class='generated' href='#'>"+item.name+"</a>";HTML+="</td>";HTML+="<td class='align-r numeric'>"+item.totalPlayed+"</td>";HTML+="<td class='align-r numeric'>"+item.totalDifference+"</td>";HTML+="<td class='align-r numeric bdr-r'>"+item.totalPoints+"</td>";HTML+="</tr>"}HTML+="</tbody>";HTML+="</table>";return HTML},_getFixtures:function(){this._instructionEl.setStyle("display","none");this._table_2.setStyle("display","none");this._loaderEl.setStyle("display","block");this._pagination.setStyle("display","none");AjaxFeedsFacade.getFixtures({competitionId:this._currentCompId,feedType:"fixtures",month:this._currentMonthId,teamId:this._currentTeamId,startIndex:this._currentPageIndex},this._setFixtures.createDelegate(this))},_setFixtures:function(r){var list=r.fixtureList;var HTML=this._tamplates.fixtures;var date="";var len=list.length;if(len>0){for(var i=0;i<len;i++){var item=list[i];if(date===""||date!==item.gameDate.date){date=item.gameDate.date;HTML+="<tr>";HTML+="<td class='align-c bdr-l bdr-r' colspan='4'>"+this._formatDate(item.gameDate.day,item.gameDate.month,item.gameDate.year)+"</td>";HTML+="</tr>"}HTML+="<tr class='bow'>";HTML+="<td class='align-r bdr-l'>"+item.firstTeam.name+"</td>";HTML+="<td class='align-c numeric'>v</td>";HTML+="<td class='align-l'>"+item.secondTeam.name+"</td>";HTML+="<td class='align-r bdr-r'>"+item.gameDate.time+"</td>";HTML+="</tr>"}HTML+="</tbody></table>";this._showError(false);this._loaderEl.setStyle("display","none");this._table_2.dom.innerHTML=HTML;this._table_2.setStyle("display","block");if(r.totalSize>20){var pagHTML=this._generatePaginator({index:this._currentPageIndex+list.length,total:r.totalSize});this._pagination.dom.innerHTML=pagHTML;this._pagination.setStyle("display","block")}this._table_2.setStyle("display","block")}else{this._showError(true);this._loaderEl.setStyle("display","none");this._table_2.setStyle("display","none")}},_getResults:function(){this._instructionEl.setStyle("display","none");this._table_3.setStyle("display","none");this._loaderEl.setStyle("display","block");this._pagination.setStyle("display","none");AjaxFeedsFacade.getResults(this._getVO(this._currentPageIndex,"results"),this._setResults.createDelegate(this))},_setResults:function(r){var list=r.fixtureList;var HTML=this._tamplates.results;var date="";var len=list.length;if(len>0){for(var i=0;i<len;i++){var item=list[i];if(date===""||date!==item.gameDate.date){date=item.gameDate.date;HTML+="<tr>";HTML+="<td class='align-c bdr-l bdr-r' colspan='3'>"+this._formatDate(item.gameDate.day,item.gameDate.month,item.gameDate.year)+"</td>";HTML+="</tr>"}HTML+="<tr class='bow'>";HTML+="<td class='align-r bdr-l'>"+item.firstTeam.name+"</td>";HTML+="<td class='align-c numeric'>"+item.firstTeam.score+"-"+item.secondTeam.score+"</td>";HTML+="<td class='align-l bdr-r'>"+item.secondTeam.name+"</td>";HTML+="</tr>"}HTML+="</tbody></table>";this._showError(false);this._loaderEl.setStyle("display","none");this._table_3.dom.innerHTML=HTML;this._table_3.setStyle("display","block");if(r.totalSize>20){var pagHTML=this._generatePaginator({index:this._currentPageIndex+list.length,total:r.totalSize});this._pagination.dom.innerHTML=pagHTML;this._pagination.setStyle("display","block")}this._table_3.setStyle("display","block")}else{this._showError(true);this._loaderEl.setStyle("display","none");this._table_3.setStyle("display","none")}},_getTeamList:function(){var o=this._getTeamSelected();this._currentTeamId=o.value;AjaxFeedsFacade.getTeamsList(this._getVO(this._currentPageIndex,"table"),this._setTeamList.createDelegate(this))},_setTeamList:function(r){this._nameMap=r;var HTML="";HTML+="<select id='teamId' class='formSelect' name='teamId' style='display: none'>";HTML+="<option value=''>All</option>";for(var i=0,len=r.length;i<len;i++){var item=r[i];HTML+="<option value='"+item.id+"'>"+item.name+"</option>"}HTML+="</select>";var selContainer=this.el.query(".js-teams")[0];selContainer.innerHTML=HTML;this._comboTeam=Ext.get("teamId");this._comboTeam.on("change",this._comboTeamChangeHandler,this);this._selectedTabId!=="t-football_1"&&this._comboTeam.setStyle("display","block");this._currentTeamId=null;if(this._currentCompId==="4"&&!PL){PL=this._createNamesMap(r)}else if(this._currentCompId==="17"&&!SPL){SPL=this._createNamesMap(r)}},_createNamesMap:function(arr){var map={};for(var i=0,len=arr.length;i<len;i++){var item=arr[i];map[item.id]=item.seoFriendlyName}return map},_getVO:function(pageIndex,type){var o=this._getCompSelected();var competition=o.getAttribute("rel");if(this._currentCompId!=o.value){this._currentCompId=o.value}return competition<0?false:{competitionId:o.value,compType:competition,feedType:type,month:this._getMonthSelected().value,startIndex:pageIndex||0,teamId:this._getTeamSelected().value}}});DM=window.DM||{};DM.FloatingButtons=function(id,config){var minWindowWidth=975;var homeChannels=["home","ushome","auhome","ukhome","indiahome"];var $floatingButtons=$(".floating-buttons");var $backToTop=$floatingButtons.children(".back-to-top");var $shareCurrentPageButton=$floatingButtons.children(".button-share-facebook");var adIDs=["billBoard-oop","sky-article-wide","textAd","h-sky-a","h-sky-b"];var hasOopAd=false;var baselineCountCookie="baseline-article-count";var latestCountCookie="latest-article-count";var articleCountTimer;function getHomeByGeo(geo){return{GB:"home",US:"ushome",AU:"auhome"}[geo]||"home"}function checkNextStoryPosition(){if($("#next-story").length>0&&$("#next-story").hasClass("show")){return $(window).height()>$("#next-story").outerHeight()+$(".floating-buttons").height()}return true}function showFloatingButtons(){return PageCriteria.pageType=="channel"||PageCriteria.pageType=="article"&&checkNextStoryPosition()}function hideBackToHomeButton(){if(getHomeByGeo(PageCriteria.geo)===PageCriteria.channel&&homeChannels.indexOf(PageCriteria.subchannel)>=0){$(document.body).addClass("no-article-count").addClass("floating-buttons-back-to-top-only")}}function handleFloatingButtonsVisibility(){clearTimeout($.data(this,"scrollTimer"));$.data(this,"scrollTimer",setTimeout(function(){hasOopAd&&$(document.body).addClass("floating-buttons-oop-ads");if(showFloatingButtons()&&getPageYPos()>$(window).height()/2&&$(window).width()>minWindowWidth){$(document.body).addClass("floating-buttons-show")}else{$(document.body).removeClass("floating-buttons-show")}},250))}function positionTopRight(){$floatingButtons.addClass("floating-no-ads").removeAttr("style")}function positionFloatingBoxAtBottomOfContent(){var newWidth=$("#content").width()-$floatingButtons.width();$floatingButtons.removeClass("floating-no-ads").css("transform","translate("+newWidth+"px, 0)")}function getPageYPos(){return typeof $(window).scrollTop()=="number"?$(window).scrollTop():document.documentElement.scrollTop}function isOopAd(id){var regexp=new RegExp("(^|,)"+id+"(,|$)");return regexp.test(adIDs.join(","))}function uptoNinetyNine(count){return count>=99?"+99":count.toString()}function hideArticleCount(newArticleCountElement,homeButton,homeButtonNewArticle){newArticleCountElement.hide();homeButton.removeClass("hidden");homeButtonNewArticle.addClass("hidden")}function showArticleCount(newArticleCountElement,articleCountText,homeButton,homeButtonNewArticle){newArticleCountElement.show().text(articleCountText);homeButton.addClass("hidden");homeButtonNewArticle.removeClass("hidden")}function setBaselineCountCookie(conf){if(conf&&conf.newArticleCount){miniDom.cookieHelper.setItem(baselineCountCookie,config.newArticleCount)}}function setLatestCountCookie(conf){if(conf&&conf.newArticleCount){miniDom.cookieHelper.setItem(latestCountCookie,config.newArticleCount)}}function updateNewArticleCount(){var homeButton=$(".back-to-home"),homeButtonNewArticle=$(".new-articles"),newArticleCountElement=$(".new-article-count"),newArticleCount=0;if(config&&config.showArticleCount==="true"){newArticleCount=miniDom.cookieHelper.getItem(latestCountCookie);if(newArticleCount-miniDom.cookieHelper.getItem(baselineCountCookie)>0&&!$(document.body).hasClass("floating-buttons-back-to-top-only")){var articleCountText=uptoNinetyNine(newArticleCount-miniDom.cookieHelper.getItem(baselineCountCookie));showArticleCount(newArticleCountElement,articleCountText,homeButton,homeButtonNewArticle)}else{hideArticleCount(newArticleCountElement,homeButton,homeButtonNewArticle)}}else{hideArticleCount(newArticleCountElement,homeButton,homeButtonNewArticle)}}function isThereAnAdOnThePage(hasOopAd){if(hasOopAd||!!adverts.getRendered().length){positionFloatingBoxAtBottomOfContent()}else{positionTopRight()}}function initializeButtonsAndBindEvents(){hideBackToHomeButton();if(getHomeByGeo(PageCriteria.geo)===PageCriteria.channel&&!(PageCriteria.pageType=="article")){setBaselineCountCookie(config);setLatestCountCookie(0)}else{setLatestCountCookie(config)}if(config&&config.featureEnabled==="true"){articleCountTimer=setInterval(updateNewArticleCount,config&&config.newArticleRefresh||1e3)}if($floatingButtons.length>0&&PageCriteria.device=="other"&&showFloatingButtons()){$(window).on("resize",handleFloatingButtonsVisibility);$(window).on("scroll",handleFloatingButtonsVisibility);$backToTop.on("click",function(event){$("body,html").animate({scrollTop:0},400);return false});adsRenderer&&adsRenderer.addLoadListener(function(ad){var id=!ad.isEmpty&&ad.slot&&ad.slot.molAd&&ad.slot.molAd.parentId;hasOopAd=hasOopAd||id&&isOopAd(id)});adsTrackers&&adsTrackers.getRequestedAds().forEach(function(ad){var id=ad.lid&&ad.cid&&ad.id;hasOopAd=hasOopAd||id&&isOopAd(id)});$shareCurrentPageButton.on("click",function(){DMS.Facebook.postToFB("floating_navigation")});handleFloatingButtonsVisibility();adverts.on("rendered",function(){isThereAnAdOnThePage()});isThereAnAdOnThePage()}}if($(".gamma").length>0){minWindowWidth=1270}initializeButtonsAndBindEvents()};DM.Horoscopes={init:function(){swfobject.embedSWF("/flash/horoscopes.swf","horoscope-flash","636","500","9.0.0",null,{xmlLocation:"/coffeebreak/horoscopes/horoscope.xml"},{allowscriptaccess:"always"},null,function(e){if(e.success){Ext.get("horoscope-text").replaceClass("js-hide","usability")}else{Ext.get("horoscope-text").removeClass("js-hide")}})}};DM.Lightbox=function(){var UI;var constructor=function(){DM.LightboxObj=Ext.extend(Ext.util.Observable,{overlayDuration:.2,overlayOpacity:.85,resizeDuration:.7,constructor:function(){DM.LightboxObj.superclass.constructor.call(this);if(!this.initialized){this.addEvents(["b4open","open","afterOpen","close"]);this.initMarkup();this.initialized=true}},initMarkup:function(){this.shim=Ext.get("lightbox-shim");this.overlay=Ext.get("overlay");this.container=Ext.get("lightbox-container");this.containerElement=Ext.get("lightbox");this.defaultContainer=Ext.get("lightbox-default-container");this.fader=Ext.get("lightbox-fader");this.els=[this.shim,this.overlay,this.defaultContainer,this.container,this.containerElement,this.fader];var l=this.els.length;while(l>0){--l;this.els[l].setVisibilityMode(Ext.Element.DISPLAY)}},open:function(e){this.setViewSize();this.showBg();this.fireEvent("b4open");return this},showBg:function(){this.overlay.fadeIn({duration:this.overlayDuration,endOpacity:this.overlayOpacity,scope:this})},show:function(pos){var dims=this.position(pos);this.resetEls();this.defaultContainer.shift({height:dims.height,width:dims.width,duration:this.resizeDuration,delay:50});this.fader.shift({height:dims.height,width:dims.width,scope:this,callback:this.contentShow,duration:this.resizeDuration,delay:50})},position:function(pos){this.containerElement.show();var w=this.containerElement.getWidth();var h=this.containerElement.getHeight();var pageScroll=Ext.fly(document).getScroll();var arrayPageSize=AND.getPageSize();if(pos){this.containerElement.setStyle({top:pos[1]+"px",left:pos[0]+"px"}).show()}else{var lightboxTop=pageScroll.top+(arrayPageSize[3]-35-h)/2;var lightboxLeft=(arrayPageSize[2]-w)/2;this.containerElement.setStyle({top:lightboxTop<0?"0px":lightboxTop+"px",left:lightboxLeft<0?"0px":lightboxLeft+"px"}).show()}return{width:w,height:h}},contentShow:function(){this.defaultContainer.setStyle({visibility:"visible",height:"auto"});this.fireEvent("afterOpen");this.fader.fadeOut({endOpacity:0,duration:this.resizeDuration,callback:function(){this.fader.hide()},scope:this})},resetEls:function(){this.defaultContainer.setStyle({visibility:"hidden",width:"0px",height:"0px"});this.fader.setStyle({display:"block",width:"0px",height:"0px",opacity:"1"});this.container.setStyle("left","0px")},close:function(){this.containerElement.hide();this.overlay.hide();this.shim.hide();this.fireEvent("close");this.defaultContainer.dom.innerHTML="";this.defaultContainer.setStyle({height:"auto",width:"auto"})},setViewSize:function(){var viewSize=AND.getPageSize(),w=viewSize[0],h=Math.max(viewSize[1],viewSize[3]);this.overlay.setStyle({left:0,top:0,width:w+"px",height:h+"px"});this.shim.setStyle({left:0,top:0,width:w+"px",height:h+"px"}).show()}})};return{getInstance:function(){if(!UI){constructor();UI=new DM.LightboxObj}return UI}}}();(function($){var $document=$(document);var addCurrentUrltoLink=function(url){return url.replace("targetUrl=","targetUrl="+window.location+" ")};$document.on("click",".js-logout",function(evt){window.location=addCurrentUrltoLink($(this).attr("href"));return false});$document.on("click",".js-login",function(evt){evt.preventDefault();window.location.href=addCurrentUrltoLink($(this).attr("href"))});$(document).on("click",".not_you",function(){$(".has-prov").removeClass("has-prov")})})(jQuery);DM.Login={init:function(o){},open:function(e,t,opt){$(".js-login").trigger("click")}};(function(){var config=DM&&DM.features&&DM.features.loginWall,articleCounter,today,nextyear;if(!DM.isLoggedIn&&PageCriteria&&PageCriteria.pageType==="article"&&config){today=new Date;nextyear=new Date(today.getTime()+24*60*60*1e3*365*2);articleCounter=parseInt(document.cookie.replace(/(?:(?:^|.*;\s*)mol-article-counter\s*\=\s*([^;]*).*$)|^.*$/,"$1"));if(isNaN(articleCounter)){articleCounter=1}articleCounter++;document.cookie="mol-article-counter="+articleCounter.toString()+"; expires="+nextyear.toString()+"; path=/";if(articleCounter>6){lightbox=$('<div class="ez-modal login-wall-lightbox-container" aria-hidden="true" role="dialog"></div>').appendTo("body").ezmodal({ajaxUrl:"/registration/p/lightbox_login_wall.html?targetUrl="+window.location+" .login-lightbox",ajaxRefreshEverytime:false});lightbox.ezmodal("open");lightbox.on("ez-modal-after-open",function(evt){DM.pageEvents.fireEvent(DM.pageEvents.PAGE_LOGIN_OPENED,DM.getPageMetadata({contentType:"login-wall",loginType:"Login Wall",registrationEntry:"Login Wall"}))});lightbox.on("ez-modal-after-open",function(evt){DM.pageEvents.fireEvent(DM.pageEvents.FRAGMENT_LOADED,evt.ui.modal.get(0))})}}})();(function(root,factory){if(typeof define==="function"&&define.amd){define(["jquery"],function($){return factory(root,$)})}else{return factory(root,$)}})(this,function(root,$){var debounce=function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}};var types="text password search number email datetime datetime-local date month week time tel url color range".split(" "),len=types.length;$.expr[":"]["textall"]=function(elem){var type=elem.getAttribute("type");for(var i=0;i<len;i++){if(type===types[i]){return true}}return false};var DEFAULT_ERROR_MESSAGE="The value is not correct";var ruleFactory={regExp:function(args){var re=args.re,error=args.error;return function(val,$form,cb){if(re.test(val)){cb()}else{cb(error||DEFAULT_ERROR_MESSAGE)}}},length:function(args){var min=args.min,max=args.max,error=args.error;if(typeof min==="undefined"){min=-Infinity}if(typeof max==="undefined"){max=Infinity}return function(val,$form,cb){var l=val.length;if(l>=min&&l<=max){cb()}else{cb(error||DEFAULT_ERROR_MESSAGE)}}},rest:function(args){var success=args.success||function(msg,status,cb){if(status==="success"){cb()}else{cb(msg||DEFAULT_ERROR_MESSAGE)}};var error=args.error||function(jqXHR,textStatus,errorThrown,cb){cb()};var notCached=args.notCached;var cache={};return function(val,form,cb){var ajaxConfig=$.extend({url:args.url,type:"GET",data:args.getData&&args.getData(val)||val,success:function(msg,status){if(!notCached){cache[val]={msg:msg,status:status}}success(msg,status,cb)},error:function(jqXHR,textStatus,errorThrown){error(jqXHR,textStatus,errorThrown,cb)}},args.ajaxConfig);if(!notCached&&typeof cache[val]!=="undefined"){success(cache[val].msg,cache[val].status,cb)}else{$.ajax(ajaxConfig)}}}};$.fn.regformvalidator=function(conf){var getFieldContainer=function($field,cls){var $fieldContainer=$($field).closest(cls);if(!$fieldContainer.length)$fieldContainer=$field;return $fieldContainer};return this.each(function(){var $this=$(this),opts=$.extend({fieldContainer:undefined,errorContainer:".err",succeedClass:"succeed",errorClass:"fail",hintClass:"hint",serverSideErrorClass:undefined,errorsMap:{},hintsMap:{},rules:{},scroll:true,changeStatus:function($field,message,cls){var $fieldContainer=getFieldContainer($field,this.fieldContainer),message,type;$fieldContainer.removeClass(this.errorClass+" "+this.hintClass+" "+this.succeedClass);$fieldContainer.find(this.errorContainer).html(message);$fieldContainer.addClass(cls)}},conf);$.each(opts.rules,function(rulename,rule){if(!$.isFunction(rule)){opts.rules[rulename]=ruleFactory[rule.type](rule.opts)}});var getValue=function($field){if($field.is(":textall,textarea,select")){return $field.val()}if($field.is(":checkbox:checked,:radio:checked")){return $field.val()}return""};var validateError=function(){validate.call(this)};var validateHint=function(){validate.call(this,true)};var validate=function(hint){var $field=$(this),value=getValue($field),name=$field.attr("name"),map=opts.errorsMap[name]||opts.errorsMap["*"],hints=opts.hintsMap[name]||opts.hintsMap["*"],gettingValidation=new $.Deferred;if(!map&&!hints){return gettingValidation.resolve()}if(hint&&hints){map=hints.concat(map)}(function(value,map,opts,$field,$form,hint){(function validateNext(i){var ruleName=map[i],func;if(!ruleName){opts.changeStatus($field,"",opts.succeedClass);gettingValidation.resolve({$field:$field,error:"",hint:opts.succeedClass});return}func=opts.rules[ruleName];func(value,$form,function(error){if(error){opts.changeStatus($field,error,hint&&opts.hintClass||opts.errorClass);gettingValidation.resolve({$field:$field,error:error,hint:hint&&opts.hintClass||opts.errorClass})}else{validateNext(i+1)}})})(0)})(value,map,opts,$field,$this,hint);return gettingValidation.promise()};var validateAll=function($form){var gettingValidation=new $.Deferred,gettingErrors;gettingErrors=$form.find(":textall,textarea,:radio,:checkbox,select").map(function(){return validate.apply(this)}).get();$.when.apply($,gettingErrors).done(function(){var errors;errors=$.map(arguments,function(obj){if(obj&&obj.error.length){return obj}});gettingValidation.resolve(errors)});return gettingValidation.promise()};var submit=function(evt,validated){var $form=$(this);if(validated){return true}if($form.hasClass("submitting")){return false}$form.addClass("submitting");validateAll($form).done(function(errors){var $firstError,offset;if(errors.length){$form.removeClass("submitting");$firstError=getFieldContainer(errors[0].$field,opts.fieldContainer).removeClass("focus");offset=$firstError.offset().top-50;if(offset<0){offset=0}if(opts.scroll){$("html, body").animate({scrollTop:offset},1e3)}$firstError.focus()}else{$form.trigger("submit",true)}});return false};var $fields=$this.find(":input");if(opts.serverSideErrorClass){$fields.each(function(){var $field=$(this),name=$field.attr("name"),value=getValue($field),$fieldContainer=getFieldContainer($field,opts.fieldContainer),msg=$fieldContainer.find(opts.errorContainer).html(),ruleName;if(!$fieldContainer.length)$fieldContainer=$field;if(!$fieldContainer.is(opts.serverSideErrorClass)||!name){return}ruleName="serverSideValidation_"+name;opts.rules[ruleName]=function(val,$form,cb){if(val===value){cb(msg||" ")}else{cb()}};if(opts.errorsMap[name]){opts.errorsMap[name].push(ruleName)}else{opts.errorsMap[name]=[ruleName]}})}$fields.each(function(){var $input=$(this);if($input.is(":textall,textarea")){$input.on("blur",validateError);$input.on("focus",validateHint);$input.on("keydown",debounce(validateError,1e3));$input.on("validate-error",validateError);$input.on("validate-hint",validateHint)}else if($input.is(":radio,:checkbox")){$input.on("click",validateError);$input.on("validate-error",validateError);$input.on("validate-hint",validateHint)}else if($input.is("select")){$input.on("change focus",validateError);$input.on("validate-error",validateError);$input.on("validate-hint",validateHint)}if($input.is(":textall,textarea,:radio,:checkbox,select")){$input.focus(function(){getFieldContainer($fields,opts.fieldContainer).removeClass("focus");getFieldContainer(this,opts.fieldContainer).addClass("focus")});$input.blur(function(){getFieldContainer(this,opts.fieldContainer).removeClass("focus")})}});$this.on("submit",submit)})};return $});DM.EmailLightbox=function(id,params){var rules={mandatoryRecipEmail:{type:"regExp",opts:{re:/^.+$/,error:"Please enter the recipient's email address here"}},mandatoryName:{type:"regExp",opts:{re:/^.+$/,error:"Please enter your name here"}},mandatoryFromEmail:{type:"regExp",opts:{re:/^.+$/,error:"Please enter your email address here"}},emailHelper:{type:"regExp",opts:{re:/^.+$/,error:"Please enter a valid email address"}},email:{type:"regExp",opts:{re:/^([A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4})?$/i,error:"Please provide a valid email address here"}},mandatoryRecaptcha:{type:"regExp",opts:{re:/^.+$/,error:"Please enter the captcha value here"}}};(function($){var $document=$(document);$document.ready(function(evt){if(document.location.hash=="#email"){$(".js-email").first().click()}});$document.on("ez-modal-before-open",function(evt){var opt=evt.opt;if(opt&&opt.placement){emailArticle(opt.placement)}});$document.on("ez-modal-after-open",function(evt){var opt=evt.opt;if(opt.modalType&&opt.modalType==="email-overlay"){$.getScript("http://www.google.com/recaptcha/api/js/recaptcha_ajax.js",function(data){Recaptcha.create(params.captchaKey,"recaptcha",{theme:"custom",custom_theme_widget:"recaptcha"})});$("#email-modal-overlay").css({"z-index":10000002});(function($){$("#sendArticleEmailForm").regformvalidator({fieldContainer:".email-fld",errorContainer:".msg",rules:rules,scroll:false,errorsMap:{forename:["mandatoryName"],to:["mandatoryRecipEmail","email"],from:["mandatoryFromEmail","email"],recaptcha_response_field:["mandatoryRecaptcha"]}})})(jQuery)}});$document.on("ez-modal-after-close",function(evt){var opt=evt.opt;if(opt.modalType&&opt.modalType==="email-overlay"){$("#"+opt.modalId).remove()}});$document.on("submit","#sendArticleEmailForm",function(ajaxRefreshEverytime){$.ajax({type:"POST",url:$(this).attr("action"),data:$("#sendArticleEmailForm").serialize(),beforeSend:function(d){$(".email-loading").addClass("show")},success:function(d){if(d.error=="SUCCESS"){$(".email-lightbox").addClass("sent")}else{handle_backend_validation(d)}},complete:function(d){$(".email-loading").removeClass("show")}});return false});function handle_backend_validation(d){$("#sendArticleEmailForm").removeClass("submitting");$("."+d.errorField).removeClass("succeed").addClass("fail");$("."+d.errorField).find(".msg").html(d.error);Recaptcha.create(params.captchaKey,"recaptcha",{theme:"custom",custom_theme_widget:"recaptcha"})}})(jQuery)};DM.MiniMoment=function MiniMoment(initDate){var weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],MINUTE=60*1e3,HOUR=60*MINUTE;var date=initDate||new Date;var offset=-date.getTimezoneOffset();init();function init(){if(date.getMinutes()){date=new Date(+date+HOUR)}}function ordinalSuffix(i){var j=i%10,k=i%100;if(j==1&&k!=11){return i+"st"}if(j==2&&k!=12){return i+"nd"}if(j==3&&k!=13){return i+"rd"}return i+"th"}var moment={minutes:function minutes(){return date.getMinutes()},add:function add(howMany,what){switch(what){case"hours":date=new Date(+date+howMany*HOUR);break;case"minutes":date=new Date(+date+howMany*MINUTE);break}return this},hours:function hours(){return date.getHours()},toString:function toString(){return date},valueOf:function valueOf(){return date},timeFormat:function timeFormat(){var hours=date.getHours();return(hours<=12?hours==0?12:hours:hours%12)+(hours<12?"AM":"PM")},dateFormat:function dateFormat(){return weekdays[date.getDay()]+", "+months[date.getMonth()]+" "+ordinalSuffix(date.getDate())+" "+date.getUTCFullYear()},dateFormatShort:function dateFormatShort(){return[weekdays[date.getDay()].substring(0,3),date.getDate(),months[date.getMonth()].substring(0,3),date.getUTCFullYear().toString().substring(2,4)].join(" ")},addOffset:function addOffset(){this.add(offset,"minutes");return this},setDate:function setDate(newDate){date=newDate;return this},clone:function(){return DM.MiniMoment(new Date(+date))},tod:function tod(hours){var m=DM.MiniMoment(new Date(+date+(hours||0)*HOUR));var mod3=m.hours()%3;return(!mod3?m:m.add(3-mod3,"hours")).timeFormat()}};return moment};DM.WeatherObj=function(id){this.el=Ext.get(id);this.init()};DM.WeatherObj.prototype={init:function(){this.form=Ext.get(this.el.dom.getElementsByTagName("form")[0]);if(!this.form)return;this.el.select(".js-submit").on("click",this.eHandler,this)},eHandler:function(){this.form.dom.submit()}};DM.WeatherTop=function(){var m=DM.MiniMoment();return function WeatherTop(options){var newNavigation=options.newNavigation,weatherDate=options.weatherDate,mapId=options.mapId,tempScale=options.tempScale;if(weatherDate){var seedDate=new Date(weatherDate.substring(0,4),weatherDate.substring(4,6)-1,weatherDate.substring(6,8),weatherDate.substring(8,10));m=DM.MiniMoment(seedDate)}function tod(m){var mod3=m.hours()%3;return(!mod3?m:m.add(3-mod3,"hours")).clone().addOffset().timeFormat()}function applyData(data){var weatherBlock=$(options.sel||".page-header .weather"),anc=weatherBlock.find("a");if(PageCriteria.geo!="GB"&&anc){anc.attr("href",anc.attr("href")+"?mapId="+mapId+"&numDays=0&mapType=Weather&temp="+tempScale)}if(!newNavigation){weatherBlock.append("<strong>"+m.clone().addOffset().dateFormat()+"</strong>"+data);var spans=weatherBlock.find("span");spans[0].innerHTML=tod(m)+"&nbsp;";spans[2].innerHTML=tod(m.clone().add(3,"hours"))+"&nbsp;";weatherBlock.show()}else{weatherBlock.html(["<span>",m.clone().addOffset().dateFormatShort(),"</span>",data].join(""))}anc=weatherBlock.children("a");if(PageCriteria.geo==="AU"&&anc.length){anc.attr("href","/weather/australia/index.html")}DM.pageEvents.fireEvent(DM.pageEvents.FRAGMENT_LOADED,weatherBlock.get(0))}$.get("/weather.html",{latitude:Math.round(PageCriteria.latitude),longitude:Math.round(PageCriteria.longitude),newNavigation:newNavigation,weatherDate:weatherDate},applyData)}}();DM.TravelSearch=function(){var UI;var constructor=function(){var el,depDay,depMon,depYear,cal;var init=function(o){Ext.fly("js-submit-button").on("click",validateForm,this);el=Ext.get("js-calendar-container");if(el){depDay=Ext.get("depdate-day");depMon=Ext.get("depdate-month");depYear=Ext.get("depdate-year");var dateRange=new Date;dateRange.setTime(dateRange.getTime()+1e3*60*60*24*3);cal=new Ext.ux.DatePicker("js-calendar-container",{handler:mySelectHandler,value:dateRange,showToday:false});Ext.fly("js-dateFromLink").on("click",cal.show,cal);var c=Ext.get("js-children-1");c.on("change",showChildren,this);c.on("keyup",showChildren,this);setDepartureDate();Ext.get("js-to").on("focus",function(e,t){t.value=""},this,{single:true})}};var mySelectHandler=function(c,d){cal.el.hide();depDay.dom.value=d.getDate();depMon.dom.value=d.getMonth()+1;depYear.dom.value=d.getFullYear()};var validateForm=function(e){var blockSub1=true;var blockSub2=true;var errDep=Ext.get("js-error-departure"),inputDep=Ext.get("js-from").dom,errDest=Ext.get("js-error-destination"),inputDest=Ext.get("js-to").dom;if(inputDep.value=="UNDEFINED"){
errDep.dom.innerHTML="Please select your departure airport";errDep.show()}else{errDep.hide();blockSub1=false}if(inputDest.value.length<1||inputDest.value=="Please type your destination"){errDest.dom.innerHTML="Please type in your destination or click 'More search options' to see the list of destinations available";errDest.show()}else{errDest.hide();blockSub2=false}(blockSub1||blockSub2)&&e.preventDefault()};var setDepartureDate=function(){var dateRange=new Date;dateRange.setTime(dateRange.getTime()+1e3*60*60*24*3);depDay.dom.value=dateRange.getDate();depMon.dom.value=dateRange.getMonth()+1;depYear.dom.value=dateRange.getFullYear()};var showChildren=function(numChildren){var elem,c=Ext.get("js-childages");if(numChildren>0){c.show();var l=5;while(l>0){--l;elem=Ext.get("js-childage-"+l);if(l>numChildren)elem.hide();else elem.show()}}else{c.hide()}};return{init:init}};return{getInstance:function(){if(!UI){UI=constructor()}return UI}}}();DM.TimSearch=function(id,conf){Ext.apply(this,conf);this.init({id:id})};DM.TimSearch.prototype={_el:null,init:function(o){this._el=Ext.get(o.id);if(!this._el){return}this._el.on("submit",this._onSubmit,this)},_onSubmit:function(e){var checkedEl=this._el.select("input[name=searchWhere]:checked").item(0),redirectUrl;if(checkedEl&&checkedEl.dom.value==="company"&&checkedEl.dom.checked){e.preventDefault();redirectUrl=this.link+this._el.select("input[name=searchPhrase]").item(0).dom.value;this._el.dom.target&&this._el.dom.target==="_top"?window.parent.location=redirectUrl:window.location=redirectUrl}}};DM.TimCalculator=Ext.extend(Ext.util.Observable,function(){var _rules={mandatory:/^.+$/,number:/^-?[\d,]*(\.\d*)?$/,integer:/^-?[\d,]*$/,pNumber:/^[\d,]*(\.\d*)?$/,pNumNoFormat:/^[\d,]*(\.\d*)?$/,pInteger:/^[\d,]*$/},SEL_INPUTS_CONTAINER=".calc-inputs",SEL_INPUTS=SEL_INPUTS_CONTAINER+" input[name], "+SEL_INPUTS_CONTAINER+" select[name]",SEL_CALC_BTN="button[name=calculate]",SEL_RESULTS_CONTAINER=".calc-results",SEL_RESULTS=SEL_RESULTS_CONTAINER+" input[name]",SEL_MSG=".calc-msg";return{_formEl:null,_inputs:{},_inputEls:{},constructor:function(id,config){var that=this,formEl=Ext.get(id);if(!formEl){return}this._formEl=formEl;Ext.apply(this,config);this._inputEls=formEl.select(SEL_INPUTS).each(function(el){if(el.dom.type&&el.dom.type==="text"){el.on("keyup",that.runCalc,that)}if(el.dom.type&&(el.dom.type==="radio"||el.dom.type==="checkbox")){el.on("click",that.runCalc,that)}if(el.dom.type==="select-one"){el.on("change",that.runCalc,that)}});formEl.on("submit",this.runCalc,this,{preventDefault:true});formEl.select(SEL_CALC_BTN).on("click",this.runCalc,this);this.addEvents("b4run","b4submitRun")},_readInput:function(el,showErrors){var that=this,elName=el.dom.name,reqs,ruleName,ruleToTest;if(!el){return}showErrors=showErrors||false;if(el.dom.type==="text"||el.dom.type==="select-one"){this._inputs[elName]=el.dom.value}if(el.dom.type==="radio"&&el.dom.checked){this._inputs[elName]=el.dom.value}if(el.dom.type==="checkbox"&&el.dom.checked){this._inputs[elName]=el.dom.value}el.isNumeric=false;if(typeof this.rq[elName]!=="undefined"||typeof this.rq["*"]!=="undefined"){reqs=this.rq[elName]||this.rq["*"];for(var i=0,len=reqs.length;i<len;i+=1){if(reqs[i].constructor.name==="RegExp"){ruleToTest=reqs[i]}else{ruleName=reqs[i];if(typeof _rules[ruleName]==="undefined"){continue}ruleToTest=_rules[ruleName];if(/^p?number|p?integer$/i.test(ruleName)){el.isNumeric=true}}if(!ruleToTest.test(this._inputs[elName])){if(showErrors){el.addClass("failed")}return false}}}el.removeClass("failed");if(el.isNumeric){this._inputs[elName]=+this._inputs[elName].replace(/,/g,"").replace(/\s/g,"")}return true},runCalc:function(ev){var that=this,formEl=this._formEl,formulae=this.fx,results={},isValid=true,showErrors=false;if(ev&&ev.type==="keyup"){if(ev.keyCode===9){return}}if(Ext.isEmpty(formulae)){return}this.fireEvent("b4run");if(ev&&ev.type==="click"){this.fireEvent("submitRun")}formEl.select(SEL_RESULTS).each(function(el){el.dom.value=""});showErrors=ev&&ev.type==="click";this._inputEls.each(function(el){if(!isValid){that._readInput(el,showErrors)}else{isValid=that._readInput(el,showErrors)}});if(!isValid){return}for(var fxName in formulae){if(formulae.hasOwnProperty(fxName)){if(typeof formulae[fxName]==="function"){results[fxName]=formulae[fxName].call(this,this._inputs,results);if(Ext.isEmpty(results[fxName])){continue}formEl.select(SEL_RESULTS_CONTAINER+" input[name="+fxName+"]").each(function(el){el.dom.value=typeof results[fxName]==="number"?that.formatNum(results[fxName],2):results[fxName]})}}}},formatNum:function(n,decimals,thousandSep,decPoint){var prec=!isFinite(+decimals)?0:Math.abs(decimals),sep=typeof thousandsSep==="undefined"?",":thousandsSep,dec=typeof decPoint==="undefined"?".":decPoint,s="",toFixedFix=function(n,prec){var k=Math.pow(10,prec);return""+Math.round(n*k)/k};if(!isFinite(n)){return null}s=(prec?toFixedFix(n,prec):""+Math.round(n)).split(".");if(s[0].length>3){s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,sep)}if((s[1]||"").length<prec){s[1]=s[1]||"";s[1]+=new Array(prec-s[1].length+1).join("0")}return s.join(dec)},printMsg:function(msg,css){var formEl=this._formEl;if(!msg)return;css=css?"calc-msg "+css:"calc-msg";formEl.select(SEL_RESULTS_CONTAINER).item(0).insertHtml("afterBegin",'<p class="'+css+'">'+msg+"</p>");this.on("b4run",function(){formEl.select(SEL_MSG).each(function(el){el.remove()})},this,{single:true})}}}());DM.TimCalculatorJSON=Ext.extend(DM.TimCalculator,function(){var _headEl=document.getElementsByTagName("head").item(0),_isAppended=[],_isLoaded=[];return{constructor:function(id,config){var that=this,onFocus;DM.TimCalculatorJSON.superclass.constructor.call(this,id,config);if(this.dataSource&&this.dataSource.url){onFocus=function(){that.appendScript(that.dataSource.url);that._inputEls.each(function(el){Ext.EventManager.un(el,"focus",onFocus)})};this._inputEls.on("focus",onFocus);this.on("b4submitRun",function(){if(!_isLoaded[encodeURI(that.dataSource.url)]){that.appendScript(that.dataSource.url,true,that.runCalc)}})}},appendScript:function(url,force,callback){var that=this,scriptTag;function scriptOnLoad(){scriptTag.parentNode.removeChild(scriptTag);_isLoaded[encodeURI(url)]=true;if(typeof callback==="function"){callback.call(that)}}if(!url){return}if(_isAppended[encodeURI(url)]&&!force){return}scriptTag=document.createElement("script");scriptTag.setAttribute("type","text/javascript");scriptTag.src=url;scriptTag.onload=function(){scriptTag.onloadDone=true;scriptOnLoad()};scriptTag.onreadystatechange=function(){if(("loaded"===scriptTag.readyState||"complete"===scriptTag.readyState)&&!scriptTag.onloadDone){scriptOnLoad()}};_headEl.appendChild(scriptTag);_isAppended[encodeURI(url)]=true}}}());(function(root,factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{root.DM.TIMCalculator=factory($)}})(this,function($){var rules={pNumber:/^[\d,]*(\.\d*)?$/,pNumNoFormat:/^[\d,]*(\.\d*)?$/,pInteger:/^[\d,]*$/},functions={loans:{payment:function(i,r){if(i.rate&&i.rate==0){return i.amount/(i.duration*i.period)}var factor=i.rate/1200;return factor*Math.pow(1+factor,i.duration*i.period)/(Math.pow(1+factor,i.duration*i.period)-1)*i.amount},charge:function(i,r){if(i.rate&&i.rate==0){return"0"}return r.payment*i.duration*i.period-i.amount},repayment:function(i,r){return r.payment*i.duration*i.period}},savings:{worth:function(i,r){var rate,growthRate;if(i.rate&&i.rate==0){return Number(i.amount)+i.payment*i.years*12}rate=i.rate/100;growthRate=Math.pow(1+rate/12,i.years*12);return i.payment*(growthRate-1)*(12/rate)+i.amount*growthRate}},mortgages:{monthly:function(i,r){if(i.rate&&i.amount&&i.years){if(i.type==="interest"){return i.amount*i.rate/12/100}if(i.type==="repayment"){var factor=i.rate/1200;return factor*Math.pow(1+factor,i.years*12)/(Math.pow(1+factor,i.years*12)-1)*i.amount}}},repayment:function(i,r){if(r.monthly){var repayment=Number(i.fee)+r.monthly*12*i.years;if(i.type==="interest"){return repayment+Number(i.amount)}if(i.type==="repayment"){return repayment}}},charge:function(i,r){if(r.repayment&&i.amount){return r.repayment-i.amount}},cost:function(i,r){if(r.monthly){if(i.fee){return r.monthly*(i.initialYears*12+Number(i.initialMonths))+Number(i.fee)}return"0"}}},stamp_duty:{stampduty:function(i,r){var buyToLet=function(i,s){return i.buytolet?s+.03:s};if(!i.price){return}else if(i.price==0){return"0"}else if(i.price<125001){return i.buytolet?i.price*.03:"0"}else if(i.price>=125001&&i.price<250001){return(i.price-125e3)*buyToLet(i,.02)+125e3*buyToLet(i,0)}else if(i.price>=250001&&i.price<925001){return(i.price-25e4)*buyToLet(i,.05)+125e3*buyToLet(i,.02)+125e3*buyToLet(i,0)}else if(i.price>=925001&&i.price<1500001){return(i.price-925e3)*buyToLet(i,.1)+675e3*buyToLet(i,.05)+125e3*buyToLet(i,.02)+125e3*buyToLet(i,0)}else if(i.price>=1500001){return(i.price-15e5)*buyToLet(i,.12)+575e3*buyToLet(i,.1)+675e3*buyToLet(i,.05)+125e3*buyToLet(i,.02)+125e3*buyToLet(i,0)}}}},SEL_INPUTS_CONTAINER=".calc-inputs",SEL_INPUTS=SEL_INPUTS_CONTAINER+" input[name], "+SEL_INPUTS_CONTAINER+" select[name]",SEL_RESULTS_CONTAINER=".calc-results",SEL_RESULTS=SEL_RESULTS_CONTAINER+" input[name]",SEL_TABS="ul.mortgage-tabs > li";$.fn.timCalculator=function(options){var _formEl=null,_inputs={},_inputEls={},removeCommas=function(num){if(typeof num==="string"){while(num.search(",")>=0){num=num.replace(",","")}}return num},cleanAll=function(){_inputEls.each(function(){$(this).parent().removeClass("failed")})},changeTab=function(){var selectedTab=$(this).data("tab");_formEl.removeClass("select");$("#"+selectedTab).addClass("select")},formatNum=function(n,decimals){var prec=!isFinite(+decimals)?0:Math.abs(decimals),s="",toFixedFix=function(n,prec){var k=Math.pow(10,prec);return""+Math.round(n*k)/k};if(!n||!isFinite(n)){return null}s=(prec?toFixedFix(n,prec):""+Math.round(n)).split(".");if(s[0].length>3){s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,",")}if((s[1]||"").length<prec){s[1]=s[1]||"";s[1]+=new Array(prec-s[1].length+1).join("0")}if((s[1]||"").length>prec){s[1]=s[1].substring(0,2)}return s.join(".")},readInput=function(el){var elName=el.attr("name"),rq=options.rq,reqs,ruleName,ruleToTest;if(!el){return}_inputs[elName]=el.prop("type")==="checkbox"?el.prop("checked"):el.val();if(typeof rq[elName]!=="undefined"||typeof rq["*"]!=="undefined"){reqs=rq[elName]||this.rq["*"];for(var i=0,len=reqs.length;i<len;i+=1){if(reqs[i].constructor.name==="RegExp"){ruleToTest=reqs[i]}else{ruleName=reqs[i];if(typeof rules[ruleName]==="undefined"){continue}ruleToTest=rules[ruleName];if(el.prop("type")==="number"){if(el.val()===""){el.val(el.val())}}else if(/^p?number|p?integer$/i.test(ruleName)){_inputs[elName]=removeCommas(_inputs[elName]);if(isFinite(_inputs[elName])){el.val(formatNum(_inputs[elName]))}}}if(!ruleToTest.test(_inputs[elName])||el.prop("max")&&el.prop("max").length<el.val().length){el.parent().addClass("failed");return false}}}el.parent().removeClass("failed");return true},runCalc=function(ev){var formulae=functions[options.fx],results={},isValid=true,result=null;if(ev&&ev.type==="keyup"){if(ev.keyCode===37||ev.keyCode===39){return}}if(!formulae)return;_formEl.find(SEL_RESULTS).each(function(){$(this).val("-")});_inputEls.each(function(){isValid=readInput($(this))&&isValid});if(!isValid){return}for(var fxName in formulae){if(formulae.hasOwnProperty(fxName)){if(typeof formulae[fxName]==="function"){results[fxName]=formulae[fxName].call(this,_inputs,results);if(!results[fxName]){continue}_formEl.find(SEL_RESULTS_CONTAINER+" input[name="+fxName+"]").each(function(el){result=typeof results[fxName]==="number"?formatNum(results[fxName].toString(),2):results[fxName];$(this).val(result?"£"+result:"-")})}}}};return this.each(function(){var el=$("#"+this.id);if(!el)return;_formEl=el;_inputEls=_formEl.find(SEL_INPUTS).each(function(){var elem=$(this);if(elem.prop("type")==="text"){elem.on("keyup",runCalc)}if(elem.prop("type")==="number"){elem.on("keyup",runCalc)}if(elem.prop("type")==="checkbox"){elem.on("click",runCalc)}if(elem.prop("type")==="select-one"){elem.on("change",runCalc)}});_formEl.on("click",SEL_TABS,changeTab);_formEl.on("reset",cleanAll)})};return $});DM.HousePriceCalculator=Ext.extend(DM.TimCalculatorJSON,{constructor:function(id,config){DM.HousePriceCalculator.superclass.constructor.call(this,id,config)},getPrice:function(area,year,type){var dataSets=DM.HousePriceCalculator.dataSets,data,price;if(!dataSets||!this.dataSource||!this.dataSource.key){return}data=dataSets[this.dataSource.key];if(!data||!data[area]||!data[area][year]||!data[area][year][type]){return}price=data[area][year][type];if(typeof price==="number"&&isFinite(price)){return price}if(Ext.isArray(price)){for(var i=0,len=price.length,acc=0;i<len;i+=1){if(typeof price[i]!=="number"||!isFinite(price[i])){return}acc+=price[i]}return acc/len}}});DM.HousePriceCalculator.dataSets={};DM.InflationCalculator=Ext.extend(DM.TimCalculatorJSON,{constructor:function(id,config){DM.InflationCalculator.superclass.constructor.call(this,id,config)},getInflationRate:function(year){var dataSets=DM.InflationCalculator.dataSets||null,data;if(!dataSets){return null}data=this.dataSource&&this.dataSource.key?dataSets[this.dataSource.key]:null;if(!data){return null}if(typeof data[year]==="undefined"||!isFinite(data[year])){return null}return data[year]},getCompoundedRate:function(year,baseYear){var dataSets=DM.InflationCalculator.dataSets||null,data,factor={};if(year===2015){return 1}if(!dataSets){return null}data=this.dataSource&&this.dataSource.key?dataSets[this.dataSource.key]:null;if(!data){return null}if(typeof data[year]==="undefined"||!isFinite(data[year])){return null}baseYear=baseYear||2015;factor[baseYear+1]=1;for(var y=baseYear;y>=1900;y-=1){if(!isFinite(data[y])||!isFinite(factor[y+1])){return null}factor[y]=factor[y+1]*(data[y]+100)/100;factor[y]=Math.round(factor[y]*1e6)/1e6;if(y===year+1){return factor[y]}}return null}});DM.InflationCalculator.dataSets={};DM.TimAccordion=function(id,config){config&&Ext.apply(DM.TimAccordion.prototype,config);this.init(id)};DM.TimAccordion.prototype={cellWidth:152,maxWidth:496,interval:3e4,selCell:"h4",selCol:".col",selCellOpen:"h4.open",selPane:".pane",init:function(id){var that=this;this._el=Ext.get(id);if(!this._el){return}this._cellCurrent=this._el.select(this.selCellOpen).item(0);this._colCurrent=this._cellCurrent.parent(this.selCol);this._paneCurrent=this._cellCurrent.next(this.selPane);this._el.select(this.selCell).on("click",that._handleClick,this,{stopEvent:true});if(this.interval){this._introTimer=setInterval(function(){that._openRandom.call(that)},this.interval)}this._el.select(".pane .radios").on("submit",function(e,t){e.preventDefault();window.location=t.action});this._el.select(".pane .radios").on("click",function(e,t){var form=e.getTarget("form",5);if(!form||!t.value){return}form.action=t.value},this,{delegate:"input[type=radio]"})},_openRandom:function(){var randIndex=Math.floor(Math.random()*8),el=this._el.select(this.selCell).item(randIndex);if(el){if(!el.is(".open")){this._openCell(el)}else{this._openRandom()}}},_handleClick:function(e,t){clearInterval(this._introTimer);this._openCell(e.getTarget(this.selCell,0,true))},_openCell:function(el){var that=this,indexOpen,indexToOpen;function setOpen(){that._cellToOpen.addClass("open");that._paneToOpen.addClass("open")}function setAnchoring(el1,el2){el1.setStyle({left:"auto",right:"0"});el2.setStyle({left:that.cellWidth+"px",right:"auto"})}if(this._wip){return}this._cellToOpen=el;if(!this._cellToOpen||this._cellToOpen.hasClass("open")){return}this._colToOpen=this._cellToOpen.parent(this.selCol);this._paneToOpen=this._cellToOpen.next(this.selPane);this._wip=true;if(this._colToOpen.id===this._colCurrent.id){that._paneToOpen.fadeIn();that._paneCurrent.fadeOut({callback:function(){setOpen();that._paneCurrent.show();that._postAnim()}});return}setOpen();indexOpen=+/.*?col-(\d)$/.exec(this._colCurrent.id)[1];indexToOpen=+/.*?col-(\d)$/.exec(this._colToOpen.id)[1];if(indexToOpen<indexOpen){setAnchoring(this._paneToOpen,this._paneCurrent)}else{setAnchoring(this._paneCurrent,this._paneToOpen)}this._animate()},_animate:function(){var that=this,collapsingW=this._colCurrent.getWidth(),expandingW=this._colToOpen.getWidth(),loop=0,duration=800,start=(new Date).valueOf(),timer;function moveIt(){var cellWidth=that.cellWidth,maxWidth=that.maxWidth,elapsed=(new Date).valueOf(),frame=elapsed>start+duration?1:(elapsed-start)/duration,step=Math.floor(frame*(maxWidth-cellWidth));loop=loop+1;if(loop>300||frame===1){that._colCurrent.setStyle("width",cellWidth+"px");that._colToOpen.setStyle("width",maxWidth+"px");that._postAnim();clearInterval(timer);return}if(collapsingW>cellWidth){collapsingW=maxWidth-step;that._colCurrent.setStyle("width",collapsingW+"px")}if(expandingW<maxWidth){expandingW=cellWidth+step;that._colToOpen.setStyle("width",expandingW+"px")}}timer=setInterval(moveIt,8)},_postAnim:function(){this._wip=false;this._cellCurrent.removeClass("open");this._paneCurrent.removeClass("open");this._colCurrent=this._colToOpen;this._cellCurrent=this._cellToOpen;this._paneCurrent=this._paneToOpen}};DM.BingSearchBox=function(id,conf){Ext.apply(this,conf,{market:"en-gb"});this.init({id:id})};DM.BingSearchBox.prototype={init:function(o){var that=this,fEl=Ext.get(o.id);if(!fEl){return}function handleSubmit(e){var checkedEl=fEl.query("input[name=sel]:checked")[0],phraseEl=fEl.query("input[name=searchPhrase]")[0],phraseVal=phraseEl&&phraseEl.value?phraseEl.value:"";e.preventDefault();if(!phraseVal){return}if(checkedEl&&checkedEl.value==="web"&&checkedEl.checked){window.open("http://www.bing.com/search?q="+phraseVal+"&mkt="+that.market+"&cp=1252&FORM=MOL635","_blank")}else{fEl.dom.submit()}}fEl.select(".bing-logo").on("click",handleSubmit);fEl.on("submit",handleSubmit)}};DM.TabbedTeamLinks=Ext.extend(DM.Tabs,{tabOffClass:["js-unactive"],tabOnClass:["js-active"],constructor:function(id){DM.Headlines.superclass.constructor.call(this,id)},_onLoadCallBack:function(){var heighMain=Ext.fly(this._panes[0]).getHeight();var paneMore=Ext.get(this._panes[1]);var amount=Ext.isIE6||Ext.isIE7?0:10;if(paneMore.query("li").length>1){amount=0}paneMore.setHeight(heighMain-amount)}});DM.BreakingBanner=function(id,conf){Ext.apply(this,conf,{market:"en-gb"});this.init({id:id})};DM.BreakingBanner.prototype={timeout:6e3,init:function(o){var that=this,handle=Ext.get(o.id),headlines=handle.child(".itms").child("div"),timeouts=[],opt={},int;if(!handle&&!headlines){return}function skip(){while(timeouts.length>0){clearTimeout(timeouts[timeouts.length-1]);timeouts.pop()}fadeToNext()}function newScrollLeft(){c=headlines.child(".first");d=c.child("div");if(headlines.getWidth()-d.getWidth()<0){opt={duration:(d.getWidth()-headlines.getWidth())/20,callback:skip};d.setXY([headlines.getX()+(headlines.getWidth()-d.getWidth()),d.getY()],opt)}else{timeouts.push(setTimeout(fadeToNext,that.timeout))}}function fadeToNext(){current=headlines.child(".first");current.sequenceFx();if(opt.anim){if(opt.anim.isAnimated){opt.anim.stop()}}current.fadeOut({easing:"easeOut",duration:.5});setTimeout(fadeToNextPart2,500)}function fadeToNextPart2(current){current=headlines.child(".first");current.removeClass("first");current.child("div").setLeft(0);if(current.next("div.b-item")!==null){current=current.next("div.b-item")}else{current=headlines.first("div.b-item")}current.addClass("first");current.fadeIn({easing:"easeIn",duration:.5});timeouts.push(setTimeout(newScrollLeft,that.timeout/2))}timeouts.push(setTimeout(newScrollLeft,that.timeout))}};DM.FancyHeadlines={init:function(o){if(!Array.prototype.forEach){Array.prototype.forEach=function(fn,scope){for(var i=0,len=this.length;i<len;++i){fn.call(scope||this,this[i],i,this)}}}var els=Ext.query(".fancy-hdln");for(var i=0;i<els.length;i++)els[i].style.display="block";var el=Ext.get(o.id),that=this;if(!el){return}that.parent=o.id;Ext.Ajax.autoAbort=true;that.headlineTemplate=new Ext.Template('<li class="dynArticle" data-aid="{artID}">','<div class="article hdln-cont" data-followbutton="{artChannelFollowButton} ">','<span class="social-headline" style="display:none">{socialHeadline}</span>','<a href="{artURL}"><img src="{imgURL}" width="154" height="115"></a>','<div class="hdln">','<h3 class="linkro-darkred"><a class="title" href="{artURL}">{headline}</a></h3>',"<p>{prevText}</p>","</div>",'<div class="comments">','<div class="article-icon-links-container">','<ul class="article-icon-links refresh cleared">',"</ul>");that.headlineEndTemplate=new Ext.Template("</div>","</div>","</div>","</li>");that.commentsTemplate=new Ext.Template("<li>",'<a class="comments-link" href="{artURL}#comments" rel="nofollow">','<span class="icon"></span><span class="linktext">','<span class="readerCommentNo bold" rel="{artID}">{comCount}</span> comment{plural}',"</span>","</a>","</li>");that.videoTemplate=new Ext.Template("<li>",'<a class="videos-link" href="{artURL}#video" rel="nofollow">','<span class="icon"></span><span class="linktext">','<span class="bold">{videos}</span> video{plural}',"</span>","</a>","</li>");that.shareTemplate=new Ext.Template('<li class="gr3ox">','<a class="{shortURL}| js-sl share-link" data-article-image="{articleImage}" href="#">','<span class="icon"></span> <span class="linktext">','<span class="bold">{shares}</span> share{plural}',"</span>","</a>","</li>");that.loadingTemplate=new Ext.Template('<li class="loading"><div>Loading more articles...</div></li>');that.newArticlesTemplate=new Ext.Template('<li class="newArticles">','<div>THERE {plural1} {count}NEWER ARTICLE{plural2} AVAILABLE - <a href="#{channel}">Reload</a></div>',"</li>");Ext.onReady(function(){that.channel=window.location.hash?window.location.hash.slice(1):"home";selected=el.child("li."+that.channel)==null?el.child("div."+that.channel):el.child("li."+that.channel);that.selectChan(null,Ext.fly(selected).child("a").dom);var lis=el.child(".menu-cont").child("ul").select("li"),drop=el.child("div.inner-cont").child("div.dropmenu").select("div");lis.each(function(li){a=li.child("a");a.on("click",that.selectChan,that,{params:o})});drop.each(function(div){a=div.child("a");a.on("click",that.selectChan,that,{params:o})});el.child(".menu-cont").child("div").on("click",function(e){el.child(".inner-cont").child("div").setStyle("display","block");e.stopPropagation()});Ext.getBody().on("click",function(){el.child(".inner-cont").child("div").setStyle("display","none")});var checkScrollTask={run:that.checkScroll,interval:500,scope:that};var checkNewTask={run:that.checkNew,interval:18e4,scope:that};Ext.TaskMgr.start(checkScrollTask);Ext.TaskMgr.start(checkNewTask)})},checkScroll:function(){var list=Ext.get(this.parent).child("div.inner-cont").child("ul"),count=list.dom.children.length;if(count>1){if(!Ext.get(list.dom.lastChild).hasClass("loading")){if((window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop)>Ext.get(list.dom.lastChild).getY()-1500){this.loadingTemplate.append(list,{});this.fetchChan(this,this.channel,count,this.parent)}}}},checkNew:function(){var that=this;if(!Ext.Ajax.isLoading()){var hdlnList=Ext.get(this.parent).child("div.inner-cont").child("ul");var list=hdlnList.select("li.dynArticle");Ext.Ajax.request({url:"/api/latest_headlines/"+this.channel+"/"+0+".json",timeout:2e5,success:function(response,opts){var id=list.item(0).getAttribute("data-aid"),count=0,found=false;t=Ext.decode(response.responseText);t.forEach(function(art){if(!found&&art.articleId!=id){count++}else found=true});if(count>0){n=hdlnList.select("li.newArticles");if(n.getCount()!=0){Ext.get(hdlnList.dom.firstChild).remove()}x=that.newArticlesTemplate.insertFirst(hdlnList,{count:count==30?"":count+" ",channel:that.channel,plural1:count>1?"ARE":"IS",plural2:count>1?"S":""},true);x.child("a").on("click",that.reload)}}})}},fetchChan:function(that,chan,start,parent,override){function plural(count){return count.length!=1?"s":""}if(override||!Ext.Ajax.isLoading()){Ext.Ajax.request({url:"/api/latest_headlines/"+chan+"/"+start+".json",timeout:2e5,success:function(response,opts){var hdlnList=Ext.get(parent).child(".inner-cont").child("ul"),t=Ext.decode(response.responseText);if(hdlnList.dom.lastChild)hdlnList.dom.removeChild(hdlnList.dom.lastChild);t.forEach(function(art){if(that.articleIds.indexOf(art.articleId)<0){that.articleIds.push(art.articleId);var headline=art.headline;if(headline.length>160){var pos=159,quit=false;while(!quit){pos++;if(headline.charAt(pos)==" "||headline.charAt(pos)=="")quit=true}art.headline=headline.substring(0,pos)+"..."}var preview=art.previewText;if(preview.length>145){var pos=144,quit=false;while(!quit){pos++;if(preview.charAt(pos)==" "||preview.charAt(pos)=="")quit=true}art.previewText=preview.substring(0,pos)+"..."}if(art.imageLinkListPuff){x=that.headlineTemplate.append(hdlnList,{artID:art.articleId,headline:art.headline,prevText:art.previewText,imgURL:art.imageLinkListPuff.url,artURL:art.articleURL,artChannelFollowButton:art.followButton!==undefined&&art.followButton!==null?art.followButton+" ":" ",socialHeadline:art.socialHeadline},true);if(art.readerComments=="W"||art.readerComments=="R"){that.commentsTemplate.append(x.child(".article-icon-links"),{artURL:art.articleURL,comCount:art.readerCommentsCount,shortURL:art.shortURL,plural:plural(art.readerCommentsCount)})}if(art.videoCount>0){that.videoTemplate.append(x.child(".article-icon-links"),{artURL:art.articleURL,videos:art.videoCount,plural:plural(art.videoInstances)})}that.shareTemplate.append(x.child(".article-icon-links"),{shortURL:art.shortURL,shares:art.shareCount,articleImage:art.articleImage.hostUrl,plural:plural(art.shareCount)});x=that.headlineEndTemplate.append(x,{},true);if(!Ext.isIE)Ext.get(x.child(".article-icon-links").dom.firstChild).addClass("first")}}});if(Ext.isIE){Ext.get(parent).select(".article-icon-links").each(function(el){Ext.get(el.dom.firstChild).addClass("first")})}DM.has(hdlnList.id,"shareLinks")},failure:function(response,opts){console.log(response);console.log(opts)}})}},selectChan:function(event,el){var parent=Ext.get(el).parent();var menuels=Ext.get(this.parent).child("div.menu-cont").child("ul").select("span");this.channel=parent.parent().dom.className;if(!parent.parent().hasClass("newArticles")){menuels.each(function(el){if(el.hasClass("link-wocc")){el.removeClass("link-wocc").removeClass("linkro-wocc");el.addClass("link-gr6ox").addClass("linkro-ccox");if(el.next())el.next().addClass("divide")}else if(el.hasClass("linkro-ccox")){if(el.next())el.next().addClass("divide")}})}if(Ext.get(el).hasClass("dropel")){var menu=Ext.get(this.parent).child("div.menu-cont").child("ul"),menuLi=Ext.isIE||Ext.isIE7?Ext.get(menu.dom.lastChild):Ext.get(menu.dom.lastElementChild),menuA=menuLi.child("a"),dropA=Ext.get(el),menuHash=menuA.dom.hash,dropHash=dropA.dom.hash,menuText=Ext.isIE8||Ext.isIE7?menuA.dom.innerHTML:menuA.dom.text,dropText=Ext.isIE8||Ext.isIE7?dropA.dom.innerHTML:dropA.dom.text,menuClass=menuLi.dom.className,dropClass=parent.parent().dom.className;menuA.dom.hash=dropHash;dropA.dom.hash=menuHash;menuA.dom.innerHTML=dropText;dropA.dom.innerHTML=menuText;menuLi.dom.className=dropClass;parent.parent().dom.className=menuClass;Ext.get(Ext.isIE||Ext.isIE7?menuLi.dom.lastChild:menuLi.dom.lastElementChild).removeClass("link-gr6ox").removeClass("linkro-ccox");Ext.get(Ext.isIE||Ext.isIE7?menuLi.dom.lastChild:menuLi.dom.lastElementChild).addClass("link-wocc").addClass("linkro-wocc");menuLi.prev().child(".divide").removeClass("divide")}else{if(!parent.parent().hasClass("newArticles")){parent.removeClass("link-gr6ox").removeClass("linkro-ccox");parent.addClass("link-wocc").addClass("linkro-wocc");if(parent.next())parent.next().removeClass("divide");if(parent.parent().prev()&&parent.parent().prev().child(".divide"))parent.parent().prev().child(".divide").removeClass("divide")}}var list=Ext.get(this.parent).child("div.inner-cont").child("ul");while(list.dom.hasChildNodes()){list.dom.removeChild(list.dom.lastChild)}this.appendLoading(this);this.articleIds=[];this.fetchChan(this,this.channel,0,this.parent,true)},appendLoading:function(that){var list=Ext.get(that.parent).child("div.inner-cont").child("ul");that.loadingTemplate.append(list,{})},reload:function(){location.reload()}};(function(pageEvents){pageEvents.listen(pageEvents.VIDEO_ADVERT_STARTED,htmlOnly(handleVideoAdvertStartedEvent));pageEvents.listen(pageEvents.VIDEO_ADVERT_COMPLETED,htmlOnly(handleVideoAdvertCompletedEvent));function htmlOnly(delegate){return function(observable,eventType,data){if(data.playerType==="html"){delegate(observable,eventType,data)}}}function handleVideoAdvertStartedEvent(observable,eventType,data){var videoParent=Ext.get(data.experienceId).parent();Ext.DomHelper.append(videoParent,overlay(data.experienceId))}function handleVideoAdvertCompletedEvent(observable,eventType,data){var overlay=Ext.get(overlayId(data.experienceId));if(overlay)overlay.remove()}function overlay(experienceId){return{id:overlayId(experienceId),tag:"div",cls:"videoplayer-html5-ad-overlay",html:"Advertisement"}}function overlayId(experienceId){return experienceId+"_adoverlay"}})(DM.pageEvents);(function(DM,Ext){function onListItemMouseLeftOrRight(eventObj,target,options){function updatePosition(item,position){Ext.fly(item).animate({right:{to:position}},.45)}function updateStyleOnHoverOverOrLeave(classToRemove,classToAdd){Ext.fly(item).removeClass(classToRemove);Ext.fly(item).addClass(classToAdd)}function updateOnMouseOver(item,position,updateStyleOnHover){updatePosition(item,position);if(updateStyleOnHover)updateStyleOnHoverOverOrLeave("wocc","womlcc")}function updateOnMouseLeave(item,position,updateStyleOnHover){updatePosition(item,position);if(updateStyleOnHover)updateStyleOnHoverOverOrLeave("womlcc","wocc")}var item=Ext.get(this).child("span");eventObj.type=="mouseover"?updateOnMouseOver(item,options.onPos,options.updateStyleOnHover):updateOnMouseLeave(item,-options.styleRight,options.updateStyleOnHover)}function forEachLeftHandedListItem(item,index,items){var linkVideo=Ext.get(item).child("span");if(linkVideo!==null){this.styleRight=/(\d+)/.exec(linkVideo.getStyle("right"))[0];Ext.get(item).on({mouseover:{fn:onListItemMouseLeftOrRight,onPos:this._params.params.onPos,styleRight:this.styleRight,updateStyleOnHover:this._params.params.updateStyleOnHover},mouseout:{fn:onListItemMouseLeftOrRight,onPos:this._params.params.onPos,styleRight:this.styleRight,updateStyleOnHover:this._params.params.updateStyleOnHover}})}}function onDomReady(){var $node=$(this.el.dom),is_x_wide=$node.is(".x-wide"),listItems=this.el.query("a.videoLink");if(is_x_wide){this._params.params.updateStyleOnHover=false}else{if(!this._params.params.nested){$node.vOverlay()}}Ext.each(listItems,forEachLeftHandedListItem,this);if(this.events){this.on("changeEnd",onChangeEnd)}}function onChangeEnd(o){var el=o.cloned;forEachLeftHandedListItem(el)}DM.ChannelCarouselModule=Ext.extend(DM.Carousel,{activePage:1,styleRight:-90,constructor:function(id,o){this._params={params:o,id:id};DM.ChannelCarouselModule.superclass.constructor.call(this,id);this.container=Ext.get(id);this.panels=this.container.child(".rotator-panels");if(this.panels.dom.children.length===0)return;this.pages=this.container.child(".rotator-pages");this._setActivePageClass(1);Ext.onReady(onDomReady,this,{single:true});var item=this.panels.child("li");this.itemWidth=item.getWidth()+/(\d+)/.exec(item.getStyle("margin-right"))[0]*1;this._initEvents()},_setActivePageClass:function(page){var activeClass=this._params.params.activeClass||"selected";if(!this.pages)return;this.pages.select("li").each(function(li,idx){if(li.child("a").dom.getAttribute("data-page")==page)li.child("a").addClass(activeClass);else li.child("a").removeClass(activeClass)},this)},_initEvents:function(){if(!this.pages)return;this.pages.on("click",function(evt){evt.preventDefault();var page=evt.target.getAttribute("data-page");if(page>0)this.scrollTo(page*1)},this)},
_move:function(e){var page=1;var pageCount=parseFloat(this._params.params.pageCount);if(e.getTarget(".js-move-next"))page=this.activePage>=pageCount?1:this.activePage+1;else page=this.activePage<=1?pageCount:this.activePage-1;this.scrollTo(page)},scrollTo:function(page){if(!!this._requestImages)this._requestImages();this.activePage=page;this._setActivePageClass(page);var offset=this.itemWidth*this._params.params.pageSize*(page-1)*-1;this.panels.stopFx(false);Ext.fly(this.panels).animate({left:{to:offset}},1.2)}})})(DM,Ext);(function(DM,Ext){function onDomReady(){var o=this._o;$("#"+o.id).vOverlay()}DM.MostWatched={init:function(o){if(Ext.get(o.id)){this._o=o;Ext.onReady(onDomReady,this,{single:true})}}}})(DM,Ext);function getId(prefix){return prefix+Math.random().toString().substring(7).slice(0,5)}$.fn.vOverlay=function(o){return this.each(function(){$(this).on("click",".videoLink",function(evt){var $this=$(this),lightbox=$this.data("modal"),geo=PageCriteria.geo||"",targetArr,targetGeoUrl,targetRemaining;evt.preventDefault();var recommendationModel=$this.attr("data-recommendation-model");function setVideoRecommendationModel(){var video=lightbox&&lightbox.find("video").get(0);if(video){video.setAttribute("data-recommendation-model",recommendationModel);return true}return false}if(!lightbox){targetArr=$this.data("target").split(" ");targetGeoUrl=targetArr[0]+"&geo="+geo;targetArr.shift();targetRemaining=targetArr.join(" ");lightbox=$('<div class="ez-modal video-lightbox-videojs-container" aria-hidden="true" role="dialog"></div>').appendTo("body").ezmodal({ajaxUrl:targetGeoUrl+" "+targetRemaining});$this.data("modal",lightbox);lightbox.on("ez-modal-after-open",function(evt){var par=$.extend({},o,{nested:true,pageCount:Math.floor(lightbox.find(".videoLink").length/3).toString(),pageSize:3,updateStyleOnHover:true,onPos:0});var $carousel_container=lightbox.find(".video_carousel_container");$carousel_container.attr("id",getId("video_carousel_container"));var vc=new DM.ChannelCarouselModule($carousel_container.attr("id"),par)});lightbox.on("ez-modal-after-open",function(evt){var viewportH=$(window).outerHeight(true),overlayH=lightbox.outerHeight(true),offsetH=(viewportH-overlayH)/2,y;if(offsetH<14){offsetH=14}y=$(window).scrollTop()+offsetH;lightbox.css("position","absolute");lightbox.css("top",y+"px")});lightbox.on("ez-modal-after-load",function(evt){evt.ui.modal.trigger({type:"ez-modal-article-load",lightbox:evt.ui.modal})});lightbox.on("ez-modal-article-load",function(evt){var abox=evt.lightbox.find(".article-box > .article"),aboxid;if(!abox.attr("id")){abox.attr("id",getId("overlay_article"))}$("#share-overlay .close").click();aboxid=abox.attr("id");DM.ShareLinks.init({id:aboxid,params:{zIndex:10000002,isChannel:true}})});lightbox.on("ez-modal-close",function(evt){$("#share-overlay .close").click()})}setVideoRecommendationModel()||lightbox.on("ez-modal-after-load",setVideoRecommendationModel);lightbox.ezmodal("open")})})};$(document).on("ez-modal-after-load",function(evt){var lightbox=evt.ui.modal;if(lightbox.length){setTimeout(function(){DM.setupMolVideoJsPlayers.forEachPlayer(lightbox.get(0),function(player){this.on("playlist-play",function(evt){var index=evt.index;lightbox.find(".videoLink").eq(index).each(function(){var target=$(this).attr("data-target-article");if(!target)return;lightbox.find(".article-box").load(target,function(responseText,textStatus,XMLHttpRequest){lightbox.trigger({type:"ez-modal-article-load",lightbox:lightbox})})})})})},0)}});(function(DM,Ext){function onDomReady(){var o=this._params;o.params.channelShortName=Ext.get(o.id).dom.className.split(" ")[1];$("#"+o.id).vOverlay(o.params)}DM.VideoPreview2=Ext.extend(Ext.util.Observable,{constructor:function(id,o){if(Ext.get(id)){this._params={params:o,id:id};Ext.onReady(onDomReady,this)}}})})(DM,Ext);(function(DM,Ext){function onListItemMouseOverOrOut(eventObj,target,options){var y=eventObj.type=="mouseover"?0:110;Ext.fly(this.getElementsByTagName("span")[0]).animate({top:{to:y}},.45)}function forEachListItem(item,index,items){Ext.get(item).on({mouseover:onListItemMouseOverOrOut,mouseout:onListItemMouseOverOrOut})}function onDomReady(){var listItems=this.el.query("li"),p=this._params.params;Ext.each(listItems,forEachListItem);$(this.el.dom).vOverlay(p);if(this.events){this.on("changeEnd",onChangeEnd)}}function onChangeEnd(o){var el=o.cloned;forEachListItem(el)}DM.VideoCarousel2=Ext.extend(DM.Carousel,{step:176,constructor:function(id,o){this._params={params:o};DM.RolloverCarousel.superclass.constructor.call(this,id);Ext.onReady(onDomReady,this,{single:true})}})})(DM,Ext);(function($){function getAbsUrl(u){var root=location.protocol+window}function videoData(link){var $link=$(link);return{videoId:link.getAttribute("data-videoid"),source:link.getAttribute("data-source"),title:$link.children(".video-item-title").html()||$link.children("span").text(),img:$link.children("img").attr("src"),sponsored:link.getAttribute("data-sponsored"),url:link.getAttribute("data-target"),href:link.href,channel:link.getAttribute("data-channel"),freewheelId:link.getAttribute("data-freewheelid")}}function getId(prefix){return prefix+Math.random().toString().substring(7).slice(0,5)}$.fn.videoOverlayPlayer=function(o,videoToPlayId){return this.each(function(){var experienceId,lightbox=$(this),isPlaylist=true,trackingType=o.trackingType,channelShortName=o.channelShortName,$carousel=$(this),currentVideo,playList,playerIdent,playerKey,rsi=o.rsi;function setVideoStill(data,container){if(data.playerType=="flash"){if(!$("#"+data.experienceId+"_title").length&&currentVideo.title){$('<div id="'+data.experienceId+'_title" class="videoplayer-title-overlay">'+currentVideo.title+"</div>").appendTo(container)}if(!$("#"+data.experienceId+"_image").length&&currentVideo.img){$('<img id= "'+data.experienceId+'_image" src="'+currentVideo.img+'" class="videoplayer-image-overlay" style="top: 0px" />').appendTo(container)}}}DM.pageEvents.listen(DM.pageEvents.VIDEO_CONTENT_COMPLETED,fiterEvent(function(observable,eventType,data){currentVideo=playList.shift();if(currentVideo){var container=$("#"+experienceId).parent();lightbox.find(".article-box").load(currentVideo.url+" .article-box > *",function(responseText,textStatus,XMLHttpRequest){lightbox.trigger({type:"ez-modal-article-load",lightbox:lightbox})});container.replaceWith(createPlayer(true));DM.FreeWheel.loadPlugin(function(){});setVideoStill(data,container);brightcove.createExperiences()}}));DM.pageEvents.listen(DM.pageEvents.VIDEO_PLAYER_READY,fiterEvent(function(observable,eventType,data){var container=$("#"+experienceId).parent();setVideoStill(data,container)}));DM.pageEvents.listen(DM.pageEvents.VIDEO_STREAM_STARTED,fiterEvent(function(observable,eventType,data){$("#"+experienceId+"_title").remove();$("#"+experienceId+"_image").remove()}));DM.pageEvents.listen(DM.pageEvents.VIDEO_CONTENT_COMPLETED,fiterEvent(function(observable,eventType,data){if(data.sponsored){currentVideo=data;var container=$("#"+data.experienceId).parent();setVideoStill(data,container)}}));function fiterEvent(delegate){return function(observable,eventType,data){if(data.experienceId!==experienceId)return;delegate(observable,eventType,data)}}function createPlayer(continuePlayList){return DM.BC.createVideoPlayer({experienceId:experienceId,playerId:playerIdent,playerKey:playerKey,mediaId:currentVideo.videoId,title:currentVideo.title,source:currentVideo.source,isPlaylist:isPlaylist,trackingType:trackingType,channelShortName:channelShortName,continuePlayList:continuePlayList,rsi:rsi,linkBaseURL:currentVideo.href,sponsored:currentVideo.sponsored,videoChannel:currentVideo.channel,freewheelId:currentVideo.freewheelId,image:currentVideo.img})}$(this).on("click",".videoLink",function(evt,pars){var $this=$(this);if(experienceId){DM.BC.playerDestroyed(experienceId)}experienceId=getId("video_channel_carousel_");currentVideo=videoData(this);evt.preventDefault();if(o.videoPlayerConfigMap){if(o.videoPlayerConfigMap[currentVideo.videoId]==="false"){playerIdent=o.player;playerKey=o.playerKey}else{playerIdent=o.nonEmbeddablePlayerIdent;playerKey=o.nonEmbeddablePlayerKey}}else{playerIdent=o.player;playerKey=o.playerKey}playList=$carousel.find(".videoLink").map(function(){return videoData(this)}).get();while(playList.length>0&&playList.shift().videoId!==currentVideo.videoId);setTimeout(function(){brightcove.createExperiences()},200);lightbox.find(".video-box").empty().append(createPlayer(false));DM.FreeWheel.loadPlugin(function(){});if(!(pars&&pars.loaded)){lightbox.find(".article-box").load($this.data("target")+" .article-box > *",function(responseText,textStatus,XMLHttpRequest){lightbox.trigger({type:"ez-modal-article-load",lightbox:lightbox})})}else{evt.stopPropagation()}});lightbox.on("ez-modal-after-close",function(evt){DM.BC.playerDestroyed(experienceId);$(document.getElementById(experienceId)).remove()})})};$.fn.videoOverlayCarousel=function(o){return this.each(function(){$(this).on("click",".videoLink",function(evt){var $this=$(this),isPlaylist=true,trackingType=o.trackingType,channelShortName=o.channelShortName,currentVideo=videoData(this),lightbox;evt.preventDefault();DM.pageEvents.fireEvent(DM.pageEvents.VIDEO_CAROUSEL_CLICKED,{pageMetadata:DM.getPageMetadata(),playlist:isPlaylist,trackingType:trackingType,channelShortName:channelShortName,videoId:currentVideo.videoId});lightbox=$this.data("modal");if(!lightbox){lightbox=$('<div class="ez-modal video-lightbox-container" aria-hidden="true" role="dialog"></div>').appendTo("body").ezmodal({ajaxUrl:$this.data("target")});$this.data("modal",lightbox);lightbox.one("ez-modal-after-open",function(evt){evt.ui.modal.videoOverlayPlayer(o)});lightbox.on("ez-modal-after-open",function(evt){var par=$.extend({},o,{nested:true,pageCount:Math.floor(lightbox.find(".videoLink").length/3).toString(),pageSize:3,trackingType:"carousel_triple",updateStyleOnHover:true,onPos:0});var $carousel_container=lightbox.find(".video_carousel_container");$carousel_container.attr("id",getId("video_carousel_container"));var vc=new DM.VideoChannelCarouselModule($carousel_container.attr("id"),par);var video=evt.ui.modal.find("[data-videoid="+currentVideo.videoId+"]");if(video.length){video.trigger("click",{loaded:true})}else{evt.ui.modal.find(".video-box").html('<div class="article">This video is not available anymore. Try clicking another video</div>')}});lightbox.on("ez-modal-after-open",function(evt){var viewportH=$(window).outerHeight(true),overlayH=lightbox.outerHeight(true),offsetH=(viewportH-overlayH)/2,y;if(offsetH<14){offsetH=14}y=$(window).scrollTop()+offsetH;lightbox.css("position","absolute");lightbox.css("top",y+"px")});lightbox.on("ez-modal-after-load",function(evt){evt.ui.modal.trigger({type:"ez-modal-article-load",lightbox:evt.ui.modal})});lightbox.on("ez-modal-article-load",function(evt){var abox=evt.lightbox.find(".article-box > .article"),aboxid;abox.attr("id")||abox.attr("id",getId("overlay_article"));$("#share-overlay .close").click();aboxid=abox.attr("id");DM.ShareLinks.init({id:aboxid,params:{zIndex:10000002,isChannel:true}})});lightbox.on("ez-modal-close",function(evt){$("#share-overlay .close").click()})}lightbox.ezmodal("open")})})};function xwVideoData(link){var $link=$(link);return{videoId:link.getAttribute("data-videoid"),source:link.getAttribute("data-source"),freewheelId:link.getAttribute("data-freewheelid"),title:$link.find(".video-item-title").text(),img:$link.find("img").attr("src"),href:link.href}}$.fn.videoExtraWide=function(o){return this.each(function(){var experienceId,isPlaylist=false,trackingType=o.trackingType,channelShortName=o.channelShortName,$carousel=$(this),currentVideo;var playerIdent;var playerKey;var rsi=o.rsi;function setVideoStill(playerType,container){if(playerType=="flash"){if(!$("#"+experienceId+"_title").length){$('<div id="'+experienceId+'_title" class="videoplayer-title-overlay">'+currentVideo.title+"</div>").appendTo(container)}if(!$("#"+experienceId+"_image").length){$('<img id= "'+experienceId+'_image" src="'+currentVideo.img+'" class="videoplayer-image-overlay" style="top: 15px" />').appendTo(container)}}}DM.pageEvents.listen(DM.pageEvents.VIDEO_PLAYER_READY,fiterEvent(function(observable,eventType,data){var container=$("#"+experienceId).parent();setVideoStill(data.playerType,container)}));DM.pageEvents.listen(DM.pageEvents.VIDEO_STREAM_STARTED,fiterEvent(function(observable,eventType,data){$("#"+experienceId+"_title").remove();$("#"+experienceId+"_image").remove()}));function fiterEvent(delegate){return function(observable,eventType,data){if(data.experienceId!==experienceId)return;delegate(observable,eventType,data)}}function createPlayer(continuePlayList){return DM.BC.createVideoPlayer({experienceId:experienceId,playerId:playerIdent,playerKey:playerKey,mediaId:currentVideo.videoId,title:currentVideo.title,source:currentVideo.source,isPlaylist:isPlaylist,trackingType:trackingType,channelShortName:channelShortName,continuePlayList:continuePlayList,rsi:rsi,linkBaseURL:currentVideo.href,videoChannel:currentVideo.channel,freewheelId:currentVideo.freewheelId})}var $playerCanvas=$(this).find(".videoplayer-large");$(this).on("click",".videoLink",function(evt){if(experienceId){DM.BC.playerDestroyed(experienceId)}evt.preventDefault();currentVideo=xwVideoData(this);experienceId=getId("video_channel_carousel_");if(o.videoPlayerConfigMap[currentVideo.videoId]==="false"){playerIdent=o.player;playerKey=o.playerKey}else{playerIdent=o.nonEmbeddablePlayerIdent;playerKey=o.nonEmbeddablePlayerKey}setTimeout(function(){brightcove.createExperiences()},200);$playerCanvas.html(createPlayer(false));DM.pageEvents.fireEvent(DM.pageEvents.VIDEO_CAROUSEL_CLICKED,{pageMetadata:DM.getPageMetadata(),playlist:false,trackingType:trackingType,channelShortName:channelShortName,videoId:currentVideo.videoId})})})};function onLightBoxOpen(){var container=this.defaultContainer;container.setWidth(620);container.setHeight(380);this.show()}function onLightBoxAfterOpen(){setTimeout(function(){brightcove.createExperiences()},200)}function onLightBoxClose(experienceId){DM.BC.playerDestroyed(experienceId)}$.fn.videoOverlay=function(o){var playlist=this.find(".videoLink").map(function(){return videoData(this)}).get();return this.each(function(){var experienceId,isPlaylist=true,trackingType=o.trackingType,channelShortName=o.channelShortName,playList,currentVideo;var playerIdent;var playerKey;var rsi=o.rsi;$(this).on("click",".videoLink",function(evt){var lightBox=DM.Lightbox.getInstance();evt.preventDefault();experienceId=getId("video_channel_carousel_");currentVideo=videoData(this);if(o.videoPlayerConfigMap){if(o.videoPlayerConfigMap[currentVideo.videoId]==="false"){playerIdent=o.player;playerKey=o.playerKey}else{playerIdent=o.nonEmbeddablePlayerIdent;playerKey=o.nonEmbeddablePlayerKey}}else{playerIdent=o.player;playerKey=o.playerKey}playList=playlist.slice(0);while(playList.length>0&&playList.shift().videoId!==currentVideo.videoId);DM.pageEvents.fireEvent(DM.pageEvents.VIDEO_CAROUSEL_CLICKED,{pageMetadata:DM.getPageMetadata(),playlist:isPlaylist,trackingType:trackingType,channelShortName:channelShortName,videoId:currentVideo.videoId});lightBox.overlay.on("click",lightBox.close,lightBox);lightBox.on("open",onLightBoxOpen,lightBox,{preventDefault:true,single:true});lightBox.on("afterOpen",onLightBoxAfterOpen,lightBox,{preventDefault:true,single:true});lightBox.on("close",function(){onLightBoxClose(experienceId)},lightBox,{preventDefault:true,single:true});var playerHtml=['<div style="width:636px; height:380px;">','<a href="#" class="f-12 close" style="float:right; margin:0 0 5px 0; width:14px; background:url(\'http://f.dailymail.co.uk/i/furniture/misc/close.gif\') right center no-repeat;">&nbsp;</a>',createPlayer(false),"</div>"].join("");lightBox.defaultContainer.dom.innerHTML=playerHtml;Ext.get(lightBox.defaultContainer.select("a.close").elements[0]).on("click",lightBox.close,lightBox,{preventDefault:true});lightBox.open();lightBox.fireEvent("open")});function setVideoStill(playerType,container){if(playerType=="flash"){if(currentVideo.title){if(!Ext.get(experienceId+"_title"))Ext.DomHelper.append(container,'<div id="'+experienceId+'_title" class="videoplayer-title-overlay">'+currentVideo.title+"</div>")}if(!Ext.get(experienceId+"_image"))Ext.DomHelper.append(container,'<img id= "'+experienceId+'_image" src="'+currentVideo.img+'" class="videoplayer-image-overlay" style="top: 15px" />')}}DM.pageEvents.listen(DM.pageEvents.VIDEO_CONTENT_COMPLETED,fiterEvent(function(observable,eventType,data){currentVideo=playList.shift();if(currentVideo){var container=Ext.get(experienceId).parent();container.update(createPlayer(true));setVideoStill(data.playerType,container);brightcove.createExperiences()}}));DM.pageEvents.listen(DM.pageEvents.VIDEO_PLAYER_READY,fiterEvent(function(observable,eventType,data){var container=Ext.get(experienceId).parent();setVideoStill(data.playerType,container)}));DM.pageEvents.listen(DM.pageEvents.VIDEO_STREAM_STARTED,fiterEvent(function(observable,eventType,data){var overlay=Ext.get(experienceId+"_title");if(overlay)overlay.remove();var overlayImg=Ext.get(experienceId+"_image");if(overlayImg)overlayImg.remove()}));function fiterEvent(delegate){return function(observable,eventType,data){if(data.experienceId!==experienceId)return;delegate(observable,eventType,data)}}function createPlayer(continuePlayList){return DM.BC.createVideoPlayer({experienceId:experienceId,playerId:playerIdent,playerKey:playerKey,mediaId:currentVideo.videoId,title:currentVideo.title,source:currentVideo.source,isPlaylist:isPlaylist,trackingType:trackingType,channelShortName:channelShortName,continuePlayList:continuePlayList,rsi:rsi,videoChannel:currentVideo.channel,freewheelId:currentVideo.freewheelId})}})}})(jQuery);DM.SCExternalLinks=function(id,params){$(document.getElementById(id)).find("a.js-tl").on("click",function(){DM.pageEvents.fireEvent(DM.pageEvents.PAGE_EXTERNAL_LINK_CLICKED,{pageMetadata:DM.getPageMetadata(),target:this,value:params.value})})};(function(DM,Ext){function onListItemMouseOverOrOut(eventObj,target,options){var y=eventObj.type=="mouseover"?0:110;Ext.fly(this.getElementsByTagName("span")[0]).animate({top:{to:y}},.45)}function forEachListItem(item,index,items){Ext.get(item).on({mouseover:onListItemMouseOverOrOut,mouseout:onListItemMouseOverOrOut})}function onDomReady(){var listItems=this.el.query("li"),p=this._params.params;Ext.each(listItems,forEachListItem);if(p.overlayType==="carousel"){$(this.el.dom).videoOverlayCarousel(p)}else{$(this.el.dom).videoOverlay(p)}if(this.events){this.on("changeEnd",onChangeEnd)}}function onChangeEnd(o){var el=o.cloned;forEachListItem(el)}DM.VideoCarousel=Ext.extend(DM.Carousel,{step:176,constructor:function(id,o){this._params={params:o};DM.RolloverCarousel.superclass.constructor.call(this,id);Ext.onReady(onDomReady,this,{single:true})}})})(DM,Ext);(function(DM,Ext){function onListItemMouseLeftOrRight(eventObj,target,options){function updatePosition(item,position){Ext.fly(item).animate({right:{to:position}},.45)}function updateStyleOnHoverOverOrLeave(classToRemove,classToAdd){Ext.fly(item).removeClass(classToRemove);Ext.fly(item).addClass(classToAdd)}function updateOnMouseOver(item,position,updateStyleOnHover){updatePosition(item,position);if(updateStyleOnHover)updateStyleOnHoverOverOrLeave("wocc","womlcc")}function updateOnMouseLeave(item,position,updateStyleOnHover){updatePosition(item,position);if(updateStyleOnHover)updateStyleOnHoverOverOrLeave("womlcc","wocc")}var item=Ext.get(this).child("span");eventObj.type=="mouseover"?updateOnMouseOver(item,options.onPos,options.updateStyleOnHover):updateOnMouseLeave(item,-options.styleRight,options.updateStyleOnHover)}function forEachLeftHandedListItem(item,index,items){var linkVideo=Ext.get(item).child("span");if(linkVideo!==null){this.styleRight=/(\d+)/.exec(linkVideo.getStyle("right"))[0];Ext.get(item).on({mouseover:{fn:onListItemMouseLeftOrRight,onPos:this._params.params.onPos,styleRight:this.styleRight,updateStyleOnHover:this._params.params.updateStyleOnHover},mouseout:{fn:onListItemMouseLeftOrRight,onPos:this._params.params.onPos,styleRight:this.styleRight,updateStyleOnHover:this._params.params.updateStyleOnHover}})}}function onDomReady(){var $node=$(this.el.dom),is_x_wide=$node.is(".x-wide"),listItems=this.el.query("a.videoLink"),p;if(is_x_wide){this._params.params.updateStyleOnHover=false}Ext.each(listItems,forEachLeftHandedListItem,this);p=this._params.params;if(is_x_wide){$node.videoExtraWide(p)}else{if(p.overlayType==="carousel"){if(!p.nested){$node.videoOverlayCarousel(p)}}else{$node.videoOverlay(p)}}if(this.events){this.on("changeEnd",onChangeEnd)}}function onChangeEnd(o){var el=o.cloned;forEachLeftHandedListItem(el)}DM.VideoChannelCarouselModule=Ext.extend(DM.Carousel,{activePage:1,styleRight:-90,constructor:function(id,o){this._params={params:o,id:id};DM.VideoChannelCarouselModule.superclass.constructor.call(this,id);this.container=Ext.get(id);this.panels=this.container.child(".rotator-panels");if(this.panels.dom.children.length===0)return;this.pages=this.container.child(".rotator-pages");this._setActivePageClass(1);Ext.onReady(onDomReady,this,{single:true});var item=this.panels.child("li");this.itemWidth=item.getWidth()+/(\d+)/.exec(item.getStyle("margin-right"))[0]*1;this._initEvents()},_setActivePageClass:function(page){var activeClass=this._params.params.activeClass||"selected";if(!this.pages)return;this.pages.select("li").each(function(li,idx){if(li.child("a").dom.getAttribute("data-page")==page)li.child("a").addClass(activeClass);else li.child("a").removeClass(activeClass)},this)},_initEvents:function(){if(!this.pages)return;this.pages.on("click",function(evt){evt.preventDefault();var page=evt.target.getAttribute("data-page");if(page>0)this.scrollTo(page*1)},this)},_move:function(e){var page=1;var pageCount=parseFloat(this._params.params.pageCount);if(e.getTarget(".js-move-next"))page=this.activePage>=pageCount?1:this.activePage+1;else page=this.activePage<=1?pageCount:this.activePage-1;this.scrollTo(page)},scrollTo:function(page){if(!!this._requestImages)this._requestImages();this.activePage=page;this._setActivePageClass(page);var offset=this.itemWidth*this._params.params.pageSize*(page-1)*-1;this.panels.stopFx(false);Ext.fly(this.panels).animate({left:{to:offset}},1.2)}})})(DM,Ext);(function(DM,Ext){function onDomReady(){var o=this._o;var listItems=Ext.get(Ext.get(o.id).select(o.params.selector?o.params.selector:".itemlist").elements[0]).select("li");o.params.channelShortName=Ext.get(o.id).dom.className.split(" ")[1];if(o.params.overlayType==="carousel"){$("#"+o.id).videoOverlayCarousel(o.params)}else{$("#"+o.id).videoOverlay(o.params)}}DM.MostWatchedVideoLightbox={init:function(o){if(Ext.get(o.id)){this._o=o;Ext.onReady(onDomReady,this,{single:true})}}}})(DM,Ext);(function(DM,Ext){function onDomReady(){var o=this._params;o.params.channelShortName=Ext.get(o.id).dom.className.split(" ")[1];$("#"+o.id).videoOverlayCarousel(o.params)}DM.VideoPreview=Ext.extend(Ext.util.Observable,{constructor:function(id,o){if(Ext.get(id)){this._params={params:o,id:id};Ext.onReady(onDomReady,this)}}})})(DM,Ext);(function(Ext){function onDomReady(){function updateOnHover(event,target,options){var item=Ext.get(this).child("span");event.type=="mouseover"?updateOnMouseover(item,options.onPos):updateOnMouseout(item,-options.styleRight)}function updatePosition(item,position){Ext.fly(item).animate({right:{to:position}},.45)}function updateOnMouseover(item,position){updatePosition(item,position)}function updateOnMouseout(item,position){updatePosition(item,position)}function addHoverHandler(item){var linkVideo=item.child("span");if(linkVideo!==null){this.styleRight=/(\d+)/.exec(linkVideo.getStyle("right"))[0];item.on({mouseover:{fn:updateOnHover,onPos:0,styleRight:this.styleRight},mouseout:{fn:updateOnHover,onPos:0,styleRight:this.styleRight}})}}Ext.select(".videoplayer-preview a").each(function(item){addHoverHandler(item)})}Ext.onReady(onDomReady,this,{single:true})})(Ext);(function(DM,Ext){DM.NextStory={init:function(o){var el=Ext.get(o.id);if(!el)return;this.el=el;Ext.EventManager.on(window,"scroll",this.toggle,this)},toggle:function(){var w=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;this.showAt=this.showAt||Ext.get(Ext.query("div[class=shareArticles]")[0]);this.container=this.container||Ext.get("content");if(Ext.getBody().getScroll().top+h>=this.showAt.getY()&&h>=this.el.getHeight()&&this.container.getX()>=this.el.getWidth()+15&&w>=this.el.getHeight()&&Ext.getBody().getStyle("background-image")=="none"){this.el.addClass("show")}else{this.el.removeClass("show")}}}})(DM,Ext);(function(root,factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{root.DM.InfiniteList=factory($)}})(this,function($){var InfiniteList={init:function(o){var el=$("#"+o.id),that=this;this.$scrollableContent=$(".scrollable-content");if(this.$scrollableContent.length===0){this.$scrollableContent=$(window)}if(!el)return;that.params=o.params||{};that.page=typeof o.params.from==="undefined"?1:o.params.from;that.loadAt=el.find("a[class=more]").eq(0);that.doDots=that.params.truncate&&typeof $.fn.dotdotdot==="function";that.onAfterAppend=that.params.onAfterAppend;var scrollHandler=function(){that.load()};that.$scrollableContent.on("scroll.infinite-scroll",scrollHandler);that.ids=[];el.find("[data-id]").each(function(index,a){that.ids.push($(a).attr("data-id"))});if(that.doDots)el.find(that.params.truncate).dotdotdot()},load:function(){var h=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,that=this;if(!that.isLoading&&that.$scrollableContent.scrollTop()+h>=that.loadAt.offset().top){that.loadAt.addClass("show");$.ajax({url:that.params.url+"&page="+that.page,cache:false,beforeSend:function(){that.isLoading=true},complete:function(){that.isLoading=false},success:function(response,opts){var container=$("<div></div>").addClass("just loaded").html(response).insertBefore(that.loadAt);container.find("[data-id]").each(function(index,a){var id=$(a).attr("data-id");if(that.ids.indexOf(id)>-1){$(a).remove()}else{that.ids.push(id)}});if(that.onAfterAppend){that.onAfterAppend(container.get(0))}if(that.doDots)container.find(that.params.truncate).dotdotdot();setTimeout(function(){container.removeClass("just")},100);that.loadAt.removeClass("show");that.page+=1;if(that.page>=that.params.total){that.$scrollableContent.off("scroll.infinite-scroll")}},error:function(){}})}}};$.fn.infiniteList=function(options){return this.each(function(){InfiniteList.init({id:this.id,params:options})})};return InfiniteList});(function($){DM.later(["DOM_READY"],function(){var $bydaywrapper=$(".articles_by_day_wrapper");if(!$bydaywrapper.length){return}$bydaywrapper.find(".checkbox input").change(function(){if($(this).attr("id")=="all"){$bydaywrapper.find(".checkbox input").prop("checked",$(this).prop("checked"))}else if(!$(this).prop("checked")){$bydaywrapper.find("#all").prop("checked",false)}$bydaywrapper.find(".checkbox input").each(function(){var value=$(this).attr("value"),sel=value===""?"li":"li."+value;if($(this).prop("checked")){$bydaywrapper.find(sel).show()}else{$bydaywrapper.find(sel).hide()}})})})})(jQuery);function Swipe(container,options){"use strict";var touchEnabled=true;var noop=function(){};var offloadFn=function(fn){setTimeout(fn||noop,0)};var browser={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,pointer:window.navigator.msPointerEnabled,transitions:function(temp){var props=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var i in props)if(temp.style[props[i]]!==undefined)return true;return false}(document.createElement("swipe"))};if(!container)return;var element=container.children[0];var slides,slidePos,width,length;options=options||{};var index=parseInt(options.startSlide,10)||0;var speed=options.speed||300;options.continuous=options.continuous!==undefined?options.continuous:true;if(browser.pointer)container.style.msTouchAction="none";function setup(){slides=element.children;length=slides.length;if(slides.length<2)options.continuous=false;if(browser.transitions&&options.continuous&&slides.length<3){element.appendChild(slides[0].cloneNode(true));element.appendChild(element.children[1].cloneNode(true));slides=element.children}slidePos=new Array(slides.length);width=container.getBoundingClientRect().width||container.offsetWidth;element.style.width=slides.length*width+"px";var pos=slides.length;while(pos--){var slide=slides[pos];slide.style.width=width+"px";slide.setAttribute("data-index",pos);if(browser.transitions){slide.style.left=pos*-width+"px";move(pos,index>pos?-width:index<pos?width:0,0)}}if(options.continuous&&browser.transitions){move(circle(index-1),-width,0);move(circle(index+1),width,0)}if(!browser.transitions)element.style.left=index*-width+"px";container.style.visibility="visible"}function prev(){if(options.continuous)slide(index-1);else if(index)slide(index-1)}function next(){if(options.continuous)slide(index+1);else if(index<slides.length-1)slide(index+1)}function circle(index){return(slides.length+index%slides.length)%slides.length}function slide(to,slideSpeed){if(index==to)return;if(browser.transitions){var direction=Math.abs(index-to)/(index-to);if(options.continuous){var natural_direction=direction;direction=-slidePos[circle(to)]/width;if(direction!==natural_direction)to=-direction*slides.length+to}var diff=Math.abs(index-to)-1;while(diff--)move(circle((to>index?to:index)-diff-1),width*direction,0);to=circle(to);move(index,width*direction,slideSpeed||speed);move(to,0,slideSpeed||speed);if(options.continuous)move(circle(to-direction),-(width*direction),0)}else{to=circle(to);animate(index*-width,to*-width,slideSpeed||speed)}index=to;offloadFn(options.callback&&options.callback(index,slides[index]))}function move(index,dist,speed){translate(index,dist,speed);slidePos[index]=dist}function translate(index,dist,speed){var slide=slides[index];var style=slide&&slide.style;if(!style)return;style.webkitTransitionDuration=style.MozTransitionDuration=style.msTransitionDuration=style.OTransitionDuration=style.transitionDuration=speed+"ms";style.webkitTransform="translate("+dist+"px,0)"+"translateZ(0)";style.msTransform=style.MozTransform=style.OTransform="translateX("+dist+"px)"}function animate(from,to,speed){if(!speed){element.style.left=to+"px";return}var start=+new Date;var timer=setInterval(function(){var timeElap=+new Date-start;if(timeElap>speed){element.style.left=to+"px";if(delay)begin();options.transitionEnd&&options.transitionEnd.call(event,index,slides[index]);clearInterval(timer);return}element.style.left=(to-from)*(Math.floor(timeElap/speed*100)/100)+from+"px"},4)}var delay=options.auto||0;var interval;function begin(){interval=setTimeout(next,delay)}function stop(){delay=0;clearTimeout(interval)}var linkHandler={preventDefault:function(e){e.preventDefault()},toggleOffPreventClick:function(){var links=element.getElementsByTagName("a");for(var i=0;i<links.length;i++){links[i].removeEventListener("click",this.preventDefault,false)}},toggleOnPreventClick:function(){var links=element.getElementsByTagName("a");for(var i=0;i<links.length;i++){links[i].addEventListener("click",this.preventDefault,false)}}};var start={};var delta={};var isScrolling;var resizeFired;var events={handleEvent:function(event){switch(event.type){case"touchstart":this.start(event);break;case"touchmove":this.move(event);break;case"touchend":offloadFn(this.end(event));break;case"MSPointerDown":this.start(event);break;case"MSPointerMove":this.move(event);if(delta.x){linkHandler.toggleOnPreventClick()}break;case"MSPointerUp":offloadFn(this.end(event));break;case"webkitTransitionEnd":case"msTransitionEnd":
case"oTransitionEnd":case"otransitionend":case"transitionend":offloadFn(this.transitionEnd(event));linkHandler.toggleOffPreventClick();break;case"resize":resizeFired=true;offloadFn(setup.call());break;case"orientationchange":resizeFired=false;setTimeout(function(){if(!resizeFired){setup.call()}},1e3);break}if(options.stopPropagation)event.stopPropagation()},start:function(event){if(!touchEnabled)return;if(!browser.pointer)var touches=event.touches[0];start={x:!browser.pointer?touches.pageX:event.pageX||event.clientX,y:!browser.pointer?touches.pageY:event.pageY||event.clientY,time:+new Date};isScrolling=undefined;delta={};if(!browser.pointer){element.addEventListener("touchmove",this,false);element.addEventListener("touchend",this,false)}else{element.addEventListener("MSPointerMove",this,false);element.addEventListener("MSPointerUp",this,false)}},move:function(event){if(!touchEnabled)return;if(!browser.pointer&&event.touches.length>1||event.scale&&event.scale!==1)return;if(options.disableScroll)event.preventDefault();if(!browser.pointer)var touches=event.touches[0];var pageX=!browser.pointer?touches.pageX:event.pageX||event.clientX;var pageY=!browser.pointer?touches.pageY:event.pageY||event.clientY;delta={x:pageX-start.x,y:pageY-start.y};if(typeof isScrolling=="undefined"){isScrolling=!!(isScrolling||Math.abs(delta.x)<Math.abs(delta.y))}if(!isScrolling){event.preventDefault();stop();if(options.continuous){translate(circle(index-1),delta.x+slidePos[circle(index-1)],0);translate(index,delta.x+slidePos[index],0);translate(circle(index+1),delta.x+slidePos[circle(index+1)],0)}else{delta.x=delta.x/(!index&&delta.x>0||index==slides.length-1&&delta.x<0?Math.abs(delta.x)/width+1:1);translate(index-1,delta.x+slidePos[index-1],0);translate(index,delta.x+slidePos[index],0);translate(index+1,delta.x+slidePos[index+1],0)}}},end:function(event){if(!touchEnabled)return;var duration=+new Date-start.time;var isValidSlide=Number(duration)<250&&Math.abs(delta.x)>20||Math.abs(delta.x)>width/2;var isPastBounds=!index&&delta.x>0||index==slides.length-1&&delta.x<0;if(options.continuous)isPastBounds=false;var direction=delta.x<0;if(!isScrolling){if(isValidSlide&&!isPastBounds){event.stopPropagation();if(direction){if(options.continuous){move(circle(index-1),-width,0);move(circle(index+2),width,0)}else{move(index-1,-width,0)}move(index,slidePos[index]-width,speed);move(circle(index+1),slidePos[circle(index+1)]-width,speed);index=circle(index+1)}else{if(options.continuous){move(circle(index+1),width,0);move(circle(index-2),-width,0)}else{move(index+1,width,0)}move(index,slidePos[index]+width,speed);move(circle(index-1),slidePos[circle(index-1)]+width,speed);index=circle(index-1)}options.callback&&options.callback(index,slides[index])}else{if(options.continuous){move(circle(index-1),-width,speed);move(index,0,speed);move(circle(index+1),width,speed)}else{move(index-1,-width,speed);move(index,0,speed);move(index+1,width,speed)}}}if(!browser.pointer){element.removeEventListener("touchmove",events,false);element.removeEventListener("touchend",events,false)}else{element.removeEventListener("MSPointerMove",events,false);element.removeEventListener("MSPointerUp",events,false)}},transitionEnd:function(event){if(parseInt(event.target.getAttribute("data-index"),10)==index){if(delay)begin();options.transitionEnd&&options.transitionEnd.call(event,index,slides[index])}}};setup();if(delay)begin();if(browser.addEventListener){if(browser.touch)element.addEventListener("touchstart",events,false);if(browser.pointer)element.addEventListener("MSPointerDown",events,false);if(browser.transitions){element.addEventListener("webkitTransitionEnd",events,false);element.addEventListener("msTransitionEnd",events,false);element.addEventListener("oTransitionEnd",events,false);element.addEventListener("otransitionend",events,false);element.addEventListener("transitionend",events,false)}window.addEventListener("resize",events,false);window.addEventListener("orientationchange",events,false)}else{window.onresize=function(){setup()}}return{setup:function(){setup()},slide:function(to,speed){stop();slide(to,speed)},prev:function(){stop();prev()},next:function(){stop();next()},getPos:function(){return index},getNumSlides:function(){return length},disableTouch:function(){touchEnabled=false},enableTouch:function(){touchEnabled=true},kill:function(){stop();element.style.width="auto";element.style.left=0;var pos=slides.length;while(pos--){var slide=slides[pos];slide.style.width="100%";slide.style.left=0;if(browser.transitions)translate(pos,0,0)}if(browser.addEventListener){element.removeEventListener("touchstart",events,false);element.removeEventListener("MSPointerDown",events,false);element.removeEventListener("webkitTransitionEnd",events,false);element.removeEventListener("msTransitionEnd",events,false);element.removeEventListener("oTransitionEnd",events,false);element.removeEventListener("otransitionend",events,false);element.removeEventListener("transitionend",events,false);window.removeEventListener("resize",events,false);window.removeEventListener("orientationchange",events,false)}else{window.onresize=null}}}}if(window.jQuery||window.Zepto){(function($){$.fn.Swipe=function(params){return this.each(function(){$(this).data("Swipe",new Swipe($(this)[0],params))})}})(window.jQuery||window.Zepto)}(function(window,undefined){"use strict";var Hammer=function(element,options){return new Hammer.Instance(element,options||{})};Hammer.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};Hammer.HAS_POINTEREVENTS=window.navigator.pointerEnabled||window.navigator.msPointerEnabled;Hammer.HAS_TOUCHEVENTS="ontouchstart"in window;Hammer.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i;Hammer.NO_MOUSEEVENTS=Hammer.HAS_TOUCHEVENTS&&window.navigator.userAgent.match(Hammer.MOBILE_REGEX);Hammer.EVENT_TYPES={};Hammer.DIRECTION_DOWN="down";Hammer.DIRECTION_LEFT="left";Hammer.DIRECTION_UP="up";Hammer.DIRECTION_RIGHT="right";Hammer.POINTER_MOUSE="mouse";Hammer.POINTER_TOUCH="touch";Hammer.POINTER_PEN="pen";Hammer.EVENT_START="start";Hammer.EVENT_MOVE="move";Hammer.EVENT_END="end";Hammer.DOCUMENT=window.document;Hammer.plugins=Hammer.plugins||{};Hammer.gestures=Hammer.gestures||{};Hammer.READY=false;function setup(){if(Hammer.READY){return}Hammer.event.determineEventTypes();for(var name in Hammer.gestures){if(Hammer.gestures.hasOwnProperty(name)){Hammer.detection.register(Hammer.gestures[name])}}Hammer.event.onTouch(Hammer.DOCUMENT,Hammer.EVENT_MOVE,Hammer.detection.detect);Hammer.event.onTouch(Hammer.DOCUMENT,Hammer.EVENT_END,Hammer.detection.detect);Hammer.READY=true}Hammer.Instance=function(element,options){var self=this;setup();this.element=element;this.enabled=true;this.options=Hammer.utils.extend(Hammer.utils.extend({},Hammer.defaults),options||{});if(this.options.stop_browser_behavior){Hammer.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior)}Hammer.event.onTouch(element,Hammer.EVENT_START,function(ev){if(self.enabled){Hammer.detection.startDetect(self,ev)}});return this};Hammer.Instance.prototype={on:function onEvent(gesture,handler){var gestures=gesture.split(" ");for(var t=0;t<gestures.length;t++){this.element.addEventListener(gestures[t],handler,false)}return this},off:function offEvent(gesture,handler){var gestures=gesture.split(" ");for(var t=0;t<gestures.length;t++){this.element.removeEventListener(gestures[t],handler,false)}return this},trigger:function triggerEvent(gesture,eventData){if(!eventData){eventData={}}var event=Hammer.DOCUMENT.createEvent("Event");event.initEvent(gesture,true,true);event.gesture=eventData;var element=this.element;if(Hammer.utils.hasParent(eventData.target,element)){element=eventData.target}element.dispatchEvent(event);return this},enable:function enable(state){this.enabled=state;return this}};var last_move_event=null;var enable_detect=false;var touch_triggered=false;Hammer.event={bindDom:function(element,type,handler){var types=type.split(" ");for(var t=0;t<types.length;t++){element.addEventListener(types[t],handler,false)}},onTouch:function onTouch(element,eventType,handler){var self=this;this.bindDom(element,Hammer.EVENT_TYPES[eventType],function bindDomOnTouch(ev){var sourceEventType=ev.type.toLowerCase();if(sourceEventType.match(/mouse/)&&touch_triggered){return}else if(sourceEventType.match(/touch/)||sourceEventType.match(/pointerdown/)||sourceEventType.match(/mouse/)&&ev.which===1){enable_detect=true}else if(sourceEventType.match(/mouse/)&&ev.which!==1){enable_detect=false}if(sourceEventType.match(/touch|pointer/)){touch_triggered=true}var count_touches=0;if(enable_detect){if(Hammer.HAS_POINTEREVENTS&&eventType!=Hammer.EVENT_END){count_touches=Hammer.PointerEvent.updatePointer(eventType,ev)}else if(sourceEventType.match(/touch/)){count_touches=ev.touches.length}else if(!touch_triggered){count_touches=sourceEventType.match(/up/)?0:1}if(count_touches>0&&eventType==Hammer.EVENT_END){eventType=Hammer.EVENT_MOVE}else if(!count_touches){eventType=Hammer.EVENT_END}if(count_touches||last_move_event===null){last_move_event=ev}handler.call(Hammer.detection,self.collectEventData(element,eventType,self.getTouchList(last_move_event,eventType),ev));if(Hammer.HAS_POINTEREVENTS&&eventType==Hammer.EVENT_END){count_touches=Hammer.PointerEvent.updatePointer(eventType,ev)}}if(!count_touches){last_move_event=null;enable_detect=false;touch_triggered=false;Hammer.PointerEvent.reset()}})},determineEventTypes:function determineEventTypes(){var types;if(Hammer.HAS_POINTEREVENTS){types=Hammer.PointerEvent.getEvents()}else if(Hammer.NO_MOUSEEVENTS){types=["touchstart","touchmove","touchend touchcancel"]}else{types=["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"]}Hammer.EVENT_TYPES[Hammer.EVENT_START]=types[0];Hammer.EVENT_TYPES[Hammer.EVENT_MOVE]=types[1];Hammer.EVENT_TYPES[Hammer.EVENT_END]=types[2]},getTouchList:function getTouchList(ev){if(Hammer.HAS_POINTEREVENTS){return Hammer.PointerEvent.getTouchList()}else if(ev.touches){return ev.touches}else{ev.indentifier=1;return[ev]}},collectEventData:function collectEventData(element,eventType,touches,ev){var pointerType=Hammer.POINTER_TOUCH;if(ev.type.match(/mouse/)||Hammer.PointerEvent.matchType(Hammer.POINTER_MOUSE,ev)){pointerType=Hammer.POINTER_MOUSE}return{center:Hammer.utils.getCenter(touches),timeStamp:(new Date).getTime(),target:ev.target,touches:touches,eventType:eventType,pointerType:pointerType,srcEvent:ev,preventDefault:function(){if(this.srcEvent.preventManipulation){this.srcEvent.preventManipulation()}if(this.srcEvent.preventDefault){this.srcEvent.preventDefault()}},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return Hammer.detection.stopDetect()}}}};Hammer.PointerEvent={pointers:{},getTouchList:function(){var self=this;var touchlist=[];Object.keys(self.pointers).sort().forEach(function(id){touchlist.push(self.pointers[id])});return touchlist},updatePointer:function(type,pointerEvent){if(type==Hammer.EVENT_END){this.pointers={}}else{pointerEvent.identifier=pointerEvent.pointerId;this.pointers[pointerEvent.pointerId]=pointerEvent}return Object.keys(this.pointers).length},matchType:function(pointerType,ev){if(!ev.pointerType){return false}var types={};types[Hammer.POINTER_MOUSE]=ev.pointerType==ev.MSPOINTER_TYPE_MOUSE||ev.pointerType==Hammer.POINTER_MOUSE;types[Hammer.POINTER_TOUCH]=ev.pointerType==ev.MSPOINTER_TYPE_TOUCH||ev.pointerType==Hammer.POINTER_TOUCH;types[Hammer.POINTER_PEN]=ev.pointerType==ev.MSPOINTER_TYPE_PEN||ev.pointerType==Hammer.POINTER_PEN;return types[pointerType]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}};Hammer.utils={extend:function extend(dest,src,merge){for(var key in src){if(dest[key]!==undefined&&merge){continue}dest[key]=src[key]}return dest},hasParent:function(node,parent){while(node){if(node==parent){return true}node=node.parentNode}return false},getCenter:function getCenter(touches){var valuesX=[],valuesY=[],touch;for(var t=0,len=touches.length;t<len;t++){touch=touches[t];valuesX.push(typeof touch.clientX!=="undefined"?touch.clientX:touch.pageX);valuesY.push(typeof touch.clientY!=="undefined"?touch.clientY:touch.pageY)}return{pageX:(Math.min.apply(Math,valuesX)+Math.max.apply(Math,valuesX))/2,pageY:(Math.min.apply(Math,valuesY)+Math.max.apply(Math,valuesY))/2}},getVelocity:function getVelocity(delta_time,delta_x,delta_y){return{x:Math.abs(delta_x/delta_time)||0,y:Math.abs(delta_y/delta_time)||0}},getAngle:function getAngle(touch1,touch2){var y=touch2.pageY-touch1.pageY,x=touch2.pageX-touch1.pageX;return Math.atan2(y,x)*180/Math.PI},getDirection:function getDirection(touch1,touch2){var x=Math.abs(touch1.pageX-touch2.pageX),y=Math.abs(touch1.pageY-touch2.pageY);if(x>=y){return touch1.pageX-touch2.pageX>0?Hammer.DIRECTION_LEFT:Hammer.DIRECTION_RIGHT}else{return touch1.pageY-touch2.pageY>0?Hammer.DIRECTION_UP:Hammer.DIRECTION_DOWN}},getDistance:function getDistance(touch1,touch2){var x=touch2.pageX-touch1.pageX,y=touch2.pageY-touch1.pageY;return Math.sqrt(x*x+y*y)},getScale:function getScale(start,end){if(start.length>=2&&end.length>=2){return this.getDistance(end[0],end[1])/this.getDistance(start[0],start[1])}return 1},getRotation:function getRotation(start,end){if(start.length>=2&&end.length>=2){return this.getAngle(end[1],end[0])-this.getAngle(start[1],start[0])}return 0},isVertical:function isVertical(direction){return direction==Hammer.DIRECTION_UP||direction==Hammer.DIRECTION_DOWN},stopDefaultBrowserBehavior:function stopDefaultBrowserBehavior(element,css_props){var prop,vendors=["webkit","khtml","moz","Moz","ms","o",""];if(!css_props||!element.style){return}for(var i=0;i<vendors.length;i++){for(var p in css_props){if(css_props.hasOwnProperty(p)){prop=p;if(vendors[i]){prop=vendors[i]+prop.substring(0,1).toUpperCase()+prop.substring(1)}element.style[prop]=css_props[p]}}}if(css_props.userSelect=="none"){element.onselectstart=function(){return false}}if(css_props.userDrag=="none"){element.ondragstart=function(){return false}}}};Hammer.detection={gestures:[],current:null,previous:null,stopped:false,startDetect:function startDetect(inst,eventData){this.stopped=false;this.current={inst:inst,startEvent:Hammer.utils.extend({},eventData),lastEvent:false,name:""};this.detect(eventData)},detect:function detect(eventData){if(!this.current||this.stopped){return}eventData=this.extendEventData(eventData);var inst_options=this.current.inst.options;for(var g=0,len=this.gestures.length;g<len;g++){var gesture=this.gestures[g];if(!this.stopped&&inst_options[gesture.name]!==false){if(gesture.handler.call(gesture,eventData,this.current.inst)===false){this.stopDetect();break}}}if(this.current){this.current.lastEvent=eventData}if(eventData.eventType==Hammer.EVENT_END&&!eventData.touches.length-1){this.stopDetect()}return eventData},stopDetect:function stopDetect(){this.previous=Hammer.utils.extend({},this.current);this.current=null;this.stopped=true},extendEventData:function extendEventData(ev){var startEv=this.current.startEvent;if(startEv&&(ev.touches.length!=startEv.touches.length||ev.touches===startEv.touches)){startEv.touches=[];for(var i=0,len=ev.touches.length;i<len;i++){startEv.touches.push(Hammer.utils.extend({},ev.touches[i]))}}var delta_time=ev.timeStamp-startEv.timeStamp,delta_x=ev.center.pageX-startEv.center.pageX,delta_y=ev.center.pageY-startEv.center.pageY,velocity=Hammer.utils.getVelocity(delta_time,delta_x,delta_y),interimAngle,interimDirection;if(ev.eventType==="end"){interimAngle=this.current.lastEvent&&this.current.lastEvent.interimAngle;interimDirection=this.current.lastEvent&&this.current.lastEvent.interimDirection}else{interimAngle=this.current.lastEvent&&Hammer.utils.getAngle(this.current.lastEvent.center,ev.center);interimDirection=this.current.lastEvent&&Hammer.utils.getDirection(this.current.lastEvent.center,ev.center)}Hammer.utils.extend(ev,{deltaTime:delta_time,deltaX:delta_x,deltaY:delta_y,velocityX:velocity.x,velocityY:velocity.y,distance:Hammer.utils.getDistance(startEv.center,ev.center),angle:Hammer.utils.getAngle(startEv.center,ev.center),interimAngle:interimAngle,direction:Hammer.utils.getDirection(startEv.center,ev.center),interimDirection:interimDirection,scale:Hammer.utils.getScale(startEv.touches,ev.touches),rotation:Hammer.utils.getRotation(startEv.touches,ev.touches),startEvent:startEv});return ev},register:function register(gesture){var options=gesture.defaults||{};if(options[gesture.name]===undefined){options[gesture.name]=true}Hammer.utils.extend(Hammer.defaults,options,true);gesture.index=gesture.index||1e3;this.gestures.push(gesture);this.gestures.sort(function(a,b){if(a.index<b.index){return-1}if(a.index>b.index){return 1}return 0});return this.gestures}};Hammer.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:true,drag_max_touches:1,drag_block_horizontal:false,drag_block_vertical:false,drag_lock_to_axis:false,drag_lock_min_distance:25},triggered:false,handler:function dragGesture(ev,inst){if(Hammer.detection.current.name!=this.name&&this.triggered){inst.trigger(this.name+"end",ev);this.triggered=false;return}if(inst.options.drag_max_touches>0&&ev.touches.length>inst.options.drag_max_touches){return}switch(ev.eventType){case Hammer.EVENT_START:this.triggered=false;break;case Hammer.EVENT_MOVE:if(ev.distance<inst.options.drag_min_distance&&Hammer.detection.current.name!=this.name){return}if(Hammer.detection.current.name!=this.name){Hammer.detection.current.name=this.name;if(inst.options.correct_for_drag_min_distance&&ev.distance>0){var factor=Math.abs(inst.options.drag_min_distance/ev.distance);Hammer.detection.current.startEvent.center.pageX+=ev.deltaX*factor;Hammer.detection.current.startEvent.center.pageY+=ev.deltaY*factor;ev=Hammer.detection.extendEventData(ev)}}if(Hammer.detection.current.lastEvent.drag_locked_to_axis||inst.options.drag_lock_to_axis&&inst.options.drag_lock_min_distance<=ev.distance){ev.drag_locked_to_axis=true}var last_direction=Hammer.detection.current.lastEvent.direction;if(ev.drag_locked_to_axis&&last_direction!==ev.direction){if(Hammer.utils.isVertical(last_direction)){ev.direction=ev.deltaY<0?Hammer.DIRECTION_UP:Hammer.DIRECTION_DOWN}else{ev.direction=ev.deltaX<0?Hammer.DIRECTION_LEFT:Hammer.DIRECTION_RIGHT}}if(!this.triggered){inst.trigger(this.name+"start",ev);this.triggered=true}inst.trigger(this.name,ev);inst.trigger(this.name+ev.direction,ev);if(inst.options.drag_block_vertical&&Hammer.utils.isVertical(ev.direction)||inst.options.drag_block_horizontal&&!Hammer.utils.isVertical(ev.direction)){ev.preventDefault()}break;case Hammer.EVENT_END:if(this.triggered){inst.trigger(this.name+"end",ev)}this.triggered=false;break}}};Hammer.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function holdGesture(ev,inst){switch(ev.eventType){case Hammer.EVENT_START:clearTimeout(this.timer);Hammer.detection.current.name=this.name;this.timer=setTimeout(function(){if(Hammer.detection.current.name=="hold"){inst.trigger("hold",ev)}},inst.options.hold_timeout);break;case Hammer.EVENT_MOVE:if(ev.distance>inst.options.hold_threshold){clearTimeout(this.timer)}break;case Hammer.EVENT_END:clearTimeout(this.timer);break}}};Hammer.gestures.Release={name:"release",index:Infinity,handler:function releaseGesture(ev,inst){if(ev.eventType==Hammer.EVENT_END){inst.trigger(this.name,ev)}}};Hammer.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function swipeGesture(ev,inst){if(ev.eventType==Hammer.EVENT_END){if(inst.options.swipe_max_touches>0&&ev.touches.length<inst.options.swipe_min_touches&&ev.touches.length>inst.options.swipe_max_touches){return}if(ev.velocityX>inst.options.swipe_velocity||ev.velocityY>inst.options.swipe_velocity){inst.trigger(this.name,ev);inst.trigger(this.name+ev.direction,ev)}}}};Hammer.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:true,doubletap_distance:20,doubletap_interval:300},handler:function tapGesture(ev,inst){if(ev.eventType==Hammer.EVENT_END&&ev.srcEvent.type!="touchcancel"){var prev=Hammer.detection.previous,did_doubletap=false;if(ev.deltaTime>inst.options.tap_max_touchtime||ev.distance>inst.options.tap_max_distance){return}if(prev&&prev.name=="tap"&&ev.timeStamp-prev.lastEvent.timeStamp<inst.options.doubletap_interval&&ev.distance<inst.options.doubletap_distance){inst.trigger("doubletap",ev);did_doubletap=true}if(!did_doubletap||inst.options.tap_always){Hammer.detection.current.name="tap";inst.trigger(Hammer.detection.current.name,ev)}}}};Hammer.gestures.Touch={name:"touch",index:-Infinity,defaults:{prevent_default:false,prevent_mouseevents:false},handler:function touchGesture(ev,inst){if(inst.options.prevent_mouseevents&&ev.pointerType==Hammer.POINTER_MOUSE){ev.stopDetect();return}if(inst.options.prevent_default){ev.preventDefault()}if(ev.eventType==Hammer.EVENT_START){inst.trigger(this.name,ev)}}};Hammer.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:false},triggered:false,handler:function transformGesture(ev,inst){if(Hammer.detection.current.name!=this.name&&this.triggered){inst.trigger(this.name+"end",ev);this.triggered=false;return}if(ev.touches.length<2){return}if(inst.options.transform_always_block){ev.preventDefault()}switch(ev.eventType){case Hammer.EVENT_START:this.triggered=false;break;case Hammer.EVENT_MOVE:var scale_threshold=Math.abs(1-ev.scale);var rotation_threshold=Math.abs(ev.rotation);if(scale_threshold<inst.options.transform_min_scale&&rotation_threshold<inst.options.transform_min_rotation){return}Hammer.detection.current.name=this.name;if(!this.triggered){inst.trigger(this.name+"start",ev);this.triggered=true}inst.trigger(this.name,ev);if(rotation_threshold>inst.options.transform_min_rotation){inst.trigger("rotate",ev)}if(scale_threshold>inst.options.transform_min_scale){inst.trigger("pinch",ev);inst.trigger("pinch"+(ev.scale<1?"in":"out"),ev)}break;case Hammer.EVENT_END:if(this.triggered){inst.trigger(this.name+"end",ev)}this.triggered=false;break}}};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define(function(){return Hammer})}else if(typeof module==="object"&&typeof module.exports==="object"){module.exports=Hammer}else{window.Hammer=Hammer}})(this);(function(window,undefined){"use strict";function setup(Hammer,$){Hammer.event.bindDom=function(element,eventTypes,handler){$(element).on(eventTypes,function(ev){var data=ev.originalEvent||ev;if(data.pageX===undefined){data.pageX=ev.pageX;data.pageY=ev.pageY}if(!data.target){data.target=ev.target}if(data.which===undefined){data.which=data.button}if(!data.preventDefault){data.preventDefault=ev.preventDefault}if(!data.stopPropagation){data.stopPropagation=ev.stopPropagation}handler.call(this,data)})};Hammer.Instance.prototype.on=function(types,handler){return $(this.element).on(types,handler)};Hammer.Instance.prototype.off=function(types,handler){return $(this.element).off(types,handler)};Hammer.Instance.prototype.trigger=function(gesture,eventData){var el=$(this.element);if(el.has(eventData.target).length){el=$(eventData.target)}return el.trigger({type:gesture,gesture:eventData})};$.fn.hammer=function(options){return this.each(function(){var el=$(this);var inst=el.data("hammer");if(!inst){el.data("hammer",new Hammer(this,options||{}))}else if(inst&&options){Hammer.utils.extend(inst.options,options)}})}}if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define(["hammer","jquery"],setup)}else{setup(window.Hammer,window.jQuery||window.Zepto)}})(this);(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else if(typeof exports==="object"){module.exports=factory}else{factory(jQuery)}})(function($){var toFix=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],toBind="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],slice=Array.prototype.slice,nullLowestDeltaTimeout,lowestDelta;if($.event.fixHooks){for(var i=toFix.length;i;){$.event.fixHooks[toFix[--i]]=$.event.mouseHooks}}var special=$.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener){for(var i=toBind.length;i;){this.addEventListener(toBind[--i],handler,false)}}else{this.onmousewheel=handler}$.data(this,"mousewheel-line-height",special.getLineHeight(this));$.data(this,"mousewheel-page-height",special.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var i=toBind.length;i;){this.removeEventListener(toBind[--i],handler,false)}}else{this.onmousewheel=null}$.removeData(this,"mousewheel-line-height");$.removeData(this,"mousewheel-page-height")},getLineHeight:function(elem){var $elem=$(elem),$parent=$elem["offsetParent"in $.fn?"offsetParent":"parent"]();if(!$parent.length){$parent=$("body")}return parseInt($parent.css("fontSize"),10)||parseInt($elem.css("fontSize"),10)||16},getPageHeight:function(elem){return $(elem).height()},settings:{adjustOldDeltas:true,normalizeOffset:true}};$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel")},unmousewheel:function(fn){return this.unbind("mousewheel",fn)}});function handler(event){var orgEvent=event||window.event,args=slice.call(arguments,1),delta=0,deltaX=0,deltaY=0,absDelta=0,offsetX=0,offsetY=0;event=$.event.fix(orgEvent);event.type="mousewheel";if("detail"in orgEvent){deltaY=orgEvent.detail*-1}if("wheelDelta"in orgEvent){deltaY=orgEvent.wheelDelta}if("wheelDeltaY"in orgEvent){deltaY=orgEvent.wheelDeltaY}if("wheelDeltaX"in orgEvent){deltaX=orgEvent.wheelDeltaX*-1}if("axis"in orgEvent&&orgEvent.axis===orgEvent.HORIZONTAL_AXIS){deltaX=deltaY*-1;deltaY=0}delta=deltaY===0?deltaX:deltaY;if("deltaY"in orgEvent){deltaY=orgEvent.deltaY*-1;delta=deltaY}if("deltaX"in orgEvent){deltaX=orgEvent.deltaX;if(deltaY===0){delta=deltaX*-1}}if(deltaY===0&&deltaX===0){return}if(orgEvent.deltaMode===1){var lineHeight=$.data(this,"mousewheel-line-height");delta*=lineHeight;deltaY*=lineHeight;deltaX*=lineHeight}else if(orgEvent.deltaMode===2){var pageHeight=$.data(this,"mousewheel-page-height");delta*=pageHeight;deltaY*=pageHeight;deltaX*=pageHeight}absDelta=Math.max(Math.abs(deltaY),Math.abs(deltaX));if(!lowestDelta||absDelta<lowestDelta){lowestDelta=absDelta;if(shouldAdjustOldDeltas(orgEvent,absDelta)){lowestDelta/=40}}if(shouldAdjustOldDeltas(orgEvent,absDelta)){delta/=40;deltaX/=40;deltaY/=40}delta=Math[delta>=1?"floor":"ceil"](delta/lowestDelta);deltaX=Math[deltaX>=1?"floor":"ceil"](deltaX/lowestDelta);deltaY=Math[deltaY>=1?"floor":"ceil"](deltaY/lowestDelta);if(special.settings.normalizeOffset&&this.getBoundingClientRect){var boundingRect=this.getBoundingClientRect();offsetX=event.clientX-boundingRect.left;offsetY=event.clientY-boundingRect.top}event.deltaX=deltaX;event.deltaY=deltaY;event.deltaFactor=lowestDelta;event.offsetX=offsetX;event.offsetY=offsetY;event.deltaMode=0;args.unshift(event,delta,deltaX,deltaY);if(nullLowestDeltaTimeout){clearTimeout(nullLowestDeltaTimeout)}nullLowestDeltaTimeout=setTimeout(nullLowestDelta,200);return($.event.dispatch||$.event.handle).apply(this,args)}function nullLowestDelta(){lowestDelta=null}function shouldAdjustOldDeltas(orgEvent,absDelta){return special.settings.adjustOldDeltas&&orgEvent.type==="mousewheel"&&absDelta%120===0}});(function($){"use strict";var PREFIXES=["Moz","Webkit","O","ms"];var SCALEX=0;var SKEWX=1;var SKEWY=2;var SCALEY=3;var TRANSLATEX=4;var TRANSLATEY=5;var ORIGINX=0;var ORIGINY=1;(function(){var lastTime=0;var vendors=["webkit","moz"];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame)window.requestAnimationFrame=function(callback,element){var currTime=(new Date).getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);lastTime=currTime+timeToCall;return id};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=function(id){clearTimeout(id)}})();function lastOne(q){return q.length?[q.pop()]:[]}function getRenderingQueue(policy){var queue=[];var isRunning=false;policy=policy||function(q){return q};var render=function(){var f;queue=policy(queue);isRunning=false;while(f=queue.shift()){f()}};return{empty:function(){queue=[]},push:function(func){queue.push(func);if(!isRunning){isRunning=true;window.requestAnimationFrame(render)}}}}function capitalize(s){return s.charAt(0).toUpperCase()+s.slice(1)}function getWithPrefixes(obj,prop){var value=obj[prop];if(value)return value;for(var i=0;i<PREFIXES.length;i++){value=obj[PREFIXES[i]+capitalize(prop)];if(value)return value}}function setWithPrefixes(obj,prop,value){obj[prop]=value;for(var i=0;i<PREFIXES.length;i++){obj[PREFIXES[i]+capitalize(prop)]=value}}function getTransformMatrix(transform){var re=/matrix\(([^)]*)\)/;var match=transform.match(re);if(match){var valuesStr=match[1].split(",");var values=[];for(var i=0;i<6;i++){values.push(parseFloat(valuesStr[i]))}return values}else{return[1,0,0,1,0,0]}}function setTransformMatrix(arr){return"matrix("+arr.join(", ")+")"}function newMatrix(){return[1,0,0,1,0,0]}function getMatrix(node){var computedStyle=window.getComputedStyle(node);var CSStransform=getWithPrefixes(computedStyle,"transform");return getTransformMatrix(CSStransform)}function setMatrix(node,matrix){var value=setTransformMatrix(matrix);setWithPrefixes(node.style,"transform",value)}function origin2translate(origin,scale){return origin*(1-scale)}function matrixMul(m1,m2){var m3=new Array(6);m3[0]=m1[0]*m2[0]+m1[2]*m2[1]+m1[4]*0;m3[2]=m1[0]*m2[2]+m1[2]*m2[3]+m1[4]*0;m3[4]=m1[0]*m2[4]+m1[2]*m2[5]+m1[4]*1;m3[1]=m1[1]*m2[0]+m1[3]*m2[1]+m1[5]*0;m3[3]=m1[1]*m2[2]+m1[3]*m2[3]+m1[5]*0;m3[5]=m1[1]*m2[4]+m1[3]*m2[5]+m1[5]*1;return m3}function getCoord(point,matrix){var p=new Array(2);p[0]=matrix[SCALEX]*point[0]+matrix[SKEWX]*point[1]+matrix[TRANSLATEX];p[1]=matrix[SCALEY]*point[1]+matrix[SKEWY]*point[0]+matrix[TRANSLATEY];return p}function getNodeZoomer(node,maxscale,minscale){var originalHeight=node.clientHeight;var originalWidth=node.clientWidth;var originalMatrix=getMatrix(node);var resultMatrix=matrixMul(originalMatrix,newMatrix());maxscale=(maxscale||4)/originalMatrix[SCALEX];minscale=(minscale||1)/originalMatrix[SCALEX];function isOver(direction,minPoint,maxPoint){switch(direction.toUpperCase()){case"N":return minPoint[1]<=0&&maxPoint[1]<=originalHeight;case"S":return minPoint[1]>=0&&maxPoint[1]>=originalHeight;case"W":return minPoint[0]<=0&&maxPoint[0]<=originalWidth;case"E":return minPoint[0]>=0&&maxPoint[0]>=originalWidth}}function limitBoundaries(m){var minPoint=getCoord([0,0],m);var maxPoint=getCoord([originalWidth,originalHeight],m);if(isOver("W",minPoint,maxPoint)){m[TRANSLATEX]=originalWidth-(maxPoint[0]-minPoint[0])}if(isOver("E",minPoint,maxPoint)){m[TRANSLATEX]=0}if(isOver("N",minPoint,maxPoint)){m[TRANSLATEY]=originalHeight-(maxPoint[1]-minPoint[1])}if(isOver("S",minPoint,maxPoint)){m[TRANSLATEY]=0}return m}function getMinPoint(m){return getCoord([0,0],m)}function getMaxPoint(m){return getCoord([originalWidth,originalHeight],m)}return{getZoom:function(){return resultMatrix[SCALEX]},cannotPan:function(direction){var minPoint=getCoord([0,0],resultMatrix);var maxPoint=getCoord([originalWidth,originalHeight],resultMatrix);var dirs=direction.split("");var over=[];for(var i=0;i<dirs.length;i++){if(isOver(dirs[i],minPoint,maxPoint)){over.push(dirs[i])}}
return over.join("")},zoom:function(centerx,centery,newscale){var m;if(newscale<=minscale){newscale=minscale}else if(newscale>=maxscale){newscale=maxscale}m=newMatrix();m[SCALEX]=newscale;m[SCALEY]=newscale;m[TRANSLATEX]=origin2translate(centerx,newscale);m[TRANSLATEY]=origin2translate(centery,newscale);resultMatrix=limitBoundaries(matrixMul(originalMatrix,m));setMatrix(node,resultMatrix)},pan:function(distanceX,distanceY){var m=newMatrix();m[TRANSLATEX]=distanceX;m[TRANSLATEY]=distanceY;resultMatrix=limitBoundaries(matrixMul(m,originalMatrix));setMatrix(node,resultMatrix)},reset:function(){resultMatrix=newMatrix();setMatrix(node,resultMatrix)}}}var CONTAINERCLASS="pinchzoom-container";var ONCLASS="pinchzoom-on";var CONTAINEDCLASS="pinchzoom-item";$.fn.zoomable=function(options){if(typeof options=="string"){var args=Array.prototype.slice.call(arguments,1);this.triggerHandler("zoomable-"+options,args);return this}return this.each(function(){var $container=$(this);$container.addClass(CONTAINERCLASS+" "+ONCLASS);$container.children().wrapAll('<div class="'+CONTAINEDCLASS+'"></div>');var $item=$container.children().get(0);var nodeZoomer;var opts=$.extend({maxscale:4,minscale:1},options);var renderingQueue=getRenderingQueue(lastOne);var handlers={end:function(e){nodeZoomer=undefined},reset:function(){nodeZoomer=getNodeZoomer($item,opts.maxscale,opts.minscale);nodeZoomer.reset();$container.trigger("zoomable-after-zoom",[nodeZoomer]);nodeZoomer=undefined},zoom:function(e,newscale,center){var cb;if(!nodeZoomer){nodeZoomer=getNodeZoomer($item,opts.maxscale,opts.minscale)}if(!center){center=[$container.width()/2,$container.height()/2]}cb=function(ctx,evt,currentCenter,zoomer){return function(){zoomer.zoom(currentCenter[0],currentCenter[1],newscale);$container.trigger("zoomable-after-zoom",[zoomer])}}(this,e,center,nodeZoomer);renderingQueue.push(cb)},pan:function(e,offsetx,offsety){var cb;if(!nodeZoomer){nodeZoomer=getNodeZoomer($item,opts.maxscale,opts.minscale)}cb=function(ctx,evt,zoomer){return function(){zoomer.pan(offsetx,offsety);$container.trigger("zoomable-after-pan",[zoomer])}}(this,e,nodeZoomer);renderingQueue.push(cb)}};$container.on("zoomable-reset",handlers.reset);$container.on("zoomable-end",handlers.end);$container.on("zoomable-zoom",handlers.zoom);$container.on("zoomable-pan",handlers.pan)})};$.fn.pinchzoom=function(options){return this.each(function(index,item){var $container=$(this);var center;var action;var opts=$.extend({disabled:false},options);var touchitem=new Hammer($container.get(0));var getOffset=function(e){var st=$(window).scrollTop();var sl=$(window).scrollLeft();var parentOffset=$container.offset();var relX=e.gesture.center.pageX+sl-parentOffset.left;var relY=e.gesture.center.pageY+st-parentOffset.top;return[relX,relY]};var handlers={end:function(e){action=undefined;center=undefined;$container.triggerHandler("zoomable-end")},reset:function(){$container.triggerHandler("zoomable-reset")},zoom:function(e){if(action==="drag")return;action="pinch";center=getOffset.call(this,e);$container.triggerHandler("zoomable-zoom",[e.gesture.scale,center])},pan:function(e){if(action==="pinch")return;action="drag";var cb;var currentOffset=getOffset.call(this,e);if(!center){center=getOffset.call(this,e)}$container.triggerHandler("zoomable-pan",[currentOffset[0]-center[0],currentOffset[1]-center[1]]);e.stopPropagation();e.gesture.stopPropagation()},enable:function(e){$container.addClass(ONCLASS);touchitem.on("dragend",handlers.end);touchitem.on("doubletap",handlers.reset);touchitem.on("pinch",handlers.zoom);touchitem.on("drag",handlers.pan)},disable:function(e){$container.removeClass(ONCLASS);touchitem.off("dragend");touchitem.off("doubletap");touchitem.off("pinch");touchitem.off("drag")}};$container.on("pinchzoom-reset",handlers.reset);$container.on("pinchzoom-enable",handlers.enable);$container.on("pinchzoom-disable",handlers.disable);if(!opts.disabled){handlers.enable()}})};$.fn.mousezoom=function(options){var opts=$.extend({disabled:false,container:document},options);return this.each(function(){var $container=$(this);var center;var getOffset=function(e){var parentOffset=$container.offset();var relX=e.pageX-parentOffset.left;var relY=e.pageY-parentOffset.top;return[relX,relY]};var clicked=false;var handlers={end:function(e){clicked=false;center=undefined;$container.triggerHandler("zoomable-end")},reset:function(){$container.triggerHandler("zoomable-reset")},start:function(e){center=getOffset.call(this,e);clicked=true},zoom:function(e){center=getOffset.call(this,e);var newscale;if(e.deltaY>0){newscale=1.1}else if(e.deltaY<0){newscale=.9}$container.triggerHandler("zoomable-zoom",[newscale,center]);$container.triggerHandler("zoomable-end");return false},move:function(e){var cb;if(!clicked)return;var currentOffset=getOffset.call(this,e);$container.triggerHandler("zoomable-pan",[currentOffset[0]-center[0],currentOffset[1]-center[1]])},enable:function(e){$container.addClass(ONCLASS);$container.on("dblclick",handlers.reset);$container.on("mousedown",handlers.start);$(opts.container).on("mouseup",handlers.end);$container.on("mousemove",handlers.move);$container.on("mousewheel",handlers.zoom)},disable:function(e){$container.removeClass(ONCLASS);$container.off("dblclick",handlers.reset);$container.off("mousedown",handlers.start);$(opts.container).off("mouseup",handlers.end);$container.off("mousemove",handlers.move);$container.off("mousewheel",handlers.zoom)}};$container.on("pinchzoom-reset",handlers.reset);$container.on("pinchzoom-enable",handlers.enable);$container.on("pinchzoom-disable",handlers.disable);if(!opts.disabled){handlers.enable()}})}})(jQuery);(function(root,factory){if(typeof define==="function"&&define.amd){define("mol-gallery/GalleryTracking",["mol-page-events/page-events"],function(events){return factory(root,events)})}else{root.GalleryTracking=factory(root,DM.pageEvents)}})(this,function(root,events){var ONE_SECOND=1e3;var adStats={};var tracking={init:function(){this.track=trackGalleryOpen},track:trackGalleryOpen,trackGalleryAdvert:trackGalleryAdvert,trackGalleryEnd:trackGalleryEnd};function defer(scope,fn,args,delay){setTimeout(function(){fn.apply(scope,args)},delay)}function trackGalleryOpen(slidePos,content,imageId,imagePos){tracking.track=trackGalleryView;defer(events,events.fireEvent,[events.GALLERY_OPENED,events.getPageMetadata({contentType:content,galleryTitle:galleryTitle(content,imagePos,"gallery start"),galleryId:galleryId(content,slidePos),threadId:imageId})],ONE_SECOND)}function trackGalleryView(slidePos,content,imageId,imagePos){defer(events,events.fireEvent,[events.GALLERY_IMAGE_VIEWED,events.getPageMetadata({contentType:content,galleryTitle:galleryTitle(content,imagePos,"gallery view"),galleryId:galleryId(content,slidePos),threadId:imageId})],ONE_SECOND)}function trackGalleryAdvert(index,advert,locked){var key="advert_"+index;if(!adStats[key]){adStats[key]={views:1,bounces:0};return}if(locked){adStats[key].bounces++}else{adStats[key].views++}defer(events,events.fireEvent,[events.GALLERY_ADVERT_VIEWED,events.getPageMetadata({contentType:"advert",threadId:index})],ONE_SECOND)}function trackGalleryEnd(){events.fireEvent(events.GALLERY_ADVERT_STATS,{type:"gallery-advert",stats:JSON.stringify(adStats)});adStats={};defer(events,events.fireEvent,[events.PAGE_RENDER_STARTED,events.getPageMetadata()]);defer(events,events.fireEvent,[events.GALLERY_CLOSED,events.getPageMetadata({contentType:"image",threadId:"i-0"})])}function galleryTitle(content,index,suffix){return[content,index,suffix].join(" ")}function galleryId(content,index){return[content,index].join(" ")}return tracking});(function(root,factory){if(typeof define==="function"&&define.amd){define("mol-gallery/ArticleGallery",["jquery","mol-mobileutils/mobileutils","mol-gallery/GalleryTracking","Swipe","mol-videoplayer/video"],function($,MobileUtils,GalleryTracking,Swipe){return factory(root,$,MobileUtils,GalleryTracking,Swipe)})}else{root.ArticleGallery=factory(root,root.jQuery,root.MobileUtils,root.GalleryTracking,root.Swipe)}})(this,function(root,$,MobileUtils,GalleryTracking,Swipe){var ArticleGalleryClass=function(config){var ESCAPE_KEY=27;var CURSOR_LEFT_KEY=37;var CURSOR_RIGHT_KEY=39;var ADVERT_ALREADY_VIEWED_ATTRIBUTE="data-advert-already-viewed";var ADVERT_POSITION_ATTRIBUTE="data-position";var ALLOWED_ADS_HTML_ELEMENTS=["div","span","img","iframe"];var DEFAULT_IMAGE_SRC="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";var topBarTitleElement,captionBarElement,mobileGallery,disableNavigationKeys=false,swipe,modal,position,scrollTop,IOS7FixTimeOut,slideCallbacks={terminator:terminate},resizeTimout={},lastImageSlide;var mouseDownTime;function mousedown(e){mouseDownTime=new Date}function mouseup(e){mouseDownTime=undefined}function initSwipe(){swipe=Swipe(mobileGallery[0],{continuous:true,startSlide:1,callback:function(index,container){var callbackName=$(".slide",container).data("show-callback");if(slideCallbacks[callbackName])slideCallbacks[callbackName](index);$(container).trigger("pinchzoom-enable");$(container).next().trigger("pinchzoom-reset").trigger("pinchzoom-disable");$(container).prev().trigger("pinchzoom-reset").trigger("pinchzoom-disable");sanitiseNextSlide(index,container);setTimeout(function(){DM.setupMolVideoJsPlayers&&DM.setupMolVideoJsPlayers.forEachPlayer(mobileGallery[0],function(){this.pause()})},0)}});position=0;var startingSlide=$(".slide",mobileGallery)[1];var startingSlideCallback=$(startingSlide).data("show-callback");$(".slide-container",mobileGallery).not(".terminator").eq(0).trigger("pinchzoom-enable").next().trigger("pinchzoom-reset").trigger("pinchzoom-disable");if(slideCallbacks[startingSlideCallback])slideCallbacks[startingSlideCallback](1)}function sanitiseNextSlide(index,slideContainer){var $nextContainer=$(slideContainer).next();var $nextNextContainer=$nextContainer.next();if(isAdSlide($nextContainer)&&!hasAdLoaded($nextContainer)){if(isAdSlide($nextNextContainer)){removeContainer($nextNextContainer);sanitiseNextSlide(index,slideContainer)}else if(!$nextNextContainer.length){removeContainer($nextContainer)}else{swapSlides($nextContainer,$nextNextContainer)}}}function hasAdLoaded($container){return $container.hasClass("advert-loaded")}function isAdSlide($container){return $container.hasClass("advert")}function bind(){modal.on("mousemove mouseup mousedown click",stopPropagation);$(".video-obj",mobileGallery).on("mousemove mouseup mousedown click",stopPropagation);$(".slide-container.image",mobileGallery).on("click",toggleFurniture).on("mousedown",mousedown);$(window).on("keyup",navigationHandler);$(".navigation-arrow.left",mobileGallery).on("touchend click",previous);$(".navigation-arrow.right",mobileGallery).on("touchend click",next);$(".mobile-gallery-bar .close-button",mobileGallery).on("touchend click",triggerTerminator);$(".slide-container.advert",mobileGallery).on("click touchstart touchend touchmove",preventSwipe);$(window).on("resize",onOrientationChange)}function unbind(){modal.off("mousemove mouseup mousedown click",stopPropagation);$(".video-obj",mobileGallery).off("mousemove mouseup mousedown click",stopPropagation);$(window).off("keyup",navigationHandler);$(".slide-container.image",mobileGallery).off("click",toggleFurniture).off("mousedown",mousedown);$(".navigation-arrow.left",mobileGallery).off("touchend click",previous);$(".navigation-arrow.right",mobileGallery).off("touchend click",next);$(".slide-container.advert",mobileGallery).off("click touchstart touchend touchmove",preventSwipe);$(".mobile-gallery-bar .close-button",mobileGallery).off("touchend click",triggerTerminator);$(".adLinkLabel a",mobileGallery).off();$(window).off("resize",onOrientationChange)}function stopPropagation(event){event.stopPropagation()}function preventSwipe(e){if(isAdvertInteracting()){e.stopPropagation();e.preventDefault()}}function navigationHandler(event){switch(event.keyCode){case ESCAPE_KEY:{triggerTerminator(event);break}case CURSOR_LEFT_KEY:{if(!disableNavigationKeys)previous(event);break}case CURSOR_RIGHT_KEY:{if(!disableNavigationKeys)next(event);break}}}function terminate(slideIndex){position=slideIndex;if(bounce())return;$(window).trigger("slideshow-terminator")}function next(event){event.preventDefault();if(disableUI())return;swipe.enableTouch();ensureFurnitureRemainsOnIfPreviouslyUsed(event);if(!mobileGallery.hasClass("last"))swipe.next()}var disableUIVar=false;function disableUI(){if(!disableUIVar){disableUIVar=true;setTimeout(function(){disableUIVar=false},400);return false}return true}function previous(event){event.preventDefault();if(disableUI())return;swipe.enableTouch();ensureFurnitureRemainsOnIfPreviouslyUsed(event);if(!mobileGallery.hasClass("first"))swipe.prev()}function ensureFurnitureRemainsOnIfPreviouslyUsed(event){if($(event.srcElement).hasClass("navigation-arrow"))enableFurniture()}function onOrientationChange(){mobileGallery.removeClass("resized");swipe.enableTouch();disableAddressBar();resizeImages();setBodyOrientationClass()}function setBodyOrientationClass(){if(MobileUtils.isLandscape()){mobileGallery.removeClass("portrait").addClass("landscape")}else{mobileGallery.addClass("portrait").removeClass("landscape")}}function toggleFurniture(){if(mouseDownTime&&new Date-mouseDownTime>400){mouseup();return}mouseup();mobileGallery.toggleClass("no-furniture")}function enableFurniture(){mobileGallery.removeClass("no-furniture")}function triggerTerminator(event){if(disableUI())return;event.preventDefault();event.stopPropagation();$(window).trigger("slideshow-terminator")}function updateTitle(content){topBarTitleElement.html(content)}function updateCaption(caption){captionBarElement.toggleClass("empty",!caption);$(".text",captionBarElement).html(caption)}function loadImages(images){function insertionPoint(index){var elementAtPosition=$('.slide-container.advert[data-position="'+index+'"]',mobileGallery);if(!isEmpty(elementAtPosition))return $(elementAtPosition);return lastImageSlide||$(".slide-container.terminator",mobileGallery).first()}_.each(images,function(image,imageIndex){var slide=$("<div>"),content=galleryImage(image,imageIndex,images.length);slide.html(content).addClass("slide-container image").css("visibility","hidden");insertionPoint(imageIndex).after(slide);lastImageSlide=slide});resizeImages();makeImagesZoomable()}function removeImages(){$(".slide-container.image",mobileGallery).unbind().remove()}function onImpressionRegistered(advert){$(advert).closest(".interstitial").attr(ADVERT_ALREADY_VIEWED_ATTRIBUTE,"true")}function advertCallback(advert,slideIndex,advertIndex){position=slideIndex;GalleryTracking.trackGalleryAdvert(advertIndex,advert,mobileGallery.hasClass("locked"));if(isSwiping())enableAdGuard();if(advert.attr(ADVERT_ALREADY_VIEWED_ATTRIBUTE)!=="true"){disableInitialSliding(1.5);AdImpression.registerImpression(advert[0],onImpressionRegistered)}mobileGallery.removeClass("image").addClass("interstitial");updateTitle('<span class="advert">Advertisement</span>');updateCaption();updateNavigationArrows(slideIndex)}function isOnSlide(container){return swipe&&container.data("index")===swipe.getPos()}function onAdvertLoaded(event){var advert=$("#"+event.slot.molAd.parentId);if(advert.length&&advert.hasClass("interstitial")){var container=advert.closest(".slide-container");container.addClass("advert-loaded");if(container.length){container.removeClass("loading");if(event.isEmpty){removeContainer(container)}else{decorateAdvert(Number(advert.parent().data("advert-index")),advert)}}}}function swapSlides($a,$b){var aIndex=$a.data("index");var aLeft=$a.css("left");$b.after($a);$a.data("index",$b.data("index"));$b.data("index",aIndex);$a.css("left",$b.css("left"));$b.css("left",aLeft)}function removeContainer(container){container.remove();resetPositions()}function resetPositions(){var slides=mobileGallery.find(".slide-container");var width=slides.width();var parent=slides.parent();parent.children().each(function(index,slide){slide.setAttribute("data-index",index);slide.style.left=width*-index+"px"})}function updateAdverts(){var advertSlides=getAdvertSlides();var advertContainers=advertSlides.closest(".slide-container");advertContainers.addClass("loading");if($(document.body).hasClass("molads_interstitial_off")){advertSlides.parent().remove()}else if(window.useGpt){var renderer=window.adsRenderer;var adListLoader=window.adListLoader;if(renderer&&adListLoader&&adListLoader.isAdEnabled({pos:"interstitial"})){renderer.addLoadListener(onAdvertLoaded);advertSlides.each(function(galleryIndex,advert){renderer.requestDelayedAdvert(advert.id)})}else{advertContainers.each(function(i,container){if(container)removeContainer($(container))})}}else{var invalidAdverts=[];advertSlides.each(function(galleryIndex,advert){var item=$(advert);if(!isValid(item))invalidAdverts.push(item)});for(var i=0;i<invalidAdverts.length;i++)invalidAdverts[i].parent().remove()}}function decorateAdvert(index,advert){var advertWrap=$(advert);if(window.useGpt){resizeAd({data:advert});$(window).bind("resize",advert,resizeAd)}slideCallbacks["advert_"+index]=function(slideIndex){advertCallback(advertWrap,slideIndex,index)};configureActionButton(advertWrap);advertWrap.attr("data-show-callback","advert_"+index);advertWrap.attr(ADVERT_ALREADY_VIEWED_ATTRIBUTE,"false");var advertPosition=advertWrap.parent().attr(ADVERT_POSITION_ATTRIBUTE);if(advertPosition===undefined||advertPosition==="")advertWrap.parent().attr(ADVERT_POSITION_ATTRIBUTE,config.images.length)}function isAdIframe(index,element){return element.id&&element.id.slice(0,18)==="google_ads_iframe_"&&element.width!=="0"}function resizeAd(event){var advert=event.data,id=advert.id;if(resizeTimout[id])clearTimeout(resizeTimout[id]);resizeTimout[id]=event.type?setTimeout(resize,200):resize();function resize(){var advertWrap=$(advert),parent=advertWrap.closest(".advert"),iframe=advertWrap.find("iframe").filter(isAdIframe).get(0);if(iframe){iframe.width=parent.width();iframe.height=parent.height()}return resizeTimout[id]=0}}function getAdvertSlides(){return $(".slide-container.advert .slide")}function decorateAdverts(){var adverts=getAdvertSlides();if(window.useGpt){adverts=adverts.filter("[data-show-callback]")}adverts.each(decorateAdvert)}function showInterstitials(){getAdvertSlides().css("visibility","visible")}function hideInterstitials(){getAdvertSlides().css("visibility","hidden")}function isValid(advert){if(isEmpty($("[data-impression-url]",AdIntegrator.getAdContainer(advert[0]||advert))))return false;if(advert.css("display")=="none")return false;var advertContent=advert.children();var valid=false;advertContent.each(function(i,content){if(_.contains(ALLOWED_ADS_HTML_ELEMENTS,content.tagName.toLowerCase())&&(content.className||"").indexOf("adLinkLabel")===-1)valid=true});return valid}function enableAdvertInteraction(){mobileGallery.addClass("interacting");disableSliding();disableAdGuard()}function disableAdvertInteraction(){mobileGallery.removeClass("interacting");enableSliding();enableAdGuard();var event=new CustomEvent("adDeactivate",{bubbles:true,cancelable:true});modal.get(0).dispatchEvent(event)}function configureActionButton(advert){if(!AdBehaviour.isClickThrough(advert))$(".adLinkLabel a",advert).on("click",enableAdvertInteraction);var buttonText=$("[data-button-text]",advert).data("button-text");isEmpty(buttonText)||$(".adLinkLabel a",advert).text(buttonText)}function disableSliding(){var slides=getSlides();slides.eq(position-1).attr("data-bounce","next");slides.eq(position+1).attr("data-bounce","prev");mobileGallery.addClass("locked")}function enableSliding(){var slides=getSlides();slides.eq(position-1).removeAttr("data-bounce");slides.eq(position+1).removeAttr("data-bounce");mobileGallery.removeClass("locked")}function disableInitialSliding(seconds){disableSliding();slideBlockTimeout=setTimeout(function(){if(!isAdvertInteracting())enableSliding()},seconds*1e3)}function isAdvertInteracting(){return $(mobileGallerySlider).hasClass("interacting")}function isSwiping(){var slides=getSlides();return!($(slides[position-1]).attr("data-bounce")||$(slides[position+1]).attr("data-bounce"))}function enableAdGuard(){$(".ad-guard",mobileGallery).show();$(".adLinkLabel",mobileGallery).show()}function disableAdGuard(){$(".ad-guard",mobileGallery).hide();$(".adLinkLabel",mobileGallery).hide()}function displaySlide(){var slides=getSlides();slides.each(function(idx,slide){var $slide=$(slide),visible=idx>=position-1&&idx<=position+2;$slide.filter(".image").css("visibility",visible?"visible":"hidden");if(visible){lazyLoadImage($slide);DM.loadDeferredImgs.load(slide)}})}function lazyLoadImage($slide){var $img=$slide.find("img[data-src]");if($img&&(!$img.attr("src")||$img.attr("src")===DEFAULT_IMAGE_SRC)){$img.attr("src",$img.attr("data-src"))}}function imageCallback(slideIndex,content,imageIndex,numImages){position=slideIndex;var imagePos=content.attr("data-track-pos");var imageId=content.attr("id")||"i-preview";if(bounce())return;mobileGallery.removeClass("interstitial").addClass("image");updateTitle("<span>"+(imageIndex+1)+" of "+numImages+"</span>");updateCaption(content.attr("data-caption"));updateNavigationArrows(slideIndex);displaySlide(slideIndex);GalleryTracking.track(imageIndex,content.attr("data-content-type"),imageId,imagePos)}function bounce(){var bounceFunction=$(getSlides()[position]).attr("data-bounce");if(bounceFunction){bounceFunction==="next"?swipe.next():swipe.prev();return true}return false}function galleryImage(image,imageIndex,numImages){var content=cloneImage(image);var callbackName="image_"+imageIndex;content.attr("data-show-callback",callbackName);slideCallbacks[callbackName]=function(slideIndex){imageCallback(slideIndex,content,imageIndex,numImages)};return content[0]}function cloneNewVideo($image){var wrapper=document.createElement("div");wrapper.className=$image[0].className;wrapper.id=$image[0].id+"-clone";DM.later("videoplayer-ready",function(){var video=$image.children()[0];var videoClone=video&&DM.setupMolVideoJsPlayers.clone(video,{plugins:{tracking:{trackingType:"image_gallery"}}});if(!videoClone)return;videoClone.id=video.id+"-clone";wrapper.appendChild(videoClone);DM.setupMolVideoJsPlayers(wrapper)});return wrapper}function cloneImage(image){var $image=$(image),isVideo=typeof $image.attr("data-video-opts")!=="undefined",isNewVideo=$image.hasClass("vjs-video-container"),content,imageCaption,contentType;if(isVideo){contentType="videoimage";content=$image.clone();content.attr("id",content.attr("id")+"-clone");content.children().each(function(idx,el){el=$(el);if(el.hasClass("js-video"))el.html("").removeClass("playing");else el.replaceWith("")});content.video({objId:"#"+content.attr("id"),trackingType:"image_gallery"})}else if(isNewVideo){content=$(cloneNewVideo($image));contentType="videoimage"}else{contentType="image";imageCaption=$image.parent().siblings(".imageCaption").html();imageCaption=typeof imageCaption==="undefined"?$image.attr("alt"):imageCaption;content=$image.clone()}return content.addClass("slide").attr("data-content-type",contentType).attr("data-caption",imageCaption)}function updateNavigationArrows(){var slides=getSlides();if(position<=0||position>=slides.size())return;mobileGallery.removeClass("first").removeClass("last");if(slides.eq(position-1).hasClass("terminator"))mobileGallery.addClass("first");if(slides.eq(position+1).hasClass("terminator"))mobileGallery.addClass("last")}function getSlides(){return $(".swipe-wrap",mobileGallery).children()}function resizeImages(){if(swipe)swipe.enableTouch();var $slides=$(".slide-container",mobileGallery).not(".advert").not(".terminator");var h=$(window).height();var w=$(window).width();$slides.each(function(index,slideContainer){fitGalleryItem($(".slide",slideContainer)[0],h,w)});mobileGallery.addClass("resized")}function makeImagesZoomable(){$(".slide-container",mobileGallery).not(".advert").not(".terminator").filter(function(){return!$(this).find(".video-obj,.vjs-video-container").length}).zoomable({maxscale:4,minscale:1}).pinchzoom({disabled:true}).on("zoomable-after-zoom",function(evt,zoomer){if(zoomer.getZoom()===1){swipe.enableTouch()}else{swipe.disableTouch()}})}function fitGalleryItem(item,h,w){setTimeout(function(){center(item);resize(item,h,w)},10)}function resize(slide,h,w){var $slide=$(slide);if(typeof $slide.attr("data-video-opts")!=="undefined")return;var scaleFactor=Math.min(h/slide.offsetHeight,w/slide.offsetWidth);if($slide.is(".vjs-video-container")&&h<w)scaleFactor*=.78;_.each(["-webkit-transform","-moz-transition","-o-transform","transform"],function(cssProperty){$(slide).css(cssProperty,"scale("+scaleFactor+")")})}function center(slide){var verticalCenter=-(slide.offsetHeight/2)+"px";var horizontalCenter=-(slide.offsetWidth/2)+"px";$(slide).css("marginTop",verticalCenter);$(slide).css("marginLeft",horizontalCenter)}var resizeOptions;var currentZoom;var mvp;function disablePageResize(){if(!MobileUtils.isAndroidStock()&&!document.querySelector("meta[name=viewport]")){mvp=document.createElement("meta");mvp.setAttribute("name","viewport");mvp.setAttribute("content","user-scalable=0");document.head.appendChild(mvp)}}function restorePageResize(){if(!MobileUtils.isAndroidStock()&&mvp){mvp.setAttribute("content","user-scalable=1");setTimeout(function(){mvp.parentNode.removeChild(mvp)},0)}}function close(){DM.setupMolVideoJsPlayers&&DM.setupMolVideoJsPlayers.destroy(mobileGallery[0]);if(isAdvertInteracting())return disableAdvertInteraction();MobileUtils.enableScroll();unbind();$(window).off("slideshow-terminator",modal.close);GalleryTracking.trackGalleryEnd();hideInterstitials();removeImages();enableFurniture();if(MobileUtils.isIPhone()){clearInterval(IOS7FixTimeOut)}$("body").removeClass("mobile-gallery-open");window.scrollTo(0,scrollTop);modal.hide();swipe.kill();modal.trigger("close");restorePageResize();setTimeout(function(){DM.loadDeferredImgs.imagesCache.resetCache();DM.loadDeferredImgs.resume()},0)}function buildSlides(){updateAdverts();decorateAdverts();loadImages(config.images);showInterstitials();DM.loadDeferredImgs.imagesCache.resetCache();DM.loadDeferredImgs.pause()}function disableAddressBar(){window.scrollTo(0,1)}function isEmpty(selected){return!selected||selected.length===0}this.show=function(){disablePageResize();scrollTop=$(window).scrollTop();if(MobileUtils.isIPhone()){IOS7FixTimeOut=setInterval(disableAddressBar,500)}modal=config.target.show();mobileGallery=$(".swipe",modal);topBarTitleElement=$(".top-bar .title",mobileGallery);captionBarElement=$(".caption-bar",mobileGallery);buildSlides();$(window).on("slideshow-terminator",close);MobileUtils.disableScroll();setBodyOrientationClass();GalleryTracking.init();initSwipe();bind();$("body").addClass("mobile-gallery-open");modal.trigger("open")}};return ArticleGalleryClass});(function(root,factory){if(typeof define==="function"&&define.amd){define("mol-gallery/ArticlePage",["jquery","mol-mobileutils/mobileutils","mol-gallery/ArticleGallery","Swipe"],function($,MobileUtils,ArticleGallery,Swipe){return factory(root,$,true,MobileUtils,ArticleGallery,Swipe)})}else{root.ArticlePage=factory(root,root.jQuery,false,root.MobileUtils,root.ArticleGallery,Swipe)}})(this,function(root,$,isAMD,MobileUtils,ArticleGallery,Swipe){var config;var selector="img[id^=i-]";var MIN_IMAGE_WIDTH;var MIN_IMAGE_HEIGHT;function init(o){var mobile=o.mobile||isAMD;MIN_IMAGE_WIDTH=mobile?200:300;MIN_IMAGE_HEIGHT=mobile?150:300;config=typeof o==="undefined"?{}:o;if(mobile&&config.allowVideos)selector="img[id^=i-],div[id^=v-]";trackZoom();var images=$(selector).filter(byLargeArticleImage),counter=0;images.filter(function(){if(this.tagName=="IMG"){if($(this).parent("div.image-wrap").length==0){$(this).wrap('<div class="image-wrap">')}return true}else{return false}}).each(processImage);function processImage(){var image=this,$image,container;disableEnlarge(image);$image=$(image);container=$image.parent(".image-wrap");$image.after('<div class="overlay-icon mobile-gallery"><div class="mobile-gallery-icon"></div><span>+'+images.length+"</span></div>");var galleryIconWidth=$image.next(".mobile-gallery").width()||0;if(!MobileUtils.isMobile()){var sharePictures=document.getElementById("share-pictures");if(sharePictures&&image.id){var overlay=$(sharePictures).clone().insertAfter(image);overlay.attr("id","share-pictures-"+ ++counter);if($image.height()<370){var $links=$("#share-pictures-"+counter+" .share-pictures-links");$links.addClass("image-share-horizontal").css("right",galleryIconWidth+20+"px");if($image.width()<390){$links.addClass("image-share-hide")}}DMS.ImageShare.initOnImage(overlay,container)}}container.on("click",function(){openGallery(image,images)}).css("cursor","pointer");if(!mobile)container.css("cursor","pointer")}}function openGallery(image,images){if(MobileUtils.getZoom()>1)return;var articleGallery=new ArticleGallery({target:$("#mobileGalleryModal"),images:galleryImages(image,images)});$(".mobile-gallery-instruction").hide();articleGallery.show()}function galleryImages(startImage,images){var result=[],start=indexOf(startImage,images),length=images.length;images.each(function(idx,el){$(el).attr("data-track-pos",idx)});for(var i=start,end=start+length;i<end;i++){result.push(images[i%length])}return result}function indexOf(image,images){for(var i=0;i<images.length;i++){if(image.src==images[i].src)return i}}function trackZoom(){$("body").toggleClass("zoomed",MobileUtils.getZoom()>1)}function disableEnlarge(image){var parent=$(image).closest("a");if(parent.length>0){parent.removeClass("lightboxPopupLink");if(parent.parent().is("font"))parent.parent().css("font-size","")}}function byLargeArticleImage(){if(this.tagName!=="IMG")return true;var image=this,height=image.height||parseInt(image.getAttribute("height"),10),width=image.width||parseInt(image.getAttribute("width"),10);return height>MIN_IMAGE_HEIGHT+70||height<MIN_IMAGE_HEIGHT+70&&height>=MIN_IMAGE_HEIGHT&&width>MIN_IMAGE_WIDTH+90}function supported(){if(!document.addEventListener)return false;if(navigator.userAgent.match(/Opera Mini/))return false;return true}var ArticlePageClass=function(){if(!supported())return;this.bind()};ArticlePageClass.prototype.bind=function(){init({});$(root).on("touchend",function(){MobileUtils.onTouchEnd(trackZoom)})};$.fn.gallery=function(o){init(o)};function hideImageLightbox(){$(".image-share-url-lightbox").hide()}$(function(){$(".image-wrap").on("mouseenter",hideImageLightbox)});return ArticlePageClass});(function(){var object=typeof exports!="undefined"?exports:this;var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function InvalidCharacterError(message){this.message=message}InvalidCharacterError.prototype=new Error;InvalidCharacterError.prototype.name="InvalidCharacterError";object.btoa||(object.btoa=function(input){var str=String(input);for(var block,charCode,idx=0,map=chars,output="";str.charAt(idx|0)||(map="=",idx%1);output+=map.charAt(63&block>>8-idx%1*8)){charCode=str.charCodeAt(idx+=3/4);if(charCode>255){throw new InvalidCharacterError("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.")}block=block<<8|charCode}return output});object.atob||(object.atob=function(input){var str=String(input).replace(/=+$/,"");if(str.length%4==1){throw new InvalidCharacterError("'atob' failed: The string to be decoded is not correctly encoded.")}for(var bc=0,bs,buffer,idx=0,output="";buffer=str.charAt(idx++);~buffer&&(bs=bc%4?bs*64+buffer:buffer,bc++%4)?output+=String.fromCharCode(255&bs>>(-2*bc&6)):0){buffer=chars.indexOf(buffer)}return output})})();(function(window,document,undefined){"use strict";var logger=DM.log;var isTouchDevice=!!("ontouchstart"in window);var isIFrame=window.top!==window.self;var BACK_TO_TOP_SELECTOR=".mol-footer-back";var backToTop=function(sel){var el=$(sel);if(!el[0]||window.self===window.top)return;el.find(BACK_TO_TOP_SELECTOR).on("click",_redirectParent);function _redirectParent(e){e.stopPropagation();e.preventDefault();
var l=window.location!=window.parent.location?document.referrer:document.location;l.replace(/#.*/,"");l+="#top";window.top.location.href=l}};var delay=500,NAV_SELECTOR=".mol-nav-primary",FOOTER_SELECTOR=".mol-page-footer",SELECTED_CLASS="mol-nav-on",USER_ACTIVE_CLASS="mol-nav-user-active",NO_TOUCH_CLASS="mol-nav-no-touch",ATTEMPTS=10;var nav=function(sel){var opts={},el,nav,isLoading,loaded,failed=0,selected,body=$("body");el=$(sel);if(!el[0])return;!isTouchDevice&&body.addClass(NO_TOUCH_CLASS);user(el);weather(el);backToTop(el);nav=el.find(NAV_SELECTOR);if(!nav[0])return;try{opts=JSON.parse(nav.attr("data-nav-opts"))}catch(e){}logger("nav","NAV > init > el:nav:opts >",el,nav,opts);selected=nav.children("."+SELECTED_CLASS);nav.children().on("mouseenter",_onMouseEnter).on("mouseleave",_onMouseLeave);function _loadCurtains(){if(loaded||isLoading||failed>=ATTEMPTS||!opts.url)return;$.ajax({url:opts.url,cache:false,beforeSend:function(){isLoading=true},complete:function(){isLoading=false},success:function(response,opts){logger("nav","NAV > success > ");nav.children().each(function(index,value){var item=$(value),href=item.children("a").attr("href"),curtain=$(response).filter(function(){return this.nodeType==1&&this.getAttribute("data-nav-href")==href});$(curtain).appendTo(item)});loaded=true},error:function(){logger("nav","NAV > error > ",failed);failed++}})}function _onMouseEnter(e){!isTouchDevice&&selected.removeClass(SELECTED_CLASS);loaded&&body.addClass(USER_ACTIVE_CLASS);setTimeout(function(){_loadCurtains()},1e3)}function _onMouseLeave(e){selected.addClass(SELECTED_CLASS);body.removeClass(USER_ACTIVE_CLASS)}};DM.Nav=nav;DM.later(["bundle","DOM_READY"],function(){nav(FOOTER_SELECTOR)});var MAX_LENGTH=15,NAME_SELECTOR=".mol-nav-logged-in span",LOGIN_SELECTOR=".mol-nav-login a",USER_CLASS="mol-user",USER_MENU_OPEN_CLASS="mol-nav-user-menu";var user=function(sel){var el=$(sel),body=$("body");if(!el[0])return;if(DM.isLoggedIn){body.addClass(USER_CLASS);el.find(NAME_SELECTOR).html(_name()).parent().on("click",function(){isTouchDevice&&body.toggleClass(USER_MENU_OPEN_CLASS)})}else{isIFrame&&el.find(LOGIN_SELECTOR).attr("data-toggle","")}function _truncate(s){if(!s||s.length<=MAX_LENGTH)return s;return s.substring(0,MAX_LENGTH)+"&hellip;"}function _name(){var name;if(!DM.isLoggedIn||!DM.userData)return;try{name=JSON.parse(atob(DM.userData.replace(/"/g,"")).replace(/'/g,'"')).displayName}catch(e){}return _truncate(name)}};var WEATHER_SELECTOR=".mol-nav-weather";var weather=function(sel){var el=$(sel),opts;if(!el[0])return;try{opts=JSON.parse(el.find(WEATHER_SELECTOR).attr("data-weather-opts"))}catch(e){}opts&&DM.WeatherTop&&DM.WeatherTop(opts)}})(window,document);(function(root,factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{factory($)}})(this,function($){var debounce=function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}};$.fn.zxcvbn=function(options,cb){var opts=$.extend({libUrl:"zxcvbn.js",minlength:5,waitInterval:400},options);if(this.length){(function(){var s=document.createElement("script");s.type="text/javascript";s.async=true;s.src=opts.libUrl;var x=document.getElementsByTagName("script")[0];x.parentNode.insertBefore(s,x)})()}return this.each(function(){var $this=$(this),previousValue=$this.val();$this.on("keydown",function(){var $this=$(this);debounce(function(){var v=$this.val(),res;if(previousValue!==v){previousValue=v;$this.removeClass("password-score-0 password-score-1 password-score-2 password-score-3 password-score-4");if(v.length>=opts.minlength&&zxcvbn){res=zxcvbn(v);$this.addClass("password-score-"+res.score)}if(cb)cb($this,v,res)}},opts.waitInterval)()})})}});(function(){var $,AbstractChosen,Chosen,SelectParser,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};SelectParser=function(){function SelectParser(){this.options_index=0;this.parsed=[]}SelectParser.prototype.add_node=function(child){if(child.nodeName.toUpperCase()==="OPTGROUP"){return this.add_group(child)}else{return this.add_option(child)}};SelectParser.prototype.add_group=function(group){var group_position,option,_i,_len,_ref,_results;group_position=this.parsed.length;this.parsed.push({array_index:group_position,group:true,label:this.escapeExpression(group.label),children:0,disabled:group.disabled});_ref=group.childNodes;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];_results.push(this.add_option(option,group_position,group.disabled))}return _results};SelectParser.prototype.add_option=function(option,group_position,group_disabled){if(option.nodeName.toUpperCase()==="OPTION"){if(option.text!==""){if(group_position!=null){this.parsed[group_position].children+=1}this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:option.value,text:option.text,html:option.innerHTML,selected:option.selected,disabled:group_disabled===true?group_disabled:option.disabled,group_array_index:group_position,classes:option.className,style:option.style.cssText})}else{this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:true})}return this.options_index+=1}};SelectParser.prototype.escapeExpression=function(text){var map,unsafe_chars;if(text==null||text===false){return""}if(!/[\&\<\>\"\'\`]/.test(text)){return text}map={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};unsafe_chars=/&(?!\w+;)|[\<\>\"\'\`]/g;return text.replace(unsafe_chars,function(chr){return map[chr]||"&amp;"})};return SelectParser}();SelectParser.select_to_array=function(select){var child,parser,_i,_len,_ref;parser=new SelectParser;_ref=select.childNodes;for(_i=0,_len=_ref.length;_i<_len;_i++){child=_ref[_i];parser.add_node(child)}return parser.parsed};AbstractChosen=function(){function AbstractChosen(form_field,options){this.form_field=form_field;this.options=options!=null?options:{};if(!AbstractChosen.browser_is_supported()){return}this.is_multiple=this.form_field.multiple;this.set_default_text();this.set_default_values();this.setup();this.set_up_html();this.register_observers()}AbstractChosen.prototype.set_default_values=function(){var _this=this;this.click_test_action=function(evt){return _this.test_active_click(evt)};this.activate_action=function(evt){return _this.activate_field(evt)};this.active_field=false;this.mouse_on_container=false;this.results_showing=false;this.result_highlighted=null;this.result_single_selected=null;this.allow_single_deselect=this.options.allow_single_deselect!=null&&this.form_field.options[0]!=null&&this.form_field.options[0].text===""?this.options.allow_single_deselect:false;this.disable_search_threshold=this.options.disable_search_threshold||0;this.disable_search=this.options.disable_search||false;this.enable_split_word_search=this.options.enable_split_word_search!=null?this.options.enable_split_word_search:true;this.group_search=this.options.group_search!=null?this.options.group_search:true;this.search_contains=this.options.search_contains||false;this.single_backstroke_delete=this.options.single_backstroke_delete!=null?this.options.single_backstroke_delete:true;this.max_selected_options=this.options.max_selected_options||Infinity;this.inherit_select_classes=this.options.inherit_select_classes||false;this.display_selected_options=this.options.display_selected_options!=null?this.options.display_selected_options:true;return this.display_disabled_options=this.options.display_disabled_options!=null?this.options.display_disabled_options:true};AbstractChosen.prototype.set_default_text=function(){if(this.form_field.getAttribute("data-placeholder")){this.default_text=this.form_field.getAttribute("data-placeholder")}else if(this.is_multiple){this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||AbstractChosen.default_multiple_text}else{this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||AbstractChosen.default_single_text}return this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||AbstractChosen.default_no_result_text};AbstractChosen.prototype.mouse_enter=function(){return this.mouse_on_container=true};AbstractChosen.prototype.mouse_leave=function(){return this.mouse_on_container=false};AbstractChosen.prototype.input_focus=function(evt){var _this=this;if(this.is_multiple){if(!this.active_field){return setTimeout(function(){return _this.container_mousedown()},50)}}else{if(!this.active_field){return this.activate_field()}}};AbstractChosen.prototype.input_blur=function(evt){var _this=this;if(!this.mouse_on_container){this.active_field=false;return setTimeout(function(){return _this.blur_test()},100)}};AbstractChosen.prototype.results_option_build=function(options){var content,data,_i,_len,_ref;content="";_ref=this.results_data;for(_i=0,_len=_ref.length;_i<_len;_i++){data=_ref[_i];if(data.group){content+=this.result_add_group(data)}else{content+=this.result_add_option(data)}if(options!=null?options.first:void 0){if(data.selected&&this.is_multiple){this.choice_build(data)}else if(data.selected&&!this.is_multiple){this.single_set_selected_text(data.text)}}}return content};AbstractChosen.prototype.result_add_option=function(option){var classes,style;if(!option.search_match){return""}if(!this.include_option_in_results(option)){return""}classes=[];if(!option.disabled&&!(option.selected&&this.is_multiple)){classes.push("active-result")}if(option.disabled&&!(option.selected&&this.is_multiple)){classes.push("disabled-result")}if(option.selected){classes.push("result-selected")}if(option.group_array_index!=null){classes.push("group-option")}if(option.classes!==""){classes.push(option.classes)}style=option.style.cssText!==""?' style="'+option.style+'"':"";return'<li class="'+classes.join(" ")+'"'+style+' data-option-array-index="'+option.array_index+'">'+option.search_text+"</li>"};AbstractChosen.prototype.result_add_group=function(group){if(!(group.search_match||group.group_match)){return""}if(!(group.active_options>0)){return""}return'<li class="group-result">'+group.search_text+"</li>"};AbstractChosen.prototype.results_update_field=function(){this.set_default_text();if(!this.is_multiple){this.results_reset_cleanup()}this.result_clear_highlight();this.result_single_selected=null;this.results_build();if(this.results_showing){return this.winnow_results()}};AbstractChosen.prototype.results_toggle=function(){if(this.results_showing){return this.results_hide()}else{return this.results_show()}};AbstractChosen.prototype.results_search=function(evt){if(this.results_showing){return this.winnow_results()}else{return this.results_show()}};AbstractChosen.prototype.winnow_results=function(){var escapedSearchText,option,regex,regexAnchor,results,results_group,searchText,startpos,text,zregex,_i,_len,_ref;this.no_results_clear();results=0;searchText=this.get_search_text();escapedSearchText=searchText.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");regexAnchor=this.search_contains?"":"^";regex=new RegExp(regexAnchor+escapedSearchText,"i");zregex=new RegExp(escapedSearchText,"i");_ref=this.results_data;for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];option.search_match=false;results_group=null;if(this.include_option_in_results(option)){if(option.group){option.group_match=false;option.active_options=0}if(option.group_array_index!=null&&this.results_data[option.group_array_index]){results_group=this.results_data[option.group_array_index];if(results_group.active_options===0&&results_group.search_match){results+=1}results_group.active_options+=1}if(!(option.group&&!this.group_search)){option.search_text=option.group?option.label:option.html;option.search_match=this.search_string_match(option.search_text,regex);if(option.search_match&&!option.group){results+=1}if(option.search_match){if(searchText.length){startpos=option.search_text.search(zregex);text=option.search_text.substr(0,startpos+searchText.length)+"</em>"+option.search_text.substr(startpos+searchText.length);option.search_text=text.substr(0,startpos)+"<em>"+text.substr(startpos)}if(results_group!=null){results_group.group_match=true}}else if(option.group_array_index!=null&&this.results_data[option.group_array_index].search_match){option.search_match=true}}}}this.result_clear_highlight();if(results<1&&searchText.length){this.update_results_content("");return this.no_results(searchText)}else{this.update_results_content(this.results_option_build());return this.winnow_results_set_highlight()}};AbstractChosen.prototype.search_string_match=function(search_string,regex){var part,parts,_i,_len;if(regex.test(search_string)){return true}else if(this.enable_split_word_search&&(search_string.indexOf(" ")>=0||search_string.indexOf("[")===0)){parts=search_string.replace(/\[|\]/g,"").split(" ");if(parts.length){for(_i=0,_len=parts.length;_i<_len;_i++){part=parts[_i];if(regex.test(part)){return true}}}}};AbstractChosen.prototype.choices_count=function(){var option,_i,_len,_ref;if(this.selected_option_count!=null){return this.selected_option_count}this.selected_option_count=0;_ref=this.form_field.options;for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];if(option.selected){this.selected_option_count+=1}}return this.selected_option_count};AbstractChosen.prototype.choices_click=function(evt){evt.preventDefault();if(!(this.results_showing||this.is_disabled)){return this.results_show()}};AbstractChosen.prototype.keyup_checker=function(evt){var stroke,_ref;stroke=(_ref=evt.which)!=null?_ref:evt.keyCode;this.search_field_scale();switch(stroke){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0){return this.keydown_backstroke()}else if(!this.pending_backstroke){this.result_clear_highlight();return this.results_search()}break;case 13:evt.preventDefault();if(this.results_showing){return this.result_select(evt)}break;case 27:if(this.results_showing){this.results_hide()}return true;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}};AbstractChosen.prototype.container_width=function(){if(this.options.width!=null){return this.options.width}else{return""+this.form_field.offsetWidth+"px"}};AbstractChosen.prototype.include_option_in_results=function(option){if(this.is_multiple&&(!this.display_selected_options&&option.selected)){return false}if(!this.display_disabled_options&&option.disabled){return false}if(option.empty){return false}return true};AbstractChosen.browser_is_supported=function(){if(window.navigator.appName==="Microsoft Internet Explorer"){return document.documentMode>=8}if(/iP(od|hone)/i.test(window.navigator.userAgent)){return false}if(/Android/i.test(window.navigator.userAgent)){if(/Mobile/i.test(window.navigator.userAgent)){return false}}return true};AbstractChosen.default_multiple_text="Select Some Options";AbstractChosen.default_single_text="Select an Option";AbstractChosen.default_no_result_text="No results match";return AbstractChosen}();$=jQuery;$.fn.extend({chosen:function(options){if(!AbstractChosen.browser_is_supported()){return this}return this.each(function(input_field){var $this,chosen;$this=$(this);chosen=$this.data("chosen");if(options==="destroy"&&chosen){chosen.destroy()}else if(!chosen){$this.data("chosen",new Chosen(this,options))}})}});Chosen=function(_super){__extends(Chosen,_super);function Chosen(){_ref=Chosen.__super__.constructor.apply(this,arguments);return _ref}Chosen.prototype.setup=function(){this.form_field_jq=$(this.form_field);this.current_selectedIndex=this.form_field.selectedIndex;return this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")};Chosen.prototype.set_up_html=function(){var container_classes,container_props;container_classes=["chosen-container"];container_classes.push("chosen-container-"+(this.is_multiple?"multi":"single"));if(this.inherit_select_classes&&this.form_field.className){container_classes.push(this.form_field.className)}if(this.is_rtl){container_classes.push("chosen-rtl")}container_props={"class":container_classes.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title};if(this.form_field.id.length){container_props.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"}this.container=$("<div />",container_props);if(this.is_multiple){this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>')}else{this.container.html('<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>')}this.form_field_jq.hide().after(this.container);this.dropdown=this.container.find("div.chosen-drop").first();this.search_field=this.container.find("input").first();this.search_results=this.container.find("ul.chosen-results").first();this.search_field_scale();this.search_no_results=this.container.find("li.no-results").first();if(this.is_multiple){this.search_choices=this.container.find("ul.chosen-choices").first();this.search_container=this.container.find("li.search-field").first()}else{this.search_container=this.container.find("div.chosen-search").first();this.selected_item=this.container.find(".chosen-single").first()}this.results_build();this.set_tab_index();this.set_label_behavior();return this.form_field_jq.trigger("chosen:ready",{chosen:this})};Chosen.prototype.register_observers=function(){var _this=this;this.container.bind("mousedown.chosen",function(evt){_this.container_mousedown(evt)});this.container.bind("mouseup.chosen",function(evt){_this.container_mouseup(evt)});this.container.bind("mouseenter.chosen",function(evt){_this.mouse_enter(evt)});this.container.bind("mouseleave.chosen",function(evt){_this.mouse_leave(evt)});this.search_results.bind("mouseup.chosen",function(evt){_this.search_results_mouseup(evt)});this.search_results.bind("mouseover.chosen",function(evt){_this.search_results_mouseover(evt)});this.search_results.bind("mouseout.chosen",function(evt){_this.search_results_mouseout(evt)});this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(evt){_this.search_results_mousewheel(evt)});this.form_field_jq.bind("chosen:updated.chosen",function(evt){_this.results_update_field(evt)});this.form_field_jq.bind("chosen:activate.chosen",function(evt){_this.activate_field(evt)});this.form_field_jq.bind("chosen:open.chosen",function(evt){_this.container_mousedown(evt)});this.search_field.bind("blur.chosen",function(evt){_this.input_blur(evt)});this.search_field.bind("keyup.chosen",function(evt){_this.keyup_checker(evt)});this.search_field.bind("keydown.chosen",function(evt){_this.keydown_checker(evt)});this.search_field.bind("focus.chosen",function(evt){_this.input_focus(evt)});if(this.is_multiple){return this.search_choices.bind("click.chosen",function(evt){_this.choices_click(evt)})}else{return this.container.bind("click.chosen",function(evt){evt.preventDefault()})}};Chosen.prototype.destroy=function(){$(document).unbind("click.chosen",this.click_test_action);if(this.search_field[0].tabIndex){this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex}this.container.remove();this.form_field_jq.removeData("chosen");return this.form_field_jq.show()};Chosen.prototype.search_field_disabled=function(){this.is_disabled=this.form_field_jq[0].disabled;if(this.is_disabled){this.container.addClass("chosen-disabled");this.search_field[0].disabled=true;if(!this.is_multiple){this.selected_item.unbind("focus.chosen",this.activate_action)}return this.close_field()}else{this.container.removeClass("chosen-disabled");this.search_field[0].disabled=false;if(!this.is_multiple){return this.selected_item.bind("focus.chosen",this.activate_action)}}};Chosen.prototype.container_mousedown=function(evt){if(!this.is_disabled){if(evt&&evt.type==="mousedown"&&!this.results_showing){evt.preventDefault()}if(!(evt!=null&&$(evt.target).hasClass("search-choice-close"))){if(!this.active_field){if(this.is_multiple){this.search_field.val("")}$(document).bind("click.chosen",this.click_test_action);this.results_show()}else if(!this.is_multiple&&evt&&($(evt.target)[0]===this.selected_item[0]||$(evt.target).parents("a.chosen-single").length)){evt.preventDefault();this.results_toggle()}return this.activate_field()}}};Chosen.prototype.container_mouseup=function(evt){if(evt.target.nodeName==="ABBR"&&!this.is_disabled){return this.results_reset(evt)}};Chosen.prototype.search_results_mousewheel=function(evt){var delta,_ref1,_ref2;delta=-((_ref1=evt.originalEvent)!=null?_ref1.wheelDelta:void 0)||((_ref2=evt.originialEvent)!=null?_ref2.detail:void 0);if(delta!=null){evt.preventDefault();if(evt.type==="DOMMouseScroll"){delta=delta*40}return this.search_results.scrollTop(delta+this.search_results.scrollTop())}};Chosen.prototype.blur_test=function(evt){if(!this.active_field&&this.container.hasClass("chosen-container-active")){return this.close_field()}};Chosen.prototype.close_field=function(){$(document).unbind("click.chosen",this.click_test_action);this.active_field=false;this.results_hide();this.container.removeClass("chosen-container-active");this.clear_backstroke();this.show_search_field_default();return this.search_field_scale()};Chosen.prototype.activate_field=function(){this.container.addClass("chosen-container-active");this.active_field=true;this.search_field.val(this.search_field.val());return this.search_field.focus()};Chosen.prototype.test_active_click=function(evt){if(this.container.is($(evt.target).closest(".chosen-container"))){return this.active_field=true}else{return this.close_field()}};Chosen.prototype.results_build=function(){this.parsing=true;this.selected_option_count=null;this.results_data=SelectParser.select_to_array(this.form_field);if(this.is_multiple){this.search_choices.find("li.search-choice").remove()}else if(!this.is_multiple){this.single_set_selected_text();if(this.disable_search||this.form_field.options.length<=this.disable_search_threshold){this.search_field[0].readOnly=true;this.container.addClass("chosen-container-single-nosearch")}else{this.search_field[0].readOnly=false;this.container.removeClass("chosen-container-single-nosearch")}}this.update_results_content(this.results_option_build({first:true}));this.search_field_disabled();this.show_search_field_default();this.search_field_scale();return this.parsing=false};Chosen.prototype.result_do_highlight=function(el){var high_bottom,high_top,maxHeight,visible_bottom,visible_top;if(el.length){this.result_clear_highlight();this.result_highlight=el;this.result_highlight.addClass("highlighted");maxHeight=parseInt(this.search_results.css("maxHeight"),10);visible_top=this.search_results.scrollTop();visible_bottom=maxHeight+visible_top;high_top=this.result_highlight.position().top+this.search_results.scrollTop();high_bottom=high_top+this.result_highlight.outerHeight();if(high_bottom>=visible_bottom){return this.search_results.scrollTop(high_bottom-maxHeight>0?high_bottom-maxHeight:0)}else if(high_top<visible_top){return this.search_results.scrollTop(high_top)}}};Chosen.prototype.result_clear_highlight=function(){if(this.result_highlight){this.result_highlight.removeClass("highlighted")}return this.result_highlight=null};Chosen.prototype.results_show=function(){if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",{chosen:this});return false}this.container.addClass("chosen-with-drop");this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this});this.results_showing=true;this.search_field.focus();this.search_field.val(this.search_field.val());return this.winnow_results()};Chosen.prototype.update_results_content=function(content){return this.search_results.html(content)};Chosen.prototype.results_hide=function(){if(this.results_showing){this.result_clear_highlight();this.container.removeClass("chosen-with-drop");this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})}return this.results_showing=false};Chosen.prototype.set_tab_index=function(el){var ti;if(this.form_field.tabIndex){ti=this.form_field.tabIndex;this.form_field.tabIndex=-1;return this.search_field[0].tabIndex=ti}};Chosen.prototype.set_label_behavior=function(){var _this=this;this.form_field_label=this.form_field_jq.parents("label");if(!this.form_field_label.length&&this.form_field.id.length){this.form_field_label=$("label[for='"+this.form_field.id+"']")}if(this.form_field_label.length>0){return this.form_field_label.bind("click.chosen",function(evt){if(_this.is_multiple){return _this.container_mousedown(evt)}else{return _this.activate_field()}})}};Chosen.prototype.show_search_field_default=function(){if(this.is_multiple&&this.choices_count()<1&&!this.active_field){this.search_field.val(this.default_text);return this.search_field.addClass("default")}else{this.search_field.val("");return this.search_field.removeClass("default")}};Chosen.prototype.search_results_mouseup=function(evt){var target;target=$(evt.target).hasClass("active-result")?$(evt.target):$(evt.target).parents(".active-result").first();if(target.length){this.result_highlight=target;this.result_select(evt);return this.search_field.focus()}};Chosen.prototype.search_results_mouseover=function(evt){var target;target=$(evt.target).hasClass("active-result")?$(evt.target):$(evt.target).parents(".active-result").first();if(target){return this.result_do_highlight(target)}};Chosen.prototype.search_results_mouseout=function(evt){if($(evt.target).hasClass("active-result"||$(evt.target).parents(".active-result").first())){return this.result_clear_highlight()}};Chosen.prototype.choice_build=function(item){var choice,close_link,_this=this;choice=$("<li />",{"class":"search-choice"}).html("<span>"+item.html+"</span>");if(item.disabled){choice.addClass("search-choice-disabled")}else{close_link=$("<a />",{"class":"search-choice-close","data-option-array-index":item.array_index});close_link.bind("click.chosen",function(evt){return _this.choice_destroy_link_click(evt)});choice.append(close_link)}return this.search_container.before(choice)};Chosen.prototype.choice_destroy_link_click=function(evt){evt.preventDefault();evt.stopPropagation();if(!this.is_disabled){return this.choice_destroy($(evt.target))}};Chosen.prototype.choice_destroy=function(link){if(this.result_deselect(link[0].getAttribute("data-option-array-index"))){this.show_search_field_default();if(this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1){this.results_hide()}link.parents("li").first().remove();return this.search_field_scale()}};Chosen.prototype.results_reset=function(){this.form_field.options[0].selected=true;this.selected_option_count=null;this.single_set_selected_text();this.show_search_field_default();this.results_reset_cleanup();this.form_field_jq.trigger("change");if(this.active_field){return this.results_hide()}};Chosen.prototype.results_reset_cleanup=function(){this.current_selectedIndex=this.form_field.selectedIndex;return this.selected_item.find("abbr").remove()};Chosen.prototype.result_select=function(evt){var high,item,selected_index;if(this.result_highlight){high=this.result_highlight;this.result_clear_highlight();if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",{chosen:this});return false}if(this.is_multiple){high.removeClass("active-result")}else{if(this.result_single_selected){this.result_single_selected.removeClass("result-selected");selected_index=this.result_single_selected[0].getAttribute("data-option-array-index");this.results_data[selected_index].selected=false}this.result_single_selected=high}high.addClass("result-selected");item=this.results_data[high[0].getAttribute("data-option-array-index")];item.selected=true;this.form_field.options[item.options_index].selected=true;this.selected_option_count=null;if(this.is_multiple){this.choice_build(item)}else{this.single_set_selected_text(item.text)}if(!((evt.metaKey||evt.ctrlKey)&&this.is_multiple)){this.results_hide()}this.search_field.val("");if(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex){this.form_field_jq.trigger("change",{selected:this.form_field.options[item.options_index].value})}this.current_selectedIndex=this.form_field.selectedIndex;return this.search_field_scale()}};Chosen.prototype.single_set_selected_text=function(text){if(text==null){text=this.default_text}if(text===this.default_text){this.selected_item.addClass("chosen-default")}else{this.single_deselect_control_build();this.selected_item.removeClass("chosen-default")}return this.selected_item.find("span").text(text)};Chosen.prototype.result_deselect=function(pos){var result_data;result_data=this.results_data[pos];if(!this.form_field.options[result_data.options_index].disabled){result_data.selected=false;this.form_field.options[result_data.options_index].selected=false;this.selected_option_count=null;this.result_clear_highlight();if(this.results_showing){this.winnow_results()}this.form_field_jq.trigger("change",{deselected:this.form_field.options[result_data.options_index].value});this.search_field_scale();return true}else{return false}};Chosen.prototype.single_deselect_control_build=function(){if(!this.allow_single_deselect){return}if(!this.selected_item.find("abbr").length){this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')}return this.selected_item.addClass("chosen-single-with-deselect")};Chosen.prototype.get_search_text=function(){if(this.search_field.val()===this.default_text){return""}else{return $("<div/>").text($.trim(this.search_field.val())).html()}};Chosen.prototype.winnow_results_set_highlight=function(){var do_high,selected_results;selected_results=!this.is_multiple?this.search_results.find(".result-selected.active-result"):[];do_high=selected_results.length?selected_results.first():this.search_results.find(".active-result").first();if(do_high!=null){return this.result_do_highlight(do_high)}};Chosen.prototype.no_results=function(terms){var no_results_html;no_results_html=$('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');no_results_html.find("span").first().html(terms);return this.search_results.append(no_results_html)};Chosen.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()};Chosen.prototype.keydown_arrow=function(){var next_sib;if(this.results_showing&&this.result_highlight){next_sib=this.result_highlight.nextAll("li.active-result").first();if(next_sib){return this.result_do_highlight(next_sib)}}else{return this.results_show()}};Chosen.prototype.keyup_arrow=function(){var prev_sibs;if(!this.results_showing&&!this.is_multiple){return this.results_show()}else if(this.result_highlight){prev_sibs=this.result_highlight.prevAll("li.active-result");if(prev_sibs.length){return this.result_do_highlight(prev_sibs.first())}else{if(this.choices_count()>0){this.results_hide()}return this.result_clear_highlight()}}};Chosen.prototype.keydown_backstroke=function(){var next_available_destroy;if(this.pending_backstroke){this.choice_destroy(this.pending_backstroke.find("a").first());return this.clear_backstroke()}else{next_available_destroy=this.search_container.siblings("li.search-choice").last();if(next_available_destroy.length&&!next_available_destroy.hasClass("search-choice-disabled")){this.pending_backstroke=next_available_destroy;if(this.single_backstroke_delete){
return this.keydown_backstroke()}else{return this.pending_backstroke.addClass("search-choice-focus")}}}};Chosen.prototype.clear_backstroke=function(){if(this.pending_backstroke){this.pending_backstroke.removeClass("search-choice-focus")}return this.pending_backstroke=null};Chosen.prototype.keydown_checker=function(evt){var stroke,_ref1;stroke=(_ref1=evt.which)!=null?_ref1:evt.keyCode;this.search_field_scale();if(stroke!==8&&this.pending_backstroke){this.clear_backstroke()}switch(stroke){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:if(this.results_showing&&!this.is_multiple){this.result_select(evt)}this.mouse_on_container=false;break;case 13:evt.preventDefault();break;case 38:evt.preventDefault();this.keyup_arrow();break;case 40:evt.preventDefault();this.keydown_arrow();break}};Chosen.prototype.search_field_scale=function(){var div,f_width,h,style,style_block,styles,w,_i,_len;if(this.is_multiple){h=0;w=0;style_block="position:absolute; left: -1000px; top: -1000px; display:none;";styles=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];for(_i=0,_len=styles.length;_i<_len;_i++){style=styles[_i];style_block+=style+":"+this.search_field.css(style)+";"}div=$("<div />",{style:style_block});div.text(this.search_field.val());$("body").append(div);w=div.width()+25;div.remove();f_width=this.container.outerWidth();if(w>f_width-10){w=f_width-10}return this.search_field.css({width:w+"px"})}};return Chosen}(AbstractChosen)}).call(this);DM.CaptchaReload={init:function(o){var el=Ext.get(o.id),lnkEl;if(!el){return}lnkEl=el.child(".js-link");lnkEl&&lnkEl.on("click",function(ev){var img=el.query(".js-img")[0],dt=new Date;img.src=img.src.replace(/&cb=\d*/,"&cb="+dt.getTime())},null,{preventDefault:true})}};DM.RegFormValidator=function(id,conf){this.init(id,conf)};DM.RegFormValidator.commonRules={mandatory:{tst:/^.+$/,msg:"Please provide a value for this field."},email:{tst:/^([A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4})?$/i,msg:"Please provide a valid email address."},displayNameLength:{tst:function(val){return val.length>=2&&val.length<=20},msg:"Username must be between 2 - 20 characters long."},displayNameValid:{tst:/^[A-Z\u00c0-\u024f]+[A-Z0-9\u00c0-\u024f\.\-\_\ ]*$/i,msg:"Username must consist of letters, numbers, hyphens or underscores, starting with a letter."},realNameLength:{tst:function(val){if(val.length===0){return true}else{return val.length>=2&&val.length<=40}},msg:"Name must be between 2 - 40 characters long."},realNameValid:{tst:function(val){if(val.length===0){return true}else{return/^[A-Z\u00c0-\u024f]+[A-Z\u00c0-\u024f\-\ ]*$/i.test(val)}},msg:"Name must consist of letters, spaces or hyphens, starting with a letter."},countryValid:{tst:/^.+$/,msg:"Please select a country."},cityLength:{tst:function(val){return val.length>=2&&val.length<=30},msg:"City must be between 2 - 30 characters long."},cityValid:{tst:/^[A-Z\u00c0-\u024f]+[A-Z\u00c0-\u024f\.\-\_\ ]*$/i,msg:"City must consist of letters, hyphens or underscores, starting with a letter."},pwdLength:{tst:function(val){return val.length>=5},msg:"Password must be at least 5 characters long."},termsY:{tst:/^Y$/,msg:"You must accept the terms and conditions."}};DM.RegFormValidator.prototype={SEL_INP:".js-val",SEL_FLD:"div",SEL_ERR:".err",CLS_FAIL:"fail",el:null,inputVals:[],inputEls:{},rules:{},init:function(id,conf){this.el=Ext.get(id);if(!this.el){return}Ext.apply(this,conf);Ext.applyIf(this.rules,DM.RegFormValidator.commonRules);this.inputEls=this.el.select(this.SEL_INP);this.inputEls.each(function(el){switch(el.dom.type){case"text":case"password":case"textarea":el.on("blur",this.run,this);break;case"radio":case"checkbox":el.on("click",this.run,this);break;case"select-one":el.on("change",this.run,this);break}},this);this.el.on("submit",this.run,this,{validateAll:true})},validate:function(el,showErrors){var elDom=el.dom,elName=elDom.name,rules=this.rules,ruleName,ruleToTest,m,i,len,result;if(!el){return}showErrors=showErrors||false;switch(elDom.type){case"text":case"password":case"textarea":case"select-one":this.inputVals[elName]=elDom.value;break;case"radio":if(elDom.checked){this.inputVals[elName]=elDom.value}break;case"checkbox":if(elDom.checked){this.inputVals[elName]=elDom.value}else{this.inputVals[elName]=""}break}if(this.map[elName]||this.map["*"]){m=this.map[elName]||this.map["*"];for(i=0,len=m.length;i<len;i+=1){if(typeof m[i]!=="string"){ruleToTest=m[i]}else{ruleName=m[i];ruleToTest=rules[ruleName]&&rules[ruleName].tst;if(!ruleToTest){continue}}if(typeof ruleToTest==="function"){result=ruleToTest(this.inputVals[elName])}else if(ruleToTest instanceof RegExp){result=ruleToTest.test(this.inputVals[elName])}if(result===false){if(showErrors){this.showError(el,ruleName&&rules[ruleName].msg)}return false}}}this.hideError(el);return true},showError:function(el,msg){var parEl=el.parent(this.SEL_FLD),errEl=parEl&&parEl.child(this.SEL_ERR);parEl&&parEl.addClass(this.CLS_FAIL);if(errEl){msg=msg||"";errEl.dom.innerHTML=msg}},hideError:function(el){var parEl=el.parent(this.SEL_FLD),errEl=parEl&&parEl.child(this.SEL_ERR);parEl&&parEl.removeClass(this.CLS_FAIL);if(errEl){errEl.dom.innerHTML=""}},run:function(ev,t,o){var isValid=true,el=Ext.get(t);if(!o.validateAll){return this.validate(el,true)}this.inputEls.each(function(el){if(!isValid){this.validate(el,true)}else{isValid=this.validate(el,true)}},this);if(!isValid){ev.preventDefault()}return isValid}};DM.RegExpander=function(id,conf){this.init(id,conf)};DM.RegExpander.prototype={init:function(id,conf){var elOut,elIn,elOutH,elMore,elMoreWrp;this.el=Ext.get(id);if(!this.el){return}Ext.apply(this,conf);elOut=this.el.child(".js-out"),elIn=this.el.child(".js-in"),elOutH=elOut.getHeight();elMoreWrp=this.el.child(".js-more");if(elIn.getHeight()>elOutH){elMore=Ext.DomHelper.overwrite(elMoreWrp,'<a href="#"><b class="arrow-small-d"></b>more</a>',true);elMore._state=null;elMore._toggle=function(){elMore.dom.innerHTML=elMore._state?'<b class="arrow-small-d"></b>more':'<b class="arrow-small-u"></b>hide';elMore._state=elMore._state?0:1};elMore.on("click",function(ev){var h;elMore._state===null&&elOut.removeClass("prlf-about-max");h=elMore._state?elOutH:elIn.getHeight();ev.preventDefault();elOut.scale(undefined,h,{callback:elMore._toggle,duration:1,easing:"easeOut"})})}}};DM.RegCharCounter=function(id,conf){this.init(id,conf)};DM.RegCharCounter.prototype={SEL_COUNTER:".js-counter",SEL_TEXTAREA:"textarea",tpl:"You have <span>{count}</span> characters left.",maxLength:500,forceMaxLength:true,init:function(id,conf){this.el=Ext.get(id);if(!this.el){return}Ext.apply(this,conf);this.launch()},launch:function(){var elCounter=this.el.child(this.SEL_COUNTER),elTextarea=this.el.child(this.SEL_TEXTAREA),t=new Ext.Template(this.tpl).compile(),elCountDom;t.overwrite(elCounter,{count:this.maxLength-elTextarea.dom.value.length});elCountDom=elCounter.child("span");if(this.forceMaxLength){elTextarea.on("keydown",function(ev,t){var len=t.value.length;if(len>=this.maxLength&&(ev.keyCode>47||ev.keyCode===32)){ev.preventDefault();return false}},this)}elTextarea.on("keyup",function(ev,t){var l=this.maxLength-t.value.length;elCountDom.dom.innerHTML=l>=0?l:0},this)}};(function($){"use strict";$(document).ready(function(){if(!window.REGWEB)return;var rules={mandatory:{type:"regExp",opts:{re:/^.+$/,error:"Please provide a value for this field"}},usernameHelper:{type:"regExp",opts:{re:/^.+$/,error:"Your username is how you'll be known by others on MailOnline, so pick one which describes you well ..."}},cityHelper:{type:"regExp",opts:{re:/^.+$/,error:"Make sure the voice of your home town is heard when you add a comment to an article"}},emailHelper:{type:"regExp",opts:{re:/^.+$/,error:"Please enter a valid email address"}},passwordHelper:{type:"regExp",opts:{re:/^.+$/,error:"Your password should be hard for anyone to guess, so we'd suggest using a mix of capitals, lower case and numbers for the strongest security"}},confirmPasswordHelper:{type:"regExp",opts:{re:/^.+$/,error:"Please re-enter your password"}},email:{type:"regExp",opts:{re:/^([A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4})?$/i,error:"Please provide a valid email address"}},displayNameLength:{type:"length",opts:{min:2,max:20,error:"Username must be between 2 - 20 characters long"}},displayNameValid:{type:"regExp",opts:{re:/^[A-Z\u00c0-\u024f]+[A-Z0-9\u00c0-\u024f\.\-\_\ ]*$/i,error:"Username must consist of letters, numbers, hyphens or underscores, starting with a letter"}},uniqueDisplayName:{type:"rest",opts:{ajaxConfig:{type:"POST",dataType:"json",contentType:"application/json; charset=utf-8"},url:REGWEB.validationFeUri,getData:function(val){return'{"formName" : "newSocialRegistrationRequest" , "fieldName":"displayName" , "fieldValue":"'+val+'"}'},success:function(msg,status,cb){if(msg.status==="success"&&msg.payload.violations==="0"){cb()}else{cb("This name already exists")}}}},cityLength:{type:"length",opts:{min:2,max:30,error:"City must be between 2 - 30 characters long"}},cityValid:{type:"regExp",opts:{re:/^[A-Z\u00c0-\u024f]+[A-Z\u00c0-\u024f\.\-\_\ ]*$/i,error:"City must consist of letters, hyphens or underscores, starting with a letter"}},countryValid:{type:"regExp",opts:{re:/^.+$/,error:"We have readers from all over the world, please share where you're from with our readers"}},pwdLength:{type:"length",opts:{min:5,max:15,error:"Password must be at least 5 and maximum 15 characters long"}},pwdSpaces:{type:"regExp",opts:{re:/^[^\s]+.*[^\s]+$/,error:"Password cannot start or end with space."}},termsY:{type:"regExp",opts:{re:/^Y$/,error:"You must accept the terms and conditions"}},pwdMatch:function(val,$form,cb){if(val===$form.find("#reg-password").val()){cb()}else{cb("Passwords do not match.")}},newPwdMatch:function(val,$form,cb){if(val===$form.find("#reg-pwd-2").val()){cb()}else{console.log("value: ",$form.find("#reg-pwd-2").val());cb("Passwords do not match!!!")}},dob:function(val,$form,cb){var d=$form.find("#reg-dob-day").val(),m=$form.find("#reg-dob-month").val(),y=$form.find("#reg-dob-year").val(),day,month,year,err;if(d&&m&&y){month=parseInt(m,10)-1,day=parseInt(d,10),year=parseInt(y,10),date=new Date(year,month,day);if(date.getFullYear()!==year||date.getMonth()!==month||date.getDate()!==day){err="Please enter a valid date"}}else{err="Please enter a valid date"}cb(err)},checkConfirmation:function(val,$form,cb){var conf=$form.find("[name=confirmPassword]");if(conf.val().length){conf.trigger("validate-error")}cb()},checkNewPwConfirmation:function(val,$form,cb){var conf=$form.find("[name=newPasswordConfirm]");if(conf.val().length){conf.trigger("validate-error")}cb()},recaptchaHelper:{type:"length",opts:{min:1,error:"Don't forget the verification code"}},reportHelper:{type:"regExp",opts:{re:/^\S(.|\n)*$/,error:"Please provide an explanation of your complaint"}},reportLength:{type:"length",opts:{min:1,max:550,error:"Please use 1 to 550 characters"}}};$("#reg-details").regformvalidator({fieldContainer:".reg-fld",errorContainer:".err",serverSideErrorClass:".server-side-fail",rules:rules,errorsMap:{displayName:["usernameHelper","displayNameLength","displayNameValid","uniqueDisplayName"],city:["cityHelper","cityLength","cityValid"],country:["countryValid"],email:["emailHelper","email"],password:["passwordHelper","pwdLength","checkConfirmation","pwdSpaces"],confirmPassword:["confirmPasswordHelper","pwdLength","pwdMatch","pwdSpaces"],dobDay:["dob"],dobMonth:["dob"],dobYear:["dob"]},hintsMap:{displayName:["usernameHelper"],city:["cityHelper"],email:["emailHelper"],password:["passwordHelper"],confirmPassword:["confirmPasswordHelper"]}});$("#reg-new-pwd").regformvalidator({fieldContainer:".reg-fld",errorContainer:".err",serverSideErrorClass:".server-side-fail",rules:rules,errorsMap:{password:["passwordHelper","pwdLength","checkConfirmation","pwdSpaces"],confirmPassword:["confirmPasswordHelper","pwdLength","pwdMatch","pwdSpaces"]},hintsMap:{password:["passwordHelper"],confirmPassword:["confirmPasswordHelper"]}});$("#reg-change-pwd").regformvalidator({fieldContainer:".reg-fld",errorContainer:".err",serverSideErrorClass:".server-side-fail",rules:rules,errorsMap:{newPassword:["passwordHelper","pwdLength","checkNewPwConfirmation","pwdSpaces"],newPasswordConfirm:["confirmPasswordHelper","pwdLength","newPwdMatch","pwdSpaces"]},hintsMap:{newPassword:["passwordHelper"],newPasswordConfirm:["confirmPasswordHelper"]}});$("#reg-details-social").regformvalidator({fieldContainer:".reg-fld",errorContainer:".err",serverSideErrorClass:".server-side-fail",rules:rules,errorsMap:{displayName:["usernameHelper","displayNameLength","displayNameValid","uniqueDisplayName"],city:["cityHelper","cityLength","cityValid"],country:["countryValid"],email:["emailHelper","email"]},hintsMap:{displayName:["usernameHelper"],city:["cityHelper"],email:["emailHelper"]}});$("#reg-report-abuse").regformvalidator({fieldContainer:".reg-fld",errorContainer:".err",serverSideErrorClass:".server-side-fail",rules:rules,errorsMap:{reporterEmail:["emailHelper","email"],reportText:["reportHelper","reportLength"]},hintsMap:{reporterEmail:["emailHelper"],reportText:["reportHelper"]}});$.fn.redirectWhenReady=function(options){var opts,failTimeoutId,tryTimeoutId;if(!this.length){return this}opts=$.extend({url:window.location.toString(),maxWait:1e4,pollInterval:1e3,fail:function(){$("body").addClass("redirect-fail")},success:function(){if(REGWEB.targetUrl){window.location.replace(REGWEB.targetUrl)}else{window.location.replace(this.url)}},check:function(cb){cb(true)}},options);failTimeoutId=setTimeout(function(){if(tryTimeoutId){clearTimeout(tryTimeoutId);failTimeoutId=undefined}opts.fail()},opts.maxWait);(function poll(){opts.check(function(success){if(!failTimeoutId){return}if(success){clearTimeout(failTimeoutId);opts.success()}else{tryTimeoutId=setTimeout(poll,opts.pollInterval)}})})()};$("#user-not-found").redirectWhenReady({url:"/registration/profile.html",check:function(cb){$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:window.location.origin+"/"+REGWEB.checkUserFeUri,data:'{"userId" : "'+REGWEB.userId+'" }',success:function(msg,status){if(msg.status==="success"&&msg.payload.user==="found"){cb(true)}else{cb(false)}}})},fail:function(){window.location.replace("/home/index.html")},maxWait:3e5});$(".mol-registration select").chosen();$(".mol-registration select").change(function(){$(this).closest(".reg-fld").addClass("focus")})})})(jQuery);(function(){"use strict";$(document).ready(function(){try{var base=DM.getPageMetadata().bundleLocation+"/"}catch(e){var base=""}$("#reg-password").zxcvbn({libUrl:base+"zxcvbn--.js"},function($node,password,result){var $this=$node.closest(".password-strength-wrapper");$this.removeClass("password-weak password-medium password-strong");if(result){if(result.score===0){$this.addClass("password-weak")}else if(result.score===1){$this.addClass("password-medium")}else if(result.score===2){$this.addClass("password-medium")}else if(result.score===3){$this.addClass("password-strong")}else if(result.score===4){$this.addClass("password-strong")}}})})})();!function($){var PROTOCOL=document.location.protocol=="https:"?"https://":"http://";var DEFAULT_SERVICE=PROTOCOL+"api2.transloadit.com/";var OPTIONS={service:DEFAULT_SERVICE,assets:PROTOCOL+"assets.transloadit.com/",beforeStart:function(){return true},onFileSelect:function(){},onStart:function(){},onProgress:function(){},onUpload:function(){},onResult:function(){},onCancel:function(){},onError:function(){},onSuccess:function(){},interval:2500,pollTimeout:8e3,poll404Retries:15,pollConnectionRetries:3,wait:false,processZeroFiles:true,triggerUploadOnFileSelection:false,autoSubmit:true,modal:true,exclude:"",fields:false,params:null,signature:null,region:"us-east-1",debug:true,locale:"en"};var I18N={en:{"errors.BORED_INSTANCE_ERROR":"Could not find a bored instance.","errors.CONNECTION_ERROR":"There was a problem connecting to the upload server","errors.unknown":"There was an internal error.","errors.tryAgain":"Please try your upload again.","errors.troubleshootDetails":"If you would like our help to troubleshoot this, "+"please email us this information:",cancel:"Cancel",details:"Details",startingUpload:"Starting upload ...",processingFiles:"Processing files",uploadProgress:"%s MB / %s MB (%s kB / sec)"}};var CSS_LOADED=false;function sprintf(str,args){args=args||[];return str.replace(/(%[s])/g,function(m,i,s){var arg=args.shift();if(!arg&&arg!==0){return""}return arg+""})}$.fn.transloadit=function(){var args=Array.prototype.slice.call(arguments);var method;var uploader;var r;if(this.length===0){return}if(this.length>1){this.each(function(){$.fn.transloadit.apply($(this),args)});return}if(args.length==1&&typeof args[0]=="object"||args[0]===undefined){args.unshift("init")}method=args.shift();if(method=="init"){uploader=new Uploader;args.unshift(this);this.data("transloadit.uploader",uploader)}else{uploader=this.data("transloadit.uploader")}if(!uploader){throw new Error("Element is not initialized for transloadit!")}r=uploader[method].apply(uploader,args);return r===undefined?this:r};$.fn.transloadit.i18n=I18N;function Uploader(){this.assemblyId=null;this.instance=null;this.documentTitle=null;this.timer=null;this._options={};this.uploads=[];this.results={};this.ended=null;this.pollStarted=null;this.pollRetries=0;this.started=false;this.assembly=null;this.params=null;this.bytesReceivedBefore=0;this.lastPoll=0;this.$params=null;this.$form=null;this.$files=null;this.$fileClones=null;this.$iframe=null;this.$modal=null;this._lastMSecs=0;this._lastNSecs=0;this._clockseq=0;this._uploadFileIds=[];this._resultFileIds=[]}Uploader.prototype.init=function($form,options){this.$form=$form;this.options($.extend({},OPTIONS,options||{}));var self=this;$form.bind("submit.transloadit",function(){self.validate();self.detectFileInputs();if(!self._options["processZeroFiles"]&&self.$files.length===0){if(self._options.beforeStart()){self.submitForm()}}else{if(self._options.beforeStart()){self.getBoredInstance()}}return false});if(this._options["triggerUploadOnFileSelection"]){$form.on("change",'input[type="file"]',function(){$form.trigger("submit.transloadit")})}$form.on("change",'input[type="file"]',function(){self._options.onFileSelect($(this).val(),$(this))});this.includeCss()};Uploader.prototype.getBoredInstance=function(){var self=this;this.instance=null;var url=this._options["service"]+"instances/bored";var canUseCustomBoredLogic=true;function proceed(){$.jsonp({url:url,timeout:self._options.pollTimeout,callbackParameter:"callback",success:function(instance){if(instance.error){self.ended=true;instance.url=url;self.renderError(instance);self._options.onError(instance);return}self.instance=instance.api2_host;self.start()},error:function(xhr,status){if(canUseCustomBoredLogic&&self._options["service"]===DEFAULT_SERVICE){canUseCustomBoredLogic=false;self._findBoredInstanceUrl(function(err,theUrl){if(err){self.ended=true;err={error:"BORED_INSTANCE_ERROR",message:self.i18n("errors.BORED_INSTANCE_ERROR")+" "+err.message};self.renderError(err);self._options.onError(err);return}url=PROTOCOL+"api2."+theUrl+"/instances/bored";proceed()});return}self.ended=true;var err={error:"CONNECTION_ERROR",message:self.i18n("errors.CONNECTION_ERROR"),reason:"JSONP request status: "+status,url:url};self.renderError(err);self._options.onError(err)}})}proceed();if(this._options.modal){this.showModal()}};Uploader.prototype._findBoredInstanceUrl=function(cb){var self=this;var url=PROTOCOL+"s3.amazonaws.com/infra-"+this._options.region;url+=".transloadit.com/cached_instances.json";$.ajax({url:url,datatype:"json",timeout:5e3,success:function(result){var instances=self._shuffle(result.uploaders);self._findResponsiveInstance(instances,0,cb)},error:function(xhr,status){var err=new Error("Could not query S3 for cached uploaders");cb(err)}})};Uploader.prototype._findResponsiveInstance=function(instances,index,cb){if(!instances[index]){var err=new Error("No responsive uploaders");return cb(err)}var self=this;var url=instances[index];$.jsonp({url:PROTOCOL+url,timeout:3e3,callbackParameter:"callback",success:function(result){cb(null,url)},error:function(xhr,status){self._findResponsiveInstance(instances,index+1,cb)}})};Uploader.prototype._shuffle=function(arr){var shuffled=[];var rand;for(var i=0;i<arr.length;i++){rand=Math.floor(Math.random()*(i+1));shuffled[i]=shuffled[rand];shuffled[rand]=arr[i]}return shuffled};Uploader.prototype.start=function(){var self=this;this.started=false;this.ended=false;this.bytesReceivedBefore=0;this.pollRetries=0;this.uploads=[];this._uploadFileIds=[];this._resultFileIds=[];this.results={};this.assemblyId=this._genUuid();this.$fileClones=$().not(document);this.$files.each(function(){var $clone=$(this).clone(true);self.$fileClones=self.$fileClones.add($clone);$clone.insertAfter(this)});this.$iframe=$('<iframe id="transloadit-'+this.assemblyId+'" name="transloadit-'+this.assemblyId+'"/>').appendTo("body").hide();var url=PROTOCOL+this.instance+"/assemblies/"+this.assemblyId+"?redirect=false";if(this._options.formData){this._options.formData.append("params",this.$form.find("input[name=params]").val());var f=new XMLHttpRequest;f.open("POST",url);f.send(this._options.formData)}else{this.$uploadForm=$('<form enctype="multipart/form-data" />').attr("action",url).attr("target","transloadit-"+this.assemblyId).attr("method","POST").append(this.$files).appendTo("body").hide();var fieldsFilter="[name=params], [name=signature]";if(this._options.fields===true){fieldsFilter="*"}else if(typeof this._options.fields==="string"){fieldsFilter+=", "+this._options.fields}var $fieldsToClone=this.$form.find(":input[type!=file]").filter(fieldsFilter);var $selects=$fieldsToClone.filter("select");$fieldsToClone=$fieldsToClone.filter(function(){return!$(this).is("select")});$fieldsToClone=$fieldsToClone.filter("[type!=submit]");var $clones=this.clone($fieldsToClone);if(this._options.params&&!this.$params){$clones=$clones.add('<input name="params" value=\''+JSON.stringify(this._options.params)+"'>")}if(this._options.signature){$clones=$clones.add('<input name="signature" value=\''+this._options.signature+"'>")}if(typeof this._options.fields=="object"){for(var fieldName in this._options.fields){var fieldValue=this._options.fields[fieldName];$clones=$clones.add('<input name="'+fieldName+"\" value='"+fieldValue+"'>")}}$clones.prependTo(this.$uploadForm);$selects.each(function(){$('<input type="hidden"/>').attr("name",$(this).attr("name")).attr("value",$(this).val()).prependTo(self.$uploadForm)});this.$uploadForm.submit()}this.lastPoll=+new Date;setTimeout(function(){self._poll()},300)};Uploader.prototype.clone=function($obj){var $result=$obj.clone();var myTextareas=$obj.filter("textarea");var resultTextareas=$result.filter("textarea");for(var i=0;i<myTextareas.length;++i){$(resultTextareas[i]).val($(myTextareas[i]).val())}return $result};Uploader.prototype.detectFileInputs=function(){var $files=this.$form.find("input[type=file]").not(this._options.exclude);if(!this._options["processZeroFiles"]){$files=$files.filter(function(){return this.value!==""})}this.$files=$files};Uploader.prototype.validate=function(){if(!this._options.params){var $params=this.$form.find("input[name=params]");if(!$params.length){alert("Could not find input[name=params] in your form.");return}this.$params=$params;try{this.params=JSON.parse($params.val())}catch(e){alert("Error: input[name=params] seems to contain invalid JSON.");return}}else{this.params=this._options.params}if(this.params.redirect_url){this.$form.attr("action",this.params.redirect_url)}else if(this._options.autoSubmit&&this.$form.attr("action")==this._options.service+"assemblies"){alert("Error: input[name=params] does not include a redirect_url");return}};Uploader.prototype._poll=function(query){var self=this;if(this.ended){return}var match=/(mozilla)(?:.*? rv:([\w.]+))?/.exec(navigator.userAgent);var isMozilla=match&&match[1];this.documentTitle=document.title;if(isMozilla&&!this.documentTitle){document.title="Loading..."}this.pollStarted=+new Date;var instance=this.instance.replace(/\.transloadit\.com/,"")+"-status.transloadit.com";var url=PROTOCOL+instance+"/assemblies/"+this.assemblyId;if(query){url+=query}$.jsonp({url:url,timeout:self._options.pollTimeout,callbackParameter:"callback",success:function(assembly){if(self.ended){return}self.assembly=assembly;if(assembly.error=="ASSEMBLY_NOT_FOUND"){self.pollRetries++;if(self.pollRetries>self._options.poll404Retries){document.title=self.documentTitle;self.ended=true;self.renderError(assembly);self._options.onError(assembly);return}setTimeout(function(){self._poll()},400);return}if(assembly.error){self.ended=true;self.renderError(assembly);document.title=self.documentTitle;self._options.onError(assembly);return}if(!self.started){self.started=true;self._options.onStart(assembly)}self.pollRetries=0;var isUploading=assembly.ok==="ASSEMBLY_UPLOADING";var isExecuting=assembly.ok==="ASSEMBLY_EXECUTING";var isCanceled=assembly.ok==="ASSEMBLY_CANCELED";var isComplete=assembly.ok==="ASSEMBLY_COMPLETED";self._options.onProgress(assembly.bytes_received,assembly.bytes_expected,assembly);for(var i=0;i<assembly.uploads.length;i++){var upload=assembly.uploads[i];if(self._uploadFileIds.indexOf(upload.id)===-1){self._options.onUpload(upload,assembly);self.uploads.push(upload);self._uploadFileIds.push(upload.id)}}for(var step in assembly.results){self.results[step]=self.results[step]||[];for(var j=0;j<assembly.results[step].length;j++){var result=assembly.results[step][j];var resultId=step+"_"+result.id;if(self._resultFileIds.indexOf(resultId)===-1){self._options.onResult(step,result,assembly);self.results[step].push(result);self._resultFileIds.push(resultId)}}}if(isCanceled){self.ended=true;document.title=self.documentTitle;self._options.onCancel(assembly);return}self.renderProgress(assembly);if(isComplete||!self._options["wait"]&&isExecuting){self.ended=true;document.title=self.documentTitle;assembly.uploads=self.uploads;assembly.results=self.results;self._options.onSuccess(assembly);if(self._options.modal){self.cancel()}self.submitForm();return}var ping=self.pollStarted-+new Date;var timeout=ping<self._options.interval?self._options.interval:ping;self.timer=setTimeout(function(){self._poll()},timeout);self.lastPoll=+new Date},error:function(xhr,status){if(self.ended){return}self.pollRetries++;if(self.pollRetries>self._options.pollConnectionRetries){document.title=self.documentTitle;self.ended=true;var err={error:"CONNECTION_ERROR",message:self.i18n("errors.CONNECTION_ERROR"),reason:"JSONP request status: "+status,url:url};self.renderError(err);self._options.onError(err);return}setTimeout(function(){self._poll()},350)}})};Uploader.prototype.stop=function(){document.title=this.documentTitle;this.ended=true};Uploader.prototype.cancel=function(){if(!this.ended){var self=this;if(this.$params){this.$params.prependTo(this.$form)}this.$fileClones.each(function(i){var $original=$(self.$files[i]).clone(true);var $clone=$(this);$original.insertAfter($clone);$clone.remove()});clearTimeout(self.timer);this._poll("?method=delete");if(navigator.appName=="Microsoft Internet Explorer"){this.$iframe[0].contentWindow.document.execCommand("Stop")}setTimeout(function(){self.$iframe.remove()},500)}if(this._options.modal){this.hideModal()}};Uploader.prototype.submitForm=function(){if(this.$form.attr("enctype")==="multipart/form-data"){this.$form.removeAttr("enctype")}if(this.assembly!==null){$("<textarea/>").attr("name","transloadit").text(JSON.stringify(this.assembly)).prependTo(this.$form).hide()}if(this._options.autoSubmit){this.$form.unbind("submit.transloadit").submit()}};Uploader.prototype.hideModal=function(){$.mask.close();this.$modal.remove()};Uploader.prototype.showModal=function(){this.$modal=$('<div id="transloadit">'+'<div class="content">'+'<a href="#close" class="close">'+this.i18n("cancel")+"</a>"+'<p class="status"></p>'+'<div class="progress progress-striped active">'+'<div class="bar"><span class="percent"></span></div>'+"</div>"+"<label>"+this.i18n("startingUpload")+"</label>"+'<p class="error"></p>'+'<div class="error-details-toggle"><a href="#">'+this.i18n("details")+"</a></div>"+'<p class="error-details"></p>'+"</div>"+"</div>").appendTo("body");$.extend(this.$modal,{$content:this.$modal.find(".content"),$close:this.$modal.find(".close"),$label:this.$modal.find("label"),$progress:this.$modal.find(".progress"),$percent:this.$modal.find(".progress .percent"),$progressBar:this.$modal.find(".progress .bar"),$error:this.$modal.find(".error"),$errorDetails:this.$modal.find(".error-details"),$errorDetailsToggle:this.$modal.find(".error-details-toggle")});var self=this;this.$modal.$close.click(function(){self.cancel()});this.$modal.$error.hide();this.$modal.$errorDetails.hide();this.$modal.$errorDetailsToggle.hide();var expose=this.$modal.expose({api:true,maskId:"transloadit_expose",opacity:.9,loadSpeed:250,closeOnEsc:false,closeOnClick:false});this.$modal.$close.click(function(){self.cancel();return false})};Uploader.prototype.renderError=function(err){if(!this._options.modal){return}if(!this._options.debug){return this.cancel()}this.$modal.$content.addClass("content-error");this.$modal.$progress.hide();this.$modal.$label.hide();var errorMsg=err.error+": "+err.message+"<br /><br />";errorMsg+=err.reason||"";var errorsRequiringDetails=["CONNECTION_ERROR","BORED_INSTANCE_ERROR","ASSEMBLY_NOT_FOUND"];if(errorsRequiringDetails.indexOf(err.error)===-1){this.$modal.$error.html(errorMsg).show();return}var text=this.i18n("errors.unknown")+"<br/>"+this.i18n("errors.tryAgain");this.$modal.$error.html(text).show();var assemblyId=err.assemblyId?err.assemblyId:this.assemblyId;var self=this;var ip=null;$.getJSON(PROTOCOL+"jsonip.com/",function(ipData){ip=ipData.ip}).always(function(){var details={endpoint:err.url,instance:self.instance,assembly_id:assemblyId,ip:ip,time:self.getUTCDatetime(),agent:navigator.userAgent,poll_retries:self.pollRetries,error:errorMsg};$.post(PROTOCOL+"status.transloadit.com/client_error",details);var detailsArr=[];for(var key in details){detailsArr.push(key+": "+details[key])}var detailsTxt=self.i18n("errors.troubleshootDetails")+"<br /><br />";self.$modal.$errorDetails.hide().html(detailsTxt+detailsArr.join("<br />"));self.$modal.$errorDetailsToggle.show().find("a").off("click").on("click",function(e){e.preventDefault();self.$modal.$errorDetails.toggle()})})};Uploader.prototype.renderProgress=function(assembly){if(!this._options.modal){return}var progress=assembly.bytes_received/assembly.bytes_expected*100;if(progress>100){progress=0}var bytesReceived=assembly.bytes_received-this.bytesReceivedBefore;var timeSinceLastPoll=+new Date-this.lastPoll;var duration=progress===100?1e3:this._options.interval*2;var txt=this.i18n("processingFiles");if(progress!=100){txt=this.i18n("uploadProgress",(assembly.bytes_received/1024/1024).toFixed(2),(assembly.bytes_expected/1024/1024).toFixed(2),(bytesReceived/1024/(timeSinceLastPoll/1e3)).toFixed(1))}this.$modal.$label.text(txt);var totalWidth=parseInt(this.$modal.$progress.css("width"),10);this.bytesReceivedBefore=assembly.bytes_received;if(bytesReceived<=0){return}var self=this;this.$modal.$progressBar.stop().animate({width:progress+"%"},{duration:duration,easing:"linear",progress:function(promise,currPercent,remainingMs){var width=parseInt(self.$modal.$progressBar.css("width"),10);var percent=(width*100/totalWidth).toFixed(0);if(percent>100){percent=100}if(percent>13){self.$modal.$percent.text(percent+"%")}}})};Uploader.prototype.includeCss=function(){if(CSS_LOADED||!this._options.modal){return}CSS_LOADED=true;$('<link rel="stylesheet" type="text/css" href="'+this._options.assets+'css/transloadit2-latest.css" />').appendTo("head")};Uploader.prototype.getUTCDatetime=function(){var now=new Date;var d=new Date(now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate(),now.getUTCHours(),now.getUTCMinutes(),now.getUTCSeconds());
var pad=function(n){return n<10?"0"+n:n};var tz=d.getTimezoneOffset();var tzs=(tz>0?"-":"+")+pad(parseInt(tz/60,10));if(tz%60!==0){tzs+=pad(tz%60)}if(tz===0){tzs="Z"}return d.getFullYear()+"-"+pad(d.getMonth()+1)+"-"+pad(d.getDate())+"T"+pad(d.getHours())+":"+pad(d.getMinutes())+":"+pad(d.getSeconds())+tzs};Uploader.prototype._genUuid=function(options,buf,offset){options=options||{};var i=buf&&offset||0;var b=buf||[];var _rnds=new Array(16);var _rng=function(){for(var j=0,r;j<16;j++){if((j&3)===0)r=Math.random()*4294967296;_rnds[j]=r>>>((j&3)<<3)&255}return _rnds};var _seedBytes=_rng();var _nodeId=[_seedBytes[0]|1,_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]];this._clockseq=(_seedBytes[6]<<8|_seedBytes[7])&16383;var clockseq=options.clockseq!=null?options.clockseq:this._clockseq;var _byteToHex=[];var _hexToByte={};for(var j=0;j<256;j++){_byteToHex[j]=(j+256).toString(16).substr(1);_hexToByte[_byteToHex[j]]=j}var msecs=options.msecs!=null?options.msecs:(new Date).getTime();var nsecs=options.nsecs!=null?options.nsecs:this._lastNSecs+1;var dt=msecs-this._lastMSecs+(nsecs-this._lastNSecs)/1e4;if(dt<0&&options.clockseq==null){clockseq=clockseq+1&16383}if((dt<0||msecs>this._lastMSecs)&&options.nsecs==null){nsecs=0}if(nsecs>=1e4){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}this._lastMSecs=msecs;this._lastNSecs=nsecs;this._clockseq=clockseq;msecs+=122192928e5;var tl=((msecs&268435455)*1e4+nsecs)%4294967296;b[i++]=tl>>>24&255;b[i++]=tl>>>16&255;b[i++]=tl>>>8&255;b[i++]=tl&255;var tmh=msecs/4294967296*1e4&268435455;b[i++]=tmh>>>8&255;b[i++]=tmh&255;b[i++]=tmh>>>24&15|16;b[i++]=tmh>>>16&255;b[i++]=clockseq>>>8|128;b[i++]=clockseq&255;var node=options.node||_nodeId;for(var n=0;n<6;n++){b[i+n]=node[n]}function unparse(_buf,offset){var i=offset||0,bth=_byteToHex;return bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]+bth[_buf[i++]]}return buf?buf:unparse(b)};Uploader.prototype.options=function(options){if(arguments.length===0){return this._options}$.extend(this._options,options)};Uploader.prototype.option=function(key,val){if(arguments.length==1){return this._options[key]}this._options[key]=val};Uploader.prototype.i18n=function(){var args=Array.prototype.slice.call(arguments);var key=args.shift();var locale=this._options.locale;var translated=I18N[locale]&&I18N[locale][key]||I18N.en[key];if(!translated){throw new Error("Unknown i18n key: "+key)}return sprintf(translated,args)}}(window.jQuery);jQuery.easing["jswing"]=jQuery.easing["swing"];jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t+b;return-c/2*(--t*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t+b;return c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t+b;return-c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t*t+b;return c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return t==0?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return t==d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)<1)return c/2*Math.pow(2,10*(t-1))+b;return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1)return-c/2*(Math.sqrt(1-t*t)-1)+b;return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d/2)==2)return b+c;if(!p)p=d*(.3*1.5);if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b},easeInBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;if((t/=d/2)<1)return c/2*(t*t*(((s*=1.525)+1)*t-s))+b;return c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){if((t/=d)<1/2.75){return c*(7.5625*t*t)+b}else if(t<2/2.75){return c*(7.5625*(t-=1.5/2.75)*t+.75)+b}else if(t<2.5/2.75){return c*(7.5625*(t-=2.25/2.75)*t+.9375)+b}else{return c*(7.5625*(t-=2.625/2.75)*t+.984375)+b}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2)return jQuery.easing.easeInBounce(x,t*2,0,c,d)*.5+b;return jQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*.5+c*.5+b}});(function($){function noop(){}function genericCallback(data){lastValue=[data]}function callIfDefined(method,object,parameters){return method&&method.apply(object.context||object,parameters)}function qMarkOrAmp(url){return/\?/.test(url)?"&":"?"}var STR_ASYNC="async",STR_CHARSET="charset",STR_EMPTY="",STR_ERROR="error",STR_INSERT_BEFORE="insertBefore",STR_JQUERY_JSONP="_jqjsp",STR_ON="on",STR_ON_CLICK=STR_ON+"click",STR_ON_ERROR=STR_ON+STR_ERROR,STR_ON_LOAD=STR_ON+"load",STR_ON_READY_STATE_CHANGE=STR_ON+"readystatechange",STR_READY_STATE="readyState",STR_REMOVE_CHILD="removeChild",STR_SCRIPT_TAG="<script>",STR_SUCCESS="success",STR_TIMEOUT="timeout",win=window,Deferred=$.Deferred,head=$("head")[0]||document.documentElement,pageCache={},count=0,lastValue,xOptionsDefaults={callback:STR_JQUERY_JSONP,url:location.href},opera=win.opera,oldIE=!!$("<div>").html("<!--[if IE]><i><![endif]-->").find("i").length;function jsonp(xOptions){xOptions=$.extend({},xOptionsDefaults,xOptions);var successCallback=xOptions.success,errorCallback=xOptions.error,completeCallback=xOptions.complete,dataFilter=xOptions.dataFilter,callbackParameter=xOptions.callbackParameter,successCallbackName=xOptions.callback,cacheFlag=xOptions.cache,pageCacheFlag=xOptions.pageCache,charset=xOptions.charset,url=xOptions.url,data=xOptions.data,timeout=xOptions.timeout,pageCached,done=0,cleanUp=noop,supportOnload,supportOnreadystatechange,firstChild,script,scriptAfter,timeoutTimer;Deferred&&Deferred(function(defer){defer.done(successCallback).fail(errorCallback);successCallback=defer.resolve;errorCallback=defer.reject}).promise(xOptions);xOptions.abort=function(){!done++&&cleanUp()};if(callIfDefined(xOptions.beforeSend,xOptions,[xOptions])===!1||done){return xOptions}url=url||STR_EMPTY;data=data?typeof data=="string"?data:$.param(data,xOptions.traditional):STR_EMPTY;url+=data?qMarkOrAmp(url)+data:STR_EMPTY;callbackParameter&&(url+=qMarkOrAmp(url)+encodeURIComponent(callbackParameter)+"=?");!cacheFlag&&!pageCacheFlag&&(url+=qMarkOrAmp(url)+"_"+(new Date).getTime()+"=");url=url.replace(/=\?(&|$)/,"="+successCallbackName+"$1");function notifySuccess(json){if(!done++){cleanUp();pageCacheFlag&&(pageCache[url]={s:[json]});dataFilter&&(json=dataFilter.apply(xOptions,[json]));callIfDefined(successCallback,xOptions,[json,STR_SUCCESS,xOptions]);callIfDefined(completeCallback,xOptions,[xOptions,STR_SUCCESS])}}function notifyError(type){if(!done++){cleanUp();pageCacheFlag&&type!=STR_TIMEOUT&&(pageCache[url]=type);callIfDefined(errorCallback,xOptions,[xOptions,type]);callIfDefined(completeCallback,xOptions,[xOptions,type])}}if(pageCacheFlag&&(pageCached=pageCache[url])){pageCached.s?notifySuccess(pageCached.s[0]):notifyError(pageCached)}else{win[successCallbackName]=genericCallback;script=$(STR_SCRIPT_TAG)[0];script.id=STR_JQUERY_JSONP+count++;if(charset){script[STR_CHARSET]=charset}opera&&opera.version()<11.6?(scriptAfter=$(STR_SCRIPT_TAG)[0]).text="document.getElementById('"+script.id+"')."+STR_ON_ERROR+"()":script[STR_ASYNC]=STR_ASYNC;if(oldIE){script.htmlFor=script.id;script.event=STR_ON_CLICK}script[STR_ON_LOAD]=script[STR_ON_ERROR]=script[STR_ON_READY_STATE_CHANGE]=function(result){if(!script[STR_READY_STATE]||!/i/.test(script[STR_READY_STATE])){try{script[STR_ON_CLICK]&&script[STR_ON_CLICK]()}catch(_){}result=lastValue;lastValue=0;result?notifySuccess(result[0]):notifyError(STR_ERROR)}};script.src=url;cleanUp=function(i){timeoutTimer&&clearTimeout(timeoutTimer);script[STR_ON_READY_STATE_CHANGE]=script[STR_ON_LOAD]=script[STR_ON_ERROR]=null;head[STR_REMOVE_CHILD](script);scriptAfter&&head[STR_REMOVE_CHILD](scriptAfter)};head[STR_INSERT_BEFORE](script,firstChild=head.firstChild);scriptAfter&&head[STR_INSERT_BEFORE](scriptAfter,firstChild);timeoutTimer=timeout>0&&setTimeout(function(){notifyError(STR_TIMEOUT)},timeout)}return xOptions}jsonp.setup=function(xOptions){$.extend(xOptionsDefaults,xOptions)};$.jsonp=jsonp})(jQuery);(function($){$.tools=$.tools||{version:"2013-02-15"};var tool=$.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",zIndex:9998,opacity:.8,startOpacity:0,color:"#fff"}};var mask,exposed,loaded,config,overlayIndex;$.mask={load:function(conf,els){if(loaded){return this}conf=conf||config;config=conf=$.extend($.extend({},tool.conf),conf);mask=$("#"+conf.maskId);if(!mask.length){mask=$("<div/>").attr("id",conf.maskId);$("body").append(mask)}mask.css({position:"fixed",top:0,left:0,width:"100%",height:"100%",display:"block",opacity:conf.opacity,zIndex:conf.zIndex,backgroundColor:conf.color});if(els&&els.length){overlayIndex=els.eq(0).css("zIndex");exposed=els.css({zIndex:Math.max(conf.zIndex+1,overlayIndex=="auto"?0:overlayIndex)})}loaded=true;return this},close:function(){if(loaded){mask.fadeOut(config.closeSpeed,function(){if(exposed){exposed.css({zIndex:overlayIndex})}});loaded=false}return this}};$.fn.mask=function(conf){$.mask.load(conf);return this};$.fn.expose=function(conf){$.mask.load(conf,this);return this}})(jQuery);(function($){$.Jcrop=function(obj,opt){var options=$.extend({},$.Jcrop.defaults),docOffset,_ua=navigator.userAgent.toLowerCase(),is_msie=/msie/.test(_ua),ie6mode=/msie [1-6]\./.test(_ua);function px(n){return Math.round(n)+"px"}function cssClass(cl){return options.baseClass+"-"+cl}function supportsColorFade(){return $.fx.step.hasOwnProperty("backgroundColor")}function getPos(obj){var pos=$(obj).offset();return[pos.left,pos.top]}function mouseAbs(e){return[e.pageX-docOffset[0],e.pageY-docOffset[1]]}function setOptions(opt){if(typeof opt!=="object")opt={};options=$.extend(options,opt);$.each(["onChange","onSelect","onRelease","onDblClick"],function(i,e){if(typeof options[e]!=="function")options[e]=function(){}})}function startDragMode(mode,pos,touch){docOffset=getPos($img);Tracker.setCursor(mode==="move"?mode:mode+"-resize");if(mode==="move"){return Tracker.activateHandlers(createMover(pos),doneSelect,touch)}var fc=Coords.getFixed();var opp=oppLockCorner(mode);var opc=Coords.getCorner(oppLockCorner(opp));Coords.setPressed(Coords.getCorner(opp));Coords.setCurrent(opc);Tracker.activateHandlers(dragmodeHandler(mode,fc),doneSelect,touch)}function dragmodeHandler(mode,f){return function(pos){if(!options.aspectRatio){switch(mode){case"e":pos[1]=f.y2;break;case"w":pos[1]=f.y2;break;case"n":pos[0]=f.x2;break;case"s":pos[0]=f.x2;break}}else{switch(mode){case"e":pos[1]=f.y+1;break;case"w":pos[1]=f.y+1;break;case"n":pos[0]=f.x+1;break;case"s":pos[0]=f.x+1;break}}Coords.setCurrent(pos);Selection.update()}}function createMover(pos){var lloc=pos;KeyManager.watchKeys();return function(pos){Coords.moveOffset([pos[0]-lloc[0],pos[1]-lloc[1]]);lloc=pos;Selection.update()}}function oppLockCorner(ord){switch(ord){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function createDragger(ord){return function(e){if(options.disabled){return false}if(ord==="move"&&!options.allowMove){return false}docOffset=getPos($img);btndown=true;startDragMode(ord,mouseAbs(e));e.stopPropagation();e.preventDefault();return false}}function presize($obj,w,h){var nw=$obj.width(),nh=$obj.height();if(nw>w&&w>0){nw=w;nh=w/$obj.width()*$obj.height()}if(nh>h&&h>0){nh=h;nw=h/$obj.height()*$obj.width()}xscale=$obj.width()/nw;yscale=$obj.height()/nh;$obj.width(nw).height(nh)}function unscale(c){return{x:c.x*xscale,y:c.y*yscale,x2:c.x2*xscale,y2:c.y2*yscale,w:c.w*xscale,h:c.h*yscale}}function doneSelect(pos){var c=Coords.getFixed();if(c.w>options.minSelect[0]&&c.h>options.minSelect[1]){Selection.enableHandles();Selection.done()}else{Selection.release()}Tracker.setCursor(options.allowSelect?"crosshair":"default")}function newSelection(e){if(options.disabled){return false}if(!options.allowSelect){return false}btndown=true;docOffset=getPos($img);Selection.disableHandles();Tracker.setCursor("crosshair");var pos=mouseAbs(e);Coords.setPressed(pos);Selection.update();Tracker.activateHandlers(selectDrag,doneSelect,e.type.substring(0,5)==="touch");KeyManager.watchKeys();e.stopPropagation();e.preventDefault();return false}function selectDrag(pos){Coords.setCurrent(pos);Selection.update()}function newTracker(){var trk=$("<div></div>").addClass(cssClass("tracker"));if(is_msie){trk.css({opacity:0,backgroundColor:"white"})}return trk}if(typeof obj!=="object"){obj=$(obj)[0]}if(typeof opt!=="object"){opt={}}setOptions(opt);var img_css={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0};var $origimg=$(obj),img_mode=true;if(obj.tagName=="IMG"){if($origimg[0].width!=0&&$origimg[0].height!=0){$origimg.width($origimg[0].width);$origimg.height($origimg[0].height)}else{var tempImage=new Image;tempImage.src=$origimg[0].src;$origimg.width(tempImage.width);$origimg.height(tempImage.height)}var $img=$origimg.clone().removeAttr("id").css(img_css).show();$img.width($origimg.width());$img.height($origimg.height());$origimg.after($img).hide()}else{$img=$origimg.css(img_css).show();img_mode=false;if(options.shade===null){options.shade=true}}presize($img,options.boxWidth,options.boxHeight);var boundx=$img.width(),boundy=$img.height(),$div=$("<div />").width(boundx).height(boundy).addClass(cssClass("holder")).css({position:"relative",backgroundColor:options.bgColor}).insertAfter($origimg).append($img);if(options.addClass){$div.addClass(options.addClass)}var $img2=$("<div />"),$img_holder=$("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),$hdl_holder=$("<div />").width("100%").height("100%").css("zIndex",320),$sel=$("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var c=Coords.getFixed();options.onDblClick.call(api,c)}).insertBefore($img).append($img_holder,$hdl_holder);if(img_mode){$img2=$("<img />").attr("src",$img.attr("src")).css(img_css).width(boundx).height(boundy),$img_holder.append($img2)}if(ie6mode){$sel.css({overflowY:"hidden"})}var bound=options.boundary;var $trk=newTracker().width(boundx+bound*2).height(boundy+bound*2).css({position:"absolute",top:px(-bound),left:px(-bound),zIndex:290}).mousedown(newSelection);var bgcolor=options.bgColor,bgopacity=options.bgOpacity,xlimit,ylimit,xmin,ymin,xscale,yscale,enabled=true,btndown,animating,shift_down;docOffset=getPos($img);var Touch=function(){function hasTouchSupport(){var support={},events=["touchstart","touchmove","touchend"],el=document.createElement("div"),i;try{for(i=0;i<events.length;i++){var eventName=events[i];eventName="on"+eventName;var isSupported=eventName in el;if(!isSupported){el.setAttribute(eventName,"return;");isSupported=typeof el[eventName]=="function"}support[events[i]]=isSupported}return support.touchstart&&support.touchend&&support.touchmove}catch(err){return false}}function detectSupport(){if(options.touchSupport===true||options.touchSupport===false)return options.touchSupport;else return hasTouchSupport()}return{createDragger:function(ord){return function(e){if(options.disabled){return false}if(ord==="move"&&!options.allowMove){return false}docOffset=getPos($img);btndown=true;startDragMode(ord,mouseAbs(Touch.cfilter(e)),true);e.stopPropagation();e.preventDefault();return false}},newSelection:function(e){return newSelection(Touch.cfilter(e))},cfilter:function(e){e.pageX=e.originalEvent.changedTouches[0].pageX;e.pageY=e.originalEvent.changedTouches[0].pageY;return e},isSupported:hasTouchSupport,support:detectSupport()}}();var Coords=function(){var x1=0,y1=0,x2=0,y2=0,ox,oy;function setPressed(pos){pos=rebound(pos);x2=x1=pos[0];y2=y1=pos[1]}function setCurrent(pos){pos=rebound(pos);ox=pos[0]-x2;oy=pos[1]-y2;x2=pos[0];y2=pos[1]}function getOffset(){return[ox,oy]}function moveOffset(offset){var ox=offset[0],oy=offset[1];if(0>x1+ox){ox-=ox+x1}if(0>y1+oy){oy-=oy+y1}if(boundy<y2+oy){oy+=boundy-(y2+oy)}if(boundx<x2+ox){ox+=boundx-(x2+ox)}x1+=ox;x2+=ox;y1+=oy;y2+=oy}function getCorner(ord){var c=getFixed();switch(ord){case"ne":return[c.x2,c.y];case"nw":return[c.x,c.y];case"se":return[c.x2,c.y2];case"sw":return[c.x,c.y2]}}function getFixed(){if(!options.aspectRatio){return getRect()}var aspect=options.aspectRatio,min_x=options.minSize[0]/xscale,max_x=options.maxSize[0]/xscale,max_y=options.maxSize[1]/yscale,rw=x2-x1,rh=y2-y1,rwa=Math.abs(rw),rha=Math.abs(rh),real_ratio=rwa/rha,xx,yy,w,h;if(max_x===0){max_x=boundx*10}if(max_y===0){max_y=boundy*10}if(real_ratio<aspect){yy=y2;w=rha*aspect;xx=rw<0?x1-w:w+x1;if(xx<0){xx=0;h=Math.abs((xx-x1)/aspect);yy=rh<0?y1-h:h+y1}else if(xx>boundx){xx=boundx;h=Math.abs((xx-x1)/aspect);yy=rh<0?y1-h:h+y1}}else{xx=x2;h=rwa/aspect;yy=rh<0?y1-h:y1+h;if(yy<0){yy=0;w=Math.abs((yy-y1)*aspect);xx=rw<0?x1-w:w+x1}else if(yy>boundy){yy=boundy;w=Math.abs(yy-y1)*aspect;xx=rw<0?x1-w:w+x1}}if(xx>x1){if(xx-x1<min_x){xx=x1+min_x}else if(xx-x1>max_x){xx=x1+max_x}if(yy>y1){yy=y1+(xx-x1)/aspect}else{yy=y1-(xx-x1)/aspect}}else if(xx<x1){if(x1-xx<min_x){xx=x1-min_x}else if(x1-xx>max_x){xx=x1-max_x}if(yy>y1){yy=y1+(x1-xx)/aspect}else{yy=y1-(x1-xx)/aspect}}if(xx<0){x1-=xx;xx=0}else if(xx>boundx){x1-=xx-boundx;xx=boundx}if(yy<0){y1-=yy;yy=0}else if(yy>boundy){y1-=yy-boundy;yy=boundy}return makeObj(flipCoords(x1,y1,xx,yy))}function rebound(p){if(p[0]<0)p[0]=0;if(p[1]<0)p[1]=0;if(p[0]>boundx)p[0]=boundx;if(p[1]>boundy)p[1]=boundy;return[Math.round(p[0]),Math.round(p[1])]}function flipCoords(x1,y1,x2,y2){var xa=x1,xb=x2,ya=y1,yb=y2;if(x2<x1){xa=x2;xb=x1}if(y2<y1){ya=y2;yb=y1}return[xa,ya,xb,yb]}function getRect(){var xsize=x2-x1,ysize=y2-y1,delta;if(xlimit&&Math.abs(xsize)>xlimit){x2=xsize>0?x1+xlimit:x1-xlimit}if(ylimit&&Math.abs(ysize)>ylimit){y2=ysize>0?y1+ylimit:y1-ylimit}if(ymin/yscale&&Math.abs(ysize)<ymin/yscale){y2=ysize>0?y1+ymin/yscale:y1-ymin/yscale}if(xmin/xscale&&Math.abs(xsize)<xmin/xscale){x2=xsize>0?x1+xmin/xscale:x1-xmin/xscale}if(x1<0){x2-=x1;x1-=x1}if(y1<0){y2-=y1;y1-=y1}if(x2<0){x1-=x2;x2-=x2}if(y2<0){y1-=y2;y2-=y2}if(x2>boundx){delta=x2-boundx;x1-=delta;x2-=delta}if(y2>boundy){delta=y2-boundy;y1-=delta;y2-=delta}if(x1>boundx){delta=x1-boundy;y2-=delta;y1-=delta}if(y1>boundy){delta=y1-boundy;y2-=delta;y1-=delta}return makeObj(flipCoords(x1,y1,x2,y2))}function makeObj(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}return{flipCoords:flipCoords,setPressed:setPressed,setCurrent:setCurrent,getOffset:getOffset,moveOffset:moveOffset,getCorner:getCorner,getFixed:getFixed}}();var Shade=function(){var enabled=false,holder=$("<div />").css({position:"absolute",zIndex:240,opacity:0}),shades={top:createShade(),left:createShade().height(boundy),right:createShade().height(boundy),bottom:createShade()};function resizeShades(w,h){shades.left.css({height:px(h)});shades.right.css({height:px(h)})}function updateAuto(){return updateShade(Coords.getFixed())}function updateShade(c){shades.top.css({left:px(c.x),width:px(c.w),height:px(c.y)});shades.bottom.css({top:px(c.y2),left:px(c.x),width:px(c.w),height:px(boundy-c.y2)});shades.right.css({left:px(c.x2),width:px(boundx-c.x2)});shades.left.css({width:px(c.x)})}function createShade(){return $("<div />").css({position:"absolute",backgroundColor:options.shadeColor||options.bgColor}).appendTo(holder)}function enableShade(){if(!enabled){enabled=true;holder.insertBefore($img);updateAuto();Selection.setBgOpacity(1,0,1);$img2.hide();setBgColor(options.shadeColor||options.bgColor,1);if(Selection.isAwake()){setOpacity(options.bgOpacity,1)}else setOpacity(1,1)}}function setBgColor(color,now){colorChangeMacro(getShades(),color,now)}function disableShade(){if(enabled){holder.remove();$img2.show();enabled=false;if(Selection.isAwake()){Selection.setBgOpacity(options.bgOpacity,1,1)}else{Selection.setBgOpacity(1,1,1);Selection.disableHandles()}colorChangeMacro($div,0,1)}}function setOpacity(opacity,now){if(enabled){if(options.bgFade&&!now){holder.animate({opacity:1-opacity},{queue:false,duration:options.fadeTime})}else holder.css({opacity:1-opacity})}}function refreshAll(){options.shade?enableShade():disableShade();if(Selection.isAwake())setOpacity(options.bgOpacity)}function getShades(){return holder.children()}return{update:updateAuto,updateRaw:updateShade,getShades:getShades,setBgColor:setBgColor,enable:enableShade,disable:disableShade,resize:resizeShades,refresh:refreshAll,opacity:setOpacity}}();var Selection=function(){var awake,hdep=370,borders={},handle={},dragbar={},seehandles=false;function insertBorder(type){var jq=$("<div />").css({position:"absolute",opacity:options.borderOpacity}).addClass(cssClass(type));$img_holder.append(jq);return jq}function dragDiv(ord,zi){var jq=$("<div />").mousedown(createDragger(ord)).css({cursor:ord+"-resize",position:"absolute",zIndex:zi}).addClass("ord-"+ord);if(Touch.support){jq.bind("touchstart.jcrop",Touch.createDragger(ord))}$hdl_holder.append(jq);return jq}function insertHandle(ord){var hs=options.handleSize,div=dragDiv(ord,hdep++).css({opacity:options.handleOpacity}).addClass(cssClass("handle"));if(hs){div.width(hs).height(hs)}return div}function insertDragbar(ord){return dragDiv(ord,hdep++).addClass("jcrop-dragbar")}function createDragbars(li){var i;for(i=0;i<li.length;i++){dragbar[li[i]]=insertDragbar(li[i])}}function createBorders(li){var cl,i;for(i=0;i<li.length;i++){switch(li[i]){case"n":cl="hline";break;case"s":cl="hline bottom";break;case"e":cl="vline right";break;case"w":cl="vline";break}borders[li[i]]=insertBorder(cl)}}function createHandles(li){var i;for(i=0;i<li.length;i++){handle[li[i]]=insertHandle(li[i])}}function moveto(x,y){if(!options.shade){$img2.css({top:px(-y),left:px(-x)})}$sel.css({top:px(y),left:px(x)})}function resize(w,h){$sel.width(Math.round(w)).height(Math.round(h))}function refresh(){var c=Coords.getFixed();Coords.setPressed([c.x,c.y]);Coords.setCurrent([c.x2,c.y2]);updateVisible()}function updateVisible(select){if(awake){return update(select)}}function update(select){var c=Coords.getFixed();resize(c.w,c.h);moveto(c.x,c.y);if(options.shade)Shade.updateRaw(c);awake||show();if(select){options.onSelect.call(api,unscale(c))}else{options.onChange.call(api,unscale(c))}}function setBgOpacity(opacity,force,now){if(!awake&&!force)return;if(options.bgFade&&!now){$img.animate({opacity:opacity},{queue:false,duration:options.fadeTime})}else{$img.css("opacity",opacity)}}function show(){$sel.show();if(options.shade)Shade.opacity(bgopacity);else setBgOpacity(bgopacity,true);awake=true}function release(){disableHandles();$sel.hide();if(options.shade)Shade.opacity(1);else setBgOpacity(1);awake=false;options.onRelease.call(api)}function showHandles(){if(seehandles){$hdl_holder.show()}}function enableHandles(){seehandles=true;if(options.allowResize){$hdl_holder.show();return true}}function disableHandles(){seehandles=false;$hdl_holder.hide()}function animMode(v){if(v){animating=true;disableHandles()}else{animating=false;enableHandles()}}function done(){animMode(false);refresh()}if(options.dragEdges&&$.isArray(options.createDragbars))createDragbars(options.createDragbars);if($.isArray(options.createHandles))createHandles(options.createHandles);if(options.drawBorders&&$.isArray(options.createBorders))createBorders(options.createBorders);$(document).bind("touchstart.jcrop-ios",function(e){if($(e.currentTarget).hasClass("jcrop-tracker"))e.stopPropagation()});var $track=newTracker().mousedown(createDragger("move")).css({cursor:"move",position:"absolute",zIndex:360});if(Touch.support){$track.bind("touchstart.jcrop",Touch.createDragger("move"))}$img_holder.append($track);disableHandles();return{updateVisible:updateVisible,update:update,release:release,refresh:refresh,isAwake:function(){return awake},setCursor:function(cursor){$track.css("cursor",cursor)},enableHandles:enableHandles,enableOnly:function(){seehandles=true},showHandles:showHandles,disableHandles:disableHandles,animMode:animMode,setBgOpacity:setBgOpacity,done:done}}();var Tracker=function(){var onMove=function(){},onDone=function(){},trackDoc=options.trackDocument;function toFront(touch){$trk.css({zIndex:450});if(touch)$(document).bind("touchmove.jcrop",trackTouchMove).bind("touchend.jcrop",trackTouchEnd);else if(trackDoc)$(document).bind("mousemove.jcrop",trackMove).bind("mouseup.jcrop",trackUp)}function toBack(){$trk.css({zIndex:290});$(document).unbind(".jcrop")}function trackMove(e){onMove(mouseAbs(e));return false}function trackUp(e){e.preventDefault();e.stopPropagation();if(btndown){btndown=false;onDone(mouseAbs(e));if(Selection.isAwake()){options.onSelect.call(api,unscale(Coords.getFixed()))}toBack();onMove=function(){};onDone=function(){}}return false}function activateHandlers(move,done,touch){btndown=true;onMove=move;onDone=done;toFront(touch);return false}function trackTouchMove(e){onMove(mouseAbs(Touch.cfilter(e)));return false}function trackTouchEnd(e){return trackUp(Touch.cfilter(e))}function setCursor(t){$trk.css("cursor",t)}if(!trackDoc){$trk.mousemove(trackMove).mouseup(trackUp).mouseout(trackUp)}$img.before($trk);return{activateHandlers:activateHandlers,setCursor:setCursor}}();var KeyManager=function(){var $keymgr=$('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),$keywrap=$("<div />").css({position:"absolute",overflow:"hidden"}).append($keymgr);function watchKeys(){if(options.keySupport){$keymgr.show();$keymgr.focus()}}function onBlur(e){$keymgr.hide()}function doNudge(e,x,y){if(options.allowMove){Coords.moveOffset([x,y]);Selection.updateVisible(true)}e.preventDefault();e.stopPropagation()}function parseKey(e){if(e.ctrlKey||e.metaKey){return true}shift_down=e.shiftKey?true:false;var nudge=shift_down?10:1;switch(e.keyCode){case 37:doNudge(e,-nudge,0);break;case 39:doNudge(e,nudge,0);break;case 38:doNudge(e,0,-nudge);break;case 40:doNudge(e,0,nudge);break;case 27:if(options.allowSelect)Selection.release();break;case 9:return true}return false}if(options.keySupport){$keymgr.keydown(parseKey).blur(onBlur);if(ie6mode||!options.fixedSupport){$keymgr.css({position:"absolute",left:"-20px"});$keywrap.append($keymgr).insertBefore($img)}else{$keymgr.insertBefore($img)}}return{watchKeys:watchKeys}}();function setClass(cname){$div.removeClass().addClass(cssClass("holder")).addClass(cname)}function animateTo(a,callback){var x1=a[0]/xscale,y1=a[1]/yscale,x2=a[2]/xscale,y2=a[3]/yscale;if(animating){return}var animto=Coords.flipCoords(x1,y1,x2,y2),c=Coords.getFixed(),initcr=[c.x,c.y,c.x2,c.y2],animat=initcr,interv=options.animationDelay,ix1=animto[0]-initcr[0],iy1=animto[1]-initcr[1],ix2=animto[2]-initcr[2],iy2=animto[3]-initcr[3],pcent=0,velocity=options.swingSpeed;x1=animat[0];y1=animat[1];x2=animat[2];y2=animat[3];Selection.animMode(true);var anim_timer;function queueAnimator(){window.setTimeout(animator,interv)}var animator=function(){return function(){pcent+=(100-pcent)/velocity;animat[0]=Math.round(x1+pcent/100*ix1);animat[1]=Math.round(y1+pcent/100*iy1);animat[2]=Math.round(x2+pcent/100*ix2);animat[3]=Math.round(y2+pcent/100*iy2);if(pcent>=99.8){pcent=100}if(pcent<100){setSelectRaw(animat);queueAnimator()}else{Selection.done();Selection.animMode(false);if(typeof callback==="function"){callback.call(api)}}}}();queueAnimator()}function setSelect(rect){setSelectRaw([rect[0]/xscale,rect[1]/yscale,rect[2]/xscale,rect[3]/yscale]);options.onSelect.call(api,unscale(Coords.getFixed()));Selection.enableHandles()}function setSelectRaw(l){Coords.setPressed([l[0],l[1]]);Coords.setCurrent([l[2],l[3]]);Selection.update()}function tellSelect(){return unscale(Coords.getFixed())}function tellScaled(){return Coords.getFixed()}function setOptionsNew(opt){setOptions(opt);interfaceUpdate()}function disableCrop(){options.disabled=true;Selection.disableHandles();Selection.setCursor("default");Tracker.setCursor("default")}function enableCrop(){options.disabled=false;interfaceUpdate()}function cancelCrop(){Selection.done();Tracker.activateHandlers(null,null)}function destroy(){$div.remove();$origimg.show();$origimg.css("visibility","visible");$(obj).removeData("Jcrop")}function setImage(src,callback){Selection.release();disableCrop();var img=new Image;img.onload=function(){var iw=img.width;var ih=img.height;var bw=options.boxWidth;var bh=options.boxHeight;$img.width(iw).height(ih);$img.attr("src",src);$img2.attr("src",src);presize($img,bw,bh);boundx=$img.width();boundy=$img.height();$img2.width(boundx).height(boundy);$trk.width(boundx+bound*2).height(boundy+bound*2);$div.width(boundx).height(boundy);Shade.resize(boundx,boundy);enableCrop();if(typeof callback==="function"){callback.call(api)}};img.src=src}function colorChangeMacro($obj,color,now){var mycolor=color||options.bgColor;if(options.bgFade&&supportsColorFade()&&options.fadeTime&&!now){$obj.animate({backgroundColor:mycolor},{queue:false,duration:options.fadeTime})}else{$obj.css("backgroundColor",mycolor)}}function interfaceUpdate(alt){if(options.allowResize){if(alt){Selection.enableOnly()}else{Selection.enableHandles()}}else{Selection.disableHandles()}Tracker.setCursor(options.allowSelect?"crosshair":"default");Selection.setCursor(options.allowMove?"move":"default");if(options.hasOwnProperty("trueSize")){xscale=options.trueSize[0]/boundx;yscale=options.trueSize[1]/boundy}if(options.hasOwnProperty("setSelect")){setSelect(options.setSelect);Selection.done();delete options.setSelect}Shade.refresh();if(options.bgColor!=bgcolor){colorChangeMacro(options.shade?Shade.getShades():$div,options.shade?options.shadeColor||options.bgColor:options.bgColor);bgcolor=options.bgColor}if(bgopacity!=options.bgOpacity){bgopacity=options.bgOpacity;if(options.shade)Shade.refresh();else Selection.setBgOpacity(bgopacity)}xlimit=options.maxSize[0]||0;ylimit=options.maxSize[1]||0;xmin=options.minSize[0]||0;ymin=options.minSize[1]||0;if(options.hasOwnProperty("outerImage")){$img.attr("src",options.outerImage);delete options.outerImage}Selection.refresh()}if(Touch.support)$trk.bind("touchstart.jcrop",Touch.newSelection);
$hdl_holder.hide();interfaceUpdate(true);var api={setImage:setImage,animateTo:animateTo,setSelect:setSelect,setOptions:setOptionsNew,tellSelect:tellSelect,tellScaled:tellScaled,setClass:setClass,disable:disableCrop,enable:enableCrop,cancel:cancelCrop,release:Selection.release,destroy:destroy,focus:KeyManager.watchKeys,getBounds:function(){return[boundx*xscale,boundy*yscale]},getWidgetSize:function(){return[boundx,boundy]},getScaleFactor:function(){return[xscale,yscale]},getOptions:function(){return options},ui:{holder:$div,selection:$sel}};if(is_msie)$div.bind("selectstart",function(){return false});$origimg.data("Jcrop",api);return api};$.fn.Jcrop=function(options,callback){var api;this.each(function(){if($(this).data("Jcrop")){if(options==="api")return $(this).data("Jcrop");else $(this).data("Jcrop").setOptions(options)}else{if(this.tagName=="IMG")$.Jcrop.Loader(this,function(){$(this).css({display:"block",visibility:"hidden"});api=$.Jcrop(this,options);if($.isFunction(callback))callback.call(api)});else{$(this).css({display:"block",visibility:"hidden"});api=$.Jcrop(this,options);if($.isFunction(callback))callback.call(api)}}});return this};$.Jcrop.Loader=function(imgobj,success,error){var $img=$(imgobj),img=$img[0];function completeCheck(){if(img.complete){$img.unbind(".jcloader");if($.isFunction(success))success.call(img)}else window.setTimeout(completeCheck,50)}$img.bind("load.jcloader",completeCheck).bind("error.jcloader",function(e){$img.unbind(".jcloader");if($.isFunction(error))error.call(img)});if(img.complete&&$.isFunction(success)){$img.unbind(".jcloader");success.call(img)}};$.Jcrop.defaults={allowSelect:true,allowMove:true,allowResize:true,trackDocument:true,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:false,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:true,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:true,dragEdges:true,fixedSupport:true,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);DM.ImageUpload={init:function(id,conf){var that=this;this.conf=conf;this.resizeRatio=1;$(document).ready(function(){var file_upload=$("#file-upl");file_upload.val("").removeAttr("disabled");if($("#js-img-area img").length>0){that.preparePreLoadedImage($($("#js-img-area img")[0]))}$("#select-prfl-img").transloadit({wait:true,autoSubmit:false,modal:false,onStart:function(){$(".hldr-r .err").html("");$("#js-img-area").hide();$(".hldr-r .wrppr p").hide();that.startLoading()},onError:that.errorLoading,onCancel:that.cancelLoading,onSuccess:function(assembly){var result=assembly.results.reformat?assembly.results.reformat[0]:assembly.results.image_check[0],imgWidth=result.meta.width,imgHeight=result.meta.height,imgContainer=$("#js-img-area"),imgContainerWidth=imgContainer.width(),imgContainerHeight=imgContainer.height();if(imgWidth>imgContainerWidth){imgHeight=Math.round(imgHeight*(imgContainerWidth/imgWidth));imgWidth=imgContainerWidth}if(imgHeight>imgContainerHeight){imgWidth=Math.round(imgWidth*(imgContainerHeight/imgHeight));imgHeight=imgContainerHeight}that.resizeRatio=result.meta.width/imgWidth;$("#js-img-area").html('<img alt="image for cropping" src="'+result.url+'" width="'+imgWidth+'" height="'+imgHeight+'" class="d-n" />');$(".js-prvw-area").html('<img id="edit-prfl-img-prev" alt="image preview" src="'+result.url+'" width="'+result.meta.width+'" height="'+result.meta.height+'" class="d-n" />');$("#edit-prfl-img .image-url").val(result.url);$("#edit-prfl-img .image-width").val(result.meta.width);$("#edit-prfl-img .image-height").val(result.meta.height);that.makeEditable(that.conf.width,that.conf.height,that.resizeRatio,result.meta.width,result.meta.height);that.finishLoading()}});file_upload.bind("change",function(e){if(e.target.value){$($(e.target).parents("form")[0]).submit()}});$("#edit-prfl-img").transloadit({wait:true,fields:true,autoSubmit:true,modal:false});$("#edit-prfl-img .js-submit").parent().prepend('<b class="loading" style="visibility: hidden;"></b>');$(".wrppr").append($('<div class="loading f-12 gr4ox">The picture is being uploaded<br /></div>').append($('<a href="#">Cancel</a>').bind("click",function(e){$("#select-prfl-img").data("transloadit.uploader").cancel();e.preventDefault()})).hide());if(window.navigator.userAgent.indexOf("AppleWebKit")!==-1){file_upload.addClass("js-file-chooser").wrap('<div class="reg-fld cleared"></div>');file_upload.attr("size","9").parent().append('<button id="fake-file-chooser-btn" type="button" class="reg-btn wocc"><b class="arrow-small-r"></b><span class="f-18">Select an image</span></button>');$("#fake-file-chooser-btn").bind("click",function(e){$("#file-upl").click()})}})},preparePreLoadedImage:function(img){var imgWidth=img.width(),imgHeight=img.height(),imgContainer=$("#js-img-area"),imgContainerWidth=imgContainer.width(),imgContainerHeight=imgContainer.height();if(imgWidth>imgContainerWidth){imgHeight=Math.round(imgHeight*(imgContainerWidth/imgWidth));imgWidth=imgContainerWidth}if(imgHeight>imgContainerHeight){imgWidth=Math.round(imgWidth*(imgContainerHeight/imgHeight));imgHeight=imgContainerHeight}this.resizeRatio=img.width()/imgWidth;$("#js-img-area img").attr("width",imgWidth).attr("height",imgHeight);$(".js-prvw-area").html('<img id="edit-prfl-img-prev" alt="image preview" src="'+img.attr("src")+'" width="'+img.width()+'" height="'+img.height()+'" />');$("#edit-prfl-img .image-url").val(img.attr("src"));$("#edit-prfl-img .image-width").val(img.width());$("#edit-prfl-img .image-height").val(img.height());$(".hldr-r .wrppr p").hide();this.makeEditable(this.conf.width,this.conf.height,this.resizeRatio,img.width(),img.height());this.finishLoading()},makeEditable:function(width,height,resizeRatio,origWidth,origHeight){jQuery(function($){$("#js-img-area img").Jcrop({onSelect:function(c){var rx=Math.round(width/resizeRatio)/c.w;var ry=Math.round(height/resizeRatio)/c.h;$("#edit-prfl-img-prev").css({width:Math.round(rx*boundx*resizeRatio)+"px",height:Math.round(ry*boundy*resizeRatio)+"px",marginLeft:"-"+Math.round(rx*c.x*resizeRatio)+"px",marginTop:"-"+Math.round(ry*c.y*resizeRatio)+"px"});$("#x1").val(Math.floor(Math.round(c.x)*resizeRatio));$("#x2").val(Math.ceil(Math.round(c.x2)*resizeRatio));$("#y1").val(Math.floor(Math.round(c.y)*resizeRatio));$("#y2").val(Math.ceil(Math.round(c.y2)*resizeRatio))},aspectRatio:width/height,bgOpacity:.2,minSize:[Math.round(width/resizeRatio),Math.round(height/resizeRatio)]},function(){var bounds=this.getBounds();boundx=bounds[0];boundy=bounds[1];var minSizeX=this.getOptions().minSize[0],minSizeY=this.getOptions().minSize[1],preSelectX=Math.round(boundx/2)-Math.round(minSizeX/2),preSelectY=Math.round(boundy/2)-Math.round(minSizeY/2);this.ui.holder.css({left:Math.round((this.ui.holder.parent().width()-this.ui.holder.width())/2),top:Math.round((this.ui.holder.parent().height()-this.ui.holder.height())/2)});this.setSelect([preSelectX,preSelectY,preSelectX+minSizeX,preSelectY+minSizeY])});function updateCoordinates(c){var rx=Math.round(width/resizeRatio)/c.w;var ry=Math.round(height/resizeRatio)/c.h;$("#edit-prfl-img-prev").css({width:Math.round(rx*boundx*resizeRatio)+"px",height:Math.round(ry*boundy*resizeRatio)+"px",marginLeft:"-"+Math.round(rx*c.x*resizeRatio)+"px",marginTop:"-"+Math.round(ry*c.y*resizeRatio)+"px"});$("#x1").val(Math.floor(Math.round(c.x)*resizeRatio));$("#x2").val(Math.ceil(Math.round(c.x2)*resizeRatio));$("#y1").val(Math.floor(Math.round(c.y)*resizeRatio));$("#y2").val(Math.ceil(Math.round(c.y2)*resizeRatio))}});$(".js-submit").removeAttr("disabled").removeClass("reg-btn-dis");$("#edit-prfl-img .loading").css("visibility","hidden");$("#edit-prfl-img").submit(function(){$(".js-submit").attr("disabled","disabled").addClass("reg-btn-dis");$("#edit-prfl-img .loading").css("visibility","visible");$("#file-upl").attr("disabled","disabled")})},startLoading:function(){$(".hldr-r .loading").show();$(".hldr-r .wrppr p").hide();$("#js-img-area").hide();$(".js-prvw-area img").hide()},finishLoading:function(){$(".hldr-r .loading").hide();$("#js-img-area").show();$(".js-prvw-area img").show()},cancelLoading:function(){$(".hldr-r .loading").hide();if($("#js-img-area img").length===0){$(".hldr-r .wrppr p").show()}else{$("#js-img-area").show();$(".js-prvw-area img").show()}},errorLoading:function(result){$(".hldr-r .loading").hide();$(".hldr-r .err").html(result.message);$(".hldr-r .wrppr p").show()}};DM.later(["DOM_READY"],function(){window.cropWidth&&window.cropHeight&&DM.ImageUpload.init("prfl-edit-img",{width:window.cropWidth,height:window.cropHeight})});DM.EditSocial=function(id,conf){this.init(id,conf)};DM.EditSocial.prototype=function(){function submitForm(id){var form=id&&document.getElementById(id);if(form&&form.submit){form.submit()}}return{SEL_ANCHOR:".dms-profile-delete",SEL_BUBBLE:".dms-profile-confirm",SEL_CANCEL:".dms-profile-cancel",SEL_REMOVE:".dms-profile-remove",SEL_DELETE_DISABLED:".dms-profile-delete-disabled",bubbleTpl:"{content}",self:this,init:function(id,conf){this.el=Ext.get(id);if(!this.el){return}Ext.apply(this,conf);this.el.on("click",this.showBubble,this,{delegate:this.SEL_ANCHOR,preventDefault:true});Ext.select(this.SEL_DELETE_DISABLED).on("click",function(event){event.preventDefault()})},showBubble:function(ev,t){var tpl,elLink=Ext.get(t),bubble;elLink.blur();bubble=elLink.next(this.SEL_BUBBLE);if(bubble&&bubble.isVisible()){return false}if(this.activeBubble)this.hideBubble();if(!bubble){tpl=new Ext.Template(this.bubbleTpl).compile();bubble=tpl.insertAfter(elLink,{content:this.content},true);var self=this;bubble.child(this.SEL_CANCEL).on("click",function(event){event.preventDefault();self.hideBubble.createDelegate(self,[bubble])()});bubble.child(this.SEL_REMOVE).on("click",function(event){event.preventDefault();submitForm.createDelegate(self,[AND.getParams(elLink.dom)[0]])()})}bubble.setStyle("display","block");this.activeBubble=bubble},hideBubble:function(el){if(!el){el=this.activeBubble}el.setStyle("display","none")}}}();DM.SocialBtnPopup=function(id,conf){this.init(id,conf)};DM.SocialBtnPopup.prototype={init:function(id,conf){var that=this;this.el=Ext.get(id);if(!this.el){return}Ext.apply(this,conf);this.el.select("a").each(function(lnk){lnk.on("click",that.openPopup,lnk,{preventDefault:true})})},openPopup:function(ev,t){if(typeof DM.popup==="function"){var d=[500,500];ev.preventDefault();t=Ext.get(t);if(t.is(".btn-fb")){d=[500,500]}else if(t.is(".btn-twttr")){d=[800,790]}else if(t.is(".btn-ggl")){d=[450,500]}DM.popup(t.dom.href,d[0],d[1])}}};(function(window,define){var _={version:"2.5.0",areas:{},apis:{},inherit:function(api,o){for(var p in api){if(!o.hasOwnProperty(p)){o[p]=api[p]}}return o},stringify:function(d){return d===undefined||typeof d==="function"?d+"":JSON.stringify(d)},parse:function(s){try{return JSON.parse(s)}catch(e){return s}},fn:function(name,fn){_.storeAPI[name]=fn;for(var api in _.apis){_.apis[api][name]=fn}},get:function(area,key){return area.getItem(key)},set:function(area,key,string){area.setItem(key,string)},remove:function(area,key){area.removeItem(key)},key:function(area,i){return area.key(i)},length:function(area){return area.length},clear:function(area){area.clear()},Store:function(id,area,namespace){var store=_.inherit(_.storeAPI,function(key,data,overwrite){if(arguments.length===0){return store.getAll()}if(typeof data==="function"){return store.transact(key,data,overwrite)}if(data!==undefined){return store.set(key,data,overwrite)}if(typeof key==="string"||typeof key==="number"){return store.get(key)}if(!key){return store.clear()}return store.setAll(key,data)});store._id=id;try{var testKey="_safariPrivate_";area.setItem(testKey,"sucks");store._area=area;area.removeItem(testKey)}catch(e){}if(!store._area){store._area=_.inherit(_.storageAPI,{items:{},name:"fake"})}store._ns=namespace||"";if(!_.areas[id]){_.areas[id]=store._area}if(!_.apis[store._ns+store._id]){_.apis[store._ns+store._id]=store}return store},storeAPI:{area:function(id,area){var store=this[id];if(!store||!store.area){store=_.Store(id,area,this._ns);if(!this[id]){this[id]=store}}return store},namespace:function(namespace,noSession){if(!namespace){return this._ns?this._ns.substring(0,this._ns.length-1):""}var ns=namespace,store=this[ns];if(!store||!store.namespace){store=_.Store(this._id,this._area,this._ns+ns+".");if(!this[ns]){this[ns]=store}if(!noSession){store.area("session",_.areas.session)}}return store},isFake:function(){return this._area.name==="fake"},toString:function(){return"store"+(this._ns?"."+this.namespace():"")+"["+this._id+"]"},has:function(key){if(this._area.has){return this._area.has(this._in(key))}return!!(this._in(key)in this._area)},size:function(){return this.keys().length},each:function(fn,and){for(var i=0,m=_.length(this._area);i<m;i++){var key=this._out(_.key(this._area,i));if(key!==undefined){if(fn.call(this,key,and||this.get(key))===false){break}}if(m>_.length(this._area)){m--;i--}}return and||this},keys:function(){return this.each(function(k,list){list.push(k)},[])},get:function(key,alt){var s=_.get(this._area,this._in(key));return s!==null?_.parse(s):alt||s},getAll:function(){return this.each(function(k,all){all[k]=this.get(k)},{})},transact:function(key,fn,alt){var val=this.get(key,alt),ret=fn(val);this.set(key,ret===undefined?val:ret);return this},set:function(key,data,overwrite){var d=this.get(key);if(d!=null&&overwrite===false){return data}return _.set(this._area,this._in(key),_.stringify(data),overwrite)||d},setAll:function(data,overwrite){var changed,val;for(var key in data){val=data[key];if(this.set(key,val,overwrite)!==val){changed=true}}return changed},remove:function(key){var d=this.get(key);_.remove(this._area,this._in(key));return d},clear:function(){if(!this._ns){_.clear(this._area)}else{this.each(function(k){_.remove(this._area,this._in(k))},1)}return this},clearAll:function(){var area=this._area;for(var id in _.areas){if(_.areas.hasOwnProperty(id)){this._area=_.areas[id];this.clear()}}this._area=area;return this},_in:function(k){if(typeof k!=="string"){k=_.stringify(k)}return this._ns?this._ns+k:k},_out:function(k){return this._ns?k&&k.indexOf(this._ns)===0?k.substring(this._ns.length):undefined:k}},storageAPI:{length:0,has:function(k){return this.items.hasOwnProperty(k)},key:function(i){var c=0;for(var k in this.items){if(this.has(k)&&i===c++){return k}}},setItem:function(k,v){if(!this.has(k)){this.length++}this.items[k]=v},removeItem:function(k){if(this.has(k)){delete this.items[k];this.length--}},getItem:function(k){return this.has(k)?this.items[k]:null},clear:function(){for(var k in this.list){this.removeItem(k)}},toString:function(){return this.length+" items in "+this.name+"Storage"}}};var store=_.Store("local",function(){try{return localStorage}catch(e){}}());store.local=store;store._=_;store.area("session",function(){try{return sessionStorage}catch(e){}}());if(typeof define==="function"&&define.amd!==undefined){define("store2",[],function(){return store})}else if(typeof module!=="undefined"&&module.exports){module.exports=store}else{if(window.store){_.conflict=window.store}window.store=store}})(this,this.define);DM.RC=DM.RC||{};(function(){DM.RC.spinner=function(){if(isProfilePage())return;DM.RC.spinner=function spinner(option){var $rcContent=$(".rc-content"),$rcSpinner=$(".rc-spinner");var $jsComments=$("#js-comments"),options={show:{callback:function showSpinner(){$rcContent.append('<div class="rc-spinner"><img src="http://f.mol.im/i/furniture/fff/preload-inline.gif" />'+"<span>Loading...</span></div>");$jsComments.addClass("rc-transparent-comments-list")}},hide:{callback:function removeOpacity(){$rcSpinner=$(".rc-spinner");$jsComments.removeClass("rc-transparent-comments-list");$rcSpinner.remove()}}};options[option].callback&&options[option].callback()}};DM.RC.initialize=function(){if(isProfilePage())return;var $rcContent=$(".rc-content"),$jsComments=$("#js-comments");$rcContent.append('<div class="rc-spinner"><img src="http://f.mol.im/i/furniture/fff/preload-inline.gif" />'+"<span>Loading...</span></div>");$jsComments.addClass("rc-transparent-comments-list")};function isProfilePage(){return window.location.toString().indexOf("/registration/profile.html")>-1}})();DM.RC.FB=function($){"use strict";var fbrc={},store=window.store,Ext=window.Ext;fbrc.initialize=function(){var handlePostToFacebookInput=document.getElementById("handlePostToFacebookInput");if(handlePostToFacebookInput){readMessageFromCookie();setUpFbShareRC();updatePublishPermissionCheckboxState()}};function setUpFbShareRC(){var $fbShareWhatsThis=$(".fbShareWhatsThis");var $fbShareConfirmBox=$(".fbShareConfirmBox");$fbShareWhatsThis.appendTo($("body")).ezmodal().on("ez-modal-after-close",function(){if(DM.UD.publishPermission==="false"||!DM.UD.publishPermission){changeCheckBoxStatus(false)}});$fbShareConfirmBox.appendTo($("body")).ezmodal();$(".ez-modal-close, .js-close").click(function(){$fbShareConfirmBox.ezmodal("close");if(DM.UD.publishPermission==="false"||!DM.UD.publishPermission){changeCheckBoxStatus(false)}});$(".whatsThis").click(function(){$fbShareWhatsThis.ezmodal("open")});$(handlePostToFacebookInput).click(function(){handlePostToFacebook($(this)[0]);savePublishPermissionCheckboxState(handlePostToFacebookInput.checked)});handlePostToFacebookInput.checked=store.get("publishPermissionCheckbox");var paramValue=!DM.UD.fbUserName?"addAccountAndLogin":"noFbMergeNeeded";$(".fbConfirm").click(function(){if(handlePostToFacebookInput.checked&&(DM.UD.publishPermission==="false"||!DM.UD.publishPermission)){saveMessageInCookie();post_to_url("/registration/p/signin/social.html",{targetUrl:setParam(window.location.href,"requestPublishPermission","true"),"social-provider":"facebook","social-permissions":"publish_actions,email",param:paramValue})}})}function changeCheckBoxStatus(status){if(handlePostToFacebookInput){handlePostToFacebookInput.checked=status}savePublishPermissionCheckboxState("false")}function setParam(uri,key,val){return uri.replace(new RegExp("([?&]"+key+"(?=[=&#]|$)[^#&]*|(?=#|$))"),"&"+key+"="+encodeURIComponent(val)).replace(/^([^?&]+)&/,"$1?")}function post_to_url(path,params,method){method=method||"post";var form=document.createElement("form");form._submit_function_=form.submit;form.setAttribute("method",method);form.setAttribute("action",path);for(var key in params){var hiddenField=document.createElement("input");hiddenField.setAttribute("type","hidden");hiddenField.setAttribute("name",key);hiddenField.setAttribute("value",params[key]);form.appendChild(hiddenField)}document.body.appendChild(form);form._submit_function_()}function saveMessageInCookie(){var message=Ext.get("message");var messageVal=message.dom.value;var expireDate=new Date;expireDate.setHours(expireDate.getHours()+1);DM.setCookie("commentMessageToSaveCookie",messageVal,expireDate,"/")}function handlePostToFacebook(cb){if(cb.checked&&(DM.UD.publishPermission==="false"||!DM.UD.publishPermission)){$(".fbShareConfirmBox").ezmodal("open")}}function readMessageFromCookie(){var message=Ext.get("message");var commentMessageToSaveCookieValue=DM.getCookie("commentMessageToSaveCookie");if(commentMessageToSaveCookieValue&&message){message.dom.value=commentMessageToSaveCookieValue;var deleteDate=new Date;DM.setCookie("commentMessageToSaveCookie","",deleteDate,"/")}}function savePublishPermissionCheckboxState(booleanSetting){if(String(booleanSetting)!==store.get("publishPermissionCheckbox")){store.set("publishPermissionCheckbox",String(booleanSetting));persistSettingInRegistration(String(booleanSetting))}}function updatePublishPermissionCheckboxState(){handlePostToFacebookInput.checked=DM.UD.publishPermission==="true"}fbrc.isHandlePostToFacebookSelected=function(){if(document.getElementById("handlePostToFacebookInput")){return handlePostToFacebookInput.checked}return false};function persistSettingInRegistration(booleanValue){$.ajax({type:"POST",url:"/registration/p/api/setUserShareSettings",Accept:"application/json",contentType:"application/json",data:JSON.stringify({shareComment:booleanValue})})}return fbrc}(window.jQuery);DM.RC.Templates=function(){var ENTER_REPLY_TEXT="Enter your reply...",newCommentButtonTemplate=new Ext.Template('<button type="submit" class="btn anchor-comment js-newcomment newcomment-wide">New Comment</button>'+'<button type="submit" class="btn anchor-comment js-newcomment newcomment-small">New</button>').compile(),inlineSubmissionResponse=new Ext.Template('<div class="submission-message submission-{type}">'+'<div class="submission-feedback-icon"></div>'+'<div class="submission-feedback-message">{message}</div>{fbMessage}'+"</div>").compile(),reportAbuseHtml='<a class="reportAbuseLink" href="{abuseLink}" rel="nofollow">'+'<div title="Report abuse" class="reportAbuseIcon"></div>'+"</a>",articleCommentTemplate=new Ext.Template('<div id="comment-{commentId}" class="{type} {type}-post bogr1 cleared">'+reportAbuseHtml+'<div class="avatar">'+'<a href="{userProfileUrl}" class="rc-avatar-link">'+"<img "+'src="'+'{userProfileImageUrl}?cb={formattedCurrentDate}"'+'style="'+"width: {avatarSide}px;"+'clip: rect(0px {avatarSide}px {avatarSide}px 0px);"'+"onerror=\"this.style.display='none';\"/>"+"</a>"+"</div>"+'<div class="container">'+'<p class="user-info">{userInfo}</p>'+'<p class="{type}-body {type}-text">{body}</p>'+'<div class="rating {ratingClass}" rel="{commentId}">'+'<div class="reply-buttons">'+"{replyButtonHTML}"+"{newCommentButtonHTML}"+"</div>"+"{shareHTML}"+'<a class="js-rate js-rate-down" href="#">'+'<div class="rating-button grey-rating-button rating-button-down">'+'<div class="rate-down"></div>'+'<div class="rating-button-inline">{votesDownValue}</div>'+"</div>"+"</a>"+'<a class="js-rate js-rate-up" href="#">'+'<div class="rating-button grey-rating-button rating-button-up">'+'<div class="rate-up"></div>'+'<div class="rating-button-inline">{votesUpValue}</div>'+"</div>"+"</a>"+'<span style="float:right;" class="gr5ox">{voteButtonText}</span> '+"</div>"+'<div class="comment-replies">'+"{repliesHtml}"+"</div>"+"</div>"+"</div>").compile(),userCommentTemplate=new Ext.Template('<div id="comment-{commentId}" class="comment comment-post bogr1 cleared">'+'<p class="comment-title f-b">'+'<a href="/reader-comments/p/comment/link/{commentId}">{articleTitle}</a>'+"</p>"+reportAbuseHtml+'<div class="container">'+'<a href="/reader-comments/p/comment/link/{commentId}">'+'<p class="comment-body comment-text">{body}</p>'+"</a>"+'<div class="rating {ratingClass}" rel="{commentId}">'+'<div class="shareComment">'+'<a class="fShareComment"></a'+'><a class="tShareComment"></a'+'><span class="pShareComment"></span'+'><span class="gShareComment"></span'+'><span class="copyCommentLink"></span'+'><span class="shareExpansionAnchor"></span>'+"</div>"+'<a class="js-rate js-rate-down" href="#">'+'<div class="rating-button grey-rating-button rating-button-down">'+'<div class="rate-down"></div>'+'<div class="rating-button-inline">{votesDownValue}</div>'+"</div>"+"</a>"+'<a class="js-rate js-rate-up" href="#">'+'<div class="rating-button grey-rating-button rating-button-up">'+'<div class="rate-up"></div>'+'<div class="rating-button-inline">{votesUpValue}</div>'+"</div>"+"</a>"+'<span style="float:right;" class="gr5ox">Click to rate</span>'+"</div>"+'<div class="comment-replies"></div>'+"</div>"+"</div>").compile(),replyButtonTemplate=new Ext.Template('<button type="submit" class="btn anchor-reply-{type} js-reply" rel="reply-form-{id}">Reply</button>').compile(),replyFormTemplate=new Ext.Template('<div class="reply-form textarea-holder field">'+'<a id="reply-form-{id}" name="reply-form-{id}"></a>'+"<textarea "+'class="js-validate js-countdown js-defaultvalue js-expand textarea-input"'+'cols="40"'+'rows="2"'+'title="'+ENTER_REPLY_TEXT+'"></textarea>'+'<button type="submit" class="btn js-reply-submit">Post</button>'+"</div>").compile(),copyCommentLinkTemplate=new Ext.Template('<div class="lightBoxContent">'+'<input id="copyLinkInput" class="copyLinkInput" onfocus="this.select();" readonly="true" type="text" value="{commentLink}" />'+"<p>Copy link to paste in your message</p>"+"</div>");return{newCommentButtonTemplate:newCommentButtonTemplate,inlineSubmissionResponse:inlineSubmissionResponse,articleCommentTemplate:articleCommentTemplate,userCommentTemplate:userCommentTemplate,replyButtonTemplate:replyButtonTemplate,replyFormTemplate:replyFormTemplate,copyCommentLinkTemplate:copyCommentLinkTemplate}}();DM.RC.Utils=function(){function getSubmitButton(textarea){return textarea.id!="message"?Ext.get(textarea).next("button"):Ext.get(textarea).parent().next(".buttons-holder").down(".btn-submit")}function disableButton(textarea){var button=getSubmitButton(textarea);button.addClass("btn-disabled");button.dom.disabled="true"}function enableButton(textarea){var button=getSubmitButton(textarea);button.removeClass("btn-disabled");button.dom.disabled=undefined}return{getSubmitButton:getSubmitButton,disableButton:disableButton,enableButton:enableButton}}();DM.ReaderComments=function(){var UI,RCTemplates=DM.RC.Templates,RCUtils=DM.RC.Utils;var constructor=function(){DM.RC.initialize();DM.RC.FB.initialize();var COMMENT_MAX_LENGTH=1e3,MAX_COMMENTS=10,MAX_COOKIE_RATINGS=50,REPLIES_INITIAL_NUMBER=2,REPLIES_PAGINATION_SIZE=25,defaultPaginationConfig,maxComments=MAX_COMMENTS,gplusClientId,totalComments=0,offset=0,viewAll=false,allowNewComments,rc,tabs,tabCommands=["newest","oldest","bestRated","worstRated"],tabNames=["newest","oldest","best","worst"],tabIndex=0,buttonLabel,ratingsCookie,abuseCookie,commentAssetToSubmitCookie,commentMessageToSubmitCookie,commentReplyToSubmitCookie,articleId,userId,period,mode,moderated;var loadComments=function(config){var queryString="?max="+config.maxResults,tabSelected=tabCommands[tabIndex];if(config.offset)queryString+="&offset="+config.offset;if(config.period)queryString+="&period="+config.period;if(tabSelected=="newest"){queryString+="&order=desc"}else if(tabSelected=="oldest"){queryString+="&order=asc"}else if(tabSelected=="bestRated"){queryString+="&sort=voteRating&order=desc"}else if(tabSelected=="worstRated"){queryString+="&sort=voteRating&order=asc"}setButtonLabel("Loading...");DM.RC.spinner("show");if(config.mode==="article"){try{var disabledShoutChannels=!DM.SHOUT.isOldArticle&&DM.SHOUT.shoutChannels&&!JSON.parse(DM.SHOUT.shoutChannels).disabledMolShout&&JSON.parse(DM.SHOUT.shoutChannels).disabledChannels;if(disabledShoutChannels&&disabledShoutChannels.indexOf(PageCriteria.subchannel)==-1){queryString+="&rcCache=shout"}}catch(e){console.log("Unable to parse rc cache",e)}if(getUrlParam("rcnew")){queryString+="&rcnew=true"}Ext.Ajax.request({url:"/reader-comments/p/asset/readcomments/"+articleId+queryString,callback:loadCommentsCallback,method:"get"})}else if(config.mode==="user"){Ext.Ajax.request({url:"/reader-comments/p/user/readcomments/"+userId+queryString,callback:loadCommentsCallback,method:"get"})}};var createCommentHtml=function(comment,parentId){var ratings=calcVoteRatings(comment);var repliesHTML="";var type=parentId?"reply":"comment";if(type!="reply"){if(comment.replies.comments.length>0){if(comment.replies.totalCount>REPLIES_INITIAL_NUMBER){repliesHTML+='<div class="more-replies-container">'+"<p>"+'<span class="number-of-replies">'+REPLIES_INITIAL_NUMBER+" of "+comment.replies.totalCount+" replies</span>"+'<a class="more-replies" rel="'+comment.id+'">'+(comment.replies.totalCount>REPLIES_INITIAL_NUMBER+REPLIES_PAGINATION_SIZE?"See next "+REPLIES_PAGINATION_SIZE+" replies":"See all replies")+'<span class="rc-down-arrow"></span>'+"</a>"+"</p>"+"</div>"}Ext.each(comment.replies.comments,function(reply){repliesHTML+=createCommentHtml(formatUserInfo(reply),comment.id)})}}function getUserProfileSubFolder(userId){var buffer="";for(var i=0;i<userId.length;i++){stopCreatingSubfolders=i>=userId.length-1||i>=5;buffer+=userId[i]+(stopCreatingSubfolders?"":"/")}return buffer.toString()}function getUserProfileImageUrl(comment){var profilePictureHost="http://i.dailymail.co.uk";return comment.hasProfilePicture?profilePictureHost+"/i/user/"+getUserProfileSubFolder(comment.userIdentifier)+"_p.jpg":profilePictureHost+"/i/furniture/reg-new/dummy_148x178.jpg"}return RCTemplates.articleCommentTemplate.apply({commentId:comment.id,type:type,body:comment.message,votesUpValue:ratings.up,votesDownValue:ratings.down,ratingClass:getRatingClass(comment.id),avatarSide:parentId?35:55,userProfileUrl:getUserProfileUrl(comment),userInfo:'<a href="'+getUserProfileUrl(comment)+'" class="js-usr">'+comment.userAlias+"</a>, "+comment.userLocation+comment.formattedDateAndTime,repliesHtml:repliesHTML,shareHTML:DMS.RC.SHARE_ELEMENTS_HTML,voteButtonText:getRatingClass(comment.id)==""?"Click to rate":"Rated",newCommentButtonHTML:allowNewComments?parentId?"":RCTemplates.newCommentButtonTemplate.apply():"",replyButtonHTML:allowNewComments&&type!="reply"?RCTemplates.replyButtonTemplate.apply({type:type,id:parentId?parentId:comment.id}):"",abuseLink:"/home/reportAbuseInComment.html?articleId="+comment.assetId+"&commentId="+comment.id,userProfileImageUrl:getUserProfileImageUrl(comment),formattedCurrentDate:formatCurrentDate()})};var getUserProfileUrl=function(comment){return"/registration/"+comment.userIdentifier+"/"+comment.userAliasUrl+"profile.html"};var formatCurrentDate=function(){var today=new Date;return today.getFullYear().toString()+(today.getMonth()+1).toString()+today.getDate().toString()};var createUserHtml=function(comment){var ratings=calcVoteRatings(comment);return RCTemplates.userCommentTemplate.apply({articleId:comment.assetId,articleTitle:comment.assetHeadline,commentId:comment.id,body:comment.message,ratingClass:getRatingClass(comment.id),votesUpValue:ratings.up,votesDownValue:ratings.down,abuseLink:"/home/reportAbuseInComment.html?articleId="+comment.assetId+"&commentId="+comment.id})};var formatUserInfo=function(comment){comment.userAliasUrl=typeof comment.userAlias==="string"?comment.userAlias.replace(/ /g,"-")+"/":"";comment.userLocation=typeof comment.userLocation==="string"&&comment.userLocation!=="default"?comment.userLocation+", ":"";return comment};var loadCommentsCallback=function(options,success,response){var m=Ext.util.JSON.decode(response.responseText),comments=m&&m.payload&&m.payload.page?m.payload.page:[],comment,commentHTML="";if(m.payload&&m.payload.parentCommentsCount)m.payload.total=m.payload.parentCommentsCount;totalComments=m.payload&&m.payload.total?m.payload.total:totalComments;for(var i=0,len=comments.length;i<len;i++){comment=formatUserInfo(comments[i]);if(mode==="article")commentHTML+=createCommentHtml(comment);else if(mode==="user")commentHTML+=createUserHtml(comment)}var jsCommemnts=Ext.get("js-comments");if(jsCommemnts)jsCommemnts.dom.innerHTML=commentHTML;Ext.each(comments,function(comment){initComment(Ext.get("comment-"+comment.id))});if(viewAll){setButtonLabel("View "+tabNames[tabIndex]+" "+maxComments);DM.Pagination.getInstance().doPagination(m.payload)}else{setButtonLabel("View all");DM.Pagination.getInstance().hide()}if(totalComments>maxComments){Ext.select(".js-view-all-link").removeClass("hidden")}if(comments.length>=0){Ext.each(Ext.query("div.rc-content",rc),function(el){Ext.fly(el).removeClass("hidden")})}var hashCommentId=Ext.urlDecode(window.location.search).jumpTo,openReply=Ext.urlDecode(window.location.search).openReply,selectedComment=Ext.fly(hashCommentId);if(selectedComment){selectedComment.replaceClass("bogr1","comment-selected");if(openReply){jQuery(document).ready(function(){var reply=jQuery("#"+hashCommentId+" button.js-reply");setTimeout(function(){reply&&reply[0]&&reply[0].click()},5)})}window.location.hash="#"+hashCommentId}initReplyForms();DM.RC.spinner("hide")};var toggleViewAll=function(pageConfig){viewAll=!viewAll;
if(viewAll){loadComments(pageConfig)}else{loadComments({maxResults:maxComments,page:1,mode:mode,period:period})}};var commentSubmissionError=function(requestParams,response,textarea){if(textarea){RCUtils.enableButton(textarea.dom);inlineSubmissionMessage("error",textarea.parent())}var requestParamsString="assetId:"+requestParams.assetId+",message:"+requestParams.message;if(requestParams.replyTo)requestParamsString+=",replyTo:"+requestParams.replyTo;tedParams={status:response.status,params:requestParamsString};if(response.status)tedParams.responseCode=response.code;if(DM.getCookie("authid"))tedParams.authidCookie=DM.getCookie("authid");DM.ted.tedEvent("reader-comments",tedParams)};var readerCommentsHandler=function(e,t){var elTarget=e.getTarget(".js-view-all-link",4,true),rel;function registrationLinkEvent(event,target,elementTarget){if(!DM.isLoggedIn&&DM.Login){e.preventDefault();window.location.replace("/registration/login.html?usr=1&targetUrl="+window.location.href)}}if(elTarget){closeCopyCommentLinkLightbox(e,t);intellitrackerLog();toggleViewAll(defaultPaginationConfig);e.stopEvent();return}else if(elTarget=e.getTarget(".js-usr",3,true)){registrationLinkEvent(e,t,elTarget)}else if(Ext.get(t).parent().hasClass("rc-avatar-link")){registrationLinkEvent(e,t,Ext.get(t).parent())}else if(elTarget=e.getTarget("a.js-rate",3,true)){var ratingEl=Ext.get(elTarget.dom.parentNode);var voteRating;if(!ratingEl.hasClass("rated")){if(elTarget.hasClass("js-rate-up")){voteRating=Ext.query("div.rating-button-up div.rating-button-inline",Ext.getDom(ratingEl))[0].innerHTML;rel=ratingEl.dom.getAttribute("rel");ratingEl.addClass("rated rated-up");updateRatingsCookie(rel,"+");Ext.query("span.gr5ox",Ext.getDom(ratingEl))[0].innerHTML="Rated";Ext.query("div.rating-button-up div.rating-button-inline",Ext.getDom(ratingEl))[0].innerHTML=parseInt(voteRating)+1;Ext.Ajax.request({method:"POST",url:"/reader-comments/p/comment/voteup/"+rel,success:function(){}})}else if(elTarget.hasClass("js-rate-down")){voteRating=Ext.query("div.rating-button-down div.rating-button-inline",Ext.getDom(ratingEl))[0].innerHTML;rel=ratingEl.dom.getAttribute("rel");ratingEl.addClass("rated rated-down");updateRatingsCookie(rel,"-");Ext.query("span.gr5ox",Ext.getDom(ratingEl))[0].innerHTML="Rated";Ext.query("div.rating-button-down div.rating-button-inline",Ext.getDom(ratingEl))[0].innerHTML=parseInt(voteRating)+1;Ext.Ajax.request({method:"POST",url:"/reader-comments/p/comment/votedown/"+rel,success:function(){}})}}e.stopEvent()}else if(elTarget=e.getTarget(".js-more-link",3,true)){var containerEl=elTarget.parent(".js-headers").child(".comments-user");if(!containerEl){return}elTarget.containerHeight=elTarget.containerHeight||containerEl.getHeight();containerEl.scale(undefined,elTarget.hasClass("js-collapsed")?elTarget.containerHeight:0,{easing:"easeOut",duration:.65});elTarget.toggleClass("js-collapsed");e.stopEvent()}else if(elTarget=e.getTarget(".btn-submit",3,true)){var message=Ext.get("message");var formAssetId=Ext.get("formAssetId");var handlePostToFacebookInput=Ext.get("handlePostToFacebookInput");var messageVal=message.dom.value;if(!validateMessage(message.dom))return;RCUtils.disableButton(message.dom);inlineSubmissionMessage("pending",message.parent());var requestParams={assetId:formAssetId.dom.value,message:messageVal,source:"desktop",postToFacebook:DM.RC.FB.isHandlePostToFacebookSelected()};var queryString="";if(getUrlParam("rcnew")){queryString+="?rcnew=true"}Ext.Ajax.request({method:"POST",url:"/reader-comments/p/comment/postCommentInline"+queryString+"#comments",params:requestParams,success:function(e){var response=JSON.parse(e.responseText);if(response.status==="success"){message.dom.value=message.dom.title;validateMessage(message.dom);var messageType=requestParams.postToFacebook?"success-fb-share":"success";inlineSubmissionMessage(messageType,message.parent())}else if(response.status==="error"&&response.reason==="login"){RCUtils.enableButton(message.dom);if(!DM.isLoggedIn&&DM.Login){var expireDate=new Date;expireDate.setHours(expireDate.getHours()+1);commentAssetToSubmitCookie=formAssetId.dom.value;commentMessageToSubmitCookie=messageVal;clearInlineSubmissionMessage();DM.setCookie("commentAssetToSubmitCookie",commentAssetToSubmitCookie,expireDate,"/");DM.setCookie("commentMessageToSubmitCookie",commentMessageToSubmitCookie,expireDate,"/");window.location.replace("/registration/login.html?usr=1&targetUrl="+window.location.href)}}else{commentSubmissionError(requestParams,response,message)}},failure:function(response,options){commentSubmissionError(requestParams,response,message)}});e.stopEvent()}else if(elTarget=e.getTarget(".more-replies",3,true)){var repliesContainer=elTarget.parent().parent().parent(),moreRepliesContainer=elTarget.parent().parent(),parentId=elTarget.dom.getAttribute("rel"),count=repliesContainer.query(".reply-post").length,startquery="start="+count;var url="/reader-comments/p/comment/morereplies/"+parentId+"?"+startquery;Ext.Ajax.request({url:url,callback:function(a,b,response){var data=Ext.util.JSON.decode(response.responseText);if(data.code!="200"||data.payload.length<1){return}var replies=data.payload;var repliesHTML="";Ext.each(replies,function(reply){repliesHTML+=createCommentHtml(formatUserInfo(reply),parentId)});Ext.DomHelper.insertAfter(moreRepliesContainer,repliesHTML,true);Ext.each(replies,function(reply){initComment(Ext.get("comment-"+reply.id))});function totalReplies(moreRepliesTextElement){var moreRepliesText=moreRepliesTextElement.dom.innerHTML;var startIndex=moreRepliesText.indexOf("of ");var endIndex=moreRepliesText.indexOf(" replies");return startIndex<0||endIndex<0?0:parseInt(moreRepliesText.substring(startIndex+3,endIndex))}var moreRepliesTextElement=Ext.get(moreRepliesContainer.query("span")[0]);var totalReplies=totalReplies(moreRepliesTextElement);var displayedReplies=repliesContainer.query(".reply").length;var remainingReplies=totalReplies-displayedReplies;if(remainingReplies>0){moreRepliesTextElement.next("a").dom.innerHTML=(remainingReplies>REPLIES_PAGINATION_SIZE?"See next "+REPLIES_PAGINATION_SIZE+" replies":"See all replies")+'<span class="rc-down-arrow"></span>';moreRepliesTextElement.dom.innerHTML=displayedReplies+" of "+totalReplies+" replies"}else{moreRepliesContainer.remove()}openReplyInput(Ext.get("comment-"+parentId),false)},method:"get"});e.stopEvent()}};function getUrlParam(name){url=window.location.href;var queryIndex=url.indexOf("?");if(queryIndex>-1){var queryString=url.substring(queryIndex+1);var params=queryString.split("&");for(var i=0;i<params.length;i++){var pair=params[i].split("=");if(decodeURIComponent(pair[0])==name){return decodeURIComponent(pair[1])}}}return null}function inlineSubmissionMessage(type,form,message){var container=form.up(".comment-replies")||form;var fbData={};clearInlineSubmissionMessage();switch(type){case"success":message=moderated?"Thanks for sharing your comment. Comments on this article are moderated. Please be patient for your comment to appear.":"Thanks for sharing your comment!";break;case"success-fb-share":if(DM.UD.publishPermission==="true"&&DM.UD.fbUserName!=="null"){type="success";fbData.fbMessage="Your comment will also been posted to the Facebook account for "+DM.UD.fbUserName+'. Your comment will be credited to "'+DM.UD.displayName+'"';fbData.completeMessage='<div class="submission-feedback-fbmessage">';if(DM.UD.fbUserId){fbData.completeMessage+='<img src="http://graph.facebook.com/'+DM.UD.fbUserId+'/picture?type=square" class="readerCommentsFacebookShareProfileImage">'}else{fbData.completeMessage+='<img src="http://i.mol.im/i/furniture/reg-new/dummy_148x178.jpg" class="readerCommentsFacebookShareProfileImage">'}fbData.completeMessage+="<p>"+fbData.fbMessage+"</p>"+"</div>";message=moderated?"Thanks for sharing your comment. Comments on this article are moderated. Please be patient for your comment to appear.":"Thanks for sharing your comment. It will appear shortly on MailOnline."}else if(DM.UD.publishPermission==="false"){type="error";message="Something has gone wrong with your Facebook user and your Daily Mail Username, sorry! You have posted as your normal Daily Mail User."}break;case"pending":message="Sending...";break;case"invalid":if(!message)message="Invalid comment";break;case"error":message="Apologies - something went wrong. Please try later.";break}if(message)Ext.DomHelper.insertAfter(container,RCTemplates.inlineSubmissionResponse.apply({message:message,type:type,fbMessage:fbData.completeMessage}))}function clearInlineSubmissionMessage(){Ext.each(Ext.get("reader-comments").query(".submission-message"),function(dom){Ext.fly(dom).remove()})}function calcVoteRatings(comment){return{up:(comment.voteCount+comment.voteRating)/2,down:(comment.voteCount-comment.voteRating)/2}}var checkCookies=function(){var arrComments,currentComment,arrAbuseLink,currentAbuseLink;if(ratingsCookie){arrComments=Ext.query("div.comment-post",rc);for(var i=0,len=arrComments.length;i<len;i++){currentComment=arrComments[i];currentComment.ratings=Ext.get("reader-comments").query(".rating");Ext.each(currentComment.ratings,function(el){currentComment.commentId=el.getAttribute("rel");if(ratingsCookie.search(eval("/"+currentComment.commentId+"[+-]/"))!=-1){Ext.fly(el).addClass(getRatingClass(currentComment.commentId));Ext.query("span.gr5ox",el)[0].innerHTML="Rated"}})}}if(abuseCookie){arrComments=Ext.query("div.comment-post",rc);arrAbuseLink=Ext.query("p.js-report-abuse",rc);for(var i=0,len=arrComments.length;i<len;i++){currentComment=arrComments[i];currentAbuseLink=arrAbuseLink[i];currentComment.rating=currentComment.getElementsByTagName("div")[0];currentComment.commentId=currentComment.rating.getAttribute("rel");if(abuseCookie.search(eval(currentComment.commentId))!=-1){currentAbuseLink.innerHTML=currentAbuseLink.getElementsByTagName("a")[0].innerHTML;Ext.fly(currentAbuseLink).replaceClass("link-gr5ox",getAbuseClass(currentComment.commentId))}}}if(commentAssetToSubmitCookie||commentMessageToSubmitCookie){var deleteDate=new Date;deleteDate.setDate(deleteDate.getDate()-1);if(!(commentAssetToSubmitCookie&&commentMessageToSubmitCookie)){DM.setCookie("commentAssetToSubmitCookie","",deleteDate,"/");DM.setCookie("commentMessageToSubmitCookie","",deleteDate,"/");if(commentReplyToSubmitCookie){DM.setCookie("commentReplyToSubmitCookie","",deleteDate,"/")}}else{if(articleId!=commentAssetToSubmitCookie){DM.setCookie("commentAssetToSubmitCookie","",deleteDate,"/");DM.setCookie("commentMessageToSubmitCookie","",deleteDate,"/");DM.setCookie("commentReplyToSubmitCookie","",deleteDate,"/");return}var requestParams={assetId:commentAssetToSubmitCookie,message:commentMessageToSubmitCookie,source:"desktop"};if(commentReplyToSubmitCookie){requestParams["replyTo"]=commentReplyToSubmitCookie}var targetForm=Ext.get("readerCommentsCommand-message-field");Ext.Ajax.request({method:"POST",url:"/reader-comments/p/comment/postCommentInline",params:requestParams,success:function(e){DM.setCookie("commentAssetToSubmitCookie","",deleteDate,"/");DM.setCookie("commentMessageToSubmitCookie","",deleteDate,"/");DM.setCookie("commentReplyToSubmitCookie","",deleteDate,"/");var response=JSON.parse(e.responseText);if(response.status==="success"){inlineSubmissionMessage("success",targetForm)}else if(response.status==="error"&&response.reason!="login"){commentSubmissionError(requestParams,response);inlineSubmissionMessage("error",targetForm)}window.location.hash="readerCommentsCommand-message-field"},failure:function(response,options){commentSubmissionError(requestParams,response);DM.setCookie("commentAssetToSubmitCookie","",deleteDate,"/");DM.setCookie("commentMessageToSubmitCookie","",deleteDate,"/");inlineSubmissionMessage("error",targetForm);window.location.hash="readerCommentsCommand-message-field"}})}}};var updateRatingsCookie=function(messageId,upOrDown){var arrRatingsCookie=ratingsCookie?ratingsCookie.split(","):[];if(arrRatingsCookie.push(messageId+upOrDown)>MAX_COOKIE_RATINGS){arrRatingsCookie=arrRatingsCookie.slice(1)}var expireDate=new Date;expireDate.setFullYear(2030);ratingsCookie=arrRatingsCookie.join(",");DM.setCookie("commentRatings",ratingsCookie,expireDate,"/")};var updateRatingCount=function(ratingEl,voteRating){var voteRatingEl=Ext.query("span.js-vote-rating",ratingEl.dom)[0];if(voteRating==0){ratingEl.removeClass(["positive","negative"]);voteRatingEl.innerHTML="(0)"}else{if(voteRating>0){ratingEl.addClass("positive")}else{voteRating*=-1;ratingEl.addClass("negative")}voteRatingEl.innerHTML=voteRating}};var getRatingClass=function(commentId){if(ratingsCookie){var match=new RegExp(commentId+"([+-])").exec(ratingsCookie);if(match){switch(match[1]){case"+":return" rated rated-up";case"-":return" rated rated-down"}}}return""};var updateAbuseCookie=function(commentId){var arrAbuseCookie=abuseCookie?abuseCookie.split(","):[];if(arrAbuseCookie.push(commentId)>MAX_COOKIE_RATINGS){arrAbuseCookie=arrAbuseCookie.slice(1)}var expireDate=new Date;expireDate.setFullYear(2030);abuseCookie=arrAbuseCookie.join(",");DM.setCookie("reportAbuse",abuseCookie,expireDate,"/")};var getAbuseClass=function(commentId){return abuseCookie&&abuseCookie.search(commentId+"")!=-1?"gr3ox":"link-gr5ox"};var setFormValuesFromCookie=function(){var formEl=Ext.query("form.post-comment-form","reader-comments")[0];if(typeof formEl!="undefined"){if(DM.getCookie("remember_me_cookie")&&typeof formEl.rememberMe!="undefined"){formEl.rememberMe.checked=true}if(DM.getCookie("reader_name_cookie")&&typeof formEl.name!="undefined"){formEl.name.value=DM.getCookie("reader_name_cookie")}if(DM.getCookie("reader_town_cookie")&&typeof formEl.townAndCountry!="undefined"){formEl.townAndCountry.value=DM.getCookie("reader_town_cookie")}}};var setButtonLabel=function(text){if(buttonLabel){buttonLabel.each(function(button){button.dom.getElementsByTagName("span")[1].innerHTML=text})}};var tabHandler=function(e){var trg=e.getTarget("li.dm-tab",5),l=tabs._tabs.length;while(0<l){l--;if(trg==tabs._tabs[l])tabIndex=l}tabs._selectTab(trg);viewAll=true;intellitrackerLog();toggleViewAll(defaultPaginationConfig)};var intellitrackerLog=function(){DM.pageEvents.fireEvent(DM.pageEvents.PAGE_COMMENT_TAB_SWAPPED,DM.getPageMetadata({contentType:"commenttab",tab:tabNames[tabIndex]}))};function rejectedComment(){var width=Ext.fly("js-comments").getWidth(),style=width>=700?"":width<500?'style="margin-top: 2px !important; font-size: 12px !important;"':'style="margin-top: 4px !important;"',houseRules='<a href="/home/house_rules.html">house rules</a>';var rejectedCommentDiv='<div id="comment-not-found" class="bogr2 bogr3 cleared comment-post">'+'<div class="rejected-left"></div>'+'<div class="rejected-body">'+'<p class="rejected-body-text" '+style+">"+"Sorry. The content of this comment did not conform to our "+houseRules+", and it has now been removed by our moderators."+"</p>"+"</div>"+'<div class="rejected-right"></div>'+"</div>";Ext.DomHelper.insertFirst("js-comments",rejectedCommentDiv);Ext.fly("comment-not-found").child(".rejected-right").on({click:function(){Ext.fly("comment-not-found").remove()}})}function getComment(target){if(!target)return;return Ext.get(target).up(".reply")||Ext.get(target).up(".comment")}function getCommentData(target){var comment=getComment(target);if(!comment)return;var commentTextClass=comment.hasClass("reply")?".reply-text":".comment-text";var commentId=comment.id.substring(8),commentLink=DMS.domain+"/reader-comments/p/comment/link/"+commentId,commentBody=comment.child(commentTextClass).dom.innerHTML,commenterNameEl=comment.child(".js-usr"),commenterName=commenterNameEl?commenterNameEl.dom.innerHTML:Ext.query(".commenter-name")[0].innerHTML.replace("'s Comments","");return{commentId:commentId,commentLink:commentLink,commentBody:commentBody,commenterName:commenterName,commentUrl:commentLink,abuseLink:"/home/reportAbuseInComment.html?articleId="+comment.assetId+"&commentId="+comment.id}}DM.RC.getCommentData=getCommentData;function onCommentMouseOver(event,target,options){var comment=Ext.get(event.getTarget(".comment"));if(!comment)return;comment.addClass("hovered");DMS.RC.updateHoverElements()}function onCommentMouseLeave(event,target,options){var comment=Ext.get(event.getTarget(".comment"));if(!comment)return;disableCommentFeatures(comment);comment.removeClass("hovered");DMS.RC.updateHoverElements()}function onReplyMouseOver(event,target,options){var reply=Ext.get(event.getTarget(".reply"));if(!reply)return;disableCommentFeatures(Ext.get(Ext.query(".comment.hovered",Ext.getDom("js-comment"))[0]));reply.addClass("hovered");DMS.RC.updateHoverElements()}function onReplyMouseLeave(event,target,options){var reply=Ext.get(event.getTarget(".reply"));if(!reply)return;disableCommentFeatures(reply);reply.removeClass("hovered");DMS.RC.updateHoverElements()}function disableCommentFeatures(comment){if(!comment)return;var commentExt=Ext.get(comment);commentExt.child(".shareComment").hide();commentExt.child(".reportAbuseLink").hide()}function initComments(){Ext.each(Ext.query(".comment",Ext.getDom("js-comments")),function(commentElement){initComment(Ext.get(commentElement))});document.onkeydown=function(event){var key=event?event.which||event.keyCode:undefined;if(key==27&&DM.Lightbox.getInstance())closeCopyCommentLinkLightbox()};Ext.getBody().on("click",closeCopyCommentLinkLightbox)}function initFurniture(){var messageForm=Ext.get("message");var addYourCommentButton=Ext.get("addYourCommentButton");if(messageForm){addYourCommentButton.on("click",function(){messageForm.focus()})}else{var b=Ext.get("addYourCommentButton");if(b){b.hide()}}}function toggleCssClass(element,cssClass,selector){if(selector)element.addClass(cssClass);else element.removeClass(cssClass)}function initCommentStyle(commentElement){if(commentElement.hasClass("reply"))return;var noReplies=commentElement.query(".reply").length==0;var hasReplyInputText=commentElement.query("textarea").length>0;toggleCssClass(commentElement,"no-replies",noReplies);toggleCssClass(commentElement,"contains-reply-textarea",hasReplyInputText)}function initComment(commentElement){initCommentStyle(commentElement);var shareCommentElement=commentElement.child(".shareComment");shareCommentElement.on({click:DMS.RC.shareComment});shareCommentElement.down(".copyCommentLink").on({click:function(e,t){copyCommentLinkClicked(e,t,false)}});shareCommentElement.down(".shareExpansionAnchor").on({click:function(e,t){copyCommentLinkClicked(e,t,true)}});var n_attempts=numberOfAttempts=10;var gPlusEnhance=function(){n_attempts--;try{DMS.RC.gPlusEnhance(shareCommentElement);console.log("Called DMS.RC.gPlusEnhance ",numberOfAttempts-n_attempts," th attempt.")}catch(e){if(n_attempts!==0){setTimeout(gPlusEnhance,1e3)}}};gPlusEnhance();if(commentElement.hasClass("reply")){commentElement.hover(onReplyMouseOver,onReplyMouseLeave)}else{commentElement.hover(onCommentMouseOver,onCommentMouseLeave);Ext.each(Ext.query(".reply",Ext.getDom(commentElement)),function(replyElement){initComment(Ext.get(replyElement))})}}function isCopyLinkLightbox(target){var extTarget=Ext.get(target);return extTarget&&(extTarget.id=="copyLinkLightboxArrow"||extTarget.id=="copyLinkLightbox"||Ext.get(target).up("#copyLinkLightbox")!=null)}function closeCopyCommentLinkLightbox(event,target){if(isCopyLinkLightbox(target))return;Ext.get("copyLinkLightbox").hide();Ext.get("copyLinkLightboxArrow").hide()}function copyCommentLinkClicked(event,target,withShareLinks){var commentData=getCommentData(target);if(!commentData)return;var copyCommentLinkIcon=Ext.get(target),lightbox=Ext.get("copyLinkLightbox"),lightboxArrow=Ext.get("copyLinkLightboxArrow"),locationLeft,locationTop,arrowLocationLeft;Ext.get("copyLinkLightbox").show();Ext.get("copyLinkLightboxArrow").show();if(withShareLinks){lightbox.dom.innerHTML='<div class="socialButtons">'+DMS.RC.SOCIAL_ELEMENTS_HTML+"</div>"+RCTemplates.copyCommentLinkTemplate.apply({commentLink:commentData.commentUrl});lightbox.removeAllListeners();lightbox.on({click:function(e,t){DMS.RC.shareComment(e,t,commentData)}});DMS.RC.gPlusEnhance(lightbox,commentData)}else{lightbox.dom.innerHTML=RCTemplates.copyCommentLinkTemplate.apply({commentLink:commentData.commentUrl})}locationLeft=copyCommentLinkIcon.getLeft()-lightbox.getWidth()/2+copyCommentLinkIcon.getWidth()/2;locationTop=copyCommentLinkIcon.getTop()+copyCommentLinkIcon.getHeight();arrowLocationLeft=copyCommentLinkIcon.getLeft();lightboxArrow.setLocation(arrowLocationLeft,locationTop);lightbox.setLocation(locationLeft,locationTop+10);Ext.get("copyLinkInput").focus();event.stopPropagation()}function replySubmitHandler(el){var button=Ext.get(el);var formAssetId=Ext.get("formAssetId");var handlePostToFacebookInput=Ext.get("handlePostToFacebookInput");var parentCommentId=button.parent().select("a").elements[0].name.split("reply-form-")[1];var textarea=Ext.get(button.parent().select(".textarea-input").elements[0]);button.on("click",function(){var messageVal=textarea.dom.value;if(!validateMessage(textarea.dom))return;RCUtils.disableButton(textarea.dom);inlineSubmissionMessage("pending",textarea.parent());var requestParams={assetId:formAssetId.dom.value,message:messageVal,replyTo:parentCommentId,source:"desktop"};Ext.Ajax.request({method:"POST",url:"/reader-comments/p/comment/postCommentInline",params:requestParams,success:function(e){var response=JSON.parse(e.responseText);if(response.status==="success"){inlineSubmissionMessage("success",textarea.parent());textarea.up(".reply-form").remove()}else if(response.status==="error"&&response.reason==="login"){RCUtils.enableButton(textarea.dom);if(!DM.isLoggedIn&&DM.Login){var expireDate=new Date;expireDate.setHours(expireDate.getHours()+1);commentAssetToSubmitCookie=formAssetId.dom.value;commentMessageToSubmitCookie=messageVal;commentReplyToSubmitCookie=parentCommentId;clearInlineSubmissionMessage();DM.setCookie("commentAssetToSubmitCookie",commentAssetToSubmitCookie,expireDate,"/");DM.setCookie("commentMessageToSubmitCookie",commentMessageToSubmitCookie,expireDate,"/");DM.setCookie("commentReplyToSubmitCookie",commentReplyToSubmitCookie,expireDate,"/");window.location.replace("/registration/login.html?usr=1&targetUrl="+window.location.href)}}else{commentSubmissionError(requestParams,response,textarea)}},failure:function(response,options){commentSubmissionError(requestParams,response,textarea)}})})}function validateMessage(textarea){function getSubmissionForm(){return textarea.id!="message"?Ext.get(textarea).parent():RCUtils.getSubmitButton(textarea).up(".post-comment-form")}var targetForm=getSubmissionForm(textarea);var messageTooLong=textarea.value&&textarea.value.length>COMMENT_MAX_LENGTH;var disabled=textarea.value==""||textarea.value==textarea.title||messageTooLong;if(messageTooLong)inlineSubmissionMessage("invalid",targetForm,"Sorry! Your comment is "+(textarea.value.length-COMMENT_MAX_LENGTH)+" characters too long.");else clearInlineSubmissionMessage(targetForm);if(disabled)RCUtils.disableButton(textarea);else RCUtils.enableButton(textarea);return!disabled}function initReplyInput(form){var textArea=form.child(".textarea-input");validateMessage(textArea.dom);textArea.on("blur",function(event,target){if(target.value=="")Ext.get(target).up(".textarea-holder").remove()});textArea.on("focus",function(event,target){validateMessage(target);clearInlineSubmissionMessage(form)});textArea.on("keyup",function(event,target){validateMessage(target)})}function initCommentInput(form){var textArea=form.child(".textarea-input");validateMessage(textArea.dom);textArea.on("blur",function(event,target){if(target.value=="")target.value=target.title});textArea.on("focus",function(event,target){if(target.value==target.title)target.value="";validateMessage(target);clearInlineSubmissionMessage()});textArea.on("keyup",function(event,target){validateMessage(target,true)})}function setFocus(scrollToElement,focusElement){window.scrollTo(0,scrollToElement.getY()-100);setTimeout(function(){focusElement.focus()},50)}function initCommentForm(){var readerCommentsElement=Ext.get("readerCommentsCommand");if(!readerCommentsElement)return;initCommentInput(readerCommentsElement.down(".comment-form"));readerCommentsElement.child(".btn-clear").on("click",function(event,target){var inputArea=Ext.get(target).parent().prev(".textarea-holder").down(".textarea-input");inputArea.dom.value="";validateMessage(inputArea);inputArea.focus()})}function openReplyInput(comment,focus){if(comment.child(".textarea-input")){var replyForm=Ext.get(comment.child(".anchor-reply-comment").dom.getAttribute("rel"));if(focus)setFocus(replyForm,replyForm.next(".textarea-input"))}else{var commentId=comment.child(".rating").dom.getAttribute("rel");var newReply=Ext.DomHelper.append(comment.child(".comment-replies"),RCTemplates.replyFormTemplate.apply({id:commentId}),true);initReplyInput(newReply);replySubmitHandler(newReply.child(".js-reply-submit"));if(focus)newReply.child(".textarea-input").focus();initCommentStyle(Ext.get("comment-"+commentId))}}function initReplyForms(){var rcCommentsDom=Ext.getDom("js-comments");Ext.each(Ext.query(".reply-form",rcCommentsDom),function(el){initReplyInput(Ext.get(el))});Ext.each(Ext.query(".js-reply-submit",rcCommentsDom),function(el){replySubmitHandler(el)});Ext.each(Ext.query(".js-newcomment",rcCommentsDom),function(el){Ext.get(el).on("click",function(){clearInlineSubmissionMessage();setFocus(Ext.get("newcomment"),Ext.get("message"))})});Ext.each(Ext.query(".js-reply.anchor-reply-comment",rcCommentsDom),function(element){var button=Ext.get(element);button.on("click",function(){openReplyInput(button.up(".comment"),true)})});Ext.each(Ext.query(".js-reply.anchor-reply-reply",rcCommentsDom),function(element){Ext.get(element).on("click",function(){var replyForm=Ext.get(element.getAttribute("rel"));setFocus(replyForm,replyForm.next(".textarea-input"))})})}return{init:function(obj){var params=obj.params||{},articleIdMatch=null,userIdMatch=null,hashCommentId;Ext.apply(Ext.Fx,{fadeInS:function(o){var NULL=null,VISIBLE="visible",EASEOUT="easeOut";o=o||{};var me=this,dom=me.dom,to=o.endOpacity||1;if(!Ext.isIE){me.queueFx(o,function(){Ext.fly(dom).setOpacity(o.startOpacity||0);Ext.fly(dom).fixDisplay();dom.style.visibility=VISIBLE;arguments.callee.anim=Ext.fly(dom).fxanim({opacity:{to:to}},o,NULL,.5,EASEOUT,function(){Ext.fly(dom).afterFx(o)})})}else{me.dom.style.opacity=1;me.dom.style.filter="alpha(opacity=100)"}return me}});Ext.Element.addMethods(Ext.Fx);DMS.RC=DMS.RC||{};DMS.RC.gplusClientId=gplusClientId=params.gplusClientId;totalComments=params.total||0;mode=params.mode||"article";moderated=params.moderated;ratingsCookie=DM.getCookie("commentRatings");abuseCookie=DM.getCookie("reportAbuse");commentAssetToSubmitCookie=DM.getCookie("commentAssetToSubmitCookie");commentMessageToSubmitCookie=DM.getCookie("commentMessageToSubmitCookie");commentReplyToSubmitCookie=DM.getCookie("commentReplyToSubmitCookie");allowNewComments=params.allowNewComments;var r=Ext.get(obj.id);if(r)rc=r.dom;if(rc){if(mode==="article"){articleIdMatch=new RegExp("article-id-([0-9]+)").exec(rc.className);articleId=articleIdMatch?articleIdMatch[1]:null}else if(mode==="user"){userIdMatch=new RegExp("user-id-([0-9]+)").exec(rc.className);userId=userIdMatch?userIdMatch[1]:null}defaultPaginationConfig={maxResults:Ext.urlDecode(window.location.search.substring(1)).max||100,page:1,offset:Ext.urlDecode(window.location.search.substring(1)).offset||0,reply:Ext.urlDecode(window.location.search.substring(1)).reply||null,articleId:articleId,userId:userId,greyStyle:true,mode:mode,numberOfPageButtonsToShow:10};if(mode==="user"){period=params.period||"week";defaultPaginationConfig.period=period;defaultPaginationConfig.numberOfPageButtonsToShow=5}DM.Pagination.getInstance().init(loadComments,defaultPaginationConfig);Ext.get("reader-comments").on("click",readerCommentsHandler,this);checkCookies();var rcTabs=Ext.get("rc-tabs");if(rcTabs){tabs=new DM.RCTabs("reader-comments",{tabOnClass:["ow-igr5-bx wogr5","link-wox","dm-tab-on"],tabOffClass:["ow-igr2-bx","xogr2","link-gr5ox"],tabQuery:"li",_clickHandler:tabHandler})}buttonLabel=Ext.select(".view-more-container");Ext.select(".pagination-container-bottom, .view-more-container-bottom a").on("click",function(){if(window.location.hash!=="#comments"){window.location.hash="#comments"}else{window.location.hash="#reader-comments"}},{delegate:"a"});if(mode==="article"){hashCommentId=window.location.hash.substring(1).match(/(comment\-\d+)/);hashCommentId=hashCommentId?hashCommentId[1]:null;if(hashCommentId){viewAll=true;setButtonLabel("View "+tabNames[tabIndex]+" "+maxComments);DM.Pagination.getInstance().doPagination({max:100,offset:params.offset||0,total:totalComments});var selectedComment=Ext.fly(hashCommentId);if(selectedComment)selectedComment.replaceClass("bogr1","comment-selected")}}setFormValuesFromCookie();if(mode==="article"){initReplyForms()}}if(window.location.hash.match(/#comment-not-found/)){rejectedComment()}if(Ext.get("report-abuse-comfirm")){updateAbuseCookie(Ext.get("report-abuse-comfirm").dom.className.split("|")[0])}initCommentForm();initComments();initFurniture();if(window.RCdefferedTab){tabHandler(RCdefferedTab)}else{if(Ext.urlDecode(window.location.search.substring(1)).offset&&Ext.urlDecode(window.location.search.substring(1)).max){viewAll=false}else{viewAll=true}toggleViewAll(defaultPaginationConfig)}}}};return{getInstance:function(){if(!UI)UI=constructor();return UI}}}();DM.RCTabs=Ext.extend(Ext.util.Observable,{linkHk:".js-links",activeHk:"js-active",tabsQuery:".dm-tab",tabOffClass:null,tabOnClass:null,constructor:function(id,config){DM.RCTabs.superclass.constructor.call(this);config&&Ext.apply(this,config);this.el=Ext.get(id);Ext.fly(this.el.query(this.linkHk)[0]).on("click",this._clickHandler,this,{preventDefault:true});this._tabs=this.el.query(this.tabsQuery)},_clickHandler:function(e){},_selectTab:function(id){this.reset();this.tab(id)},reset:function(){var tab;var l=this._tabs.length;while(l>0){--l;tab=Ext.get(this._tabs[l]);tab.addClass(this.tabOffClass).removeClass(this.tabOnClass).removeClass(this.activeHk)}},tab:function(tab){Ext.fly(tab).removeClass(this.tabOffClass).addClass(this.tabOnClass).addClass(this.activeHk)}});DM.Pagination=function(){var UI;function constructor(){var arrPaginationContainers,externalHandler,objConfig={maxResults:100,offset:0,page:1,showPageNumber:true,showPagingOptions:false,greyStyle:false,numberOfPageButtonsToShow:10};function clickHandler(e){e.stopEvent();var target=e.getTarget("A",5);if(target){objConfig.page=parseInt(target.getAttribute("rel"));objConfig.offset=parseInt(objConfig.page-1)*objConfig.maxResults;externalHandler(objConfig)}}return{init:function(fHandler,oConfig){externalHandler=fHandler;Ext.apply(objConfig,oConfig);arrPaginationContainers=Ext.query("div.pagination-container","content");Ext.each(arrPaginationContainers,function(el){Ext.fly(el).on("click",clickHandler)})},doPagination:function(payload){if(typeof payload!=="object"){return}var numberOfResultsPerPage=parseInt(payload.max),offSet=parseInt(payload.offset),totalResults=parseInt(payload.total),numberOfPageButtonsToShow=objConfig.numberOfPageButtonsToShow,totalNumberOfPages=Math.ceil(totalResults/numberOfResultsPerPage),prePages=parseInt(offSet/numberOfResultsPerPage),currentPage=1+prePages,previousButtonsToShow=[],nextButtonsToShow=[];for(var i=1;i<numberOfPageButtonsToShow;i++){if(currentPage>1&&currentPage-i>0){previousButtonsToShow.push(currentPage-i)}if(previousButtonsToShow.length+nextButtonsToShow.length>=numberOfPageButtonsToShow-1){break}if(currentPage+i<=totalNumberOfPages){nextButtonsToShow.push(currentPage+i)}if(previousButtonsToShow.length+nextButtonsToShow.length>=numberOfPageButtonsToShow-1){break}}if(totalNumberOfPages>1&&arrPaginationContainers.length>0){var strHtml="";var arrLinks=["","","","",""];var linkClass="link-ccox";var pageSpan="<span>Page</span>";if(objConfig.showPageNumber){strHtml+='<div class="sch-pagesummary">Page '+currentPage+" of "+totalNumberOfPages+"</div>";
}if(currentPage>1){arrLinks[0]='<a href="#" rel="'+(currentPage-1)+'">Previous</a>'}for(var i=previousButtonsToShow.length-1;i>=0;i--){arrLinks[1]+='<a class="page-number bdrgr3" href="#" rel="'+previousButtonsToShow[i]+'">'+previousButtonsToShow[i]+"</a>"}arrLinks[2]='<span class="page-number bdrgr3 bogr2">'+currentPage+"</span>";for(var i=0;i<nextButtonsToShow.length;i++){arrLinks[3]+='<a class="page-number bdrgr3" href="#" rel="'+nextButtonsToShow[i]+'">'+nextButtonsToShow[i]+"</a>"}if(currentPage<totalNumberOfPages){arrLinks[4]='<a href="#" rel="'+(currentPage+1)+'">Next</a>'}if(objConfig.greyStyle){linkClass="link-gr5ox";pageSpan=""}strHtml+='<div class="pagination bdrcc '+linkClass+' linkro-box">'+'<div class="float-r">'+pageSpan+arrLinks.join("")+"</div>"+"</div>";for(var i=0,len=arrPaginationContainers.length;i<len;i++){arrPaginationContainers[i].innerHTML=strHtml;Ext.fly(arrPaginationContainers[i]).setStyle("display","block")}}else{this.hide()}},hide:function(){for(var i=0,len=arrPaginationContainers.length;i<len;i++){Ext.fly(arrPaginationContainers[i]).setStyle("display","none")}}}}return{getInstance:function(){if(!UI)UI=constructor();return UI}}}();(function($){"use strict";$(document).ready(function(){var abuseDetails=$("#abuse-details");var thankYou=$(".thankyou");var failed=$(".failed");var rules={mandatory:{type:"regExp",opts:{re:/^.+$/,error:"Please provide a value for this field"}},emailHelper:{type:"regExp",opts:{re:/^.+$/,error:"Please enter a valid email address"}},email:{type:"regExp",opts:{re:/^([A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4})?$/i,error:"Please provide a valid email address"}},recaptchaHelper:{type:"length",opts:{min:1,error:"Don't forget the verification code"}},complaintHelper:{type:"regExp",opts:{re:/^.*[^\s].*$/,error:"Please provide an explanation of your complaint"}},complaint:{type:"regExp",opts:{re:/^.+$/,error:"Please provide an explanation of your complaint"}}};$("#abuse-details").regformvalidator({fieldContainer:".reg-fld",errorContainer:".err",serverSideErrorClass:".server-side-fail",rules:rules,errorsMap:{email:["emailHelper","email"],recaptcha_response_field:["recaptchaHelper"],complaint:["complaintHelper","complaint"]},hintsMap:{email:["emailHelper"],complaint:["complaintHelper"]}});$(".mol-registration select").chosen();$(".mol-registration select").change(function(){$(this).closest(".reg-fld").addClass("focus")});thankYou.hide();failed.hide();window.submitReportAbuseFunction=function(){console.log("submit Action");abuseDetails.hide();failed.hide();DM.RC.spinner("show");var email=$("#email").val();var complaint=$("#complaint").val();var recaptcha_challenge_field=$("#recaptcha_challenge_field").val();var recaptcha_response_field=$("#recaptcha_response_field").val();var commentId=$("#commentId").val();$.ajax({type:"POST",url:"/reader-comments/p/postReportAbuseInComment.html",Accept:"application/json",contentType:"application/json",data:JSON.stringify({email:email,complaint:complaint,recaptcha_challenge_field:recaptcha_challenge_field,recaptcha_response_field:recaptcha_response_field,commentId:commentId}),success:function(response){if("success"==response.status){console.log("success: "+response.reportId+"..");document.querySelector(".reportId").innerHTML=response.reportId;abuseDetails.hide();thankYou.show();failed.hide();DM.RC.spinner("hide")}else{console.log("failure: "+response.status+"..");DM.RC.spinner("hide");abuseDetails.show();thankYou.hide();failed.hide();javascript:Recaptcha.reload();abuseDetails.removeClass("submitting")}},error:function(xhr,status,err){console.log("Error while accessing server: "+err);DM.RC.spinner("hide");failed.show()}});$(function(){$("textarea[maxlength]").bind("input propertychange",function(){var maxLength=$(this).attr("maxlength");if($(this).val().length>maxLength){$(this).val($(this).val().substring(0,maxLength))}})})}})})(jQuery);DM.ArrowFactor=Ext.extend(DM.Tabs,{tabOnClass:"dm-tab-on",tabOffClass:"dm-tab-off",userId:"",constructor:function(id){that=this;DM.ArrowFactor.superclass.constructor.call(this,id);this.container=Ext.get(id);if(this.container.getAttribute("className")){this.userId=this.container.getAttribute("className").match(/user-id-[0-9]*/)[0].replace("user-id-","")}else{this.userId=this.container.getAttribute("class").match(/user-id-[0-9]*/)[0].replace("user-id-","")}this.container.select(".dm-tab").each(function(){this.on("click",that._changeHandler,that)});this.container.select("#arrow-factor-2 .rating-value",true).each(function(){this.update("&nbsp;")});this.container.select("#arrow-factor-2 .commentsTotal .value",true).each(function(){this.update("&nbsp;")});this.container.select("#arrow-factor-3 .rating-value",true).each(function(){this.update("&nbsp;")});this.container.select("#arrow-factor-3 .commentsTotal .value",true).each(function(){this.update("&nbsp;")});this.container.select("#arrow-factor-4 .rating-value",true).each(function(){this.update("&nbsp;")});this.container.select("#arrow-factor-4 .commentsTotal .value",true).each(function(){this.update("&nbsp;")})},_changeHandler:function(e){var trg=Ext.get(e.getTarget(this.tabsQuery,3)),rating;if(trg){if(trg.getAttribute("className")){rating=trg.getAttribute("className").match(/ratings-[a-z]*/)[0].replace("ratings-","")}else{rating=trg.getAttribute("class").match(/ratings-[a-z]*/)[0].replace("ratings-","")}if(rating!==""){Ext.Ajax.request({method:"GET",disableCaching:false,url:"/reader-comments/p/user/arrowfactor/"+this.userId+"?period="+rating,success:this._ratingsCallback})}}},_ratingsCallback:function(response){var response=Ext.util.JSON.decode(response.responseText),pane=Ext.get(that.currentTab.id.replace("t-",""));pane.child(".rating-positive .rating-value",true).innerHTML=that._numberWithCommas(response.payload.votesUp);pane.child(".rating-negative .rating-value",true).innerHTML=that._numberWithCommas(response.payload.votesDown);pane.child(".commentsTotal .value",true).innerHTML=that._numberWithCommas(response.payload.commentCount);if(response.payload.voteRating>=0){pane.child(".rating-overall").removeClass("rating-overall-negative").addClass("rating-overall-positive");pane.child(".rating-overall .rating-value",true).innerHTML=that._numberWithCommas(response.payload.voteRating)}else{pane.child(".rating-overall").addClass("rating-overall-negative").removeClass("rating-overall-positive");pane.child(".rating-overall .rating-value",true).innerHTML=that._numberWithCommas(-1*response.payload.voteRating)}},_numberWithCommas:function(n){var parts=n.toString().split(".");return parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,",")+(parts[1]?"."+parts[1]:"")}});if(Object.hasOwnProperty.call(window,"ActiveXObject")&&!window.ActiveXObject&&location.pathname==="/home/index.html"){DM.later("DOM_READY",function(){$(".video_carousel_container").parent().parent().hide()})}(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol?"symbol":typeof obj};function isCallable(_ref){var cb=_ref.cb;var _ref$throwError=_ref.throwError;var throwError=_ref$throwError===undefined?false:_ref$throwError;var cbType=typeof cb==="undefined"?"undefined":_typeof(cb);if(cbType!=="function"){if(throwError){throw new Error('onDocumentLoad: expected function, but received "'+cbType+'"')}return false}return true}module.exports=isCallable},{}],2:[function(require,module,exports){"use strict";var isCallable=require("./isCallable");function removableListener(cb){isCallable({cb:cb,throwError:true});return{isRemoved:false,remove:function remove(){this.isRemoved=true;cb()}}}module.exports=removableListener},{"./isCallable":1}],3:[function(require,module,exports){"use strict";var isCallable=require("../common/isCallable");var removableListener=require("../common/removableListener");function onDocumentLoad(cb){isCallable({cb:cb,throwError:true});function eventHandler(){if(_removableListener.isRemoved){return}_removableListener.remove();cb()}var documentEventValues=["DOMContentLoaded",eventHandler];var windowEventValues=["load",eventHandler];var _removableListener=removableListener(function(){var _document,_window;(_document=document).removeEventListener.apply(_document,documentEventValues);(_window=window).removeEventListener.apply(_window,windowEventValues)});if(document.attachEvent?document.readyState==="complete":document.readyState!=="loading"){eventHandler()}else{var _document2,_window2;(_document2=document).addEventListener.apply(_document2,documentEventValues);(_window2=window).addEventListener.apply(_window2,windowEventValues)}return _removableListener}module.exports=onDocumentLoad},{"../common/isCallable":1,"../common/removableListener":2}],4:[function(require,module,exports){"use strict";function serializeQueryString(obj){switch(Object.prototype.toString.call(obj)){case"[object Object]":return Object.keys(obj).map(function(key){return encodeURIComponent(key)+"="+encodeURIComponent(obj[key])}).join("&");case"[object String]":return obj}return""}function makeRequest(url){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var request=new XMLHttpRequest;if(!url){throw new Error("URL required to make request")}var _options$method=options.method;var method=_options$method===undefined?"GET":_options$method;var headers=options.headers;var body=options.body;var cb=options.cb;var calledErrorCallback=false;if(typeof options==="function"){cb=options}if(method==="GET"&&body){var serialized=serializeQueryString(body);if(serialized){url+=(url.indexOf("?")!==-1?"&":"?")+serialized}}request.open(method,url);if(headers){Object.keys(headers).forEach(function(key){request.setRequestHeader(key,headers[key])})}request.onreadystatechange=function(){if(request.readyState>3){if(request.status>=200&&request.status<300){cb(null,request.responseText)}else if(!calledErrorCallback){calledErrorCallback=true;cb(new Error("Error in server response, status: "+request.status))}}};request.onerror=function(){if(!calledErrorCallback){calledErrorCallback=true;cb(new Error("Error making request, status: "+request.status))}};request.send(body||null)}module.exports=makeRequest},{}],5:[function(require,module,exports){(function(Hogan){var rIsWhitespace=/\S/,rQuot=/\"/g,rNewline=/\n/g,rCr=/\r/g,rSlash=/\\/g,rLineSep=/\u2028/,rParagraphSep=/\u2029/;Hogan.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12};Hogan.scan=function scan(text,delimiters){var len=text.length,IN_TEXT=0,IN_TAG_TYPE=1,IN_TAG=2,state=IN_TEXT,tagType=null,tag=null,buf="",tokens=[],seenTag=false,i=0,lineStart=0,otag="{{",ctag="}}";function addBuf(){if(buf.length>0){tokens.push({tag:"_t",text:new String(buf)});buf=""}}function lineIsWhitespace(){var isAllWhitespace=true;for(var j=lineStart;j<tokens.length;j++){isAllWhitespace=Hogan.tags[tokens[j].tag]<Hogan.tags["_v"]||tokens[j].tag=="_t"&&tokens[j].text.match(rIsWhitespace)===null;if(!isAllWhitespace){return false}}return isAllWhitespace}function filterLine(haveSeenTag,noNewLine){addBuf();if(haveSeenTag&&lineIsWhitespace()){for(var j=lineStart,next;j<tokens.length;j++){if(tokens[j].text){if((next=tokens[j+1])&&next.tag==">"){next.indent=tokens[j].text.toString()}tokens.splice(j,1)}}}else if(!noNewLine){tokens.push({tag:"\n"})}seenTag=false;lineStart=tokens.length}function changeDelimiters(text,index){var close="="+ctag,closeIndex=text.indexOf(close,index),delimiters=trim(text.substring(text.indexOf("=",index)+1,closeIndex)).split(" ");otag=delimiters[0];ctag=delimiters[delimiters.length-1];return closeIndex+close.length-1}if(delimiters){delimiters=delimiters.split(" ");otag=delimiters[0];ctag=delimiters[1]}for(i=0;i<len;i++){if(state==IN_TEXT){if(tagChange(otag,text,i)){--i;addBuf();state=IN_TAG_TYPE}else{if(text.charAt(i)=="\n"){filterLine(seenTag)}else{buf+=text.charAt(i)}}}else if(state==IN_TAG_TYPE){i+=otag.length-1;tag=Hogan.tags[text.charAt(i+1)];tagType=tag?text.charAt(i+1):"_v";if(tagType=="="){i=changeDelimiters(text,i);state=IN_TEXT}else{if(tag){i++}state=IN_TAG}seenTag=i}else{if(tagChange(ctag,text,i)){tokens.push({tag:tagType,n:trim(buf),otag:otag,ctag:ctag,i:tagType=="/"?seenTag-otag.length:i+ctag.length});buf="";i+=ctag.length-1;state=IN_TEXT;if(tagType=="{"){if(ctag=="}}"){i++}else{cleanTripleStache(tokens[tokens.length-1])}}}else{buf+=text.charAt(i)}}}filterLine(seenTag,true);return tokens};function cleanTripleStache(token){if(token.n.substr(token.n.length-1)==="}"){token.n=token.n.substring(0,token.n.length-1)}}function trim(s){if(s.trim){return s.trim()}return s.replace(/^\s*|\s*$/g,"")}function tagChange(tag,text,index){if(text.charAt(index)!=tag.charAt(0)){return false}for(var i=1,l=tag.length;i<l;i++){if(text.charAt(index+i)!=tag.charAt(i)){return false}}return true}var allowedInSuper={_t:true,"\n":true,$:true,"/":true};function buildTree(tokens,kind,stack,customTags){var instructions=[],opener=null,tail=null,token=null;tail=stack[stack.length-1];while(tokens.length>0){token=tokens.shift();if(tail&&tail.tag=="<"&&!(token.tag in allowedInSuper)){throw new Error("Illegal content in < super tag.")}if(Hogan.tags[token.tag]<=Hogan.tags["$"]||isOpener(token,customTags)){stack.push(token);token.nodes=buildTree(tokens,token.tag,stack,customTags)}else if(token.tag=="/"){if(stack.length===0){throw new Error("Closing tag without opener: /"+token.n)}opener=stack.pop();if(token.n!=opener.n&&!isCloser(token.n,opener.n,customTags)){throw new Error("Nesting error: "+opener.n+" vs. "+token.n)}opener.end=token.i;return instructions}else if(token.tag=="\n"){token.last=tokens.length==0||tokens[0].tag=="\n"}instructions.push(token)}if(stack.length>0){throw new Error("missing closing tag: "+stack.pop().n)}return instructions}function isOpener(token,tags){for(var i=0,l=tags.length;i<l;i++){if(tags[i].o==token.n){token.tag="#";return true}}}function isCloser(close,open,tags){for(var i=0,l=tags.length;i<l;i++){if(tags[i].c==close&&tags[i].o==open){return true}}}function stringifySubstitutions(obj){var items=[];for(var key in obj){items.push('"'+esc(key)+'": function(c,p,t,i) {'+obj[key]+"}")}return"{ "+items.join(",")+" }"}function stringifyPartials(codeObj){var partials=[];for(var key in codeObj.partials){partials.push('"'+esc(key)+'":{name:"'+esc(codeObj.partials[key].name)+'", '+stringifyPartials(codeObj.partials[key])+"}")}return"partials: {"+partials.join(",")+"}, subs: "+stringifySubstitutions(codeObj.subs)}Hogan.stringify=function(codeObj,text,options){return"{code: function (c,p,i) { "+Hogan.wrapMain(codeObj.code)+" },"+stringifyPartials(codeObj)+"}"};var serialNo=0;Hogan.generate=function(tree,text,options){serialNo=0;var context={code:"",subs:{},partials:{}};Hogan.walk(tree,context);if(options.asString){return this.stringify(context,text,options)}return this.makeTemplate(context,text,options)};Hogan.wrapMain=function(code){return'var t=this;t.b(i=i||"");'+code+"return t.fl();"};Hogan.template=Hogan.Template;Hogan.makeTemplate=function(codeObj,text,options){var template=this.makePartials(codeObj);template.code=new Function("c","p","i",this.wrapMain(codeObj.code));return new this.template(template,text,this,options)};Hogan.makePartials=function(codeObj){var key,template={subs:{},partials:codeObj.partials,name:codeObj.name};for(key in template.partials){template.partials[key]=this.makePartials(template.partials[key])}for(key in codeObj.subs){template.subs[key]=new Function("c","p","t","i",codeObj.subs[key])}return template};function esc(s){return s.replace(rSlash,"\\\\").replace(rQuot,'\\"').replace(rNewline,"\\n").replace(rCr,"\\r").replace(rLineSep,"\\u2028").replace(rParagraphSep,"\\u2029")}function chooseMethod(s){return~s.indexOf(".")?"d":"f"}function createPartial(node,context){var prefix="<"+(context.prefix||"");var sym=prefix+node.n+serialNo++;context.partials[sym]={name:node.n,partials:{}};context.code+='t.b(t.rp("'+esc(sym)+'",c,p,"'+(node.indent||"")+'"));';return sym}Hogan.codegen={"#":function(node,context){context.code+="if(t.s(t."+chooseMethod(node.n)+'("'+esc(node.n)+'",c,p,1),'+"c,p,0,"+node.i+","+node.end+',"'+node.otag+" "+node.ctag+'")){'+"t.rs(c,p,"+"function(c,p,t){";Hogan.walk(node.nodes,context);context.code+="});c.pop();}"},"^":function(node,context){context.code+="if(!t.s(t."+chooseMethod(node.n)+'("'+esc(node.n)+'",c,p,1),c,p,1,0,0,"")){';Hogan.walk(node.nodes,context);context.code+="};"},">":createPartial,"<":function(node,context){var ctx={partials:{},code:"",subs:{},inPartial:true};Hogan.walk(node.nodes,ctx);var template=context.partials[createPartial(node,context)];template.subs=ctx.subs;template.partials=ctx.partials},$:function(node,context){var ctx={subs:{},code:"",partials:context.partials,prefix:node.n};Hogan.walk(node.nodes,ctx);context.subs[node.n]=ctx.code;if(!context.inPartial){context.code+='t.sub("'+esc(node.n)+'",c,p,i);'}},"\n":function(node,context){context.code+=write('"\\n"'+(node.last?"":" + i"))},_v:function(node,context){context.code+="t.b(t.v(t."+chooseMethod(node.n)+'("'+esc(node.n)+'",c,p,0)));'},_t:function(node,context){context.code+=write('"'+esc(node.text)+'"')},"{":tripleStache,"&":tripleStache};function tripleStache(node,context){context.code+="t.b(t.t(t."+chooseMethod(node.n)+'("'+esc(node.n)+'",c,p,0)));'}function write(s){return"t.b("+s+");"}Hogan.walk=function(nodelist,context){var func;for(var i=0,l=nodelist.length;i<l;i++){func=Hogan.codegen[nodelist[i].tag];func&&func(nodelist[i],context)}return context};Hogan.parse=function(tokens,text,options){options=options||{};return buildTree(tokens,"",[],options.sectionTags||[])};Hogan.cache={};Hogan.cacheKey=function(text,options){return[text,!!options.asString,!!options.disableLambda,options.delimiters,!!options.modelGet].join("||")};Hogan.compile=function(text,options){options=options||{};var key=Hogan.cacheKey(text,options);var template=this.cache[key];if(template){var partials=template.partials;for(var name in partials){delete partials[name].instance}return template}template=this.generate(this.parse(this.scan(text,options.delimiters),text,options),text,options);return this.cache[key]=template}})(typeof exports!=="undefined"?exports:Hogan)},{}],6:[function(require,module,exports){var Hogan=require("./compiler");Hogan.Template=require("./template").Template;Hogan.template=Hogan.Template;module.exports=Hogan},{"./compiler":5,"./template":7}],7:[function(require,module,exports){var Hogan={};(function(Hogan){Hogan.Template=function(codeObj,text,compiler,options){codeObj=codeObj||{};this.r=codeObj.code||this.r;this.c=compiler;this.options=options||{};this.text=text||"";this.partials=codeObj.partials||{};this.subs=codeObj.subs||{};this.buf=""};Hogan.Template.prototype={r:function(context,partials,indent){return""},v:hoganEscape,t:coerceToString,render:function render(context,partials,indent){return this.ri([context],partials||{},indent)},ri:function(context,partials,indent){return this.r(context,partials,indent)},ep:function(symbol,partials){var partial=this.partials[symbol];var template=partials[partial.name];if(partial.instance&&partial.base==template){return partial.instance}if(typeof template=="string"){if(!this.c){throw new Error("No compiler available.")}template=this.c.compile(template,this.options)}if(!template){return null}this.partials[symbol].base=template;if(partial.subs){if(!partials.stackText)partials.stackText={};for(key in partial.subs){if(!partials.stackText[key]){partials.stackText[key]=this.activeSub!==undefined&&partials.stackText[this.activeSub]?partials.stackText[this.activeSub]:this.text}}template=createSpecializedPartial(template,partial.subs,partial.partials,this.stackSubs,this.stackPartials,partials.stackText)}this.partials[symbol].instance=template;return template},rp:function(symbol,context,partials,indent){var partial=this.ep(symbol,partials);if(!partial){return""}return partial.ri(context,partials,indent)},rs:function(context,partials,section){var tail=context[context.length-1];if(!isArray(tail)){section(context,partials,this);return}for(var i=0;i<tail.length;i++){context.push(tail[i]);section(context,partials,this);context.pop()}},s:function(val,ctx,partials,inverted,start,end,tags){var pass;if(isArray(val)&&val.length===0){return false}if(typeof val=="function"){val=this.ms(val,ctx,partials,inverted,start,end,tags)}pass=!!val;if(!inverted&&pass&&ctx){ctx.push(typeof val=="object"?val:ctx[ctx.length-1])}return pass},d:function(key,ctx,partials,returnFound){var found,names=key.split("."),val=this.f(names[0],ctx,partials,returnFound),doModelGet=this.options.modelGet,cx=null;if(key==="."&&isArray(ctx[ctx.length-2])){val=ctx[ctx.length-1]}else{for(var i=1;i<names.length;i++){found=findInScope(names[i],val,doModelGet);if(found!==undefined){cx=val;val=found}else{val=""}}}if(returnFound&&!val){return false}if(!returnFound&&typeof val=="function"){ctx.push(cx);val=this.mv(val,ctx,partials);ctx.pop()}return val},f:function(key,ctx,partials,returnFound){var val=false,v=null,found=false,doModelGet=this.options.modelGet;for(var i=ctx.length-1;i>=0;i--){v=ctx[i];val=findInScope(key,v,doModelGet);if(val!==undefined){found=true;break}}if(!found){return returnFound?false:""}if(!returnFound&&typeof val=="function"){val=this.mv(val,ctx,partials)}return val},ls:function(func,cx,partials,text,tags){var oldTags=this.options.delimiters;this.options.delimiters=tags;this.b(this.ct(coerceToString(func.call(cx,text)),cx,partials));this.options.delimiters=oldTags;return false},ct:function(text,cx,partials){if(this.options.disableLambda){throw new Error("Lambda features disabled.")}return this.c.compile(text,this.options).render(cx,partials)},b:function(s){this.buf+=s},fl:function(){var r=this.buf;this.buf="";return r},ms:function(func,ctx,partials,inverted,start,end,tags){var textSource,cx=ctx[ctx.length-1],result=func.call(cx);if(typeof result=="function"){if(inverted){return true}else{textSource=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text;return this.ls(result,cx,partials,textSource.substring(start,end),tags)}}return result},mv:function(func,ctx,partials){var cx=ctx[ctx.length-1];var result=func.call(cx);if(typeof result=="function"){return this.ct(coerceToString(result.call(cx)),cx,partials)}return result},sub:function(name,context,partials,indent){var f=this.subs[name];if(f){this.activeSub=name;f(context,partials,this,indent);this.activeSub=false}}};function findInScope(key,scope,doModelGet){var val;if(scope&&typeof scope=="object"){if(scope[key]!==undefined){val=scope[key]}else if(doModelGet&&scope.get&&typeof scope.get=="function"){val=scope.get(key)}}return val}function createSpecializedPartial(instance,subs,partials,stackSubs,stackPartials,stackText){function PartialTemplate(){}PartialTemplate.prototype=instance;function Substitutions(){}Substitutions.prototype=instance.subs;var key;var partial=new PartialTemplate;partial.subs=new Substitutions;partial.subsText={};partial.buf="";stackSubs=stackSubs||{};partial.stackSubs=stackSubs;partial.subsText=stackText;for(key in subs){if(!stackSubs[key])stackSubs[key]=subs[key]}for(key in stackSubs){partial.subs[key]=stackSubs[key]}stackPartials=stackPartials||{};partial.stackPartials=stackPartials;for(key in partials){if(!stackPartials[key])stackPartials[key]=partials[key]}for(key in stackPartials){partial.partials[key]=stackPartials[key]}return partial}var rAmp=/&/g,rLt=/</g,rGt=/>/g,rApos=/\'/g,rQuot=/\"/g,hChars=/[&<>\"\']/;function coerceToString(val){return String(val===null||val===undefined?"":val)}function hoganEscape(str){str=coerceToString(str);return hChars.test(str)?str.replace(rAmp,"&amp;").replace(rLt,"&lt;").replace(rGt,"&gt;").replace(rApos,"&#39;").replace(rQuot,"&quot;"):str}var isArray=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"}})(typeof exports!=="undefined"?exports:Hogan)},{}],8:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var makeRequest=require("@mol-fe/mol-fe-client-utils/src/makeRequest");var _require=require("./config");var showNextDelay=_require.showNextDelay;var maxCommentUserLocationLength=_require.maxCommentUserLocationLength;var nextStoryElementId=_require.nextStoryElementId;var nextStoryClass=_require.nextStoryClass;var _require2=require("./utils");var updateCommentUserLocation=_require2.updateCommentUserLocation;var createContainer=_require2.createContainer;var getCommentTime=_require2.getCommentTime;var time=_require2.time;var addClass=_require2.addClass;var removeClass=_require2.removeClass;var commentElementPositions=["previous","current","next"];function setCommentElementPosClass(el,position){commentElementPositions.forEach(function(pos){if(pos!==position){removeClass(el,pos)}else{addClass(el,pos)}})}var CommentNotifications=function(){function CommentNotifications(channel){_classCallCheck(this,CommentNotifications);this.isEnabled=false;this.channel=channel;this.url="/api/commentnotification/"+this.channel+".json";this.nextStoryElement=document.getElementById(nextStoryElementId);this._resetCounters()}_createClass(CommentNotifications,[{key:"refreshData",value:function refreshData(){var _this=this;this._resetRequest();return new Promise(function(resolve,reject){makeRequest(_this.url,function(err,data){if(err){return reject(err)}resolve(data)})}).then(function(responseText){return JSON.parse(responseText)}).then(function(data){if(data&&data.comments){_this.data=updateCommentUserLocation(data,maxCommentUserLocationLength);_this._initElements()}else{throw"No comments to render"}_this.request=null}).catch(function(err){_this.request=null;throw err})}},{key:"notifyNexStory",value:function notifyNexStory(disable){if(this.nextStoryElement){if(disable){removeClass(this.nextStoryElement,nextStoryClass)}else{addClass(this.nextStoryElement,nextStoryClass)}}return this}},{key:"showNextComment",value:function showNextComment(){this._updateCommentTimes();this.curComment=(this.curComment+1)%this.commentsCount;var prevIndex=(this.commentsCount+this.curComment-2)%this.commentsCount;var curIndex=(this.commentsCount+this.curComment-1)%this.commentsCount;var nextIndex=this.curComment;setCommentElementPosClass(this.commentElements[prevIndex],"previous");setCommentElementPosClass(this.commentElements[curIndex],"current");setCommentElementPosClass(this.commentElements[nextIndex],"next")}},{key:"disable",value:function disable(){this._resetRequest()._stopIntervals()._removeElement().notifyNexStory(true);this.isEnabled=false;return this}},{key:"enable",value:function enable(){var _this2=this;if(!this.isEnabled){this.isEnabled=true;document.body.appendChild(this.element);this.notifyNexStory().showNextComment();this.showNextInterval=setInterval(function(){return _this2.showNextComment()},showNextDelay*time.SECOND)}return this}},{key:"_initElements",value:function _initElements(){this._removeElement();this.element=createContainer(this.channel,this.data);this.commentElements=this.element.querySelectorAll(".comment-notification-comment");this.commentsCount=this.commentElements.length;this.commentTimes=[].concat(_toConsumableArray(this.element.querySelectorAll(".comment-notification-time")))}},{key:"_resetCounters",value:function _resetCounters(){this.curComment=0;return this}},{key:"_updateCommentTimes",value:function _updateCommentTimes(){var _this3=this;this.commentTimes.forEach(function(element,index){element.innerHTML=getCommentTime(_this3.data.comments[index])})}},{key:"_removeElement",value:function _removeElement(){if(this.element&&this.element.parentNode)this.element.parentNode.removeChild(this.element);return this}},{key:"_resetRequest",value:function _resetRequest(){if(this.request){this.request.abort();this.request=null}return this}},{key:"_stopIntervals",value:function _stopIntervals(){if(this.showNextInterval)clearInterval(this.showNextInterval);return this}}]);return CommentNotifications}();module.exports=CommentNotifications},{"./config":10,"./utils":13,"@mol-fe/mol-fe-client-utils/src/makeRequest":4}],9:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _require=require("./config");var containerHeight=_require.containerHeight;var _require$watchOverlay=_require.watchOverlay;var waitForElementDelay=_require$watchOverlay.waitForElementDelay;var waitForElementTimeout=_require$watchOverlay.waitForElementTimeout;var topStoryMarginBottom=_require.topStoryMarginBottom;var WAIT_FOR_ELEMENT_TRY_COUNT=waitForElementTimeout/waitForElementDelay;function isOverlaid(slotViewPortBox,widgetHeight){var windowHeight=window.innerHeight;var isOverlaid=void 0;if(widgetHeight>windowHeight){isOverlaid=true}else if(slotViewPortBox.top>=windowHeight||slotViewPortBox.bottom>=windowHeight){isOverlaid=false}else{isOverlaid=windowHeight-slotViewPortBox.bottom<widgetHeight}return isOverlaid}var WatchOverlay=function(){function WatchOverlay(commentNotifications){_classCallCheck(this,WatchOverlay);this.map={};this.waitForElementDelay=waitForElementDelay;this.nextStoryElement=commentNotifications.nextStoryElement;this.cbs=[];this.allowSynch=true}_createClass(WatchOverlay,[{key:"notifyOverlay",value:function notifyOverlay(isOverlaid){this.cbs.forEach(function(cb){return cb(isOverlaid)})}},{key:"addCallback",value:function addCallback(cb){this.cbs.push(cb)}},{key:"addSlot",value:function addSlot(slotId){this.map[slotId]={id:slotId};return this}},{key:"synch",value:function synch(){var _this=this;if(!this.allowSynch){return}var promises=[];Object.keys(this.map).forEach(function(slotId){var overlaySlot=_this.map[slotId];if(overlaySlot.done&&!overlaySlot.element)return delete _this.map[slotId];promises.push(overlaySlot.element||_this.waitForSlot(overlaySlot))});return Promise.all(promises).then(function(elements){_this.notifyOverlay(elements.some(function(element){if(!element)return false;var finalHeight=containerHeight;if(_this.nextStoryElement){var clientRect=_this.nextStoryElement.getBoundingClientRect();finalHeight+=clientRect.bottom-clientRect.top+topStoryMarginBottom}return isOverlaid(element.getBoundingClientRect(),finalHeight)}))}).catch(function(){})}},{
key:"waitForSlot",value:function waitForSlot(overlaySlot){var _this2=this;var getElement=function getElement(resolve,reject){overlaySlot.element=document.getElementById(overlaySlot.id);if(overlaySlot.element)return resolve(overlaySlot.element);overlaySlot.tryCount=(overlaySlot.tryCount||0)+1;if(overlaySlot.tryCount>WAIT_FOR_ELEMENT_TRY_COUNT){overlaySlot.done=true;return reject()}overlaySlot.timeoutId=setTimeout(function(){getElement(resolve,reject)},_this2.waitForElementDelay)};return new Promise(function(resolve,reject){if(overlaySlot.done)return resolve(overlaySlot.element);getElement(resolve,reject)})}}]);return WatchOverlay}();module.exports=WatchOverlay},{"./config":10}],10:[function(require,module,exports){"use strict";module.exports={nextStoryElementId:"next-story",nextStoryClass:"with-comment-notification",containerHeight:320,watchOverlay:{waitForElementDelay:100,waitForElementTimeout:2e3},slotsToWatch:{halfsky_right_top:{watchHeight:true},halfsky_right_bottom:{watchHeight:true},halfsky_right_middle:{watchHeight:true},sky_right_top:{watchHeight:true},billboard:{verifyHit:function verifyHit(slot){return((slot||{}).parentId||"").trim().toLowerCase()==="billboard-oop"}}},showNextDelay:5,maxCommentUserLocationLength:23,topStoryMarginBottom:15}},{}],11:[function(require,module,exports){"use strict";var onDocumentLoad=require("@mol-fe/mol-fe-client-utils/src/dom/onDocumentLoad");var runModule=require("./runModule");function isFeaturedArticle(){return document.body.classList.contains("mol-feature")}onDocumentLoad(function(){if(isFeaturedArticle()){return}if(DM&&DM.getPageMetadata&&DM.getPageMetadata().channel){runModule(DM.getPageMetadata().channel.substring(1)).catch(function(){})}})},{"./runModule":12,"@mol-fe/mol-fe-client-utils/src/dom/onDocumentLoad":3}],12:[function(require,module,exports){"use strict";var CommentNotifications=require("./CommentNotifications");var _require=require("./utils");var getRenderedSlots=_require.getRenderedSlots;var onViewPortChange=_require.onViewPortChange;var _require2=require("./config");var slotsToWatch=_require2.slotsToWatch;var WatchOverlay=require("./WatchOverlay");function startWatching(watchOverlay,slotName,slot){if(!slotName||!slot||!slot.parentId)return;if(slotsToWatch.hasOwnProperty(slotName)&&!slotsToWatch[slotName].ignore){var slotConfig=slotsToWatch[slotName];if(!slotConfig.verifyHit||slotConfig.verifyHit(slot)){if(slotConfig.watchHeight){watchOverlay.addSlot(slot.parentId).synch()}else{watchOverlay.notifyOverlay(true);watchOverlay.allowSynch=false}}}}function runModule(channel){var commentNotifications=new CommentNotifications(channel);var watchOverlay=new WatchOverlay(commentNotifications);var refreshDataPromise=void 0;onViewPortChange(function(){return watchOverlay.synch()});watchOverlay.addCallback(function(isOverlaid){refreshDataPromise&&refreshDataPromise.then(function(){if(isOverlaid){commentNotifications.disable()}else{commentNotifications.enable()}}).catch(function(){})});refreshDataPromise=commentNotifications.refreshData().then(function(){commentNotifications.enable();return commentNotifications});if(window.adverts){(function(){var renderedSlots=getRenderedSlots();Object.keys(slotsToWatch).forEach(function(slotName){renderedSlots.hasOwnProperty(slotName)&&startWatching(watchOverlay,slotName,renderedSlots[slotName]);window.adverts.on("rendered."+slotName,function(event){startWatching(watchOverlay,slotName,((event||{}).slot||{}).molAd)})})})()}return refreshDataPromise}module.exports=runModule},{"./CommentNotifications":8,"./WatchOverlay":9,"./config":10,"./utils":13}],13:[function(require,module,exports){"use strict";var template=require("../templates/notification.mustache");var SECOND=1e3;var MINUTE=SECOND*60;var HOUR=MINUTE*60;var DAY=HOUR*24;function formatTimeDiff(now,date){var diff=now-date;if(diff<MINUTE){return"Just now"}else if(diff<HOUR){var minutes=Math.floor(diff/MINUTE);return"About "+minutes+" minute"+(minutes>1?"s":"")+" ago"}else if(diff<DAY){var hours=Math.floor(diff/HOUR);return"About "+hours+" hour"+(hours>1?"s":"")+" ago"}else{var days=Math.floor(diff/DAY);return"About "+days+" day"+(days>1?"s":"")+" ago"}}function updateCommentUserLocation(data,maxLength){data.comments.forEach(function(comment){if(comment.userLocation&&comment.userLocation.length>maxLength){comment.userLocation=comment.userLocation.substring(0,maxLength-3)+"... "}});return data}function getCommentTime(comment){var creationTime=void 0;if(comment.unixTimestamp){creationTime=comment.unixTimestamp*1e3}else if(comment.createdDateUTC){creationTime=new Date(comment.createdDateUTC).getTime()}else if(comment.commentCreateDate){var commentDate=comment.commentCreateDate.split(" ");if(commentDate.length===2){var datePart=commentDate[0].split("-");var timePart=commentDate[1].split(":");if(datePart.length===3&&timePart.length===3){creationTime=new Date(datePart[0],datePart[1]-1,datePart[2],timePart[0],timePart[1],timePart[2]).getTime()}}}return creationTime?formatTimeDiff(Date.now(),creationTime):""}function createContainer(channel,data){var container=document.createElement("div");container.className="comment-notification-container";container.innerHTML=template.render(data);container.className=channel+" comment-notification-container comment-notification-visible";return container}function getRenderedSlots(){if(!window.adverts)return null;var rendered=window.adverts.getRendered();var map={};rendered&&rendered.length&&rendered.forEach(function(obj){map[obj.pos]=obj});return map}function _removeClass(originalClass,className){var regExp=new RegExp("\\s+"+className,"gi");return originalClass.replace(regExp,"")}function addClass(el,className){el.className=_removeClass(el.className,className)+" "+className}function removeClass(el,className){el.className=_removeClass(el.className,className)}function onViewPortChange(cb){var timeoutId=void 0;function callCb(){clearTimeout(timeoutId);timeoutId=setTimeout(function(){return cb()},100)}window.addEventListener("scroll",callCb);window.addEventListener("resize",callCb)}module.exports={formatTimeDiff:formatTimeDiff,updateCommentUserLocation:updateCommentUserLocation,getCommentTime:getCommentTime,createContainer:createContainer,getRenderedSlots:getRenderedSlots,addClass:addClass,removeClass:removeClass,onViewPortChange:onViewPortChange,time:{SECOND:SECOND,MINUTE:MINUTE,HOUR:HOUR,DAY:DAY}}},{"../templates/notification.mustache":14}],14:[function(require,module,exports){var Hogan=require("hogan.js");module.exports=new Hogan.Template({code:function(c,p,i){var t=this;t.b(i=i||"");t.b('<div class="comment-notification-header wocc">');t.b("\n"+i);t.b("  Latest comments");t.b("\n"+i);t.b("</div>");t.b("\n"+i);t.b('<div class="comment-notification-viewport" data-track-module="am-comment_notification^comment_notification">');t.b("\n"+i);if(t.s(t.f("comments",c,p,1),c,p,0,196,939,"{{ }}")){t.rs(c,p,function(c,p,t){t.b('    <div class="comment-notification-comment">');t.b("\n"+i);t.b('      <a class="comment-notification-text" href="');t.b(t.v(t.f("url",c,p,0)));t.b("?offset=0&max=100&jumpTo=comment-");t.b(t.v(t.f("commentId",c,p,0)));t.b('">');t.b("\n"+i);t.b("          ");t.b(t.v(t.f("commentText",c,p,0)));t.b("\n"+i);t.b("        </a>");t.b("\n"+i);t.b('      <div class="comment-notification-details">');t.b("\n"+i);t.b('        <p class="comment-notification-user">');t.b(t.v(t.f("user",c,p,0)));t.b("</p>");t.b("\n"+i);t.b('        <p class="comment-notification-time">');t.b(t.v(t.f("time",c,p,0)));t.b("</p>");t.b("\n"+i);t.b('        <a class="comment-notification-commentlink" href="');t.b(t.v(t.f("url",c,p,0)));t.b("?offset=0&max=100&jumpTo=comment-");t.b(t.v(t.f("commentId",c,p,0)));t.b('">Read more</a>');t.b("\n"+i);t.b('        <a class="comment-notification-headline" href="');t.b(t.v(t.f("url",c,p,0)));t.b('">');t.b(t.t(t.f("articleHeadline",c,p,0)));t.b("</a>");t.b("\n"+i);t.b("      </div>");t.b("\n"+i);t.b('      <div class="comment-notification-footer">');t.b("\n"+i);t.b('        <a class="comment-notification-articlelink" href="');t.b(t.v(t.f("url",c,p,0)));t.b('">View story</a>');t.b("\n"+i);t.b("      </div>");t.b("\n"+i);t.b("    </div>");t.b("\n"+i)});c.pop()}t.b("</div>");t.b("\n");return t.fl()},partials:{},subs:{}},'<div class="comment-notification-header wocc">\n  Latest comments\n</div>\n<div class="comment-notification-viewport" data-track-module="am-comment_notification^comment_notification">\n  {{#comments}}\n    <div class="comment-notification-comment">\n      <a class="comment-notification-text" href="{{url}}?offset=0&max=100&jumpTo=comment-{{commentId}}">\n          {{commentText}}\n        </a>\n      <div class="comment-notification-details">\n        <p class="comment-notification-user">{{user}}</p>\n        <p class="comment-notification-time">{{time}}</p>\n        <a class="comment-notification-commentlink" href="{{url}}?offset=0&max=100&jumpTo=comment-{{commentId}}">Read more</a>\n        <a class="comment-notification-headline" href="{{url}}">{{{articleHeadline}}}</a>\n      </div>\n      <div class="comment-notification-footer">\n        <a class="comment-notification-articlelink" href="{{url}}">View story</a>\n      </div>\n    </div>\n  {{/comments}}\n</div>\n',Hogan)},{"hogan.js":6}]},{},[11]);!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=19)}([function(e,t,r){"use strict";function n(e){var t=e.cb,r=e.throwError,n=void 0!==r&&r,i="undefined"==typeof t?"undefined":o(t);if("function"!==i){if(n)throw new Error('onDocumentLoad: expected function, but received "'+i+'"');return!1}return!0}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=n},function(e,t,r){"use strict";function n(e){return o({cb:e,throwError:!0}),{isRemoved:!1,remove:function(){this.isRemoved=!0,e()}}}var o=r(0);e.exports=n},function(e,t,r){"use strict";var n=String.prototype.replace,o=/%20/g;e.exports={"default":"RFC3986",formatters:{RFC1738:function(e){return n.call(e,o,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=Object.prototype.hasOwnProperty,i=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}();t.arrayToObject=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)"undefined"!=typeof e[n]&&(r[n]=e[n]);return r},t.merge=function(e,r,i){if(!r)return e;if("object"!==("undefined"==typeof r?"undefined":n(r))){if(Array.isArray(e))e.push(r);else{if("object"!==("undefined"==typeof e?"undefined":n(e)))return[e,r];e[r]=!0}return e}if("object"!==("undefined"==typeof e?"undefined":n(e)))return[e].concat(r);var a=e;return Array.isArray(e)&&!Array.isArray(r)&&(a=t.arrayToObject(e,i)),Array.isArray(e)&&Array.isArray(r)?(r.forEach(function(r,a){o.call(e,a)?e[a]&&"object"===n(e[a])?e[a]=t.merge(e[a],r,i):e.push(r):e[a]=r}),e):Object.keys(r).reduce(function(e,n){var o=r[n];return Object.prototype.hasOwnProperty.call(e,n)?e[n]=t.merge(e[n],o,i):e[n]=o,e},a)},t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},t.encode=function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),r="",n=0;n<t.length;++n){var o=t.charCodeAt(n);45===o||46===o||95===o||126===o||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122?r+=t.charAt(n):o<128?r+=i[o]:o<2048?r+=i[192|o>>6]+i[128|63&o]:o<55296||o>=57344?r+=i[224|o>>12]+i[128|o>>6&63]+i[128|63&o]:(n+=1,o=65536+((1023&o)<<10|1023&t.charCodeAt(n)),r+=i[240|o>>18]+i[128|o>>12&63]+i[128|o>>6&63]+i[128|63&o])}return r},t.compact=function(e,r){if("object"!==("undefined"==typeof e?"undefined":n(e))||null===e)return e;var o=r||[],i=o.indexOf(e);if(i!==-1)return o[i];if(o.push(e),Array.isArray(e)){for(var a=[],c=0;c<e.length;++c)e[c]&&"object"===n(e[c])?a.push(t.compact(e[c],o)):"undefined"!=typeof e[c]&&a.push(e[c]);return a}var l=Object.keys(e);return l.forEach(function(r){e[r]=t.compact(e[r],o)}),e},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isBuffer=function(e){return null!==e&&"undefined"!=typeof e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},function(e,t,r){"use strict";var n=r(6),o=r(7);e.exports={onDocumentLoad:n,onOrientationChange:o}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(8),c=n(a),l=r(12),u=n(l),s=r(13),f=r(11),p=r(15),d=n(p),y=r(16),m=n(y),h=r(17),v=n(h),b=r(18),g=n(b);r(14);var w=function(){function e(t){o(this,e),this.element=t,this.createSocialShareButtons(),this.createSocialShareObject(),this.addEventListeners()}return i(e,[{key:"createSocialShareButtons",value:function(){var e='<a class="mol-factbox-social-share-button facebook">'+d.default+"</a>",t='<a class="mol-factbox-social-share-button twitter">'+g.default+"</a>",r='<a class="mol-factbox-social-share-button pinterest">'+v.default+"</a>",n='<a class="mol-factbox-social-share-button mailto">'+m.default+"</a>",o=document.createElement("div");o.className="mol-factbox-social-share-buttons",o.innerHTML=e+t+r+n,this.element.appendChild(o)}},{key:"createSocialShareObject",value:function(){this.socialShareObject={description:this.getDescription(),image:this.getImage(),title:this.getTitle(),via:s.currentChannelTwitterFollow||""}}},{key:"getDescription",value:function(){return this.getFactboxDescription()||(0,f.getOpenGraphDescription)()||""}},{key:"getFactboxDescription",value:function(){return this.getTextContentByQuerySelector(".mol-para-with-font")}},{key:"getImage",value:function(){return this.getFactboxImage()||(0,f.getOpenGraphImage)()||""}},{key:"getFactboxImage",value:function(){var e=$("#"+this.element.id+" img:not(.mol-video img)"),t=e&&e.length&&e[0];return t&&(t.getAttribute("data-src")||t.src)}},{key:"getTitle",value:function(){return this.getFactboxTitle()||(0,f.getOpenGraphTitle)()||""}},{key:"getFactboxTitle",value:function(){return this.getTextContentByQuerySelector("h3")}},{key:"getTextContentByQuerySelector",value:function(e){var t=this.element.querySelector(e);return t&&t.textContent&&t.textContent.trim()}},{key:"addEventListeners",value:function(){var e=this;this.element.querySelector(".mol-factbox-social-share-button.facebook").addEventListener("click",function(){return e.postToFacebook()}),this.element.querySelector(".mol-factbox-social-share-button.twitter").addEventListener("click",function(){return e.postToTwitter()}),this.element.querySelector(".mol-factbox-social-share-button.pinterest").addEventListener("click",function(){return e.postToPinterest()}),this.element.querySelector(".mol-factbox-social-share-button.mailto").addEventListener("click",function(){return e.shareByEmail()})}},{key:"getShareUrl",value:function(e){var t=document.location,r=""+this.element.id,n=c.default.parse(t.search.slice(1));return n.ito=e+"_share_article-factbox",""+t.origin+t.pathname+"?"+c.default.stringify(n)+"#"+r}},{key:"postToFacebook",value:function(){u.default.Facebook.postToFB("factbox",JSON.stringify({description:this.socialShareObject.description,link:this.getShareUrl("facebook"),name:this.socialShareObject.title,picture:this.socialShareObject.image}),this.socialShareObject.trackingOptions)}},{key:"postToTwitter",value:function(){u.default.Twitter.postToTWTTR("factbox",JSON.stringify({text:this.socialShareObject.title+" - "+this.socialShareObject.description,url:this.getShareUrl("twitter"),via:this.socialShareObject.via}),this.socialShareObject.trackingOptions)}},{key:"postToPinterest",value:function(){u.default.Pinterest.postToPinterest("factbox",{caption:this.socialShareObject.title,description:this.socialShareObject.description,media:this.socialShareObject.image,type:"factbox",url:this.getShareUrl("pinterest")},this.socialShareObject.trackingOptions)}},{key:"shareByEmail",value:function(){var e=this.socialShareObject.description+"\n\n"+encodeURI(this.getShareUrl("email"));u.default.socialClick("email","factbox"),this.element.querySelector(".mol-factbox-social-share-button.mailto").href="mailto:?subject="+encodeURIComponent(this.socialShareObject.title)+"&body="+encodeURIComponent(e)}}]),e}();t.default=w},function(e,t,r){"use strict";function n(e){function t(){a.isRemoved||(a.remove(),e())}o({cb:e,throwError:!0});var r=["DOMContentLoaded",t],n=["load",t],a=i(function(){var e,t;(e=document).removeEventListener.apply(e,r),(t=window).removeEventListener.apply(t,n)});if(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)t();else{var c,l;(c=document).addEventListener.apply(c,r),(l=window).addEventListener.apply(l,n)}return a}var o=r(0),i=r(1);e.exports=n},function(e,t,r){"use strict";function n(e){function t(t){clearInterval(s),clearTimeout(f),t&&(s=null,f=null,e(t))}function r(e){t(),s=setInterval(function(){window.innerWidth===p&&window.innerHeight===d?(y++,y===l&&t(e)):(p=window.innerWidth,d=window.innerHeight,y=0)},c),f=setTimeout(function(){t(e)},a)}var n,u;o({cb:e,throwError:!0});var s=void 0,f=void 0,p=void 0,d=void 0,y=void 0,m=["resize",r],h=["orientationchange",r];return(n=window).addEventListener.apply(n,m),(u=window).addEventListener.apply(u,h),i(function(){var e,t;(e=window).removeEventListener.apply(e,m),(t=window).removeEventListener.apply(t,h)})}var o=r(0),i=r(1),a=1e3,c=100,l=3;e.exports=n},function(e,t,r){"use strict";var n=r(10),o=r(9),i=r(2);e.exports={formats:i,parse:o,stringify:n}},function(e,t,r){"use strict";var n=r(3),o=Object.prototype.hasOwnProperty,i={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:n.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},a=function(e,t){for(var r={},n=e.split(t.delimiter,t.parameterLimit===1/0?void 0:t.parameterLimit),i=0;i<n.length;++i){var a,c,l=n[i],u=l.indexOf("]=")===-1?l.indexOf("="):l.indexOf("]=")+1;u===-1?(a=t.decoder(l),c=t.strictNullHandling?null:""):(a=t.decoder(l.slice(0,u)),c=t.decoder(l.slice(u+1))),o.call(r,a)?r[a]=[].concat(r[a]).concat(c):r[a]=c}return r},c=function e(t,r,n){if(!t.length)return r;var o,i=t.shift();if("[]"===i)o=[],o=o.concat(e(t,r,n));else{o=n.plainObjects?Object.create(null):{};var a="["===i[0]&&"]"===i[i.length-1]?i.slice(1,i.length-1):i,c=parseInt(a,10);!isNaN(c)&&i!==a&&String(c)===a&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(o=[],o[c]=e(t,r,n)):o[a]=e(t,r,n)}return o},l=function(e,t,r){if(e){var n=r.allowDots?e.replace(/\.([^\.\[]+)/g,"[$1]"):e,i=/^([^\[\]]*)/,a=/(\[[^\[\]]*\])/g,l=i.exec(n),u=[];if(l[1]){if(!r.plainObjects&&o.call(Object.prototype,l[1])&&!r.allowPrototypes)return;u.push(l[1])}for(var s=0;null!==(l=a.exec(n))&&s<r.depth;)s+=1,(r.plainObjects||!o.call(Object.prototype,l[1].replace(/\[|\]/g,""))||r.allowPrototypes)&&u.push(l[1]);return l&&u.push("["+n.slice(l.index)+"]"),c(u,t,r)}};e.exports=function(e,t){var r=t||{};if(null!==r.decoder&&void 0!==r.decoder&&"function"!=typeof r.decoder)throw new TypeError("Decoder has to be a function.");if(r.delimiter="string"==typeof r.delimiter||n.isRegExp(r.delimiter)?r.delimiter:i.delimiter,r.depth="number"==typeof r.depth?r.depth:i.depth,r.arrayLimit="number"==typeof r.arrayLimit?r.arrayLimit:i.arrayLimit,r.parseArrays=r.parseArrays!==!1,r.decoder="function"==typeof r.decoder?r.decoder:i.decoder,r.allowDots="boolean"==typeof r.allowDots?r.allowDots:i.allowDots,r.plainObjects="boolean"==typeof r.plainObjects?r.plainObjects:i.plainObjects,r.allowPrototypes="boolean"==typeof r.allowPrototypes?r.allowPrototypes:i.allowPrototypes,r.parameterLimit="number"==typeof r.parameterLimit?r.parameterLimit:i.parameterLimit,r.strictNullHandling="boolean"==typeof r.strictNullHandling?r.strictNullHandling:i.strictNullHandling,""===e||null===e||"undefined"==typeof e)return r.plainObjects?Object.create(null):{};for(var o="string"==typeof e?a(e,r):e,c=r.plainObjects?Object.create(null):{},u=Object.keys(o),s=0;s<u.length;++s){var f=u[s],p=l(f,o[f],r);c=n.merge(c,p,r)}return n.compact(c)}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(3),i=r(2),a={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},c=Date.prototype.toISOString,l={delimiter:"&",encode:!0,encoder:o.encode,serializeDate:function(e){return c.call(e)},skipNulls:!1,strictNullHandling:!1},u=function e(t,r,n,i,a,c,l,u,s,f,p){var d=t;if("function"==typeof l)d=l(r,d);else if(d instanceof Date)d=f(d);else if(null===d){if(i)return c?c(r):r;d=""}if("string"==typeof d||"number"==typeof d||"boolean"==typeof d||o.isBuffer(d))return c?[p(c(r))+"="+p(c(d))]:[p(r)+"="+p(String(d))];var y=[];if("undefined"==typeof d)return y;var m;if(Array.isArray(l))m=l;else{var h=Object.keys(d);m=u?h.sort(u):h}for(var v=0;v<m.length;++v){var b=m[v];a&&null===d[b]||(y=Array.isArray(d)?y.concat(e(d[b],n(r,b),n,i,a,c,l,u,s,f,p)):y.concat(e(d[b],r+(s?"."+b:"["+b+"]"),n,i,a,c,l,u,s,f,p)))}return y};e.exports=function(e,t){var r=e,o=t||{},c="undefined"==typeof o.delimiter?l.delimiter:o.delimiter,s="boolean"==typeof o.strictNullHandling?o.strictNullHandling:l.strictNullHandling,f="boolean"==typeof o.skipNulls?o.skipNulls:l.skipNulls,p="boolean"==typeof o.encode?o.encode:l.encode,d=p?"function"==typeof o.encoder?o.encoder:l.encoder:null,y="function"==typeof o.sort?o.sort:null,m="undefined"!=typeof o.allowDots&&o.allowDots,h="function"==typeof o.serializeDate?o.serializeDate:l.serializeDate;if("undefined"==typeof o.format)o.format=i.default;else if(!Object.prototype.hasOwnProperty.call(i.formatters,o.format))throw new TypeError("Unknown format option provided.");var v,b,g=i.formatters[o.format];if(null!==o.encoder&&void 0!==o.encoder&&"function"!=typeof o.encoder)throw new TypeError("Encoder has to be a function.");"function"==typeof o.filter?(b=o.filter,r=b("",r)):Array.isArray(o.filter)&&(b=o.filter,v=b);var w=[];if("object"!==("undefined"==typeof r?"undefined":n(r))||null===r)return"";var O;O=o.arrayFormat in a?o.arrayFormat:"indices"in o?o.indices?"indices":"repeat":"indices";var x=a[O];v||(v=Object.keys(r)),y&&v.sort(y);for(var j=0;j<v.length;++j){var S=v[j];f&&null===r[S]||(w=w.concat(u(r[S],S,x,s,f,d,b,y,m,h,g)))}return w.join(c)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=$('meta[property="og:description"]');return e&&e.attr("content")},o=function(){var e=$('meta[property="og:image"]');return e&&e.attr("content")},i=function(){var e=$('meta[property="og:title"]');return e&&e.attr("content")};t.getOpenGraphDescription=n,t.getOpenGraphImage=o,t.getOpenGraphTitle=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.DMS},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=window.currentChannelTwitterFollow;t.currentChannelTwitterFollow=n},function(e,t){},function(e,t){e.exports='<svg viewBox="0 0 9.05 18.18" xmlns="http://www.w3.org/2000/svg"><path d="m6 19.09h-4v-9.09h-2v-3.13h2v-1.87c0-2.57 1.14-4.09 4.35-4.09h2.65v3.09h-1.64c-1.25 0-1.36.48-1.36 1.3v1.57h3l-.3 3.13h-2.7z" transform="translate(0 -.91)"/></svg>'},function(e,t){e.exports='<svg viewBox="0 0 21.66 15.19" xmlns="http://www.w3.org/2000/svg"><path d="m1 0l9.73 9.49 9.89-9.49z"/><path d="m7.46 9l-6.46 6.19h19.07l-6.3-6.12-3.15 3.03z"/><path d="m0 13.08l6.25-6-6.25-6.08z"/><path d="m21.66 13.86v-12.86l-6.66 6.39z"/></svg>'},function(e,t){e.exports='<svg viewBox="0 0 13.87 17.77" xmlns="http://www.w3.org/2000/svg"><path d="m7.35 0c-4.89 0-7.35 3.48-7.35 6.37 0 1.75.67 3.32 2.11 3.9a.35.35 0 0 0  .51-.27l.21-.8a.49.49 0 0 0-.15-.57 2.93 2.93 0 0 1-.68-2 4.85 4.85 0 0 1  5.07-4.89c2.76 0 4.28 1.67 4.28 3.91 0 2.94-1.31 5.43-3.26 5.43a1.58 1.58 0 0 1-1.62-2 21.76 21.76 0 0 0  .91-3.62 1.37 1.37 0 0 0-1.38-1.46c-1.11 0-2 1.09-2 2.6a3.9 3.9 0 0 0  .33 1.61l-1.33 5.57a11.35 11.35 0 0 0 0 3.88.14.14 0 0 0  .24.06 10.86 10.86 0 0 0  1.86-3.34c.13-.45.72-2.81.72-2.81a3 3 0 0 0 2.51 1.27c3.31 0 5.55-3 5.55-7 0-3-2.59-5.85-6.51-5.85h0z"/></svg>'},function(e,t){e.exports='<svg viewBox="0 0 19.91 16.36" xmlns="http://www.w3.org/2000/svg"><path d="m17.72 3.4a4.13 4.13 0 0 0 1.8-2.29 8.13 8.13 0 0 1-2.59 1 4.06 4.06 0 0 0-3-1.3 4.11 4.11 0 0 0-4.08 4.14 4.18 4.18 0 0 0  .11.94 11.56 11.56 0 0 1-8.42-4.32 4.17 4.17 0 0 0  1.26 5.52 4 4 0 0 1-1.8-.52s0 0 0 .05a4.12 4.12 0 0 0 3.28 4.05 4 4 0 0 1-1.84.07 4.1 4.1 0 0 0  3.76 2.88 8.14 8.14 0 0 1-5.07 1.77 8.26 8.26 0 0 1-1-.06 11.47 11.47 0 0 0  6.26 1.86 11.61 11.61 0 0 0  11.61-11.76c0-.18 0-.36 0-.53a8.35 8.35 0 0 0 2-2.14 8.11 8.11 0 0 1-2.28.64z" transform="translate(-.15 -.82)"/></svg>'},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var o=r(5),i=n(o),a=r(4);(0,a.onDocumentLoad)(function(){Array.from(document.querySelectorAll('.mol-factbox[data-version="2"]')).map(function(e){return new i.default(e)})})}])});(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function isCallable(_ref){var cb=_ref.cb;var _ref$throwError=_ref.throwError;var throwError=_ref$throwError===undefined?false:_ref$throwError;var cbType=typeof cb==="undefined"?"undefined":_typeof(cb);if(cbType!=="function"){if(throwError){throw new Error('onDocumentLoad: expected function, but received "'+cbType+'"')}return false}return true}module.exports=isCallable},{}],2:[function(require,module,exports){"use strict";var isCallable=require("./isCallable");function removableListener(cb){isCallable({cb:cb,throwError:true});return{isRemoved:false,remove:function remove(){this.isRemoved=true;cb()}}}module.exports=removableListener},{"./isCallable":1}],3:[function(require,module,exports){"use strict";var isCallable=require("../common/isCallable");var removableListener=require("../common/removableListener");function onDocumentLoad(cb){isCallable({cb:cb,throwError:true});function eventHandler(){if(_removableListener.isRemoved){return}_removableListener.remove();cb()}var documentEventValues=["DOMContentLoaded",eventHandler];var windowEventValues=["load",eventHandler];var _removableListener=removableListener(function(){var _document,_window;(_document=document).removeEventListener.apply(_document,documentEventValues);(_window=window).removeEventListener.apply(_window,windowEventValues)});if(document.attachEvent?document.readyState==="complete":document.readyState!=="loading"){eventHandler()}else{var _document2,_window2;(_document2=document).addEventListener.apply(_document2,documentEventValues);(_window2=window).addEventListener.apply(_window2,windowEventValues)}return _removableListener}module.exports=onDocumentLoad},{"../common/isCallable":1,"../common/removableListener":2}],4:[function(require,module,exports){(function(window,document,exportName,undefined){"use strict";var VENDOR_PREFIXES=["","webkit","Moz","MS","ms","o"];var TEST_ELEMENT=document.createElement("div");var TYPE_FUNCTION="function";var round=Math.round;var abs=Math.abs;var now=Date.now;function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout)}function invokeArrayArg(arg,fn,context){if(Array.isArray(arg)){each(arg,context[fn],context);return true}return false}function each(obj,iterator,context){var i;if(!obj){return}if(obj.forEach){obj.forEach(iterator,context)}else if(obj.length!==undefined){i=0;while(i<obj.length){iterator.call(context,obj[i],i,obj);i++}}else{for(i in obj){obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}}}function deprecate(method,name,message){var deprecationMessage="DEPRECATED METHOD: "+name+"\n"+message+" AT \n";return function(){var e=new Error("get-stack-trace");var stack=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace";var log=window.console&&(window.console.warn||window.console.log);if(log){log.call(window.console,deprecationMessage,stack)}return method.apply(this,arguments)}}var assign;if(typeof Object.assign!=="function"){assign=function assign(target){if(target===undefined||target===null){throw new TypeError("Cannot convert undefined or null to object")}var output=Object(target);for(var index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&source!==null){for(var nextKey in source){if(source.hasOwnProperty(nextKey)){output[nextKey]=source[nextKey]}}}}return output}}else{assign=Object.assign}var extend=deprecate(function extend(dest,src,merge){var keys=Object.keys(src);var i=0;while(i<keys.length){if(!merge||merge&&dest[keys[i]]===undefined){dest[keys[i]]=src[keys[i]]}i++}return dest},"extend","Use `assign`.");var merge=deprecate(function merge(dest,src){return extend(dest,src,true)},"merge","Use `assign`.");function inherit(child,base,properties){var baseP=base.prototype,childP;childP=child.prototype=Object.create(baseP);childP.constructor=child;childP._super=baseP;if(properties){assign(childP,properties)}}function bindFn(fn,context){return function boundFn(){return fn.apply(context,arguments)}}function boolOrFn(val,args){if(typeof val==TYPE_FUNCTION){return val.apply(args?args[0]||undefined:undefined,args)}return val}function ifUndefined(val1,val2){return val1===undefined?val2:val1}function addEventListeners(target,types,handler){each(splitStr(types),function(type){target.addEventListener(type,handler,false)})}function removeEventListeners(target,types,handler){each(splitStr(types),function(type){target.removeEventListener(type,handler,false)})}function hasParent(node,parent){while(node){if(node==parent){return true}node=node.parentNode}return false}function inStr(str,find){return str.indexOf(find)>-1}function splitStr(str){return str.trim().split(/\s+/g)}function inArray(src,find,findByKey){if(src.indexOf&&!findByKey){return src.indexOf(find)}else{var i=0;while(i<src.length){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find){return i}i++}return-1}}function toArray(obj){
return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){var results=[];var values=[];var i=0;while(i<src.length){var val=key?src[i][key]:src[i];if(inArray(values,val)<0){results.push(src[i])}values[i]=val;i++}if(sort){if(!key){results=results.sort()}else{results=results.sort(function sortUniqueArray(a,b){return a[key]>b[key]})}}return results}function prefixed(obj,property){var prefix,prop;var camelProp=property[0].toUpperCase()+property.slice(1);var i=0;while(i<VENDOR_PREFIXES.length){prefix=VENDOR_PREFIXES[i];prop=prefix?prefix+camelProp:property;if(prop in obj){return prop}i++}return undefined}var _uniqueId=1;function uniqueId(){return _uniqueId++}function getWindowForElement(element){var doc=element.ownerDocument||element;return doc.defaultView||doc.parentWindow||window}var MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i;var SUPPORT_TOUCH="ontouchstart"in window;var SUPPORT_POINTER_EVENTS=prefixed(window,"PointerEvent")!==undefined;var SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&MOBILE_REGEX.test(navigator.userAgent);var INPUT_TYPE_TOUCH="touch";var INPUT_TYPE_PEN="pen";var INPUT_TYPE_MOUSE="mouse";var INPUT_TYPE_KINECT="kinect";var COMPUTE_INTERVAL=25;var INPUT_START=1;var INPUT_MOVE=2;var INPUT_END=4;var INPUT_CANCEL=8;var DIRECTION_NONE=1;var DIRECTION_LEFT=2;var DIRECTION_RIGHT=4;var DIRECTION_UP=8;var DIRECTION_DOWN=16;var DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT;var DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN;var DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL;var PROPS_XY=["x","y"];var PROPS_CLIENT_XY=["clientX","clientY"];function Input(manager,callback){var self=this;this.manager=manager;this.callback=callback;this.element=manager.element;this.target=manager.options.inputTarget;this.domHandler=function(ev){if(boolOrFn(manager.options.enable,[manager])){self.handler(ev)}};this.init()}Input.prototype={handler:function(){},init:function(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler);this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler);this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler);this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler);this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)}};function createInputInstance(manager){var Type;var inputClass=manager.options.inputClass;if(inputClass){Type=inputClass}else if(SUPPORT_POINTER_EVENTS){Type=PointerEventInput}else if(SUPPORT_ONLY_TOUCH){Type=TouchInput}else if(!SUPPORT_TOUCH){Type=MouseInput}else{Type=TouchMouseInput}return new Type(manager,inputHandler)}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length;var changedPointersLen=input.changedPointers.length;var isFirst=eventType&INPUT_START&&pointersLen-changedPointersLen===0;var isFinal=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen===0;input.isFirst=!!isFirst;input.isFinal=!!isFinal;if(isFirst){manager.session={}}input.eventType=eventType;computeInputData(manager,input);manager.emit("hammer.input",input);manager.recognize(input);manager.session.prevInput=input}function computeInputData(manager,input){var session=manager.session;var pointers=input.pointers;var pointersLength=pointers.length;if(!session.firstInput){session.firstInput=simpleCloneInputData(input)}if(pointersLength>1&&!session.firstMultiple){session.firstMultiple=simpleCloneInputData(input)}else if(pointersLength===1){session.firstMultiple=false}var firstInput=session.firstInput;var firstMultiple=session.firstMultiple;var offsetCenter=firstMultiple?firstMultiple.center:firstInput.center;var center=input.center=getCenter(pointers);input.timeStamp=now();input.deltaTime=input.timeStamp-firstInput.timeStamp;input.angle=getAngle(offsetCenter,center);input.distance=getDistance(offsetCenter,center);computeDeltaXY(session,input);input.offsetDirection=getDirection(input.deltaX,input.deltaY);var overallVelocity=getVelocity(input.deltaTime,input.deltaX,input.deltaY);input.overallVelocityX=overallVelocity.x;input.overallVelocityY=overallVelocity.y;input.overallVelocity=abs(overallVelocity.x)>abs(overallVelocity.y)?overallVelocity.x:overallVelocity.y;input.scale=firstMultiple?getScale(firstMultiple.pointers,pointers):1;input.rotation=firstMultiple?getRotation(firstMultiple.pointers,pointers):0;input.maxPointers=!session.prevInput?input.pointers.length:input.pointers.length>session.prevInput.maxPointers?input.pointers.length:session.prevInput.maxPointers;computeIntervalInputData(session,input);var target=manager.element;if(hasParent(input.srcEvent.target,target)){target=input.srcEvent.target}input.target=target}function computeDeltaXY(session,input){var center=input.center;var offset=session.offsetDelta||{};var prevDelta=session.prevDelta||{};var prevInput=session.prevInput||{};if(input.eventType===INPUT_START||prevInput.eventType===INPUT_END){prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0};offset=session.offsetDelta={x:center.x,y:center.y}}input.deltaX=prevDelta.x+(center.x-offset.x);input.deltaY=prevDelta.y+(center.y-offset.y)}function computeIntervalInputData(session,input){var last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp,velocity,velocityX,velocityY,direction;if(input.eventType!=INPUT_CANCEL&&(deltaTime>COMPUTE_INTERVAL||last.velocity===undefined)){var deltaX=input.deltaX-last.deltaX;var deltaY=input.deltaY-last.deltaY;var v=getVelocity(deltaTime,deltaX,deltaY);velocityX=v.x;velocityY=v.y;velocity=abs(v.x)>abs(v.y)?v.x:v.y;direction=getDirection(deltaX,deltaY);session.lastInterval=input}else{velocity=last.velocity;velocityX=last.velocityX;velocityY=last.velocityY;direction=last.direction}input.velocity=velocity;input.velocityX=velocityX;input.velocityY=velocityY;input.direction=direction}function simpleCloneInputData(input){var pointers=[];var i=0;while(i<input.pointers.length){pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)};i++}return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getCenter(pointers){var pointersLength=pointers.length;if(pointersLength===1){return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)}}var x=0,y=0,i=0;while(i<pointersLength){x+=pointers[i].clientX;y+=pointers[i].clientY;i++}return{x:round(x/pointersLength),y:round(y/pointersLength)}}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function getDirection(x,y){if(x===y){return DIRECTION_NONE}if(abs(x)>=abs(y)){return x<0?DIRECTION_LEFT:DIRECTION_RIGHT}return y<0?DIRECTION_UP:DIRECTION_DOWN}function getDistance(p1,p2,props){if(!props){props=PROPS_XY}var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y)}function getAngle(p1,p2,props){if(!props){props=PROPS_XY}var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.atan2(y,x)*180/Math.PI}function getRotation(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)+getAngle(start[1],start[0],PROPS_CLIENT_XY)}function getScale(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY)}var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:INPUT_MOVE,mouseup:INPUT_END};var MOUSE_ELEMENT_EVENTS="mousedown";var MOUSE_WINDOW_EVENTS="mousemove mouseup";function MouseInput(){this.evEl=MOUSE_ELEMENT_EVENTS;this.evWin=MOUSE_WINDOW_EVENTS;this.pressed=false;Input.apply(this,arguments)}inherit(MouseInput,Input,{handler:function MEhandler(ev){var eventType=MOUSE_INPUT_MAP[ev.type];if(eventType&INPUT_START&&ev.button===0){this.pressed=true}if(eventType&INPUT_MOVE&&ev.which!==1){eventType=INPUT_END}if(!this.pressed){return}if(eventType&INPUT_END){this.pressed=false}this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:INPUT_TYPE_MOUSE,srcEvent:ev})}});var POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:INPUT_MOVE,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL};var IE10_POINTER_TYPE_ENUM={2:INPUT_TYPE_TOUCH,3:INPUT_TYPE_PEN,4:INPUT_TYPE_MOUSE,5:INPUT_TYPE_KINECT};var POINTER_ELEMENT_EVENTS="pointerdown";var POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";if(window.MSPointerEvent&&!window.PointerEvent){POINTER_ELEMENT_EVENTS="MSPointerDown";POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel"}function PointerEventInput(){this.evEl=POINTER_ELEMENT_EVENTS;this.evWin=POINTER_WINDOW_EVENTS;Input.apply(this,arguments);this.store=this.manager.session.pointerEvents=[]}inherit(PointerEventInput,Input,{handler:function PEhandler(ev){var store=this.store;var removePointer=false;var eventTypeNormalized=ev.type.toLowerCase().replace("ms","");var eventType=POINTER_INPUT_MAP[eventTypeNormalized];var pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType;var isTouch=pointerType==INPUT_TYPE_TOUCH;var storeIndex=inArray(store,ev.pointerId,"pointerId");if(eventType&INPUT_START&&(ev.button===0||isTouch)){if(storeIndex<0){store.push(ev);storeIndex=store.length-1}}else if(eventType&(INPUT_END|INPUT_CANCEL)){removePointer=true}if(storeIndex<0){return}store[storeIndex]=ev;this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev});if(removePointer){store.splice(storeIndex,1)}}});var SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL};var SINGLE_TOUCH_TARGET_EVENTS="touchstart";var SINGLE_TOUCH_WINDOW_EVENTS="touchstart touchmove touchend touchcancel";function SingleTouchInput(){this.evTarget=SINGLE_TOUCH_TARGET_EVENTS;this.evWin=SINGLE_TOUCH_WINDOW_EVENTS;this.started=false;Input.apply(this,arguments)}inherit(SingleTouchInput,Input,{handler:function TEhandler(ev){var type=SINGLE_TOUCH_INPUT_MAP[ev.type];if(type===INPUT_START){this.started=true}if(!this.started){return}var touches=normalizeSingleTouches.call(this,ev,type);if(type&(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length===0){this.started=false}this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}});function normalizeSingleTouches(ev,type){var all=toArray(ev.touches);var changed=toArray(ev.changedTouches);if(type&(INPUT_END|INPUT_CANCEL)){all=uniqueArray(all.concat(changed),"identifier",true)}return[all,changed]}var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL};var TOUCH_TARGET_EVENTS="touchstart touchmove touchend touchcancel";function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS;this.targetIds={};Input.apply(this,arguments)}inherit(TouchInput,Input,{handler:function MTEhandler(ev){var type=TOUCH_INPUT_MAP[ev.type];var touches=getTouches.call(this,ev,type);if(!touches){return}this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}});function getTouches(ev,type){var allTouches=toArray(ev.touches);var targetIds=this.targetIds;if(type&(INPUT_START|INPUT_MOVE)&&allTouches.length===1){targetIds[allTouches[0].identifier]=true;return[allTouches,allTouches]}var i,targetTouches,changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;targetTouches=allTouches.filter(function(touch){return hasParent(touch.target,target)});if(type===INPUT_START){i=0;while(i<targetTouches.length){targetIds[targetTouches[i].identifier]=true;i++}}i=0;while(i<changedTouches.length){if(targetIds[changedTouches[i].identifier]){changedTargetTouches.push(changedTouches[i])}if(type&(INPUT_END|INPUT_CANCEL)){delete targetIds[changedTouches[i].identifier]}i++}if(!changedTargetTouches.length){return}return[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",true),changedTargetTouches]}var DEDUP_TIMEOUT=2500;var DEDUP_DISTANCE=25;function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler);this.mouse=new MouseInput(this.manager,handler);this.primaryTouch=null;this.lastTouches=[]}inherit(TouchMouseInput,Input,{handler:function TMEhandler(manager,inputEvent,inputData){var isTouch=inputData.pointerType==INPUT_TYPE_TOUCH,isMouse=inputData.pointerType==INPUT_TYPE_MOUSE;if(isMouse&&inputData.sourceCapabilities&&inputData.sourceCapabilities.firesTouchEvents){return}if(isTouch){recordTouches.call(this,inputEvent,inputData)}else if(isMouse&&isSyntheticEvent.call(this,inputData)){return}this.callback(manager,inputEvent,inputData)},destroy:function destroy(){this.touch.destroy();this.mouse.destroy()}});function recordTouches(eventType,eventData){if(eventType&INPUT_START){this.primaryTouch=eventData.changedPointers[0].identifier;setLastTouch.call(this,eventData)}else if(eventType&(INPUT_END|INPUT_CANCEL)){setLastTouch.call(this,eventData)}}function setLastTouch(eventData){var touch=eventData.changedPointers[0];if(touch.identifier===this.primaryTouch){var lastTouch={x:touch.clientX,y:touch.clientY};this.lastTouches.push(lastTouch);var lts=this.lastTouches;var removeLastTouch=function(){var i=lts.indexOf(lastTouch);if(i>-1){lts.splice(i,1)}};setTimeout(removeLastTouch,DEDUP_TIMEOUT)}}function isSyntheticEvent(eventData){var x=eventData.srcEvent.clientX,y=eventData.srcEvent.clientY;for(var i=0;i<this.lastTouches.length;i++){var t=this.lastTouches[i];var dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(dx<=DEDUP_DISTANCE&&dy<=DEDUP_DISTANCE){return true}}return false}var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction");var NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined;var TOUCH_ACTION_COMPUTE="compute";var TOUCH_ACTION_AUTO="auto";var TOUCH_ACTION_MANIPULATION="manipulation";var TOUCH_ACTION_NONE="none";var TOUCH_ACTION_PAN_X="pan-x";var TOUCH_ACTION_PAN_Y="pan-y";var TOUCH_ACTION_MAP=getTouchActionProps();function TouchAction(manager,value){this.manager=manager;this.set(value)}TouchAction.prototype={set:function(value){if(value==TOUCH_ACTION_COMPUTE){value=this.compute()}if(NATIVE_TOUCH_ACTION&&this.manager.element.style&&TOUCH_ACTION_MAP[value]){this.manager.element.style[PREFIXED_TOUCH_ACTION]=value}this.actions=value.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var actions=[];each(this.manager.recognizers,function(recognizer){if(boolOrFn(recognizer.options.enable,[recognizer])){actions=actions.concat(recognizer.getTouchAction())}});return cleanTouchActions(actions.join(" "))},preventDefaults:function(input){var srcEvent=input.srcEvent;var direction=input.offsetDirection;if(this.manager.session.prevented){srcEvent.preventDefault();return}var actions=this.actions;var hasNone=inStr(actions,TOUCH_ACTION_NONE)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_NONE];var hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y];var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];if(hasNone){var isTapPointer=input.pointers.length===1;var isTapMovement=input.distance<2;var isTapTouchTime=input.deltaTime<250;if(isTapPointer&&isTapMovement&&isTapTouchTime){return}}if(hasPanX&&hasPanY){return}if(hasNone||hasPanY&&direction&DIRECTION_HORIZONTAL||hasPanX&&direction&DIRECTION_VERTICAL){return this.preventSrc(srcEvent)}},preventSrc:function(srcEvent){this.manager.session.prevented=true;srcEvent.preventDefault()}};function cleanTouchActions(actions){if(inStr(actions,TOUCH_ACTION_NONE)){return TOUCH_ACTION_NONE}var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X);var hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);if(hasPanX&&hasPanY){return TOUCH_ACTION_NONE}if(hasPanX||hasPanY){return hasPanX?TOUCH_ACTION_PAN_X:TOUCH_ACTION_PAN_Y}if(inStr(actions,TOUCH_ACTION_MANIPULATION)){return TOUCH_ACTION_MANIPULATION}return TOUCH_ACTION_AUTO}function getTouchActionProps(){if(!NATIVE_TOUCH_ACTION){return false}var touchMap={};var cssSupports=window.CSS&&window.CSS.supports;["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(val){touchMap[val]=cssSupports?window.CSS.supports("touch-action",val):true});return touchMap}var STATE_POSSIBLE=1;var STATE_BEGAN=2;var STATE_CHANGED=4;var STATE_ENDED=8;var STATE_RECOGNIZED=STATE_ENDED;var STATE_CANCELLED=16;var STATE_FAILED=32;function Recognizer(options){this.options=assign({},this.defaults,options||{});this.id=uniqueId();this.manager=null;this.options.enable=ifUndefined(this.options.enable,true);this.state=STATE_POSSIBLE;this.simultaneous={};this.requireFail=[]}Recognizer.prototype={defaults:{},set:function(options){assign(this.options,options);this.manager&&this.manager.touchAction.update();return this},recognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"recognizeWith",this)){return this}var simultaneous=this.simultaneous;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);if(!simultaneous[otherRecognizer.id]){simultaneous[otherRecognizer.id]=otherRecognizer;otherRecognizer.recognizeWith(this)}return this},dropRecognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRecognizeWith",this)){return this}otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);delete this.simultaneous[otherRecognizer.id];return this},requireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this)){return this}var requireFail=this.requireFail;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);if(inArray(requireFail,otherRecognizer)===-1){requireFail.push(otherRecognizer);otherRecognizer.requireFailure(this)}return this},dropRequireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this)){return this}otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);if(index>-1){this.requireFail.splice(index,1)}return this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]},emit:function(input){var self=this;var state=this.state;function emit(event){self.manager.emit(event,input)}if(state<STATE_ENDED){emit(self.options.event+stateStr(state))}emit(self.options.event);if(input.additionalEvent){emit(input.additionalEvent)}if(state>=STATE_ENDED){emit(self.options.event+stateStr(state))}},tryEmit:function(input){if(this.canEmit()){return this.emit(input)}this.state=STATE_FAILED},canEmit:function(){var i=0;while(i<this.requireFail.length){if(!(this.requireFail[i].state&(STATE_FAILED|STATE_POSSIBLE))){return false}i++}return true},recognize:function(inputData){var inputDataClone=assign({},inputData);if(!boolOrFn(this.options.enable,[this,inputDataClone])){this.reset();this.state=STATE_FAILED;return}if(this.state&(STATE_RECOGNIZED|STATE_CANCELLED|STATE_FAILED)){this.state=STATE_POSSIBLE}this.state=this.process(inputDataClone);if(this.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED|STATE_CANCELLED)){this.tryEmit(inputDataClone)}},process:function(inputData){},getTouchAction:function(){},reset:function(){}};function stateStr(state){if(state&STATE_CANCELLED){return"cancel"}else if(state&STATE_ENDED){return"end"}else if(state&STATE_CHANGED){return"move"}else if(state&STATE_BEGAN){return"start"}return""}function directionStr(direction){if(direction==DIRECTION_DOWN){return"down"}else if(direction==DIRECTION_UP){return"up"}else if(direction==DIRECTION_LEFT){return"left"}else if(direction==DIRECTION_RIGHT){return"right"}return""}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;if(manager){return manager.get(otherRecognizer)}return otherRecognizer}function AttrRecognizer(){Recognizer.apply(this,arguments)}inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function(input){var optionPointers=this.options.pointers;return optionPointers===0||input.pointers.length===optionPointers},process:function(input){var state=this.state;var eventType=input.eventType;var isRecognized=state&(STATE_BEGAN|STATE_CHANGED);var isValid=this.attrTest(input);if(isRecognized&&(eventType&INPUT_CANCEL||!isValid)){return state|STATE_CANCELLED}else if(isRecognized||isValid){if(eventType&INPUT_END){return state|STATE_ENDED}else if(!(state&STATE_BEGAN)){return STATE_BEGAN}return state|STATE_CHANGED}return STATE_FAILED}});function PanRecognizer(){AttrRecognizer.apply(this,arguments);this.pX=null;this.pY=null}inherit(PanRecognizer,AttrRecognizer,{defaults:{event:"pan",threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function(){var direction=this.options.direction;var actions=[];if(direction&DIRECTION_HORIZONTAL){actions.push(TOUCH_ACTION_PAN_Y)}if(direction&DIRECTION_VERTICAL){actions.push(TOUCH_ACTION_PAN_X)}return actions},directionTest:function(input){var options=this.options;var hasMoved=true;var distance=input.distance;var direction=input.direction;var x=input.deltaX;var y=input.deltaY;if(!(direction&options.direction)){if(options.direction&DIRECTION_HORIZONTAL){direction=x===0?DIRECTION_NONE:x<0?DIRECTION_LEFT:DIRECTION_RIGHT;hasMoved=x!=this.pX;distance=Math.abs(input.deltaX)}else{direction=y===0?DIRECTION_NONE:y<0?DIRECTION_UP:DIRECTION_DOWN;hasMoved=y!=this.pY;distance=Math.abs(input.deltaY)}}input.direction=direction;return hasMoved&&distance>options.threshold&&direction&options.direction},attrTest:function(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(this.state&STATE_BEGAN||!(this.state&STATE_BEGAN)&&this.directionTest(input))},emit:function(input){this.pX=input.deltaX;this.pY=input.deltaY;var direction=directionStr(input.direction);if(direction){input.additionalEvent=this.options.event+direction}this._super.emit.call(this,input)}});function PinchRecognizer(){AttrRecognizer.apply(this,arguments)}inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||this.state&STATE_BEGAN)},emit:function(input){if(input.scale!==1){var inOut=input.scale<1?"in":"out";input.additionalEvent=this.options.event+inOut}this._super.emit.call(this,input)}});function PressRecognizer(){Recognizer.apply(this,arguments);this._timer=null;this._input=null}inherit(PressRecognizer,Recognizer,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[TOUCH_ACTION_AUTO]},process:function(input){var options=this.options;var validPointers=input.pointers.length===options.pointers;var validMovement=input.distance<options.threshold;var validTime=input.deltaTime>options.time;this._input=input;if(!validMovement||!validPointers||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime){this.reset()}else if(input.eventType&INPUT_START){this.reset();this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED;this.tryEmit()},options.time,this)}else if(input.eventType&INPUT_END){return STATE_RECOGNIZED}return STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(input){if(this.state!==STATE_RECOGNIZED){return}if(input&&input.eventType&INPUT_END){this.manager.emit(this.options.event+"up",input)}else{this._input.timeStamp=now();this.manager.emit(this.options.event,this._input)}}});function RotateRecognizer(){AttrRecognizer.apply(this,arguments)}inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||this.state&STATE_BEGAN)}});function SwipeRecognizer(){AttrRecognizer.apply(this,arguments)}inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function(){return PanRecognizer.prototype.getTouchAction.call(this)},attrTest:function(input){var direction=this.options.direction;var velocity;if(direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL)){velocity=input.overallVelocity}else if(direction&DIRECTION_HORIZONTAL){velocity=input.overallVelocityX}else if(direction&DIRECTION_VERTICAL){velocity=input.overallVelocityY}return this._super.attrTest.call(this,input)&&direction&input.offsetDirection&&input.distance>this.options.threshold&&input.maxPointers==this.options.pointers&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END},emit:function(input){var direction=directionStr(input.offsetDirection);if(direction){this.manager.emit(this.options.event+direction,input)}this.manager.emit(this.options.event,input)}});function TapRecognizer(){Recognizer.apply(this,arguments);this.pTime=false;this.pCenter=false;this._timer=null;this._input=null;this.count=0}inherit(TapRecognizer,Recognizer,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[TOUCH_ACTION_MANIPULATION]},process:function(input){var options=this.options;var validPointers=input.pointers.length===options.pointers;var validMovement=input.distance<options.threshold;var validTouchTime=input.deltaTime<options.time;this.reset();if(input.eventType&INPUT_START&&this.count===0){return this.failTimeout()}if(validMovement&&validTouchTime&&validPointers){if(input.eventType!=INPUT_END){return this.failTimeout()}var validInterval=this.pTime?input.timeStamp-this.pTime<options.interval:true;var validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;this.pTime=input.timeStamp;this.pCenter=input.center;if(!validMultiTap||!validInterval){this.count=1}else{this.count+=1}this._input=input;var tapCount=this.count%options.taps;if(tapCount===0){if(!this.hasRequireFailures()){return STATE_RECOGNIZED}else{this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED;this.tryEmit()},options.interval,this);return STATE_BEGAN}}}return STATE_FAILED},failTimeout:function(){this._timer=setTimeoutContext(function(){this.state=STATE_FAILED},this.options.interval,this);return STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(){if(this.state==STATE_RECOGNIZED){this._input.tapCount=this.count;this.manager.emit(this.options.event,this._input)}}});function Hammer(element,options){options=options||{};options.recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset);return new Manager(element,options)}Hammer.VERSION="2.0.7";Hammer.defaults={domEvents:false,touchAction:TOUCH_ACTION_COMPUTE,enable:true,inputTarget:null,inputClass:null,preset:[[RotateRecognizer,{enable:false}],[PinchRecognizer,{enable:false},["rotate"]],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var STOP=1;var FORCED_STOP=2;function Manager(element,options){this.options=assign({},Hammer.defaults,options||{});this.options.inputTarget=this.options.inputTarget||element;this.handlers={};this.session={};this.recognizers=[];this.oldCssProps={};this.element=element;this.input=createInputInstance(this);this.touchAction=new TouchAction(this,this.options.touchAction);toggleCssProps(this,true);each(this.options.recognizers,function(item){var recognizer=this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]);item[3]&&recognizer.requireFailure(item[3])},this)}Manager.prototype={set:function(options){assign(this.options,options);if(options.touchAction){this.touchAction.update()}if(options.inputTarget){this.input.destroy();this.input.target=options.inputTarget;this.input.init()}return this},stop:function(force){this.session.stopped=force?FORCED_STOP:STOP},recognize:function(inputData){var session=this.session;if(session.stopped){return}this.touchAction.preventDefaults(inputData);var recognizer;var recognizers=this.recognizers;var curRecognizer=session.curRecognizer;if(!curRecognizer||curRecognizer&&curRecognizer.state&STATE_RECOGNIZED){curRecognizer=session.curRecognizer=null}var i=0;while(i<recognizers.length){recognizer=recognizers[i];if(session.stopped!==FORCED_STOP&&(!curRecognizer||recognizer==curRecognizer||recognizer.canRecognizeWith(curRecognizer))){recognizer.recognize(inputData)}else{recognizer.reset()}if(!curRecognizer&&recognizer.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED)){curRecognizer=session.curRecognizer=recognizer}i++}},get:function(recognizer){if(recognizer instanceof Recognizer){return recognizer}var recognizers=this.recognizers;for(var i=0;i<recognizers.length;i++){if(recognizers[i].options.event==recognizer){return recognizers[i]}}return null},add:function(recognizer){if(invokeArrayArg(recognizer,"add",this)){return this}var existing=this.get(recognizer.options.event);if(existing){this.remove(existing)}this.recognizers.push(recognizer);recognizer.manager=this;this.touchAction.update();return recognizer},remove:function(recognizer){if(invokeArrayArg(recognizer,"remove",this)){return this}recognizer=this.get(recognizer);if(recognizer){var recognizers=this.recognizers;var index=inArray(recognizers,recognizer);if(index!==-1){recognizers.splice(index,1);this.touchAction.update()}}return this},on:function(events,handler){if(events===undefined){return}if(handler===undefined){return}var handlers=this.handlers;each(splitStr(events),function(event){handlers[event]=handlers[event]||[];handlers[event].push(handler)});return this},off:function(events,handler){if(events===undefined){return}var handlers=this.handlers;each(splitStr(events),function(event){if(!handler){delete handlers[event]}else{handlers[event]&&handlers[event].splice(inArray(handlers[event],handler),1)}});return this},emit:function(event,data){if(this.options.domEvents){triggerDomEvent(event,data)}var handlers=this.handlers[event]&&this.handlers[event].slice();if(!handlers||!handlers.length){return}data.type=event;data.preventDefault=function(){data.srcEvent.preventDefault()};var i=0;while(i<handlers.length){handlers[i](data);i++}},destroy:function(){this.element&&toggleCssProps(this,false);this.handlers={};this.session={};this.input.destroy();this.element=null}};function toggleCssProps(manager,add){var element=manager.element;if(!element.style){return}var prop;each(manager.options.cssProps,function(value,name){prop=prefixed(element.style,name);if(add){manager.oldCssProps[prop]=element.style[prop];element.style[prop]=value}else{element.style[prop]=manager.oldCssProps[prop]||""}});if(!add){manager.oldCssProps={}}}function triggerDomEvent(event,data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,true,true);gestureEvent.gesture=data;data.target.dispatchEvent(gestureEvent)}assign(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:INPUT_MOVE,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:STATE_BEGAN,STATE_CHANGED:STATE_CHANGED,STATE_ENDED:STATE_ENDED,STATE_RECOGNIZED:STATE_RECOGNIZED,STATE_CANCELLED:STATE_CANCELLED,STATE_FAILED:STATE_FAILED,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,
extend:extend,assign:assign,inherit:inherit,bindFn:bindFn,prefixed:prefixed});var freeGlobal=typeof window!=="undefined"?window:typeof self!=="undefined"?self:{};freeGlobal.Hammer=Hammer;if(typeof define==="function"&&define.amd){define(function(){return Hammer})}else if(typeof module!="undefined"&&module.exports){module.exports=Hammer}else{window[exportName]=Hammer}})(window,document,"Hammer")},{}],5:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var truncateElementInnerText=require("./utils/truncateElementInnerText");var selectorPrefix="mol-fe-rotator";var currentRotatorIndex=0;function truncateDescriptionInElements(items){for(var i=0,length=items.length;i<length;i++){var item=items[i].getElementsByClassName("description")[0];item&&truncateElementInnerText(item)}}var MolFeRotator=function(){function MolFeRotator(el){_classCallCheck(this,MolFeRotator);this.element=el;this.panels=this.element.getElementsByClassName("panels")[0];if(!this.panels){throw new Error("Incompatible html version for rotator")}if(!this.element.id){this.element.id=selectorPrefix+"-instance-"+ ++currentRotatorIndex}this.items=this.panels.children}_createClass(MolFeRotator,[{key:"init",value:function init(){truncateDescriptionInElements(this.items);return true}}]);return MolFeRotator}();module.exports=MolFeRotator},{"./utils/truncateElementInnerText":13}],6:[function(require,module,exports){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&((typeof call==="undefined"?"undefined":_typeof(call))==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof(superClass)))}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var MolFeRotator=require("./MolFeRotator");var _Hammer=window.Hammer;var Hammer=require("hammerjs");window.Hammer=_Hammer;var _require=require("./utils/dom");var onOrientationChange=_require.onOrientationChange;var createStyle=_require.createStyle;var elementOnTapOrClick=_require.elementOnTapOrClick;var _require2=require("./utils/position");var positionElements=_require2.positionElements;var config=require("./config");function getPageCss(){var selector=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var page=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var value=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";return selector+" .panels.page-"+page+" { left: "+value+" }"}var MolFeRotatorMobile=function(_MolFeRotator){_inherits(MolFeRotatorMobile,_MolFeRotator);function MolFeRotatorMobile(el){_classCallCheck(this,MolFeRotatorMobile);var _this=_possibleConstructorReturn(this,(MolFeRotatorMobile.__proto__||Object.getPrototypeOf(MolFeRotatorMobile)).call(this,el));_this.curPage=1;_this.originalItems=Object.keys(_this.items).map(function(index){return _this.items[index]});_this.itemsCount=_this.items.length;_this.colsCount=Math.ceil(_this.itemsCount/config.rowsCount);_this.nextButton=_this.element.getElementsByClassName("next")[0];_this.pageCounterElement=_this.element.getElementsByClassName("page-counter")[0];return _this}_createClass(MolFeRotatorMobile,[{key:"reloadIsAllowed",value:function reloadIsAllowed(){return this.element.clientWidth>0}},{key:"init",value:function init(){var _this2=this;if(!this.reloadIsAllowed())return false;_get(MolFeRotatorMobile.prototype.__proto__||Object.getPrototypeOf(MolFeRotatorMobile.prototype),"init",this).call(this);this.initPagesVars().initPagesStyles().initPagesNavigation().reArrangeItems().setCurrentPage(1);onOrientationChange(function(){if(!_this2.reloadIsAllowed())return;_this2.initPagesVars().initPagesStyles().reArrangeItems().setCurrentPage(1)});return true}},{key:"initPagesVars",value:function initPagesVars(){this.colWidth=this.panels.children[0].clientWidth;this.maxColsInPage=parseInt((this.element.clientWidth-config.nextButtonOverflow)/this.colWidth);this.colsInPage=Math.min(config.maxColumnsScroll,this.maxColsInPage);this.pageWidth=this.colsInPage*this.colWidth;this.pagesCount=1;if(this.colsCount>this.maxColsInPage){this.pagesCount+=Math.ceil((this.colsCount-this.maxColsInPage)/this.colsInPage);this.nextButton.style.display="block"}else{this.nextButton.style.display="none"}return this}},{key:"reArrangeItems",value:function reArrangeItems(){positionElements(this.originalItems,this.colsCount,this.colsInPage,config.rowsCount);return this}},{key:"setCurrentPage",value:function setCurrentPage(){var nextPage=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.curPage;if(nextPage>this.pagesCount){nextPage=1}if(this.curPage!==nextPage){this.panels.className=this.panels.className.replace(" page-"+this.curPage,"")+" page-"+nextPage;this.curPage=nextPage}if(this.curPage>this.pagesCount){this.curPage=this.pagesCount}var className=this.nextButton.className;if(this.curPage===this.pagesCount&&!/\s*reverse\s*/.test(this.nextButton.className)){this.nextButton.className+=" reverse"}else if(/reverse/.test(className)){this.nextButton.className=className.replace(/\s*reverse/,"")}this.pageCounterElement.innerText=this.pagesCount===1&&this.curPage===1?"":this.curPage+"/"+this.pagesCount;return this}},{key:"initPagesNavigation",value:function initPagesNavigation(){this._initTap();this._initSwipe();return this}},{key:"initPagesStyles",value:function initPagesStyles(){var selector="#"+this.element.id;var elementClientWidth=this.element.clientWidth;var ds=this.pageWidth>0?this.pageWidth:1;var widthToGo=this.panels.clientWidth;var page=1;var loop=true;var cssText="";while(loop){++page;widthToGo-=ds;if(widthToGo<elementClientWidth){widthToGo=elementClientWidth;loop=false}cssText+=getPageCss(selector,page,widthToGo-this.panels.clientWidth+"px")}if(!this.styleElement){this.styleElement=createStyle()}this.styleElement.innerText=cssText;return this}},{key:"_initTap",value:function _initTap(){var _this3=this;elementOnTapOrClick(this.element,function(e){if(e.target===_this3.nextButton){e.preventDefault();_this3.setCurrentPage(_this3.curPage+1)}})}},{key:"_initSwipe",value:function _initSwipe(){var _this4=this;var hammer=new Hammer.Manager(this.element);hammer.add(new Hammer.Swipe({direction:Hammer.DIRECTION_HORIZONTAL}));hammer.on("swipeleft",function(e){e.preventDefault();if(_this4.curPage<_this4.pagesCount){_this4.setCurrentPage(_this4.curPage+1)}});hammer.on("swiperight",function(e){e.preventDefault();if(_this4.curPage>1){_this4.setCurrentPage(_this4.curPage-1)}})}}]);return MolFeRotatorMobile}(MolFeRotator);module.exports=MolFeRotatorMobile},{"./MolFeRotator":5,"./config":7,"./utils/dom":10,"./utils/position":12,hammerjs:4}],7:[function(require,module,exports){"use strict";module.exports={rowsCount:2,maxColumnsScroll:2,nextButtonOverflow:15}},{}],8:[function(require,module,exports){"use strict";var _require=require("./utils/dom");var onDocumentLoad=_require.onDocumentLoad;var MolFeRotator=require("./MolFeRotator");var MolFeRotatorMobile=require("./MolFeRotatorMobile");function initRotatorAfterReady(rotator){!rotator.init()&&setTimeout(function(){return initRotatorAfterReady(rotator)},1e3)}function isMobile(){return window.PageCriteria&&window.PageCriteria.isMobile}onDocumentLoad(function(){var _isMobile=isMobile();var elements=document.querySelectorAll("[data-mol-fe-rotator]");for(var i=0;i<elements.length;i++){var element=elements[i];try{var rotator=_isMobile?new MolFeRotatorMobile(element):new MolFeRotator(element);initRotatorAfterReady(rotator)}catch(e){}}})},{"./MolFeRotator":5,"./MolFeRotatorMobile":6,"./utils/dom":10}],9:[function(require,module,exports){"use strict";function isCallable(fn){return typeof fn==="function"}module.exports={isCallable:isCallable}},{}],10:[function(require,module,exports){"use strict";var onDocumentLoad=require("@mol-fe/mol-fe-client-utils/src/dom/onDocumentLoad");var _require=require("./common");var isCallable=_require.isCallable;var onOrientationChange=require("./onOrientationChange");function getDocumentElement(tag){return document[tag]||document.getElementsByTagName(tag)[0]}function createStyle(){var styleElement=document.createElement("style");styleElement.type="text/css";getDocumentElement("head").appendChild(styleElement);return styleElement}function elementOnTapOrClick(el,cb){if(isCallable(cb)){el.addEventListener("mouseup",cb,false);el.addEventListener("touchend",cb,false)}}function elementInsertAfter(newChild,refChild){return refChild.parentNode.insertBefore(newChild,refChild.nextSibling)}module.exports={onDocumentLoad:onDocumentLoad,onOrientationChange:onOrientationChange,getDocumentElement:getDocumentElement,createStyle:createStyle,elementOnTapOrClick:elementOnTapOrClick,elementInsertAfter:elementInsertAfter}},{"./common":9,"./onOrientationChange":11,"@mol-fe/mol-fe-client-utils/src/dom/onDocumentLoad":3}],11:[function(require,module,exports){"use strict";var _require=require("./common");var isCallable=_require.isCallable;var orientationEvent="onorientationchange"in window?"orientationchange":"resize";var maxTimeout=1e3;var intervalDelay=100;var noChangeCountToEnd=3;function onOrientationChange(cb){if(!isCallable(cb))return;var running=false;var intervalId=void 0;var timeoutId=void 0;var lastInnerWidth=void 0;var lastInnerHeight=void 0;var noChangeCount=void 0;function done(event){clearInterval(intervalId);clearTimeout(timeoutId);if(event){intervalId=null;timeoutId=null;cb(event)}}window.addEventListener(orientationEvent,function(event){if(running){done()}else{running=true}intervalId=setInterval(function(){if(window.innerWidth===lastInnerWidth&&window.innerHeight===lastInnerHeight){noChangeCount++;if(noChangeCount===noChangeCountToEnd){done(event)}}else{lastInnerWidth=window.innerWidth;lastInnerHeight=window.innerHeight;noChangeCount=0}},intervalDelay);timeoutId=setTimeout(function(){done(event)},maxTimeout)})}module.exports=onOrientationChange},{"./common":9}],12:[function(require,module,exports){"use strict";var _require=require("./dom");var elementInsertAfter=_require.elementInsertAfter;function createPositionMap(elements,colsCount,colsInPage,rowsCount){var map=[];var pageBlocksCount=Math.ceil(colsCount/colsInPage);var colsShift=(colsInPage-colsCount%colsInPage)%colsInPage;for(var page=0;page<pageBlocksCount;page++){for(var row=0;row<rowsCount;row++){for(var column=0;column<colsInPage;column++){if(page*colsInPage+column>=colsCount)continue;var targetPos=page*colsInPage+colsCount*row+column;var fromPos=page*colsInPage*rowsCount+row*colsInPage+column;if(page==pageBlocksCount-1){fromPos-=colsShift*row}if(elements[fromPos]){map[targetPos]=elements[fromPos]}}}}return map}function syncPositions(map){var pos=1;var length=map.length;for(;pos<length;pos++){if(!map[pos])continue;var prevElement=map[pos-1];elementInsertAfter(map[pos],prevElement)}}function positionElements(elements,colsCount,colsInPage,rowsCount){syncPositions(createPositionMap(elements,colsCount,colsInPage,rowsCount))}module.exports={createPositionMap:createPositionMap,syncPositions:syncPositions,positionElements:positionElements}},{"./dom":10}],13:[function(require,module,exports){"use strict";var DEFAULT_TAIL_CHARS="...";function createContainer(element){var container=document.createElement("div");container.style.position="fixed";container.style.background="green";container.style.top="-1000px";container.style.left="-1000px";container.style.height=element.clientHeight+"px";container.style.width=element.clientWidth+"px";return container}function createContainerDiv(container){var div=document.createElement("div");div.style.width="100%";container.appendChild(div);return div}function truncateElementInnerText(element,exact){var tailChars=arguments.length>2&&arguments[2]!==undefined?arguments[2]:DEFAULT_TAIL_CHARS;var elementOverflow=element.style.overflow;var height=element.clientHeight;var container=createContainer(element);var div=createContainerDiv(container);div.innerText=element.innerText;setUpElement();if(div.clientHeight>height){var biggerText=div.innerText;var right=biggerText.length;var left=0;var diff=void 0;var counter=0;do{++counter;diff=right-left>>1;div.innerText=biggerText.substr(0,left+diff)+tailChars;if(div.clientHeight>height)right-=diff;else left+=diff}while(diff>0&&counter<20);var finalText=div.innerText;resetElement();if(!exact){finalText=finalText.split(" ");finalText.pop();finalText[finalText.length-1]+=tailChars;finalText=finalText.join(" ")}element.innerText=finalText}else{resetElement()}function setUpElement(){element.style.overflow="hidden";element.appendChild(container)}function resetElement(){element.removeChild(container);element.style.overflow=elementOverflow}}module.exports=truncateElementInnerText},{}]},{},[8]);(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function isCallable(_ref){var cb=_ref.cb,_ref$throwError=_ref.throwError,throwError=_ref$throwError===undefined?false:_ref$throwError;var cbType=typeof cb==="undefined"?"undefined":_typeof(cb);if(cbType!=="function"){if(throwError){throw new Error('onDocumentLoad: expected function, but received "'+cbType+'"')}return false}return true}module.exports=isCallable},{}],2:[function(require,module,exports){"use strict";var isCallable=require("./isCallable");function removableListener(cb){isCallable({cb:cb,throwError:true});return{isRemoved:false,remove:function remove(){this.isRemoved=true;cb()}}}module.exports=removableListener},{"./isCallable":1}],3:[function(require,module,exports){"use strict";var isCallable=require("../common/isCallable");var removableListener=require("../common/removableListener");function onDocumentLoad(cb){isCallable({cb:cb,throwError:true});function eventHandler(){if(_removableListener.isRemoved){return}_removableListener.remove();cb()}var documentEventValues=["DOMContentLoaded",eventHandler];var windowEventValues=["load",eventHandler];var _removableListener=removableListener(function(){var _document,_window;(_document=document).removeEventListener.apply(_document,documentEventValues);(_window=window).removeEventListener.apply(_window,windowEventValues)});if(document.attachEvent?document.readyState==="complete":document.readyState!=="loading"){eventHandler()}else{var _document2,_window2;(_document2=document).addEventListener.apply(_document2,documentEventValues);(_window2=window).addEventListener.apply(_window2,windowEventValues)}return _removableListener}module.exports=onDocumentLoad},{"../common/isCallable":1,"../common/removableListener":2}],4:[function(require,module,exports){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&((typeof call==="undefined"?"undefined":_typeof(call))==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof(superClass)))}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _require=require("./utils"),nodeListToArray=_require.nodeListToArray;var VideoPreviewBase=require("./base/VideoPreviewBase");function createVideoElement(videoSrc,poster){var styles=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var video=document.createElement("video");if(poster){video.poster=poster}video.loop=true;video.innerHTML='<source src="'+videoSrc+'" type="video/mp4"/>';Object.assign(video.style,styles);return video}var VideoPreview=function(_VideoPreviewBase){_inherits(VideoPreview,_VideoPreviewBase);function VideoPreview(){_classCallCheck(this,VideoPreview);return _possibleConstructorReturn(this,(VideoPreview.__proto__||Object.getPrototypeOf(VideoPreview)).apply(this,arguments))}_createClass(VideoPreview,[{key:"_init",value:function _init(){var _this2=this;if(this.element.tagName.toLowerCase()==="video"){this.element.loop=true;var sources=this.element.getElementsByTagName("source");nodeListToArray(sources).forEach(function(source){var srcUrl=source.getAttribute("data-src");if(srcUrl){var newSource=document.createElement("source");newSource.src=srcUrl;newSource.type=source.type;_this2.element.replaceChild(newSource,source)}})}else{var videoSrc=this.element.getAttribute("data-video");if(!videoSrc)return;var posterImg=this.element.getAttribute("data-poster")||this.element.src;this._registerMainElement(createVideoElement(videoSrc,posterImg,{width:this.element.clientWidth+"px",height:this.element.clientHeight+"px"}))}this.initDone=true}},{key:"_play",value:function _play(){_get(VideoPreview.prototype.__proto__||Object.getPrototypeOf(VideoPreview.prototype),"_play",this).call(this);this.element&&this.element.play&&this.element.play()}},{key:"_pause",value:function _pause(){_get(VideoPreview.prototype.__proto__||Object.getPrototypeOf(VideoPreview.prototype),"_pause",this).call(this);this.element&&this.element.pause&&this.element.pause()}}]);return VideoPreview}(VideoPreviewBase);module.exports=VideoPreview},{"./base/VideoPreviewBase":8,"./utils":14}],5:[function(require,module,exports){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&((typeof call==="undefined"?"undefined":_typeof(call))==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof(superClass)))}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var VideoPreviewBase=require("./base/VideoPreviewBase");var VideoPreviewImgSimplePlay=require("./VideoPreviewImgSimplePlay");var VideoPreviewImgFadePlay=require("./VideoPreviewImgFadePlay");var _require=require("./utils"),waitForElementToLoad=_require.waitForElementToLoad,calcPaddingStyles=_require.calcPaddingStyles;var VideoPreviewImg=function(_VideoPreviewBase){_inherits(VideoPreviewImg,_VideoPreviewBase);function VideoPreviewImg(el,quality){_classCallCheck(this,VideoPreviewImg);var _this=_possibleConstructorReturn(this,(VideoPreviewImg.__proto__||Object.getPrototypeOf(VideoPreviewImg)).call(this,el));var attrPrefix=quality?quality+"-":"";_this.filmSrc=_this._getDataAttribute(attrPrefix+"film");if(!_this.filmSrc){throw new Error("Could not init VideoPreviewImg: data attribute "+attrPrefix+"film must not be empty")}_this.fps=parseFloat(_this._getDataAttribute("fps",quality))||5;_this.frameCount=parseInt(_this._getDataAttribute("frame-count",quality),10);_this.frameWidth=parseInt(_this._getDataAttribute("frame-width",quality),10);_this.frameHeight=parseInt(_this._getDataAttribute("frame-height",quality),10);_this.frameRatio=_this.frameWidth/_this.frameHeight;if(_this._hasDataAttribute(attrPrefix+"fade")){_this.playbackManager=new VideoPreviewImgFadePlay(_this)}else{_this.playbackManager=new VideoPreviewImgSimplePlay(_this)}return _this}_createClass(VideoPreviewImg,[{key:"_getDataAttribute",value:function _getDataAttribute(attr,prefix){var finalPrefix=prefix?"-"+prefix:"";return this.element.getAttribute("data"+finalPrefix+"-"+attr)||prefix&&this.element.getAttribute("data-"+attr)}},{key:"_hasDataAttribute",value:function _hasDataAttribute(attr,prefix){var finalPrefix=prefix?"-"+prefix:"";return this.element.hasAttribute("data"+finalPrefix+"-"+attr)||prefix&&this.element.hasAttribute("data-"+attr)}},{key:"fixElement",value:function fixElement(){var element=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.element;_get(VideoPreviewImg.prototype.__proto__||Object.getPrototypeOf(VideoPreviewImg.prototype),"fixElement",this).call(this,element);Object.assign(element.style,calcPaddingStyles(this.originalElement,this.frameRatio));return this}},{key:"_createFilmElement",value:function _createFilmElement(){if(this.filmElement)return this.filmElement;if(!this.filmSrc)return;this.filmElement=new Image;this.filmElement.src=this.filmSrc;return this.filmElement}},{key:"_init",value:function _init(){var _this2=this;return this._createFilmElement()&&waitForElementToLoad(this.filmElement).then(function(){var container=VideoPreviewImg.createFramesContainer();_this2.fixElement(container);_this2._registerMainElement(container);_this2.playbackManager.init();_this2.initDone=true}).catch(function(err){_this2.synchIsAllowed=false;throw err})}},{key:"_play",value:function _play(){_get(VideoPreviewImg.prototype.__proto__||Object.getPrototypeOf(VideoPreviewImg.prototype),"_play",this).call(this);this.playbackManager.play()}},{key:"_pause",value:function _pause(){_get(VideoPreviewImg.prototype.__proto__||Object.getPrototypeOf(VideoPreviewImg.prototype),"_pause",this).call(this);this.playbackManager.pause()}}],[{key:"createFramesContainer",value:function createFramesContainer(){var container=document.createElement("div");container.className="frames-container";return container}}]);return VideoPreviewImg}(VideoPreviewBase);module.exports=VideoPreviewImg},{"./VideoPreviewImgFadePlay":6,"./VideoPreviewImgSimplePlay":7,"./base/VideoPreviewBase":8,"./utils":14}],6:[function(require,module,exports){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&((typeof call==="undefined"?"undefined":_typeof(call))==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof(superClass)))}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var VideoPreviewImgPlayBase=require("./base/VideoPreviewImgPlayBase");var VideoPreviewImgFadePlay=function(_VideoPreviewImgPlayB){_inherits(VideoPreviewImgFadePlay,_VideoPreviewImgPlayB);function VideoPreviewImgFadePlay(videoPreviewImg){_classCallCheck(this,VideoPreviewImgFadePlay);var _this=_possibleConstructorReturn(this,(VideoPreviewImgFadePlay.__proto__||Object.getPrototypeOf(VideoPreviewImgFadePlay)).call(this,videoPreviewImg));var dataFade=parseFloat(_this.videoPreviewImg.element.getAttribute("data-fade"));_this.fadeDuration=dataFade||1/_this.videoPreviewImg.fps;_this._frameHoldersCount=3;_this.fadeTiming=_this.videoPreviewImg.element.getAttribute("data-fade-timing")||"ease-in-out";return _this}_createClass(VideoPreviewImgFadePlay,[{key:"_createFrameHolder",value:function _createFrameHolder(){var frameHolder=_get(VideoPreviewImgFadePlay.prototype.__proto__||Object.getPrototypeOf(VideoPreviewImgFadePlay.prototype),"_createFrameHolder",this).call(this);Object.assign(frameHolder.style,{"transition-duration":this.fadeDuration+"s","transition-timing-function":this.fadeTiming});return frameHolder}},{key:"nextFrame",value:function nextFrame(frameNum){_get(VideoPreviewImgFadePlay.prototype.__proto__||Object.getPrototypeOf(VideoPreviewImgFadePlay.prototype),"nextFrame",this).call(this,frameNum);this._frameHolders.push(this._frameHolders.shift());this._frameHolders[0].className=this.frameHolderClassName;this._frameHolders[1].className=this.frameHolderClassName+" frame-holder-current";this.setFrameHolderNext(this._frameHolders[2])}}]);return VideoPreviewImgFadePlay}(VideoPreviewImgPlayBase);module.exports=VideoPreviewImgFadePlay},{"./base/VideoPreviewImgPlayBase":9}],7:[function(require,module,exports){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined;
}else{return get(parent,property,receiver)}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&((typeof call==="undefined"?"undefined":_typeof(call))==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof(superClass)))}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var VideoPreviewImgPlayBase=require("./base/VideoPreviewImgPlayBase");var VideoPreviewImgSimplePlay=function(_VideoPreviewImgPlayB){_inherits(VideoPreviewImgSimplePlay,_VideoPreviewImgPlayB);function VideoPreviewImgSimplePlay(videoPreviewImg){_classCallCheck(this,VideoPreviewImgSimplePlay);var _this=_possibleConstructorReturn(this,(VideoPreviewImgSimplePlay.__proto__||Object.getPrototypeOf(VideoPreviewImgSimplePlay)).call(this,videoPreviewImg));_this._frameHoldersCount=1;return _this}_createClass(VideoPreviewImgSimplePlay,[{key:"nextFrame",value:function nextFrame(frameNum){_get(VideoPreviewImgSimplePlay.prototype.__proto__||Object.getPrototypeOf(VideoPreviewImgSimplePlay.prototype),"nextFrame",this).call(this,frameNum);this.setFrameHolderNext(this._frameHolders[0])}}]);return VideoPreviewImgSimplePlay}(VideoPreviewImgPlayBase);module.exports=VideoPreviewImgSimplePlay},{"./base/VideoPreviewImgPlayBase":9}],8:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _require=require("../utils"),elementIsVisibleInViewPort=_require.elementIsVisibleInViewPort,waitForElementToLoad=_require.waitForElementToLoad,calcPositionStyles=_require.calcPositionStyles;var _require2=require("../config"),elementAttribute=_require2.elementAttribute;var VideoPreviewBase=function(){function VideoPreviewBase(el){_classCallCheck(this,VideoPreviewBase);this.element=el;this.originalElement=el;this.initDone=false;this.synchPromise=null;this.synchIsAllowed=true;this.hasNewSize=true;this.showOriginalOnPause=false}_createClass(VideoPreviewBase,[{key:"isInViewPort",value:function isInViewPort(){return elementIsVisibleInViewPort(this.getActiveElement())}},{key:"setOriginalElementActive",value:function setOriginalElementActive(){if(this.getActiveElement()!==this.originalElement){this.showOriginalElement().hideElement()}}},{key:"setMainElementActive",value:function setMainElementActive(){if(this.getActiveElement()!==this.element){this.showElement().hideOriginalElement()}}},{key:"getActiveElement",value:function getActiveElement(){return this.originalElement.style.display!=="none"?this.originalElement:this.element}},{key:"synch",value:function synch(){var _this=this;if(this.synchPromise){return this.synchPromise}this.synchPromise=waitForElementToLoad(this.element).catch(function(){}).then(function(){if(!_this.synchIsAllowed){throw new Error("Synch is not allowed")}if(_this.hasNewSize){_this.setOriginalElementActive()}var activeElement=_this.getActiveElement();if(activeElement.clientHeight>1&&activeElement.clientWidth>1&&_this.isInViewPort()){return Promise.resolve(_this.initDone?null:_this._init()).then(function(){if(_this.initDone){_this.hasNewSize&&_this.fixElement();return _this._play()}return _this._pause()}).catch(function(){})}return _this._pause()}).then(this._resetSynchPromise.bind(this)).catch(this._resetSynchPromise.bind(this));return Promise.resolve(this.synchPromise)}},{key:"synchResize",value:function synchResize(){this.hasNewSize=true;return this.synch()}},{key:"fixElement",value:function fixElement(){var element=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.element;if(this.element===this.originalElement){return this}Object.assign(element.style,calcPositionStyles(this.originalElement));this.hasNewSize=false;return this}},{key:"_resetSynchPromise",value:function _resetSynchPromise(){if(this.synchIsAllowed){this.synchPromise=null}}},{key:"_registerMainElement",value:function _registerMainElement(){var newElement=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.deRegisteredElement;this.hideElement(newElement);newElement.setAttribute(elementAttribute,this.element.getAttribute(elementAttribute)||"");this.element.parentNode&&this.element.parentNode.replaceChild(newElement,this.element);this.originalElement=this.element;this.element=newElement;this.element.parentNode&&this.element.parentNode.insertBefore(this.originalElement,this.element)}},{key:"_deRegisterMainElement",value:function _deRegisterMainElement(){if(this.element!==this.originalElement){this.deRegisteredElement=this.element;this.showOriginalElement();this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=this.originalElement}}},{key:"hideElement",value:function hideElement(){var element=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.element;element&&element.style&&element.style.display!=="none"&&(element.style.display="none");return this}},{key:"showElement",value:function showElement(){var element=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.element;element&&element.style&&element.style.display!==""&&(element.style.display="");return this}},{key:"hideOriginalElement",value:function hideOriginalElement(){return this.hideElement(this.originalElement)}},{key:"showOriginalElement",value:function showOriginalElement(){return this.showElement(this.originalElement)}},{key:"_init",value:function _init(){}},{key:"_play",value:function _play(){this.setMainElementActive()}},{key:"_pause",value:function _pause(){if(this.showOriginalOnPause){this.setOriginalElementActive()}}}]);return VideoPreviewBase}();module.exports=VideoPreviewBase},{"../config":10,"../utils":14}],9:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _require=require("../utils"),nodeListToArray=_require.nodeListToArray;var _require2=require("../config"),playbackFw=_require2.playbackFw;var VideoPreviewImgPlayBase=function(){function VideoPreviewImgPlayBase(videoPreviewImg){_classCallCheck(this,VideoPreviewImgPlayBase);this.videoPreviewImg=videoPreviewImg;this.nextFrameDelay=parseInt(1e3/(this.videoPreviewImg.fps*playbackFw),10);this.frameHolderClassName="frame-holder";this.isPlaying=false;this.curFrame=0;this.initDone=false;this._frameHolders=[];this._frameHoldersCount=1;this.animationStart=null;this.animationStartFrame=null}_createClass(VideoPreviewImgPlayBase,[{key:"_createFrameHolder",value:function _createFrameHolder(){var el=document.createElement("div");el.className=this.frameHolderClassName+" frame-holder-current";el.style["background-image"]='url("'+this.videoPreviewImg.filmSrc+'")';el.style["background-size"]=this.framesPerRow*100+"% "+this.framesRows*100+"%";return el}},{key:"_createFrameHolders",value:function _createFrameHolders(){var _this=this;this._calcFrameGridParams();if(!this.frameHoldersElement){this.frameHoldersElement=document.createElement("div");this.frameHoldersElement.className="frame-holders";this.videoPreviewImg.element.appendChild(this.frameHoldersElement)}else{nodeListToArray(this.frameHoldersElement.children).forEach(function(el){_this.frameHoldersElement.removeChild(el)})}this._frameHolders=[];for(var i=0;i<this._frameHoldersCount||0;i++){var frameHolder=this._createFrameHolder();this.frameHoldersElement.appendChild(frameHolder);this._frameHolders.push(frameHolder)}}},{key:"_calcFrameGridParams",value:function _calcFrameGridParams(){var filmWidth=this.videoPreviewImg.filmElement.naturalWidth;this.framesPerRow=filmWidth/this.videoPreviewImg.frameWidth>>0;this.framesRows=this.videoPreviewImg.filmElement.naturalHeight/this.videoPreviewImg.frameHeight>>0}},{key:"getCurFrameBackgroundPosition",value:function getCurFrameBackgroundPosition(){var column=this.curFrame%this.framesPerRow;var row=this.curFrame/this.framesPerRow>>0;return"-"+column*100+"% -"+row*100+"%"}},{key:"nextFrame",value:function nextFrame(){var frameNum=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.curFrame+1;this.curFrame=frameNum%this.videoPreviewImg.frameCount}},{key:"setFrameHolderNext",value:function setFrameHolderNext(frameHolder){frameHolder.className=this.frameHolderClassName+" frame-holder-next";frameHolder.style["background-position"]=this.getCurFrameBackgroundPosition()}},{key:"init",value:function init(){if(this.initDone){return}this.initDone=true;this._createFrameHolders()}},{key:"play",value:function play(){if(this.isPlaying||!this.initDone)return;this.isPlaying=true;this.nextFrame();this.continueAnimation()}},{key:"continueAnimation",value:function continueAnimation(){var _this2=this;this.animationRequestId=window.requestAnimationFrame(function(timestamp){var frameCount=_this2.videoPreviewImg.frameCount;if(_this2.animationStart===null){_this2.animationStart=timestamp}if(_this2.animationStartFrame===null){_this2.animationStartFrame=(_this2.curFrame-(_this2.curFrame-1)%frameCount)%frameCount}var nextFrame=(timestamp-_this2.animationStart)/_this2.nextFrameDelay+_this2.animationStartFrame>>0;if(nextFrame>=frameCount){_this2.animationStart=timestamp;_this2.animationStartFrame=nextFrame=0}if(_this2.animationStart===timestamp||nextFrame-_this2.curFrame>0){_this2.nextFrame(nextFrame)}_this2.isPlaying&&_this2.continueAnimation()})}},{key:"stopAnimation",value:function stopAnimation(){window.cancelAnimationFrame(this.animationRequestId);this.animationStart=null;this.animationStartFrame=this.curFrame}},{key:"pause",value:function pause(){this.isPlaying=false;this.stopAnimation()}}]);return VideoPreviewImgPlayBase}();module.exports=VideoPreviewImgPlayBase},{"../config":10,"../utils":14}],10:[function(require,module,exports){"use strict";module.exports={elementAttribute:"data-mol-fe-video-preview",playbackFw:1}},{}],11:[function(require,module,exports){"use strict";var _require=require("./config"),elementAttribute=_require.elementAttribute;var _require2=require("./utils"),onDocumentLoad=_require2.onDocumentLoad,nodeListToArray=_require2.nodeListToArray;var videoPreviewRegister=require("./videoPreviewRegister");function loadAllVideoPreviews(){onDocumentLoad(function(){videoPreviewRegister.addElements(nodeListToArray(document.querySelectorAll("["+elementAttribute+"]")))})}loadAllVideoPreviews();module.exports=loadAllVideoPreviews},{"./config":10,"./utils":14,"./videoPreviewRegister":18}],12:[function(require,module,exports){"use strict";function calcPositionStyles(originalElement){var elementComputedStyle=document.defaultView.getComputedStyle(originalElement,"");var styles={width:originalElement.clientWidth+"px",height:originalElement.clientHeight+"px",left:elementComputedStyle.right==="0px"?"":elementComputedStyle.left,right:elementComputedStyle.left==="0px"?"":elementComputedStyle.right,top:elementComputedStyle.bottom==="0px"?"":elementComputedStyle.top,bottom:elementComputedStyle.top==="0px"?"":elementComputedStyle.bottom,margin:elementComputedStyle.margin,"float":elementComputedStyle.float,position:elementComputedStyle.position!=="static"?elementComputedStyle.position:""};if(!elementComputedStyle.display||elementComputedStyle.display==="inline"){styles.display="inline-block"}else{styles.display=elementComputedStyle.display}return styles}function calcPaddingStyles(originalElement,frameRatio){var width=originalElement.clientWidth;var height=originalElement.clientHeight;var ratio=width/height;var left=0,top=0;if(ratio>frameRatio){left=width-height*frameRatio>>1}else{top=height-width/frameRatio>>1}return{padding:top+"px "+left+"px"}}module.exports={calcPositionStyles:calcPositionStyles,calcPaddingStyles:calcPaddingStyles}},{}],13:[function(require,module,exports){"use strict";function elementIsVisibleInViewPort(element){var windowHeight=window.innerHeight;var windowWidth=window.innerWidth;var dH=Math.max(element.clientHeight,element.clientHeight-windowHeight)>>1;var dW=Math.max(element.clientWidth,element.clientWidth-windowWidth)>>1;var clientRect=element.getBoundingClientRect();var inHorizontal=clientRect.left>-dW&&clientRect.right<windowWidth+dW||clientRect.left<0&&clientRect.right>windowWidth;var inVertical=clientRect.top>-dH&&clientRect.bottom<windowHeight+dH||clientRect.top<0&&clientRect.bottom>windowHeight;return inHorizontal&&inVertical}module.exports=elementIsVisibleInViewPort},{}],14:[function(require,module,exports){"use strict";var onDocumentLoad=require("@mol-fe/mol-fe-client-utils/src/dom/onDocumentLoad");var elementIsVisibleInViewPort=require("./elementIsVisibleInViewPort");var _require=require("./viewport"),onScroll=_require.onScroll,onOrientationChange=_require.onOrientationChange;var _require2=require("./calc"),calcPositionStyles=_require2.calcPositionStyles,calcPaddingStyles=_require2.calcPaddingStyles;function waitForElementToLoad(el){return new Promise(function(resolve){switch(el.tagName.toLowerCase()){case"img":resolve(waitForImg(el));break;case"video":resolve();break;default:resolve()}})}function waitForImg(img){return new Promise(function(resolve,reject){if(!img.src){reject()}else if(img.complete){resolve()}else{img.addEventListener("load",resolve);img.addEventListener("error",reject)}})}function isMobile(){return window.PageCriteria&&window.PageCriteria.isMobile&&!isTablet()}function isTablet(){return window.PageCriteria&&window.PageCriteria.isTablet}function nodeListToArray(nodeList){return[].map.call(nodeList,function(el){return el})}module.exports={elementIsVisibleInViewPort:elementIsVisibleInViewPort,isMobile:isMobile,isTablet:isTablet,onDocumentLoad:onDocumentLoad,onOrientationChange:onOrientationChange,onScroll:onScroll,waitForElementToLoad:waitForElementToLoad,waitForImg:waitForImg,calcPositionStyles:calcPositionStyles,calcPaddingStyles:calcPaddingStyles,nodeListToArray:nodeListToArray}},{"./calc":12,"./elementIsVisibleInViewPort":13,"./viewport":17,"@mol-fe/mol-fe-client-utils/src/dom/onDocumentLoad":3}],15:[function(require,module,exports){"use strict";var maxTimeout=1e3;var intervalDelay=100;var noChangeCountToEnd=3;function onOrientationChange(cb){if(typeof cb!=="function"){return}var intervalId=void 0;var timeoutId=void 0;var lastInnerWidth=void 0;var lastInnerHeight=void 0;var noChangeCount=void 0;function done(event){clearInterval(intervalId);clearTimeout(timeoutId);if(event){intervalId=null;timeoutId=null;cb(event)}}function eventHandler(event){done();intervalId=setInterval(function(){if(window.innerWidth===lastInnerWidth&&window.innerHeight===lastInnerHeight){noChangeCount++;if(noChangeCount===noChangeCountToEnd){done(event)}}else{lastInnerWidth=window.innerWidth;lastInnerHeight=window.innerHeight;noChangeCount=0}},intervalDelay);timeoutId=setTimeout(function(){done(event)},maxTimeout)}window.addEventListener("orientationchange",eventHandler);window.addEventListener("resize",eventHandler);return eventHandler}module.exports=onOrientationChange},{}],16:[function(require,module,exports){"use strict";function onScroll(targets,cb){var delay=arguments.length>2&&arguments[2]!==undefined?arguments[2]:100;if(targets.constructor!==Array){targets=[targets]}var timeoutId=void 0;function eventHandler(){clearTimeout(timeoutId);timeoutId=setTimeout(cb,delay)}targets.forEach(function(target){if(!target||!target.addEventListener){return}target.addEventListener("scroll",eventHandler)});return eventHandler}module.exports=onScroll},{}],17:[function(require,module,exports){"use strict";var onScroll=require("./onScroll");var onOrientationChange=require("./onOrientationChange");function createStoppableListener(stopFunction){return{stop:stopFunction.bind(stopFunction)}}function onScrollStoppable(targets,cb,delay){if(targets.constructor!==Array){targets=[targets]}var eventHandler=onScroll(targets,cb,delay);return createStoppableListener(function(){targets.forEach(function(target){if(!target||!target.removeEventListener){return}target.removeEventListener("scroll",eventHandler)})})}function onOrientationChangeStoppable(cb){var eventHandler=onOrientationChange(cb);return createStoppableListener(function(){window.removeEventListener("orientationchange",eventHandler);window.removeEventListener("resize",eventHandler)})}module.exports={onScroll:onScrollStoppable,onOrientationChange:onOrientationChangeStoppable}},{"./onOrientationChange":15,"./onScroll":16}],18:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _require=require("./utils"),onOrientationChange=_require.onOrientationChange,onScroll=_require.onScroll,onDocumentLoad=_require.onDocumentLoad,isMobile=_require.isMobile,isTablet=_require.isTablet;var VideoPreview=require("./VideoPreview");var VideoPreviewImg=require("./VideoPreviewImg");var VideoPreviewRegister=function(){function VideoPreviewRegister(){_classCallCheck(this,VideoPreviewRegister);this.initOnDocumentLoad=true;this.pool=[];this.parents=[window];this._showOriginalOnPause=false}_createClass(VideoPreviewRegister,[{key:"cleanUp",value:function cleanUp(){this.removeAll();this.pool=[]}},{key:"removeAll",value:function removeAll(){this.pool.forEach(function(videoPreview){videoPreview._deRegisterMainElement()})}},{key:"addElements",value:function addElements(elements){var _this=this;if(!elements){return}var isArray=elements.constructor===Array;if(!isArray){elements=[elements]}var videoPreviews=elements.reduce(function(result,element){var videoPreview=void 0;try{if(isTablet()){if(element.getAttribute("data-hd-film")){videoPreview=new VideoPreviewImg(element,"hd")}}else if(isMobile()){if(element.getAttribute("data-film")){videoPreview=new VideoPreviewImg(element)}}else if(element.getAttribute("data-video")||element.tagName.toLowerCase()==="video"){videoPreview=new VideoPreview(element)}else if(element.getAttribute("data-hd-film")){videoPreview=new VideoPreviewImg(element,"hd")}else if(element.getAttribute("data-film")){videoPreview=new VideoPreviewImg(element)}if(videoPreview){_this.synchVideoPreviewAttrs(videoPreview);videoPreview.synch();result.push(videoPreview)}}catch(err){console.error(err)}return result},[]);this.pool.push.apply(this.pool,videoPreviews);return isArray?videoPreviews:videoPreviews[0]}},{key:"addParent",value:function addParent(parent){parent&&this.parents.indexOf(parent)===-1&&this.parents.push(parent)}},{key:"synchAll",value:function synchAll(){this.pool.forEach(function(videoPreview){return videoPreview.synch()})}},{key:"synchResizeAll",value:function synchResizeAll(){this.pool.forEach(function(videoPreview){return videoPreview.synchResize()})}},{key:"enableListeners",value:function enableListeners(){this.orientationChangeListener=onOrientationChange(this.synchResizeAll.bind(this));this.scrollListener=onScroll(this.parents,this.synchAll.bind(this),50)}},{key:"disableListeners",value:function disableListeners(){this.orientationChangeListener&&this.orientationChangeListener.stop();this.scrollListener&&this.scrollListener.stop()}},{key:"synchVideoPreviewAttrs",value:function synchVideoPreviewAttrs(videoPreview){videoPreview.showOriginalOnPause=this._showOriginalOnPause}},{key:"showOriginalOnPause",set:function set(bool){this._showOriginalOnPause=!!bool;this.pool.forEach(this.synchVideoPreviewAttrs.bind(this))},get:function get(){return this._showOriginalOnPause}}]);return VideoPreviewRegister}();var videoPreviewRegister=new VideoPreviewRegister;onDocumentLoad(function(){if(isMobile()){videoPreviewRegister.showOriginalOnPause=true;videoPreviewRegister.addParent(document.querySelector(".scrollable-content"))}videoPreviewRegister.initOnDocumentLoad&&videoPreviewRegister.enableListeners()});module.exports=videoPreviewRegister},{"./VideoPreview":4,"./VideoPreviewImg":5,"./utils":14}]},{},[11]);DM.later(["bundle","DOM_READY"],function(){if(DM.getPageMetadata&&DM.getPageMetadata().channel==="/tvshowbiz"&&DM.getPageMetadata().isSocialHoneyEnabled){(function(t,h,u,n,d,e,r){t[d]=t[d]||function(){(t[d].q=t[d].q||[]).push(arguments)};e=h.createElement(u);r=h.getElementsByTagName(u)[0];e.async=1;e.src=n;r.parentNode.insertBefore(e,r);t[d]("providence",true);t[d]("create","SH-72958405-1")})(window,document,"script","http://cdn.socialhoney.co/widget/sh-mol.js","sh")}});DM.later.go("bundle");
//# sourceMappingURL=async_bundle--.js.map
