usingNamespace("Biz.Store")["DVD"] = {search: function () {if (!String.isNullOrEmpty(Web.UI.Form.getValue("frmSearchDVD", "DvdDescription"))) {Web.UI.Form.submit("frmSearchDVD");};}};usingNamespace("Biz.Store")["Promotion"] = {popup: function () {jQuery(document).ready(function () {jQuery('.open-popup').click(function () {var $this = jQuery(this),_id = this.id,_content = jQuery('#' + _id + '_Content').html(),$win = jQuery('<div class="centerPopup"><div class="centerPopup-body">' + _content + '</div></div>');jQuery('#bodyArea').append($win);var _left = (jQuery('body').width() - $win.width()) / 2,_top = (jQuery(window).height() - $win.height()) / 2;_top = _top < 0 ? 0 : _top;$win.css({'left': _left,'top': _top});jQuery('#overlay, .centerPopup-close').show().one('click', function () {jQuery('#overlay').hide();$win.remove();});});jQuery("#Expire-Popup").click();});}};NEG.Module("Biz.Store.Personalization2012", function (require) {var jQuery = require("NEG.ThirdParty.JQuery");var storage = require('Biz.Storage');var resourceMananger = require("Biz.UI.ResourceManager");function personalization() {var storeId, storeType, tabStoreId, itemMaintain, displayedItem, tid;if (typeof (storeItemString) != "undefined" && storeItemString != null) {storeId = storeItemString.StoreId;storeType = storeItemString.StoreType;tabStoreId = storeItemString.TabStoreId;itemMaintain = storeItemString.ItemMaintain;tid = storeItemString.Tid;}if (typeof (itemMaintain) != "undefined" && itemMaintain != null) {displayedItem = itemMaintain;} else {displayedItem = '';}if (typeof (tabStoreId) == "undefined" || tabStoreId == null) {tabStoreId = '';}var viewedItem = storage.getItem("ItemViewed", new Array());var shoppingCartItem = Biz.Common.ShoppingItem.extractFromOrderInfo();var wishlistItem = Web.StateManager.Cookies.get("NV_WISHLIST");var orderedItem = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.PRDLIST, "ItemOrdered");var searchKeyword = storage.getItem("ItemSearchKeywords", "");var subCookie = function (source, maxlength, delimiter) {var result = source;if (source) {var sourceArray = source.split(delimiter);if (sourceArray.length > maxlength) {result = sourceArray.slice(0, maxlength).join(delimiter);}}return result;};var getParameters = function () {var viewedItems = viewedItem.join("#");var shoppingCartItems = subCookie(shoppingCartItem, 20, "&");var wishlistItems = subCookie(wishlistItem, 20, "&");var orderedItems = subCookie(orderedItem, 10, ",");var searchKeywords = "";if (searchKeyword) {var keyValue = searchKeyword.split("|");if (keyValue.length >= 2) {searchKeywords = keyValue[1];}}return "v=" + escape(viewedItems) + "&s=" + escape(shoppingCartItems) + "&w=" + escape(wishlistItems) + "&o=" + escape(orderedItems) + "&k=" + escape(searchKeywords);};var getAjaxParameters = function () {return "sid=" + storeId + "&ste=" + storeType + "&tid=" + tid + "&tsid=" + tabStoreId + "&ispreview=" + isPersonalizationEdit + "&di=" + displayedItem + "&" + getParameters();};var api = {getData: function () {var script = document.getElementById("personalizationAjaxJs");if (script) {document.getElementsByTagName('head')[0].removeChild(script);}script = document.createElement("script");script.type = "text/javascript";script.id = 'personalizationAjaxJS';script.src = resourceMananger.Url.www("Common/Ajax/PersonalizationStorePage.aspx") + "?v2=2016&" + getAjaxParameters();document.getElementsByTagName('head')[0].appendChild(script);},renderData: function (pData, v2) {if (pData.length > 0 && v2) {var modules = pData.split("|||###|||");var allModuleData = "";for (var index = 0; index < modules.length; index++) {allModuleData += modules[index];}jQuery("#personalizationContent .loader").remove();jQuery("#personalizationContent").append(allModuleData);Biz.Common.CommonPop.init();Biz.Common.ProcessImage.ironEggReplaceSrc();var perModules = jQuery("a[href*='Product/ProductList.aspx?Submit=Pers']");jQuery.each(perModules, function (index, value) {value.href += "&" + getParameters();});} else {jQuery("#personalizationContent .loader").remove();}jQuery('#personalizationContent .swiper-box').each(function (index, el) {Biz.Common.Swiper.init('#personalizationContent .' + Array.prototype.join.call(el.classList, '.'));});}};return api;}return personalization;});