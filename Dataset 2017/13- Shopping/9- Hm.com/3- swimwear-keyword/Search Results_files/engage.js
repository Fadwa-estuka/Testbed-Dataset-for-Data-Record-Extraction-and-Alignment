(function() {window.psPlugin={bridge:{},core:{connection:{},ui:{}},shell:null,banners:{},themes:{},themeAPI:{},customJS:{},serverConf:{theme:{}}},window.vngage=window.vngage||{};var subUid=-1,topics=window.vngage._subscriptions={};window.vngage.subscribe=function(n,e){var i=(++subUid).toString();return topics[n]||(topics[n]=[]),topics[n].push({token:i,func:e}),i};window.vngage.info = {"version":"2.7.141","revision":114,"created":"Sat, 11 Feb 2017 08:33:14 GMT"}; window.vngage.config = {"configurationSections":[{"data":{"id":"107E6332-739F-43B3-B68A-27BFD76C29EF","name":"Default settings","type":"visitor","siteId":"00000000-0000-0000-0000-000000000000","section":{"defaultSiteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","themeId":"B808D92C-2864-4486-8586-13C3622314E8","transportDomains":[],"blockVisitorDays":1,"dialogQuarantine":15,"doNotAskAgainQuarantine":30,"domCoBrowsing":false,"enableHTTPSCoBrowsing":false,"enablePassiveCoBrowsing":false,"excludePagesFromCoBrowsingStart":["http://tablet.hm.com/us/checkout","https://tablet.hm.com/us/checkout","http://www.hm.com/us/checkout","https://www.hm.com/us/checkout","http://www.hm.com/us/my-hm/pendingshipments","https://www.hm.com/us/my-hm/pendingshipments","http://tablet.hm.com/us/my-hm/pendingshipments","https://tablet.hm.com/us/my-hm/pendingshipments"],"shortQuarantine":0,"useProtocolRelativeUrls":false,"useResponsiveBanners":true,"videoStreamingServer":null,"shortQuatantine":0}}},{"data":{"id":"D9E941F3-76CA-4D3E-A4E6-CD353736D20C","name":"Offered size guide help","type":"solution","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"description":"","isProactive":false,"caseTypeId":"B85A47BE-8680-4F4F-B599-FB6C1232BC36","groupId":"0673451C-76DD-4DC1-88E4-5C52142750B2","messageToCustomerCase":"Seeks size guide support","bannerId":"84CF1EA9-3F36-4E66-AEAF-D24BD71D2C9B","bannerIdGroupBusy":null,"bannerIdGroupClosed":null,"bannerIdGroupOpen":null}}},{"data":{"id":"F54F7143-8E77-4E85-B185-8EE0F1292E80","name":"Offered generic support","type":"solution","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"description":"","isProactive":false,"caseTypeId":"B85A47BE-8680-4F4F-B599-FB6C1232BC36","groupId":"0673451C-76DD-4DC1-88E4-5C52142750B2","messageToCustomerCase":"Generic shopping help","bannerId":"A5500865-C9FA-40FC-B3DA-8DEB2F8E4E85","bannerIdGroupBusy":null,"bannerIdGroupClosed":null,"bannerIdGroupOpen":null}}},{"data":{"id":"D3E517AE-887F-45F4-8718-A71BE3B24AEF","name":"Offered registration support","type":"solution","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"description":"","isProactive":false,"caseTypeId":"2064B7ED-3A6C-417E-9D09-15CB81CEF9E9","groupId":"0673451C-76DD-4DC1-88E4-5C52142750B2","messageToCustomerCase":"Seeks registration support","bannerId":"3B2AF3E6-B963-47E4-BB54-162701A0B7CD","bannerIdGroupBusy":null,"bannerIdGroupClosed":null,"bannerIdGroupOpen":null}}},{"data":{"id":"FF61AF55-BC88-4FD7-BED1-B002D8FEDA2A","name":"Offered login support","type":"solution","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"description":"","isProactive":false,"caseTypeId":"2064B7ED-3A6C-417E-9D09-15CB81CEF9E9","groupId":"0673451C-76DD-4DC1-88E4-5C52142750B2","messageToCustomerCase":"Seeks login support","bannerId":"E9E60BDC-F8C4-4C12-AE1C-2F1120085E3D","bannerIdGroupBusy":null,"bannerIdGroupClosed":null,"bannerIdGroupOpen":null}}},{"data":{"id":"B4EF8D7F-52F3-458A-BC05-F0347321A6BD","name":"Offered update support","type":"solution","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"description":"","isProactive":false,"caseTypeId":"2064B7ED-3A6C-417E-9D09-15CB81CEF9E9","groupId":"0673451C-76DD-4DC1-88E4-5C52142750B2","messageToCustomerCase":"Seeks update support","bannerId":"9E9A2638-1869-4569-BE40-56545B8774DA","bannerIdGroupBusy":null,"bannerIdGroupClosed":null,"bannerIdGroupOpen":null}}},{"data":{"id":"B570BAFF-EA13-4CDE-AC94-2B11AA43B8F0","name":"Browsing site","type":"opportunity","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"description":"","score":0,"position":8,"solutions":["F54F7143-8E77-4E85-B185-8EE0F1292E80"],"condition":{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"contains"},"value":{"type":"static","value":"/us"}},"operator":"","conditions":[]}}}},{"data":{"id":"ED004B8E-81C8-4E9E-A028-DE1DBE2AD018","name":"Browsing Ladies' department","type":"opportunity","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"description":"","score":0,"position":2,"solutions":["F54F7143-8E77-4E85-B185-8EE0F1292E80"],"condition":{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"contains"},"value":{"type":"static","value":"hm.com/us/department/LADIES"}},"operator":"","conditions":[{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"notContain"},"value":{"type":"static","value":"tablet.hm.com"}},"operator":"and"},{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"contains"},"value":{"type":"static","value":"hm.com/us/subdepartment/LADIES"}},"operator":"or"},{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"notContain"},"value":{"type":"static","value":"tablet.hm.com"}},"operator":"and"}]}}}},{"data":{"id":"16991546-133E-4D9B-B7D3-473A9EA6F5E8","name":"Browsing Men's department","type":"opportunity","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"description":"","score":0,"position":3,"solutions":["F54F7143-8E77-4E85-B185-8EE0F1292E80"],"condition":{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"contains"},"value":{"type":"static","value":"hm.com/us/department/MEN"}},"operator":"","conditions":[{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"notContain"},"value":{"type":"static","value":"tablet.hm.com"}},"operator":"and"},{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"contains"},"value":{"type":"static","value":"hm.com/us/subdepartment/MEN"}},"operator":"or"},{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"notContain"},"value":{"type":"static","value":"tablet.hm.com"}},"operator":"and"}]}}}},{"data":{"id":"1DF66D02-4F28-46B7-9E9F-8485A2EE3685","name":"Browsing Kids department","type":"opportunity","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"description":"","score":0,"position":4,"solutions":["F54F7143-8E77-4E85-B185-8EE0F1292E80"],"condition":{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"contains"},"value":{"type":"static","value":"hm.com/us/department/KIDS"}},"operator":"","conditions":[{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"notContain"},"value":{"type":"static","value":"tablet.hm.com"}},"operator":"and"},{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"contains"},"value":{"type":"static","value":"hm.com/us/subdepartment/KIDS"}},"operator":"or"},{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"notContain"},"value":{"type":"static","value":"tablet.hm.com"}},"operator":"and"}]}}}},{"data":{"id":"3430BEDA-0BF6-4507-81AB-5B4D7373641A","name":"Browsing Home department","type":"opportunity","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"description":"","score":0,"position":5,"solutions":["F54F7143-8E77-4E85-B185-8EE0F1292E80"],"condition":{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"contains"},"value":{"type":"static","value":"hm.com/us/department/HOME"}},"operator":"","conditions":[{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"notContain"},"value":{"type":"static","value":"tablet.hm.com"}},"operator":"and"},{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"contains"},"value":{"type":"static","value":"hm.com/us/subdepartment/HOME"}},"operator":"or"},{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"notContain"},"value":{"type":"static","value":"tablet.hm.com"}},"operator":"and"}]}}}},{"data":{"id":"2B687ABE-40E2-4867-9315-B44567137A68","name":"Browsing products on sale","type":"opportunity","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"description":"","score":0,"position":6,"solutions":["F54F7143-8E77-4E85-B185-8EE0F1292E80"],"condition":{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"contains"},"value":{"type":"static","value":"hm.com/us/department/sale"}},"operator":"","conditions":[{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"notContain"},"value":{"type":"static","value":"tablet.hm.com"}},"operator":"and"},{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"contains"},"value":{"type":"static","value":"hm.com/us/subdepartment/sale"}},"operator":"or"},{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"notContain"},"value":{"type":"static","value":"tablet.hm.com"}},"operator":"and"}]}}}},{"data":{"id":"AF2EDFB1-9BC1-4C1C-BF1F-3DE7891B367A","name":"Browsing customer service","type":"opportunity","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"description":"","score":0,"position":7,"solutions":["F54F7143-8E77-4E85-B185-8EE0F1292E80"],"condition":{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"contains"},"value":{"type":"static","value":"hm.com/us/customer-service"}},"operator":"","conditions":[{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"notContain"},"value":{"type":"static","value":"tablet.hm.com"}},"operator":"and"}]}}}},{"data":{"id":"7E37BFF7-2859-4599-BC3C-0DD823752B58","name":"Default Settings","type":"accountSettings","siteId":"00000000-0000-0000-0000-000000000000","section":{"deactivatePhoneToPs":true,"displayCaseHistory":true,"notificationOnProactive":false,"PDFcapture":false,"alwaysMailToThisEmailOnDialogClose":"","chatMessagePendingTimeoutForVisitor":10,"coBrowserNoFollow":["hm.com/us/checkout","hm.com/us/my-hm","hm.com/us/bag"],"enableVideoChat":false,"hideQueue":false,"notificationDuration":0,"notificationOnChatMessages":true,"oldSoundPlayer":false}}},{"data":{"id":"B1157E7D-05F2-4D11-8A3E-680CF3889AC6","name":"Default","type":"bannerTheme","siteId":"00000000-0000-0000-0000-000000000000","section":{"baseTheme":"banners","less":"@bannerResponsive: false;\n@bannerPrimary: #121212;\n@bannerBackground: #fff;\n@borderCol: #dcdcdc;\n@errorCol: #ce2127;\n\n@bannerFontFamily: 'HM Ampersand Regular', Arial, sans-serif;\n@bannerFontFamilyBold: 'HM Ampersand Bold', Arial, sans-serif;\n@bannerH2Size: 1.6em;\n@bannerH2Weight: normal;\n@bannerH3Size: 1.6em;\n@bannerH3Weight: normal;\n@bannerParagraphSize: 1.1em;\n@bannerParagraphLineHeight: 1.25;\n\n@bannerBtnBorderRadius: 0;\n@bannerBtnBorder: 0;\n@bannerBtnFontSize: 1em;\n@bannerBtnLineHeight: 3.4;\n@bannerBtnMargin: 0;\n@bannerBtnBackgroundPrimaryHover: #555;\n@bannerButtonsMargin: 1.6em 0 0;\n\n@tabbannerAgent: false;\n@tabbannerBoxShadow: none;\n@tabbannerBorderColor: @borderCol;\n@tabbannerTop: 35%;\n@tabbannerWidth: 285px;\n@tabbannerHeight: 100px;\n@tabbannerMargin: 0;\n@tabbannerPadding: 2.084em;\n\n@tabbannerTabStyle: 0;\n@tabbannerTabBorderRadius: 0;\n@tabbannerTabBoxShadow: none;\n@tabbannerTabFontSize: 0.84em;\n@tabbannerTabLineHeight: 1.2;\n@tabbannerTabPadding: 1.5em 0.5em 1.2em;\n\n@takeover: false;\n@dooreye: false;\n\n.hmBold() {\n  font-weight: normal;\n  font-family: @bannerFontFamilyBold;\n}\n\n.vngage-banner {\n\n  div {\n    font-size: inherit;\n  }\n\n  .vngage-btn {\n    display: block;\n    .hmBold();\n    width: 100%;\n    margin-top: 1em;\n    text-transform: uppercase;\n    .transition(none) !important;\n  }\n\n  .vngage-disclaimer {\n    font-size: 0.92em;\n    margin: 1.2em 0 0;\n  }\n\n  &.vngage-tabbanner {\n    textarea {\n      display: block;\n      background-color:white !important;\n      .box-sizing(border-box);\n      border: solid 1px @borderCol;\n      border-radius: 0;\n      font-size: 13px;\n      font-family: inherit;\n      width: 100%;\n      height: 76px;\n      margin-top: 1.2em;\n      padding: 0.5em 0.6em;\n      resize: none;\n    }\n\n    .vngage-tab .vngage-tab-text {\n      .hmBold();\n      .transition(background-color 1s);\n    }\n\n    .vngage-content {\n      + .vngage-content {\n        display: none;\n      }\n\n      &.vngage-wider {\n        -moz-box-sizing: border-box;\n        box-sizing: border-box;\n        width: 325px;\n      }\n    }\n\n    &.vngage-error .vngage-tab .vngage-tab-text {\n      background-color: @errorCol;\n    }\n  }\n\n}\n\n// Fix for disappearing caret in inputs for IE9\n.vngage-no-csstransitions .vngage-banner.vngage-tabbanner.vngage-expand {\n  -ms-transform: none;\n  margin-left: -@tabbannerWidth;\n}","css":".vngage-banner{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;font-size:12px;font-family:'HM Ampersand Regular',Arial,sans-serif;line-height:1.1;position:fixed;z-index:10000}.vngage-banner h1{color:#000;font-size:2em;font-weight:bold;font-family:inherit;margin:0 0 .2em;padding:0}.vngage-banner h2{color:#000;font-size:1.6em;font-weight:normal;font-family:inherit;margin:0 0 .3em;padding:0}.vngage-banner h3{color:#000;font-size:1.6em;font-weight:normal;font-family:inherit;margin:0 0 .4em;padding:0}.vngage-banner h4{color:#000;font-size:1.3em;font-weight:bold;font-family:inherit;margin:0 0 .5em;padding:0}.vngage-banner p{font-size:1.1em;line-height:1.25;margin:.4em 0;padding:0}.vngage-banner .vngage-buttons{margin:1.6em 0 0}.vngage-banner .vngage-btn{cursor:pointer;display:inline-block;color:#222;background-color:#fff;border:0;border-color:#000;border-color:rgba(0,0,0,0.3);border-radius:0;font-size:1em;font-weight:bold;font-family:inherit;line-height:3.4;margin:0 0;padding:0 1.2em;text-decoration:none}.vngage-banner .vngage-btn::-moz-focus-inner{border:0;padding:0}.vngage-banner .vngage-btn:hover{color:#222;background-color:#ededed}.vngage-banner .vngage-btn.vngage-primary{color:#fff;background-color:#121212;border-color:#000;border-color:rgba(0,0,0,0.22)}.vngage-banner .vngage-btn.vngage-primary:hover{color:#fff;background-color:#555}.vngage-banner .vngage-icon,.vngage-banner [class^=\"vngage-icon-\"]:before,.vngage-banner [class*=\" vngage-icon-\"]:before{display:inline-block;font-family:\"vngage\";font-style:normal;font-weight:normal;font-variant:normal;width:1em;speak:none;text-align:center;text-transform:none;text-decoration:inherit}.vngage-banner .vngage-icon-ok:before{content:'\\e810'}.vngage-banner .vngage-icon-cancel:before{content:'\\e805'}.vngage-banner.vngage-tabbanner{color:#222;display:table;table-layout:fixed;top:35%;left:100%;width:285px;height:100px;margin:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;-o-transform:none;transform:none;text-align:left}.vngage-banner.vngage-tabbanner.vngage-inactive{-webkit-transform:translateX(70px);-moz-transform:translateX(70px);-ms-transform:translateX(70px);-o-transform:translateX(70px);transform:translateX(70px)}.vngage-banner.vngage-tabbanner.vngage-expand{-webkit-transform:translateX(-100%);-moz-transform:translateX(-100%);-ms-transform:translateX(-100%);-o-transform:translateX(-100%);transform:translateX(-100%)}.vngage-banner.vngage-tabbanner .vngage-tab{cursor:pointer;position:absolute;top:0;left:0;height:0;width:0;z-index:-1}.vngage-banner.vngage-tabbanner .vngage-tab .vngage-tab-text{color:#fff;background-color:#121212;position:absolute;text-transform:uppercase;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;border-radius:0;font-size:.84em;font-weight:bold;line-height:1.2;top:0;right:0;width:60px;padding:1.5em .5em 1.2em;text-align:center}.vngage-banner.vngage-tabbanner .vngage-tab .vngage-tab-text:before{content:'';display:block;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAbCAYAAAD28DaZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAahJREFUeNrMl10rBFEYx88qcrFulChtinKxtd5uKMaF8hLFJxDFnXyIzcfYW8o3UCgXaFFKay5QiguldbEXJktTjv9Tz9EkszN2zTnnX7+2nd2Z59eZM+c8k5JSiphpBRPAAUOgH3SDtsB/XsETuANX4BicgPdYFUgmAgdsA0/WF4/Pd6Jq1fpxEhTl/6bI140tkwYFmWwKXKemTAa4Uk9crvddPxWYwD3glCelrtBkHweP9EXJ0JNyDgaE/pTAKD1xTXwgb0hEcN28GpkMPu9BszAXH/TRyKwaFhFcf4Vk5oUdWaDbREt42gIZj2SkJSMj6DZ9WOLik8ytJTI3JHNoicwBzZkcr4Kmk6ORuQY7hkV2gav2pg6W6jQg8gwGQVntTS9gCVQ1i1S5blk92iq0a0+BikaZGXARXGeCOQMjLKZrgxRhMpQHbng2+fYlmem/vB1Qn7oBSgm1nkdhbWdUsmCO35uGuU39LZ/cRl5yG7sHesEaWPzRrtBW1A7egm1nPWkBXXwxJVHhR9UPOYeWkGUWy/KxWbDfqEyjGQPrPIpbdOBLgAEA+iHZgcwfVMwAAAAASUVORK5CYII=);background-position:center;background-repeat:no-repeat;width:35px;height:27px;margin:0 auto .75em}.vngage-banner.vngage-tabbanner .vngage-content{display:table-cell;background-color:#fff;background-image:none;border:solid 1px #dcdcdc;border-right-width:0;border-radius:0;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;width:100%;padding:2.084em;vertical-align:middle;z-index:1}.vngage-banner.vngage-tabbanner.vngage-expand .vngage-content{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none}.vngage-form{position:relative}.vngage-form .vngage-validity-message{color:#333;background:#fff;border:solid 1px #999;border-radius:3px;box-shadow:0 2px 2px 0 rgba(0,0,0,0.3);font-style:normal;font-family:Verdana,Arial,sans-serif;zoom:1;filter:alpha(opacity=0);-webkit-opacity:0;-moz-opacity:0;opacity:0;visibility:hidden;pointer-events:none;position:absolute;margin:7px 0 0;padding:8px 8px 8px 36px;-webkit-transition:all 0.3s;-moz-transition:all 0.3s;-o-transition:all 0.3s;transition:all 0.3s;-webkit-transform:scale(0.85);-moz-transform:scale(0.85);-ms-transform:scale(0.85);-o-transform:scale(0.85);transform:scale(0.85)}.vngage-form .vngage-validity-message:after,.vngage-form .vngage-validity-message:before{content:'';border:solid 7px transparent;position:absolute;left:10px}.vngage-form .vngage-validity-message:before{border-bottom-color:#fff;top:-14px;z-index:2}.vngage-form .vngage-validity-message:after{border-bottom-color:#999;top:-15px;z-index:1}.vngage-form .vngage-validity-message.vngage-show{zoom:1;filter:alpha(opacity=100);-webkit-opacity:1;-moz-opacity:1;opacity:1;visibility:visible;-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);-o-transform:scale(1);transform:scale(1)}.vngage-form .vngage-validity-message.vngage-offset{margin-left:-17px}.vngage-form .vngage-validity-message p{font-size:12.5px;margin:0}.vngage-form .vngage-validity-message p:before{color:#fff;content:'!';display:block;background:#ea3;border-radius:2px;font-size:16px;font-weight:bold;font-family:monospace;line-height:20px;position:absolute;top:6px;left:7px;width:21px;height:20px;text-align:center}.vngage-form .vngage-validity-message small{display:block;font-size:11.5px;margin:4px 0 0}.vngage-banner .vngage-form fieldset{border:0;padding:0}.vngage-banner .vngage-form select,.vngage-banner .vngage-form .vngage-text{display:block;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:100%;height:auto;padding:6px 8px}.vngage-banner .vngage-form textarea,.vngage-banner .vngage-form textarea.vngage-text{display:block;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:100%;height:70px;margin:0;padding:6px 8px;resize:none}.vngage-banner .vngage-form .vngage-placeholder{color:#bbb}.vngage-banner .vngage-form .vngage-form-row{margin:0.4em 0}.vngage-banner .vngage-form .vngage-form-btn{display:inline-block;margin:.6em 0}.vngage-banner .vngage-form .vngage-form-group{margin-bottom:0.6em}.vngage-banner .vngage-form .vngage-form-group .vngage-label{font-weight:normal}.vngage-banner .vngage-form .vngage-form-group .vngage-label+.vngage-label{margin-left:0}.vngage-csstransitions .vngage-banner .vngage-btn{-webkit-transition:all 0.3s;-moz-transition:all 0.3s;-o-transition:all 0.3s;transition:all 0.3s}.vngage-csstransitions .vngage-banner.vngage-tabbanner{-webkit-transition:all 0.45s;-moz-transition:all 0.45s;-o-transition:all 0.45s;transition:all 0.45s}.vngage-csstransitions .vngage-banner.vngage-tabbanner .vngage-tab-text{-webkit-transition:background-color 0.3s;-moz-transition:background-color 0.3s;-o-transition:background-color 0.3s;transition:background-color 0.3s}.vngage-csstransitions .vngage-banner.vngage-tabbanner .vngage-content{-webkit-transition:all 0.45s;-moz-transition:all 0.45s;-o-transition:all 0.45s;transition:all 0.45s}.vngage-csstransitions .vngage-banner.vngage-takeover{-webkit-transition:all 0.45s cubic-bezier(0.17, 0.67, 0.39, 1);-moz-transition:all 0.45s cubic-bezier(0.17, 0.67, 0.39, 1);-o-transition:all 0.45s cubic-bezier(0.17, 0.67, 0.39, 1);transition:all 0.45s cubic-bezier(0.17, 0.67, 0.39, 1)}.vngage-csstransitions .vngage-banner.vngage-takeover .vngage-btn-close{-webkit-transition:all 0.3s;-moz-transition:all 0.3s;-o-transition:all 0.3s;transition:all 0.3s}.vngage-csstransitions .vngage-banner.vngage-dooreye:after{-webkit-transition:-webkit-box-shadow 0.45s;-moz-transition:-moz-box-shadow 0.45s;-o-transition:box-shadow 0.45s;transition:box-shadow 0.45s}.vngage-csstransitions .vngage-banner.vngage-dooreye:before{-webkit-transition:border-color 0.45s;-moz-transition:border-color 0.45s;-o-transition:border-color 0.45s;transition:border-color 0.45s}.vngage-csstransitions .vngage-banner.vngage-dooreye .vngage-tab{-webkit-transition:opacity 0.45s;-moz-transition:opacity 0.45s;-o-transition:opacity 0.45s;transition:opacity 0.45s}.vngage-csstransitions .vngage-banner.vngage-dooreye .vngage-content{-webkit-transition:width 0.45s;-moz-transition:width 0.45s;-o-transition:width 0.45s;transition:width 0.45s}.vngage-no-csstransforms .vngage-icon,.vngage-no-csstransforms [class^=\"vngage-icon-\"]:before,.vngage-no-csstransforms [class*=\" vngage-icon-\"]:before{position:static;margin:0;padding:0}.vngage-no-csstransforms .vngage-banner.vngage-tabbanner .vngage-tab .vngage-tab-text:after{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);position:static;padding:0}.vngage-no-csstransforms .vngage-banner.vngage-tabbanner .vngage-tab .vngage-tab-text:before{position:static;padding:0}.vngage-no-csstransforms .vngage-banner.vngage-tabbanner .vngage-content:after{border:0;padding:0}.vngage-no-csstransforms .vngage-banner.vngage-tabbanner.vngage-expand{margin-left:-285px}.vngage-no-csstransforms .vngage-banner.vngage-takeover .vngage-content:after{padding:0}.vngage-no-csstransitions .vngage-banner.vngage-inactive{display:none}.vngage-overlay{background-color:#000;position:fixed;top:0;left:0;width:100%;height:100%;zoom:1;filter:alpha(opacity=0);-webkit-opacity:0;-moz-opacity:0;opacity:0;visibility:hidden;z-index:9999;-webkit-transition:all 0.45s;-moz-transition:all 0.45s;-o-transition:all 0.45s;transition:all 0.45s}.vngage-overlay.vngage-show{zoom:1;filter:alpha(opacity=50);-webkit-opacity:0.5;-moz-opacity:0.5;opacity:0.5;visibility:visible}.vngage-banner div{font-size:inherit}.vngage-banner .vngage-btn{display:block;font-weight:normal;font-family:'HM Ampersand Bold',Arial,sans-serif;width:100%;margin-top:1em;text-transform:uppercase;-webkit-transition:none !important;-moz-transition:none !important;-o-transition:none !important;transition:none !important}.vngage-banner .vngage-disclaimer{font-size:0.92em;margin:1.2em 0 0}.vngage-banner.vngage-tabbanner textarea{display:block;background-color:white !important;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;border:solid 1px #dcdcdc;border-radius:0;font-size:13px;font-family:inherit;width:100%;height:76px;margin-top:1.2em;padding:0.5em 0.6em;resize:none}.vngage-banner.vngage-tabbanner .vngage-tab .vngage-tab-text{font-weight:normal;font-family:'HM Ampersand Bold',Arial,sans-serif;-webkit-transition:background-color 1s;-moz-transition:background-color 1s;-o-transition:background-color 1s;transition:background-color 1s}.vngage-banner.vngage-tabbanner .vngage-content+.vngage-content{display:none}.vngage-banner.vngage-tabbanner .vngage-content.vngage-wider{-moz-box-sizing:border-box;box-sizing:border-box;width:325px}.vngage-banner.vngage-tabbanner.vngage-error .vngage-tab .vngage-tab-text{background-color:#ce2127}.vngage-no-csstransitions .vngage-banner.vngage-tabbanner.vngage-expand{-ms-transform:none;margin-left:-285px}"}}},{"data":{"id":"A5500865-C9FA-40FC-B3DA-8DEB2F8E4E85","name":"Generic","type":"banner","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"texts":{"tab":"Chat with us","title":"Need advice?","subtitle":"We can help with any query regarding  your shopping experience!","questionPlaceholder":"Type your question here","btnJoin":"Start chat","disclaimer":"By joining the chat with H&M, you agree that we may co-browse in order to assist you. Enjoy!"},"template":"tabbanner","introOnce":false,"introPerTemplate":false,"displayWhenOpen":true,"displayWhenBusy":false,"displayWhenClosed":false,"mouseExpand":false,"mouseCollapse":false,"html":"<h2>{{= conf.title}}</h2>\n<p>{{= conf.subtitle}}</p>\n\n<form data-vngage-banner=\"formJoin\">\n  <textarea placeholder=\"{{= conf.questionPlaceholder}}\" maxlength=\"99\" data-vngage-banner=\"message\"></textarea>\n</form>\n\n<div class=\"vngage-buttons\">\n  <button class=\"vngage-btn vngage-primary\" data-vngage-banner=\"join\">{{= conf.btnJoin}}</button>\n</div>\n\n<p class=\"vngage-disclaimer\">{{= conf.disclaimer}}</p>","htmlTab":"{{= conf.tab}}","introDuration":0,"introDelay":0,"introQuarantine":null}}},{"data":{"id":"3B2AF3E6-B963-47E4-BB54-162701A0B7CD","name":"Failed registration","type":"banner","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"texts":{"title":"Do you want some help to register your account?","btnJoin":"Start chat","disclaimer":"By joining the chat with H&M, you agree that we may co-browse in order to assist you. Enjoy!"},"template":"injected","introOnce":false,"introPerTemplate":false,"displayWhenOpen":true,"displayWhenBusy":true,"displayWhenClosed":true,"targetMethod":"before","target":".vngage-banner.vngage-tabbanner .vngage-content","extraClasses":"vngage-content","html":"<h3>{{= conf.title}}</h3>\n\n<div class=\"vngage-buttons\">\n  <button class=\"vngage-btn vngage-primary\" data-vngage-banner=\"join\">{{= conf.btnJoin}}</button>\n</div>\n\n<p class=\"vngage-disclaimer\">{{= conf.disclaimer}}</p>"}}},{"data":{"id":"E9E60BDC-F8C4-4C12-AE1C-2F1120085E3D","name":"Failed login","type":"banner","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"texts":{"btnJoin":"Start chat","titleRowOne":"Having trouble logging in?","titleRowTwo":"Let us know if we can help you.","disclaimer":"By joining the chat with H&M, you agree that we may co-browse in order to assist you. Enjoy!"},"template":"injected","introOnce":false,"introPerTemplate":false,"displayWhenOpen":true,"displayWhenBusy":true,"displayWhenClosed":true,"targetMethod":"before","target":".vngage-banner.vngage-tabbanner .vngage-content","extraClasses":"vngage-content vngage-wider","html":"<h3>{{= conf.titleRowOne}}<br />{{= conf.titleRowTwo}}</h3>\n\n<div class=\"vngage-buttons\">\n  <button class=\"vngage-btn vngage-primary\" data-vngage-banner=\"join\">{{= conf.btnJoin}}</button>\n</div>\n\n<p class=\"vngage-disclaimer\">{{= conf.disclaimer}}</p>"}}},{"data":{"id":"9E9A2638-1869-4569-BE40-56545B8774DA","name":"Failed update","type":"banner","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"texts":{"title":"Need advice?","subtitle":"Something seems to have gone wrong. Can we help you?","btnJoin":"Start chat","disclaimer":"By joining the chat with H&M, you agree that we may co-browse in order to assist you. Enjoy!"},"template":"injected","introOnce":false,"introPerTemplate":false,"displayWhenOpen":true,"displayWhenBusy":true,"displayWhenClosed":true,"targetMethod":"before","target":".vngage-banner.vngage-tabbanner .vngage-content","extraClasses":"vngage-content","html":"<h2>{{= conf.title}}</h2>\n<p>{{= conf.subtitle}}</p>\n\n<div class=\"vngage-buttons\">\n  <button class=\"vngage-btn vngage-primary\" data-vngage-banner=\"join\">{{= conf.btnJoin}}</button>\n</div>\n\n<p class=\"vngage-disclaimer\">{{= conf.disclaimer}}</p>"}}},{"data":{"id":"84CF1EA9-3F36-4E66-AEAF-D24BD71D2C9B","name":"Size guide","type":"banner","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"texts":{"title":"Need help with choosing size?","btnJoin":"Start chat","disclaimer":"By joining the chat with H&M, you agree that we may co-browse in order to assist you. Enjoy!"},"template":"injected","introOnce":false,"introPerTemplate":false,"displayWhenOpen":true,"displayWhenBusy":true,"displayWhenClosed":true,"targetMethod":"before","html":"<h3>{{= conf.title}}</h3>\n\n<div class=\"vngage-buttons\">\n  <button class=\"vngage-btn vngage-primary\" data-vngage-banner=\"join\">{{= conf.btnJoin}}</button>\n</div>\n\n<p class=\"vngage-disclaimer\">{{= conf.disclaimer}}</p>","target":".vngage-banner.vngage-tabbanner .vngage-content","extraClasses":"vngage-content vngage-wider"}}},{"data":{"id":"FF969F4E-2ECF-4898-9A42-2A6957915F13","name":"Default settings","type":"panelSettings","siteId":"00000000-0000-0000-0000-000000000000","section":{"initialState":"docked-right","nonResponsiveMobile":false,"shouldAutoHide":false,"stateBlacklist":["undocked"],"offsetTop":"35%","resizeObject":"{ \"width\": \"340\", \"height\": \"400\", \"minHeight\": \"250\" }","point":null,"supportImage":null,"defaultAgentPicture":"//hm-content.vergic.com/cdn/accounts/9815BE97-340C-4510-8280-38558217092F/images/icon-chat-dots.png"}}},{"data":{"id":"4109EF31-11B4-4E45-91F8-834D9BF549A9","name":"Email Tabbanner","type":"banner","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"template":"tabbanner","texts":{"title":"Need help?","tab":"Chat with us","subtitle":"Chat with customer service to get your answer right away!","disclaimer":"By joining the chat with H&M, you agree that we may co-browse in order to assist you. Enjoy!","btnJoin":"Start chat"},"introOnce":false,"introPerTemplate":false,"displayWhenOpen":true,"displayWhenBusy":false,"displayWhenClosed":false,"mouseExpand":false,"mouseCollapse":false,"introDuration":10,"introDelay":2,"html":"<h2>{{= conf.title}}</h2>\n<p>{{= conf.subtitle}}</p>\n\n\n\n<div class=\"vngage-buttons\">\n  <button class=\"vngage-btn vngage-primary\" data-vngage-banner=\"join\">{{= conf.btnJoin}}</button>\n</div>\n\n<p class=\"vngage-disclaimer\">{{= conf.disclaimer}}</p>\n\n","htmlTab":"{{= conf.tab}}"}}},{"data":{"id":"849ABE9F-6691-4343-9D82-241A31CE795A","name":"Email support tab","type":"solution","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"bannerId":"4109EF31-11B4-4E45-91F8-834D9BF549A9","caseTypeId":"2064B7ED-3A6C-417E-9D09-15CB81CEF9E9","groupId":"0673451C-76DD-4DC1-88E4-5C52142750B2","messageToCustomerCase":"Email Page"}}},{"data":{"id":"E337B070-4AC8-424D-8B3B-C1D7D0C12CA0","name":"Email Page","type":"opportunity","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","section":{"position":1,"solutions":["849ABE9F-6691-4343-9D82-241A31CE795A"],"name":"","score":"","condition":{"expression":{"not":false,"field":{"type":"navigation","value":"currentPage"},"operator":{"type":"string","value":"contains"},"value":{"type":"static","value":"/contact"}},"conditions":[]}}}}],"groups":[{"data":{"id":"809092A6-0801-4A61-A3BE-D99DE2FA2BC4","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0"}},{"data":{"id":"0673451C-76DD-4DC1-88E4-5C52142750B2","siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0"}}],"pointOfInterests":[{"data":{"id":"0B731F18-C62F-49C7-926E-2AB06EE7C1F4","name":"Purchase confirmation","key":"purchaseConfirmation","value":"https://www.hm.com/us/purchase","tags":[],"siteId":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0"}}],"scripts":[{"data":{"id":"D26F9E63-1CD3-437A-8136-2AE722CDFE40","name":"Custom script (live)","comments":"Script","script":"var hasPsApplication = psPlugin && psPlugin.application,\n    hasPsStateMachine = hasPsApplication && psPlugin.application.stateMachine,\n    hasPsCurrentState = hasPsStateMachine && psPlugin.application.stateMachine.currentState,\n    hasPsCommands = hasPsApplication && psPlugin.application.commands;\n \nvar bannerHandler = vngageapp.require('applications/banners/handler');\n\nvar solutionMap, blurListener, submitListener, setActiveBanner;\n\n//map solution and presentation GUIDs, since they differ between environments.\nvar idFor = {\n\t'tabBanner':'F54F7143-8E77-4E85-B185-8EE0F1292E80',\n\t'login':'FF61AF55-BC88-4FD7-BED1-B002D8FEDA2A',\n    'update':'B4EF8D7F-52F3-458A-BC05-F0347321A6BD',\n    'registration':'D3E517AE-887F-45F4-8718-A71BE3B24AEF',\n    'sizeGuide':'D9E941F3-76CA-4D3E-A4E6-CD353736D20C'\n};\n\n/* ==========================\n *        ACCOUNT JS\n * ========================== */\n\n//addCallback to js n avigation\nif (window.hm && window.hm.url && window.hm.url.addCallback){\n\n\thm.url.addCallback(function(url){\n\n\t\tif (window.top === window.self) {\n          \tif ( vngage.get('currentstate') !== 'Ready' || \n               (hasPsStateMachine && hasPsCurrentState &&                  \n               psPlugin.application.stateMachine.currentState !== 'Ready')\n             )\n          {\n          \tif (hasPsCommands) {\n                  psPlugin.application.commands.addHistory.execute(location.href);\n                } else {\n                  vngage.update('location', { url: location.href });\n                }\n          }\n        } else {\n          try {\n            psPlugin.application.URL = location.href;\n            psPlugin.application.postMessageEvents.call('onPageLoaded');\n          } catch(err){}\n        }\n\t\t\n\t});\n}\n\nvar childPageProtocol = 'http://';\n// Report page width on orientationchange via postMessage\n    // Fixes layout issues on tablets.\n\n    function onOrientationchange(){\n        var iframe = document.getElementById(\"psDialogFrame\");\n        if (!iframe) { return false; }\n        var origin = childPageProtocol + document.location.host;\n        var isPortrait = (window.orientation === 0 || window.orientation === 180);\n\n        // screen.width is always the width of screen in portrait mode,\n        // and doesn't change on orientationchange.\n        // var width = isPortrait ? window.screen.width : window.screen.height;\n        // another possibility would be to always calculate the correct max/min value:\n        var width = Math[ isPortrait ? 'min' : 'max' ](window.innerHeight, window.innerWidth);\n\n        if (iframe.contentWindow && iframe.contentWindow.postMessage){\n            iframe.contentWindow.postMessage({width: width}, origin);\n        }\n    }\n\n\n\n// break out of iframe if checkout or pending shipments\n\t\nif (window.self !== window.top) {\n\tvar host = document.location.host;\n  \tvar market = window.location.pathname.substring(1,3);\n  \n    if (document.location.pathname.indexOf('/checkout') > -1){\n  \t\twindow.top.location.href = 'https://'+host+'/'+market+'/checkout';\n\t}else if(document.location.pathname.indexOf('/my-hm/pendingshipments') > -1){\n      \twindow.top.location.href = 'https://'+host+'/'+market+'/my-hm/pendingshipments';\n    }\n}\n\n\n\n\n// break out of bidirectional state if https: page\nif (window.self !== window.top) {\n\n\tif (document.location.protocol === 'https:'){\n\t\tvar msg = JSON.stringify({vngageUrl: document.location.href});\n\t\twindow.parent.postMessage(msg, 'http://' + document.location.host);\n\t}\n\n} else {\n  \n  \n  \twindow.addEventListener(\"message\", function (event) {\n\t\tif(window.self !== window.top) return;\n\t\tif(event.origin === 'https://' + document.location.host) {\n\t\t\tvar url, msg = event.data;\n          \n\t        childPageProtocol = 'https://';\n          \n\t\t\tif (msg && typeof msg === 'string' && msg !== '') {\n            \n\t\t\t\ttry {\n\t\t\t\t\tmsg = JSON.parse(msg);\n\t\t\t\t\turl = msg.vngageUrl;\n\t\t\t\t\tif(url && url.indexOf('https://') > -1) {\n\t\t\t\t\t\tlocation.href = url;\n\t\t\t\t\t}\n\t\t\t\t} catch(error) {\n                \tconsole.info('postMessage error: ',error);\n                }\n\t\t\t\t\n\t\t\t}\n\t\t} else {\n\n        \tif(event.origin === 'http://' + document.location.host){\n            \tchildPageProtocol = 'http://'; \n            }\n        }\n\t}, false);\n\n  \n    \n\n    // Add listener for tablet version only\n    if (document.location.host.indexOf('tablet.hm.com') > -1){\n      window.addEventListener('orientationchange', onOrientationchange, false);\n    }\n\n}\n\n\n\n//decorate coBrowserUrl with parameter if on a device\nvngage.extensions.decorateCobrowserUrl = function decorateCobrowserUrl(url) {\n\tvar param = 'devicestay=true',\n\t\tstate = 'Ready';\n\n\ttry {\n\t  \n\t  if (hasPsCurrentState){\n\t\t  state = psPlugin.application.stateMachine.currentState;\n\t  } else {\n      \t  state = vngage.get('currentstate');\n      }\n\n\t  if (state === 'Ready' || \n\t\t  url.indexOf('tablet.hm.com') === -1 || \n\t\t  url.indexOf(param) > -1\n\t  ){\n\t\t  return url;\n\t  }\n\n\t  url = url.replace(/([^#?\\n]+)([?#]?)(.*)/gi, function (match, start, q, end) {\n\t\t  return start + '?' + param + ((q === '?') ? '&': q) + end;\n\t  });\n\t\n\t} catch (err){}\n  \n\treturn url;\n};\n\n\nfunction accountJs($) {\n\n\t/* ==========================\n\t *       jQuery CHECK\n\t * ========================== */\n\tif (typeof $ === 'undefined') {\n\t\treturn;\n\t}\n\n\n\n    /* ==========================\n           *        BLUR/SUBMIT\n           * ========================== */\n    function getIteratorAction(listeners) {\n      function iterator(event) {\n        _.each(listeners, function(lstnr) {\n          lstnr(event);\n        });\n      }\n\n      return iterator;\n    }\n\n    function createListener(eventName, delayedChecks) {\n      function bodyListener() {\n        var listeners = [],\n            debouncedIterators = [],\n            iteratorAction = getIteratorAction(listeners);\n\n        _.each(delayedChecks, function(delay) {\n          debouncedIterators.push(_.debounce(iteratorAction, delay));\n        });\n\n        $(document.body).on(eventName, function(event) {\n          _.each(debouncedIterators, function(func) {\n            func(event);\n          });\n        });\n\n        return listeners;\n      }\n\n      return bodyListener;\n    }\n\n    function getListener(eventName, delayedChecks) {\n      return _.once(createListener(eventName, delayedChecks));\n    }\n\n    // These will add a listener on first run,\n    // first and subsequent runs returns an array\n    // which will contain all the listeners to run\n    blurListener = getListener('focusout', [400]);\n    submitListener = getListener('submit', [800, 2000]);\n\n\n    /* ==========================\n           *      SOLUTION CONFIG\n           * ========================== */\n    solutionMap = {};\n\n\n    //Failed login - Injected\n    solutionMap[idFor.login] = { \n      name: 'Login',\n      trigger: createFormTrigger(submitListener, 'customerLogin')\n    };\n\n    //Failed (profile) update - Injected\n    solutionMap[idFor.update] = {\n      name: 'Update',\n      trigger: createFormTrigger([blurListener, submitListener], ['checkout', 'editPersonalDetails'])\n    };\n\n    //Failed registration - Injected\n    solutionMap[idFor.registration] = {\n      name: 'Registration',\n      trigger: createFormTrigger(blurListener, ['register', 'checkout-register'])\n    };\n\n    //Size guide - Injected\n    solutionMap[idFor.sizeGuide] = {\n      name: 'Size guide',\n      trigger: function(resolve) {\n\t\t\n        var sizeGuide = new RegExp('hm\\\\.com/us/sizeguide/sizeguide');\n        //var timedResolve = _.debounce(_.partial(resolve, false, 0.2, 10), 30000);\n\t\tvar resolveFn = function () { resolve(false, 0.2, 10); };\n\t\tvar timedResolve = _.debounce( resolveFn , 30000);\n\n        if (window.location.href.match(sizeGuide)) {\n          timedResolve();\n        } else {\n          $('#link-sizeFit').on('click', timedResolve);\n          $('.btn-size-guide').on('click', timedResolve);\n        }\n      }\n    };\n\n\t\n  \t/* ==========================\n         *        BANNER ADD\n         * ========================== */\n  vngage.subscribe('banner:add', function(evt, banner) {\n\n      var bannerId = banner.config.id;\n      if (bannerId === idFor.tabBanner) {\n        setupFirstIntro(banner);\n        setupContentSwap(banner);\n      } else if (bannerId in solutionMap) {\n        setupSwappedContent(banner);\n      }\n\n      var textEl = banner.el.querySelector('textarea');\n\n      if (textEl) {\n        textEl.addEventListener('focus', function() {\n          if (document.all) {\n            window.setTimeout(function() {\n              textEl.focus();\n              textEl.createTextRange().select();\n            }, 0);\n          }\n        });\n      }\n  });\n\n\n\t/* ==========================\n\t *       HELPER METHODS\n\t * ========================== */\n\t\n\n\tfunction invalidFields(formSelector) {\n      \tvar isInvalid = $(formSelector).find('p.error, .field.error').size() > 0;\n\n\t\treturn isInvalid;\n\t}\n\n\tfunction createFormTrigger(listenerTypes, formNames) {\n\t\tvar formNameSelector = [];\n\n\t\tif (!_.isArray(listenerTypes)) {\n\t\t\tlistenerTypes = [listenerTypes];\n\t\t}\n\n\t\tif (_.isString(formNames)) {\n\t\t\tformNames = [formNames];\n\t\t}\n\n\n\t\t_.each(formNames, function(name) {\n\t\t\tformNameSelector.push('form[name=\"' + name + '\"]');\n\t\t});\n\n\t\tformNameSelector = formNameSelector.join(', ');\n\n\t\treturn function(resolve) {\n\n\t\t\tfunction invalidCheck() {\n\t\t\t\tif (invalidFields(formNameSelector)) {\n\t\t\t\t\tresolve(true);\n\t\t\t\t}\n\t\t\t}\n\t\t\t_.each(listenerTypes, function(lstnr) {\n\t\t\t\tlstnr().push(invalidCheck);\n\t\t\t});\n\t\t\t_.delay(invalidCheck, 300);\n\t\t};\n\t}\n\n\n\t// Uses cookie, so works cross protocol\n\t// also remembers count from previous page\n\tfunction setupFirstIntro(banner) {\n      \n\t\tvar recursiveCount,\n\t\t\ttargetCount = 30,\n\t\t\tcurrentCount = getCount();\n\n\t\tcurrentCount = currentCount < 30 ? currentCount : 0;\n\n\t\trecursiveCount = _.debounce(function() {\n\t\t\tif (currentCount >= 0 && currentCount < targetCount) {\n\t\t\t\tcurrentCount += 1;\n\t\t\t\tsetCookie(currentCount);\n\t\t\t\trecursiveCount();\n\t\t\t} else if (currentCount >= targetCount) {\n\t\t\t\tbanner.intro(0, 10, setCookie);\n\t\t\t}\n\t\t}, 1000);\n\n\t\trecursiveCount();\n\n\t\tfunction getCount() {\n\t\t\tvar val = /(?:^|; )vngage\\.visit=(-?\\d+);?/.exec(document.cookie) || [];\n\t\t\tval = Number(val[1]);\n\t\t\treturn isNaN(val) ? 0 : val;\n\t\t}\n\n\t\tfunction setCookie(count) {\n\t\t\tvar expireTime = (new Date(Date.now() + 7776000000)).toGMTString();\n\t\t\tcount = count || -1;\n\t\t\tdocument.cookie = 'vngage.visit=' + count + '; path=/; expires=' + expireTime;\n\t\t}\n\t\twindow.vngageDebug = {\n        \tgetCount: getCount,\n\t        setCookie:setCookie\n        };\n      \n    }\n\n\tfunction setupContentSwap(banner) {\n\t\tvar bannerId, bannerEl, activeBanner;\n\n      \t\n\t\tbannerEl = $(banner.el);\n\t\t// Closes old injected banner, adds the new injected,\n\t\t// sets classes and intro as specified by parameters\n\t\tfunction doSwap(newBannerId, addWarning, introDelay, introDuration) {\n\t\t\tvar tracking = {\n\t\t\t\topportunityId: banner.config.opportunityId,\n\t\t\t\tcorrelationId: banner.config.correlationId\n\t\t\t};\n          \n\t\t\tif (!activeBanner || activeBanner.config.id !== newBannerId) {\n\t\t\t\tif (activeBanner) {\n\t\t\t\t\tactiveBanner.close();\n\t\t\t\t}\n\n\t\t\t\t// If tracking of solution \"evaluated\" is not sent,\n\t\t\t\t// the statistics for this solution will not be tracked correctly\n\t\t\t\t/*psPlugin.application.listener.tracking({\n\t\t\t\t type: 'Solution',\n\t\t\t\t visitId: '00000000-0000-0000-0000-000000000000',\n\t\t\t\t solutionId: newBannerId,\n\t\t\t\t siteId: psPlugin.application.configuration.chosenLanguage,\n\t\t\t\t opportunityId: tracking.opportunityId,\n\t\t\t\t correlationId: tracking.correlationId,\n\t\t\t\t eventName: 'Evaluated',\n\t\t\t\t tags: [],\n\t\t\t\t source: 'visitor',\n\t\t\t\t tag: {}\n\t\t\t\t });*/\n                bannerHandler.add(newBannerId, tracking);\n\t\t\t\t//psPlugin.application.bannerHandler.add(newBannerId, tracking);\n\t\t\t}\n\n\t\t\tif (introDelay && introDuration) {\n\t\t\t\tbanner.intro(introDelay, introDuration);\n\t\t\t}\n\n\t\t\tbannerEl.addClass('vngage-swapped');\n\t\t\tbannerEl.toggleClass('vngage-error', !!addWarning);\n\t\t}\n\n\t\tfunction setActive(newActive) {\n\t\t\tvar bannerTab, bannerToggleAction;\n\n\t\t\tbannerTab = bannerEl.children('.vngage-tab');\n\t\t\tbannerToggleAction = _.debounce(function() {\n\t\t\t\tif (! bannerEl.hasClass('vngage-expand')) {\n\t\t\t\t\tactiveBanner.close();\n\t\t\t\t\tactiveBanner = null;\n\t\t\t\t\tbannerEl.removeClass('vngage-error');\n\t\t\t\t\tbannerTab.off('click', bannerToggleAction);\n\t\t\t\t}\n\t\t\t}, 500);\n\n\t\t\tactiveBanner = newActive;\n\t\t\tbannerTab.on('click', bannerToggleAction);\n\t\t}\n\n\t\tsetActiveBanner = setActive;\n\n\t\t// Run all solution triggers, send in doSwap as parameter\n\t\tfor (bannerId in solutionMap) {\n\t\t\tif (solutionMap.hasOwnProperty(bannerId)) {\n\t\t\t\tsolutionMap[bannerId].trigger(doSwap.bind(this, bannerId));\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction setupSwappedContent(banner) {\n\t\tsetActiveBanner(banner);\n\t}\n\n}\n\naccountJs(window.$);"}}],"sites":[{"data":{"id":"EFE0A7DD-594C-4EFF-8AFC-36EC57ACB5B0","name":"HM US","languageCode":"en-GB"}}],"translations":{"en-GB":{"rolevisitor":"Visitor","roleguest":"Guest","roleagent":"Agent","participantjoined":"has joined","participantleft":"has left","visitorPrefix":"You","menuActionHide":"Hide panel","menuActionPrint":"Print chat","menuActionPDF":"Download chat as PDF","menuActionEmailChatHistory":"Email chat history","menuActionLeaveQueue":"Leave queue","menuActionEndDialog":"End dialogue","menuActionCancel":"Cancel","queueLeaveConfirm":"Are you sure you want to leave queue?","queueLeaveActionYes":"Yes, leave","queueLeaveActionNo":"No, stay","dialogTalkingTo":"You're talking to:","dialogUndefinedUser":"Please wait ...","dialogTransferring":"Transferring you to another agent","dialogEndConfirm":"Are you sure you want to end the current dialogue?","dialogEndActionYes":"Yes, end it","dialogEndActionNo":"No, cancel","dialogActionStart":"Start chat","dialogActionCancel":"Cancel","dialogJoinTimer":"Please confirm within","dialogSendAsEmail":"Email chat history","dialogPrint":"Print chat history","dialogClose":"Close panel","newMessage":"New message","queueJoinReject":"You are either trying to reach us outside of our opening hours, or we have some technical difficulties. Reload the page to try again.","queueJoinRejectBtn":"Close","InvalidStartCodeReject":"Invalid start code. Unfortunately we could not match the supplied code in the system. Reload the page to try again.","queueJoinTitle":"Your place in line","queuePlaceInQueueTitle":"Queue","queuePlaceInQueueDescription":"This is your place in queue","queueJoinHeadline":"","queueJoinMessage":"Hi. We're working as fast as we can to find an available agent. Meanwhile feel free to browse around here at hm.com.","pendingApprovalHeading":"Hi! Can I help you?","queueWaitingTime":"Estimated waiting time:","queueBtnHidePanel":"Hide this panel","dialogResumeHeading":"Your dialog has moved to another browser window","dialogResumeText":"Looks like you recently opened our website in another browser window or tab. Your active dialog has been moved over there. Do you want to reactivate your dialog in this window again?","dialogResumeAction":"Resume","emailHistoryMessage":"Send chat history","emailHistorySendAction":"Send","emailHistoryCancelAction":"Cancel","emailSentToMessage":"Email was sent to","emailAddressPlaceholder":"your.name@mydomain.com","emailAddressError":"Invalid email address","emailHistoryCloseAction":"Close","chatPlaceholder":"Type your message here ...","dialogConnectionLostMessage":"Unfortunately we are experiencing technical difficulties, please wait!","dialogConnectionDeadMessage":"Unfortunately we are experiencing technical difficulties and cannot connect to your service agent.","visitorConnectionDeadMessage":"Unfortunately we are experiencing technical difficulties and cannot connect you to your service agent. Please try again later, or call us (toll free) on 1-855-466-7467!","visitorOfflineHeader":"Connection error","visitorOfflineMessage":"Unfortunately your connection to our server is not available. Please chat with us again later, or call us (toll free) on 1-855-466-7467!","visitorOfflineMessageLater":"If that does not help, please feel free to contact us again later.","visitorOfflineBtn":"Reload page","dialogBlockMessage":"We would like to end this session","dialogEnded":"Chat history","confirmDialogStartProactiveText":"Do you want one of our customer service agents to guide you through our site?","btnApproveProactive":"Approve","btnDeclineProactive":"Decline","confirmDialogStartProactiveHeading":"Hi! How can I help you?","queueAlreadyInQueue":"Looks like you are already in queue in another browser window or tab.","validationRequired":"Required field","validationInvalid":"Invalid field","allowVideo":"To start the video stream you usually need to click Allow in a dialog box near the browser address bar."}},"comm":{"host":"https://hm-content-a.vergic.com","commUrl":"https://hm-prod.vergic.com/","restUrl":"https://hm-prod.vergic.com/api/v1/","assetPath":"//hm-content-a.vergic.com/cdn/","domainWhiteList":["*.hm.com","*.vergic.com","*.psplugin.com"],"accountId":"9815BE97-340C-4510-8280-38558217092F"}};})();var vngageapp;!function(){if(!vngageapp||!vngageapp.requirejs){vngageapp?require=vngageapp:vngageapp={};var requirejs,require,define;!function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,r){return t&&eachProp(t,function(t,i){(n||!hasProp(e,i))&&(r&&"string"!=typeof t?(e[i]||(e[i]={}),mixin(e[i],t,n,r)):e[i]=t)}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,r){var i=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return i.requireType=e,i.requireModules=r,n&&(i.originalError=n),i}function newContext(e){function t(e){var t,n;for(t=0;e[t];t+=1)if(n=e[t],"."===n)e.splice(t,1),t-=1;else if(".."===n){if(1===t&&(".."===e[2]||".."===e[0]))break;t>0&&(e.splice(t-1,2),t-=2)}}function n(e,n,r){var i,o,a,s,c,u,l,p,d,f,g,h=n&&n.split("/"),v=h,m=C.map,y=m&&m["*"];if(e&&"."===e.charAt(0)&&(n?(v=getOwn(C.pkgs,n)?h=[n]:h.slice(0,h.length-1),e=v.concat(e.split("/")),t(e),o=getOwn(C.pkgs,i=e[0]),e=e.join("/"),o&&e===i+"/"+o.main&&(e=i)):0===e.indexOf("./")&&(e=e.substring(2))),r&&m&&(h||y)){for(s=e.split("/"),c=s.length;c>0;c-=1){if(l=s.slice(0,c).join("/"),h)for(u=h.length;u>0;u-=1)if(a=getOwn(m,h.slice(0,u).join("/")),a&&(a=getOwn(a,l))){p=a,d=c;break}if(p)break;!f&&y&&getOwn(y,l)&&(f=getOwn(y,l),g=c)}!p&&f&&(p=f,d=g),p&&(s.splice(0,d,p),e=s.join("/"))}return e}function r(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===w.contextName?(t.parentNode.removeChild(t),!0):void 0})}function i(e){var t=getOwn(C.paths,e);return t&&isArray(t)&&t.length>1?(r(e),t.shift(),w.require.undef(e),w.require([e]),!0):void 0}function o(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function a(e,t,r,i){var a,s,c,u,l=null,p=t?t.name:null,d=e,f=!0,g="";return e||(f=!1,e="_@r"+(R+=1)),u=o(e),l=u[0],e=u[1],l&&(l=n(l,p,i),s=getOwn(A,l)),e&&(l?g=s&&s.normalize?s.normalize(e,function(e){return n(e,p,i)}):n(e,p,i):(g=n(e,p,i),u=o(g),l=u[0],g=u[1],r=!0,a=w.nameToUrl(g))),c=!l||s||r?"":"_unnormalized"+(N+=1),{prefix:l,name:g,parentMap:t,unnormalized:!!c,url:a,originalName:d,isDefine:f,id:(l?l+"!"+g:g)+c}}function s(e){var t=e.id,n=getOwn(I,t);return n||(n=I[t]=new w.Module(e)),n}function c(e,t,n){var r=e.id,i=getOwn(I,r);!hasProp(A,r)||i&&!i.defineEmitComplete?(i=s(e),i.error&&"error"===t?n(i.error):i.on(t,n)):"defined"===t&&n(A[r])}function u(e,t){var n=e.requireModules,r=!1;t?t(e):(each(n,function(t){var n=getOwn(I,t);n&&(n.error=e,n.events.error&&(r=!0,n.emit("error",e)))}),r||req.onError(e))}function l(){globalDefQueue.length&&(apsp.apply(T,[T.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function p(e){delete I[e],delete S[e]}function d(e,t,n){var r=e.map.id;e.error?e.emit("error",e.error):(t[r]=!0,each(e.depMaps,function(r,i){var o=r.id,a=getOwn(I,o);!a||e.depMatched[i]||n[o]||(getOwn(t,o)?(e.defineDep(i,A[o]),e.check()):d(a,t,n))}),n[r]=!0)}function f(){var e,t,n,o,a=1e3*C.waitSeconds,s=a&&w.startTime+a<(new Date).getTime(),c=[],l=[],p=!1,g=!0;if(!y){if(y=!0,eachProp(S,function(n){if(e=n.map,t=e.id,n.enabled&&(e.isDefine||l.push(n),!n.error))if(!n.inited&&s)i(t)?(o=!0,p=!0):(c.push(t),r(t));else if(!n.inited&&n.fetched&&e.isDefine&&(p=!0,!e.prefix))return g=!1}),s&&c.length)return n=makeError("timeout","Load timeout for modules: "+c,null,c),n.contextName=w.contextName,u(n);g&&each(l,function(e){d(e,{},{})}),s&&!o||!p||!isBrowser&&!isWebWorker||E||(E=setTimeout(function(){E=0,f()},50)),y=!1}}function g(e){hasProp(A,e[0])||s(a(e[0],null,!0)).init(e[1],e[2])}function h(e,t,n,r){e.detachEvent&&!isOpera?r&&e.detachEvent(r,t):e.removeEventListener(n,t,!1)}function v(e){var t=e.currentTarget||e.srcElement;return h(t,w.onScriptLoad,"load","onreadystatechange"),h(t,w.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function m(){var e;for(l();T.length;){if(e=T.shift(),null===e[0])return u(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));g(e)}}var y,b,w,_,E,C={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},I={},S={},O={},T=[],A={},x={},R=1,N=1;return _={require:function(e){return e.require?e.require:e.require=w.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?e.exports:e.exports=A[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){var t,n=getOwn(C.pkgs,e.map.id);return t=n?getOwn(C.config,e.map.id+"/"+n.main):getOwn(C.config,e.map.id),t||{}},exports:A[e.map.id]}}},b=function(e){this.events=getOwn(O,e.id)||{},this.map=e,this.shim=getOwn(C.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},b.prototype={init:function(e,t,n,r){r=r||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=r.ignore,r.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var e=this.map;return this.shim?void w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;x[e]||(x[e]=!0,w.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id,r=this.depExports,i=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{i=w.execCb(n,o,r,i)}catch(a){e=a}else i=w.execCb(n,o,r,i);if(this.map.isDefine&&(t=this.module,t&&void 0!==t.exports&&t.exports!==this.exports?i=t.exports:void 0===i&&this.usingExports&&(i=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",u(this.error=e)}else i=o;this.exports=i,this.map.isDefine&&!this.ignore&&(A[n]=i,req.onResourceLoad&&req.onResourceLoad(w,this.map,this.depMaps)),p(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,r=a(e.prefix);this.depMaps.push(r),c(r,"defined",bind(this,function(r){var i,o,l,d=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,g=w.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(r.normalize&&(d=r.normalize(d,function(e){return n(e,f,!0)})||""),o=a(e.prefix+"!"+d,this.map.parentMap),c(o,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),l=getOwn(I,o.id),void(l&&(this.depMaps.push(o),this.events.error&&l.on("error",bind(this,function(e){this.emit("error",e)})),l.enable()))):(i=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),i.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(I,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&p(e.map.id)}),u(e)}),i.fromText=bind(this,function(n,r){var o=e.name,c=a(o),l=useInteractive;r&&(n=r),l&&(useInteractive=!1),s(c),hasProp(C.config,t)&&(C.config[o]=C.config[t]);try{req.exec(n)}catch(p){return u(makeError("fromtexteval","fromText eval for "+t+" failed: "+p,p,[t]))}l&&(useInteractive=!0),this.depMaps.push(c),w.completeLoad(o),g([o],i)}),void r.load(e.name,g,i,C))})),w.enable(r,this),this.pluginMaps[r.id]=r},enable:function(){S[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,r,i;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,i=getOwn(_,e.id))return void(this.depExports[t]=i(this));this.depCount+=1,c(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&c(e,"error",bind(this,this.errback))}n=e.id,r=I[n],hasProp(_,n)||!r||r.enabled||w.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(I,e.id);t&&!t.enabled&&w.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},w={config:C,contextName:e,registry:I,defined:A,urlFetched:x,defQueue:T,Module:b,makeModuleMap:a,nextTick:req.nextTick,onError:u,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=C.pkgs,n=C.shim,r={paths:!0,config:!0,map:!0};eachProp(e,function(e,t){r[t]?"map"===t?(C.map||(C.map={}),mixin(C[t],e,!0,!0)):mixin(C[t],e,!0):C[t]=e}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=w.makeShimExports(e)),n[t]=e}),C.shim=n),e.packages&&(each(e.packages,function(e){var n;e="string"==typeof e?{name:e}:e,n=e.location,t[e.name]={name:e.name,location:n||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),C.pkgs=t),eachProp(I,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t))}),(e.deps||e.callback)&&w.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,r){function i(n,o,c){var l,p,d;return r.enableBuildCallback&&o&&isFunction(o)&&(o.__requireJsBuild=!0),"string"==typeof n?isFunction(o)?u(makeError("requireargs","Invalid require call"),c):t&&hasProp(_,n)?_[n](I[t.id]):req.get?req.get(w,n,t,i):(p=a(n,t,!1,!0),l=p.id,hasProp(A,l)?A[l]:u(makeError("notloaded",'Module name "'+l+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(m(),w.nextTick(function(){m(),d=s(a(null,t)),d.skipMap=r.skipMap,d.init(n,o,c,{enabled:!0}),f()}),i)}return r=r||{},mixin(i,{isBrowser:isBrowser,toUrl:function(e){var r,i=e.lastIndexOf("."),o=e.split("/")[0],a="."===o||".."===o;return-1!==i&&(!a||i>1)&&(r=e.substring(i,e.length),e=e.substring(0,i)),w.nameToUrl(n(e,t&&t.id,!0),r,!0)},defined:function(e){return hasProp(A,a(e,t,!1,!0).id)},specified:function(e){return e=a(e,t,!1,!0).id,hasProp(A,e)||hasProp(I,e)}}),t||(i.undef=function(e){l();var n=a(e,t,!0),r=getOwn(I,e);delete A[e],delete x[n.url],delete O[e],r&&(r.events.defined&&(O[e]=r.events),p(e))}),i},enable:function(e){var t=getOwn(I,e.id);t&&s(e).enable()},completeLoad:function(e){var t,n,r,o=getOwn(C.shim,e)||{},a=o.exports;for(l();T.length;){if(n=T.shift(),null===n[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);g(n)}if(r=getOwn(I,e),!t&&!hasProp(A,e)&&r&&!r.inited){if(!(!C.enforceDefine||a&&getGlobal(a)))return i(e)?void 0:u(makeError("nodefine","No define call for "+e,null,[e]));g([e,o.deps||[],o.exportsFn])}f()},nameToUrl:function(e,t,n){var r,i,o,a,s,c,u,l,p;if(req.jsExtRegExp.test(e))l=e+(t||"");else{for(r=C.paths,i=C.pkgs,s=e.split("/"),c=s.length;c>0;c-=1){if(u=s.slice(0,c).join("/"),o=getOwn(i,u),p=getOwn(r,u)){isArray(p)&&(p=p[0]),s.splice(0,c,p);break}if(o){a=e===o.name?o.location+"/"+o.main:o.location,s.splice(0,c,a);break}}l=s.join("/"),l+=t||(/^data\:|\?/.test(l)||n?"":".js"),l=("/"===l.charAt(0)||l.match(/^[\w\+\.\-]+:/)?"":C.baseUrl)+l}return C.urlArgs?l+((-1===l.indexOf("?")?"?":"&")+C.urlArgs):l},load:function(e,t){req.load(w,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=v(e);w.completeLoad(t.id)}},onScriptError:function(e){var t=v(e);return i(t.id)?void 0:u(makeError("scripterror","Script error for: "+t.id,e,[t.id]))}},w.require=w.makeRequire(),w}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.8+",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||!navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1,dataBaseUrl;if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,n,r){var i,o,a=defContextName;return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=n,n=r):e=[]),o&&o.context&&(a=o.context),i=getOwn(contexts,a),i||(i=contexts[a]=req.s.newContext(a)),o&&i.configure(o),i.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,n){var r=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return r.type=e.scriptType||"text/javascript",r.charset="utf-8",r.async=!0,r},req.load=function(e,t,n){var r,i=e&&e.config||{};if(isBrowser)return r=req.createNode(i,t,n),r.setAttribute("data-requirecontext",e.contextName),r.setAttribute("data-requiremodule",t),!r.attachEvent||r.attachEvent.toString&&r.attachEvent.toString().indexOf("[native code")<0||isOpera?(r.addEventListener("load",e.onScriptLoad,!1),r.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,r.attachEvent("onreadystatechange",e.onScriptLoad)),r.src=n,currentlyAddingScript=r,baseElement?head.insertBefore(r,baseElement):head.appendChild(r),currentlyAddingScript=null,r;if(isWebWorker)try{importScripts(n),e.completeLoad(t)}catch(o){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,o,[t]))}},isBrowser&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),(dataMain=e.getAttribute("data-main"))?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):(dataBaseUrl=e.getAttribute("data-baseurl"),void(dataBaseUrl&&(cfg.baseUrl=dataBaseUrl)))}),define=function(e,t,n){var r,i;"string"!=typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(r=currentlyAddingScript||getInteractiveScript(),r&&(e||(e=r.getAttribute("data-requiremodule")),i=contexts[r.getAttribute("data-requirecontext")])),(i?i.defQueue:globalDefQueue).push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}(this),vngageapp.requirejs=requirejs,vngageapp.require=require,vngageapp.define=define}}(),vngageapp.define("../vendor/vergic/require.js",function(){}),vngageapp.define("vergic.polyfill",[],function(){if("function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i}),!window.matchMedia){var e={matches:!1};window.matchMedia=function(){return e}}!function(e){function t(){l.setAttribute("content",f),g=!0}function n(){l.setAttribute("content",d),g=!1}function r(r){u=r.accelerationIncludingGravity,a=Math.abs(u.x),s=Math.abs(u.y),c=Math.abs(u.z),e.orientation&&180!==e.orientation||!(a>7||(c>6&&8>s||8>c&&s>6)&&a>5)?g||t():g&&n()}var i=navigator.userAgent;if(/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(i)&&i.indexOf("AppleWebKit")>-1){var o=e.document;if(o.querySelector){var a,s,c,u,l=o.querySelector("meta[name=viewport]"),p=l&&l.getAttribute("content"),d=p+",maximum-scale=1",f=p+",maximum-scale=10",g=!0;l&&(e.addEventListener("orientationchange",t,!1),e.addEventListener("devicemotion",r,!1))}}}(this),function(){for(var e=["webkit","moz"],t=0;t<e.length&&!window.requestAnimationFrame;++t){var n=e[t];window.requestAnimationFrame=window[n+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n+"CancelAnimationFrame"]||window[n+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var r=0;window.requestAnimationFrame=function(e){var t=Date.now(),n=Math.max(r+16,t);return setTimeout(function(){e(r=n)},n-t)},window.cancelAnimationFrame=clearTimeout}}()}),vngageapp.define("vergic.environment",[],function(){"use strict";function e(){var e=document.documentElement.style;return"WebkitAppearance"in e?"webkit":"MozAppearance"in e?"mozilla":"-ms-scroll-limit"in e?"ie":"OLink"in e?"opera":"KhtmlUserInput"in e?"khtml":null}function t(t){var n=this.os={},r=this.browser={},i=t.match(/Edge\/?([\d.]+)/),o=!i&&t.match(/Web[kK]it[\/]{0,1}([\d.]+)/),a=t.match(/(Android);?[\s\/]+([\d.]+)?/),s=!!t.match(/\(Macintosh\; Intel /),c=t.match(/(iPad).*OS\s([\d_]+)/),u=t.match(/(iPod)(.*OS\s([\d_]+))?/),l=!c&&t.match(/(iPhone\sOS)\s([\d_]+)/),p=t.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),d=/Windows/.test(t),f=t.match(/Windows Phone ([\d.]+)/),g=p&&t.match(/TouchPad/),h=t.match(/Kindle\/([\d.]+)/),v=t.match(/Silk\/([\d._]+)/),m=t.match(/(BlackBerry).*Version\/([\d.]+)/),y=t.match(/(BB10).*Version\/([\d.]+)/),b=t.match(/(RIM\sTablet\sOS)\s([\d.]+)/),w=t.match(/PlayBook/),_=t.match(/Chrome\/([\d.]+)/)||t.match(/CriOS\/([\d.]+)/),E=t.match(/Firefox\/([\d.]+)/),C=t.match(/\((?:Mobile|Tablet); rv:([\d.]+)\).*Firefox\/[\d.]+/),I=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),S=!_&&t.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),O=S||t.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/),T=t.match(/Touch/);(r.webkit=!!o)&&(r.version=o[1]),a&&(n.android=!0,n.version=a[2]),l&&!u&&(n.ios=n.iphone=!0,n.version=l[2].replace(/_/g,".")),c&&(n.ios=n.ipad=!0,n.version=c[2].replace(/_/g,".")),u&&(n.ios=n.ipod=!0,n.version=u[3]?u[3].replace(/_/g,"."):null),f&&(n.wp=!0,n.version=f[1]),p&&(n.webos=!0,n.version=p[2]),g&&(n.touchpad=!0),m&&(n.blackberry=!0,n.version=m[2]),y&&(n.bb10=!0,n.version=y[2]),b&&(n.rimtabletos=!0,n.version=b[2]),w&&(r.playbook=!0),h&&(n.kindle=!0,n.version=h[1]),v&&(r.silk=!0,r.version=v[1]),!v&&n.android&&t.match(/Kindle Fire/)&&(r.silk=!0),_&&!i&&(r.chrome=!0,r.version=_[1]),E&&(r.firefox=!0,r.version=E[1]),C&&(n.firefoxos=!0,n.version=C[1]),I&&(r.ie=!0,r.version=I[1]),O&&(s||n.ios||d)&&(r.safari=!0,n.ios||(r.version=O[1])),S&&(r.webview=!0),i&&(r.edge=!0,r.ie=!0,r.version=i[1]),n.osx=s,n.win=d,n.tablet=!!(c||w||a&&!t.match(/Mobile/)||E&&t.match(/Tablet/)||I&&!t.match(/Phone/)&&T),n.phone=!(n.tablet||n.ipod||!(a||l||p||m||y||_&&t.match(/Android/)||_&&t.match(/CriOS\/([\d.]+)/)||E&&t.match(/Mobile/)||I&&T)),n.touch=!!(n.tablet||n.phone||i&&T),n.legacy=!("opacity"in document.documentElement.style),r.engine=e()}var n={};t.call(n,navigator.userAgent);var r=null;return n.hasFlash=function(){function e(){try{return!!(navigator.mimeTypes["application/x-shockwave-flash"]||window.ActiveXObject&&new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(e){return!1}}return null!==r?r:r=e()},n.getTransform=function(){return function(){var e,t=document.createElement("div"),n=["transform","WebkitTransform","MozTransform","OTransition","msTransform"],r=["transition","WebkitTransition","MozTransition","OTransition","msTransition"];for(e in n)if(void 0!==t.style[n[e]]){var i=n[e],o=r[e],a=n[e].length>9?"-"+n[e].replace("Transform","").toLowerCase():"",s=a.length>0,c=s?a+"-transform":"transform",u=s?a+"-transition":"transition";return{jsTransform:i,jsTransition:o,cssTransform:c,cssTransition:u}}return!1}()},window.__vngageTest__&&(window.__vngageTest__.detect=t),n}),function(){function e(e,t){return e.set(t[0],t[1]),e}function t(e,t){return e.add(t),e}function n(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function r(e,t){for(var n=-1,r=e?e.length:0;++n<r&&t(e[n],n,e)!==!1;);return e}function i(e,t){for(var n=-1,r=e?e.length:0;++n<r;)if(!t(e[n],n,e))return!1;return!0}function o(e,t){for(var n=-1,r=e?e.length:0,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function a(e,t){var n=e?e.length:0;return!!n&&g(e,t,0)>-1}function s(e,t,n){for(var r=-1,i=e?e.length:0;++r<i;)if(n(t,e[r]))return!0;return!1}function c(e,t){for(var n=-1,r=e?e.length:0,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function u(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function l(e,t,n,r){var i=-1,o=e?e.length:0;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function p(e,t){for(var n=-1,r=e?e.length:0;++n<r;)if(t(e[n],n,e))return!0;return!1}function d(e){return e.split("")}function f(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function g(e,t,n){return t===t?k(e,t,n):f(e,h,n)}function h(e){return e!==e}function v(e){return function(t){return null==t?Hr:t[e]}}function m(e){return function(t){return null==e?Hr:e[t]}}function y(e,t,n,r,i){return i(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function b(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function w(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function _(e){return function(t){return e(t)}}function E(e,t){return c(t,function(t){return e[t]})}function C(e,t){return e.has(t)}function I(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}function S(e,t){return null==e?Hr:e[t]}function O(e){return No.test(e)}function T(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}function A(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function x(e,t){return function(n){return e(t(n))}}function R(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];(a===t||a===Kr)&&(e[n]=Kr,o[i++]=n)}return o}function N(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function k(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}function P(e){return O(e)?L(e):Wo(e)}function q(e){return O(e)?D(e):d(e)}function L(e){for(var t=Ro.lastIndex=0;Ro.test(e);)++t;return t}function D(e){return e.match(Ro)||[]}function M(e){if(lr(e)&&!cs(e)&&!(e instanceof V)){if(e instanceof U)return e;if(ta.call(e,"__wrapped__"))return Cn(e)}return new U(e)}function j(){}function U(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=Hr}function V(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=yi,this.__views__=[]}function B(){var e=new V(this.__wrapped__);return e.__actions__=Ct(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ct(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ct(this.__views__),e}function z(){if(this.__filtered__){var e=new V(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function F(){var e=this.__wrapped__.value(),t=this.__dir__,n=cs(e),r=0>t,i=n?e.length:0,o=$t(0,i,this.__views__),a=o.start,s=o.end,c=s-a,u=r?s:a-1,l=this.__iteratees__,p=l.length,d=0,f=Ea(c,this.__takeCount__);if(!n||Gr>i||i==c&&f==c)return ut(e,this.__actions__);var g=[];e:for(;c--&&f>d;){u+=t;for(var h=-1,v=e[u];++h<p;){var m=l[h],y=m.iteratee,b=m.type,w=y(v);if(b==di)v=w;else if(!w){if(b==pi)continue e;break e}}g[d++]=v}return g}function H(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Q(){this.__data__=xa?xa(null):{},this.size=0}function G(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function W(e){var t=this.__data__;if(xa){var n=t[e];return n===$r?Hr:n}return ta.call(t,e)?t[e]:Hr}function $(e){var t=this.__data__;return xa?t[e]!==Hr:ta.call(t,e)}function J(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=xa&&t===Hr?$r:t,this}function K(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Y(){this.__data__=[],this.size=0}function X(e){var t=this.__data__,n=we(t,e);if(0>n)return!1;var r=t.length-1;return n==r?t.pop():ga.call(t,n,1),--this.size,!0}function Z(e){var t=this.__data__,n=we(t,e);return 0>n?Hr:t[n][1]}function ee(e){return we(this.__data__,e)>-1}function te(e,t){var n=this.__data__,r=we(n,e);return 0>r?(++this.size,n.push([e,t])):n[r][1]=t,this}function ne(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function re(){this.size=0,this.__data__={hash:new H,map:new(Sa||K),string:new H}}function ie(e){var t=Qt(this,e)["delete"](e);return this.size-=t?1:0,t}function oe(e){return Qt(this,e).get(e)}function ae(e){return Qt(this,e).has(e)}function se(e,t){var n=Qt(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function ce(e){var t=-1,n=e?e.length:0;for(this.__data__=new ne;++t<n;)this.add(e[t])}function ue(e){return this.__data__.set(e,$r),this}function le(e){return this.__data__.has(e)}function pe(e){var t=this.__data__=new K(e);this.size=t.size}function de(){this.__data__=new K,this.size=0}function fe(e){var t=this.__data__,n=t["delete"](e);return this.size=t.size,n}function ge(e){return this.__data__.get(e)}function he(e){return this.__data__.has(e)}function ve(e,t){var n=this.__data__;if(n instanceof K){var r=n.__data__;if(!Sa||r.length<Gr-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new ne(r)}return n.set(e,t),this.size=n.size,this}function me(e,t){var n=cs(e),r=!n&&ss(e),i=!n&&!r&&us(e),o=!n&&!r&&!i&&ds(e),a=n||r||i||o,s=a?w(e.length,String):[],c=s.length;for(var u in e)!t&&!ta.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||nn(u,c))||s.push(u);return s}function ye(e,t,n,r){return e===Hr||er(e,Yo[n])&&!ta.call(r,n)?t:e}function be(e,t,n){var r=e[t];ta.call(e,t)&&er(r,n)&&(n!==Hr||t in e)||Ee(e,t,n)}function we(e,t){for(var n=e.length;n--;)if(er(e[n][0],t))return n;return-1}function _e(e,t){return e&&It(t,Or(t),e)}function Ee(e,t,n){"__proto__"==t&&va?va(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Ce(e,t){for(var n=-1,r=null==e,i=t.length,o=Array(i);++n<i;)o[n]=r?Hr:Cr(e,t[n]);return o}function Ie(e,t,n,i,o,a,s){var c;if(i&&(c=a?i(e,o,a,s):i(e)),c!==Hr)return c;if(!ur(e))return e;var u=cs(e);if(u){if(c=Yt(e),!t)return Ct(e,c)}else{var l=$a(e),p=l==Si||l==Oi;if(us(e))return pt(e,t);if(l==xi||l==wi||p&&!a){if(c=Xt(p?{}:e),!t)return St(e,_e(c,e))}else{if(!Po[l])return a?e:{};c=Zt(e,l,Ie,t)}}s||(s=new pe);var d=s.get(e);if(d)return d;s.set(e,c);var f=u?Hr:(n?Bt:Or)(e);return r(f||e,function(r,o){f&&(o=r,r=e[o]),be(c,o,Ie(r,t,n,i,o,e,s))}),c}function Se(e,t,n){if("function"!=typeof e)throw new TypeError(Wr);return setTimeout(function(){e.apply(Hr,n)},t)}function Oe(e,t,n,r){var i=-1,o=a,u=!0,l=e.length,p=[],d=t.length;if(!l)return p;n&&(t=c(t,_(n))),r?(o=s,u=!1):t.length>=Gr&&(o=C,u=!1,t=new ce(t));e:for(;++i<l;){var f=e[i],g=n?n(f):f;if(f=r||0!==f?f:0,u&&g===g){for(var h=d;h--;)if(t[h]===g)continue e;p.push(f)}else o(t,g,r)||p.push(f)}return p}function Te(e,t){var n=!0;return Ba(e,function(e,r,i){return n=!!t(e,r,i)}),n}function Ae(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=t(o);if(null!=a&&(s===Hr?a===a&&!hr(a):n(a,s)))var s=a,c=o}return c}function xe(e,t){var n=[];return Ba(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function Re(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=tn),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?Re(s,t-1,n,r,i):u(i,s):r||(i[i.length]=s)}return i}function Ne(e,t){return e&&za(e,t,Or)}function ke(e,t){return o(t,function(t){return sr(e[t])})}function Pe(e,t){t=on(t,e)?[t]:lt(t);for(var n=0,r=t.length;null!=e&&r>n;)e=e[wn(t[n++])];return n&&n==r?e:Hr}function qe(e,t,n){var r=t(e);return cs(e)?r:u(r,n(e))}function Le(e){return ra.call(e)}function De(e,t){return e>t}function Me(e,t){return null!=e&&ta.call(e,t)}function je(e,t){return null!=e&&t in Object(e)}function Ue(e,t,r){on(t,e)||(t=lt(t),e=vn(e,t),t=Nn(t));var i=null==e?e:e[wn(t)];return null==i?Hr:n(i,e,r)}function Ve(e){return lr(e)&&ra.call(e)==wi}function Be(e){return lr(e)&&ra.call(e)==Ci}function ze(e,t,n,r,i){return e===t?!0:null==e||null==t||!ur(e)&&!lr(t)?e!==e&&t!==t:Fe(e,t,ze,n,r,i)}function Fe(e,t,n,r,i,o){var a=cs(e),s=cs(t),c=_i,u=_i;a||(c=$a(e),c=c==wi?xi:c),s||(u=$a(t),u=u==wi?xi:u);var l=c==xi,p=u==xi,d=c==u;if(d&&us(e)){if(!us(t))return!1;a=!0,l=!1}if(d&&!l)return o||(o=new pe),a||ds(e)?Mt(e,t,n,r,i,o):jt(e,t,c,n,r,i,o);if(!(i&ci)){var f=l&&ta.call(e,"__wrapped__"),g=p&&ta.call(t,"__wrapped__");if(f||g){var h=f?e.value():e,v=g?t.value():t;return o||(o=new pe),n(h,v,r,i,o)}}return d?(o||(o=new pe),Ut(e,t,n,r,i,o)):!1}function He(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=Object(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){s=n[i];var c=s[0],u=e[c],l=s[1];if(a&&s[2]){if(u===Hr&&!(c in e))return!1}else{var p=new pe;if(r)var d=r(u,l,c,e,t,p);if(!(d===Hr?ze(l,u,r,si|ci,p):d))return!1}}return!0}function Qe(e){if(!ur(e)||cn(e))return!1;var t=sr(e)?oa:uo;return t.test(_n(e))}function Ge(e){return ur(e)&&ra.call(e)==ki}function We(e){return lr(e)&&cr(e.length)&&!!ko[ra.call(e)]}function $e(e){return"function"==typeof e?e:null==e?kr:"object"==typeof e?cs(e)?et(e[0],e[1]):Ze(e):jr(e)}function Je(e){if(!un(e))return wa(e);var t=[];for(var n in Object(e))ta.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Ke(e){if(!ur(e))return gn(e);var t=un(e),n=[];for(var r in e)("constructor"!=r||!t&&ta.call(e,r))&&n.push(r);return n}function Ye(e,t){return t>e}function Xe(e,t){var n=-1,r=tr(e)?Array(e.length):[];return Ba(e,function(e,i,o){r[++n]=t(e,i,o);
}),r}function Ze(e){var t=Gt(e);return 1==t.length&&t[0][2]?pn(t[0][0],t[0][1]):function(n){return n===e||He(n,e,t)}}function et(e,t){return on(e)&&ln(t)?pn(wn(e),t):function(n){var r=Cr(n,e);return r===Hr&&r===t?Sr(n,e):ze(t,r,Hr,si|ci)}}function tt(e,t,n){var r=-1;t=c(t.length?t:[kr],_($e));var i=Xe(e,function(e,n,i){var o=c(t,function(t){return t(e)});return{criteria:o,index:++r,value:e}});return b(i,function(e,t){return wt(e,t,n)})}function nt(e,t){return e=Object(e),rt(e,t,function(t,n){return n in e})}function rt(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=e[a];n(s,a)&&Ee(o,a,s)}return o}function it(e){return function(t){return Pe(t,e)}}function ot(e,t){return Ka(hn(e,t,kr),e+"")}function at(e,t,n){var r=-1,i=e.length;0>t&&(t=-t>i?0:i+t),n=n>i?i:n,0>n&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}function st(e,t){var n;return Ba(e,function(e,r,i){return n=t(e,r,i),!n}),!!n}function ct(e){if("string"==typeof e)return e;if(cs(e))return c(e,ct)+"";if(hr(e))return Ua?Ua.call(e):"";var t=e+"";return"0"==t&&1/e==-gi?"-0":t}function ut(e,t){var n=e;return n instanceof V&&(n=n.value()),l(t,function(e,t){return t.func.apply(t.thisArg,u([e],t.args))},n)}function lt(e){return cs(e)?e:Ya(e)}function pt(e,t){if(t)return e.slice();var n=e.length,r=ua?ua(n):new e.constructor(n);return e.copy(r),r}function dt(e){var t=new e.constructor(e.byteLength);return new ca(t).set(new ca(e)),t}function ft(e,t){var n=t?dt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function gt(t,n,r){var i=n?r(A(t),!0):A(t);return l(i,e,new t.constructor)}function ht(e){var t=new e.constructor(e.source,ao.exec(e));return t.lastIndex=e.lastIndex,t}function vt(e,n,r){var i=n?r(N(e),!0):N(e);return l(i,t,new e.constructor)}function mt(e){return ja?Object(ja.call(e)):{}}function yt(e,t){var n=t?dt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function bt(e,t){if(e!==t){var n=e!==Hr,r=null===e,i=e===e,o=hr(e),a=t!==Hr,s=null===t,c=t===t,u=hr(t);if(!s&&!u&&!o&&e>t||o&&a&&c&&!s&&!u||r&&a&&c||!n&&c||!i)return 1;if(!r&&!o&&!u&&t>e||u&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!c)return-1}return 0}function wt(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var c=bt(i[r],o[r]);if(c){if(r>=s)return c;var u=n[r];return c*("desc"==u?-1:1)}}return e.index-t.index}function _t(e,t,n,r){for(var i=-1,o=e.length,a=n.length,s=-1,c=t.length,u=_a(o-a,0),l=Array(c+u),p=!r;++s<c;)l[s]=t[s];for(;++i<a;)(p||o>i)&&(l[n[i]]=e[i]);for(;u--;)l[s++]=e[i++];return l}function Et(e,t,n,r){for(var i=-1,o=e.length,a=-1,s=n.length,c=-1,u=t.length,l=_a(o-s,0),p=Array(l+u),d=!r;++i<l;)p[i]=e[i];for(var f=i;++c<u;)p[f+c]=t[c];for(;++a<s;)(d||o>i)&&(p[f+n[a]]=e[i++]);return p}function Ct(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function It(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],c=r?r(n[s],e[s],s,n,e):Hr;c===Hr&&(c=e[s]),i?Ee(n,s,c):be(n,s,c)}return n}function St(e,t){return It(e,Ga(e),t)}function Ot(e){return ot(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:Hr,a=i>2?n[2]:Hr;for(o=e.length>3&&"function"==typeof o?(i--,o):Hr,a&&rn(n[0],n[1],a)&&(o=3>i?Hr:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t})}function Tt(e,t){return function(n,r){if(null==n)return n;if(!tr(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Object(n);(t?o--:++o<i)&&r(a[o],o,a)!==!1;);return n}}function At(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(n(o[c],c,o)===!1)break}return t}}function xt(e,t,n){function r(){var t=this&&this!==jo&&this instanceof r?o:e;return t.apply(i?n:this,arguments)}var i=t&Yr,o=Rt(e);return r}function Rt(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Va(e.prototype),r=e.apply(n,t);return ur(r)?r:n}}function Nt(e,t,r){function i(){for(var a=arguments.length,s=Array(a),c=a,u=Ht(i);c--;)s[c]=arguments[c];var l=3>a&&s[0]!==u&&s[a-1]!==u?[]:R(s,u);if(a-=l.length,r>a)return Lt(e,t,Pt,i.placeholder,Hr,s,l,Hr,Hr,r-a);var p=this&&this!==jo&&this instanceof i?o:e;return n(p,this,s)}var o=Rt(e);return i}function kt(e){return function(t,n,r){var i=Object(t);if(!tr(t)){var o=$e(n,3);t=Or(t),n=function(e){return o(i[e],e,i)}}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:Hr}}function Pt(e,t,n,r,i,o,a,s,c,u){function l(){for(var m=arguments.length,y=Array(m),b=m;b--;)y[b]=arguments[b];if(g)var w=Ht(l),_=I(y,w);if(r&&(y=_t(y,r,i,g)),o&&(y=Et(y,o,a,g)),m-=_,g&&u>m){var E=R(y,w);return Lt(e,t,Pt,l.placeholder,n,y,E,s,c,u-m)}var C=d?n:this,S=f?C[e]:e;return m=y.length,s?y=mn(y,s):h&&m>1&&y.reverse(),p&&m>c&&(y.length=c),this&&this!==jo&&this instanceof l&&(S=v||Rt(S)),S.apply(C,y)}var p=t&ii,d=t&Yr,f=t&Xr,g=t&(ei|ti),h=t&ai,v=f?Hr:Rt(e);return l}function qt(e,t,r,i){function o(){for(var t=-1,c=arguments.length,u=-1,l=i.length,p=Array(l+c),d=this&&this!==jo&&this instanceof o?s:e;++u<l;)p[u]=i[u];for(;c--;)p[u++]=arguments[++t];return n(d,a?r:this,p)}var a=t&Yr,s=Rt(e);return o}function Lt(e,t,n,r,i,o,a,s,c,u){var l=t&ei,p=l?a:Hr,d=l?Hr:a,f=l?o:Hr,g=l?Hr:o;t|=l?ni:ri,t&=~(l?ri:ni),t&Zr||(t&=~(Yr|Xr));var h=[e,t,i,f,p,g,d,s,c,u],v=n.apply(Hr,h);return sn(e)&&Ja(v,h),v.placeholder=r,yn(v,e,t)}function Dt(e,t,n,r,i,o,a,s){var c=t&Xr;if(!c&&"function"!=typeof e)throw new TypeError(Wr);var u=r?r.length:0;if(u||(t&=~(ni|ri),r=i=Hr),a=a===Hr?a:_a(br(a),0),s=s===Hr?s:br(s),u-=i?i.length:0,t&ri){var l=r,p=i;r=i=Hr}var d=c?Hr:Qa(e),f=[e,t,n,r,i,l,p,o,a,s];if(d&&fn(f,d),e=f[0],t=f[1],n=f[2],r=f[3],i=f[4],s=f[9]=null==f[9]?c?0:e.length:_a(f[9]-u,0),!s&&t&(ei|ti)&&(t&=~(ei|ti)),t&&t!=Yr)g=t==ei||t==ti?Nt(e,t,s):t!=ni&&t!=(Yr|ni)||i.length?Pt.apply(Hr,f):qt(e,t,n,r);else var g=xt(e,t,n);var h=d?Fa:Ja;return yn(h(g,f),e,t)}function Mt(e,t,n,r,i,o){var a=i&ci,s=e.length,c=t.length;if(s!=c&&!(a&&c>s))return!1;var u=o.get(e);if(u&&o.get(t))return u==t;var l=-1,d=!0,f=i&si?new ce:Hr;for(o.set(e,t),o.set(t,e);++l<s;){var g=e[l],h=t[l];if(r)var v=a?r(h,g,l,t,e,o):r(g,h,l,e,t,o);if(v!==Hr){if(v)continue;d=!1;break}if(f){if(!p(t,function(e,t){return C(f,t)||g!==e&&!n(g,e,r,i,o)?void 0:f.push(t)})){d=!1;break}}else if(g!==h&&!n(g,h,r,i,o)){d=!1;break}}return o["delete"](e),o["delete"](t),d}function jt(e,t,n,r,i,o,a){switch(n){case ji:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Mi:return e.byteLength==t.byteLength&&r(new ca(e),new ca(t))?!0:!1;case Ei:case Ci:case Ai:return er(+e,+t);case Ii:return e.name==t.name&&e.message==t.message;case ki:case qi:return e==t+"";case Ti:var s=A;case Pi:var c=o&ci;if(s||(s=N),e.size!=t.size&&!c)return!1;var u=a.get(e);if(u)return u==t;o|=si,a.set(e,t);var l=Mt(s(e),s(t),r,i,o,a);return a["delete"](e),l;case Li:if(ja)return ja.call(e)==ja.call(t)}return!1}function Ut(e,t,n,r,i,o){var a=i&ci,s=Or(e),c=s.length,u=Or(t),l=u.length;if(c!=l&&!a)return!1;for(var p=c;p--;){var d=s[p];if(!(a?d in t:ta.call(t,d)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var g=!0;o.set(e,t),o.set(t,e);for(var h=a;++p<c;){d=s[p];var v=e[d],m=t[d];if(r)var y=a?r(m,v,d,t,e,o):r(v,m,d,e,t,o);if(!(y===Hr?v===m||n(v,m,r,i,o):y)){g=!1;break}h||(h="constructor"==d)}if(g&&!h){var b=e.constructor,w=t.constructor;b!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(g=!1)}return o["delete"](e),o["delete"](t),g}function Vt(e){return Ka(hn(e,Hr,Tn),e+"")}function Bt(e){return qe(e,Or,Ga)}function zt(e){return qe(e,Tr,Wa)}function Ft(e){for(var t=e.name+"",n=Na[t],r=ta.call(Na,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function Ht(e){var t=ta.call(M,"placeholder")?M:e;return t.placeholder}function Qt(e,t){var n=e.__data__;return an(t)?n["string"==typeof t?"string":"hash"]:n.map}function Gt(e){for(var t=Or(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,ln(i)]}return t}function Wt(e,t){var n=S(e,t);return Qe(n)?n:Hr}function $t(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=Ea(t,e+a);break;case"takeRight":e=_a(e,t-a)}}return{start:e,end:t}}function Jt(e){var t=e.match(ro);return t?t[1].split(io):[]}function Kt(e,t,n){t=on(t,e)?[t]:lt(t);for(var r=-1,i=t.length,o=!1;++r<i;){var a=wn(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:(i=e?e.length:0,!!i&&cr(i)&&nn(a,i)&&(cs(e)||ss(e)))}function Yt(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&ta.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Xt(e){return"function"!=typeof e.constructor||un(e)?{}:Va(la(e))}function Zt(e,t,n,r){var i=e.constructor;switch(t){case Mi:return dt(e);case Ei:case Ci:return new i(+e);case ji:return ft(e,r);case Ui:case Vi:case Bi:case zi:case Fi:case Hi:case Qi:case Gi:case Wi:return yt(e,r);case Ti:return gt(e,r,n);case Ai:case qi:return new i(e);case ki:return ht(e);case Pi:return vt(e,r,n);case Li:return mt(e)}}function en(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(no,"{\n/* [wrapped with "+t+"] */\n")}function tn(e){return cs(e)||ss(e)||!!(ha&&e&&e[ha])}function nn(e,t){return t=null==t?hi:t,!!t&&("number"==typeof e||po.test(e))&&e>-1&&e%1==0&&t>e}function rn(e,t,n){if(!ur(n))return!1;var r=typeof t;return("number"==r?tr(n)&&nn(t,n.length):"string"==r&&t in n)?er(n[t],e):!1}function on(e,t){if(cs(e))return!1;var n=typeof e;return"number"==n||"symbol"==n||"boolean"==n||null==e||hr(e)?!0:Yi.test(e)||!Ki.test(e)||null!=t&&e in Object(t)}function an(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function sn(e){var t=Ft(e),n=M[t];if("function"!=typeof n||!(t in V.prototype))return!1;if(e===n)return!0;var r=Qa(n);return!!r&&e===r[0]}function cn(e){return!!Zo&&Zo in e}function un(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||Yo;return e===n}function ln(e){return e===e&&!ur(e)}function pn(e,t){return function(n){return null==n?!1:n[e]===t&&(t!==Hr||e in Object(n))}}function dn(e){var t=$n(e,function(e){return n.size===Jr&&n.clear(),e}),n=t.cache;return t}function fn(e,t){var n=e[1],r=t[1],i=n|r,o=(Yr|Xr|ii)>i,a=r==ii&&n==ei||r==ii&&n==oi&&e[7].length<=t[8]||r==(ii|oi)&&t[7].length<=t[8]&&n==ei;if(!o&&!a)return e;r&Yr&&(e[2]=t[2],i|=n&Yr?0:Zr);var s=t[3];if(s){var c=e[3];e[3]=c?_t(c,s,t[4]):s,e[4]=c?R(e[3],Kr):t[4]}return s=t[5],s&&(c=e[5],e[5]=c?Et(c,s,t[6]):s,e[6]=c?R(e[5],Kr):t[6]),s=t[7],s&&(e[7]=s),r&ii&&(e[8]=null==e[8]?t[8]:Ea(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e}function gn(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}function hn(e,t,r){return t=_a(t===Hr?e.length-1:t,0),function(){for(var i=arguments,o=-1,a=_a(i.length-t,0),s=Array(a);++o<a;)s[o]=i[t+o];o=-1;for(var c=Array(t+1);++o<t;)c[o]=i[o];return c[t]=r(s),n(e,this,c)}}function vn(e,t){return 1==t.length?e:Pe(e,at(t,0,-1))}function mn(e,t){for(var n=e.length,r=Ea(t.length,n),i=Ct(e);r--;){var o=t[r];e[r]=nn(o,n)?i[o]:Hr}return e}function yn(e,t,n){var r=t+"";return Ka(e,en(r,En(Jt(r),n)))}function bn(e){var t=0,n=0;return function(){var r=Ca(),i=li-(r-n);if(n=r,i>0){if(++t>=ui)return arguments[0]}else t=0;return e.apply(Hr,arguments)}}function wn(e){if("string"==typeof e||hr(e))return e;var t=e+"";return"0"==t&&1/e==-gi?"-0":t}function _n(e){if(null!=e){try{return ea.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function En(e,t){return r(bi,function(n){var r="_."+n[0];t&n[1]&&!a(e,r)&&e.push(r)}),e.sort()}function Cn(e){if(e instanceof V)return e.clone();var t=new U(e.__wrapped__,e.__chain__);return t.__actions__=Ct(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function In(e){for(var t=-1,n=e?e.length:0,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i}function Sn(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return u(cs(n)?Ct(n):[n],Re(t,1))}function On(e,t,n){var r=e?e.length:0;if(!r)return-1;var i=null==n?0:br(n);return 0>i&&(i=_a(r+i,0)),f(e,$e(t,3),i)}function Tn(e){var t=e?e.length:0;return t?Re(e,1):[]}function An(e){var t=e?e.length:0;return t?Re(e,gi):[]}function xn(e){return e&&e.length?e[0]:Hr}function Rn(e,t,n){var r=e?e.length:0;if(!r)return-1;var i=null==n?0:br(n);return 0>i&&(i=_a(r+i,0)),g(e,t,i)}function Nn(e){var t=e?e.length:0;return t?e[t-1]:Hr}function kn(e,t,n){var r=e?e.length:0;return r?(n&&"number"!=typeof n&&rn(e,t,n)?(t=0,n=r):(t=null==t?0:br(t),n=n===Hr?r:br(n)),at(e,t,n)):[]}function Pn(e){var t=M(e);return t.__chain__=!0,t}function qn(e,t){return t(e),e}function Ln(e,t){return t(e)}function Dn(){return this}function Mn(e,t,n){var r=cs(e)?i:Te;return n&&rn(e,t,n)&&(t=Hr),r(e,$e(t,3))}function jn(e,t){var n=cs(e)?o:xe;return n(e,$e(t,3))}function Un(e,t){var n=cs(e)?r:Ba;return n(e,$e(t,3))}function Vn(e,t,n,r){e=tr(e)?e:xr(e),n=n&&!r?br(n):0;var i=e.length;return 0>n&&(n=_a(i+n,0)),gr(e)?i>=n&&e.indexOf(t,n)>-1:!!i&&g(e,t,n)>-1}function Bn(e,t){var n=cs(e)?c:Xe;return n(e,$e(t,3))}function zn(e,t,n){var r=cs(e)?l:y,i=arguments.length<3;return r(e,$e(t,4),n,i,Ba)}function Fn(e,t){var n=cs(e)?o:xe;return n(e,Jn($e(t,3)))}function Hn(e){if(null==e)return 0;if(tr(e))return gr(e)?P(e):e.length;var t=$a(e);return t==Ti||t==Pi?e.size:Je(e).length}function Qn(e,t,n){var r=cs(e)?p:st;return n&&rn(e,t,n)&&(t=Hr),r(e,$e(t,3))}function Gn(e,t){var n;if("function"!=typeof t)throw new TypeError(Wr);return e=br(e),function(){return--e>0&&(n=t.apply(this,arguments)),1>=e&&(t=Hr),n}}function Wn(e,t,n){function r(t){var n=d,r=f;return d=f=Hr,y=t,h=e.apply(r,n)}function i(e){return y=e,v=setTimeout(s,t),b?r(e):h}function o(e){var n=e-m,r=e-y,i=t-n;return w?Ea(i,g-r):i}function a(e){var n=e-m,r=e-y;return m===Hr||n>=t||0>n||w&&r>=g}function s(){var e=ns();return a(e)?c(e):void(v=setTimeout(s,o(e)))}function c(e){return v=Hr,_&&d?r(e):(d=f=Hr,h)}function u(){v!==Hr&&clearTimeout(v),y=0,d=m=f=v=Hr}function l(){return v===Hr?h:c(ns())}function p(){var e=ns(),n=a(e);if(d=arguments,f=this,m=e,n){if(v===Hr)return i(m);if(w)return v=setTimeout(s,t),r(m)}return v===Hr&&(v=setTimeout(s,t)),h}var d,f,g,h,v,m,y=0,b=!1,w=!1,_=!0;if("function"!=typeof e)throw new TypeError(Wr);return t=wr(t)||0,ur(n)&&(b=!!n.leading,w="maxWait"in n,g=w?_a(wr(n.maxWait)||0,t):g,_="trailing"in n?!!n.trailing:_),p.cancel=u,p.flush=l,p}function $n(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(Wr);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new($n.Cache||ne),n}function Jn(e){if("function"!=typeof e)throw new TypeError(Wr);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Kn(e){return Gn(2,e)}function Yn(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError(Wr);return ur(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Wn(e,t,{leading:r,maxWait:t,trailing:i})}function Xn(e,t){return t=null==t?kr:t,as(t,e)}function Zn(e){return Ie(e,!1,!0)}function er(e,t){return e===t||e!==e&&t!==t}function tr(e){return null!=e&&cr(e.length)&&!sr(e)}function nr(e){return lr(e)&&tr(e)}function rr(e){return e===!0||e===!1||lr(e)&&ra.call(e)==Ei}function ir(e){if(tr(e)&&(cs(e)||"string"==typeof e||"function"==typeof e.splice||us(e)||ds(e)||ss(e)))return!e.length;var t=$a(e);if(t==Ti||t==Pi)return!e.size;if(un(e))return!Je(e).length;for(var n in e)if(ta.call(e,n))return!1;return!0}function or(e,t){return ze(e,t)}function ar(e){return"number"==typeof e&&ba(e)}function sr(e){var t=ur(e)?ra.call(e):"";return t==Si||t==Oi||t==Ni}function cr(e){return"number"==typeof e&&e>-1&&e%1==0&&hi>=e}function ur(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function lr(e){return null!=e&&"object"==typeof e}function pr(e){return fr(e)&&e!=+e}function dr(e){return null===e}function fr(e){return"number"==typeof e||lr(e)&&ra.call(e)==Ai}function gr(e){return"string"==typeof e||!cs(e)&&lr(e)&&ra.call(e)==qi}function hr(e){return"symbol"==typeof e||lr(e)&&ra.call(e)==Li}function vr(e){return e===Hr}function mr(e){if(!e)return[];if(tr(e))return gr(e)?q(e):Ct(e);if(pa&&e[pa])return T(e[pa]());var t=$a(e),n=t==Ti?A:t==Pi?N:xr;return n(e)}function yr(e){if(!e)return 0===e?e:0;if(e=wr(e),e===gi||e===-gi){var t=0>e?-1:1;return t*vi}return e===e?e:0}function br(e){var t=yr(e),n=t%1;return t===t?n?t-n:t:0}function wr(e){if("number"==typeof e)return e;if(hr(e))return mi;if(ur(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ur(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(to,"");var n=co.test(e);return n||lo.test(e)?Lo(e.slice(2),n?2:8):so.test(e)?mi:+e}function _r(e){return null==e?"":ct(e)}function Er(e,t){var n=Va(e);return t?_e(n,t):n}function Cr(e,t,n){var r=null==e?Hr:Pe(e,t);return r===Hr?n:r}function Ir(e,t){return null!=e&&Kt(e,t,Me)}function Sr(e,t){return null!=e&&Kt(e,t,je)}function Or(e){return tr(e)?me(e):Je(e)}function Tr(e){return tr(e)?me(e,!0):Ke(e)}function Ar(e,t,n){t=on(t,e)?[t]:lt(t);var r=-1,i=t.length;for(i||(e=Hr,i=1);++r<i;){var o=null==e?Hr:e[wn(t[r])];o===Hr&&(r=i,o=n),e=sr(o)?o.call(e):o}return e}function xr(e){return e?E(e,Or(e)):[]}function Rr(e){return e=_r(e),e&&Ji.test(e)?e.replace($i,$o):e}function Nr(e){return function(){return e}}function kr(e){return e}function Pr(e){return $e("function"==typeof e?e:Ie(e,!0))}function qr(e){return Ze(Ie(e,!0))}function Lr(e,t,n){var i=Or(t),o=ke(t,i);null!=n||ur(t)&&(o.length||!i.length)||(n=t,t=e,e=this,o=ke(t,Or(t)));var a=!(ur(n)&&"chain"in n&&!n.chain),s=sr(e);return r(o,function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__),i=n.__actions__=Ct(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,u([this.value()],arguments))})}),e}function Dr(){return jo._===this&&(jo._=ia),this}function Mr(){}function jr(e){return on(e)?v(wn(e)):it(e)}function Ur(){return[]}function Vr(){return!1}function Br(e){var t=++na;return _r(e)+t}function zr(e){return e&&e.length?Ae(e,kr,De):Hr}function Fr(e){return e&&e.length?Ae(e,kr,Ye):Hr}var Hr,Qr="4.16.4",Gr=200,Wr="Expected a function",$r="__lodash_hash_undefined__",Jr=500,Kr="__lodash_placeholder__",Yr=1,Xr=2,Zr=4,ei=8,ti=16,ni=32,ri=64,ii=128,oi=256,ai=512,si=1,ci=2,ui=500,li=16,pi=1,di=2,fi=3,gi=1/0,hi=9007199254740991,vi=1.7976931348623157e308,mi=NaN,yi=4294967295,bi=[["ary",ii],["bind",Yr],["bindKey",Xr],["curry",ei],["curryRight",ti],["flip",ai],["partial",ni],["partialRight",ri],["rearg",oi]],wi="[object Arguments]",_i="[object Array]",Ei="[object Boolean]",Ci="[object Date]",Ii="[object Error]",Si="[object Function]",Oi="[object GeneratorFunction]",Ti="[object Map]",Ai="[object Number]",xi="[object Object]",Ri="[object Promise]",Ni="[object Proxy]",ki="[object RegExp]",Pi="[object Set]",qi="[object String]",Li="[object Symbol]",Di="[object WeakMap]",Mi="[object ArrayBuffer]",ji="[object DataView]",Ui="[object Float32Array]",Vi="[object Float64Array]",Bi="[object Int8Array]",zi="[object Int16Array]",Fi="[object Int32Array]",Hi="[object Uint8Array]",Qi="[object Uint8ClampedArray]",Gi="[object Uint16Array]",Wi="[object Uint32Array]",$i=/[&<>"']/g,Ji=RegExp($i.source),Ki=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yi=/^\w*$/,Xi=/^\./,Zi=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,eo=/[\\^$.*+?()[\]{}|]/g,to=/^\s+|\s+$/g,no=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ro=/\{\n\/\* \[wrapped with (.+)\] \*/,io=/,? & /,oo=/\\(\\)?/g,ao=/\w*$/,so=/^[-+]0x[0-9a-f]+$/i,co=/^0b[01]+$/i,uo=/^\[object .+?Constructor\]$/,lo=/^0o[0-7]+$/i,po=/^(?:0|[1-9]\d*)$/,fo="\\ud800-\\udfff",go="\\u0300-\\u036f\\ufe20-\\ufe23",ho="\\u20d0-\\u20f0",vo="\\ufe0e\\ufe0f",mo="["+fo+"]",yo="["+go+ho+"]",bo="\\ud83c[\\udffb-\\udfff]",wo="(?:"+yo+"|"+bo+")",_o="[^"+fo+"]",Eo="(?:\\ud83c[\\udde6-\\uddff]){2}",Co="[\\ud800-\\udbff][\\udc00-\\udfff]",Io="\\u200d",So=wo+"?",Oo="["+vo+"]?",To="(?:"+Io+"(?:"+[_o,Eo,Co].join("|")+")"+Oo+So+")*",Ao=Oo+So+To,xo="(?:"+[_o+yo+"?",yo,Eo,Co,mo].join("|")+")",Ro=RegExp(bo+"(?="+bo+")|"+xo+Ao,"g"),No=RegExp("["+Io+fo+go+ho+vo+"]"),ko={};ko[Ui]=ko[Vi]=ko[Bi]=ko[zi]=ko[Fi]=ko[Hi]=ko[Qi]=ko[Gi]=ko[Wi]=!0,ko[wi]=ko[_i]=ko[Mi]=ko[Ei]=ko[ji]=ko[Ci]=ko[Ii]=ko[Si]=ko[Ti]=ko[Ai]=ko[xi]=ko[ki]=ko[Pi]=ko[qi]=ko[Di]=!1;var Po={};Po[wi]=Po[_i]=Po[Mi]=Po[ji]=Po[Ei]=Po[Ci]=Po[Ui]=Po[Vi]=Po[Bi]=Po[zi]=Po[Fi]=Po[Ti]=Po[Ai]=Po[xi]=Po[ki]=Po[Pi]=Po[qi]=Po[Li]=Po[Hi]=Po[Qi]=Po[Gi]=Po[Wi]=!0,Po[Ii]=Po[Si]=Po[Di]=!1;var qo={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Lo=parseInt,Do="object"==typeof global&&global&&global.Object===Object&&global,Mo="object"==typeof self&&self&&self.Object===Object&&self,jo=Do||Mo||Function("return this")(),Uo="object"==typeof exports&&exports&&!exports.nodeType&&exports,Vo=Uo&&"object"==typeof module&&module&&!module.nodeType&&module,Bo=Vo&&Vo.exports===Uo,zo=Bo&&Do.process,Fo=function(){try{return zo&&zo.binding("util")}catch(e){}}(),Ho=Fo&&Fo.isDate,Qo=Fo&&Fo.isRegExp,Go=Fo&&Fo.isTypedArray,Wo=v("length"),$o=m(qo),Jo=Array.prototype,Ko=Function.prototype,Yo=Object.prototype,Xo=jo["__core-js_shared__"],Zo=function(){var e=/[^.]+$/.exec(Xo&&Xo.keys&&Xo.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ea=Ko.toString,ta=Yo.hasOwnProperty,na=0,ra=Yo.toString,ia=jo._,oa=RegExp("^"+ea.call(ta).replace(eo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),aa=Bo?jo.Buffer:Hr,sa=jo.Symbol,ca=jo.Uint8Array,ua=aa?aa.allocUnsafe:Hr,la=x(Object.getPrototypeOf,Object),pa=sa?sa.iterator:Hr,da=Object.create,fa=Yo.propertyIsEnumerable,ga=Jo.splice,ha=sa?sa.isConcatSpreadable:Hr,va=function(){try{var e=Wt(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),ma=Object.getOwnPropertySymbols,ya=aa?aa.isBuffer:Hr,ba=jo.isFinite,wa=x(Object.keys,Object),_a=Math.max,Ea=Math.min,Ca=Date.now,Ia=(Jo.reverse,Wt(jo,"DataView")),Sa=Wt(jo,"Map"),Oa=Wt(jo,"Promise"),Ta=Wt(jo,"Set"),Aa=Wt(jo,"WeakMap"),xa=Wt(Object,"create"),Ra=Aa&&new Aa,Na={},ka=_n(Ia),Pa=_n(Sa),qa=_n(Oa),La=_n(Ta),Da=_n(Aa),Ma=sa?sa.prototype:Hr,ja=Ma?Ma.valueOf:Hr,Ua=Ma?Ma.toString:Hr,Va=function(){function e(){}return function(t){if(!ur(t))return{};if(da)return da(t);e.prototype=t;var n=new e;return e.prototype=Hr,n}}();M.prototype=j.prototype,M.prototype.constructor=M,U.prototype=Va(j.prototype),U.prototype.constructor=U,V.prototype=Va(j.prototype),V.prototype.constructor=V,H.prototype.clear=Q,H.prototype["delete"]=G,H.prototype.get=W,H.prototype.has=$,H.prototype.set=J,K.prototype.clear=Y,K.prototype["delete"]=X,K.prototype.get=Z,K.prototype.has=ee,K.prototype.set=te,ne.prototype.clear=re,ne.prototype["delete"]=ie,ne.prototype.get=oe,ne.prototype.has=ae,ne.prototype.set=se,ce.prototype.add=ce.prototype.push=ue,ce.prototype.has=le,pe.prototype.clear=de,pe.prototype["delete"]=fe,pe.prototype.get=ge,pe.prototype.has=he,pe.prototype.set=ve;var Ba=Tt(Ne),za=At(),Fa=Ra?function(e,t){return Ra.set(e,t),e}:kr,Ha=va?function(e,t){return va(e,"toString",{configurable:!0,enumerable:!1,value:Nr(t),writable:!0})}:kr,Qa=Ra?function(e){return Ra.get(e)}:Mr,Ga=ma?x(ma,Object):Ur,Wa=ma?function(e){for(var t=[];e;)u(t,Ga(e)),e=la(e);return t}:Ur,$a=Le;(Ia&&$a(new Ia(new ArrayBuffer(1)))!=ji||Sa&&$a(new Sa)!=Ti||Oa&&$a(Oa.resolve())!=Ri||Ta&&$a(new Ta)!=Pi||Aa&&$a(new Aa)!=Di)&&($a=function(e){var t=ra.call(e),n=t==xi?e.constructor:Hr,r=n?_n(n):Hr;if(r)switch(r){case ka:return ji;case Pa:return Ti;case qa:return Ri;case La:return Pi;case Da:return Di}return t});var Ja=bn(Fa),Ka=bn(Ha),Ya=dn(function(e){e=_r(e);var t=[];return Xi.test(e)&&t.push(""),e.replace(Zi,function(e,n,r,i){t.push(r?i.replace(oo,"$1"):n||e)}),t}),Xa=ot(function(e,t){return nr(e)?Oe(e,Re(t,1,nr,!0)):[]}),Za=(Vt(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return Ce(t,e)};return!(t>1||this.__actions__.length)&&r instanceof V&&nn(n)?(r=r.slice(n,+n+(t?1:0)),r.__actions__.push({func:Ln,args:[i],thisArg:Hr}),new U(r,this.__chain__).thru(function(e){return t&&!e.length&&e.push(Hr),e})):this.thru(i)}),kt(On)),es=ot(function(e,t,r){var i=-1,o="function"==typeof t,a=on(t),s=tr(e)?Array(e.length):[];return Ba(e,function(e){var c=o?t:a&&null!=e?e[t]:Hr;s[++i]=c?n(c,e,r):Ue(e,t,r)}),s}),ts=ot(function(e,t){if(null==e)return[];var n=t.length;return n>1&&rn(e,t[0],t[1])?t=[]:n>2&&rn(t[0],t[1],t[2])&&(t=[t[0]]),tt(e,Re(t,1),[])}),ns=function(){return jo.Date.now()},rs=ot(function(e,t,n){var r=Yr;if(n.length){var i=R(n,Ht(rs));r|=ni}return Dt(e,r,t,n,i)}),is=ot(function(e,t){return Se(e,1,t)}),os=ot(function(e,t,n){return Se(e,wr(t)||0,n)});$n.Cache=ne;var as=ot(function(e,t){var n=R(t,Ht(as));return Dt(e,ni,Hr,t,n)}),ss=Ve(function(){return arguments}())?Ve:function(e){return lr(e)&&ta.call(e,"callee")&&!fa.call(e,"callee")},cs=Array.isArray,us=ya||Vr,ls=Ho?_(Ho):Be,ps=Qo?_(Qo):Ge,ds=Go?_(Go):We,fs=Ot(function(e,t){It(t,Tr(t),e)}),gs=Ot(function(e,t,n,r){It(t,Tr(t),e,r)}),hs=ot(function(e){return e.push(Hr,ye),n(gs,Hr,e)}),vs=ot(Ue),ms=Vt(function(e,t){return null==e?{}:(t=c(t,wn),nt(e,Oe(zt(e),t)))}),ys=Vt(function(e,t){return null==e?{}:nt(e,c(t,wn))}),bs=Vt(function(e,t){return r(t,function(t){t=wn(t),Ee(e,t,rs(e[t],e))}),e});M.assignIn=fs,M.before=Gn,M.bind=rs,M.bindAll=bs,M.chain=Pn,M.compact=In,M.concat=Sn,M.create=Er,M.debounce=Wn,M.defaults=hs,M.defer=is,M.delay=os,M.difference=Xa,M.filter=jn,M.flatten=Tn,M.flattenDeep=An,M.invokeMap=es,M.iteratee=Pr,M.keys=Or,M.map=Bn,M.matches=qr,M.memoize=$n,M.mixin=Lr,M.negate=Jn,M.omit=ms,M.once=Kn,M.pick=ys,M.reject=Fn,M.slice=kn,M.sortBy=ts,M.tap=qn,M.throttle=Yn,M.thru=Ln,M.toArray=mr,M.values=xr,M.wrap=Xn,M.extend=fs,Lr(M,M),M.clone=Zn,M.escape=Rr,M.every=Mn,M.find=Za,M.forEach=Un,M.has=Ir,M.head=xn,M.identity=kr,M.includes=Vn,M.indexOf=Rn,M.invoke=vs,M.isArguments=ss,M.isArray=cs,M.isBoolean=rr,M.isDate=ls,M.isEmpty=ir,M.isEqual=or,M.isFinite=ar,M.isFunction=sr,M.isNaN=pr,M.isNull=dr,M.isNumber=fr,M.isObject=ur,M.isRegExp=ps,M.isString=gr,M.isUndefined=vr,M.last=Nn,M.max=zr,M.min=Fr,M.noConflict=Dr,M.noop=Mr,M.reduce=zn,M.result=Ar,M.size=Hn,M.some=Qn,M.uniqueId=Br,M.each=Un,M.first=xn,Lr(M,function(){var e={};return Ne(M,function(t,n){ta.call(M.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),M.VERSION=Qr,r(["drop","take"],function(e,t){V.prototype[e]=function(n){var r=this.__filtered__;if(r&&!t)return new V(this);n=n===Hr?1:_a(br(n),0);var i=this.clone();return r?i.__takeCount__=Ea(n,i.__takeCount__):i.__views__.push({size:Ea(n,yi),type:e+(i.__dir__<0?"Right":"")}),i},V.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),r(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n==pi||n==fi;V.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:getIteratee(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),r(["head","last"],function(e,t){var n="take"+(t?"Right":"");V.prototype[e]=function(){return this[n](1).value()[0]}}),r(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");V.prototype[e]=function(){return this.__filtered__?new V(this):this[n](1)}}),V.prototype.compact=function(){return this.filter(kr)},V.prototype.find=function(e){return this.filter(e).head()},V.prototype.findLast=function(e){return this.reverse().find(e)},V.prototype.invokeMap=ot(function(e,t){return"function"==typeof e?new V(this):this.map(function(n){return Ue(n,e,t)})}),V.prototype.reject=function(e){return this.filter(Jn(getIteratee(e)))},V.prototype.slice=function(e,t){e=br(e);var n=this;return n.__filtered__&&(e>0||0>t)?new V(n):(0>e?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==Hr&&(t=br(t),n=0>t?n.dropRight(-t):n.take(t-e)),n)},V.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},V.prototype.toArray=function(){return this.take(yi)},Ne(V.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=M[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(M.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,s=t instanceof V,c=a[0],l=s||cs(t),p=function(e){var t=i.apply(M,u([e],a));return r&&d?t[0]:t};l&&n&&"function"==typeof c&&1!=c.length&&(s=l=!1);var d=this.__chain__,f=!!this.__actions__.length,g=o&&!d,h=s&&!f;if(!o&&l){t=h?t:new V(this);var v=e.apply(t,a);return v.__actions__.push({func:Ln,args:[p],thisArg:Hr}),new U(v,d)}return g&&h?e.apply(this,a):(v=this.thru(p),g?r?v.value()[0]:v.value():v)})}),r(["pop","push","shift","sort","splice","unshift"],function(e){var t=Jo[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);M.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(cs(i)?i:[],e)}return this[n](function(n){return t.apply(cs(n)?n:[],e)})}}),Ne(V.prototype,function(e,t){var n=M[t];if(n){var r=n.name+"",i=Na[r]||(Na[r]=[]);i.push({name:t,func:n})}}),Na[Pt(Hr,Xr).name]=[{name:"wrapper",func:Hr}],V.prototype.clone=B,V.prototype.reverse=z,V.prototype.value=F,M.prototype.first=M.prototype.head,pa&&(M.prototype[pa]=Dn),"function"==typeof vngageapp.define&&"object"==typeof vngageapp.define.amd&&vngageapp.define.amd?(jo._=M,vngageapp.define("underscore",[],function(){return M})):Vo?((Vo.exports=M)._=M,Uo._=M):jo._=M}.call(this),vngageapp.define("lodashNoConflict",["underscore"],function(e){return e.noConflict()}),vngageapp.define("runtime",["require","vergic.environment","underscore"],function(e){"use strict";function t(e){return e?parseFloat(e.slice(0,3),10):0}function n(e){return s.includes(e,a.browser.engine)}function r(e,n){var r=t(a.browser.version)>=e;return r&&a.browser[n]}function i(e){var i=c[e],o=n(i.engines),u="android"===e&&!a.os.version&&o,l=u||t(a.os.version)>=i.version,p=l&&a.os.ios&&a.browser.webkit||!!s.filter(i.browsers,r).length;return l&&p&&o}function o(e){return e&&(a=e),a.os.android?i("android"):a.os.ios?i("ios"):a.os.ios||a.os.android||!a.os.touch?!!s.filter(c.browsers,r).length:a.browser.edge?!0:a.os.firefoxos?i("firefoxos"):!1}var a=e("vergic.environment"),s=e("underscore"),c={browsers:{ie:9,chrome:13,firefox:8,opera:9,safari:5},ios:{version:7,browsers:{safari:0,chrome:0},engines:["webkit"]},android:{version:4.2,browsers:{firefox:39,chrome:14},engines:["webkit","mozilla"]},firefoxos:{version:39,browsers:{firefox:39},engines:["mozilla"]}};return{approve:o}}),vngageapp.define("appConfig",["require","underscore"],function(e){"use strict";var t=e("underscore");return{sites:[],setCurrentSiteId:function(e){var n=this;(e||n.sites.length)&&(e||(e=n.sites[0].id),n.currentSiteId=e,n.currentSite=t.find(n.sites,{id:n.currentSiteId}),n.currentSite.themeId&&(n.themes.dialog=n.currentSite.themeId))},getVisitorLanguage:function(){var e=this.currentSite.languageCode||"en-GB";return this.translations[e]},currentSiteId:null,currentSite:null,account:{},visitor:{},panel:{},themes:{banners:null,dialog:null},translations:{},comm:{host:"",restUrl:"",commUrl:"",assetPath:"",domainWhiteList:null,visitorIdAuthProxyUrl:null,visitorIdLoggedInDetectionKeyword:null,visitorIdLoggedInDetectionVariable:null,jsPath:null,transportDomains:[]}}}),vngageapp.define("services/siteSetter",["require","appConfig"],function(e){"use strict";function t(){window.psSetLanguage?n.setCurrentSiteId(window.psSetLanguage):n.setCurrentSiteId(n.visitor.defaultSiteId),n.currentSite||n.setCurrentSiteId()}var n=e("appConfig");return{evaluate:t}}),vngageapp.define("core/vngage/getQueryParameter",[],function(){"use strict";
return function(e){var t,n,r=window.location.search.substring(1),i=r.split("&"),o=i.length;for(t=0;o>t;t++)if(n=i[t].split("="),n[0]===e){if("replaceState"in window.history){var a=new RegExp("(&)?("+e+"=[^&]*)"),s=location.href.replace(a,"");"?"===s.charAt(s.length-1)&&(s=s.substring(0,s.length-1)),window.history.replaceState({},null,s)}return n[1]?n[1]:null}return void 0}}),function(e){function t(){this._callbacks=[]}function n(e){function n(e){return function(){o+=1,i[e]=Array.prototype.slice.call(arguments),o===a&&r.done(i)}}var r=new t,i=[];if(!e||!e.length)return r.done(i),r;for(var o=0,a=e.length,s=0;a>s;s++)e[s].then(n(s));return r}function r(e,n){var i=new t;return 0===e.length?i.done.apply(i,n):e[0].apply(null,n).then(function(){e.splice(0,1),r(e,arguments).then(function(){i.done.apply(i,arguments)})}),i}function i(e){var t="";if("string"==typeof e)t=e;else{var n=encodeURIComponent;for(var r in e)e.hasOwnProperty(r)&&(t+="&"+n(r)+"="+n(e[r]))}return t}function o(){var e;if(window.XMLHttpRequest)e=new XMLHttpRequest;else if(window.ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){e=new ActiveXObject("Microsoft.XMLHTTP")}return a(e)&&(e=new XDomainRequest),e}function a(e){return!("withCredentials"in e)&&"undefined"!=typeof XDomainRequest}function s(e,n,r,s){function c(){d.abort(),g.done(u.ETIMEOUT,"",d)}function l(){g.done(u.ENOXHR,"",{status:u.ENOXHR})}function p(){if(m&&clearTimeout(y),4===d.readyState){1223===d.status&&(d.status=204,d.statusText="No Content");var e=!d.status||(d.status<200||d.status>=300)&&304!==d.status;g.done(e,d.responseText,d)}else!d.readyState&&d.responseText&&g.done(null,d.responseText,d)}var d,f,g=new t;r=r||{},s=s||{};try{d=o()}catch(h){return g.done(u.ENOXHR,""),g}if(f=i(r),"GET"===e&&f&&(n+="?"+f,f=null),a(d)&&(n+=n.indexOf("?")>0?"&json=true":"?json=true",n=n.replace(/^(https|http):\/\//,"//")),d.open(e,n,!0),d.withCredentials=!0,"setRequestHeader"in d){"undefined"==typeof s["Content-type"]&&(d.setRequestHeader("Accept","application/json"),d.setRequestHeader("Content-type","text/plain; charset=utf-8"));for(var v in s)s.hasOwnProperty(v)&&d.setRequestHeader(v,s[v])}var m=u.ajaxTimeout;if(m)var y=setTimeout(c,m);return"timeout"in d&&(d.timeout=m),"onreadystatechange"in d?d.onreadystatechange=p:"onload"in d&&(d.onload=p,d.onerror=l),f?d.send(f):d.send(),g}function c(e){return function(t,n,r){return s(e,t,n,r)}}t.prototype.then=function(e,n){var r;return this._isdone?r=e.apply(n,this.result):(r=new t,this._callbacks.push(function(){var t=e.apply(n,arguments);t&&"function"==typeof t.then&&t.then(r.done,r)})),r},t.prototype.done=function(){this.result=arguments,this._isdone=!0;for(var e=0;e<this._callbacks.length;e++)this._callbacks[e].apply(null,arguments);this._callbacks=[]};var u={Promise:t,join:n,chain:r,ajax:s,get:c("GET"),post:c("POST"),put:c("PUT"),del:c("DELETE"),ENOXHR:1,ETIMEOUT:2,ajaxTimeout:2e4};"function"==typeof vngageapp.define&&vngageapp.define.amd?vngageapp.define("promise",[],function(){return u}):e.promise=u}(this),vngageapp.define("models/site",[],function(){"use strict";return{id:null,languageCode:null,name:null,opportunities:{},groups:{},poi:{},solutions:{},banners:{},translations:{}}}),vngageapp.define("services/configurationMap",["require","underscore","promise","appConfig","models/site"],function(require){"use strict";function sites(e){_.each(e,function(e){var t=Object.create(Site);t.id=e.id,t.name=e.name,t.languageCode=e.languageCode,t.baseDomain=e.baseDomain,AppConfig.sites.push(t)})}function dialogTheme(){AppConfig.themes.dialog=AppConfig.visitor.themeId}function groups(e){_.each(AppConfig.sites,function(t){var n={};_.each(e,function(e){if(e.siteId.toUpperCase()===t.id.toUpperCase()){var r=e.id;n[r]=e}}),t.groups=n})}function pointOfInterests(e){_.each(AppConfig.sites,function(t){var n={};_.each(e,function(e){if(e.siteId.toUpperCase()===t.id.toUpperCase()){var r=e.id;n[r]=e}}),t.poi=n})}function opportunities(e){_.each(AppConfig.sites,function(t){var n={};_.each(e,function(e){if(e.siteId.toUpperCase()===t.id.toUpperCase()){var r=e.id;n[r]=e}}),t.opportunities=n})}function scripts(val){vngage.extensions=vngage.extensions||{},val&&val[0]&&val[0].script&&eval("vngage.extensions.accountMethods = function(_, DOM) { "+val[0].script+" }")}function solutions(e){_.each(AppConfig.sites,function(t){var n={};_.each(e,function(e){if(e.siteId.toUpperCase()===t.id.toUpperCase()){var r=e.id;n[r]=e}}),t.solutions=n})}function banners(e){_.each(AppConfig.sites,function(t){var n={};_.each(e,function(e){if(e.siteId.toUpperCase()===t.id.toUpperCase()){var r=e.id;n[r]=e}}),t.banners=n})}function bannerThemes(e){e&&e[0]&&e[0].section&&(AppConfig.themes.banners=e[0].section.css)}function translations(e){e&&(AppConfig.translations=e)}function configurationSections(e){var t=_.filter(e,{type:"banner"});banners(t);var n=_.filter(e,{type:"bannerTheme"});bannerThemes(n);var r=_.filter(e,{type:"solution"});solutions(r);var i=_.filter(e,{type:"opportunity"});opportunities(i);var o=_.find(e,{type:"accountSettings"});AppConfig.account=o?o.section:{};var a=_.find(e,{type:"visitor"});AppConfig.visitor=a?a.section:{};var s=_.find(e,{type:"panelSettings"});AppConfig.panel=s?s.section:{}}function comm(e){e&&(AppConfig.comm=e)}function pickData(e){return _.map(e,function(e){return e.data})}var _=require("underscore"),promise=require("promise"),AppConfig=require("appConfig"),Site=require("models/site");return function(e){var t=new promise.Promise;return comm(e.comm),sites(pickData(e.sites)),scripts(pickData(e.scripts)),groups(pickData(e.groups)),pointOfInterests(pickData(e.pointOfInterests)),translations(e.translations),configurationSections(pickData(e.configurationSections)),dialogTheme(),t.done(null,e),t}}),vngageapp.define("core/common/json",["require","underscore"],function(e){"use strict";function t(){var e={},t={a:[1,2,3]},n='{"a":[1,2,3]}';return JSON&&"function"==typeof JSON.stringify&&JSON.stringify(t).replace(/\s/g,"")===n?JSON:(Object.toJSON&&Object.toJSON(t).replace(/\s/g,"")===n&&(e.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(t=n.evalJSON(),t.a&&3===t.a.length&&3===t.a[2]&&(e.parse=function(e){return e.evalJSON()})),e.stringify&&e.parse?e:{stringify:function(){},parse:function(){}})}var n=e("underscore"),r=n.memoize(t);return r()}),vngageapp.define("core/vngage/configuration",["require","promise","services/configurationMap","core/common/json"],function(e){"use strict";function t(e){var t=localStorage.getItem(u),i=t&&""!==t?c.parse(t):!1,o=new Date,a=e.revision>-1?e.revision:!1;return a?n(a,o):i&&o.getTime()-i.ts<9e6?a=i.revision:r(),a}function n(e,t){localStorage.setItem(u,c.stringify({ts:t.getTime(),revision:e}))}function r(){localStorage.removeItem(u)}function i(e,n,r){var i,o=new a.Promise,u=t(r);return vngage.config&&!u?s(vngage.config).then(function(){o.done(null)}):u?(i="?revision="+u+"&SessionId="+encodeURIComponent(n),a.get(e+"ConfigurationSet/Resolved/master"+i).then(function(e,t){return e?o.done(e):(t=c.parse(t),vngage.info=vngage.info||{},vngage.info.revision=parseInt(u,10),delete t.translations,s(t))}).then(function(e,t){e?o.done(e):o.done(null,t)})):o.done("norevision"),o}function o(e){s(e)}var a=e("promise"),s=e("services/configurationMap"),c=e("core/common/json"),u="vngage.accountrevision";return{get:i,set:o,clearRevision:r}}),vngageapp.define("pubsub",[],function(){"use strict";function e(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}function t(e){return function(){throw e}}function n(e,n,r){try{e(n,r)}catch(i){setTimeout(t(i),0)}}function r(e,t,n){e(t,n)}function i(e,t,i,o){var a,s=u[t],c=o?r:n;if(u.hasOwnProperty(t))for(a in s)s.hasOwnProperty(a)&&c(s[a],e,i)}function o(e,t,n){return function(){var r=String(e),o=r.lastIndexOf(".");for(i(e,e,t,n);-1!==o;)r=r.substr(0,o),o=r.lastIndexOf("."),i(e,r,t,n)}}function a(t){for(var n=String(t),r=Boolean(u.hasOwnProperty(n)&&e(u[n])),i=n.lastIndexOf(".");!r&&-1!==i;)n=n.substr(0,i),i=n.lastIndexOf("."),r=Boolean(u.hasOwnProperty(n)&&e(u[n]));return r}function s(e,t,n,r){var i=o(e,t,r),s=a(e);return s?(n===!0?i():setTimeout(i,0),!0):!1}var c={},u={},l=-1;return c.publish=function(e,t){return s(e,t,!1,c.immediateExceptions)},c.publishSync=function(e,t){return s(e,t,!0,c.immediateExceptions)},c.subscribe=function(e,t){if("function"!=typeof t)return!1;u.hasOwnProperty(e)||(u[e]={});var n="uid_"+String(++l);return u[e][n]=t,n},c.clearAllSubscriptions=function(){u={}},c.clearSubscriptions=function(e){var t;for(t in u)u.hasOwnProperty(t)&&0===t.indexOf(e)&&delete u[t]},c.unsubscribe=function(e){var t,n,r,i="string"==typeof e&&u.hasOwnProperty(e),o=!i&&"string"==typeof e,a="function"==typeof e,s=!1;if(i)return void delete u[e];for(t in u)if(u.hasOwnProperty(t)){if(n=u[t],o&&n[e]){delete n[e],s=e;break}if(a)for(r in n)n.hasOwnProperty(r)&&n[r]===e&&(delete n[r],s=!0)}return s},c}),vngageapp.define("core/vngage/eventsVO",[],function(){"use strict";return{APP_READY:"app.ready",APP_STOP:"app.stop",APP_CLOSE:"application.close",BANNER_ADD:"banner:add",BANNER_RENDERED:"banner:rendered",BANNER_JOIN:"banner:join",BANNER_INTRO:"banner:intro",BANNER_CLOSE:"banner:close",BANNER_REMOVE:"banner:remove",BANNER_REMOVEALL:"banner:removeAll",BANNER_STATUS:"banner:status",BANNER_STATUS_UPDATE:"banner:status.update",BANNER_OVERLAY_CLICK:"banner:overlay.click",BANNER_QUARANTINE:"banner:quarantine",BANNERS_RENDER:"banners:render",BLOCK:"block",CLOSE:"close",CONNECTION_CHANGE:"connection:change",CONNECTION_STARTED:"connection:started",QUEUE_JOIN:"queue:join",QUEUE_JOINED:"queue:joined",QUEUE_LEAVE:"queue:leave",QUEUESTATUS_CHANGE:"queue:change.status",QUEUESTATUS_UPDATE:"queue:update.status",QUEUE_INFO:"queue.info",CONFIGURATION_READY:"configuration:ready",CONFIGURATION_CHANGE:"configuration:change",DIALOG_END:"dialog:end",DIALOG_CLOSE:"dialog:close",DIALOG_INVITE:"dialog:invite",DIALOG_APPROVE:"dialog:approve",DIALOG_REJECT:"dialog:reject",DIALOG_DECLINE:"dialog:decline",DIALOG_RESUME:"dialog:resume",DIALOG_RESUMED:"dialog:resumed",DIALOG_NAVIGATE:"dialog:navigate",DIALOG_EMAIL_HISTORY:"dialog:email.chathistory",DIALOG_SEND_MESSAGE:"dialog:send.message",DIALOG_VISITORTYPING:"dialog:visitorTyping",DIALOG_CHATHISTORY:"dialog:receive.history",PENDING_TIMEOUT:"pending:timeout",ERROR:"app:error",ERROR_JOINQUEUE:"app:error.joinqueue",ERROR_ALREADYINQUEUE:"app:error.alreadyinqueue",ERROR_UNKNOWNVISITOR:"app:error.unknownvisitor",ERROR_INVALID_STARTCODE:"app:error.invalidStartCode",ERROR_CONNECTION:"app:error.connection",ERROR_TOKENMISMATCH:"app:error.tokenmismatch",ERROR_TRANSFER:"app:error.transfer",LEGACY_ACTION:"legacyActionEvent",PDFCAPTURE_VERIFY:"pdfCapture:verify",PDFCAPTURE_UPDATE:"pdfCapture:update",PDFCAPTURE_BROWSER:"pdfCapture:browser",PDFCAPTURE_INITIATE:"pdfCapture:initiate",PDFCAPTURE_CLOSE:"pdfCapture:close",VIDEO_START:"videochat:start",VIDEO_STOP:"videochat:stop",VIDEO_EXTERNAL:"__p__",REQUEST_NOOP:"connection:noop",STATE_CHANGE:"change:state",STATEMACHINE_STARTED:"stateMachineStarted",RECEIVE_AS_STATE:"recieve_as_state",RECEIVE_SINCE:"recieve_since",CREATE_MESSAGE:"create_message",PARTICIPANT_BROWSERINFO:"participant_browserInfo",PARTICIPANT_ACTIVITY:"participant_activity",PARTICIPANT_JOINED:"participant_joined",PARTICIPANT_LEFT:"participant_left",PARTICIPANTS_STORE:"participants_store",EVENT_STORE:"event_store",COBROWSER_HIGHLIGHT:"coBrowser.highlight",COBROWSER_AGENT_NAVIGATED:"cobrowser_agent_navigated",COBROWSER_VISITOR_NAVIGATED_LINK:"cobrowser_visitor_navigated_link",COBROWSER_DOMUPLOAD:"coBrowser.domUpload",CONVERSATION_STARTED:"conversation_started",CONVERSATION_CLOSED:"conversation_closed",CONVERSATION_SUSPENDED:"conversation_suspended",CONVERSATION_RESUMED:"conversation_resumed",CONVERSATION_UNAUTHORIZED:"conversation_unauthorized",MESSAGE_RECEIVED:"message_received",MODAL_CREATE:"modal:create"}}),vngageapp.define("batchrequest",["require","underscore","appConfig"],function(e){"use strict";var t=e("underscore"),n=e("appConfig");return function(e){var r={items:[]};return t.each(e,function(e){var t={contentHeaders:{"Content-type":"application/json"},method:e.method,uri:n.comm.restUrl+e.uri,body:e.body,tag:e.tag};r.items.push(t)}),r}}),vngageapp.define("services/legacyNoop",["require","promise"],function(e){"use strict";function t(e){var t=new n.Promise,r=document.createElement("iframe");return r.src=e,document.body.appendChild(r),document.body.removeChild(r),r=null,t.done(null),t}var n=e("promise");return{ping:t}}),function(e){"use strict";var t=function(e,n,r){return 1===arguments.length?t.get(e):t.set(e,n,r)};t._document=document,t._navigator=navigator,t.defaults={path:"/"},t.get=function(e){return t._cachedDocumentCookie!==t._document.cookie&&t._renewCache(),t._cache[e]},t.set=function(n,r,i){return i=t._getExtendedOptions(i),i.expires=t._getExpiresDate(r===e?-1:i.expires),t._document.cookie=t._generateCookieString(n,r,i),t},t.expire=function(n,r){return t.set(n,e,r)},t._getExtendedOptions=function(n){return{path:n&&n.path||t.defaults.path,domain:n&&n.domain||t.defaults.domain,expires:n&&n.expires||t.defaults.expires,secure:n&&n.secure!==e?n.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){switch(n=n||new Date,typeof e){case"number":e=new Date(n.getTime()+1e3*e);break;case"string":e=new Date(e)}if(e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){e=encodeURIComponent(e),t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),n=n||{};var r=e+"="+t;return r+=n.path?";path="+n.path:"",r+=n.domain?";domain="+n.domain:"",r+=n.expires?";expires="+n.expires.toUTCString():"",r+=n.secure?";secure":""},t._getCookieObjectFromString=function(n){for(var r={},i=n?n.split("; "):[],o=0;o<i.length;o++){var a=t._getKeyValuePairFromCookieString(i[o]);r[a.key]===e&&(r[a.key]=a.value)}return r},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");t=0>t?e.length:t;try{return{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}}catch(n){return{key:"",value:""}}},t._renewCache=function(){t._cache=t._getCookieObjectFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){return t._navigator.cookieEnabled||"1"===t.set("cookies.js",1).get("cookies.js")},t.enabled=t._areEnabled(),"function"==typeof vngageapp.define&&vngageapp.define.amd?vngageapp.define("cookies",[],function(){return t}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.Cookies=t):window.Cookies=t}(),vngageapp.define("core/vngage/store-cookies",["require","cookies"],function(e){"use strict";function t(e,t){var n={},r={expires:7776e3};return e&&e.sessionId&&e.visitorToken?(t&&(n={domain:"."+t}),s.set(c,e.sessionId,n),s.set(u,e.visitorToken,r),!0):!1}function n(e){var t={};s.expire(c),e&&(t={domain:"."+e},s.expire(c,t))}function r(){var e=s.get(c);return e?e:null}function i(){return s.get(u)}function o(e,t){s.set(l,e,t)}function a(){return!!s.get(l)}var s=e("cookies"),c="vngage.id",u="vngage.lkvt",l="psB";return{storeSessionId:t,clearSessionId:n,getSessionId:r,getVisitorToken:i,block:o,isBlocked:a}}),vngageapp.define("core/vngage/store-localStorage",["require","core/common/json","appConfig"],function(e){"use strict";function t(){return o||(o="vngage_"+s.comm.accountId),o}function n(){var e=localStorage.getItem(t());return e&&""!==e&&(e=a.parse(e)),e}function r(e){return localStorage.setItem(t(),a.stringify(e)),e}function i(){localStorage.removeItem(t())}var o,a=e("core/common/json"),s=e("appConfig");return{getSessionData:n,saveSessionData:r,removeSessionData:i}}),vngageapp.define("winIdChecker",[],function(){var e=function(e,t){"function"!=typeof t&&(t=function(){}),this.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})},this.update=function(){return this.id=this.guid(),localStorage.setItem(e,this.id),this.id},this.verify=function(){return localStorage.getItem(e)!==this.id?(t(),!1):!0}};return e}),vngageapp.define("applications/psLegacy/parts/urlHelpers",[],function(){function e(e,t){var n=e.split("#"),r=t.split("="),i=r[0],o=n[0].split("?"),a=o[0].split("&"),s=o.length>1?o[1].split("&"):[],c=a.splice(0,1);s=s.concat(a);for(var u=!1,l=0;s.length>l;l++)0===s[l].indexOf(i+"=")&&(s[l]=t,u=!0);for(u||s.push(t),n.splice(0,1);n.length>0&&""===n[n.length-1];)n.pop();return c+(s.length>0?"?"+s.join("&"):"")+(n.length>0?"#"+n.join("#"):"")}function t(t,n,r){return r=r||"inDialog=true",n&&n!==t?t:e(t,r)}function n(e,t){var n=t?new RegExp("(&)?"+t):/(&)?inDialog=true/;return e=e.replace(n,"").replace("?&","?"),"?"===e[e.length-1]?e.slice(0,-1):e}function r(e){return e.replace(/^(https?|ftp):\/\//,"//")}function i(e){return e.replace(/^(http:\/\/|\/\/)/,"https://")}return{injectParamToURL:e,addParam:t,removeParam:n,stripProtocol:r,makeSecure:i}}),vngageapp.define("core/vngage/transportcrawler",["require","promise","applications/psLegacy/parts/urlHelpers"],function(e){"use strict";var t,n,r=e("promise"),i=e("applications/psLegacy/parts/urlHelpers"),o=/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/,a={"http:":80,"https:":443},s=[],c="";return{init:function(e,i,o){if(n=new r.Promise,!e||0===e.length||!i||!o)return n.done("error, one or seveleral conditions where not met"),n;s=e,c=i;var a,u,l,p,d,f,g,h,v=document.querySelectorAll("a"),m=v.length,y=[],b=this._isMatchingDomain(e);for(t=this._decorate(c),this._lifeCycle(o),u=0;m>u;u++)p=v[u],d=this._isExternal(p.href),d&&y.push(p);for(a=y.length,l=0;a>l;l++)f=y[l],g=f.href,h=b(f),h&&this._prepareTransfer(f);return n},updateToken:function(e,i){return n=new r.Promise,e&&i?(c=e,t=this._decorate(e),this._lifeCycle(i),n):(n.done("failed to pass in correct arguments"),n)},decorateUrl:function(e){var t;return c&&s&&s.length&&this._isExternal(e)?(t=document.createElement("a"),t.href=e,s.indexOf(t.hostname)>-1?i.injectParamToURL(e,"vngagetrans="+c):e):e},_decorate:function(e){return function(t){var n=t.href,r=n.indexOf("?")>-1?"&":"?";t.href=n+r+"vngagetrans="+e}},_isExternal:function(e,t){var n,r=e.match(o);return t=t||window.location,"string"==typeof r[1]&&r[1].length>0?r[1].toLowerCase()!==t.protocol?!0:(n="string"==typeof r[2]&&r[2].length>0&&r[2].replace(new RegExp(":("+a[t.protocol]+")?$"),""),n!==t.host):!1},_isMatchingDomain:function(e){return function(t){return e.indexOf(t.hostname)>-1}},_prepareTransfer:function(e){e.addEventListener("mousedown",function(e){t(this)}),e.addEventListener("touchstart",function(e){t(this)})},_lifeCycle:function(e){setTimeout(function(){n.done("dead")},1e3*e)}}}),vngageapp.define("core/vngage/noop",[],function(){"use strict";function e(e,t){n||(n=setInterval(function(){e(t)},25e3))}function t(){n&&(clearInterval(n),n=null)}var n;return{start:e,stop:t}}),vngageapp.define("jschannel",["require","core/common/json"],function(e){var t=function(){"use strict";function t(e,t,n,r){function i(t){for(var n=0;n<t.length;n++)if(t[n].win===e)return!0;return!1}var o=!1;if("*"===t){for(var s in a)if(a.hasOwnProperty(s)&&"*"!==s&&"object"==typeof a[s][n]&&(o=i(a[s][n])))break}else a["*"]&&a["*"][n]&&(o=i(a["*"][n])),!o&&a[t]&&a[t][n]&&(o=i(a[t][n]));if(o)throw"A channel is already bound to the same window which overlaps with origin '"+t+"' and has scope '"+n+"'";"object"!=typeof a[t]&&(a[t]={}),"object"!=typeof a[t][n]&&(a[t][n]=[]),a[t][n].push({win:e,handler:r})}function n(e,t,n){for(var r=a[t][n],i=0;i<r.length;i++)r[i].win===e&&r.splice(i,1);0===a[t][n].length&&delete a[t][n]}function r(e){return Array.isArray?Array.isArray(e):-1!=e.constructor.toString().indexOf("Array")}var i=e("core/common/json"),o=Math.floor(1000001*Math.random()),a={},s={},c=function(e){var t;try{if(t=i.parse(e.data),"object"!=typeof t||null===t)throw"malformed"}catch(e){return}var n,r,o,c,u=e.source,l=e.origin;if("string"==typeof t.method){var p=t.method.split("::");2==p.length?(n=p[0],c=p[1]):c=t.method}if("undefined"!=typeof t.id&&(r=t.id),"string"==typeof c){var d=!1;if(a[l]&&a[l][n])for(o=0;o<a[l][n].length;o++)if(a[l][n][o].win===u){a[l][n][o].handler(l,c,t),d=!0;break}if(!d&&a["*"]&&a["*"][n])for(o=0;o<a["*"][n].length;o++)if(a["*"][n][o].win===u){a["*"][n][o].handler(l,c,t);break}}else"undefined"!=typeof r&&s[r]&&s[r](l,c,t)};return window.addEventListener?window.addEventListener("message",c,!1):window.attachEvent&&window.attachEvent("onmessage",c),{build:function(e){var a=function(t){if(e.debugOutput&&window.console&&window.console.log){try{"string"!=typeof t&&(t=i.stringify(t))}catch(n){window.console.error(n)}window.console.log("["+l+"] ",t)}};if(!window.postMessage)throw"jschannel: no postMessage";if(!window.JSON||!window.JSON.stringify||!window.JSON.parse)throw"jschannel: no JSON";if("object"!=typeof e)throw"Channel build invoked without a proper object argument";if(!e.window||!e.window.postMessage)throw"Channel.build() called without a valid window argument";if(window===e.window)throw"target window is same as present window -- not allowed";var c=!1;if("string"==typeof e.origin){var u;"*"===e.origin?c=!0:null!==(u=e.origin.match(/^https?:\/\/(?:[\-a-zA-Z0-9_\.])+(?::\d+)?/))&&(e.origin=u[0].toLowerCase(),c=!0)}if(!c)throw"Channel.build() called with an invalid origin";if("undefined"!=typeof e.scope){if("string"!=typeof e.scope)throw"scope, when specified, must be a string";if(e.scope.split("::").length>1)throw"scope may not contain double colons: '::'"}var l=function(){var e=0,t="",n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(e;5>e;e++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}(),p={},d={},f={},g=!1,h=[],v=function(e,t,n){var r=!1,i=!1;return{origin:t,invoke:function(t,r){if(!f[e])throw"attempting to invoke a callback of a nonexistent transaction: "+e;for(var i=!1,o=0;o<n.length;o++)if(t===n[o]){i=!0;break}if(!i)throw"request supports no such callback '"+t+"'";w({id:e,callback:t,params:r})},error:function(t,n){if(i=!0,!f[e])throw"error called for nonexistent message: "+e;delete f[e],w({id:e,error:t,message:n})},complete:function(t){if(i=!0,!f[e])throw"complete called for nonexistent message: "+e;delete f[e],w({id:e,result:t})},delayReturn:function(e){return"boolean"==typeof e&&(r=e===!0),r},completed:function(){return i}}},m=function(e,t,n){return window.setTimeout(function(){if(d[e]){var r="timeout ("+t+"ms) exceeded on method '"+n+"'";d[e].error&&d[e].error("timeout_error",r),delete d[e],delete s[e]}},t)},y=function(t,n,o){if("function"==typeof e.gotMessageObserver)try{e.gotMessageObserver(t,o)}catch(c){a("gotMessageObserver() raised an exception: "+c.toString())}if(o.id&&n){if(p[n]){var u=v(o.id,t,o.callbacks?o.callbacks:[]);f[o.id]={};try{if(o.callbacks&&r(o.callbacks)&&o.callbacks.length>0)for(var l=0;l<o.callbacks.length;l++){for(var g=o.callbacks[l],h=o.params,m=g.split("/"),y=0;y<m.length-1;y++){var b=m[y];"object"!=typeof h[b]&&(h[b]={}),h=h[b]}h[m[m.length-1]]=function(){var e=g;return function(t){return u.invoke(e,t)}}()}var w=p[n](u,o.params);u.delayReturn()||u.completed()||u.complete(w)}catch(c){var _="runtime_error",E=null;if("string"==typeof c?E=c:"object"==typeof c&&(c&&r(c)&&2==c.length?(_=c[0],E=c[1]):"string"==typeof c.error&&(_=c.error,c.message?"string"==typeof c.message?E=c.message:c=c.message:E="")),null===E)try{E=i.stringify(c),"undefined"==typeof E&&(E=c.toString())}catch(C){E=c.toString()}u.error(_,E)}}}else o.id&&o.callback?d[o.id]&&d[o.id].callbacks&&d[o.id].callbacks[o.callback]?d[o.id].callbacks[o.callback](o.params):a("ignoring invalid callback, id:"+o.id+" ("+o.callback+")"):o.id?d[o.id]?(o.error&&d[o.id].error?d[o.id].error(o.error,o.message):void 0!==o.result?d[o.id].success(o.result):d[o.id].success(),delete d[o.id],delete s[o.id]):a("ignoring invalid response: "+o.id):n&&p[n]&&p[n]({origin:t},o.params)};t(e.window,e.origin,"string"==typeof e.scope?e.scope:"",y);var b=function(t){return"string"==typeof e.scope&&e.scope.length&&(t=[e.scope,t].join("::")),t},w=function(t,n){if(!t)throw"postMessage called with null message";var r=g?"post  ":"queue ";if(a(r+" message: "+i.stringify(t)),n||g){if("function"==typeof e.postMessageObserver)try{e.postMessageObserver(e.origin,t)}catch(o){a("postMessageObserver() raised an exception: "+o.toString())}try{e.window.postMessage(i.stringify(t),e.origin)}catch(s){}}else h.push(t)},_=function(t,n){if(a("ready msg received"),g&&!e.reconnect)throw"received ready message while in ready state. help!";for(g=!1,l.length<6&&(l+="ping"===n?"-R":"-L"),e.reconnect||E.unbind("__ready"),g=!0,a("ready msg accepted."),"ping"===n&&E.notify({method:"__ready",params:"pong"});h.length;)w(h.pop());"function"==typeof e.onReady&&e.onReady(E)},E={unbind:function(e){if(p[e]){if(!delete p[e])throw"can't delete method: "+e;return!0}return!1},bind:function(e,t){if(!e||"string"!=typeof e)throw"'method' argument to bind must be string";if(!t||"function"!=typeof t)throw"callback missing from bind params";if(p[e])throw"method '"+e+"' is already bound!";return p[e]=t,this},call:function(e){if(!e)throw"missing arguments to call function";if(!e.method||"string"!=typeof e.method)throw"'method' argument to call must be string";if(!e.success||"function"!=typeof e.success)throw"'success' callback missing from call";var t={},n=[],r=[],i=function(e,o){if(r.indexOf(o)>=0)throw"params cannot be a recursive data structure";if(r.push(o),"object"==typeof o)for(var a in o)if(o.hasOwnProperty(a)){var s=e+(e.length?"/":"")+a;"function"==typeof o[a]?(t[s]=o[a],n.push(s),delete o[a]):"object"==typeof o[a]&&i(s,o[a])}};i("",e.params);var a={id:o,method:b(e.method),params:e.params};n.length&&(a.callbacks=n),e.timeout&&m(o,e.timeout,b(e.method)),d[o]={callbacks:t,error:e.error,success:e.success},s[o]=y,o++,w(a)},notify:function(e){if(!e)throw"missing arguments to notify function";if(!e.method||"string"!=typeof e.method)throw"'method' argument to notify must be string";w({method:b(e.method),params:e.params})},destroy:function(){n(e.window,e.origin,"string"==typeof e.scope?e.scope:""),window.removeEventListener?window.removeEventListener("message",y,!1):window.detachEvent&&window.detachEvent("onmessage",y),g=!1,p={},f={},d={},e.origin=null,h=[],a("channel destroyed"),l=""}};return E.bind("__ready",_),setTimeout(function(){try{w({method:b("__ready"),params:"ping"},!0)}catch(e){a("JSChannel:ping failed!"+e)}},200),E}}}();return t}),vngageapp.define("core/request/xdmRequester",["require","appConfig","promise","jschannel"],function(e){var t=e("appConfig"),n=e("promise"),r=e("jschannel"),i=new n.Promise,o=function(){function e(e){var t=document.location.protocol,n=document.location.hostname,r=(r=document.location.port)?":"+r:"",i=document.createElement("iframe");return i.name=t+"//"+n+r,i.domain="psplugin.com",i.id="psPluginConn",i.className="psPluginConn",i.src=e,i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.visibility="hidden",document.getElementsByTagName("body")[0].appendChild(i),i}function o(e,t){return r.build({debugOutput:!1,window:e.contentWindow,origin:t,scope:"connection",onReady:function(){i.done(null)}})}function a(){var n,r=t.comm.commUrl,i=r+"vngage.html",a=r.match(/^https?\:\/\/([^\/?#]+)/);i+="?id="+t.comm.accountId+"&url="+t.comm.restUrl,t.comm.debugMode&&(i=i.replace("vngage.html","xdmdebug.html")+"&scripturl="+t.comm.jsPath+"core/request/xdmdebug.js"),a&&a[0]&&(a=a[0]),n=e(i),setTimeout(function(){l=o(n,a)},10)}function s(e){var t=new n.Promise,r={url:e,headers:{}};return i.then(function(){l.call({method:"get",params:r,success:function(e){t.done(null,e)},error:function(e){t.done(e,null,{status:n.ENOXHR})}})}),t}function c(e,t){var r=new n.Promise,o={url:e,data:t,headers:{}};return i.then(function(){l.call({method:"post",params:o,success:function(e){r.done(null,e)},error:function(e){r.done(e,null,{status:n.ENOXHR})}})}),r}function u(e){var t=new n.Promise,r={url:e,headers:{"Content-type":"text/plain"}};return i.then(function(){l.call({method:"ping",params:r,success:function(e){t.done(null,e)},error:function(e){t.done(null)}})}),t}var l;return{init:a,get:s,post:c,ping:u}};return o}),vngageapp.define("core/request/requesterFacade",["require","promise","core/request/xdmRequester"],function(e){function t(){var e;return"withCredentials"in new XMLHttpRequest?e=n:(e=new r,e.init()),{get:e.get,post:e.post,ping:e.ping}}var n=e("promise"),r=e("core/request/xdmRequester");return{setup:t}}),vngageapp.define("components/sandbox/main",["require","underscore","core/common/json"],function(e){"use strict";function t(){s=document.createElement("div"),s.className="vngage-ui vngage-sandboxui",s.style.cssText="transition:all 300ms;position:fixed;left:0;right:0;top:-15px;height:15px;zIndex:9999;background-color:#AB3192;color:white",s.innerHTML='<span style="display:block;padding:2px 5px;font-family: Arial;font-size: 9px;">SANDBOX</span>',document.body.appendChild(s),s.style.top="0px"}function n(){var e=new Date;l(),o(),localStorage.getItem(d)&&!g?(g=!0,r()):(g=!0,localStorage.getItem(d)||localStorage.setItem(d,u.stringify({ts:e.getTime()})),p())}function r(){s&&(s.style.top="-12px")}function i(){s&&s.parentNode&&(document.removeChild(s),s=null),localStorage.removeItem(d)}function o(){var e=new Date,t=localStorage.getItem(d);return t?(t=u.parse(t),e.getTime()-t.ts<f?!0:(localStorage.removeItem(d),!1)):!1}function a(){return o()}var s,c=e("underscore"),u=e("core/common/json"),l=c.once(t),p=c.throttle(r,3e3,{leading:!1,trailing:!0}),d="vngage.sandboxmode",f=9e5,g=!1;return o()&&n(),{isActive:a,show:n,remove:i,_create:t}}),vngageapp.define("connection",["require","pubsub","core/vngage/eventsVO","appConfig","core/common/json","promise","batchrequest","services/legacyNoop","underscore","core/vngage/store-cookies","core/vngage/store-localStorage","winIdChecker","core/vngage/transportcrawler","core/vngage/noop","core/request/requesterFacade","components/sandbox/main","core/vngage/getQueryParameter"],function(e){"use strict";var t=e("pubsub"),n=e("core/vngage/eventsVO"),r=e("appConfig"),i=e("core/common/json"),o=e("promise"),a=e("batchrequest"),s=e("services/legacyNoop"),c=e("underscore"),u=e("core/vngage/store-cookies"),l=e("core/vngage/store-localStorage"),p=e("winIdChecker"),d=e("core/vngage/transportcrawler"),f=e("core/vngage/noop"),g=e("core/request/requesterFacade"),h=e("components/sandbox/main"),v=e("core/vngage/getQueryParameter"),m="sessionId=",y="json=true",b=1,w=[o.ENOXHR,401],_=v("vngageMode"),E=_?"register/"+_+"/":"register/",C="Register/TransportToken/Create",I="Register/TransportToken/Use/",S="session/bucket/visitor",O=function(){function e(){f.start(U,r.comm.restUrl+"Command/Noop")}function O(){f.stop()}function T(){O(),W.update(),z().then(function(e,r){t.publish(n.DIALOG_RESUMED,r)})}function A(){if(W=new p("vngage.wId_"+r.comm.accountId,function(){t.publish(n.ERROR_TOKENMISMATCH)}),r.visitor.transportDomains&&r.visitor.transportDomains.length){var e=v("vngagetrans");e?x(e):R()}else R()}function x(e){var i=I+e;return V(i,"nosession").then(function(e,i){if(e)t.publish(n.ERROR_TRANSFER),R();else{var o=r.currentSite?r.currentSite.baseDomain:null;u.storeSessionId(i,o),R()}})}function R(){q().then(function(e,r){var i=new o.Promise;return W.update(),e?i.done(e):z().then(function(e,o){e?i.done(e):(o.user.token=r,t.publish(n.CONFIGURATION_CHANGE,o),t.publish(n.CONNECTION_STARTED),i.done(null,r))}),i}).then(function(e){e||N()})}function N(){var e=r.visitor.transportDomains||[];if(0!==e.length){if(e.indexOf(location.hostname)>-1){var t=e.indexOf(location.hostname);e.splice(t,1)}V(C).then(function(t,n){t||d.init(e,n.transportToken,n.lifetimeSeconds).then(function(e){e&&k()})})}}function k(){V(C).then(function(e,t){e||d.updateToken(t.transportToken,t.lifetimeSeconds).then(function(e){e&&k()})})}function P(){function e(e,n){
if(e)return t.done("session register failed"),t;n&&!c.isObject(n)&&""!==n&&(n=i.parse(n));var o=r.currentSite?r.currentSite.baseDomain:null;u.storeSessionId(n,o),t.done(null,n.sessionId)}var t=new o.Promise,n=r.comm.restUrl+E+r.comm.accountId+"?json=true",a=u.getVisitorToken(),s={};return a&&!_&&(s=i.stringify({lastKnownVisitorToken:a,clientVersion:vngage.info?vngage.info.version:"local",configurationSetRevision:vngage.info?vngage.info.revision:null})),g.post||(g=g.setup()),g.post(n,s).then(e),t}function q(){var e=new o.Promise,t=u.getSessionId();return!t||_?P().then(function(t,n){return t?(h.remove(),e.done(t),e):("Sandbox"===_&&(h.show(),_=null),void e.done(null,n))}):(h.isActive()&&h.show(),e.done(null,t)),e}function L(){var e=r.currentSite?r.currentSite.baseDomain:null;u.clearSessionId(e)}function D(e,t,n,a){function l(o,a){if(o)return f.done("error verifying session"),f;if(d="ping"===e||0===t.indexOf("http")?t:r.comm.restUrl+t,a&&(d=n&&n.json===!1?d+"?"+m+encodeURIComponent(a):d+"?"+y+"&"+m+encodeURIComponent(a)),g.post&&g.get||(g=g.setup()),n&&""!==n){if("post"===e){var u=c.isString(n)?n:i.stringify(n);return g[e](d,u)}d=d+"&"+n}return"ping"===e&&g[e]?s.ping(d):("ping"===e&&(e="get"),g[e](d))}function p(o,s,l){if(o&&l){var p=c.indexOf(w,l.status)>=0;if(b>=a&&l&&p){var d=r.currentSite?r.currentSite.baseDomain:null;return u.clearSessionId(d),D(e,t,n,a+1)}s&&!c.isObject(s)&&""!==s&&(s=i.parse(s),s.errorCode&&(o=s.errorCode)),f.done(o,s,l)}else s&&!c.isObject(s)&&""!==s&&(s=i.parse(s)),f.done(null,s,l);return f}var d,f=new o.Promise;return a=a||1,"nosession"===n?(n=!1,l(null,!1).then(p)):q().then(l).then(p)}function M(e){return D("post","batch/",a(e),1)}function j(e,t){if(W.verify(),c.isArray(e)){var n=c.map(e,function(e){return{uri:e.uri,method:"get",tag:e.tag}});return M(n)}return D("get",e,t)}function U(e){return W.verify(),D("ping",e)}function V(e,t){if(W.verify(),c.isArray(e)){var n=c.map(e,function(e){return{uri:e.uri,method:"post",body:e.body,tag:e.tag}});return M(n)}return D("post",e,t,1)}function B(e){return l.saveSessionData(e),V([{method:"POST",uri:S,body:i.stringify(e)}])}function z(){var e=new o.Promise;return j(S).then(function(t,n){if(t)e.done("failed fetching session");else{var r=n;"string"==typeof r&&""!==r?r=i.parse(r):"object"==typeof r&&r.user||(r={user:{state:"Ready"}}),l.saveSessionData(r),e.done(null,r)}}),e}function F(e){V("Conversation/"+e+"/Leave")}function H(e,t){V("Conversation/"+e+"/Message",t)}function Q(e,t){V("Conversation/"+e+"/Task",t)}function G(e,t){return V("Conversation/"+e+"/Dom",t)}var W;return{start:A,get:j,ping:U,post:V,resume:T,syncSession:B,verifySession:q,clearSession:L,startNoop:e,stopNoop:O,sendTask:Q,sendMessage:H,leaveConversation:F,sendPageDOM:G}}();return O}),function(e,t){"object"==typeof module&&module.exports?module.exports=function(e){return e=e||require("underscore"),t(e)}:"function"==typeof vngageapp.define&&vngageapp.define.amd?vngageapp.define("machina",["underscore"],function(n){return t(n,e)}):e.machina=t(e._,e)}(this,function(e,t,n){var r=[].slice,i="transition",o="handler",a="handling",s="handled",c="nohandler",u="transition",l="invalidstate",p="deferred",d="newfsm",f={makeFsmNamespace:function(){var e=0;return function(){return"fsm."+e++}}(),getDefaultOptions:function(){return{initialState:"uninitialized",eventListeners:{"*":[]},states:{},eventQueue:[],namespace:f.makeFsmNamespace(),targetReplayState:"",state:n,priorState:n,_priorAction:"",_currentAction:""}}};if(!e.deepExtend){var g={"*":function(e,t,n){e[t]=n},object:function(e,t,n){e[t]=m({},e[t]||{},n)},array:function(t,n,r){t[n]=[],e.each(r,function(e,r){g[v(e)](t[n],r,e)},this)}},h=function(t){return e.isArray(t)?"array":e.isDate(t)?"date":e.isRegExp(t)?"regex":typeof t},v=function(e){var t=h(e);return g[t]?t:"*"},m=function(t){return e.each(r.call(arguments,1),function(n){e.each(n,function(e,n){g[v(e)](t,n,e)})}),t};e.mixin({deepExtend:m})}var y=function(t){e.extend(this,t),e.defaults(this,f.getDefaultOptions()),this.initialize.apply(this,arguments),_.emit(d,this),this.initialState&&this.transition(this.initialState)};e.extend(y.prototype,{initialize:function(){},emit:function(t){var n=arguments;this.eventListeners["*"]&&e.each(this.eventListeners["*"],function(e){try{e.apply(this,r.call(n,0))}catch(t){console&&"undefined"!=typeof console.log&&0}},this),this.eventListeners[t]&&e.each(this.eventListeners[t],function(e){try{e.apply(this,r.call(n,1))}catch(t){console&&"undefined"!=typeof console.log&&0}},this)},handle:function(t){if(!this.inExitHandler){var i,u,l,p,d=this.states,f=this.state,g=r.call(arguments,0);this.currentActionArgs=g,d[f][t]||d[f]["*"]||this["*"]?(i=d[f][t]?t:"*",l="*"===i,d[f][i]?(u=d[f][i],p=f+"."+i):(u=this["*"],p="*"),this._currentAction||(this._currentAction=p),this.emit.call(this,a,{inputType:t,args:g.slice(1)}),e.isFunction(u)&&(u=u.apply(this,l?g:g.slice(1))),e.isString(u)&&this.transition(u),this.emit.call(this,s,{inputType:t,args:g.slice(1)}),this._priorAction=this._currentAction,this._currentAction="",this.processQueue(o)):this.emit.call(this,c,{inputType:t,args:g.slice(1)}),this.currentActionArgs=n}},transition:function(e){if(!this.inExitHandler&&e!==this.state){var t;if(this.states[e])return this.targetReplayState=e,this.priorState=this.state,this.state=e,t=this.priorState,this.states[t]&&this.states[t]._onExit&&(this.inExitHandler=!0,this.states[t]._onExit.call(this),this.inExitHandler=!1),this.emit.call(this,u,{fromState:t,action:this._currentAction,toState:e}),this.states[e]._onEnter&&this.states[e]._onEnter.call(this),void(this.targetReplayState===e&&this.processQueue(i));this.emit.call(this,l,{state:this.state,attemptedState:e})}},processQueue:function(t){var n=t===i?function(e){return e.type===i&&(!e.untilState||e.untilState===this.state)}:function(e){return e.type===o},r=e.filter(this.eventQueue,n,this);this.eventQueue=e.difference(this.eventQueue,r),e.each(r,function(e){this.handle.apply(this,e.args)},this)},clearQueue:function(t,n){if(t){var r;t===i?r=function(e){return e.type===i&&(n?e.untilState===n:!0)}:t===o&&(r=function(e){return e.type===o}),this.eventQueue=e.filter(this.eventQueue,r)}else this.eventQueue=[]},deferUntilTransition:function(e){if(this.currentActionArgs){var t={type:i,untilState:e,args:this.currentActionArgs};this.eventQueue.push(t),this.emit.call(this,p,{state:this.state,queuedArgs:t})}},deferUntilNextHandler:function(){if(this.currentActionArgs){var e={type:i,args:this.currentActionArgs};this.eventQueue.push(e),this.emit.call(this,p,{state:this.state,queuedArgs:e})}},on:function(e,t){var n=this;return n.eventListeners[e]||(n.eventListeners[e]=[]),n.eventListeners[e].push(t),{eventName:e,callback:t,off:function(){n.off(e,t)}}},off:function(t,n){t?this.eventListeners[t]&&(n?this.eventListeners[t]=e.without(this.eventListeners[t],n):this.eventListeners[t]=[]):this.eventListeners={}}}),y.prototype.trigger=y.prototype.emit;var b=function(){},w=function(t,n,r){var i;return i=n&&n.hasOwnProperty("constructor")?n.constructor:function(){t.apply(this,arguments)},e.deepExtend(i,t),b.prototype=t.prototype,i.prototype=new b,n&&e.deepExtend(i.prototype,n),r&&e.deepExtend(i,r),i.prototype.constructor=i,i.__super__=t.prototype,i};y.extend=function(e,t){var n=w(this,e,t);return n.extend=this.extend,n};var _={Fsm:y,utils:f,on:function(e,t){return this.eventListeners[e]||(this.eventListeners[e]=[]),this.eventListeners[e].push(t),t},off:function(t,n){this.eventListeners[t]&&(this.eventListeners[t]=e.without(this.eventListeners[t],n))},trigger:function(t){var n=arguments,i=this.eventListeners[t]||[];i&&i.length&&e.each(i,function(e){e.apply(null,r.call(n,1))})},eventListeners:{newFsm:[]}};return _.emit=_.trigger,_}),vngageapp.define("core/vngage/logger",["require","underscore"],function(e){function t(e,t){window.console&&(t&&window.console.groupCollapsed&&window.console.groupCollapsed(t),"string"!=typeof e?window.console.log(JSON.stringify(e,null,"  ")):window.console.log(e),t&&window.console.groupEnd&&window.console.groupEnd())}function n(e){return e===!1?(a=!1,localStorage.removeItem(i),!1):(e===!0&&(a=o),"string"==typeof e&&(a=e),void localStorage.setItem(i,a))}var r=e("underscore"),i="vngage.debug",o="groups opportunities solutions",a=localStorage.getItem(i),s={log:t,init:n};return a&&r.each(a.split(" "),function(e){s[e]=!0}),s}),vngageapp.define("core/vngage/track",["require","underscore","appConfig","core/common/json","connection","core/vngage/logger"],function(e){"use strict";function t(e){e.type?n(e):a.each(e,n)}function n(e){switch(e.type.toLowerCase()){case"purchase":i(o(e));break;case"opportunity":i(e);break;case"solution":i(e);break;case"navigation":i(e);break;case"pointofinterest":i(e)}}function r(){var e="Tracking/Bundle",t=p.length;d=null,p&&t&&(1===t&&(p=p[0],e="Tracking"),l.tracking&&l.log(p,"TrackingData"),u.post([{method:"POST",uri:e,body:c.stringify(p)}]),p=[])}function i(e){p=p.concat(e),d||(d=setTimeout(r,250))}function o(e){return{type:"PointOfInterest",siteId:s.currentSiteId,pointOfInterestId:e.id,name:e.name,category:"purchaseConfirmation",matched:!0,tags:[]}}var a=e("underscore"),s=e("appConfig"),c=e("core/common/json"),u=e("connection"),l=e("core/vngage/logger"),p=[],d=!1;return{add:t}}),vngageapp.define("applications/analyze/collection",["require","underscore"],function(e){"use strict";var t=e("underscore"),n=function(){function e(){this.items=[]}return e.prototype.add=function(e){this.items=this.items.concat(e)},e.prototype.getItems=function(){return t.map(this.items,t.clone)},e}();return n}),vngageapp.define("applications/psLegacy/parts/visitorIdentification",["require","connection","cookies"],function(e){"use strict";function t(e){var t=f.get(v);if("0"===t)return n(),!1;var i=Date.now();if(t&&"string"==typeof t&&t!==p&&i-parseInt(t,10)<h)return!1;t!==p&&f.set(v,i);var o=d.ping(e+"api/v1/Command/Noop");o&&o.then&&o.then(r)}function n(){l&&(clearInterval(l),l=null)}function r(e,t,n){return!n||302!==n.status&&401!==n.status&&403!==n.status?!0:(i(),!1)}function i(){var e=f.get(v);e&&"0"!==e&&(f.set(v,"0"),d.post("Visit/Me/ClearIdentity")),n()}function o(e){l||(l=setInterval(function(){l&&t(e)},g),t(e))}function a(e){var t=f.get(v);t&&"0"!==t||(p=""+Date.now(),f.set(v,p)),o(e)}function s(){i()}function c(e,t){var n=!1,r=/\s+/g;return e&&t?(e=e.toLowerCase(),"string"==typeof t&&(t=t.trim().split(r)),t.forEach(function(t){return e.indexOf(t.toLowerCase())>-1?(n=!0,!0):void 0}),n):!1}function u(e,t,n,r){var i,o,u=[];if("string"==typeof r&&(u=r.trim().split(/[ .\/]+/)),!t)return!1;var l=u.reduce(function(e,t){return e?e[t]:!1},window),p=u.reduce(function(e,t){return e?e[t]:!1},window.top);if(r){try{i=window.top===window.self?l:p}catch(d){}return i===!0?(a(t),!0):(s(),!1)}return n?(o=c(e,n))?(a(t),!0):(s(),!1):void 0}var l,p,d=e("connection"),f=e("cookies"),g=6e4,h=3e4,v="vngage.li";return{identify:u,clearNoop:n,clear:i,_handleNoopResponse:r}}),vngageapp.define("vergic.dom",["require","underscore"],function(e){"use strict";function t(e){return new RegExp("(^|\\s)"+e+"($|\\s)","g")}var n,r,i=e("underscore");return r=function(){var e,t=document.createElement("div");return t.style.width="100px",t.style.height="100px",t.style.overflow="scroll",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t),e=t.offsetWidth-t.clientWidth,document.body.removeChild(t),e}(),n={addClass:function(e,t){var n=!1;return e&&t?(/ /.test(t)?i.each(t.split(" "),function(t){this.addClass(e,t)&&(n=!0)}.bind(this)):this.hasClass(e,t)||(e.className+=(e.className.length?" ":"")+t,n=!0),n):!1},removeClass:function(e,n){return e&&this.hasClass(e,n)?(e.className=e.className.replace(t(n)," ").trim(),!0):!1},removeClasses:function(e){return e?(e.className="",!0):!1},hasClass:function(e,n){return e?t(n).test(e.className):!1},toggleClass:function(e,t){return e?this.addClass(e,t)||!this.removeClass(e,t):!1},createElement:function(e,t,n){var r=document.createElement(e);return t&&r.appendChild(document.createTextNode(t)),n&&this.addClass(r,n),r},insertAfter:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},insertBefore:function(e,t){e.parentNode.insertBefore(t,e)},setCSS:function(e,t){var n,r=/\w+:/g,o=e.style.cssText,a=t.match(r),s=o.match(r),c=i.difference(s,a);return c?(n=[],i.each(c,function(e,t){var r=new RegExp("("+e+")([^;]+;)","g");n.unshift(o.match(r))}),t+n.join(" ")):t},scrollbarWidth:function(){return r}}}),vngageapp.define("queueStatus",["require","underscore","core/common/json","connection","core/vngage/eventsVO","appConfig","promise","pubsub","core/vngage/logger"],function(e){"use strict";function t(e){function t(e,t){var n=!1;return e?(i.done(e),console.error("get Group Statuses:",e)):(f.each(t,function(e){I[e.groupId]!==e.status&&(I[e.groupId]=e.status,n=!0)}),n&&b.publish(v.QUEUESTATUS_CHANGE,I),void i.done(null,I))}var n,r="Group/Status/",i=new y.Promise;return e===!1?(n=m.comm.restUrl+r+m.comm.accountId+"/?json=true&"+p,h.get(n,"nosession").then(function(e,n){"string"==typeof n&&""!==n&&(n=g.parse(n)),t(e,n)})):h.get(r,p).then(t),i}function n(e){return"string"!=typeof e?"":e.toUpperCase()}function r(e){return e=n(e),"open"===I[e]}function i(e){return e=n(e),I[e]?I[e]:!1}function o(e,t){var n=[];f.each(t,function(e,t){n.push(t+"	"+e)}),w.log(n.join("\n"),"Groups")}function a(e){return f.each(e,function(e,t){S.push(t),I[t]={name:e.name}}),p="groupId="+S.join("&groupId="),w.groups&&(d=e,b.subscribe(v.QUEUESTATUS_CHANGE,o)),t().then(function(){b.publish(v.QUEUESTATUS_UPDATE,I)}),I}function s(){_++,t(!1),_>E&&(_=0,u())}function c(e){l||(e=m.account.queueStatusUpdateInterval||C,l=setInterval(s,e))}function u(){l&&(l=clearInterval(l))}var l,p,d,f=e("underscore"),g=e("core/common/json"),h=e("connection"),v=e("core/vngage/eventsVO"),m=e("appConfig"),y=e("promise"),b=e("pubsub"),w=e("core/vngage/logger"),_=0,E=6,C=6e4,I={},S=[];return{startChecking:c,stopChecking:u,init:a,refresh:t,getStatus:i,isGroupOpen:r}}),vngageapp.define("applications/banners/classes",["require","underscore"],function(e){"use strict";function t(e){var t,i;return e=e||{},i=n.defaults(e,r),t=i.prefix,n.each(n.omit(i,"prefix"),function(e,r){var o=e.split(" ");n.each(o,function(e,n){e&&(o[n]=t+e)}),i[r]=o.join(" ")}),i}var n=e("underscore"),r={prefix:"vngage-",banner:"banner",content:"content",inactive:"inactive",active:"active",expand:"expand",template:"",open:"open",busy:"busy",closed:"closed",overlay:"overlay",overlayShow:"show",overlayMobile:"mobile-show",form:"form",formRow:"form-row",formGroup:"form-group",label:"label",required:"required",typeText:"text",typeButton:"btn",buttonRow:"form-btn",valid:"valid",invalid:"invalid",dirty:"dirty",pristine:"pristine",message:"validity-message",messageShow:"show",messageOffset:"offset",placeholder:"placeholder"};return t}),vngageapp.define("applications/banners/overlay",["require","underscore","vergic.dom","core/vngage/eventsVO","applications/banners/classes"],function(e){"use strict";function t(e){this.active=!1,this.config=e.config,this.banner=e}function n(){function e(){l.addClass(g,n)}function t(){document.body.appendChild(g),s(this.config.api),requestAnimationFrame(e)}var n;return this.active?!1:(clearTimeout(c),n=this.getShowClass(),f[n]=(f[n]||0)+1,1===f[n]&&(a(n)?e():requestAnimationFrame(t.bind(this))),this.active=n,!0)}function r(){return this.active?(f[this.active]-=1,f[this.active]||(l.removeClass(g,this.active),a(this.active)||(c=u.delay(function(){document.body.removeChild(g),s()},500))),this.active=!1,!0):!1}function i(){var e=this.config.overlayMobileOnly;return h["overlay"+(e?"Mobile":"Show")]}function o(){var e=this.banner,t=e[this.config.overlayMethodHide];u.isFunction(t)&&t.call(e)}function a(e){var t=0;return u.each(u.omit(f,e),function(e){e>0&&(t+=e)}),t}function s(e){function t(){e.publish(p.BANNER_OVERLAY_CLICK),n=!1}var n=!0;e?g.addEventListener("click",t):g.removeEventListener("click",t)}var c,u=e("underscore"),l=e("vergic.dom"),p=e("core/vngage/eventsVO"),d=e("applications/banners/classes"),f={},g=document.createElement("div"),h=d();return l.addClass(g,h.overlay),t.prototype.show=n,t.prototype.hide=r,t.prototype.getShowClass=i,t.prototype.doBannerMethod=o,t}),vngageapp.define("applications/banners/helpers",["require","underscore","vergic.dom","appConfig","core/vngage/eventsVO","queueStatus","applications/banners/overlay"],function(e){"use strict";function t(e){var t,r,i,o=E.currentSite,a=o&&o.banners||{},s=o&&o.solutions[e],c=s&&s.section;return s&&c?(t=I.getStatus(c.groupId),"open"===t?r=c.bannerIdGroupOpen:"busy"===t?r=c.bannerIdGroupBusy:"closed"===t&&(r=c.bannerIdGroupClosed),r||(r=c.bannerId),a[r]?(i=a[r].section,i.id=s.id,i.groupId=c.groupId,i.caseTypeId=c.caseTypeId,i.title=c.messageToCustomerCase,i.status=n(t),i):null):null}function n(e){var t={};return t.isOpen="open"===e,t.isBusy="busy"===e,t.isClosed="closed"===e,t}function r(e,t,n,r){var o=this.config,a=o.classes,s=_.hasClass(this.el,a[e]);return i.call(this),o.closed||r!==!0&&s?!1:(n=n>0?1e3*n:0,n?o.displayTimer=w.delay(t.bind(this,o,a),n):t.call(this,o,a),!0)}function i(){var e=this.config,t="clearTimeout";e.displayTimerAnimationFrame&&(t="cancelAnimationFrame",e.displayTimerAnimationFrame=!1),window[t](e.displayTimer)}function o(e){e.tag=e.tag||{};var t,n=document.createElement(e.tag);return _.addClass(n,e.classes.banner),_.addClass(n,e.classes.template),w.each(e.extraClasses.split(" "),function(e){_.addClass(n,e)}),e.content?(t=e.htmlTarget=a(e),n.appendChild(t)):e.htmlTarget=n,n}function a(e){var t=document.createElement("div");return _.addClass(t,e.classes.content),t}function s(e,t,n){t.overlay&&(w.isBoolean(t.overlay)&&(t.overlay=new S(e)),n===t.overlayMethod?t.overlay.show():("hide"===n||n===t.overlayMethodHide)&&t.overlay.hide())}function c(){function e(e){var t=e.targetMethod,n=e.targetParent;return n===this.el.parentNode?!0:n?(n[t](this.el,e.target),e.targetReplace&&(e.targetReplace=!1,e.targetMethod="insertBefore",e.target=this.el.nextSibling),!0):!1}function t(){return c.call(this),n.addNode.isAddMethod?(n.addNode(),!0):!1}var n=this.config;if("body"===n.target?n.target=document.body:"string"==typeof n.target&&(n.target=document.querySelector(n.target)),!n.target)return void(n.addNode=t.bind(this));switch(n.targetMethod){case"before":n.targetParent=n.target.parentNode,n.targetMethod="insertBefore";break;case"after":n.targetParent=n.target.parentNode,n.target=n.target.nextSibling,n.targetMethod="insertBefore";break;case"replace":n.targetReplace=!0,n.targetParent=n.target.parentNode,n.targetMethod="replaceChild";break;case"prepend":n.targetParent=n.target,n.target=n.target.firstChild,n.targetMethod="insertBefore";break;case"append":n.targetParent=n.target,n.targetMethod="appendChild"}n.addNode=e.bind(this,n),n.addNode.isAddMethod=!0}function u(){var e,t=this.config,n=this.el;e={open:"isOpen",busy:"isBusy",closed:"isClosed"},w.each(e,function(e,r){var i=t.status[e]?"add":"remove";_[i+"Class"](n,t.classes[r])})}function l(e){var t=e.displayWhenOpen&&e.status.isOpen,n=e.displayWhenBusy&&e.status.isBusy,r=e.displayWhenClosed&&e.status.isClosed;return t||n||r}function p(e){this.hide(),"takeover"===e.template&&e.introDelay>0?this.show(e.introDelay):this.show(e.showDelay,function(){var t=Math.max(e.introDelay-e.showDelay,0),n=d.bind(this);e.intro&&this.intro(t,e.introDuration,n)}.bind(this))}function d(){var e={},t=this.config;t.introOnce&&(e.duration=t.introQuarantine,e.type=t.introPerTemplate?t.template:t.id,t.api.publish(C.BANNER_INTRO,e))}function f(e){var t,n=e||E.themes.banners||"",r=document.getElementsByTagName("head")[0];return n&&r?(t=document.createElement("style"),t.id="vngageBannerCSS",t.setAttribute("type","text/css"),t.styleSheet?(r.appendChild(t),t.styleSheet.cssText=n):(t.appendChild(document.createTextNode(n)),r.appendChild(t)),t):!1}function g(){var e,t,n="vngage-csstransitions",r=document.getElementsByTagName("html")[0];t=_.hasClass(r,n),t&&(e=w.debounce(function(){t=!0,_.addClass(r,n)},500),window.addEventListener("resize",function(){t&&(t=!1,_.removeClass(r,n),e())}))}function h(){function e(e){var t,i;return i=e.charAt(0).toUpperCase()+e.slice(1),t=(e+" "+n.join(i+" ")+i).split(" "),w.some(t,function(e){return"undefined"!=typeof r.style[e]})}var t,n=["Webkit","Moz","O","ms"],r=document.createElement("div"),i=document.getElementsByTagName("html")[0];t={csstransforms:"transform",csstransitions:"transition"},w.each(t,function(t,n){var r=e(t)?"":"no-";_.addClass(i,"vngage-"+r+n)})}function v(e){var t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0,n=screen.width,r=t>n?n:t;return e>=r}function m(e,t){"function"==typeof e&&e.call(t)}function y(e,t){if(e===t)return!1;for(;e&&e!==t;)e=e.parentNode;return e===t}function b(e,t){return t===e||y(t,e)}var w=e("underscore"),_=e("vergic.dom"),E=e("appConfig"),C=e("core/vngage/eventsVO"),I=e("queueStatus"),S=e("applications/banners/overlay");return{getConfig:t,groupStatus:n,display:r,displayTimerClear:i,createWrapper:o,overlayMethod:s,setupAddMethod:c,availabilityClasses:u,shouldDisplay:l,creationDisplay:p,loadBannerCss:f,htmlSupportClasses:h,resizeTransitionDisable:g,mobileSize:v,doIfPossible:m,isEnterOrLeave:b}}),function(){"use strict";function e(){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},t=/&(?!#?\w+;)|<|>|"|'|\//g;return function(){return this?this.replace(t,function(t){return e[t]||t}):this}}function t(e,n,r){return("string"==typeof n?n:n.toString()).replace(e.define||a,function(t,n,i,o){return 0===n.indexOf("def.")&&(n=n.substring(4)),n in r||(":"===i?(e.defineParams&&o.replace(e.defineParams,function(e,t,i){r[n]={arg:t,text:i}}),n in r||(r[n]=o)):new Function("def","def['"+n+"']="+o)(r)),""}).replace(e.use||a,function(n,i){e.useParams&&(i=i.replace(e.useParams,function(e,t,n,i){if(r[n]&&r[n].arg&&i){var o=(n+":"+i).replace(/'|\\/g,"_");return r.__exp=r.__exp||{},r.__exp[o]=r[n].text.replace(new RegExp("(^|[^\\w$])"+r[n].arg+"([^\\w$])","g"),"$1"+i+"$2"),t+"def.__exp['"+o+"']"}}));var o=new Function("def","return "+i)(r);return o?t(e,o,r):o})}function n(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var r,i={version:"1.0.1",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1},template:void 0,compile:void 0};"undefined"!=typeof module&&module.exports?module.exports=i:"function"==typeof vngageapp.define&&vngageapp.define.amd?vngageapp.define("doT",[],function(){return i}):(r=function(){return this||(0,eval)("this")}(),r.doT=i),String.prototype.encodeHTML=e();var o={append:{start:"'+(",end:")+'",endencode:"||'').toString().encodeHTML()+'"},split:{start:"';out+=(",end:");out+='",endencode:"||'').toString().encodeHTML();out+='"}},a=/$^/;i.template=function(r,s,c){s=s||i.templateSettings;var u,l,p=s.append?o.append:o.split,d=0,f=s.use||s.define?t(s,r,c||{}):r;f=("var out='"+(s.strip?f.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):f).replace(/'|\\/g,"\\$&").replace(s.interpolate||a,function(e,t){return p.start+n(t)+p.end}).replace(s.encode||a,function(e,t){return u=!0,p.start+n(t)+p.endencode}).replace(s.conditional||a,function(e,t,r){return t?r?"';}else if("+n(r)+"){out+='":"';}else{out+='":r?"';if("+n(r)+"){out+='":"';}out+='"}).replace(s.iterate||a,function(e,t,r,i){return t?(d+=1,l=i||"i"+d,t=n(t),"';var arr"+d+"="+t+";if(arr"+d+"){var "+r+","+l+"=-1,l"+d+"=arr"+d+".length-1;while("+l+"<l"+d+"){"+r+"=arr"+d+"["+l+"+=1];out+='"):"';} } out+='"}).replace(s.evaluate||a,function(e,t){return"';"+n(t)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,"").replace(/(\s|;|\}|^|\{)out\+=''\+/g,"$1out+="),u&&s.selfcontained&&(f="String.prototype.encodeHTML=("+e.toString()+"());"+f);try{return new Function(s.varname,f)}catch(g){throw"undefined"!=typeof console&&0,g}},i.compile=function(e,t){return i.template(e,null,t)}}(),vngageapp.define("models/claims",["require","underscore"],function(e){"use strict";var t=e("underscore"),n={};return{hasClaims:function(){return!t.isEmpty(n)&&n.claims.length>0},getClaims:function(){return n},setClaims:function(e){return n=e}}}),vngageapp.define("models/connectionModel",[],function(){"use strict";function e(){return n}function t(e){n=e}var n=null;return{tokenMismatch:!1,getCurrentUrl:e,setCurrentUrl:t}}),vngageapp.define("services/guidGenerator",[],function(){"use strict";return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16).toUpperCase()})}}),vngageapp.define("services/requesterPool",["require","underscore"],function(e){function t(e,t){o.push({id:e,cb:t})}function n(e){o=i.filter(o,function(t){return t.id!==e})}function r(e){var t=i.find(o,{id:e});return n(e),t.cb}var i=e("underscore"),o=[];return{find:r,add:t}}),vngageapp.define("stores/ConversationsStore",["require","pubsub","core/vngage/eventsVO"],function(e){"use strict";var t=e("pubsub"),n=e("core/vngage/eventsVO"),r={CONVERSATIONS:{}},i={add:function(e){r.CONVERSATIONS[e]={initialized:!1,id:e}},find:function(e){return r.CONVERSATIONS[e]},update:function(e,t){r.CONVERSATIONS[e]={initialized:!0,since:t,id:e}},remove:function(e){delete r.CONVERSATIONS[e]},getAll:function(){return r.CONVERSATIONS}};return t.subscribe(n.RECEIVE_AS_STATE,function(e,t){var n=t.action,r=n.conversationState,o=n.conversationId,a=i.find(o),s=r.stateTime;a&&!a.isInitialized&&i.update(o,s)}),t.subscribe(n.RECEIVE_SINCE,function(e,t){var n=t.action,r=n.conversationId,o=n.rawMessages,a=i.find(r),s=o[o.length-1].createdAt;a&&!a.isInitialized&&i.update(r,s)}),i}),vngageapp.define("core/request/ConversationRequest",["require","appConfig","pubsub","core/vngage/eventsVO"],function(e){"use strict";var t=e("appConfig"),n=e("pubsub"),r=e("core/vngage/eventsVO"),i=function(e,t){this.guid=e,this.conversationId=t};return i.prototype.asRequest=function(){return{body:{},method:"get",tag:this.guid,uri:t.comm.restUrl+"Conversation/"+this.conversationId}},i.prototype.resolve=function(e){if(e.messages){var t=e.messages[0];t&&"chat"===t.messageType&&t.speaker&&t.speaker.visitId&&e.messages.shift()}n.publish(r.RECEIVE_AS_STATE,{action:{conversationState:e,conversationId:this.conversationId}})},i}),vngageapp.define("core/request/QueueInfoRequest",["require","appConfig","pubsub","core/vngage/eventsVO"],function(e){"use strict";var t=e("appConfig"),n=e("pubsub"),r=e("core/vngage/eventsVO"),i=function(e,t){this.guid=e,this.conversationId=t};return i.prototype.asRequest=function(){return{body:{},method:"get",tag:this.guid,uri:t.comm.restUrl+"Conversation/"+this.conversationId+"/QueueInfo"}},i.prototype.resolve=function(e){n.publish(r.QUEUE_INFO,e)},i}),vngageapp.define("core/request/ConversationSinceRequest",["require","appConfig","underscore","pubsub","core/vngage/eventsVO"],function(e){"use strict";var t=e("appConfig"),n=e("underscore"),r=e("pubsub"),i=e("core/vngage/eventsVO"),o=function(e,t,n){this.guid=e,this.conversationId=t,this.since=n};return o.prototype.asRequest=function(){return{body:{},method:"get",tag:this.guid,uri:t.comm.restUrl+"Conversation/"+this.conversationId+"/Since?timestamp="+this.since}},o.prototype.resolve=function(e){if(e&&e.length>0){var o;if(n.find(e,{type:"conversationClosed"})&&r.publish(i.CONVERSATION_CLOSED,{action:{conversationId:this.conversationId}}),n.find(e,{type:"conversationStarted"})&&r.publish(i.CONVERSATION_STARTED),n.find(e,{type:"conversationSuspended"})&&r.publish(i.CONVERSATION_SUSPENDED),n.find(e,{type:"conversationResumed"})&&r.publish(i.CONVERSATION_RESUMED),(o=n.filter(e,{type:"participantJoined"}))&&o.length&&r.publish(i.PARTICIPANT_JOINED,{action:{participant:o,conversationId:this.conversationId}}),(o=n.filter(e,{type:"participantLeft"}))&&o.length&&r.publish(i.PARTICIPANT_LEFT,{action:{participant:o,conversationId:this.conversationId}}),o=n.find(e.slice().reverse(),{messageType:"video"})){var a={outStreamId:o.streamId,inStreamId:"1"+o.streamId,conf:t.visitor},s="start"===o.activity?i.VIDEO_START:i.VIDEO_STOP;r.publish(s,a)}(o=n.find(e,{messageType:"domHighlight"}))&&r.publish(i.COBROWSER_HIGHLIGHT,{action:{data:{targetPath:o.targetPath,targetId:o.targetId,targetName:o.targetName,targetSelectors:o.targetSelectors},conversationId:this.conversationId}}),n.find(e,{messageType:"askForDomUpload"})&&r.publish(i.COBROWSER_DOMUPLOAD,this.conversationId),r.publish(i.RECEIVE_SINCE,{action:{rawMessages:e,conversationId:this.conversationId}})}},o}),vngageapp.define("core/request/PollRequester",["require","underscore","pubsub","core/vngage/eventsVO","connection","./../../services/guidGenerator","stores/ConversationsStore","./ConversationRequest","./QueueInfoRequest","./ConversationSinceRequest"],function(e){"use strict";var t=e("underscore"),n=e("pubsub"),r=e("core/vngage/eventsVO"),i=e("connection"),o=e("./../../services/guidGenerator"),a=e("stores/ConversationsStore"),s=e("./ConversationRequest"),c=e("./QueueInfoRequest"),u=e("./ConversationSinceRequest"),l={},p=!1;return{init:function(){n.subscribe(r.CONVERSATION_CLOSED,function(){p=!1}),p=!0,this.poll()},stop:function(){p=!1},poll:function(){if(p){l={};var e,d,f=a.getAll();for(var g in f)f.hasOwnProperty(g)&&(d=f[g],d.initialized?(e=o(),l[e]=new u(e,g,d.since)):(e=o(),l[e]=new s(e,g)),"Queued"===vngage.get("currentstate")&&(e=o(),l[e]=new c(e,g)));var h={items:[]},v=t.values(l);for(var m in v)v.hasOwnProperty(m)&&h.items.push(v[m].asRequest());var y=this;h.items.length>0?i.post("Batch",JSON.stringify(h)).then(function(e,i){return e&&(0,p=!1,n.publish(r.ERROR_CONNECTION)),p?(i=i||{},t.each(i.items,function(e){if("closed"===e.body.state)p=!1,n.publish(r.CONVERSATION_CLOSED,{action:{conversationId:e.body.id}});else if(403===e.statusCode&&"failedConversationAuthorization"===e.body.errorCode)n.publish(r.CONVERSATION_UNAUTHORIZED),p=!1,n.publish(r.BLOCK),n.publish(r.CONVERSATION_CLOSED);else{var t=l[e.tag];t&&t.resolve(e.body)}}),p?(h={items:[]},void setTimeout(function(){y.poll()},3e3)):!1):!1}):setTimeout(function(){y.poll()},3e3)}}}}),vngageapp.define("core/request/ConversationsMyRequest",["require","promise","connection"],function(e){"use strict";function t(){var e=new n.Promise;return r.get("Conversation/Current/My").then(function(t,n){t||0===n.length?e.done("no conversations"):e.done(null,n[0])}),e}var n=e("promise"),r=e("connection");return{fetch:t}}),vngageapp.define("services/guidToUpper",["require","core/common/json"],function(e){"use strict";function t(e,t){return t=t||/[A-Z]/g,e.replace(t,function(){return arguments[0].toUpperCase()})}function n(e){return"object"!=typeof e?!1:r.parse(t(r.stringify(e),i))}var r=e("core/common/json"),i=/[A-z0-9]{8}-([A-z0-9]{4}-){3}[A-z0-9]{12}/g;return{map:n}}),vngageapp.define("applications/psLegacy/parts/visitorCORS",["require","pubsub","connection","core/vngage/eventsVO","core/common/json","services/requesterPool","services/guidToUpper"],function(e){function t(e){function t(e){var t,n=e.body||null,r=e.tag,i=e.statusCode;if((200>i||i>=300)&&304!==i)return console.error("_responseHandler got the following response ("+i+")",e),!1;if("string"==typeof n&&""!==n&&(t=o.parse(n),t&&t.status&&t.status.error))throw t.status.error.type;if(!r)return console.error("responseHandler (a.k.a. data.tag) is undefined"),!1;for(var s in r)try{var c=a.find(s);c&&c(t);
}catch(u){console.error("_responseHandler exception:",u,psPlugin.application[s][r[s]],n)}}function s(){d||(f&&(p.length<1||p.length>0&&"undefined"!=typeof p[0].body&&-1===p[0].body.indexOf("method=registerv2"))&&(p.unshift(f),f=!1),r.post(p).then(function(e,r){if(e)n.publish(i.ERROR_CONNECTION,e);else{if(r&&r.items&&r.items.length)for(var o=r.items,a=0,s=o.length;s>a;a++)try{t(o[a])}catch(c){switch(console.error("ConnectionError: BUNDLE:",c,a,o[a],p),c){case"visitor already in queue":case"VisitorAlreadyInQueue":n.publish(i.ERROR_ALREADYINQUEUE);break;case"UnknownVisitor":case"Unknown visitor":n.publish(i.ERROR_UNKNOWNVISITOR);break;case"MissingParameter":case"UnhandledException":n.publish(i.ERROR_CONNECTION,c)}}d=!1}}),p=[]),u=!1}var c=!1,u=!1,l=300,p=[],d=!1,f=!1;this.send=function(e){var t;e&&(t=o.parse(o.stringify(e))),!t||c||"undefined"==typeof t.groupJoin&&"undefined"==typeof t.routeSubscribe&&"undefined"==typeof t.listen||(c=!0),"object"==typeof t&&("string"==typeof t.body&&t.body.indexOf("method=heartbeat")>-1?f=t:p.push(t)),u||(u=setTimeout(s,l))}}var n=e("pubsub"),r=e("connection"),i=e("core/vngage/eventsVO"),o=e("core/common/json"),a=e("services/requesterPool");e("services/guidToUpper");return t}),vngageapp.define("applications/psLegacy/parts/jsExt",["require"],function(e){var t={htmlEncode:function(e){var t=document.createElement("div");return e?(t.innerText=t.textContent=e,t.innerHTML):e},htmlDecode:function(e){var t=document.createElement("div");return e?(t.innerHTML=e,t.textContent||t.innerText||""):e}};return t}),vngageapp.define("applications/psLegacy/parts/session",["require","core/vngage/store-localStorage","core/vngage/store-cookies"],function(e){"use strict";var t=e("core/vngage/store-localStorage"),n=e("core/vngage/store-cookies");return function(){function e(){for(var e in c)c.hasOwnProperty(e)&&"object"==typeof c[e]&&(a[e]=c[e])}function r(){c=t.getSessionData(),e()}function i(){t.saveSessionData(a),e()}function o(e){for(var t in e)e.hasOwnProperty(t)&&(c[t]=e[t]);i()}var a=this,s=n.getVisitorToken()||"",c={user:{id:s,state:"Ready"}};this.load=r,this.save=i,this.addObject=o}}),vngageapp.define("applications/psLegacy/parts/shellLoader",["require","applications/psLegacy/parts/visitorCORS","applications/psLegacy/parts/jsExt","applications/psLegacy/parts/session"],function(e){function t(){this.jsExt=r,window.psPlugin&&window.psPlugin.core&&(window.psPlugin.core.jsExt=this.jsExt),this.session=new i,this.connections={}}var n=e("applications/psLegacy/parts/visitorCORS"),r=e("applications/psLegacy/parts/jsExt"),i=e("applications/psLegacy/parts/session");return t.prototype.startConnection=function(){this.connections.comServer3=new n},new t}),vngageapp.define("services/requester",["require","promise","core/common/json","appConfig","models/connectionModel","services/guidGenerator","core/vngage/eventsVO","pubsub","services/requesterPool","core/vngage/logger","./../core/request/PollRequester","stores/ConversationsStore","connection","./../core/request/ConversationsMyRequest","applications/psLegacy/parts/shellLoader"],function(e){"use strict";function t(){return C}function n(){C||(d.tokenMismatch=!1,_.fetch().then(function(e,t){e?h.publish(g.ERROR_UNKNOWNVISITOR):(b.add(t),y.init(),C=!0)}))}function r(){y.stop(),C=!1}function i(e){var t=new u.Promise,n=f(),r={uri:"Command/Proxy25/Visitor",method:"POST",body:o(e),tag:{}};return console.warn("DEPRECATED! requester.request:",e,r),r.tag[n]="responseHandler",I(e.method,r.body),v.add(n,function(n){n&&""!==n&&"object"!=typeof n&&(n=l.parse(n)),I(e.method,n),t.done(null,n)}),E.connections.comServer3.send(r),t}function o(e){var t;if("undefined"!=typeof e)if(""!==e){t="rid2="+Math.random();for(var n in e)"object"==typeof e[n]&&(e[n]=l.stringify(e[n])),t+="&"+n+"="+encodeURIComponent(e[n])}else t="rid2="+Math.random();else t="rid2="+Math.random();return'{"data":"'+t+'"}'}function a(e){var t={type:"interactive",opportunityId:e.opportunityId,solutionId:e.solutionId,languageId:p.currentSiteId,groupId:e.groupId,caseType:e.caseType,correlationId:e.correlationId};e.startCode&&(t.startCode=e.startCode),e.messages&&e.messages.length&&(t.messages=e.messages);var n=new u.Promise;return w.post("Conversation",t).then(function(e,t){return e?(("string"!=typeof e||""===e)&&(e="failedConversation"),n.done(e,t),!1):d.tokenMismatch?(n.done("tokenmismatch"),n):(b.add(t.id),C=!0,y.init(),void n.done(null,"success"))}),n}function s(e){var t=new u.Promise;return w.post("Conversation",e).then(function(e,n){return e?(t.done("failedConversation"),!1):d.tokenMismatch?(t.done("tokenmismatch"),t):void t.done(null,"success")}),t}function c(){return d.tokenMismatch}var u=e("promise"),l=e("core/common/json"),p=e("appConfig"),d=e("models/connectionModel"),f=e("services/guidGenerator"),g=e("core/vngage/eventsVO"),h=e("pubsub"),v=e("services/requesterPool"),m=e("core/vngage/logger"),y=e("./../core/request/PollRequester"),b=e("stores/ConversationsStore"),w=e("connection"),_=e("./../core/request/ConversationsMyRequest"),E=e("applications/psLegacy/parts/shellLoader"),C=!1,I=function(){return m.reqres?function(e,t){("heartbeat"!==e||m.heartbeat&&t.status)&&m.log(t,e+(t.status?":response":""))}:function(){}}();return{request:i,callbackRequest:s,isListening:t,stop:r,resume:n,register:a,tokenMismatch:c}}),vngageapp.define("models/navigationValues",["require"],function(e){"use strict";return{urlImageId:0,score:0,url:"",psSite:"",psLanguage:""}}),vngageapp.define("services/requesterCalls",["require","underscore","services/requester","models/connectionModel","promise","pubsub","appConfig","core/vngage/eventsVO","cookies","models/navigationValues","applications/psLegacy/parts/shellLoader"],function(e){var t,n=e("underscore"),r=e("services/requester"),i=e("models/connectionModel"),o=e("promise"),a=e("pubsub"),s=e("appConfig"),c=e("core/vngage/eventsVO"),u=e("cookies"),l=e("models/navigationValues"),p=e("applications/psLegacy/parts/shellLoader");return{proactiveQuarantine:function(){var e=15;try{e=parseInt(s.visitor.dialogQuarantine,10)}catch(t){}e>0&&(e=60*e,u.set("ps_pQ",1,{expires:e}))},focusBannerQuarantine:function(){var e=1;try{"string"==typeof s.visitor.shortQuarantine&&(e=parseInt(s.visitor.shortQuarantine,10))}catch(t){}e>0&&(e=60*e,u.set("ps_bQ",1,{expires:e}))},joinQueue:function(e){var t=new o.Promise;return e.isProactive=e.isProactive||!1,"undefined"!=typeof e.code&&(e.phoneId=e.code),r.register(e).then(function(n,r){return n?t.done(n,r):(e.isProactive?(p.session.user.startType="Proactive",p.session.save()):(p.session.user.startType="Queued",p.session.save(),a.publish(c.QUEUE_JOINED)),t.done(null,r)),t})},addHistory:function(e){r.request({method:"addhistory",currentURL:{url:e,URL:e,score:10,urlGroupId:1,psLanguage:s.currentSiteId},urlGroupId:"psAjaxNavigate"});var t=e;try{window.vngage.extensions.decorateCobrowserUrl&&(t=window.vngage.extensions.decorateCobrowserUrl(e))}catch(n){t=e}return l.url=t,!0},getPageWithFormValues:function(e){var t={type:"coBrowser",data:{command:"getPageWithFormValues"}};a.publish(c.LEGACY_ACTION,t)},sendChatMessage:function(e){return r.request({method:"chat",chatMessage:e})},getChatHistory:function(){return r.request({method:"activecasechathistory"}).then(function(e,n){e||(t?t.set(n):vngageapp.require(["services/chatHistory"],function(e){t=e,t.set(n)}))})},sendAction:function(e,t){return i.tokenMismatch?!1:r.request({method:"clientmsg",func:e,args:"",type:"true",msg:JSON.stringify(t),actionId:"-1"})},mailToCS:function(e,t){if(!t||!t.config||"object"!=typeof e)return!1;var i=t.config,o=[],a={type:"callbackRequest",opportunityId:i.opportunityId,solutionId:i.solutionId,siteId:s.currentSiteId,groupId:i.groupId,caseType:i.caseType,correlationId:i.correlationId,messages:[]};n.each(e,function(e,t){o.push({key:t,value:e})}),a.messages.push({messageType:"form",form:o}),r.callbackRequest(a)},callguideCallBack:function(e,t){if("undefined"!=typeof t&&t.hasOwnProperty("Errand")){var n={type:"callguide",data:t,tag:{}};return p.connections.comServer3.post({url:"CallbackRequest",data:n}),!0}return!1},visitorNavigate:function(e){psPlugin.application.modules.coWorker.coBrowser?a.publish(c.COBROWSER_VISITOR_NAVIGATED_LINK,decodeURIComponent(e.data)):document.location=decodeURIComponent(e.data)},navigate:function(e,t){return psPlugin.application.modules.coWorker.coBrowser?(this.visitorNavigate(e),void(t&&a.publish(c.LEGACY_ACTION,e))):!1},saveStateToSession:function(e){return p.session.user.state===e?!1:(u.set("psCurrentState",e),p.session.user.state=e,p.session.save(),!0)},Enlist:function(e){var t=new o.Promise;return e.isProactive=!0,"undefined"!=typeof e.code&&(e.phoneId=e.code),r.register(e).then(function(e,n){return e?t.done(e):(p.session.user.startType="Proactive",p.session.save(),t.done(null,n)),t})},Leave:function(){r.request({method:"clientCommand",clientCommands:[{command:"leaveQueue"}]}).then(function(e,t){r.stop()})},TimedOut:function(){return r.request({method:"clientCommand",clientCommands:[{command:"leaveQueue"}]}).then(function(e,t){return e?!1:void r.stop()})},Reject:function(){return r.request({method:"clientCommand",clientCommands:[{command:"declineDialog"}]})},EndDialog:function(){r.request({method:"clientCommand",clientCommands:[{command:"closeDialogue"}]})},Close:function(){a.publish(c.CLOSE)}}}),vngageapp.define("language",["require","underscore"],function(e){"use strict";var t=e("underscore"),n={store:{},set:function(e){n.store=e},get:function(){return n.store},i18n:function(e){e=e||{};var r={__:function(e){return n.store[e]||"{{! "+e+" !}}"}};return t.extend(e,r)}};return n}),vngageapp.define("applications/banners/validation",["require","underscore","vergic.dom","language","applications/banners/classes"],function(e){"use strict";function t(e){var t=/input/i,n=/(radio|checkbox)/i;return t.test(e.nodeName)&&n.test(e.type)}function n(e){var n=!0,o={};return a.each(e.elements,function(a){var s=r(a);n&&s?(n=!1,a.focus(),i(e,a,s)):s||!a.value||!a.name||t(a)&&!a.checked||(o[a.name]=a.value)}),n?o:!1}function r(e){function t(){return e.value||(o="required"),"radio"===e.type?o=!1:"checkbox"===e.type&&(o=e.checked?!1:"required"),s.hasClass(e,l.placeholder)&&(o="required"),!!o}function n(){var t,n;return n={email:"^\\S+@\\S+\\.\\S+$",phone:"^[0-9 ()\\-+]+$",tel:"^[0-9 ()\\-+]+$"},t=e.pattern||n[e.getAttribute("type")],t=new RegExp(t,"i"),t.test(e.value)?void 0:(o=!0,!0)}function r(){var t=Number(e.value),n=Number(e.getAttribute("min")),r=Number(e.getAttribute("max"));return"number"!==e.getAttribute("type")?!1:(isNaN(t)?o=!0:!isNaN(n)&&n>t?o=!0:!isNaN(r)&&t>r&&(o=!0),!!o)}var i,o=!1;return e.disabled||!e.required?!1:(i=[t,n,r],a.some(i,function(e){return e()}),s.addClass(e,l.dirty),s.removeClass(e,l.pristine),o?(s.addClass(e,l.invalid),s.removeClass(e,l.valid)):(s.addClass(e,l.valid),s.removeClass(e,l.invalid)),o)}function i(e,t,n){function r(n){function r(){s.addClass(p,l.messageShow),o=a.delay(i,5e3)}var c,u,d,f,g;window.clearTimeout(o),e.appendChild(p),d=t.getBoundingClientRect(),f=e.getBoundingClientRect(),c=d.bottom,c-=f.top,p.style.top=Math.round(c)+"px",u=d.left,u-=f.left,p.style.left=Math.round(u)+"px",g="radio"===t.type||"checkbox"===t.type?"add":"remove",s[g+"Class"](p,l.messageOffset),n===!0?r():requestAnimationFrame(r)}function i(){window.clearTimeout(o),s.removeClass(p,l.messageShow),o=a.delay(function(){p.parentNode&&p.parentNode.removeChild(p)},400)}function u(){return p.parentNode===e&&s.hasClass(p,l.messageShow)}var g,h,v=c.get();"required"===n?g=v.validationRequired:n&&(g=v.validationInvalid),d.nodeValue=g,f.nodeValue=t.title||"",u()?r(!0):requestAnimationFrame(r),h=function(e){i(),this.removeEventListener(e.type,h)},t.addEventListener("blur",h)}var o,a=e("underscore"),s=e("vergic.dom"),c=e("language"),u=e("applications/banners/classes"),l=u(),p=s.createElement("div","",l.message),d=s.createElement("p","Default"),f=s.createElement("small","Default");return p.appendChild(d),p.appendChild(f),d=d.firstChild,f=f.firstChild,{form:n,element:r}}),vngageapp.define("applications/banners/forms",["require","underscore","vergic.dom","models/claims","services/requesterCalls","applications/banners/validation","applications/banners/classes"],function(e){"use strict";function t(){psPlugin.forms=psPlugin.forms||{},psPlugin.forms.codeStarter=[{type:"number",name:"code",min:1e4,max:99999,title:"You need to enter 5 digits",placeholder:"Write your code",required:!0},{type:"submit",label:"Send code"}]}function n(e,n,i,o){function s(e){e.target&&_.hasClass(e.target,O.dirty)&&I.element(e.target)}var c,u=!1,l={};t(),/form/i.test(n.nodeName)&&("mailToCs"===i?i=v:("codeStarter"===i&&(o=o||"codeStarter"),i=y),_.addClass(n,O.form),n.noValidate=!0,c=psPlugin.forms[o],c?(n.innerHTML="",l["default"]=a(n),w.each(c,r.bind(e,n,l))):w.each(n.elements,function(t){g(e,t,!0),d(e,t)}),e.addListener&&(e.addListener(n,"keyup",w.debounce(s,5)),e.addListener(n,"change",s)),n.addEventListener("submit",function(t){var r;t.preventDefault(),r=I.form(n),!u&&r&&(u=!0,i(e,r)&&h(n))}),e.addListener&&e.addListener(n,"reset",function(){w.each(n.elements,function(t){g(e,t,!0)})}))}function r(e,t,n){var r,a,u;switch(n=w.extend({},n),r=i.bind(this,n),a=o.bind(this,n,r),u=s(n.className,n.type),n.type){case"title":n.type="hidden",n.name="title",u=r("input",u,T);break;case"textarea":n.type=!1,r("textarea",u);break;case"radio":a(u);break;case"checkbox":w.isArray(n.options)?a(u):(c(n),r("input",u,x));break;case"select":n.type=!1,w.each(n.options,function(e){e.label&&(c(e),r("option",this,T,e.label,e))}.bind(r("select",u)));break;case"submit":case"reset":case"button":r("button",u,T,n.label);break;default:r("input",u)}l(e,t,n.section,u)}function i(e,t,n,r,i,o){var a,s,c,l;return r=r||A,o=o||{},w.defaults(o,e),a=_.createElement(t,i),p(this,a,o),f(a)?_.addClass(a,O.typeText):"button"===t&&_.addClass(a,O.typeButton),g(this,a),c=o.label,c||r!==x||(c="Radio/checkbox label"),c&&r!==T&&(s=_.createElement("label",c,O.label),n.appendChild(s)),r===x?(s.insertBefore(a,s.firstChild),u(s,o.required)):n.appendChild(a),r===A&&(u(s,o.required),l=o.name?O.prefix+o.name:"",s&&l&&(a.id=l,s.setAttribute("for",l))),a}function o(e,t,n){var r=_.createElement("div","",O.formGroup),i=_.createElement("label",e.label,O.lab);e.label&&(n.appendChild(i),u(i,e.required)),w.each(e.options,function(e){c(e),t("input",r,x,"",e)}),n.appendChild(r)}function a(e,t){var n,r=_.createElement("fieldset");return t&&(n=_.createElement("legend",t),r.appendChild(n)),e.appendChild(r),r}function s(e,t){var n=_.createElement("div");return _.addClass(n,O.formRow),_.addClass(n,e),/^(submit|reset|button)$/.test(t)&&_.addClass(n,O.buttonRow),n}function c(e){w.isUndefined(e.value)&&e.label&&(e.value=e.label)}function u(e,t){var n;t&&e&&(n=_.createElement("span","*",O.required),e.appendChild(n))}function l(e,t,n,r){n=n||"default",t[n]||(t[n]=a(e,n)),t[n].appendChild(r)}function p(e,t,n){var r=/^(required|disabled)$/,i=["label","className","section","options"];n=w.omit(n,i),w.each(n,function(n,i){n&&"checked"===i?t.setAttribute(i,i):n&&r.test(i)?t[i]=!0:"placeholder"===i?d(e,t,n):"value"===i&&/textarea/i.test(t.nodeName)?t.innerHTML=n:"submit"===i?t.setAttribute("data-submit",n):t.setAttribute(i,n)})}function d(e,t,n){function r(){""===t.value&&(t.value=n,_.addClass(t,o))}function i(){t.value===n&&_.hasClass(t,o)&&(t.value="",_.removeClass(t,o))}var o=O.placeholder,a=/^(input|textarea)$/i;if(n)t.setAttribute("placeholder",n);else{if(n||!t.getAttribute("placeholder"))return;n=t.getAttribute("placeholder")}!b()&&a.test(t.nodeName)&&(e.addListener&&(e.addListener(t,"blur",r),e.addListener(t,"focus",i)),r())}function f(e){var t=/(input|textarea)/i,n=/(radio|checkbox|button)/i;return t.test(e.nodeName)&&!n.test(e.type)}function g(e,t,n){function r(e){I.element(this),_.addClass(this,O.dirty),_.removeClass(this,O.pristine),this.removeEventListener(e.type,r)}function i(e){function t(e){var n,r="change";document.createEvent?(n=document.createEvent("HTMLEvents"),n.initEvent(r,!0,!0)):(n=document.createEventObject(),n.type=r),n.eventName=r,this.dispatchEvent(n),this.removeEventListener(e.type,t)}this.addEventListener("blur",t),this.removeEventListener(e.type,i)}/button/i.test(t.nodeName)||(n&&(_.removeClass(t,O.dirty),_.removeClass(t,O.valid),_.removeClass(t,O.invalid)),_.addClass(t,O.pristine),f(t)&&e.addListener&&e.addListener(t,"keyup",i),e.addListener&&e.addListener(t,"change",r))}function h(e){w.each(e.elements,function(e){var t=e.firstChild,n=e.getAttribute("data-submit");e.disabled=!0,_.removeClass(e,O.dirty),_.removeClass(e,O.pristine),_.removeClass(e,O.valid),_.removeClass(e,O.invalid),n&&t&&t.nodeValue?t.nodeValue=n:/input/i.test(e.tagName)&&n?e.value=n:n&&e.appendChild(document.createTextNode(n))})}function v(e,t){return C.mailToCS(t,e),!0}function m(e){var t={claims:[]};w.each(e,function(n,r){if(e.vngageProfileData.indexOf(r)>-1){w.isArray(n)||(n=[n]);var i={type:r,values:n};t.claims.push(i)}}),E.setClaims(t)}function y(e,t){return e.config.code=t.code,t.vngageProfileData&&m(t),e.join(),!1}var b,w=e("underscore"),_=e("vergic.dom"),E=e("models/claims"),C=e("services/requesterCalls"),I=e("applications/banners/validation"),S=e("applications/banners/classes"),O=S(),T=1,A=2,x=3;return b=w.once(function(){return"placeholder"in document.createElement("input")}),n}),vngageapp.define("applications/banners/html-compile",["require","underscore","doT","applications/banners/forms"],function(e){"use strict";function t(e,t){var r,i;t=t||this.config[e+"Target"],i=this.config[e],"string"==typeof i&&(i=this.config[e]=a.template(i,c)),r=i(o.extend({},this.config.status,this.config.texts)),t&&"innerHTML"in t&&(t.innerHTML=r,n.call(this,t))}function n(e){var t,n="data-vngage-banner",i=/^(addListener|update)$/;e=e||this.config.htmlTarget,t=e.querySelectorAll("["+n+"]"),o.each(t,r.bind(this,n,i))}function r(e,t,r){function a(e){var i=this[e.method];"message"===e.method?(this.config.messageDefault||(this.config.messageDefault=this.config.title,this.config.publishDefault=this.config.publish),this.addListener(r,"change",c.bind(r,this,e)),this.addListener(r,"keydown",u.bind(r,this,e))):o.includes(["formJoin","mailToCs","codeStarter"],e.method)?(e.params.unshift(this,r,e.method),s.apply(this,e.params),n.call(this,r)):o.includes(["bannerId","groupId","caseTypeId","message"],e.method)?/select/i.test(r.nodeName)&&(e.method=e.method.replace("bannerId","id"),this.addListener(r,"change",function(){var t={};t[e.method]=r.value,this.update(t)}.bind(this))):o.isFunction(i)&&!t.test(e.method)&&this.addListener(r,e.event,function(){i.apply(this,e.params)}.bind(this))}function c(e,t){var n=this.value,r=e.config,i="false"!==t.params[0];n?(r.title=n,r.publish=i):(r.title=r.messageDefault,r.publish=r.publishDefault)}function u(e,t,n){(10===n.keyCode||n.ctrlKey&&13===n.keyCode)&&(c.call(this,e,t),e.join())}var l=i(r.getAttribute(e));o.each(l,a.bind(this))}function i(e){function t(e){var t=e.split(" ");return{method:t[0],name:(t[1]||"click").trim()}}function n(e){var t=[];return e&&e.length>0&&o.each(e.split(","),function(e){t.push(e.trim())}),t}var r=[],i=e.split(";");return o.each(i,function(e){var i,o;e=e||"",i=e.trim().split("|"),o=t(i[0]),r.push({method:o.method,event:o.name,params:n(i[1])})}),r}var o=e("underscore"),a=e("doT"),s=e("applications/banners/forms"),c={evaluate:/\{\{([\s\S]+?\}?)\}\}/g,interpolate:/\{\{\!\=([\s\S]+?)\}\}/g,encode:/\{\{\=([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"conf",strip:!0,append:!0,selfcontained:!1};return t}),vngageapp.define("applications/banners/events",["require","underscore","core/vngage/eventsVO","applications/banners/helpers","applications/banners/html-compile"],function(e){"use strict";function t(){this.config.mouseExpand&&this.addListener(this.el,"mouseenter",function(){o.mobileSize(this.config.mobileSize)||this.expand()}.bind(this)),this.config.mouseCollapse&&this.addListener(this.el,"mouseleave",function(){o.mobileSize(this.config.mobileSize)||this.show()}.bind(this))}function n(e){e.subscribe(i.BANNER_STATUS_UPDATE,function(e,t){var n=t[this.config.groupId];r.isString(n)&&(this.config.status=o.groupStatus(n),o.shouldDisplay(this.config)?(a.call(this,"html"),o.availabilityClasses.call(this)):this.close())}.bind(this)),e.subscribe(i.BANNER_OVERLAY_CLICK,function(){r.isObject(this.config.overlay)&&this.config.overlay.doBannerMethod()}.bind(this)),e.subscribe(i.BANNER_REMOVEALL,this.close.bind(this)),e.subscribe(i.BANNER_REMOVE,function(e,t){this.config.id===t&&this.close()}.bind(this))}var r=e("underscore"),i=e("core/vngage/eventsVO"),o=e("applications/banners/helpers"),a=e("applications/banners/html-compile");return{defaults:t,subscriptions:n}}),vngageapp.define("applications/banners/Banner",["require","underscore","pubsub","vergic.dom","core/vngage/eventsVO","applications/banners/events","applications/banners/helpers","applications/banners/html-compile"],function(e){"use strict";function t(e){e.listeners=[],e.api=g,this.config=e,this.el=y.createWrapper.call(this,e),b.call(this,"html"),y.availabilityClasses.call(this),y.setupAddMethod.call(this),m.defaults.call(this),m.subscriptions.call(this,e.api),e.afterRender.call(this),y.creationDisplay.call(this,e),g.publish(v.BANNER_RENDERED,this)}function n(e,t){var n,r,i=this.config;"undefined"==typeof t&&(t=i.publish||!1),e=e||i.title,t===!0&&f.isString(e)&&e!==i.messageDefault&&(r=e),n={solutionId:i.id,groupId:i.groupId,caseType:i.caseTypeId,opportunityId:i.opportunityId,correlationId:i.correlationId},f.isString(i.code)&&5===i.code.length&&(n.startCode=i.code,e=i.code+" - "+e),n.messages=[{messageType:"title",message:e}],t&&r&&n.messages.push({messageType:"chat",message:r}),g.publish(v.BANNER_JOIN,n)}function r(){this.config.closed||(f.each(this.config.listeners,function(e){e.el.removeEventListener(e.method,e.listener)}),y.displayTimerClear.call(this),this.hide(),this.config.closed=!0,this.config.api.publish(v.BANNER_CLOSE,this))}function i(e,t){var n=this.config,r=t?n.id:n.template;e=Number(e)||n.quarantine,this.config.api.publish(v.BANNER_QUARANTINE,{type:r,duration:e}),this.close()}function o(e){var t=["solutionId","groupId","caseTypeId","title"];e=f.pick(e,t),f.each(e,function(e,t){t=t.replace("solutionId","id"),this.config[t]=e}.bind(this))}function a(e,t){function n(e,n){h.addClass(this.el,n.inactive),h.removeClass(this.el,n.active),h.removeClass(this.el,n.expand),y.overlayMethod(this,e,"hide"),y.doIfPossible(t,this),this.el.parentNode===e.targetParent&&(e.displayTimer=f.delay(function(e){e.parentNode.removeChild(e)},1e3,this.el))}return y.display.call(this,"inactive",n,e)}function s(e,t){function n(e,n){function r(){e.addNode()&&(e.displayTimer=window.requestAnimationFrame(i.bind(this)))}function i(){h.addClass(this.el,n.active),h.removeClass(this.el,n.expand),h.removeClass(this.el,n.inactive),y.overlayMethod(this,e,"show"),y.doIfPossible(t,this)}e.displayTimerAnimationFrame=!0,e.displayTimer=window.requestAnimationFrame(r.bind(this))}var r=h.hasClass(this.el,this.config.classes.expand);return y.display.call(this,"active",n,e,r)}function c(e,t){function n(){h.addClass(this.el,this.config.classes.expand),y.overlayMethod(this,this.config,"expand"),y.doIfPossible(t,this)}return h.hasClass(this.el,this.config.classes.active)?y.display.call(this,"expand",n,e):(this.show(e,n),!0)}function u(e,t,n,r){function i(){y.doIfPossible(n,this),this.show(t,r)}return e>0||t>0?(t>0?e=e>0?e:0:e>0&&(r=n,n=t,t=e,e=0),this.expand(e,i.bind(this))):!1}function l(e,t){var n=this.show(e,t);return n||this.hide(e,t),n}function p(e,t){var n=this.expand(e,t);return n||this.show(e,t),n}function d(e,t,n){var r,i=w.exec(t);i?(t=t.replace(i[1],"enter"===i[1]?"over":"out"),r=function(e){y.isEnterOrLeave(this,e.relatedTarget)||n.call(this,e)}):r=n,e.addEventListener(t,r),this.config.listeners.push({el:e,method:t,listener:r})}var f=e("underscore"),g=e("pubsub"),h=e("vergic.dom"),v=e("core/vngage/eventsVO"),m=e("applications/banners/events"),y=e("applications/banners/helpers"),b=e("applications/banners/html-compile"),w=/^mouse(enter|leave)$/;return t.prototype.join=n,t.prototype.close=r,t.prototype.quarantine=i,t.prototype.update=o,t.prototype.hide=a,t.prototype.show=s,t.prototype.expand=c,t.prototype.intro=u,t.prototype.toggle=l,t.prototype.toggleExpand=p,t.prototype.addListener=d,t}),vngageapp.define("applications/banners/templates/tabbanner",["require","vergic.dom","core/vngage/eventsVO","applications/banners/helpers","applications/banners/html-compile"],function(e){"use strict";function t(){var e=document.createElement("div"),t=document.createElement("div");n.addClass(e,this.config.classes.prefix+"tab"),n.addClass(t,this.config.classes.prefix+"tab-text"),this.addListener(e,"click",this.toggleExpand.bind(this)),this.el.insertBefore(e,this.el.firstChild),e.appendChild(t),o.call(this,"htmlTab",t),this.config.api.subscribe(r.BANNER_STATUS_UPDATE,function(){i.shouldDisplay(this.config)&&o.call(this,"htmlTab",t)}.bind(this))}var n=e("vergic.dom"),r=e("core/vngage/eventsVO"),i=e("applications/banners/helpers"),o=e("applications/banners/html-compile");return{name:"tabbanner",displayMax:1,displayName:"Tabbanner",classes:{template:"tabbanner"},config:{htmlTab:"",mouseExpand:!1,mouseCollapse:!1},base:{content:!0,overlay:!0,overlayMethod:"expand",overlayMethodHide:"show",overlayMobileOnly:!0,afterRender:t}}}),vngageapp.define("applications/banners/templates/dooreye",["require","vergic.dom","core/vngage/eventsVO","applications/banners/helpers","applications/banners/html-compile"],function(e){"use strict";function t(){var e,t,a,s=this.el.firstChild;t=document.createElement("div"),n.addClass(t,s.className),this.el.insertBefore(t,s),t.appendChild(s),s.className=this.config.classes.prefix+"message",e=document.createElement("div"),a=document.createElement("div"),n.addClass(e,this.config.classes.prefix+"tab"),n.addClass(a,this.config.classes.prefix+"tab-text"),this.addListener(e,"click",this.toggleExpand.bind(this)),this.el.insertBefore(e,t),e.appendChild(a),o.call(this,"htmlTab",a),this.config.api.subscribe(r.BANNER_STATUS_UPDATE,function(){i.shouldDisplay(this.config)&&o.call(this,"htmlTab",a)}.bind(this))}var n=e("vergic.dom"),r=e("core/vngage/eventsVO"),i=e("applications/banners/helpers"),o=e("applications/banners/html-compile");return{name:"dooreye",displayMax:1,displayName:"Dooreye",classes:{template:"dooreye"},config:{htmlTab:"",mouseExpand:!1,mouseCollapse:!1},base:{content:!0,overlay:!0,overlayMethod:"expand",overlayMethodHide:"show",overlayMobileOnly:!0,afterRender:t}}}),vngageapp.define("applications/banners/templates/takeover",[],function(){"use strict";return{name:"takeover",displayMax:1,displayName:"Takeover",classes:{template:"takeover"},config:{},base:{content:!0,overlay:!0}}}),vngageapp.define("applications/banners/templates/injected",[],function(){"use strict";return{name:"injected",displayMax:0,displayName:"Injected",classes:{banner:"",template:"injected"},config:{tag:"div",target:"body",targetMethod:"append"},base:{mouseExpand:!0,mouseCollapse:!0}}}),vngageapp.define("applications/banners/templates/templates",["require","underscore","applications/banners/classes","applications/banners/templates/tabbanner","applications/banners/templates/dooreye","applications/banners/templates/takeover","applications/banners/templates/injected"],function(e){"use strict";function t(){var e={};return o.each(s,function(t){e[t.name]={displayMax:t.displayMax,displayName:t.displayName,config:o.extend({},t.config)}}),e}function n(e){var t=s[e.template];return e=o.extend({},t.base,t.config,e),e.classes=o.extend({},t.classes),e}var r,i,o=e("underscore"),a=e("applications/banners/classes"),s={};return i=[e("applications/banners/templates/tabbanner"),e("applications/banners/templates/dooreye"),e("applications/banners/templates/takeover"),e("applications/banners/templates/injected")],r={config:{html:"",introDelay:0,introDuration:0,introOnce:!1,introQuarantine:60,introPerTemplate:!1,extraClasses:"",id:"",groupId:"",caseTypeId:"",title:"",displayWhenOpen:!1,displayWhenBusy:!1,displayWhenClosed:!1},base:{tag:"div",intro:!0,content:!1,overlay:!1,publish:!1,overlayMethod:"show",overlayMethodHide:"close",overlayMobileOnly:!1,showDelay:.2,quarantine:120,mobileSize:640,mouseExpand:!1,mouseCollapse:!1,target:"body",targetMethod:"append",afterRender:function(){}}},o.each(i,function(e){s[e.name]=e,o.defaults(e.base,r.base),o.defaults(e.config,r.config),a(e.classes)}),{getAll:t,bannerConfig:n}}),vngageapp.define("applications/banners/presentation",["require","underscore","core/common/json","applications/banners/templates/templates"],function(e){"use strict";function t(e){var t,n,r,a=p[e.template],c=p.banners[e.id]||{},u=a.displayMax;return o(e.template,e.id)&&i(),t=s.includes(a.displayed,e.id),n=u&&a.displayed.length>=u,r=a.quarantine||c.quarantine,n||t||r?!1:((a.intro||c.intro)&&(e.intro=!1),!0)}function n(e,t){var n=p[e.template];t?n.displayed.push(e.id):n.displayed=s.reject(n.displayed,function(t){return t===e.id}),i()}function r(e,t){var n=p.banners,r=p[t.type];s.isUndefined(r)&&(r=n[t.type]=n[t.type]||{}),t.duration=6e4*t.duration,r[e]=(new Date).getTime()+t.duration,i()}function i(){var e=c.stringify(p);localStorage.setItem(l,e)}function o(e,t){function n(e){i(p.banners[e]),0===s.keys(p.banners[e]).length&&delete p.banners[e]}function r(e){i(p[e])}function i(e){e&&(e.intro<a&&(delete e.intro,o=!0),e.quarantine<a&&(delete e.quarantine,o=!0))}var o=!1,a=(new Date).getTime();return e||t?(n(t),r(e),o):(s.each(s.omit(p,"banners"),function(e,t){r(t)}),s.each(p.banners,function(e,t){n(t)}),o)}var a,s=e("underscore"),c=e("core/common/json"),u=e("applications/banners/templates/templates"),l="vngage.presentation",p={},d=[];return a=localStorage.getItem(l),a&&(a=c.parse(a),s.isObject(a)&&(p=a)),s.each(u.getAll(),function(e,t){p[t]=p[t]||{},p[t].displayed=[],p[t].displayMax=e.displayMax,d.push(t)}),p.banners=p.banners||{},d.push("banners"),p=s.pick(p,d),o(),i(),{checkDisplay:t,setDisplay:n,setQuarantine:r}}),vngageapp.define("applications/banners/handler",["require","pubsub","core/vngage/eventsVO","applications/banners/Banner","applications/banners/helpers","applications/banners/templates/templates","applications/banners/presentation"],function(e){"use strict";function t(){u.loadBannerCss(),u.htmlSupportClasses(),u.resizeTransitionDisable()}function n(e,t){var n,r=u.getConfig(e);return r&&d&&p.checkDisplay(r)?(r=l.bannerConfig(r),r.name=t.name,r.opportunityId=t.opportunityId,r.correlationId=t.correlationId,u.shouldDisplay(r)?(n=new c(r),a.publish(s.BANNER_ADD,n),p.setDisplay(r,!0),n):(p.setDisplay(r,!1),!1)):void 0}function r(e){a.publish(s.BANNER_REMOVE,e)}function i(){a.publish(s.BANNER_REMOVEALL)}function o(e){a.publish(s.BANNER_STATUS_UPDATE,e)}var a=e("pubsub"),s=e("core/vngage/eventsVO"),c=e("applications/banners/Banner"),u=e("applications/banners/helpers"),l=e("applications/banners/templates/templates"),p=e("applications/banners/presentation"),d=!0;return a.subscribe(s.QUEUESTATUS_CHANGE,function(e,t){o(t)}),a.subscribe(s.BANNER_CLOSE,function(e,t){p.setDisplay(t.config,!1)}),a.subscribe(s.BANNER_INTRO,function(e,t){p.setQuarantine("intro",t)}),a.subscribe(s.BANNER_QUARANTINE,function(e,t){p.setQuarantine("quarantine",t)}),{init:t,add:n,remove:r,removeAll:i,updateStatus:o}}),vngageapp.define("applications/analyze/session-updater",[],function(){"use strict";return function(e,t,n,r){var i=[];if("undefined"==typeof e.poi){var o={poi:{navigation:{currentPage:n,historyPage1:"",historyPage2:""},visitor:{score:0,isProactive:!1}}};e.addObject(o)}else e.poi.navigation.historyPage2=e.poi.navigation.historyPage1,e.poi.navigation.historyPage1=e.poi.navigation.currentPage,
e.poi.navigation.currentPage=n;for(var a in t.poi)if("object"==typeof t.poi[a]){var s=t.poi[a],c=e.poi[s.id]||{};if(e.poi[s.id]=r[s.key].evaluate(s,c),e.poi[s.id].matched===!0){var u={id:s.id,name:s.name,matched:!0};"purchaseConfirmation"===s.key&&(u.category="purchaseConfirmation"),i.push(u)}}return e.save(),i}}),vngageapp.define("applications/analyze/opportunity-poiTypes",[],function(){"use strict";return{html:{name:"HTML",key:"html",match:function(e){return!!document.getElementById(e)},evaluate:function(e,t){var n={total:t.total||0,consecutive:t.consecutive||0,consecutiveAway:t.consecutiveAway||0,matched:this.match(e.value)};return n.matched===!0?(n.total++,n.consecutive++,n.consecutiveAway=0):(n.consecutive=0,n.consecutiveAway++),n}},script:{name:"Script",key:"script",match:function(e){try{return!!window[e]()}catch(t){return!1}},evaluate:function(e,t){var n={total:t.total||0,consecutive:t.consecutive||0,consecutiveAway:t.consecutiveAway||0,matched:this.match(e.value)};return n.matched===!0?(n.total++,n.consecutive++,n.consecutiveAway=0):(n.consecutive=0,n.consecutiveAway++),n}},purchaseConfirmation:{name:"Purchase Confirmation",key:"purchaseConfirmation",match:function(e,t){return!!t&&e.toLowerCase().indexOf(t.toLowerCase())>-1},evaluate:function(e,t){var n={total:t.total||0,consecutive:t.consecutive||0,consecutiveAway:t.consecutiveAway||0,matched:this.match(psPlugin.application.URL,e.value)};return n.matched===!0?(n.total++,n.consecutive++,n.consecutiveAway=0):(n.consecutive=0,n.consecutiveAway++),n}},url:{name:"URL match",key:"url",match:function(e,t){return!!t&&e.toLowerCase().indexOf(t.toLowerCase())>-1},evaluate:function(e,t){var n={total:t.total||0,consecutive:t.consecutive||0,consecutiveAway:t.consecutiveAway||0,matched:this.match(psPlugin.application.URL,e.value)};return n.matched===!0?(n.total++,n.consecutive++,n.consecutiveAway=0):(n.consecutive=0,n.consecutiveAway++),n}},pattern:{name:"URL pattern match",key:"pattern",match:function(e,t){if(!t)return!1;"/"===t.charAt(0)&&(t=t.substr(1));var n="",r=t.lastIndexOf("/");r>=0&&0!==r&&"\\"!==t.charAt(r-1)&&(r<t.length&&(n=t.substr(r+1)),t=t.substr(0,r));try{var i=new RegExp(t,n);if(i.test(e))return!0}catch(o){}return!1},evaluate:function(e,t){var n={total:t.total||0,consecutive:t.consecutive||0,consecutiveAway:t.consecutiveAway||0,matched:this.match(psPlugin.application.URL,e.value)};return n.matched===!0?(n.total++,n.consecutive++,n.consecutiveAway=0):(n.consecutive=0,n.consecutiveAway++),n}}}}),vngageapp.define("applications/analyze/analyze",["require","underscore","core/vngage/track","appConfig","applications/analyze/collection","applications/psLegacy/parts/visitorIdentification","applications/banners/handler","core/vngage/logger","applications/analyze/session-updater","applications/analyze/opportunity-poiTypes","models/navigationValues","applications/psLegacy/parts/shellLoader"],function(e){"use strict";function t(){var e,t,n=g.currentSiteId,r=I.getItems(),i=C.getItems(),o=psPlugin.application.URL;for(T.add({type:"Navigation",url:o,referrer:"",visitId:"00000000-0000-0000-0000-000000000000",siteId:n,metaData:[]}),e=0,t=r.length;t>e;e++){var a=r[e],s={type:"PointOfInterest",visitId:"00000000-0000-0000-0000-000000000000",siteId:n,pointOfInterestId:a.id,name:a.name,matched:a.matched,tags:[],source:"visitor",tag:{}};a.category&&"purchaseConfirmation"===a.category&&(s.category="purchaseConfirmation"),T.add(s),a=null,s=null}for(e=0,t=i.length;t>e;e++)T.add({type:"Opportunity",visitId:"00000000-0000-0000-0000-000000000000",siteId:n,opportunityId:i[e].id,correlationId:i[e].evaluationScopeId,tags:[],source:"visitor",tag:{},score:i[e].score||0});f.add(T.getItems())}function n(){var e=g.comm.visitorIdAuthProxyUrl,t=g.comm.visitorIdLoggedInDetectionKeyword,n=g.comm.visitorIdLoggedInDetectionVariable;v.identify(psPlugin.application.URL,e,t,n)}function r(){d.each(O.getItems(),function(e){var t=m.add(e.id,{name:e.name,id:e.id,opportunityId:e.opportunityId,correlationId:e.correlationId});f.add({type:"Solution",visitId:"00000000-0000-0000-0000-000000000000",solutionId:e.id,siteId:g.currentSiteId,opportunityId:e.opportunityId,correlationId:e.correlationId,eventName:"Evaluated",tags:[],source:"visitor",tag:{}}),t&&(S.add(e),f.add({type:"Solution",visitId:"00000000-0000-0000-0000-000000000000",solutionId:e.id,siteId:g.currentSiteId,opportunityId:e.opportunityId,correlationId:e.correlationId,eventName:"Activated",tags:[],source:"visitor",tag:{}}))}),y.solutions&&setTimeout(function(){y.log(O.getItems(),"Solutions.evaluated: "+O.getItems().length),y.log(S.getItems(),"Solutions.activated: "+S.getItems().length)},0)}function i(){y.opportunities&&y.log(C.getItems(),"Opportunities:"+C.getItems().length)}function o(){var e=psPlugin.application.URL.substring(0,180),t=b(E,g.currentSite,e,w);_.urlImageId=0,_.score=0,_.url=location.href,_.psSite=g.comm.accountId,_.psLanguage=g.currentSiteId,u(t)}function a(){i(),r()}function s(){n(),t()}function c(e){C.add(e)}function u(e){I.add(e)}function l(e){S.add(e)}function p(e){O.add(e)}var d=e("underscore"),f=e("core/vngage/track"),g=e("appConfig"),h=e("applications/analyze/collection"),v=e("applications/psLegacy/parts/visitorIdentification"),m=e("applications/banners/handler"),y=e("core/vngage/logger"),b=e("applications/analyze/session-updater"),w=e("applications/analyze/opportunity-poiTypes"),_=e("models/navigationValues"),E=e("applications/psLegacy/parts/shellLoader").session,C=new h,I=new h,S=new h,O=new h,T=new h;return{report:s,evaluate:a,investigate:o,addOpportunity:c,addPointofInterest:u,addSolutionActivated:l,addSolutionEvaluated:p}}),vngageapp.define("services/themeRequester",["require","appConfig"],function(e){"use strict";function t(){var e,t,i=n.comm.host+"/visitor/"+vngage.version+"/"+n.comm.accountId+"/"+n.themes.dialog+".css";r||(r=!0,t=window.document.getElementsByTagName("script")[0],e=document.createElement("link"),e.href=i,e.type="text/css",e.rel="stylesheet",e.media="x none",e.id="vngageThemeCSS",t.parentNode.insertBefore(e,t),setTimeout(function(){e.media="all"}))}var n=e("appConfig"),r=!1;return{load:t}}),vngageapp.define("services/appLoader",["require","underscore","promise"],function(e){"use strict";function t(){i&&i.start()}function n(){function e(){vngageapp.require(["app"],function(e){i=e,c=!1,s=!0,u.done()})}return c||(c=!0,s?u.done():(r=o.once(e))()),u}var r,i,o=e("underscore"),a=e("promise"),s=!1,c=!1,u=new a.Promise;return{request:n,start:t}}),vngageapp.define("core/vngage/viewportmeta",["require","vergic.environment"],function(e){var t=e("vergic.environment");return function(e){var n=t.os.version&&t.os.ios?parseInt(t.os.version,10)>=10:!1,r=document.querySelector("meta[name=viewport]"),i="";if(e?i="width=device-width, height=device-height, initial-scale=1.0, minimum-scale=0.1":(i="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0",n&&(i+=" ,user-scalable=no")),r)r.setAttribute("content",i);else{var o=document.createElement("meta");o.setAttribute("name","viewport"),o.setAttribute("content",i);try{document.getElementsByTagName("head")[0].appendChild(o)}catch(a){}}}}),vngageapp.define("components/coBrowser/getPageContent",["require","underscore"],function(e){function t(e){var t,n=e?"<!DOCTYPE html>":null;try{if(t=document.doctype,null===t)return n;n="<!DOCTYPE "+t.name+(t.publicId?' PUBLIC "'+t.publicId+'"':"")+(!t.publicId&&t.systemId?" SYSTEM":"")+(t.systemId?' "'+t.systemId+'"':"")+">"}catch(r){}return n}function n(e){var n,r,i=document.getElementById("__VIEWSTATE"),o="";return e&&e!==document.documentElement||(o=t(!0),e=document.documentElement),i?(r=i.value,i.value="",n=e.outerHTML,i.value=r,o+n):o+e.outerHTML}function r(e){var t=[];return e=e||document.forms,i.each(e,function(e,n){var r,o=0;i.each(e.elements,function(e){switch(r=!0,e.tagName){case"INPUT":switch(e.type){case"hidden":"__VIEWSTATE"!==e.name&&"__EVENTVALIDATION"!==e.name&&t.push({form:n,element:o,attrib:"value",value:e.value});break;case"checkbox":case"radio":e.checked&&t.push({form:n,element:o,attrib:"checked",value:"checked"});break;case"password":break;default:e.value&&t.push({form:n,element:o,attrib:"value",value:e.value})}break;case"TEXTAREA":e.value&&t.push({form:n,element:o,attrib:"innerHTML",value:e.value});break;case"SELECT":"select-multiple"===e.type?i.map(i.filter(e.options,function(e){return e.selected}),function(e){t.push({form:n,element:o,child:e.index,attrib:"selected",value:"selected"})}):e.options[e.options.selectedIndex]&&t.push({form:n,element:o,child:e.options.selectedIndex,attrib:"selected",value:"selected"});break;default:r=!1}r&&o++})}),t}var i=e("underscore");return function(e){var t=window.psPlugin&&psPlugin.application&&psPlugin.application.URL?psPlugin.application.URL:document.location.href,i=e&&"function"==typeof e.getElementsByTagName,o=i?n(e):n(),a=r(i?e.getElementsByTagName("form"):document.forms);return{originalSource:t,html:o,form:a}}}),vngageapp.define("actions/ServerActions",["require","pubsub","appConfig","core/vngage/eventsVO","core/vngage/store-cookies","services/guidGenerator","components/coBrowser/getPageContent","stores/ConversationsStore","underscore","connection"],function(e){"use strict";var t=(e("pubsub"),e("appConfig")),n=(e("core/vngage/eventsVO"),e("core/vngage/store-cookies")),r=e("services/guidGenerator"),i=e("components/coBrowser/getPageContent"),o=e("stores/ConversationsStore"),a=e("underscore"),s=e("connection");return{visitorBlocked:function(){var e=t.visitor.blockVisitorDays||0;e>0&&n.block(r(),{expires:24*e*60*60})},conversationClosed:function(){console.error("deprecated")},sendDomUpload:function(e){e||(e=a.keys(o.getAll())[0]),s.sendPageDOM(e,i())}}}),vngageapp.define("core/vngage/stateGuard",["require","queueStatus"],function(e){"use strict";var t=e("queueStatus");return{join:function(e){var n=t.getStatus(e.groupId);return"open"===n||e.startCode&&"busy"===n}}}),vngageapp.define("core/vngage/stateMachine",["require","machina","appConfig","applications/analyze/analyze","language","connection","models/claims","models/connectionModel","applications/psLegacy/parts/shellLoader","services/requesterCalls","services/themeRequester","services/appLoader","services/requester","applications/banners/handler","core/vngage/viewportmeta","queueStatus","actions/ServerActions","./stateGuard"],function(e){"use strict";var t=e("machina"),n=e("appConfig"),r=e("applications/analyze/analyze"),i=e("language"),o=e("connection"),a=e("models/claims"),s=e("models/connectionModel"),c=e("applications/psLegacy/parts/shellLoader"),u=e("services/requesterCalls"),l=e("services/themeRequester"),p=e("services/appLoader"),d=e("services/requester"),f=e("applications/banners/handler"),g=e("core/vngage/viewportmeta"),h=e("queueStatus"),v=e("actions/ServerActions"),m=e("./stateGuard"),y=t.Fsm.extend({initialState:"",states:{"*":{Stop:function(){0,o.stopNoop()}},WaitingForResponse:{_onEnter:function(){var e=c.session;"undefined"==typeof e.user.state?(e.user.state="Ready",e.save()):("Completed"===e.user.state&&(e.user.state="Ready"),this.transition(e.user.state))},_onExit:function(){i.set(n.getVisitorLanguage())}},Ready:{_onEnter:function(){s.tokenMismatch=!1,h.startChecking()},PresentSolutions:function(){r.evaluate()},Join:function(e){var t=this;l.load();var n=setTimeout(function(e){t.handle("ErrorJoinQueue",{error:e})},6e3);h.refresh().then(function(r){clearTimeout(n),!r&&m.join(e)?(p.request(),f.removeAll(),u.joinQueue(e).then(function(n,r){if(n)"invalidStartCode"===n?t.handle("ErrorInvalidStartCode",e):t.handle("ErrorJoinQueue",{error:n});else{if(a.hasClaims()){var i=a.getClaims();o.post("Visit/Me/Claims",JSON.stringify(i))}t.handle("next")}})):t.handle("ErrorJoinQueue",{error:r})})},ErrorAlreadyInQueue:function(){vngageapp.require(["views/reject-modal"],function(e){e.show(i.get().queueAlreadyInQueue)})},ErrorJoinQueue:function(){vngageapp.require(["views/reject-modal"],function(e){var t=i.get();e.show(t.queueJoinReject,t.queueJoinRejectBtn)})},ErrorInvalidStartCode:function(e){vngageapp.require(["views/reject-modal"],function(e){var t=i.get();e.show(t.InvalidStartCodeReject,t.queueJoinRejectBtn)})},Enlist:function(){this.transition("Proactive")},ReactToQueued:function(){this.transition("Queued")},next:function(){this.transition("Queued")},_onExit:function(){h.stopChecking()}},Proactive:{_onEnter:function(){s.tokenMismatch=!1,h.startChecking(),c.session.proactivePayload?(u.Enlist(c.session.proactivePayload),delete c.session.proactivePayload):d.resume()},PresentSolutions:function(){r.evaluate()},Join:function(e){var t=this;l.load();var n=setTimeout(function(e){t.handle("ErrorJoinQueue",{error:e})},6e3);h.refresh().then(function(r){clearTimeout(n),!r&&m.join(e)?(p.request(),f.removeAll(),u.joinQueue(e).then(function(){t.transition("Queued")})):t.handle("ErrorJoinQueue",{error:r})})},ErrorAlreadyInQueue:function(){vngageapp.require(["views/reject-modal"],function(e){e.show(i.get().queueAlreadyInQueue)})},ErrorJoinQueue:function(){vngageapp.require(["views/reject-modal"],function(e){e.show(i.get().queueJoinReject)})},ReactToQueued:function(){},ReactToApproval:function(){this.transition("PendingApproval")},next:function(){this.transition("PendingApproval")},_onExit:function(){h.stopChecking()}},Queued:{_onEnter:function(){l.load(),p.request().then(function(){p.start()}),f.removeAll(),d.resume()},Leave:function(){this.transition("Ready")},Begin:function(){this.handle("next")},Block:function(){this.transition("Ready")},Resume:function(){o.resume()},TokenMismatch:function(){s.tokenMismatch=!0,d.stop()},TransferError:function(){vngageapp.require(["views/reject-modal"],function(e){e.show("Something went wrong with your transfer... ")})},OptOutError:function(){d.stop(),o.clearSession(),this.transition("Ready")},ReactToApproval:function(){this.transition("PendingApproval")},ReactToDialog:function(){this.transition("InDialog")},next:function(){this.transition("PendingApproval")}},PendingApproval:{_onEnter:function(){l.load(),p.request().then(function(){p.start()}),d.resume()},Approve:function(){this.transition("InDialog")},Resume:function(){o.resume()},TimedOut:function(){var e=this;u.Reject().then(function(){d.stop(),e.transition("Ready")})},Decline:function(){var e=this;u.Reject().then(function(){d.stop(),e.transition("Ready")})},TokenMismatch:function(){s.tokenMismatch=!0,d.stop()},TransferError:function(){vngageapp.require(["views/reject-modal"],function(e){e.show("Something went wrong with your transfer... ")})},OptOutError:function(){o.clearSession(),d.stop(),this.transition("Ready")},ReactToDialog:function(){this.transition("InDialog")},next:function(){this.transition("InDialog")}},InDialog:{_onEnter:function(){l.load(),d.resume(),p.request().then(function(e){p.start(),e||vngageapp.require(["psCoworker","models/app-model"],function(e,t){g(t.get("isNonResponsiveMobile")===!0),e.start()})})},Block:function(){v.visitorBlocked(),this.handle("next")},End:function(){this.handle("next")},TokenMismatch:function(){s.tokenMismatch=!0,d.stop()},TransferError:function(){vngageapp.require(["views/reject-modal"],function(e){e.show("Something went wrong with your transfer... ")})},OptOutError:function(){o.clearSession(),d.stop(),this.transition("Ready")},Resume:function(){o.resume()},Transferred:function(){0},LostByUser:function(){0},next:function(){this.transition("Completed")}},Completed:{_onEnter:function(){d.stop(),o.startNoop()},Close:function(){u.proactiveQuarantine(),u.focusBannerQuarantine(),u.Close(),this.handle("next")},OptOutError:function(){o.clearSession(),this.handle("Close")},next:function(){this.transition("Ready")}}}});return new y}),vngageapp.define("core/vngage/visitorStates",[],function(){"use strict";return{Ready:"Ready",Proactive:"Proactive",Queued:"Queued",PendingApproval:"PendingApproval",LostByUser:"LostByUser",Transferred:"Transferred",InDialog:"InDialog",Completed:"Completed"}}),vngageapp.define("actions/ViewActions",["require","underscore","pubsub","connection","core/vngage/eventsVO","services/requesterCalls","stores/ConversationsStore"],function(e){"use strict";function t(){return n.keys(s.getAll())[0]}var n=e("underscore"),r=e("pubsub"),i=e("connection"),o=e("core/vngage/eventsVO"),a=e("services/requesterCalls"),s=e("stores/ConversationsStore");return{sendNavigation:function(e,r){var o=t();if(!o)return!1;r.classification="ok";var a=n.extend({type:"conversationMessage",messageType:e},r);i.sendMessage(o,a)},createMessage:function(e){var n=t();return n?void r.publish(o.CREATE_MESSAGE,{action:{text:e,conversationId:n}}):!1},visitorTyping:function(e){var n=t();return n?void 0:!1},visitorLeaveQueue:function(){var e=t();return e?(r.publish(o.CONVERSATION_CLOSED,{action:{conversationId:e}}),void r.publish(o.QUEUE_LEAVE)):!1},visitorTimedOut:function(){r.publish(o.PENDING_TIMEOUT)},visitorDeclineDialog:function(){a.Reject(),r.publish(o.DIALOG_DECLINE)},visitorLeaveDialog:function(){r.publish(o.DIALOG_END)},visitorSendEmail:function(e){var n=t(),r={email:e};return n&&e?void i.post("Conversation/"+n+"/Transcript/SendEmail",r):!1},visitorNavigatedLink:function(e){a.visitorNavigate({data:e})},visitorClosedPanel:function(){i.stopNoop()},sendDomUpload:function(e){var n=t();return n?void i.sendPageDOM(n,e):!1}}}),vngageapp.define("services/snapUpdater",["require","services/requesterCalls","core/vngage/visitorStates","core/vngage/stateMachine","actions/ViewActions"],function(e){"use strict";function t(e,t){switch(e){case"location":r.state===n.InDialog&&i.sendNavigation("navigation",{url:t.url})}}var n=(e("services/requesterCalls"),e("core/vngage/visitorStates")),r=e("core/vngage/stateMachine"),i=e("actions/ViewActions");return{update:t}}),vngageapp.define("api",["require","pubsub","core/vngage/eventsVO","core/vngage/stateMachine","queueStatus","core/vngage/track","core/vngage/logger","services/snapUpdater"],function(e){"use strict";function t(e){var t="00000000-0000-0000-0000-000000000000",n={solutionId:e.solutionId||e.bannerId||t,caseType:e.caseType||e.caseTypeId||t,groupId:e.groupId||t,opportunityId:e.opportunityId||e.triggerId||t,correlationId:e.correlationId||t},r=e.title||e.message||"",i=e.startCode||e.code||!1;return i&&(n.startCode=i),r&&(n.messages=[{messageType:"title",message:r}]),e.isProactive&&(n.isProactive=!0),n}var n=e("pubsub"),r=e("core/vngage/eventsVO"),i=e("core/vngage/stateMachine"),o=e("queueStatus"),a=e("core/vngage/track"),s=e("core/vngage/logger"),c=e("services/snapUpdater"),u={};return{subscribe:function(e,t){return n.subscribe(e,t)},unsubscribe:function(e){return n.unsubscribe(e)},publish:function(e,t){return n.publish(e,t)},track:function(e,t){t=t||{},t.type=e,a.add(t)},join:function(e,i){i=t(i),n.publish(r.BANNER_JOIN,i)},update:function(e,t){c.update(e,t)},get:function(e,t){switch(e.toLowerCase()){case"currentstate":return i.state;case"queuestatus":var n="string"==typeof t?t:t.groupId||null;return n?(n=n.toUpperCase(),o.getStatus(n)):!1;case"time":return o.getTime();case"servertime":return o.getServerTime();default:if(u[e])return u[e]}return!1},set:function(e,t){return"debug"===e?void s.init(t):void(u[e]=t)},__p:function(e){n.publish(r.VIDEO_EXTERNAL,e)}}}),vngageapp.define("applications/psLegacy/parts/legacyNameSpace",[],function(){window.psPlugin=window.psPlugin||{bridge:{},core:{connection:{},ui:{}},shell:null,banners:{},themes:{},themeAPI:{},customJS:{},serverConf:{theme:{}}}}),vngageapp.define("components/cobrowser/cssPath",[],function(){function e(e){return e.replace(/^\s*|\s*$/g,"")}function t(e){for(var t=e.split(/\s/g),n=[],r=0,i=t.length;i>r;++r)t[r].length>0&&n.push("."+t[r]);return n.join("")}function n(e){for(var t=0,n=e.parentNode.childNodes,r=0,i=n.length;i>r;++r)if(1===n[r].nodeType&&++t,n[r]===e)return t}function r(i,o,a){var s=i.tagName.toLowerCase(),c=[s],u=i.getAttribute("class"),l=i.getAttribute("id");return l?(a.unshift(s+"#"+e(l)),a):(u&&c.push(t(u)),"html"!==s&&"body"!==s&&i.parentNode&&c.push(":nth-child("+n(i)+")"),a.unshift(c.join("")),i.parentNode&&i.parentNode!==o&&i.parentNode.tagName&&r(i.parentNode,o,a),a)}return function(e,t){return e?r(e,t,[]).join(" > "):!1}}),vngageapp.define("components/cobrowser/element",["require","./cssPath"],function(e){function t(e,t,n){var i;if(t&&(i=document.getElementById(t)))return i;if(i=document.querySelector(e))return i;if(n){if(i=document.getElementsByName(n),1===i.length)return i[0];if(i.length>1)for(var o=0,a=i.length;a>o;o++)if(r(i[o],"body")===e)return i[o]}return!1}function n(e){for(var t={inner:{width:e.clientWidth,height:e.clientHeight},outer:{width:e.offsetWidth,height:e.offsetHeight},scroll:{width:e.scrollWidth,height:e.scrollHeight<e.clientHeight?e.clientHeight:e.scrollHeight,left:e.scrollLeft,top:e.scrollTop}},n=e,r=0,i=0;n.offsetParent;)r+=n.offsetLeft,i+=n.offsetTop,n=n.offsetParent;return t.x=r,t.y=i,t}var r=e("./cssPath");return{find:t,cssPath:r,getDimensions:n}}),vngageapp.define("components/cobrowser/scrollToPos",[],function(){function e(e,t,n){t=t||{};var r=t.duration||600,i=t.threshold||100,o=t.easing||function(e){return-Math.cos(e*Math.PI)/2+.5},a=+new Date,s=a+r,c=isNaN(window.pageYOffset)?document.documentElement.scrollTop:window.pageYOffset,u=e-c;if(Math.abs(u)<i)return void window.scrollTo(0,e);var l=setInterval(function(){var e=+new Date,i=e>s?1:(e-a)/r;window.scrollTo(0,c+u*o(i)),e>s&&(clearInterval(l),t.after&&t.after(),n&&setTimeout(n,1))},15)}return e}),vngageapp.define("components/cobrowser/highlight",["require","underscore","./element","pubsub","./scrollToPos"],function(e){function t(){I.show(c)}function n(e){e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation()),u.isActive?I.send():I.hide()}function r(e){return-1===h.indexOf(" "+e.nodeName+" ")}function i(e){e.preventDefault(),e.stopPropagation(),I.picker.send()}function o(e){e&&e.preventDefault&&e.preventDefault(),I.hide(),r(s)&&s.focus()}function a(e){var t=d.find(e.targetPath,e.targetId,e.targetName);t&&(s=t,c=e,I.move(d.getDimensions(s)))}var s,c,u,l,p=e("underscore"),d=e("./element"),f=e("pubsub"),g=e("./scrollToPos"),h=" BODY OPTION ",v=999999998,m="-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);cursor:hand; -webkit-transition: all 200ms; -moz-transition: all 200ms; -ms-transition: all 200ms;position:absolute; border:4px solid #fc0; margin:-4px; background:rgba(255,255,255,.3); border-radius:3px; box-shadow:inset 0 0 2px rgba(0,0,0,.7), 1px 1px 3px rgba(0,0,0,.5); left:0; top:0; display:none; opacity:1; z-index:"+v+";",y="psPlugin-highlightEl",b="psPlugin-highlightEl",w="psPlugin-highlighter",_="-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);pointer-events:none;overflow:hidden;cursor:alias;position:absolute;border:4px solid #e71;margin:-4px;background:rgba(255,255,255,.3);border-radius:3px;box-shadow:inset 0 0 2px rgba(0,0,0,.7), 1px 1px 3px rgba(0,0,0,.5);left:30%;top:-10px;opacity:1;z-index:"+v+";-webkit-transform-origin:right top;-ms-transform-origin:right top;transform-origin:right top;-webkit-transition: all 200ms;transition: all 200ms;",E="Click to highlight for visitor",C="pointer-events:none; position:absolute; white-space:nowrap;z-index:-1;left:0;bottom:0;padding:0 2px 0 0;background:#e71;border-radius:0 3px 0 0;font-size:11px;font-weight:bold;color:#322416;",I={picker:{create:function(){return u=document.createElement("div"),l=document.createElement("span"),l.innerHTML=E,l.setAttribute("style",C),u.appendChild(l),u.className=w,u.setAttribute("style",_),document.body.appendChild(u),u.addEventListener("click",n,!1),u},start:function(){u&&I.hide(),this.create(),u.style.opacity=1,l.style.opacity=1,document.body.addEventListener("mousemove",O,!1),document.body.addEventListener("click",i,!0),window.addEventListener("resize",S,!1),u.isActive=!0},stop:function(){return u?(u.isActive=!1,this.destroy(),window.removeEventListener("resize",S,!1),document.body.removeEventListener("mousemove",O,!1),void document.body.removeEventListener("click",i,!0)):!1},send:function(){u.style.opacity=.5,l.style.opacity=0,f.publish("highlight:send",c),setTimeout(this.stop.bind(this),300),setTimeout(t,600)},destroy:function(){return u?(u.removeEventListener("click",n,!1),u.parentNode.removeChild(u),void(u=!1)):!1}},move:function(e,t){return(t=t||u)?(t.isActive=!0,t.style.display="",t.style.opacity=1,t.style.left=e.x+"px",t.style.top=e.y+"px",t.style.width=e.outer.width+"px",void(t.style.height=e.outer.height+"px")):!1},create:function(){return window.addEventListener("resize",S,!1),u=document.createElement("div"),u.id=y,u.className=b,u.setAttribute("style",m),document.body.appendChild(u),u.addEventListener("click",o,!1),u},show:function(e){e=e||c;var t,n=d.find(e.targetPath,e.targetId,e.targetName);if(!n)return!1;s=n,u||this.create(),t=d.getDimensions(s),this.move(t);var r=t.y,i=window.scrollY,o=window.scrollY+window.innerHeight,a=100;(i>r||r+t.outer.height>o)&&(r-=a,0>r&&(r=0),g(r))},hide:function(){return u?(window.removeEventListener("resize",S,!1),u.removeEventListener("click",o,!1),u.parentNode.removeChild(u),void(u=!1)):!1}},S=p.debounce(function(){return u?void I.move(d.getDimensions(s)):!1},200),O=p.throttle(function(e){if(!e||e.target===s||!r(e.target))return!1;var t=e.target,n={targetPath:d.cssPath(t,document.body),targetId:t.id||null,targetName:t.name||null};a(n)},100);return I}),vngageapp.define("applications/psLegacy/parts/pmEvents",["require","underscore","core/common/json","cookies","jschannel","pubsub","components/cobrowser/highlight","components/coBrowser/getPageContent","services/guidGenerator"],function(e){var t=(e("underscore"),e("core/common/json")),n=e("cookies"),r=e("jschannel"),i=e("pubsub"),o=e("components/cobrowser/highlight"),a=e("components/coBrowser/getPageContent"),s=e("services/guidGenerator"),c={channel:!1,init:function(){function e(e,t){c.channel.notify({method:"onElementHighlighted",params:t})}var t="*";this.channel=r.build({window:window.parent,origin:t,reconnect:!0,scope:"cobrowser"}),this.channel.bind("getPageWithFormValues",this.onGetPageWithFormValues),this.channel.bind("runTaskForDesktop",this.runTaskForDesktop),this.channel.bind("highlight",this.onHighlight),this.channel.bind("onPageLoaded",this.onPageLoaded),i.subscribe("highlight:send",e)},onHighlight:function(e,t){return"start"===t?(o.picker.start(),"highlight:start"):"stop"===t?(o.picker.stop(),"highlight:stop"):("hide"===t&&o.hide(),void("object"==typeof t&&o.show(t)))},call:function(e){"function"==typeof this[e]&&this[e]()},onPageLoaded:function(){psPlugin.application.URL.indexOf("api/vi/Content")>-1||this.channel.notify({method:"onPageLoaded",params:{title:document.title||"",url:psPlugin.application.URL}})},onCapturedNavigation:function(e){this.channel.notify({method:"onCapturedNavigation",params:{url:e}})},onGetPageWithFormValues:function(e,n){var r=a();c.channel.notify({method:"getPageWithFormValues",params:t.stringify(r)})},runTaskForDesktop:function(e,t){var n;n="psPlugin"!==t.scope?window[t.command](t.params||null):c.commands[t.command](t.params||null),c.channel.notify({method:"runTaskForDesktop",params:{scope:t.scope,command:t.command,params:t.params,result:n}})},commands:{block:function(e){return e=e||1,console.info("BLOCK!"),e>0&&n.set("psB",s(),{expires:24*e*60*60}),"blocked"}}};return c}),vngageapp.define("psMain",["require","applications/psLegacy/parts/legacyNameSpace","applications/psLegacy/parts/pmEvents"],function(e){function t(e){return"function"==typeof ps_purifyURL?ps_purifyURL(e):e}function n(e){var n=e.target;"psPlugin-highlightEl"===n.id&&n.parentNode.removeChild(n);try{for(;"BODY"!==n.nodeName;){if("A"===n.nodeName)return e.preventDefault(),o.onCapturedNavigation(t(n.href)),!1;n=n.parentNode}}catch(r){}}function r(e){return e.toLowerCase().indexOf("api/v1/content/")>-1}function i(){psPlugin.application.URL=t(document.URL),window.top!==window.self&&(o.init(),r(psPlugin.application.URL)?document.body.addEventListener("click",n,!1):o.call("onPageLoaded"))}var o=(e("applications/psLegacy/parts/legacyNameSpace"),e("applications/psLegacy/parts/pmEvents"));return psPlugin.application={URL:null,configuration:{},stateMachine:null,commands:null,events:null,modules:{},views:{},groups:{}},psPlugin.core.connection={},{init:i}}),vngageapp.define("core/vngage/extensions",["require","underscore","vergic.dom"],function(e){"use strict";function t(e){if(e&&"function"==typeof e.accountMethods)try{window.vngage.extensions.accountMethods=e.accountMethods(n,r)}catch(t){window.vngage.extensions.accountMethods={}}}var n=e("underscore"),r=e("vergic.dom");return{init:t}}),vngageapp.define("utils/MessageUtils",["require","underscore"],function(e){"use strict";var t=e("underscore");return{convertRawMessage:function(e){return t.extend(e,{createdAt:new Date(e.createdAt)})},getCreatedMessageData:function(e,n,r){var i={id:t.uniqueId("visito_"),messageType:"chat",type:"conversationMessage",recipients:null,message:e,createdAt:new Date(Date.now())};return r&&(i.speaker=r),i},getParticipantMessageData:function(e,n){var r={id:t.uniqueId("participant_"),messageType:"participant",type:"conversationMessage",message:null,createdAt:new Date(Date.now())};return n&&(r.speaker=n),t.extend(r,e)},getActivityMessageData:function(e){var n={messageType:"activity",type:"conversationMessage",recipients:null,message:null};return t.extend(n,e)},getBrowserInfoMessageData:function(e){return t.extend({messageType:"browserInfo",type:"conversationMessage",recipients:null,message:null},e)},sortByDate:function(e){return e.sort(function(e,t){return e.createdAt.getTime()<t.createdAt.getTime()?-1:e.createdAt.getTime()>t.createdAt.getTime()?1:0})},getConversationMessages:function(e){return t.sortBy(t.filter(e,function(e){return"conversationMessage"===e.type}),"createdAt")},getMessagesWithoutMe:function(e){return t.reject(e,function(e){return e.speaker.visitId})},getChatMessagesWithoutMe:function(e,n){var r=["chat","navigation"];return t.reject(e,function(e){return r.indexOf(e.messageType)>-1&&e.speaker.visitId&&e.speaker.visitId===n})},addConversationIdToMsg:function(e,n){return e.length?(t.map(e,function(e){e.conversationId=n}),e):(e.conversationId=n,e)},getById:function(e,n){return t.find(e,function(e){return e.id===n})},getParticipantEntityId:function(e){var t=e.participant||e;return t.userId||t.visitId},getWritingId:function(e){return e.id}}}),vngageapp.define("utils/Activity",["require","underscore"],function(e){"use strict";function t(e,t,r){var i=[];return n.map(t,function(t){var o=t.speaker.userId||t.speaker.visitId;t.conversationId=e,t.pid=o;var a=n.find(r,{pid:o});a?i=n.reject(r,function(e){return e.pid===a.pid}):"set"===t.change&&i.push(t)}),i}var n=e("underscore");return{filterWritings:t}}),vngageapp.define("stores/ParticipantsStore",["require","pubsub","underscore","connection","./ConversationsStore","./../utils/MessageUtils","./../utils/Activity","core/vngage/eventsVO"],function(e){"use strict";function t(e){var t=e.userId||e.visitId;l.participants=i.reject(l.participants,function(e){var n=e.userId||e.visitId;return n===t}),l.participants.push(e)}function n(e){e.forEach(function(e){t(e)})}var r=e("pubsub"),i=e("underscore"),o=e("connection"),a=e("./ConversationsStore"),s=e("./../utils/MessageUtils"),c=e("./../utils/Activity"),u=e("core/vngage/eventsVO"),l={participants:{},writings:[]},p={getAllParticipants:function(){return l.participants},getParticipantById:function(e){return i.find(l.participants,function(t){var n=t.userId||t.visitId;return n===e})},getVisitorParticipant:function(){return i.find(l.participants,function(e){return e.visitId})},getOwnerParticipant:function(){return i.find(l.participants,function(e){return e.info.owner===!0&&"joined"===e.state})},isParticipantAgent:function(e){return i.find(l.participants,function(t){return"agent"===t.info.role&&t.userId&&t.userId===e})},getWritingParticipantsOfConversation:function(e){var t=i.keys(a.getAll())[0];if(!t)return[];var n=p.getVisitorParticipant();
return i.filter(l.writings,function(t){var r=t.speaker.userId||t.speaker.visitId;return t.conversationId===e&&r!==n.visitId})}};return r.subscribe(u.RECEIVE_AS_STATE,function(e,t){var i=t.action;l.participants=[],n(i.conversationState.participants),r.publish(u.PARTICIPANTS_STORE)}),r.subscribe(u.RECEIVE_SINCE,function(e,t){var n=t.action,o=n.conversationId,a=s.getMessagesWithoutMe(i.filter(n.rawMessages,function(e){return"activity"===e.messageType})),d=i.filter(n.rawMessages,function(e){return"participantConnectionStatus"===e.type});i.each(d,function(e){var t=e.participant.userId||e.participant.visitId,n=p.getParticipantById(t);n&&(n.connectionState=e.connectionState)});var f=i.filter(n.rawMessages,function(e){return"chat"===e.messageType});i.each(f,function(e){if(e.speaker.userId){var t=e.speaker.userId;a=i.reject(a,function(e){return e.speaker.userId&&e.speaker.userId===t&&"reset"===e.change});var n=i.reject(l.writings,function(n){return n.pid===t||n.id===e.id});n.length!==l.writings&&(l.writings=n,r.publish(u.PARTICIPANTS_STORE))}});var g=!1;if(a.length){var h=l.writings.slice(0);l.writings=c.filterWritings(o,a,l.writings),JSON.stringify(l.writings)!==JSON.stringify(h)&&(g=!0)}(g||d.length>0)&&r.publish(u.PARTICIPANTS_STORE)}),r.subscribe(u.PARTICIPANT_JOINED,function(e,n){var o=n.action,a=o.participant;i.map(a,function(e){var n={id:e.participationId,connectionState:"ok",info:e.info,state:"joined"};e.participant.visitId?n.visitId=e.participant.visitId:n.userId=e.participant.userId,t(n)}),r.publish(u.PARTICIPANTS_STORE)}),r.subscribe(u.PARTICIPANT_LEFT,function(e,t){var n=t.action,o=n.participant,a=i.map(o,function(e){return e.participant.userId||e.participant.visitId});l.participants=i.map(l.participants,function(e){var t=e.userId||e.visitId;return a.indexOf(t)>-1&&(e.state="left",e.connectionState="terminate"),e}),r.publish(u.PARTICIPANTS_STORE)}),r.subscribe(u.PARTICIPANT_ACTIVITY,function(e,t){var n=t.action,r=n.conversationId,i=n.activityData,a=s.getActivityMessageData(i);o.sendMessage(r,a)}),r.subscribe(u.PARTICIPANT_BROWSERINFO,function(e,t){var n=i.keys(a.getAll())[0];if(!n)return!1;var r=s.getBrowserInfoMessageData(t);o.sendMessage(n,r)}),p}),vngageapp.define("stores/EventStore",["require","underscore","pubsub","connection","./../utils/MessageUtils","./ParticipantsStore","appConfig","core/vngage/eventsVO"],function(e){"use strict";function t(e){return a.getById(l.messages,e.id)?!1:void l.messages.push(a.convertRawMessage(e))}function n(e){r.isArray(e)?r.each(e,function(e){t(e)}):t(e)}var r=e("underscore"),i=e("pubsub"),o=e("connection"),a=e("./../utils/MessageUtils"),s=e("./ParticipantsStore"),c=e("appConfig"),u=e("core/vngage/eventsVO"),l={messages:[],events:[],state:-1},p={getState:function(){return l.state},getMappedMessagesOfConversation:function(e){var t=["chat","link","participant"],n=r.filter(l.messages,function(e){return t.indexOf(e.messageType)>-1});return r.map(n,function(e){var t=e.speaker.userId||e.speaker.visitId;e.speaker=s.getParticipantById(t)}),a.sortByDate(n)}};return i.subscribe(u.CONVERSATION_STARTED,function(){l.state="open",i.publish(u.EVENT_STORE)}),i.subscribe(u.CONVERSATION_RESUMED,function(){l.state="open",i.publish(u.EVENT_STORE)}),i.subscribe(u.CONVERSATION_CLOSED,function(e,t){var n=t.action,r=n.conversationId;o.leaveConversation(r),l.state="closed",i.publish(u.EVENT_STORE)}),i.subscribe(u.CONVERSATION_UNAUTHORIZED,function(e,t){l.state="closed",i.publish(u.EVENT_STORE)}),i.subscribe(u.RECEIVE_AS_STATE,function(e,t){var o=t.action,s=o.conversationState,p=a.getConversationMessages(s.messages);n(p),l.state=s.state,i.publish(u.EVENT_STORE);var d=r.find(p.slice().reverse(),{messageType:"video"});if(d&&"start"===d.activity){var f={outStreamId:d.streamId,inStreamId:"1"+d.streamId,conf:c.visitor};setTimeout(function(){i.publish(u.VIDEO_START,f)},800)}}),i.subscribe(u.RECEIVE_SINCE,function(e,t){var o=t.action,c=(o.conversationId,o.rawMessages),l=a.getConversationMessages(c),p=a.getChatMessagesWithoutMe(l,s.getVisitorParticipant().visitId),d=r.filter(p,function(e){return"navigation"===e.messageType});if(d.length>0&&i.publish(u.COBROWSER_AGENT_NAVIGATED,d[d.length-1].url),n(p),p.length>0){i.publish(u.EVENT_STORE);var f=["chat","link","participant"],g=r.filter(p,function(e){return f.indexOf(e.messageType)>-1});if(g.length){i.publish(u.MESSAGE_RECEIVED,g.length);var h=r.find(g,{linkType:"link"});h&&i.publish(u.COBROWSER_VISITOR_NAVIGATED_LINK,h.url)}}}),i.subscribe(u.CREATE_MESSAGE,function(e,t){var n=t.action,c=n.conversationId,p=n.text,d=s.getVisitorParticipant(),f=a.getCreatedMessageData(p,c,d);l.messages.push(f),o.sendMessage(c,r.omit(f,"id","createdAt","speaker","recipients")),i.publish(u.EVENT_STORE)}),i.subscribe(u.PARTICIPANT_JOINED,function(e,t){var n=t.action,o=n.participant,c=n.conversationId,p=r.filter(o,function(e){var t=l.events&&l.events.indexOf(e.eventId)>-1;return t||(l.events=l.events||[],l.events.push(e.eventId)),!t}),d=r.map(p,a.getParticipantEntityId);r.map(d,function(e,t){var n=s.getParticipantById(e),r=n.visitId||n.userId,i={speaker:n,action:"joined"},o=a.getParticipantMessageData(i,n);o=a.addConversationIdToMsg(o,c);var u=s.getVisitorParticipant().visitId===e;s.isParticipantAgent(r)||u||l.messages.push(o)}),i.publish(u.EVENT_STORE)}),i.subscribe(u.PARTICIPANT_LEFT,function(e,t){var n=t.action,o=n.conversationId,c=n.participant,p=r.filter(c,function(e){var t=l.events&&l.events.indexOf(e.eventId)>-1;return t||(l.events=l.events||[],l.events.push(e.eventId)),!t}),d=r.map(p,a.getParticipantEntityId);r.map(d,function(e,t){var n=s.getParticipantById(e),r=n.visitId||n.userId,i={speaker:n,action:"left"},c=a.getParticipantMessageData(i,n);c=a.addConversationIdToMsg(c,o),s.isParticipantAgent(r)||l.messages.push(c)}),i.publish(u.EVENT_STORE)}),p}),vngageapp.define("components/cobrowser/browserAttributes",["require","pubsub","core/vngage/eventsVO","vergic.environment"],function(e){"use strict";function t(){return a}function n(){var e=window.innerWidth,t=window.innerHeight,n=!1;null===a.hasFlash&&(a.hasFlash=o.hasFlash(),n=!0),(e!==a.width||t!==a.height)&&(a.width=e,a.height=t,n=!0),n&&r.publish(i.PARTICIPANT_BROWSERINFO,a)}var r=e("pubsub"),i=e("core/vngage/eventsVO"),o=e("vergic.environment"),a={width:null,height:null,hasFlash:null};return{get:t,update:n}}),vngageapp.define("applications/analyze/opportunity-operators",["require"],function(e){"use strict";return{returnAsArray:function(e){var t=this[e],n=[];for(var r in t)"function"!=typeof t[r]&&(t[r].key=r,n.push(t[r]));return n},"boolean":{equal:{name:"Equal",evaluate:function(e,t){return e===t}},notEqual:{name:"Not Equal",evaluate:function(e,t){return e!==t}}},string:{equal:{name:"Equal",evaluate:function(e,t){return e===t}},notEqual:{name:"Not Equal",evaluate:function(e,t){return e!==t}},contains:{name:"Contains",evaluate:function(e,t){return e&&"number"!=typeof e?-1!==e.indexOf(t):!1}},notContain:{name:"Does Not Contain",evaluate:function(e,t){return e&&"number"!=typeof e?-1===e.indexOf(t):!1}}},number:{equal:{name:"Equal",evaluate:function(e,t){return e===t}},notEqual:{name:"Not Equal",evaluate:function(e,t){return e!==t}},greater:{name:"Greater Than",evaluate:function(e,t){return e>t}},less:{name:"Less Than",evaluate:function(e,t){return t>e}}},condition:{and:{name:"And",evaluate:function(e,t){return e&&t}},or:{name:"Or",evaluate:function(e,t){return e||t}}}}}),vngageapp.define("applications/analyze/opportunity-sorter",[],function(){"use strict";return function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&"object"==typeof e[t]&&n.push(e[t]);return n.sort(function(e,t){var n=e.section.position,r=t.section.position;return r>n?-1:n>r?1:0}),n}}),vngageapp.define("applications/analyze/opportunity-engine",["require"],function(e){"use strict";function t(e,t){var n=t[e.operator.type][e.operator.value],r=function(){var t=e.value.value,n=e.value.type.toLowerCase();if("number"===e.operator.type){var r=parseInt(t,10);return r||0===r?r:t}return"static"===n?"true"===t?!0:"false"===t?!1:t:void 0};this.evaluate=function(t){var i=e.field.type;"navigation"!==i&&"visitor"!==i&&(i=i.toUpperCase());var o=t[i],a=o?o[e.field.value]:!1;return o?n.evaluate(a,r(o)):!1}}function n(e,r){var i=new t(e.expression,r),o=[];if("undefined"!=typeof e.conditions)for(var a=0;a<e.conditions.length;a++){var s=e.conditions[a];o.push({condition:new n(s,r),operator:r.condition[s.operator]})}this.evaluate=function(e){for(var t=i.evaluate(e),n=0;n<o.length;n++){var r=o[n];t=r.operator.evaluate(t,r.condition.evaluate(e))}return t}}return function(){function e(e,t){this.rootCondition=new n(e,t)}return e.prototype.evaluate=function(e){return this.rootCondition.evaluate(e)},e}()}),vngageapp.define("applications/psLegacy/parts/opportunityHandler",["require","underscore","applications/analyze/analyze","applications/analyze/opportunity-operators","applications/analyze/opportunity-sorter","applications/analyze/opportunity-engine","services/guidGenerator","appConfig","core/vngage/track","applications/psLegacy/parts/shellLoader","models/navigationValues","connection"],function(e){var t=e("underscore"),n=e("applications/analyze/analyze"),r=e("applications/analyze/opportunity-operators"),i=e("applications/analyze/opportunity-sorter"),o=e("applications/analyze/opportunity-engine"),a=e("services/guidGenerator"),s=e("appConfig"),c=(e("core/vngage/track"),e("applications/psLegacy/parts/shellLoader").session),u=e("models/navigationValues"),l=e("connection");return{init:function(){this.opportunityCheck.run()},opportunityCheck:{pageScore:0,runCodeStarter:!0,run:function(){var e=s.currentSite,p=i(e.opportunities),d=c.poi,f=a(),g=!0,h=0;for("Ready"!==c.user.state&&("Proactive"===c.user.state&&d&&d.visitor&&(d.visitor.isProactive=!0),g=!1),s.account.deactivatePhoneToPs===!0&&(this.runCodeStarter=!1);h<p.length;){var v=p[h];if("undefined"==typeof v.section.condition)return h++;if(v.run=new o(v.section.condition,r),v.run.evaluate(d)){if(n.addOpportunity({id:v.id,evaluationScopeId:f,name:v.name,score:parseInt(v.section.score,10),position:parseInt(v.section.position,10),matched:!0}),"undefined"!=typeof v.section.solutions){var m;t.each(v.section.solutions,function(e){var t=s.currentSite.solutions[e];n.addSolutionEvaluated({name:t.name,id:e,opportunityId:v.id,correlationId:f}),g&&t.section.isProactive&&(m={groupId:t.section.groupId,caseType:t.section.caseTypeId,title:t.section.messageToCustomerCase,solutionId:e,opportunityId:v.id,correlationId:f},c.user.state="Proactive",c.proactivePayload=m,g=!1)}),!m&&c.proactivePayload&&delete c.proactivePayload}c.poi.visitor.score=c.poi.visitor.score+parseInt(v.section.score,10),this.pageScore=this.pageScore+parseInt(v.section.score,10)}h++}l.syncSession(c),u.score=this.pageScore}}}}),vngageapp.define("stateSubscriber",["require","underscore","pubsub","connection","appConfig","core/vngage/eventsVO","stores/EventStore","stores/ParticipantsStore","services/appLoader","core/vngage/visitorStates","services/requesterCalls","core/vngage/stateMachine","applications/psLegacy/parts/shellLoader","queueStatus","applications/analyze/analyze","stores/ConversationsStore","components/cobrowser/browserAttributes","applications/psLegacy/parts/opportunityHandler"],function(e){"use strict";function t(){a.subscribe(u.CONNECTION_STARTED,n),a.subscribe(u.BANNER_JOIN,function(e,t){h.handle("Join",t)}),a.subscribe(u.QUEUE_JOIN,function(e,t){h.handle("Join",t)}),a.subscribe(u.QUEUE_LEAVE,function(){h.handle("Leave");var e=o.keys(b.getAll())[0];return e?void a.publish(u.CONVERSATION_CLOSED,{action:{conversationId:e}}):!1}),a.subscribe(u.QUEUESTATUS_UPDATE,function(){a.publish(u.BANNERS_RENDER),h.handle("PresentSolutions")}),a.subscribe(u.PENDING_TIMEOUT,function(){h.handle("TimedOut")}),a.subscribe(u.DIALOG_INVITE,function(){h.handle("Begin")}),a.subscribe(u.DIALOG_APPROVE,function(){h.handle("Approve")}),a.subscribe(u.DIALOG_DECLINE,function(){h.handle("Decline")}),a.subscribe(u.DIALOG_END,function(){h.handle("End");var e=o.keys(b.getAll())[0];return e?void a.publish(u.CONVERSATION_CLOSED,{action:{conversationId:e}}):!1}),a.subscribe(u.DIALOG_CLOSE,function(){h.handle("Close")}),a.subscribe(u.DIALOG_RESUME,function(){h.handle("Resume")}),a.subscribe(u.APP_STOP,function(){h.handle("Stop")}),a.subscribe(u.ERROR_TOKENMISMATCH,function(){h.handle("TokenMismatch")}),a.subscribe(u.ERROR_TRANSFER,function(){h.handle("TransferError")}),a.subscribe(u.ERROR_UNKNOWNVISITOR,function(){h.handle("OptOutError"),a.publish(u.CLOSE)}),a.subscribe(u.ERROR_INVALID_STARTCODE,function(){h.handle("ErrorInvalidStartCode")}),a.subscribe(u.ERROR_ALREADYINQUEUE,function(){h.handle("ErrorAlreadyInQueue")}),a.subscribe(u.BLOCK,function(){h.handle("Block")}),a.subscribe(u.CLOSE,function(){var e=[f.InDialog,f.Queued];e.indexOf(h.state)>-1&&window.top===window.self&&location.reload()}),a.subscribe(u.DIALOG_RESUMED,function(e,t){var n,r=[f.InDialog,f.PendingApproval,f.Queued];t&&(v.session.addObject(t),n=t.user.state),n!==h.state?h.transition(n):o.indexOf(r,n)>-1&&h.handle("_onEnter"),(n===f.Ready||n===f.Completed)&&h.handle("Close")}),a.subscribe(u.DIALOG_NAVIGATE,function(e,t){g.visitorNavigate({data:t})}),a.subscribe(u.CONFIGURATION_CHANGE,function(e,t){t&&"object"==typeof t&&v.session.addObject(t)})}function n(){var e=[f.Ready,f.Completed],t=o.once(r);m.init(c.currentSite.groups),y.investigate(),_.init(),y.report(),h.transition("WaitingForResponse"),e.indexOf(h.state)<0&&t(),h.on("transition",function(n){n.toState!==f.PendingApproval&&(g.saveStateToSession(n.toState),v.session.user.state=n.toState,v.session.save(),s.syncSession(v.session),e.indexOf(n.toState)<0&&t(),i&&i.set("state",n.toState))})}function r(){d.request().then(function(e){e||vngageapp.require(["models/app-model","collections/messages"],function(e,t){function n(){var e=p.getOwnerParticipant(),t=e?e.info.profilePicture:i.get("support").agentImage,n=e?e.info.name:"";if(e){var r={displayName:n,profilePicture:t};i.set("user",r)}}function r(){var e=l.getMappedMessagesOfConversation();switch(e.length&&t.add(e),l.getState()){case"pendingStart":h.handle("ReactToQueued");break;case"open":h.handle("ReactToDialog");break;case"suspended":i.set("inTransfer",!0);break;case"closed":h.handle("End")}}i=e,i.set("state",h.state),a.subscribe(u.CONVERSATION_STARTED,function(){h.handle("ReactToApproval"),h.handle("Approve"),w.update()}),a.subscribe(u.CONVERSATION_SUSPENDED,function(){i.set("inTransfer",!0)}),a.subscribe(u.CONVERSATION_RESUMED,function(){i.set("inTransfer",!1),h.handle("_onEnter")}),a.subscribe(u.EVENT_STORE,function(){n(),r()}),a.subscribe(u.PARTICIPANTS_STORE,function(){n();var e=o.keys(b.getAll())[0];if(!e)return!1;var r=p.getWritingParticipantsOfConversation(e),i=p.getOwnerParticipant();if(r.length>0?(t.removeUserWritingMessage(),t.addTyping({value:{isWriting:!0},messageType:"participantWriting"})):t.removeUserWritingMessage(),i)switch(i.connectionState){case"ok":t.clearErrorMessages({command:"userConnection",type:"active",entity:"error"});break;case"lost":t.addMessage({command:"userConnection",type:"lost",entity:"error"});break;case"dead":t.addMessage({command:"userConnection",type:"dead",entity:"error"})}}),r()})})}var i,o=e("underscore"),a=e("pubsub"),s=e("connection"),c=e("appConfig"),u=e("core/vngage/eventsVO"),l=e("stores/EventStore"),p=e("stores/ParticipantsStore"),d=e("services/appLoader"),f=e("core/vngage/visitorStates"),g=e("services/requesterCalls"),h=e("core/vngage/stateMachine"),v=e("applications/psLegacy/parts/shellLoader"),m=e("queueStatus"),y=e("applications/analyze/analyze"),b=e("stores/ConversationsStore"),w=e("components/cobrowser/browserAttributes"),_=e("applications/psLegacy/parts/opportunityHandler");return{listen:t}}),vngageapp.define("main",["require","vergic.polyfill","runtime","services/siteSetter","core/vngage/getQueryParameter","core/vngage/configuration","connection","api","psMain","applications/psLegacy/parts/shellLoader","core/vngage/extensions","core/vngage/store-cookies","applications/banners/handler","stateSubscriber"],function(e){"use strict";function t(e,n){if(e)return!1;var s={branch:i("vngageBranch"),revision:i("vngageRevision")};o.get(vngage.config.comm.restUrl,n,s).then(function(e){e&&"norevision"!==e?(o.clearRevision(),a.clearSession(),a.verifySession().then(function(e,n){t(e,n)})):(d.init(),l.init(vngage.extensions),r.evaluate(),c.init(),window.top===window.self&&(u.startConnection(),a.start()))})}var n=(e("vergic.polyfill"),e("runtime")),r=e("services/siteSetter"),i=e("core/vngage/getQueryParameter"),o=e("core/vngage/configuration"),a=e("connection"),s=e("api"),c=e("psMain"),u=e("applications/psLegacy/parts/shellLoader"),l=e("core/vngage/extensions"),p=e("core/vngage/store-cookies"),d=e("applications/banners/handler"),f=e("stateSubscriber");if(p.isBlocked()||!n.approve())return!1;window.vngage=window.vngage||{},vngage.subscribe=s.subscribe,vngage.unsubscribe=s.unsubscribe,vngage.track=s.track,vngage.update=s.update,vngage.join=s.join,vngage.get=s.get,vngage.set=s.set,vngage.__p=s.__p,window.psPlugin=window.psPlugin||{},psPlugin.get=s.get,psPlugin.join=s.join;for(var g in vngage._subscriptions)if(vngage._subscriptions.hasOwnProperty(g)){var h=vngage._subscriptions[g];if(!h.length)continue;for(var v=0,m=h.length;m>v;v++)vngage.subscribe(g,h[v].func)}o.set(vngage.config),f.listen(),r.evaluate(),a.verifySession().then(t)}),vngageapp.require.config({waitSeconds:18,paths:{jquery:"../vendor/jquery/jquery-built",noconflict:"../vendor/jquery/noconflict",underscore:"../vendor/underscore-amd/lodash",lodashNoConflict:"../vendor/underscore-amd/lodashNoConflict",backbone:"../vendor/backbone/backbone",promise:"../vendor/promisejs/promise",cookies:"../vendor/cookiesjs/cookies",favicon:"core/vngage/favicon",doT:"../vendor/doT/doT",mmd:"../vendor/mmd/mmd",templates:"tpl/doTemplates",text:"../vendor/requirejs/text",pubsub:"../vendor/pubsubJS/pubsub-vngage",purchase:"applications/psLegacy/parts/purchase",jschannel:"../vendor/JSChannel/jschannel",appConfig:"models/app-configuration",connection:"core/vngage/connection",winIdChecker:"core/vngage/winIdChecker",batchrequest:"core/vngage/batchrequest",machina:"../vendor/machina/machina","vergic.module":"core/common/module","vergic.ui":"core/common/ui","vergic.polyfill":"core/common/polyfills","vergic.dom":"core/common/dom","vergic.environment":"core/common/environment","vergic.components.modal":"components/modal/modal-view",api:"core/vngage/api-visitor",queueStatus:"components/queue/queue-status","components/draggable":"components/panel-draggable","components/chat":"components/chat",dialog:"applications/dialog/main",language:"language",psMain:"applications/psLegacy/main",psCoworker:"applications/psLegacy/psCoworker",swfObject:"components/videocapture/utils/swfobject",easyrtc:"../vendor/easyrtc/easyrtc-amd","socket.io":"socket.io",main:"main.min",app:"app.min"},map:{"*":{jquery:"noconflict",underscore:"lodashNoConflict"},noconflict:{jquery:"jquery"},lodashNoConflict:{underscore:"underscore"}},shim:{swfObject:{exports:"swfobject"}},packages:[{name:"videochat",location:"components/videocapture/",main:"main.min"},{name:"webrtcvideo",location:"components/webrtcvideo/",main:"main.min"},{name:"pdfcapture",location:"components/pdfcapture/",main:"main.min"}]}),vngageapp.require(["main"]),vngageapp.define("require-config-production",function(){}),vngageapp.define("vergic.components.modal",["require","underscore","vergic.dom"],function(e){"use strict";var t=e("underscore"),n=e("vergic.dom"),r=function(e){var n={theme:"dark",overlay:!0,width:"100%",height:"100%",content:"",stage:"body",force:!0,onClose:null};this.options=t.extend(n,e),this.init()};return r.prototype.createWindow=function(){var e;this.modalbg=document.createElement("div"),this.inner=document.createElement("div"),this.options.takeover?(e="vngage-banner vngage-takeover",this.inner.className="vngage-content"):(e=this.options.className+" vngage-modal-container vngage-ui vngage-modal-theme-"+this.options.theme,this.modalbg.style.width=this.options.width,this.modalbg.style.height=this.options.height,this.inner.className="vngage-centered"),this.options.overlay===!0&&(e+=" vngage-modal-overlay"),this.modalbg.className=e,"string"==typeof this.options.content?this.inner.innerHTML=this.options.content:this.inner.appendChild(this.options.content),this.modalbg.appendChild(this.inner),"string"==typeof this.options.stage?document.querySelector(this.options.stage).appendChild(this.modalbg):this.options.stage.appendChild(this.modalbg),this.options.force===!1&&this.addListeners(),this.elementListeners=[]},r.prototype.hide=function(e){e=e||window.event;var t=e.target||e.srcElement;return this.modalbg||t.getAttribute("data-bypass")?void this.dispose():!1},r.prototype.dispose=function(){this.name=null,this.removeListeners(),this.removeElementListeners(),n.removeClass(this.modalbg,"active");var e=t.bind(function(){if("string"==typeof this.options.stage){var e=document.querySelector(this.options.stage);if(!e)return;this.modalbg&&this.modalbg.parentNode&&e.removeChild(this.modalbg)}else{if(!this.options.stage)return;this.options.stage.removeChild(this.modalbg)}null!==this.options.onClose&&this.options.onClose()},this);t.delay(e,500)},r.prototype.init=function(){this.createWindow();var e=t.bind(function(){this.modalbg.className+=" active"},this);t.delay(e,200)},r.prototype.addListeners=function(){this.modalBgHandler=t.bind(this.hide,this),this.modalbg.addEventListener?this.modalbg.addEventListener("click",this.modalBgHandler):this.modalbg.attachEvent("onclick",this.modalBgHandler)},r.prototype.removeListeners=function(){this.modalbg.addEventListener?this.modalbg.removeEventListener("click",this.modalBgHandler):this.modalbg.detachEvent("onclick",this.modalBgHandler)},r.prototype.removeElementListeners=function(){t.each(this.elementListeners,function(e){document.getElementById(e.id).removeEventListener(e.event,e.callback)})},r.prototype.on=function(e,n,r,i){document.getElementById(n).addEventListener(e,t.once(r.bind(i))),this.elementListeners.push({id:n,event:e,callback:r})},r.prototype.getId=function(){return this.options.id},r}),vngageapp.define("views/reject-modal",["require","vergic.components.modal"],function(e){"use strict";function t(e,t){var n,o;return t=t||"Ok",e?(document.body.appendChild(i),n=['<div class="modal-inner bright"> ','<div class="vngage-group"><p>'+e+"</p></div>",'<a data-bypass="true" href="javascript:;" ','class="vngage-btn vngage-btn-success">',""+t+"</a></div>"].join(""),o=new r({content:n,stage:".vngage-ui",className:"vngage-modal-fixed",takeover:!0,force:!1,onClose:function(){document.body.removeChild(i)}})):!1}function n(){i.parentNode&&document.body.removeChild(i)}var r=e("vergic.components.modal"),i=document.createElement("div");return i.className="vngage-ui",{show:t,dispose:n}}),function(){window.vngage=window.vngage||{},window.vngage.version="2.7.141"}();
vngageapp.require.config({baseUrl:"https://hm-content-a.vergic.com/visitor/2.7.141/"});