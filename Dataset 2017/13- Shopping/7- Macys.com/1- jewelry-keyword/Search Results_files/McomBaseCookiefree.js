var requirejs,require,define,paths,shims,TotalCookieSize,TotalCookieCount;!function(global,setTimeout){var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.2",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!!("undefined"!==typeof window&&"undefined"!==typeof navigator&&window.document),isWebWorker=!isBrowser&&"undefined"!==typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!==typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=false;function commentReplace(a,b){return b||""}function isFunction(a){return"[object Function]"===ostring.call(a)}function isArray(a){return"[object Array]"===ostring.call(a)}function each(a,b){if(a){var c;for(c=0;c<a.length;c+=1)if(a[c]&&b(a[c],c,a))break}}function eachReverse(a,b){if(a){var c;for(c=a.length-1;c>-1;c-=1)if(a[c]&&b(a[c],c,a))break}}function hasProp(a,b){return hasOwn.call(a,b)}function getOwn(a,b){return hasProp(a,b)&&a[b]}function eachProp(a,b){var c;for(c in a)if(hasProp(a,c))if(b(a[c],c))break}function mixin(a,b,c,d){if(b)eachProp(b,function(b,e){if(c||!hasProp(a,e))if(d&&"object"===typeof b&&b&&!isArray(b)&&!isFunction(b)&&!(b instanceof RegExp)){if(!a[e])a[e]={};mixin(a[e],b,c,d)}else a[e]=b});return a}function bind(a,b){return function(){return b.apply(a,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(a){throw a}function getGlobal(a){if(!a)return a;var b=global;each(a.split("."),function(a){b=b[a]});return b}function makeError(a,b,c,d){var e=new Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);e.requireType=a;e.requireModules=d;if(c)e.originalError=c;return e}if("undefined"!==typeof define)return;if("undefined"!==typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs;requirejs=void 0}if("undefined"!==typeof require&&!isFunction(require)){cfg=require;require=void 0}function newContext(a){var b,c,d,e,f,g={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},h={},i={},j={},k=[],l={},m={},n={},o=1,p=1;function q(a){var b,c;for(b=0;b<a.length;b++){c=a[b];if("."===c){a.splice(b,1);b-=1}else if(".."===c)if(0===b||1===b&&".."===a[2]||".."===a[b-1])continue;else if(b>0){a.splice(b-1,2);b-=2}}}function r(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,r=b&&b.split("/"),s=g.map,t=s&&s["*"];if(a){a=a.split("/");k=a.length-1;if(g.nodeIdCompat&&jsSuffixRegExp.test(a[k]))a[k]=a[k].replace(jsSuffixRegExp,"");if("."===a[0].charAt(0)&&r){p=r.slice(0,r.length-1);a=p.concat(a)}q(a);a=a.join("/")}if(c&&s&&(r||t)){f=a.split("/");a:for(h=f.length;h>0;h-=1){j=f.slice(0,h).join("/");if(r)for(i=r.length;i>0;i-=1){e=getOwn(s,r.slice(0,i).join("/"));if(e){e=getOwn(e,j);if(e){l=e;m=h;break a}}}if(!n&&t&&getOwn(t,j)){n=getOwn(t,j);o=h}}if(!l&&n){l=n;m=o}if(l){f.splice(0,m,l);a=f.join("/")}}d=getOwn(g.pkgs,a);return d?d:a}function s(a){if(isBrowser)each(scripts(),function(b){if(b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===d.contextName){b.parentNode.removeChild(b);return true}})}function t(a){var b=getOwn(g.paths,a);if(b&&isArray(b)&&b.length>1){b.shift();d.require.undef(a);d.makeRequire(null,{skipMap:true})([a]);return true}}function u(a){var b,c=a?a.indexOf("!"):-1;if(c>-1){b=a.substring(0,c);a=a.substring(c+1,a.length)}return[b,a]}function v(a,b,c,e){var f,g,h,i,j=null,k=b?b.name:null,m=a,n=true,q="";if(!a){n=false;a="_@r"+(o+=1)}i=u(a);j=i[0];a=i[1];if(j){j=r(j,k,e);g=getOwn(l,j)}if(a)if(j)if(g&&g.normalize)q=g.normalize(a,function(a){return r(a,k,e)});else q=a.indexOf("!")===-1?r(a,k,e):a;else{q=r(a,k,e);i=u(q);j=i[0];q=i[1];c=true;f=d.nameToUrl(q)}h=j&&!g&&!c?"_unnormalized"+(p+=1):"";return{prefix:j,name:q,parentMap:b,unnormalized:!!h,url:f,originalName:m,isDefine:n,id:(j?j+"!"+q:q)+h}}function w(a){var b=a.id,c=getOwn(h,b);if(!c)c=h[b]=new d.Module(a);return c}function x(a,b,c){var d=a.id,e=getOwn(h,d);if(hasProp(l,d)&&(!e||e.defineEmitComplete)){if("defined"===b)c(l[d])}else{e=w(a);if(e.error&&"error"===b)c(e.error);else e.on(b,c)}}function y(a,b){var c=a.requireModules,d=false;if(b)b(a);else{each(c,function(b){var c=getOwn(h,b);if(c){c.error=a;if(c.events.error){d=true;c.emit("error",a)}}});if(!d)req.onError(a)}}function z(){if(globalDefQueue.length){each(globalDefQueue,function(a){var b=a[0];if("string"===typeof b)d.defQueueMap[b]=true;k.push(a)});globalDefQueue=[]}}e={require:function(a){if(a.require)return a.require;else return a.require=d.makeRequire(a.map)},exports:function(a){a.usingExports=true;if(a.map.isDefine)if(a.exports)return l[a.map.id]=a.exports;else return a.exports=l[a.map.id]={}},module:function(a){if(a.module)return a.module;else return a.module={id:a.map.id,uri:a.map.url,config:function(){return getOwn(g.config,a.map.id)||{}},exports:a.exports||(a.exports={})}}};function A(a){delete h[a];delete i[a]}function B(a,b,c){var d=a.map.id;if(a.error)a.emit("error",a.error);else{b[d]=true;each(a.depMaps,function(d,e){var f=d.id,g=getOwn(h,f);if(g&&!a.depMatched[e]&&!c[f])if(getOwn(b,f)){a.defineDep(e,l[f]);a.check()}else B(g,b,c)});c[d]=true}}function C(){var a,c,e=1e3*g.waitSeconds,h=e&&d.startTime+e<(new Date).getTime(),j=[],k=[],l=false,m=true;if(b)return;b=true;eachProp(i,function(a){var b=a.map,d=b.id;if(!a.enabled)return;if(!b.isDefine)k.push(a);if(!a.error)if(!a.inited&&h)if(t(d)){c=true;l=true}else{j.push(d);s(d)}else if(!a.inited&&a.fetched&&b.isDefine){l=true;if(!b.prefix)return m=false}});if(h&&j.length){a=makeError("timeout","Load timeout for modules: "+j,null,j);a.contextName=d.contextName;return y(a)}if(m)each(k,function(a){B(a,{},{})});if((!h||c)&&l)if((isBrowser||isWebWorker)&&!f)f=setTimeout(function(){f=0;C()},50);b=false}c=function(a){this.events=getOwn(j,a.id)||{};this.map=a;this.shim=getOwn(g.shim,a.id);this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0};c.prototype={init:function(a,b,c,d){d=d||{};if(this.inited)return;this.factory=b;if(c)this.on("error",c);else if(this.events.error)c=bind(this,function(a){this.emit("error",a)});this.depMaps=a&&a.slice(0);this.errback=c;this.inited=true;this.ignore=d.ignore;if(d.enabled||this.enabled)this.enable();else this.check()},defineDep:function(a,b){if(!this.depMatched[a]){this.depMatched[a]=true;this.depCount-=1;this.depExports[a]=b}},fetch:function(){if(this.fetched)return;this.fetched=true;d.startTime=(new Date).getTime();var a=this.map;if(this.shim)d.makeRequire(this.map,{enableBuildCallback:true})(this.shim.deps||[],bind(this,function(){return a.prefix?this.callPlugin():this.load()}));else return a.prefix?this.callPlugin():this.load()},load:function(){var a=this.map.url;if(!m[a]){m[a]=true;d.load(this.map.id,a)}},check:function(){var a,b,c,e,f,g,h;if(!this.enabled||this.enabling)return;c=this.map.id,e=this.depExports,f=this.exports,g=this.factory;if(!this.inited){if(!hasProp(d.defQueueMap,c))this.fetch()}else if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=true;if(this.depCount<1&&!this.defined){if(isFunction(g)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{f=d.execCb(c,g,e,f)}catch(i){a=i}else f=d.execCb(c,g,e,f);if(this.map.isDefine&&void 0===f){b=this.module;if(b)f=b.exports;else if(this.usingExports)f=this.exports}if(a){a.requireMap=this.map;a.requireModules=this.map.isDefine?[this.map.id]:null;a.requireType=this.map.isDefine?"define":"require";return y(this.error=a)}}else f=g;this.exports=f;if(this.map.isDefine&&!this.ignore){l[c]=f;if(req.onResourceLoad){h=[];each(this.depMaps,function(a){h.push(a.normalizedMap||a)});req.onResourceLoad(d,this.map,h)}}A(c);this.defined=true}this.defining=false;if(this.defined&&!this.defineEmitted){this.defineEmitted=true;this.emit("defined",this.exports);this.defineEmitComplete=true}}},callPlugin:function(){var a=this.map,b=a.id,c=v(a.prefix);this.depMaps.push(c);x(c,"defined",bind(this,function(c){var e,f,i,j=getOwn(n,this.map.id),k=this.map.name,l=this.map.parentMap?this.map.parentMap.name:null,m=d.makeRequire(a.parentMap,{enableBuildCallback:true});if(this.map.unnormalized){if(c.normalize)k=c.normalize(k,function(a){return r(a,l,true)})||"";f=v(a.prefix+"!"+k,this.map.parentMap);x(f,"defined",bind(this,function(a){this.map.normalizedMap=f;this.init([],function(){return a},null,{enabled:true,ignore:true})}));i=getOwn(h,f.id);if(i){this.depMaps.push(f);if(this.events.error)i.on("error",bind(this,function(a){this.emit("error",a)}));i.enable()}return}if(j){this.map.url=d.nameToUrl(j);this.load();return}e=bind(this,function(a){this.init([],function(){return a},null,{enabled:true})});e.error=bind(this,function(a){this.inited=true;this.error=a;a.requireModules=[b];eachProp(h,function(a){if(0===a.map.id.indexOf(b+"_unnormalized"))A(a.map.id)});y(a)});e.fromText=bind(this,function(c,f){var h=a.name,i=v(h),j=useInteractive;if(f)c=f;if(j)useInteractive=false;w(i);if(hasProp(g.config,b))g.config[h]=g.config[b];try{req.exec(c)}catch(k){return y(makeError("fromtexteval","fromText eval for "+b+" failed: "+k,k,[b]))}if(j)useInteractive=true;this.depMaps.push(i);d.completeLoad(h);m([h],e)});c.load(a.name,m,e,g)}));d.enable(c,this);this.pluginMaps[c.id]=c},enable:function(){i[this.map.id]=this;this.enabled=true;this.enabling=true;each(this.depMaps,bind(this,function(a,b){var c,f,g;if("string"===typeof a){a=v(a,this.map.isDefine?this.map:this.map.parentMap,false,!this.skipMap);this.depMaps[b]=a;g=getOwn(e,a.id);if(g){this.depExports[b]=g(this);return}this.depCount+=1;x(a,"defined",bind(this,function(a){if(this.undefed)return;this.defineDep(b,a);this.check()}));if(this.errback)x(a,"error",bind(this,this.errback));else if(this.events.error)x(a,"error",bind(this,function(a){this.emit("error",a);
}))}c=a.id;f=h[c];if(!hasProp(e,c)&&f&&!f.enabled)d.enable(a,this)}));eachProp(this.pluginMaps,bind(this,function(a){var b=getOwn(h,a.id);if(b&&!b.enabled)d.enable(a,this)}));this.enabling=false;this.check()},on:function(a,b){var c=this.events[a];if(!c)c=this.events[a]=[];c.push(b)},emit:function(a,b){each(this.events[a],function(a){a(b)});if("error"===a)delete this.events[a]}};function D(a){if(!hasProp(l,a[0]))w(v(a[0],null,true)).init(a[1],a[2])}function E(a,b,c,d){if(a.detachEvent&&!isOpera){if(d)a.detachEvent(d,b)}else a.removeEventListener(c,b,false)}function F(a){var b=a.currentTarget||a.srcElement;E(b,d.onScriptLoad,"load","onreadystatechange");E(b,d.onScriptError,"error");return{node:b,id:b&&b.getAttribute("data-requiremodule")}}function G(){var a;z();while(k.length){a=k.shift();if(null===a[0])return y(makeError("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));else D(a)}d.defQueueMap={}}d={config:g,contextName:a,registry:h,defined:l,urlFetched:m,defQueue:k,defQueueMap:{},Module:c,makeModuleMap:v,nextTick:req.nextTick,onError:y,configure:function(a){var b,c,e;if(a.baseUrl)if("/"!==a.baseUrl.charAt(a.baseUrl.length-1))a.baseUrl+="/";if("string"===typeof a.urlArgs){b=a.urlArgs;a.urlArgs=function(a,c){return(c.indexOf("?")===-1?"?":"&")+b}}c=g.shim,e={paths:true,bundles:true,config:true,map:true};eachProp(a,function(a,b){if(e[b]){if(!g[b])g[b]={};mixin(g[b],a,true,true)}else g[b]=a});if(a.bundles)eachProp(a.bundles,function(a,b){each(a,function(a){if(a!==b)n[a]=b})});if(a.shim){eachProp(a.shim,function(a,b){if(isArray(a))a={deps:a};if((a.exports||a.init)&&!a.exportsFn)a.exportsFn=d.makeShimExports(a);c[b]=a});g.shim=c}if(a.packages)each(a.packages,function(a){var b,c;a="string"===typeof a?{name:a}:a;c=a.name;b=a.location;if(b)g.paths[c]=a.location;g.pkgs[c]=a.name+"/"+(a.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")});eachProp(h,function(a,b){if(!a.inited&&!a.map.unnormalized)a.map=v(b,null,true)});if(a.deps||a.callback)d.require(a.deps||[],a.callback)},makeShimExports:function(a){function b(){var b;if(a.init)b=a.init.apply(global,arguments);return b||a.exports&&getGlobal(a.exports)}return b},makeRequire:function(b,c){c=c||{};function f(g,i,j){var k,m,n;if(c.enableBuildCallback&&i&&isFunction(i))i.__requireJsBuild=true;if("string"===typeof g){if(isFunction(i))return y(makeError("requireargs","Invalid require call"),j);if(b&&hasProp(e,g))return e[g](h[b.id]);if(req.get)return req.get(d,g,b,f);m=v(g,b,false,true);k=m.id;if(!hasProp(l,k))return y(makeError("notloaded",'Module name "'+k+'" has not been loaded yet for context: '+a+(b?"":". Use require([])")));return l[k]}G();d.nextTick(function(){G();n=w(v(null,b));n.skipMap=c.skipMap;n.init(g,i,j,{enabled:true});C()});return f}mixin(f,{isBrowser:isBrowser,toUrl:function(a){var c,e=a.lastIndexOf("."),f=a.split("/")[0],g="."===f||".."===f;if(e!==-1&&(!g||e>1)){c=a.substring(e,a.length);a=a.substring(0,e)}return d.nameToUrl(r(a,b&&b.id,true),c,true)},defined:function(a){return hasProp(l,v(a,b,false,true).id)},specified:function(a){a=v(a,b,false,true).id;return hasProp(l,a)||hasProp(h,a)}});if(!b)f.undef=function(a){z();var c=v(a,b,true),e=getOwn(h,a);e.undefed=true;s(a);delete l[a];delete m[c.url];delete j[a];eachReverse(k,function(b,c){if(b[0]===a)k.splice(c,1)});delete d.defQueueMap[a];if(e){if(e.events.defined)j[a]=e.events;A(a)}};return f},enable:function(a){var b=getOwn(h,a.id);if(b)w(a).enable()},completeLoad:function(a){var b,c,e,f=getOwn(g.shim,a)||{},i=f.exports;z();while(k.length){c=k.shift();if(null===c[0]){c[0]=a;if(b)break;b=true}else if(c[0]===a)b=true;D(c)}d.defQueueMap={};e=getOwn(h,a);if(!b&&!hasProp(l,a)&&e&&!e.inited)if(g.enforceDefine&&(!i||!getGlobal(i)))if(t(a))return;else return y(makeError("nodefine","No define call for "+a,null,[a]));else D([a,f.deps||[],f.exportsFn]);C()},nameToUrl:function(a,b,c){var e,f,h,i,j,k,l,m=getOwn(g.pkgs,a);if(m)a=m;l=getOwn(n,a);if(l)return d.nameToUrl(l,b,c);if(req.jsExtRegExp.test(a))j=a+(b||"");else{e=g.paths;f=a.split("/");for(h=f.length;h>0;h-=1){i=f.slice(0,h).join("/");k=getOwn(e,i);if(k){if(isArray(k))k=k[0];f.splice(0,h,k);break}}j=f.join("/");j+=b||(/^data\:|^blob\:|\?/.test(j)||c?"":".js");j=("/"===j.charAt(0)||j.match(/^[\w\+\.\-]+:/)?"":g.baseUrl)+j}return g.urlArgs&&!/^blob\:/.test(j)?j+g.urlArgs(a,j):j},load:function(a,b){req.load(d,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if("load"===a.type||readyRegExp.test((a.currentTarget||a.srcElement).readyState)){interactiveScript=null;var b=F(a);d.completeLoad(b.id)}},onScriptError:function(a){var b,c=F(a);if(!t(c.id)){b=[];eachProp(h,function(a,d){if(0!==d.indexOf("_@r"))each(a.depMaps,function(a){if(a.id===c.id){b.push(d);return true}})});return y(makeError("scripterror",'Script error for "'+c.id+(b.length?'", needed by: '+b.join(", "):'"'),a,[c.id]))}}};d.require=d.makeRequire();return d}req=requirejs=function(a,b,c,d){var e,f,g=defContextName;if(!isArray(a)&&"string"!==typeof a){f=a;if(isArray(b)){a=b;b=c;c=d}else a=[]}if(f&&f.context)g=f.context;e=getOwn(contexts,g);if(!e)e=contexts[g]=req.s.newContext(g);if(f)e.configure(f);return e.require(a,b,c)};req.config=function(a){return req(a)};req.nextTick="undefined"!==typeof setTimeout?function(a){setTimeout(a,4)}:function(a){a()};if(!require)require=req;req.version=version;req.jsExtRegExp=/^\/|:|\?|\.js$/;req.isBrowser=isBrowser;s=req.s={contexts:contexts,newContext:newContext};req({});each(["toUrl","undef","defined","specified"],function(a){req[a]=function(){var b=contexts[defContextName];return b.require[a].apply(b,arguments)}});if(isBrowser){head=s.head=document.getElementsByTagName("head")[0];baseElement=document.getElementsByTagName("base")[0];if(baseElement)head=s.head=baseElement.parentNode}req.onError=defaultOnError;req.createNode=function(a,b,c){var d=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");d.type=a.scriptType||"text/javascript";d.charset="utf-8";d.async=true;return d};req.load=function(a,b,c){var d=a&&a.config||{},e;if(isBrowser){e=req.createNode(d,b,c);e.setAttribute("data-requirecontext",a.contextName);e.setAttribute("data-requiremodule",b);if(e.attachEvent&&!(e.attachEvent.toString&&e.attachEvent.toString().indexOf("[native code")<0)&&!isOpera){useInteractive=true;e.attachEvent("onreadystatechange",a.onScriptLoad)}else{e.addEventListener("load",a.onScriptLoad,false);e.addEventListener("error",a.onScriptError,false)}e.src=c;if(d.onNodeCreated)d.onNodeCreated(e,d,b,c);currentlyAddingScript=e;if(baseElement)head.insertBefore(e,baseElement);else head.appendChild(e);currentlyAddingScript=null;return e}else if(isWebWorker)try{setTimeout(function(){},0);importScripts(c);a.completeLoad(b)}catch(f){a.onError(makeError("importscripts","importScripts failed for "+b+" at "+c,f,[b]))}};function getInteractiveScript(){if(interactiveScript&&"interactive"===interactiveScript.readyState)return interactiveScript;eachReverse(scripts(),function(a){if("interactive"===a.readyState)return interactiveScript=a});return interactiveScript}if(isBrowser&&!cfg.skipDataMain)eachReverse(scripts(),function(a){if(!head)head=a.parentNode;dataMain=a.getAttribute("data-main");if(dataMain){mainScript=dataMain;if(!cfg.baseUrl&&mainScript.indexOf("!")===-1){src=mainScript.split("/");mainScript=src.pop();subPath=src.length?src.join("/")+"/":"./";cfg.baseUrl=subPath}mainScript=mainScript.replace(jsSuffixRegExp,"");if(req.jsExtRegExp.test(mainScript))mainScript=dataMain;cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript];return true}});define=function(a,b,c){var d,e;if("string"!==typeof a){c=b;b=a;a=null}if(!isArray(b)){c=b;b=null}if(!b&&isFunction(c)){b=[];if(c.length){c.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,function(a,c){b.push(c)});b=(1===c.length?["require"]:["require","exports","module"]).concat(b)}}if(useInteractive){d=currentlyAddingScript||getInteractiveScript();if(d){if(!a)a=d.getAttribute("data-requiremodule");e=contexts[d.getAttribute("data-requirecontext")]}}if(e){e.defQueue.push([a,b,c]);e.defQueueMap[a]=true}else globalDefQueue.push([a,b,c])};define.amd={jQuery:true};req.exec=function(text){return eval(text)};req(cfg)}(this,"undefined"===typeof setTimeout?void 0:setTimeout);!function(){var a={async:"js/vendor/script/requirejs/async",domReady:"js/vendor/script/requirejs/domReady",devicePrint:"js/vendor/script/devicePrint/deviceprint-amd",handlebars:"js/vendor/script/handlebars/handlebars",hammer:"js/vendor/script/hammerjs/hammer",inputMask:"js/vendor/script/input-mask/jquery.mask",jquery:"js/vendor/script/jquery/jquery-1.9.1",jqueryui:"js/vendor/script/jqueryui/jquery-ui-1.10.2.custom","jqueryui-amd":"js/vendor/script/jqueryui-amd",marionette:"js/vendor/script/marionette/backbone.marionette",require:"js/vendor/script/requirejs/require",swfobject:"js/vendor/script/swfobject/swfobject",text:"js/vendor/script/requirejs/text",underscore:"js/vendor/script/underscorejs/underscore",backbone:"js/vendor/script/backbonejs/backbone",backbonerelational:"js/vendor/script/backbone-relational/backbone-relational","backbone.babysitter":"js/vendor/script/backbone-babysitter/backbone.babysitter","backbone.wreqr":"js/vendor/script/backbone-wreqr/backbone.wreqr",backboneradio:"js/vendor/script/backbone-radio/backbone.radio",webfont:"js/vendor/script/requirejs/webfont",iscroll:"js/vendor/script/iscroll/iscroll",iscrollIE8:"js/vendor/script/iscroll/iscroll-ie8",iscrollinfinite:"js/vendor/script/iscroll/iscroll-infinite",fastClick:"js/vendor/script/fastClick/fastclick",zeroclipboard:"js/vendor/script/zeroclipboard/zeroclipboard",accordian:"js/common/components/Accordian",addressModel:"js/common/backbone/models/address/AddressModel",baseModel:"js/common/backbone/models/BaseModel",baseNestedModel:"js/common/backbone/models/BaseNestedModel",baseView:"js/common/views/Base",buttonZoomer:"js/common/components/zoomer/ButtonZoomer",category:"js/common/models/Category",
categoryCollection:"js/common/collections/CategoryCollection",carousel:"js/common/components/Carousel",channel:"js/common/util/facade/Channel",checkout:"js/common/features/checkout",clock:"js/common/features/clock/Clock",colorSwatches:"js/common/components/colorSwatches",commonjs:"js/common",commonRePaymentBase:"js/common/features/repayment",commonRc:"js/common/features/rcCheckout",commonBops:"js/common/features/bops",creditCardsList:"js/common/backbone/models/creditCard/CreditCardsList",creditCardModel:"js/common/backbone/models/creditCard/CreditCardModel",credit:"js/common/features/credit",customValidations:"js/common/components/validation/customValidations",customDropDown:"js/common/features/credit/CustomDropDown",drawerView:"js/common/components/base/DrawerView",footerView:"js/common/components/base/FooterView",formHandlerDisplay:"js/common/components/formHandler/FormHandlerDisplay",formHandlerMain:"js/common/components/formHandler/FormHandlerMain",formHandlerRecoveryTexts:"js/common/components/formHandler/FormHandlerRecoveryTexts",formHandlerRules:"js/common/components/formHandler/FormHandlerRules",formHandlerUtil:"js/common/components/formHandler/FormHandlerUtil",formHandlerValidate:"js/common/components/formHandler/FormHandlerValidate",forgotPassword:"js/common/features/forgotPassword",googleConfig:"js/common/base/GoogleConfig",googleMaps:"js/common/components/stores/GoogleMaps",hbsFormHelpers:"js/common/hbsHelpers/FormHelpers",hbsHelpers:"js/common/hbsHelpers/Helpers",hbsUtils:"js/common/hbsHelpers/Utils",iShip:"js/common/components/iShip",imageLazyLoad:"js/common/components/productThumbnail/ImageLazyLoad",loader:"js/common/components/Loader",localStorage:"js/common/util/LocalStorageCache",models:"js/common/backbone/models",modelValidation:"js/common/components/validation/ModelValidation",overlayView:"js/common/components/base/OverlayView",offersList:"js/common/backbone/models/offers/OffersList",offersModel:"js/common/backbone/models/offers/OffersModel",pageApp:"js/common/pages/PageApp",phoneModel:"js/common/backbone/models/phone/PhoneModel",productModel:"js/common/backbone/models/Product",productThumbnail:"js/common/components/productThumbnail",prosTrackingHelper:"js/common/components/thumbCarousel/hbsHelpers/ProsTrackingHelper",rdppHelper:"js/common/features/rdpp/RdppHelper",recommendation:"js/common/components/Recommendation",rewardCardsList:"js/common/backbone/models/rewardCard/RewardCardsList",rewardCardModel:"js/common/backbone/models/rewardCard/RewardCardModel",lazyLoad:"js/common/components/lazyLoad",sampleModule:"js/common/base/SampleModule",segmentation:"js/common/util/Segmentation",sideBySideImageZoomer:"js/common/components/zoomer/SideBySideImageZoomer",store:"js/common/components/stores/Store",storeAvailability:"js/common/components/stores/StoreAvailability",storeCollection:"js/common/components/stores/StoresCollection",storeDataMergeHandler:"js/common/components/stores/StoreDataMergeHandler",storeFactory:"js/common/components/stores/StoresFactory",cnfStoreFactory:"js/common/components/stores/CnfStoreFactory",storesMap:"js/common/components/stores/StoresMap",storesNearby:"js/common/components/stores/StoresNearby",subCategory:"js/common/models/SubCategory",subCategoryCollection:"js/common/collections/SubCategoryCollection",user:"js/common/models/User",navigation:"js/common/collections/Navigation",postFor:"js/common/features/credit/PostBuilder",thumbnailCarousel:"js/common/components/thumbCarousel",thumbnail:"js/common/components/product/ProductImage",userLocation:"js/common/components/stores/UserLocation",validation:"js/common/components/validation/Validation",validationManager:"js/common/components/validation/ValidationManager",validators:"js/common/components/validation/validators/Common",wishList:"js/common/components/WishList/WishList",wishListCollection:"js/common/components/WishList/WishListCollection",wishListInfo:"js/common/components/WishList/WishListInfo",wishListPriceAlertModel:"js/common/components/WishList/WishListPriceAlertModel",uniqueNumber:"js/common/util/UniqueNumber",hbsTemplates:"/templates",hbsCommonTemplates:"templates/common",facetAnalytics:"js/common/features/refineByFacet/FacetAnalytics",recentlyViewed:"js/common/components/thumbCarousel/recentlyViewed/RecentlyViewedV3",rviCoremetrics:"js/common/components/thumbCarousel/recentlyViewed/RviCoremetrics",commonUtil:"js/common/util",analyticsBase:"js/common/util/AnalyticsBase",analyticsQueryString:"js/common/util/AnalyticsQueryString",arrayUtils:"js/common/util/ArrayUtils",autoTab:"js/common/util/AutoTabbing",browser:"js/common/util/Browser",cacheManager:"js/common/util/CacheManager",clientSideStorage:"js/common/util/ClientSideStorage",cookie:"js/common/util/Cookie",coremetricsAttributes:"js/common/util/CoremetricsAttributes",dateUtil:"js/common/util/DateUtil",equalizer:"js/common/util/Equalizer",form:"js/common/util/Form",globals:"js/common/util/Globals",imageUtils:"js/common/util/ImageUtils",keycodeFilter:"js/common/util/KeycodeFilter",logger:"js/common/util/Logger",mapCache:"js/common/util/MapCache",mathUtil:"js/common/util/MathUtil",objectUtil:"js/common/util/ObjectUtil",pubsub:"js/common/util/PublishSubscribe",pubsubMixin:"js/common/util/PublishSubscribeMixin",redirectUtil:"js/common/util/RedirectUtil",registryUtil:"js/common/util/RegistryUtil",security:"js/common/util/Security",serviceHandler:"js/common/util/ServiceHandler",sortedMap:"js/common/util/SortedMap",stringUtil:"js/common/util/StringUtil",urlUtil:"js/common/util/UrlUtils",userStatus:"js/common/util/UserStatus",contextFramework:"js/common/components/ContextFramework",textBoxClearable:"js/common/components/TextBoxClearable",textBoxFilterList:"js/common/components/TextBoxFilterList"},b={jqueryui:{deps:["jquery"],exports:"jQuery.ui"},marionette:{deps:["backbone"],exports:"Backbone.Marionette"},backboneradio:{deps:["backbone"],exports:"Backbone.Radio"},handlebars:{exports:"Handlebars"},swfobject:{exports:"swfobject"},iscroll:{exports:"IScroll"},iscrollIE8:{exports:"IScroll"},fastClick:{exports:"fastClick"},inputMask:{deps:["jquery"],exports:"jQuery.inputMask"}},c={"*":{commonUtil:"commonUtil","commonUtil/AnalyticsBase":"analyticsBase","commonUtil/AnalyticsQueryString":"analyticsQueryString","commonUtil/ArrayUtils":"arrayUtils","commonUtil/AutoTabbing":"autoTab","commonUtil/Browser":"browser","commonUtil/CacheManager":"cacheManager","commonUtil/ClientSideStorage":"clientSideStorage","commonUtil/Cookie":"cookie","commonUtil/CoremetricsAttributes":"coremetricsAttributes","commonUtil/DateUtil":"dateUtil","commonUtil/Equalizer":"equalizer","commonUtil/Form":"form","commonUtil/Globals":"globals","commonUtil/ImageUtils":"imageUtils","commonUtil/KeycodeFilter":"keycodeFilter","commonUtil/Logger":"logger","commonUtil/MapCache":"mapCache","commonUtil/MathUtil":"mathUtil","commonUtil/PublishSubscribe":"pubsub","commonUtil/PublishSubscribeMixin":"pubsubMixin","commonUtil/ObjectUtil":"objectUtil","commonUtil/RedirectUtil":"redirectUtil","commonUtil/RegistryUtil":"registryUtil","commonUtil/Security":"security","commonUtil/ServiceHandler":"serviceHandler","commonUtil/SortedMap":"sortedMap","commonUtil/StringUtil":"stringUtil","commonUtil/UrlUtils":"urlUtil","commonUtil/UserStatus":"userStatus","commonjs/util/AddOfferToWallet":"commonUtil/AddOfferToWallet","commonjs/util/BTDataDictionaryUtils":"commonUtil/BTDataDictionaryUtils","commonjs/util/HttpStatusCodes":"commonUtil/HttpStatusCodes","components/validation/Validation":"validation"}};require.config({paths:a,shim:b,map:c})}();paths={account2:"js/mcom/features/account2",accountHelpers:"js/mcom/features/account2/hbsHelpers/accountHelpers",addOffersView:"js/mcom/features/account2/wallet/views/AddOffersView",alternateImages:"js/mcom/components/AlternateImages",appController:"js/mcom/base/AppController",backToTop:"js/mcom/components/backToTop/BackToTop",bagContent:"js/mcom/components/thumbCarousel/BagContent",base:"js/mcom/components/Base",browsePageApp:"js/mcom/pages/BrowsePageApp",mcomBops:"js/mcom/features/bops",mcomBopsCookie:"js/mcom/features/bops/bops_Cookie",mcomBopsCoreMetrics:"js/mcom/features/refineByFacet/BopsCoremetrics",mcomBopsFacetCommon:"js/mcom/features/refineByFacet/BopsCommon",mcomBopsFacetOverlay:"js/mcom/features/refineByFacet/BopsOverlay",mcomBopsFacetSelect:"js/mcom/features/refineByFacet/BopsSelect",mcomBopsGME:"js/mcom/features/refineByFacet/BopsGme",breadcrumbs:"js/mcom/features/stores/jquery.rcrumbs",browseGridApp:"js/mcom/features/browseGrid/BrowseGridApp",cmElement:"js/mcom/util/CoreMetricsElement",creditFeature:"js/mcom/features/credit",creditCardView:"js/mcom/features/account2/wallet/views/CreditCardView",creditCardAddView:"js/mcom/features/account2/wallet/views/AddCreditCardView",colorSizeTypeManager:"js/mcom/components/quickView/views/ColorSizeTypeManager",commonOverlay:"js/mcom/features/account2/commonOverlay",detailsExclusionsView:"js/mcom/features/account2/wallet/views/DetailsExclusionsView",drp:"js/mcom/features/drp",dynamicCanvas:"js/mcom/features/refineByFacet/DynamicCanvas",eventSearchDetailView:"js/mcom/features/stores/event/view/EventSearchDetailView",eventSearchResultView:"js/mcom/features/stores/event/view/EventSearchResultView",eventSearchRouter:"js/mcom/features/stores/event/model/EventSearchRouter",eventSearchView:"js/mcom/features/stores/event/view/EventSearchView",enhancedQVModel:"js/mcom/components/enhancedQuickView/model/EnhancedQVModel",enhancedQVView:"js/mcom/components/enhancedQuickView/view/EnhancedQVView",enhancedQVUtil:"js/mcom/components/enhancedQuickView/util/EnhancedQVUtil",enhancedQVCMUtil:"js/mcom/components/enhancedQuickView/util/EnhancedQVCMUtil",enhancedQVColorSwatch:"js/mcom/components/enhancedQVColorSwatches/views/ColorSwatches",enhancedQVWishList:"js/mcom/components/enhancedQuickView/view/EnhancedQVWishList",facetCollectionView:"js/mcom/features/refineByFacet/views/FacetCollectionView",formValidation:"js/mcom/util/FormValidation",groupGift:"js/mcom/features/groupGift",
hbsCommonTemplates:"templates/common",headerDesktop:"js/mcom/features/header/Header",headerApp:"js/mcom/features/header/HeaderApp",headerFlyout:"js/mcom/features/header/HeaderFlyout",headerFOBNav:"js/mcom/features/header/HeaderFOBNavigation",homeModules:"js/mcom/pages/HomeModules",leanProfileInit:"js/mcom/features/leanProfile/LeanProfileInit",leanProfileView:"js/mcom/features/leanProfile/views/LeanProfileView",loyaltyFeature:"js/mcom/features/loyalty",loveItOrLeaveIt:"js/mcom/features/loveItOrLeaveIt/LoveItOrLeaveIt",mcomAnalytics:"js/mcom/components/analytics/Coremetrics",mcomVendorCoremetricsHelper:"js/mcom/components/analytics/VendorCoremetricsHelper",mcomjs:"js/mcom",mcomCheckoutBase:"js/mcom/features/checkout",mcomColorSwatches:"js/mcom/components/colorSwatches",mcomColorSwatchesTemplates:"templates/mcom/component/colorSwatches",mcomErrorMessages:"js/mcom/components/validation/errors",mcomForgotPassword:"js/mcom/features/forgotPassword",mcomFormValidators:"js/mcom/components/validation/formValidators",mcomFullOverlay:"js/mcom/components/FullOverlay",mcomLeanProduct:"js/mcom/features/leanProduct",mcomLeanProductTemplates:"templates/mcom/features/leanProduct",mcomOverlay:"js/mcom/components/Overlay",mcomProductThumbnail:"js/mcom/components/productThumbnail",mcomRcBase:"js/mcom/features/rcCheckout",mcomRePayment:"js/mcom/features/repayment",mcomRePaymentTemplates:"templates/mcom/features/repayment",mcomRcTemplates:"templates/mcom/features/rcCheckout",mcomSecurityResetPassword:"js/mcom/features/account2/securityresetpassword",mcomQuickBagTemplate:"templates/mcom/features/quickBag",mcomTemplates:"templates/mcom",mcomZoomer:"js/mcom/components/product/zoomer",mcomZoomerTemplates:"templates/mcom/component/product/zoomer",messagingLib:"js/mcom/util/MessagingLib",multiAccordion:"js/mcom/components/MultiAccordion",myAccounts:"js/mcom/features/account2/myAccounts",myReviews:"js/mcom/features/account2/myReviews/MyReviewsApplication",myReviewsAdditionalFields:"js/mcom/features/account2/myReviewsAdditionalFields/MyReviewsApplication",noCreditCardView:"js/mcom/features/account2/wallet/views/NoCreditCardView",noOffersView:"js/mcom/features/account2/wallet/views/NoOffersView",orderDetailsTracking:"js/mcom/features/ordermanagement/OrderDetailsTracking",ocWalletjs:"js/mcom/features/account2/wallet",orderManagement:"js/mcom/features/ordermanagement",orderManagementTemplates:"templates/mcom/features/orderManagement",paypal:"js/mcom/features/paypal",productCommon:"js/mcom/features/product/common",productColorway:"js/mcom/features/product/colorway",productCommonTemplates:"templates/mcom/features/product/common",productDecisionHelperPanel:"js/mcom/features/product/decisionHelperPanel",productOffersSummary:"js/mcom/features/product/offersSummary",productReviews:"js/mcom/components/product/reviews",productReviewsSummary:"js/mcom/features/product/reviewsSummary",productSizeChart:"js/mcom/features/product/sizeChart",productSocialIcons:"js/mcom/features/product/socialIcons",productSpecialOffers:"js/mcom/features/product/specialOffers",productTemplates:"templates/mcom/features/product",productMember:"js/mcom/features/product/member",productZoomer:"js/mcom/features/product/zoomer",productZoomerTemplates:"templates/mcom/features/product/zoomer",promoHandler:"js/mcom/components/header/PromoHandler",personalizedWidget:"js/mcom/features/personalizedWidget/PersonalizedWidget",quickBag:"js/mcom/features/quickBag",qvAdapter:"js/mcom/components/quickView/QVAdapter",qvAddToBagModel:"js/mcom/components/quickView/models/QVAddToBag",qvAddToBagView:"js/mcom/components/quickView/views/QVAddToBagView",qvAddToWishlistModel:"js/mcom/components/quickView/models/QVAddToWishlist",qvProductModel:"js/mcom/components/quickView/models/QVProductModel",qvProductView:"js/mcom/components/quickView/views/QVProductView",qvZoomer:"js/mcom/components/quickView/views/QVZoomer",registry:"js/mcom/features/registry/registry",returnsQVAdapter:"js/mcom/features/ordermanagement/ReturnsQVAdapter",returnTracking:"js/mcom/features/ordermanagement/ReturnTracking",richRelevance:"js/mcom/components/thumbCarousel/richRelevance",richRelevanceControllers:"js/mcom/components/thumbCarousel/controller/richRelevance",scarcityWidget:"js/mcom/features/scarcityWidget/ScarcityWidget",search:"js/mcom/features/search/Search",siteMoneyJS:"js/mcom/features/siteMonetization",siteMoneyTemplates:"templates/mcom/features/siteMonetization",splitButton:"js/mcom/components/SplitButton",storeDataCache:"js/mcom/features/bops/storeCache",storeEvent:"js/mcom/features/stores/event/model/StoreEvent",storeEventCollection:"js/mcom/features/stores/event/model/StoreEventCollection",storeOverlay:"js/mcom/features/bops/storeOverlay",storeRouter:"js/mcom/features/stores/StoreRouter",storeView:"js/mcom/features/stores/StoreView",storeHelpers:"js/mcom/features/stores/hbsHelpers/storeHelpers",tabletMenuIcon:"js/mcom/features/header/TabletMenuIcon",tabletSearch:"js/mcom/features/header/TabletSearch",thumbCarousel:"js/mcom/components/thumbCarousel",mcomThumbnailCarousel:"js/mcom/components/thumbCarousel",thumbCarouselControllers:"js/mcom/components/thumbCarousel/controller",thumbCarouselHelpers:"js/mcom/components/thumbCarousel/hbsHelpers/ThumbHelpers",toggleMedia:"js/mcom/components/media/ToggleMedia",prosZSPController:"js/mcom/components/thumbCarousel/controller/ZeroSearchPage",prosATBController:"js/mcom/components/thumbCarousel/controller/AddToBagPage",prosBagController:"js/mcom/components/thumbCarousel/controller/BagRecommendations",prosProductDetailsController:"js/mcom/components/thumbCarousel/controller/ProductDetailsPage",prosOcpController:"js/mcom/components/thumbCarousel/controller/OrderConfirmationPage",prosQVAdapter:"js/mcom/components/quickView/ProsQVAdapter",tracking:"js/mcom/util/tracking",trafficSplitter:"js/mcom/util/TrafficSplitter",walletPageView:"js/mcom/features/account2/wallet/views/WalletPageView",walletPromoHandler:"js/mcom/components/header/WalletPromoHandler",walletStart:"js/mcom/features/account2/wallet/wallet",wishListBase:"js/mcom/features/wishlist",wishListQVAdapter:"js/mcom/components/quickView/WishListQVAdapter",wishListView:"js/mcom/features/wishlist/views/WishListView",zoomer:"js/mcom/components/quickView/zoomer",tierSwatchColor:"js/mcom/components/quickView/TierSwatchColor",tieredSwatchColorHeaderTextView:"js/mcom/components/quickView/views/TieredSwatchColorHeaderTextView",tieredSwatchColorPriceModel:"js/mcom/components/quickView/models/TieredSwatchColorPriceModel",tieredSwatchColorPricesView:"js/mcom/components/quickView/views/TieredSwatchColorPricesView",tieredPricesMasterView:"js/mcom/components/quickView/views/TieredPricesMasterView",topReviewer:"js/mcom/features/topReviewer/TopReviewer",nlsExperimentationUtility:"js/mcom/util/NlsExperimentationUtility",loyalty:"js/mcom/features/loyalty/bag/Loyalty",crossFadedImageSprite:"js/mcom/components/productThumbnail/CrossFadedImageSprite",facetAnalytics:"js/mcom/features/refineByFacet/FacetAnalytics",recentlyViewed:"js/mcom/components/thumbCarousel/recentlyViewed/RecentlyViewedV3",recentlyViewedHelper:"js/mcom/features/leanProduct/common/bottom/recentlyViewed/RecentlyViewedHelper",rviCoremetrics:"js/mcom/components/thumbCarousel/recentlyViewed/RviCoremetrics"};shims={};require.config({shim:shims,paths:paths});require.config({urlArgs:"timenow=2.37.0-SNAPSHOT"});(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this,y=x._,z=Array.prototype,A=Object.prototype,B=Function.prototype,C=z.push,D=z.slice,E=A.toString,F=A.hasOwnProperty,G=Array.isArray,H=Object.keys,I=B.bind,J=Object.create,K=function(){},L=function(a){if(a instanceof L)return a;if(!(this instanceof L))return new L(a);this._wrapped=a};if("undefined"!==typeof exports){if("undefined"!==typeof module&&module.exports)exports=module.exports=L;exports._=L}else x._=L;L.VERSION="1.8.3";a=function(a,b,c){if(b===void 0)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}};b=function(b,c,d){if(null==b)return L.identity;if(L.isFunction(b))return a(b,c,d);if(L.isObject(b))return L.matcher(b);return L.property(b)};L.iteratee=function(a,c){return b(a,c,1/0)};c=function(a,b){return function(c){var d,e,f,g,h,i,j=arguments.length;if(j<2||null==c)return c;for(d=1;d<j;d++){e=arguments[d],f=a(e),g=f.length;for(h=0;h<g;h++){i=f[h];if(!b||c[i]===void 0)c[i]=e[i]}}return c}};d=function(a){if(!L.isObject(a))return{};if(J)return J(a);K.prototype=a;var b=new K;K.prototype=null;return b};e=function(a){return function(b){return null==b?void 0:b[a]}};f=Math.pow(2,53)-1;g=e("length");h=function(a){var b=g(a);return"number"==typeof b&&b>=0&&b<=f};L.each=L.forEach=function(b,c,d){var e,f,g;c=a(c,d);if(h(b))for(e=0,f=b.length;e<f;e++)c(b[e],e,b);else{g=L.keys(b);for(e=0,f=g.length;e<f;e++)c(b[g[e]],g[e],b)}return b};L.map=L.collect=function(a,c,d){var e,f,g,i,j;c=b(c,d);e=!h(a)&&L.keys(a),f=(e||a).length,g=Array(f);for(i=0;i<f;i++){j=e?e[i]:i;g[i]=c(a[j],j,a)}return g};function M(b){function c(a,c,d,e,f,g){for(;f>=0&&f<g;f+=b){var h=e?e[f]:f;d=c(d,a[h],h,a)}return d}return function(d,e,f,g){e=a(e,g,4);var i=!h(d)&&L.keys(d),j=(i||d).length,k=b>0?0:j-1;if(arguments.length<3){f=d[i?i[k]:k];k+=b}return c(d,e,f,i,k,j)}}L.reduce=L.foldl=L.inject=M(1);L.reduceRight=L.foldr=M(-1);L.find=L.detect=function(a,b,c){var d;if(h(a))d=L.findIndex(a,b,c);else d=L.findKey(a,b,c);if(d!==void 0&&d!==-1)return a[d]};L.filter=L.select=function(a,c,d){var e=[];c=b(c,d);L.each(a,function(a,b,d){if(c(a,b,d))e.push(a)});return e};L.reject=function(a,c,d){return L.filter(a,L.negate(b(c)),d)};L.every=L.all=function(a,c,d){var e,f,g,i;c=b(c,d);e=!h(a)&&L.keys(a),f=(e||a).length;for(g=0;g<f;g++){i=e?e[g]:g;if(!c(a[i],i,a))return false}return true};L.some=L.any=function(a,c,d){var e,f,g,i;c=b(c,d);e=!h(a)&&L.keys(a),
f=(e||a).length;for(g=0;g<f;g++){i=e?e[g]:g;if(c(a[i],i,a))return true}return false};L.contains=L.includes=L.include=function(a,b,c,d){if(!h(a))a=L.values(a);if("number"!=typeof c||d)c=0;return L.indexOf(a,b,c)>=0};L.invoke=function(a,b){var c=D.call(arguments,2),d=L.isFunction(b);return L.map(a,function(a){var e=d?b:a[b];return null==e?e:e.apply(a,c)})};L.pluck=function(a,b){return L.map(a,L.property(b))};L.where=function(a,b){return L.filter(a,L.matcher(b))};L.findWhere=function(a,b){return L.find(a,L.matcher(b))};L.max=function(a,c,d){var e,f,g,i,j=-(1/0),k=-(1/0);if(null==c&&null!=a){a=h(a)?a:L.values(a);for(g=0,i=a.length;g<i;g++){e=a[g];if(e>j)j=e}}else{c=b(c,d);L.each(a,function(a,b,d){f=c(a,b,d);if(f>k||f===-(1/0)&&j===-(1/0)){j=a;k=f}})}return j};L.min=function(a,c,d){var e,f,g,i,j=1/0,k=1/0;if(null==c&&null!=a){a=h(a)?a:L.values(a);for(g=0,i=a.length;g<i;g++){e=a[g];if(e<j)j=e}}else{c=b(c,d);L.each(a,function(a,b,d){f=c(a,b,d);if(f<k||f===1/0&&j===1/0){j=a;k=f}})}return j};L.shuffle=function(a){var b,c,d=h(a)?a:L.values(a),e=d.length,f=Array(e);for(b=0;b<e;b++){c=L.random(0,b);if(c!==b)f[b]=f[c];f[c]=d[b]}return f};L.sample=function(a,b,c){if(null==b||c){if(!h(a))a=L.values(a);return a[L.random(a.length-1)]}return L.shuffle(a).slice(0,Math.max(0,b))};L.sortBy=function(a,c,d){c=b(c,d);return L.pluck(L.map(a,function(a,b,d){return{value:a,index:b,criteria:c(a,b,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||c===void 0)return 1;if(c<d||d===void 0)return-1}return a.index-b.index}),"value")};i=function(a){return function(c,d,e){var f={};d=b(d,e);L.each(c,function(b,e){var g=d(b,e,c);a(f,b,g)});return f}};L.groupBy=i(function(a,b,c){if(L.has(a,c))a[c].push(b);else a[c]=[b]});L.indexBy=i(function(a,b,c){a[c]=b});L.countBy=i(function(a,b,c){if(L.has(a,c))a[c]++;else a[c]=1});L.toArray=function(a){if(!a)return[];if(L.isArray(a))return D.call(a);if(h(a))return L.map(a,L.identity);return L.values(a)};L.size=function(a){if(null==a)return 0;return h(a)?a.length:L.keys(a).length};L.partition=function(a,c,d){c=b(c,d);var e=[],f=[];L.each(a,function(a,b,d){(c(a,b,d)?e:f).push(a)});return[e,f]};L.first=L.head=L.take=function(a,b,c){if(null==a)return void 0;if(null==b||c)return a[0];return L.initial(a,a.length-b)};L.initial=function(a,b,c){return D.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))};L.last=function(a,b,c){if(null==a)return void 0;if(null==b||c)return a[a.length-1];return L.rest(a,Math.max(0,a.length-b))};L.rest=L.tail=L.drop=function(a,b,c){return D.call(a,null==b||c?1:b)};L.compact=function(a){return L.filter(a,L.identity)};j=function(a,b,c,d){var e,f,i,k,l,m=[],n=0;for(e=d||0,f=g(a);e<f;e++){i=a[e];if(h(i)&&(L.isArray(i)||L.isArguments(i))){if(!b)i=j(i,b,c);k=0,l=i.length;m.length+=l;while(k<l)m[n++]=i[k++]}else if(!c)m[n++]=i}return m};L.flatten=function(a,b){return j(a,b,false)};L.without=function(a){return L.difference(a,D.call(arguments,1))};L.uniq=L.unique=function(a,c,d,e){var f,h,i,j,k,l;if(!L.isBoolean(c)){e=d;d=c;c=false}if(null!=d)d=b(d,e);f=[];h=[];for(i=0,j=g(a);i<j;i++){k=a[i],l=d?d(k,i,a):k;if(c){if(!i||h!==l)f.push(k);h=l}else if(d){if(!L.contains(h,l)){h.push(l);f.push(k)}}else if(!L.contains(f,k))f.push(k)}return f};L.union=function(){return L.uniq(j(arguments,true,true))};L.intersection=function(a){var b,c,d,e,f=[],h=arguments.length;for(b=0,c=g(a);b<c;b++){d=a[b];if(L.contains(f,d))continue;for(e=1;e<h;e++)if(!L.contains(arguments[e],d))break;if(e===h)f.push(d)}return f};L.difference=function(a){var b=j(arguments,true,true,1);return L.filter(a,function(a){return!L.contains(b,a)})};L.zip=function(){return L.unzip(arguments)};L.unzip=function(a){var b,c=a&&L.max(a,g).length||0,d=Array(c);for(b=0;b<c;b++)d[b]=L.pluck(a,b);return d};L.object=function(a,b){var c,d,e={};for(c=0,d=g(a);c<d;c++)if(b)e[a[c]]=b[c];else e[a[c][0]]=a[c][1];return e};function N(a){return function(c,d,e){var f,h;d=b(d,e);f=g(c);h=a>0?0:f-1;for(;h>=0&&h<f;h+=a)if(d(c[h],h,c))return h;return-1}}L.findIndex=N(1);L.findLastIndex=N(-1);L.sortedIndex=function(a,c,d,e){var f,h,i,j;d=b(d,e,1);f=d(c);h=0,i=g(a);while(h<i){j=Math.floor((h+i)/2);if(d(a[j])<f)h=j+1;else i=j}return h};function O(a,b,c){return function(d,e,f){var h=0,i=g(d);if("number"==typeof f)if(a>0)h=f>=0?f:Math.max(f+i,h);else i=f>=0?Math.min(f+1,i):f+i+1;else if(c&&f&&i){f=c(d,e);return d[f]===e?f:-1}if(e!==e){f=b(D.call(d,h,i),L.isNaN);return f>=0?f+h:-1}for(f=a>0?h:i-1;f>=0&&f<i;f+=a)if(d[f]===e)return f;return-1}}L.indexOf=O(1,L.findIndex,L.sortedIndex);L.lastIndexOf=O(-1,L.findLastIndex);L.range=function(a,b,c){var d,e,f;if(null==b){b=a||0;a=0}c=c||1;d=Math.max(Math.ceil((b-a)/c),0);e=Array(d);for(f=0;f<d;f++,a+=c)e[f]=a;return e};k=function(a,b,c,e,f){var g,h;if(!(e instanceof b))return a.apply(c,f);g=d(a.prototype);h=a.apply(g,f);if(L.isObject(h))return h;return g};L.bind=function(a,b){var c,d;if(I&&a.bind===I)return I.apply(a,D.call(arguments,1));if(!L.isFunction(a))throw new TypeError("Bind must be called on a function");c=D.call(arguments,2);d=function(){return k(a,d,b,this,c.concat(D.call(arguments)))};return d};L.partial=function(a){var b=D.call(arguments,1),c=function(){var d,e=0,f=b.length,g=Array(f);for(d=0;d<f;d++)g[d]=b[d]===L?arguments[e++]:b[d];while(e<arguments.length)g.push(arguments[e++]);return k(a,c,this,this,g)};return c};L.bindAll=function(a){var b,c=arguments.length,d;if(c<=1)throw new Error("bindAll must be passed function names");for(b=1;b<c;b++){d=arguments[b];a[d]=L.bind(a[d],a)}return a};L.memoize=function(a,b){var c=function(d){var e=c.cache,f=""+(b?b.apply(this,arguments):d);if(!L.has(e,f))e[f]=a.apply(this,arguments);return e[f]};c.cache={};return c};L.delay=function(a,b){var c=D.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};L.defer=L.partial(L.delay,L,1);L.throttle=function(a,b,c){var d,e,f,g,h=null,i=0;if(!c)c={};g=function(){i=false===c.leading?0:L.now();h=null;f=a.apply(d,e);if(!h)d=e=null};return function(){var j,k=L.now();if(!i&&false===c.leading)i=k;j=b-(k-i);d=this;e=arguments;if(j<=0||j>b){if(h){clearTimeout(h);h=null}i=k;f=a.apply(d,e);if(!h)d=e=null}else if(!h&&false!==c.trailing)h=setTimeout(g,j);return f}};L.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=L.now()-g;if(j<b&&j>=0)d=setTimeout(i,b-j);else{d=null;if(!c){h=a.apply(f,e);if(!d)f=e=null}}};return function(){f=this;e=arguments;g=L.now();var j=c&&!d;if(!d)d=setTimeout(i,b);if(j){h=a.apply(f,e);f=e=null}return h}};L.wrap=function(a,b){return L.partial(b,a)};L.negate=function(a){return function(){return!a.apply(this,arguments)}};L.compose=function(){var a=arguments,b=a.length-1;return function(){var c=b,d=a[b].apply(this,arguments);while(c--)d=a[c].call(this,d);return d}};L.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}};L.before=function(a,b){var c;return function(){if(--a>0)c=b.apply(this,arguments);if(a<=1)b=null;return c}};L.once=L.partial(L.before,2);l=!{toString:null}.propertyIsEnumerable("toString");m=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function P(a,b){var c=m.length,d=a.constructor,e=L.isFunction(d)&&d.prototype||A,f="constructor";if(L.has(a,f)&&!L.contains(b,f))b.push(f);while(c--){f=m[c];if(f in a&&a[f]!==e[f]&&!L.contains(b,f))b.push(f)}}L.keys=function(a){var b,c;if(!L.isObject(a))return[];if(H)return H(a);b=[];for(c in a)if(L.has(a,c))b.push(c);if(l)P(a,b);return b};L.allKeys=function(a){var b,c;if(!L.isObject(a))return[];b=[];for(c in a)b.push(c);if(l)P(a,b);return b};L.values=function(a){var b,c=L.keys(a),d=c.length,e=Array(d);for(b=0;b<d;b++)e[b]=a[c[b]];return e};L.mapObject=function(a,c,d){var e,f,g,h,i;c=b(c,d);e=L.keys(a),f=e.length,g={};for(i=0;i<f;i++){h=e[i];g[h]=c(a[h],h,a)}return g};L.pairs=function(a){var b,c=L.keys(a),d=c.length,e=Array(d);for(b=0;b<d;b++)e[b]=[c[b],a[c[b]]];return e};L.invert=function(a){var b,c,d={},e=L.keys(a);for(b=0,c=e.length;b<c;b++)d[a[e[b]]]=e[b];return d};L.functions=L.methods=function(a){var b,c=[];for(b in a)if(L.isFunction(a[b]))c.push(b);return c.sort()};L.extend=c(L.allKeys);L.extendOwn=L.assign=c(L.keys);L.findKey=function(a,c,d){var e,f,g,h;c=b(c,d);e=L.keys(a);for(g=0,h=e.length;g<h;g++){f=e[g];if(c(a[f],f,a))return f}};L.pick=function(b,c,d){var e,f,g,h,i,k,l={},m=b;if(null==m)return l;if(L.isFunction(c)){f=L.allKeys(m);e=a(c,d)}else{f=j(arguments,false,false,1);e=function(a,b,c){return b in c};m=Object(m)}for(g=0,h=f.length;g<h;g++){i=f[g];k=m[i];if(e(k,i,m))l[i]=k}return l};L.omit=function(a,b,c){if(L.isFunction(b))b=L.negate(b);else{var d=L.map(j(arguments,false,false,1),String);b=function(a,b){return!L.contains(d,b)}}return L.pick(a,b,c)};L.defaults=c(L.allKeys,true);L.create=function(a,b){var c=d(a);if(b)L.extendOwn(c,b);return c};L.clone=function(a){if(!L.isObject(a))return a;return L.isArray(a)?a.slice():L.extend({},a)};L.tap=function(a,b){b(a);return a};L.isMatch=function(a,b){var c,d,e,f=L.keys(b),g=f.length;if(null==a)return!g;c=Object(a);for(d=0;d<g;d++){e=f[d];if(b[e]!==c[e]||!(e in c))return false}return true};n=function(a,b,c,d){var e,f,g,h,i,j,k;if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;if(a instanceof L)a=a._wrapped;if(b instanceof L)b=b._wrapped;e=E.call(a);if(e!==E.call(b))return false;switch(e){case"[object RegExp]":case"[object String]":return""+a===""+b;case"[object Number]":if(+a!==+a)return+b!==+b;return 0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}f="[object Array]"===e;if(!f){if("object"!=typeof a||"object"!=typeof b)return false;g=a.constructor,h=b.constructor;if(g!==h&&!(L.isFunction(g)&&g instanceof g&&L.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return false}c=c||[];d=d||[];i=c.length;while(i--)if(c[i]===a)return d[i]===b;c.push(a);d.push(b);if(f){i=a.length;if(i!==b.length)return false;while(i--)if(!n(a[i],b[i],c,d))return false}else{j=L.keys(a);i=j.length;if(L.keys(b).length!==i)return false;while(i--){k=j[i];if(!(L.has(b,k)&&n(a[k],b[k],c,d)))return false;
}}c.pop();d.pop();return true};L.isEqual=function(a,b){return n(a,b)};L.isEmpty=function(a){if(null==a)return true;if(h(a)&&(L.isArray(a)||L.isString(a)||L.isArguments(a)))return 0===a.length;return 0===L.keys(a).length};L.isElement=function(a){return!!(a&&1===a.nodeType)};L.isArray=G||function(a){return"[object Array]"===E.call(a)};L.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a};L.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(a){L["is"+a]=function(b){return E.call(b)==="[object "+a+"]"}});if(!L.isArguments(arguments))L.isArguments=function(a){return L.has(a,"callee")};if("function"!=typeof/./&&"object"!=typeof Int8Array)L.isFunction=function(a){return"function"==typeof a||false};L.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};L.isNaN=function(a){return L.isNumber(a)&&a!==+a};L.isBoolean=function(a){return true===a||false===a||"[object Boolean]"===E.call(a)};L.isNull=function(a){return null===a};L.isUndefined=function(a){return a===void 0};L.has=function(a,b){return null!=a&&F.call(a,b)};L.noConflict=function(){x._=y;return this};L.identity=function(a){return a};L.constant=function(a){return function(){return a}};L.noop=function(){};L.property=e;L.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}};L.matcher=L.matches=function(a){a=L.extendOwn({},a);return function(b){return L.isMatch(b,a)}};L.times=function(b,c,d){var e,f=Array(Math.max(0,b));c=a(c,d,1);for(e=0;e<b;e++)f[e]=c(e);return f};L.random=function(a,b){if(null==b){b=a;a=0}return a+Math.floor(Math.random()*(b-a+1))};L.now=Date.now||function(){return(new Date).getTime()};o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};p=L.invert(o);q=function(a){var b=function(b){return a[b]},c="(?:"+L.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){a=null==a?"":""+a;return d.test(a)?a.replace(e,b):a}};L.escape=q(o);L.unescape=q(p);L.result=function(a,b,c){var d=null==a?void 0:a[b];if(d===void 0)d=c;return L.isFunction(d)?d.call(a):d};r=0;L.uniqueId=function(a){var b=++r+"";return a?a+b:b};L.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};s=/(.)^/;t={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};u=/\\|'|\r|\n|\u2028|\u2029/g;v=function(a){return"\\"+t[a]};L.template=function(a,b,c){var d,e,f,g,h,i;if(!b&&c)b=c;b=L.defaults({},b,L.templateSettings);d=RegExp([(b.escape||s).source,(b.interpolate||s).source,(b.evaluate||s).source].join("|")+"|$","g");e=0;f="__p+='";a.replace(d,function(b,c,d,g,h){f+=a.slice(e,h).replace(u,v);e=h+b.length;if(c)f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'";else if(d)f+="'+\n((__t=("+d+"))==null?'':__t)+\n'";else if(g)f+="';\n"+g+"\n__p+='";return b});f+="';\n";if(!b.variable)f="with(obj||{}){\n"+f+"}\n";f="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{g=new Function(b.variable||"obj","_",f)}catch(j){j.source=f;throw j}h=function(a){return g.call(this,a,L)};i=b.variable||"obj";h.source="function("+i+"){\n"+f+"}";return h};L.chain=function(a){var b=L(a);b._chain=true;return b};w=function(a,b){return a._chain?L(b).chain():b};L.mixin=function(a){L.each(L.functions(a),function(b){var c=L[b]=a[b];L.prototype[b]=function(){var a=[this._wrapped];C.apply(a,arguments);return w(this,c.apply(L,a))}})};L.mixin(L);L.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=z[a];L.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);if(("shift"===a||"splice"===a)&&0===c.length)delete c[0];return w(this,c)}});L.each(["concat","join","slice"],function(a){var b=z[a];L.prototype[a]=function(){return w(this,b.apply(this._wrapped,arguments))}});L.prototype.value=function(){return this._wrapped};L.prototype.valueOf=L.prototype.toJSON=L.prototype.value;L.prototype.toString=function(){return""+this._wrapped};if("function"===typeof define&&define.amd)define("underscore",[],function(){return L})}).call(this);!function(a){var b,c,d="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;if("function"===typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(b,c,e){d.Backbone=a(d,e,b,c)});else if("undefined"!==typeof exports){b=require("underscore");try{c=require("jquery")}catch(e){}a(d,exports,b,c)}else d.Backbone=a(d,{},d._,d.jQuery||d.Zepto||d.ender||d.$)}(function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=a.Backbone,P=Array.prototype.slice;b.VERSION="1.2.3";b.$=d;b.noConflict=function(){a.Backbone=O;return this};b.emulateHTTP=false;b.emulateJSON=false;e=function(a,b,d){switch(a){case 1:return function(){return c[b](this[d])};case 2:return function(a){return c[b](this[d],a)};case 3:return function(a,e){return c[b](this[d],g(a,this),e)};case 4:return function(a,e,f){return c[b](this[d],g(a,this),e,f)};default:return function(){var a=P.call(arguments);a.unshift(this[d]);return c[b].apply(c,a)}}};f=function(a,b,d){c.each(b,function(b,f){if(c[f])a.prototype[f]=e(b,f,d)})};g=function(a,b){if(c.isFunction(a))return a;if(c.isObject(a)&&!b._isModel(a))return h(a);if(c.isString(a))return function(b){return b.get(a)};return a};h=function(a){var b=c.matches(a);return function(a){return b(a.attributes)}};i=b.Events={};j=/\s+/;k=function(a,b,d,e,f){var g=0,h;if(d&&"object"===typeof d){if(e!==void 0&&"context"in f&&f.context===void 0)f.context=e;for(h=c.keys(d);g<h.length;g++)b=k(a,b,h[g],d[h[g]],f)}else if(d&&j.test(d))for(h=d.split(j);g<h.length;g++)b=a(b,h[g],e,f);else b=a(b,d,e,f);return b};i.on=function(a,b,c){return l(this,a,b,c)};l=function(a,b,c,d,e){a._events=k(m,a._events||{},b,c,{context:d,ctx:a,listening:e});if(e){var f=a._listeners||(a._listeners={});f[e.id]=e}return a};i.listenTo=function(a,b,d){var e,f,g,h;if(!a)return this;e=a._listenId||(a._listenId=c.uniqueId("l"));f=this._listeningTo||(this._listeningTo={});g=f[e];if(!g){h=this._listenId||(this._listenId=c.uniqueId("l"));g=f[e]={obj:a,objId:e,id:h,listeningTo:f,count:0}}l(a,b,d,this,g);return this};m=function(a,b,c,d){var e,f,g,h;if(c){e=a[b]||(a[b]=[]);f=d.context,g=d.ctx,h=d.listening;if(h)h.count++;e.push({callback:c,context:f,ctx:f||g,listening:h})}return a};i.off=function(a,b,c){if(!this._events)return this;this._events=k(n,this._events,a,b,{context:c,listeners:this._listeners});return this};i.stopListening=function(a,b,d){var e,f,g,h=this._listeningTo;if(!h)return this;e=a?[a._listenId]:c.keys(h);for(f=0;f<e.length;f++){g=h[e[f]];if(!g)break;g.obj.off(b,d,this)}if(c.isEmpty(h))this._listeningTo=void 0;return this};n=function(a,b,d,e){var f,g,h,i,j,k,l,m,n,o;if(!a)return;f=0;h=e.context,i=e.listeners;if(!b&&!d&&!h){j=c.keys(i);for(;f<j.length;f++){g=i[j[f]];delete i[g.id];delete g.listeningTo[g.objId]}return}k=b?[b]:c.keys(a);for(;f<k.length;f++){b=k[f];l=a[b];if(!l)break;m=[];for(n=0;n<l.length;n++){o=l[n];if(d&&d!==o.callback&&d!==o.callback._callback||h&&h!==o.context)m.push(o);else{g=o.listening;if(g&&0===--g.count){delete i[g.id];delete g.listeningTo[g.objId]}}}if(m.length)a[b]=m;else delete a[b]}if(c.size(a))return a};i.once=function(a,b,d){var e=k(o,{},a,b,c.bind(this.off,this));return this.on(e,void 0,d)};i.listenToOnce=function(a,b,d){var e=k(o,{},b,d,c.bind(this.stopListening,this,a));return this.listenTo(a,e)};o=function(a,b,d,e){if(d){var f=a[b]=c.once(function(){e(b,f);d.apply(this,arguments)});f._callback=d}return a};i.trigger=function(a){var b,c,d;if(!this._events)return this;b=Math.max(0,arguments.length-1);c=Array(b);for(d=0;d<b;d++)c[d]=arguments[d+1];k(p,this._events,a,void 0,c);return this};p=function(a,b,c,d){var e,f;if(a){e=a[b];f=a.all;if(e&&f)f=f.slice();if(e)q(e,d);if(f)q(f,[b].concat(d))}return a};q=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:while(++d<e)(c=a[d]).callback.call(c.ctx);return;case 1:while(++d<e)(c=a[d]).callback.call(c.ctx,f);return;case 2:while(++d<e)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:while(++d<e)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:while(++d<e)(c=a[d]).callback.apply(c.ctx,b);return}};i.bind=i.on;i.unbind=i.off;c.extend(b,i);r=b.Model=function(a,b){var d=a||{};b||(b={});this.cid=c.uniqueId(this.cidPrefix);this.attributes={};if(b.collection)this.collection=b.collection;if(b.parse)d=this.parse(d,b)||{};d=c.defaults({},d,c.result(this,"defaults"));this.set(d,b);this.changed={};this.initialize.apply(this,arguments)};c.extend(r.prototype,i,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(a){return c.clone(this.attributes)},sync:function(){return b.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return c.escape(this.get(a))},has:function(a){return null!=this.get(a)},matches:function(a){return!!c.iteratee(a,this)(this.attributes)},set:function(a,b,d){var e,f,g,h,i,j,k,l,m,n;if(null==a)return this;if("object"===typeof a){e=a;d=b}else(e={})[a]=b;d||(d={});if(!this._validate(e,d))return false;f=d.unset;g=d.silent;h=[];i=this._changing;this._changing=true;if(!i){this._previousAttributes=c.clone(this.attributes);this.changed={}}j=this.attributes;k=this.changed;l=this._previousAttributes;for(m in e){b=e[m];if(!c.isEqual(j[m],b))h.push(m);if(!c.isEqual(l[m],b))k[m]=b;else delete k[m];f?delete j[m]:j[m]=b}this.id=this.get(this.idAttribute);if(!g){if(h.length)this._pending=d;for(n=0;n<h.length;n++)this.trigger("change:"+h[n],this,j[h[n]],d)}if(i)return this;if(!g)while(this._pending){d=this._pending;this._pending=false;this.trigger("change",this,d)}this._pending=false;this._changing=false;return this},unset:function(a,b){return this.set(a,void 0,c.extend({},b,{unset:true}))},clear:function(a){var b,d={};for(b in this.attributes)d[b]=void 0;return this.set(d,c.extend({},a,{unset:true}))},hasChanged:function(a){if(null==a)return!c.isEmpty(this.changed);return c.has(this.changed,a);
},changedAttributes:function(a){var b,d,e,f;if(!a)return this.hasChanged()?c.clone(this.changed):false;b=this._changing?this._previousAttributes:this.attributes;d={};for(e in a){f=a[e];if(c.isEqual(b[e],f))continue;d[e]=f}return c.size(d)?d:false},previous:function(a){if(null==a||!this._previousAttributes)return null;return this._previousAttributes[a]},previousAttributes:function(){return c.clone(this._previousAttributes)},fetch:function(a){var b,d;a=c.extend({parse:true},a);b=this;d=a.success;a.success=function(c){var e=a.parse?b.parse(c,a):c;if(!b.set(e,a))return false;if(d)d.call(a.context,b,c,a);b.trigger("sync",b,c,a)};N(this,a);return this.sync("read",this,a)},save:function(a,b,d){var e,f,g,h,i,j,k;if(null==a||"object"===typeof a){e=a;d=b}else(e={})[a]=b;d=c.extend({validate:true,parse:true},d);f=d.wait;if(e&&!f){if(!this.set(e,d))return false}else if(!this._validate(e,d))return false;g=this;h=d.success;i=this.attributes;d.success=function(a){g.attributes=i;var b=d.parse?g.parse(a,d):a;if(f)b=c.extend({},e,b);if(b&&!g.set(b,d))return false;if(h)h.call(d.context,g,a,d);g.trigger("sync",g,a,d)};N(this,d);if(e&&f)this.attributes=c.extend({},i,e);j=this.isNew()?"create":d.patch?"patch":"update";if("patch"===j&&!d.attrs)d.attrs=e;k=this.sync(j,this,d);this.attributes=i;return k},destroy:function(a){var b,d,e,f,g;a=a?c.clone(a):{};b=this;d=a.success;e=a.wait;f=function(){b.stopListening();b.trigger("destroy",b,b.collection,a)};a.success=function(c){if(e)f();if(d)d.call(a.context,b,c,a);if(!b.isNew())b.trigger("sync",b,c,a)};g=false;if(this.isNew())c.defer(a.success);else{N(this,a);g=this.sync("delete",this,a)}if(!e)f();return g},url:function(){var a,b=c.result(this,"urlRoot")||c.result(this.collection,"url")||M();if(this.isNew())return b;a=this.get(this.idAttribute);return b.replace(/[^\/]$/,"$&/")+encodeURIComponent(a)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},c.defaults({validate:true},a))},_validate:function(a,b){if(!b.validate||!this.validate)return true;a=c.extend({},this.attributes,a);var d=this.validationError=this.validate(a,b)||null;if(!d)return true;this.trigger("invalid",this,d,c.extend(b,{validationError:d}));return false}});s={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};f(r,s,"attributes");t=b.Collection=function(a,b){b||(b={});if(b.model)this.model=b.model;if(b.comparator!==void 0)this.comparator=b.comparator;this._reset();this.initialize.apply(this,arguments);if(a)this.reset(a,c.extend({silent:true},b))};u={add:true,remove:true,merge:true};v={add:true,remove:false};w=function(a,b,c){var d,e,f;c=Math.min(Math.max(c,0),a.length);d=Array(a.length-c);e=b.length;for(f=0;f<d.length;f++)d[f]=a[f+c];for(f=0;f<e;f++)a[f+c]=b[f];for(f=0;f<d.length;f++)a[f+e+c]=d[f]};c.extend(t.prototype,i,{model:r,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return b.sync.apply(this,arguments)},add:function(a,b){return this.set(a,c.extend({merge:false},b,v))},remove:function(a,b){var d,e;b=c.extend({},b);d=!c.isArray(a);a=d?[a]:c.clone(a);e=this._removeModels(a,b);if(!b.silent&&e)this.trigger("update",this,b);return d?e[0]:e},set:function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,v;if(null==a)return;b=c.defaults({},b,u);if(b.parse&&!this._isModel(a))a=this.parse(a,b);d=!c.isArray(a);a=d?[a]:a.slice();e=b.at;if(null!=e)e=+e;if(e<0)e+=this.length+1;f=[];g=[];h=[];i={};j=b.add;k=b.merge;l=b.remove;m=false;n=this.comparator&&null==e&&false!==b.sort;o=c.isString(this.comparator)?this.comparator:null;for(q=0;q<a.length;q++){p=a[q];r=this.get(p);if(r){if(k&&p!==r){s=this._isModel(p)?p.attributes:p;if(b.parse)s=r.parse(s,b);r.set(s,b);if(n&&!m)m=r.hasChanged(o)}if(!i[r.cid]){i[r.cid]=true;f.push(r)}a[q]=r}else if(j){p=a[q]=this._prepareModel(p,b);if(p){g.push(p);this._addReference(p,b);i[p.cid]=true;f.push(p)}}}if(l){for(q=0;q<this.length;q++){p=this.models[q];if(!i[p.cid])h.push(p)}if(h.length)this._removeModels(h,b)}t=false;v=!n&&j&&l;if(f.length&&v){t=this.length!=f.length||c.some(this.models,function(a,b){return a!==f[b]});this.models.length=0;w(this.models,f,0);this.length=this.models.length}else if(g.length){if(n)m=true;w(this.models,g,null==e?this.length:e);this.length=this.models.length}if(m)this.sort({silent:true});if(!b.silent){for(q=0;q<g.length;q++){if(null!=e)b.index=e+q;p=g[q];p.trigger("add",p,this,b)}if(m||t)this.trigger("sort",this,b);if(g.length||h.length)this.trigger("update",this,b)}return d?a[0]:a},reset:function(a,b){b=b?c.clone(b):{};for(var d=0;d<this.models.length;d++)this._removeReference(this.models[d],b);b.previousModels=this.models;this._reset();a=this.add(a,c.extend({silent:true},b));if(!b.silent)this.trigger("reset",this,b);return a},push:function(a,b){return this.add(a,c.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a)},unshift:function(a,b){return this.add(a,c.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a)},slice:function(){return P.apply(this.models,arguments)},get:function(a){if(null==a)return void 0;var b=this.modelId(this._isModel(a)?a.attributes:a);return this._byId[a]||this._byId[b]||this._byId[a.cid]},at:function(a){if(a<0)a+=this.length;return this.models[a]},where:function(a,b){return this[b?"find":"filter"](a)},findWhere:function(a){return this.where(a,true)},sort:function(a){var b,d=this.comparator;if(!d)throw new Error("Cannot sort a set without a comparator");a||(a={});b=d.length;if(c.isFunction(d))d=c.bind(d,this);if(1===b||c.isString(d))this.models=this.sortBy(d);else this.models.sort(d);if(!a.silent)this.trigger("sort",this,a);return this},pluck:function(a){return c.invoke(this.models,"get",a)},fetch:function(a){var b,d;a=c.extend({parse:true},a);b=a.success;d=this;a.success=function(c){var e=a.reset?"reset":"set";d[e](c,a);if(b)b.call(a.context,d,c,a);d.trigger("sync",d,c,a)};N(this,a);return this.sync("read",this,a)},create:function(a,b){var d,e,f;b=b?c.clone(b):{};d=b.wait;a=this._prepareModel(a,b);if(!a)return false;if(!d)this.add(a,b);e=this;f=b.success;b.success=function(a,b,c){if(d)e.add(a,c);if(f)f.call(c.context,a,b,c)};a.save(null,b);return a},parse:function(a,b){return a},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(a){return a[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(a,b){if(this._isModel(a)){if(!a.collection)a.collection=this;return a}b=b?c.clone(b):{};b.collection=this;var d=new this.model(a,b);if(!d.validationError)return d;this.trigger("invalid",this,d.validationError,b);return false},_removeModels:function(a,b){var c,d,e,f=[];for(c=0;c<a.length;c++){d=this.get(a[c]);if(!d)continue;e=this.indexOf(d);this.models.splice(e,1);this.length--;if(!b.silent){b.index=e;d.trigger("remove",d,this,b)}f.push(d);this._removeReference(d,b)}return f.length?f:false},_isModel:function(a){return a instanceof r},_addReference:function(a,b){this._byId[a.cid]=a;var c=this.modelId(a.attributes);if(null!=c)this._byId[c]=a;a.on("all",this._onModelEvent,this)},_removeReference:function(a,b){delete this._byId[a.cid];var c=this.modelId(a.attributes);if(null!=c)delete this._byId[c];if(this===a.collection)delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){var e,f;if(("add"===a||"remove"===a)&&c!==this)return;if("destroy"===a)this.remove(b,d);if("change"===a){e=this.modelId(b.previousAttributes());f=this.modelId(b.attributes);if(e!==f){if(null!=e)delete this._byId[e];if(null!=f)this._byId[f]=b}}this.trigger.apply(this,arguments)}});x={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3};f(t,x,"models");y=b.View=function(a){this.cid=c.uniqueId("view");c.extend(this,c.pick(a,A));this._ensureElement();this.initialize.apply(this,arguments)};z=/^(\S+)\s*(.*)$/;A=["model","collection","el","id","attributes","className","tagName","events"];c.extend(y.prototype,i,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this._removeElement();this.stopListening();return this},_removeElement:function(){this.$el.remove()},setElement:function(a){this.undelegateEvents();this._setElement(a);this.delegateEvents();return this},_setElement:function(a){this.$el=a instanceof b.$?a:b.$(a);this.el=this.$el[0]},delegateEvents:function(a){var b,d,e;a||(a=c.result(this,"events"));if(!a)return this;this.undelegateEvents();for(b in a){d=a[b];if(!c.isFunction(d))d=this[d];if(!d)continue;e=b.match(z);this.delegate(e[1],e[2],c.bind(d,this))}return this},delegate:function(a,b,c){this.$el.on(a+".delegateEvents"+this.cid,b,c);return this},undelegateEvents:function(){if(this.$el)this.$el.off(".delegateEvents"+this.cid);return this},undelegate:function(a,b,c){this.$el.off(a+".delegateEvents"+this.cid,b,c);return this},_createElement:function(a){return document.createElement(a)},_ensureElement:function(){if(!this.el){var a=c.extend({},c.result(this,"attributes"));if(this.id)a.id=c.result(this,"id");if(this.className)a["class"]=c.result(this,"className");this.setElement(this._createElement(c.result(this,"tagName")));this._setAttributes(a)}else this.setElement(c.result(this,"el"))},_setAttributes:function(a){this.$el.attr(a)}});b.sync=function(a,d,e){var f,g,h,i,j=B[a];c.defaults(e||(e={}),{emulateHTTP:b.emulateHTTP,emulateJSON:b.emulateJSON});f={type:j,dataType:"json"};if(!e.url)f.url=c.result(d,"url")||M();
if(null==e.data&&d&&("create"===a||"update"===a||"patch"===a)){f.contentType="application/json";f.data=JSON.stringify(e.attrs||d.toJSON(e))}if(e.emulateJSON){f.contentType="application/x-www-form-urlencoded";f.data=f.data?{model:f.data}:{}}if(e.emulateHTTP&&("PUT"===j||"DELETE"===j||"PATCH"===j)){f.type="POST";if(e.emulateJSON)f.data._method=j;g=e.beforeSend;e.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",j);if(g)return g.apply(this,arguments)}}if("GET"!==f.type&&!e.emulateJSON)f.processData=false;h=e.error;e.error=function(a,b,c){e.textStatus=b;e.errorThrown=c;if(h)h.call(e.context,a,b,c)};i=e.xhr=b.ajax(c.extend(f,e));d.trigger("request",d,i,e);return i};B={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};b.ajax=function(){return b.$.ajax.apply(b.$,arguments)};C=b.Router=function(a){a||(a={});if(a.routes)this.routes=a.routes;this._bindRoutes();this.initialize.apply(this,arguments)};D=/\((.*?)\)/g;E=/(\(\?)?:\w+/g;F=/\*\w+/g;G=/[\-{}\[\]+?.,\\\^$|#\s]/g;c.extend(C.prototype,i,{initialize:function(){},route:function(a,d,e){if(!c.isRegExp(a))a=this._routeToRegExp(a);if(c.isFunction(d)){e=d;d=""}if(!e)e=this[d];var f=this;b.history.route(a,function(c){var g=f._extractParameters(a,c);if(false!==f.execute(e,g,d)){f.trigger.apply(f,["route:"+d].concat(g));f.trigger("route",d,g);b.history.trigger("route",f,d,g)}});return this},execute:function(a,b,c){if(a)a.apply(this,b)},navigate:function(a,c){b.history.navigate(a,c);return this},_bindRoutes:function(){if(!this.routes)return;this.routes=c.result(this,"routes");var a,b=c.keys(this.routes);while(null!=(a=b.pop()))this.route(a,this.routes[a])},_routeToRegExp:function(a){a=a.replace(G,"\\$&").replace(D,"(?:$1)?").replace(E,function(a,b){return b?a:"([^/?]+)"}).replace(F,"([^?]*?)");return new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,b){var d=a.exec(b).slice(1);return c.map(d,function(a,b){if(b===d.length-1)return a||null;return a?decodeURIComponent(a):null})}});H=b.History=function(){this.handlers=[];this.checkUrl=c.bind(this.checkUrl,this);if("undefined"!==typeof window){this.location=window.location;this.history=window.history}};I=/^[#\/]|\s+$/g;J=/^\/+|\/+$/g;K=/#.*$/;H.started=false;c.extend(H.prototype,i,{interval:50,atRoot:function(){var a=this.location.pathname.replace(/[^\/]$/,"$&/");return a===this.root&&!this.getSearch()},matchRoot:function(){var a=this.decodeFragment(this.location.pathname),b=a.slice(0,this.root.length-1)+"/";return b===this.root},decodeFragment:function(a){return decodeURI(a.replace(/%25/g,"%2525"))},getSearch:function(){var a=this.location.href.replace(/#.*/,"").match(/\?.+/);return a?a[0]:""},getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getPath:function(){var a=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===a.charAt(0)?a.slice(1):a},getFragment:function(a){if(null==a)if(this._usePushState||!this._wantsHashChange)a=this.getPath();else a=this.getHash();return a.replace(I,"")},start:function(a){var b,d,e,f;if(H.started)throw new Error("Backbone.history has already been started");H.started=true;this.options=c.extend({root:"/"},this.options,a);this.root=this.options.root;this._wantsHashChange=false!==this.options.hashChange;this._hasHashChange="onhashchange"in window&&(document.documentMode===void 0||document.documentMode>7);this._useHashChange=this._wantsHashChange&&this._hasHashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.history&&this.history.pushState);this._usePushState=this._wantsPushState&&this._hasPushState;this.fragment=this.getFragment();this.root=("/"+this.root+"/").replace(J,"/");if(this._wantsHashChange&&this._wantsPushState)if(!this._hasPushState&&!this.atRoot()){b=this.root.slice(0,-1)||"/";this.location.replace(b+"#"+this.getPath());return true}else if(this._hasPushState&&this.atRoot())this.navigate(this.getHash(),{replace:true});if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe");this.iframe.src="javascript:0";this.iframe.style.display="none";this.iframe.tabIndex=-1;d=document.body;e=d.insertBefore(this.iframe,d.firstChild).contentWindow;e.document.open();e.document.close();e.location.hash="#"+this.fragment}f=window.addEventListener||function(a,b){return attachEvent("on"+a,b)};if(this._usePushState)f("popstate",this.checkUrl,false);else if(this._useHashChange&&!this.iframe)f("hashchange",this.checkUrl,false);else if(this._wantsHashChange)this._checkUrlInterval=setInterval(this.checkUrl,this.interval);if(!this.options.silent)return this.loadUrl()},stop:function(){var a=window.removeEventListener||function(a,b){return detachEvent("on"+a,b)};if(this._usePushState)a("popstate",this.checkUrl,false);else if(this._useHashChange&&!this.iframe)a("hashchange",this.checkUrl,false);if(this.iframe){document.body.removeChild(this.iframe);this.iframe=null}if(this._checkUrlInterval)clearInterval(this._checkUrlInterval);H.started=false},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();if(b===this.fragment&&this.iframe)b=this.getHash(this.iframe.contentWindow);if(b===this.fragment)return false;if(this.iframe)this.navigate(b);this.loadUrl()},loadUrl:function(a){if(!this.matchRoot())return false;a=this.fragment=this.getFragment(a);return c.some(this.handlers,function(b){if(b.route.test(a)){b.callback(a);return true}})},navigate:function(a,b){var c,d,e;if(!H.started)return false;if(!b||true===b)b={trigger:!!b};a=this.getFragment(a||"");c=this.root;if(""===a||"?"===a.charAt(0))c=c.slice(0,-1)||"/";d=c+a;a=this.decodeFragment(a.replace(K,""));if(this.fragment===a)return;this.fragment=a;if(this._usePushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,d);else if(this._wantsHashChange){this._updateHash(this.location,a,b.replace);if(this.iframe&&a!==this.getHash(this.iframe.contentWindow)){e=this.iframe.contentWindow;if(!b.replace){e.document.open();e.document.close()}this._updateHash(e.location,a,b.replace)}}else return this.location.assign(d);if(b.trigger)return this.loadUrl(a)},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}});b.history=new H;L=function(a,b){var d,e,f=this;if(a&&c.has(a,"constructor"))d=a.constructor;else d=function(){return f.apply(this,arguments)};c.extend(d,f,b);e=function(){this.constructor=d};e.prototype=f.prototype;d.prototype=new e;if(a)c.extend(d.prototype,a);d.__super__=f.prototype;return d};r.extend=t.extend=C.extend=y.extend=H.extend=L;M=function(){throw new Error('A "url" property or function must be specified')};N=function(a,b){var c=b.error;b.error=function(d){if(c)c.call(b.context,a,d,b);a.trigger("error",a,d,b)}};return b});!function a(b,c){if("object"===typeof exports&&"object"===typeof module)module.exports=c();else if("function"===typeof define&&define.amd)define("handlebars",[],c);else if("object"===typeof exports)exports["Handlebars"]=c();else b["Handlebars"]=c()}(this,function(){return function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:false};a[d].call(e.exports,e,e.exports,c);e.loaded=true;return e.exports}c.m=a;c.c=b;c.p="";return c(0)}([function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q=c(1)["default"],r=c(2)["default"];b.__esModule=true;d=c(3);e=q(d);f=c(17);g=r(f);h=c(5);i=r(h);j=c(4);k=q(j);l=c(18);m=q(l);n=c(19);o=r(n);function s(){var a=new e.HandlebarsEnvironment;k.extend(a,e);a.SafeString=g["default"];a.Exception=i["default"];a.Utils=k;a.escapeExpression=k.escapeExpression;a.VM=m;a.template=function(b){return m.template(b,a)};return a}p=s();p.create=s;o["default"](p);p["default"]=p;b["default"]=p;a.exports=b["default"]},function(a,b){"use strict";b["default"]=function(a){var b,c;if(a&&a.__esModule)return a;else{b={};if(null!=a)for(c in a)if(Object.prototype.hasOwnProperty.call(a,c))b[c]=a[c];b["default"]=a;return b}};b.__esModule=true},function(a,b){"use strict";b["default"]=function(a){return a&&a.__esModule?a:{"default":a}};b.__esModule=true},function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p=c(2)["default"];b.__esModule=true;b.HandlebarsEnvironment=q;d=c(4);e=c(5);f=p(e);g=c(6);h=c(14);i=c(16);j=p(i);k="4.0.5";b.VERSION=k;l=7;b.COMPILER_REVISION=l;m={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};b.REVISION_CHANGES=m;n="[object Object]";function q(a,b,c){this.helpers=a||{};this.partials=b||{};this.decorators=c||{};g.registerDefaultHelpers(this);h.registerDefaultDecorators(this)}q.prototype={constructor:q,logger:j["default"],log:j["default"].log,registerHelper:function r(a,b){if(d.toString.call(a)===n){if(b)throw new f["default"]("Arg not supported with multiple helpers");d.extend(this.helpers,a)}else this.helpers[a]=b},unregisterHelper:function s(a){delete this.helpers[a]},registerPartial:function t(a,b){if(d.toString.call(a)===n)d.extend(this.partials,a);else{if("undefined"===typeof b)throw new f["default"]('Attempting to register a partial called "'+a+'" as undefined');this.partials[a]=b}},unregisterPartial:function u(a){delete this.partials[a]},registerDecorator:function v(a,b){if(d.toString.call(a)===n){if(b)throw new f["default"]("Arg not supported with multiple decorators");d.extend(this.decorators,a)}else this.decorators[a]=b},unregisterDecorator:function w(a){delete this.decorators[a]}};o=j["default"].log;b.log=o;b.createFrame=d.createFrame;b.logger=j["default"]},function(a,b){"use strict";var c,d,e,f,g,h;b.__esModule=true;b.extend=j;b.indexOf=k;b.escapeExpression=l;b.isEmpty=m;b.createFrame=n;b.blockParams=o;b.appendContextPath=p;c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"};d=/[&<>"'`=]/g,e=/[&<>"'`=]/;function i(a){return c[a]}function j(a){var b,c;for(b=1;b<arguments.length;b++)for(c in arguments[b])if(Object.prototype.hasOwnProperty.call(arguments[b],c))a[c]=arguments[b][c];
return a}f=Object.prototype.toString;b.toString=f;g=function q(a){return"function"===typeof a};if(g(/x/))b.isFunction=g=function(a){return"function"===typeof a&&"[object Function]"===f.call(a)};b.isFunction=g;h=Array.isArray||function(a){return a&&"object"===typeof a?"[object Array]"===f.call(a):false};b.isArray=h;function k(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}function l(a){if("string"!==typeof a){if(a&&a.toHTML)return a.toHTML();else if(null==a)return"";else if(!a)return a+"";a=""+a}if(!e.test(a))return a;return a.replace(d,i)}function m(a){if(!a&&0!==a)return true;else if(h(a)&&0===a.length)return true;else return false}function n(a){var b=j({},a);b._parent=a;return b}function o(a,b){a.path=b;return a}function p(a,b){return(a?a+".":"")+b}},function(a,b){"use strict";b.__esModule=true;var c=["description","fileName","lineNumber","message","name","number","stack"];function d(a,b){var e,f,g=b&&b.loc,h=void 0,i=void 0;if(g){h=g.start.line;i=g.start.column;a+=" - "+h+":"+i}e=Error.prototype.constructor.call(this,a);for(f=0;f<c.length;f++)this[c[f]]=e[c[f]];if(Error.captureStackTrace)Error.captureStackTrace(this,d);if(g){this.lineNumber=h;this.column=i}}d.prototype=new Error;b["default"]=d;a.exports=b["default"]},function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=c(2)["default"];b.__esModule=true;b.registerDefaultHelpers=s;d=c(7);e=r(d);f=c(8);g=r(f);h=c(9);i=r(h);j=c(10);k=r(j);l=c(11);m=r(l);n=c(12);o=r(n);p=c(13);q=r(p);function s(a){e["default"](a);g["default"](a);i["default"](a);k["default"](a);m["default"](a);o["default"](a);q["default"](a)}},function(a,b,c){"use strict";b.__esModule=true;var d=c(4);b["default"]=function(a){a.registerHelper("blockHelperMissing",function(b,c){var e,f=c.inverse,g=c.fn;if(true===b)return g(this);else if(false===b||null==b)return f(this);else if(d.isArray(b))if(b.length>0){if(c.ids)c.ids=[c.name];return a.helpers.each(b,c)}else return f(this);else{if(c.data&&c.ids){e=d.createFrame(c.data);e.contextPath=d.appendContextPath(c.data.contextPath,c.name);c={data:e}}return g(b,c)}})};a.exports=b["default"]},function(a,b,c){"use strict";var d,e,f,g=c(2)["default"];b.__esModule=true;d=c(4);e=c(5);f=g(e);b["default"]=function(a){a.registerHelper("each",function(a,b){var c,e,g,h,i,j,k,l,m;if(!b)throw new f["default"]("Must pass iterator to #each");c=b.fn,e=b.inverse,g=0,h="",i=void 0,j=void 0;if(b.data&&b.ids)j=d.appendContextPath(b.data.contextPath,b.ids[0])+".";if(d.isFunction(a))a=a.call(this);if(b.data)i=d.createFrame(b.data);function n(b,e,f){if(i){i.key=b;i.index=e;i.first=0===e;i.last=!!f;if(j)i.contextPath=j+b}h+=c(a[b],{data:i,blockParams:d.blockParams([a[b],b],[j+b,null])})}if(a&&"object"===typeof a)if(d.isArray(a)){for(k=a.length;g<k;g++)if(g in a)n(g,g,g===a.length-1)}else{l=void 0;for(m in a)if(a.hasOwnProperty(m)){if(void 0!==l)n(l,g-1);l=m;g++}if(void 0!==l)n(l,g-1,true)}if(0===g)h=e(this);return h})};a.exports=b["default"]},function(a,b,c){"use strict";var d,e,f=c(2)["default"];b.__esModule=true;d=c(5);e=f(d);b["default"]=function(a){a.registerHelper("helperMissing",function(){if(1===arguments.length)return;else throw new e["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')})};a.exports=b["default"]},function(a,b,c){"use strict";b.__esModule=true;var d=c(4);b["default"]=function(a){a.registerHelper("if",function(a,b){if(d.isFunction(a))a=a.call(this);if(!b.hash.includeZero&&!a||d.isEmpty(a))return b.inverse(this);else return b.fn(this)});a.registerHelper("unless",function(b,c){return a.helpers["if"].call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})})};a.exports=b["default"]},function(a,b){"use strict";b.__esModule=true;b["default"]=function(a){a.registerHelper("log",function(){var b,c,d=[void 0],e=arguments[arguments.length-1];for(b=0;b<arguments.length-1;b++)d.push(arguments[b]);c=1;if(null!=e.hash.level)c=e.hash.level;else if(e.data&&null!=e.data.level)c=e.data.level;d[0]=c;a.log.apply(a,d)})};a.exports=b["default"]},function(a,b){"use strict";b.__esModule=true;b["default"]=function(a){a.registerHelper("lookup",function(a,b){return a&&a[b]})};a.exports=b["default"]},function(a,b,c){"use strict";b.__esModule=true;var d=c(4);b["default"]=function(a){a.registerHelper("with",function(a,b){var c,e;if(d.isFunction(a))a=a.call(this);c=b.fn;if(!d.isEmpty(a)){e=b.data;if(b.data&&b.ids){e=d.createFrame(b.data);e.contextPath=d.appendContextPath(b.data.contextPath,b.ids[0])}return c(a,{data:e,blockParams:d.blockParams([a],[e&&e.contextPath])})}else return b.inverse(this)})};a.exports=b["default"]},function(a,b,c){"use strict";var d,e,f=c(2)["default"];b.__esModule=true;b.registerDefaultDecorators=g;d=c(15);e=f(d);function g(a){e["default"](a)}},function(a,b,c){"use strict";b.__esModule=true;var d=c(4);b["default"]=function(a){a.registerDecorator("inline",function(a,b,c,e){var f=a;if(!b.partials){b.partials={};f=function(e,f){var g,h=c.partials;c.partials=d.extend({},h,b.partials);g=a(e,f);c.partials=h;return g}}b.partials[e.args[0]]=e.fn;return f})};a.exports=b["default"]},function(a,b,c){"use strict";var d,e;b.__esModule=true;d=c(4);e={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function f(a){if("string"===typeof a){var b=d.indexOf(e.methodMap,a.toLowerCase());if(b>=0)a=b;else a=parseInt(a,10)}return a},log:function g(a){var b,c,d,f;a=e.lookupLevel(a);if("undefined"!==typeof console&&e.lookupLevel(e.level)<=a){b=e.methodMap[a];if(!console[b])b="log";for(c=arguments.length,d=Array(c>1?c-1:0),f=1;f<c;f++)d[f-1]=arguments[f];console[b].apply(console,d)}}};b["default"]=e;a.exports=b["default"]},function(a,b){"use strict";b.__esModule=true;function c(a){this.string=a}c.prototype.toString=c.prototype.toHTML=function(){return""+this.string};b["default"]=c;a.exports=b["default"]},function(a,b,c){"use strict";var d,e,f,g,h,i=c(1)["default"],j=c(2)["default"];b.__esModule=true;b.checkRevision=k;b.template=l;b.wrapProgram=m;b.resolvePartial=n;b.invokePartial=o;b.noop=p;d=c(4);e=i(d);f=c(5);g=j(f);h=c(3);function k(a){var b,c,d=a&&a[0]||1,e=h.COMPILER_REVISION;if(d!==e)if(d<e){b=h.REVISION_CHANGES[e],c=h.REVISION_CHANGES[d];throw new g["default"]("Template was precompiled with an older version of Handlebars than the current runtime. "+"Please update your precompiler to a newer version ("+b+") or downgrade your runtime to an older version ("+c+").")}else throw new g["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. "+"Please update your runtime to a newer version ("+a[1]+").")}function l(a,b){if(!b)throw new g["default"]("No environment passed to template");if(!a||!a.main)throw new g["default"]("Unknown template object: "+typeof a);a.main.decorator=a.main_d;b.VM.checkRevision(a.compiler);function c(c,d,f){var h,i,j,k;if(f.hash){d=e.extend({},d,f.hash);if(f.ids)f.ids[0]=true}c=b.VM.resolvePartial.call(this,c,d,f);h=b.VM.invokePartial.call(this,c,d,f);if(null==h&&b.compile){f.partials[f.name]=b.compile(c,a.compilerOptions,b);h=f.partials[f.name](d,f)}if(null!=h){if(f.indent){i=h.split("\n");for(j=0,k=i.length;j<k;j++){if(!i[j]&&j+1===k)break;i[j]=f.indent+i[j]}h=i.join("\n")}return h}else throw new g["default"]("The partial "+f.name+" could not be compiled when running in runtime-only mode")}var d={strict:function h(a,b){if(!(b in a))throw new g["default"]('"'+b+'" not defined in '+a);return a[b]},lookup:function i(a,b){var c,d=a.length;for(c=0;c<d;c++)if(a[c]&&null!=a[c][b])return a[c][b]},lambda:function j(a,b){return"function"===typeof a?a.call(b):a},escapeExpression:e.escapeExpression,invokePartial:c,fn:function k(b){var c=a[b];c.decorator=a[b+"_d"];return c},programs:[],program:function l(a,b,c,d,e){var f=this.programs[a],g=this.fn(a);if(b||e||d||c)f=m(this,a,g,b,c,d,e);else if(!f)f=this.programs[a]=m(this,a,g);return f},data:function n(a,b){while(a&&b--)a=a._parent;return a},merge:function o(a,b){var c=a||b;if(a&&b&&a!==b)c=e.extend({},b,a);return c},noop:b.VM.noop,compilerInfo:a.compiler};function f(b){var c,e,g=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],h=g.data;f._setup(g);if(!g.partial&&a.useData)h=q(b,h);c=void 0,e=a.useBlockParams?[]:void 0;if(a.useDepths)if(g.depths)c=b!==g.depths[0]?[b].concat(g.depths):g.depths;else c=[b];function i(b){return""+a.main(d,b,d.helpers,d.partials,h,e,c)}i=r(a.main,i,d,g.depths||[],h,e);return i(b,g)}f.isTop=true;f._setup=function(c){if(!c.partial){d.helpers=d.merge(c.helpers,b.helpers);if(a.usePartial)d.partials=d.merge(c.partials,b.partials);if(a.usePartial||a.useDecorators)d.decorators=d.merge(c.decorators,b.decorators)}else{d.helpers=c.helpers;d.partials=c.partials;d.decorators=c.decorators}};f._child=function(b,c,e,f){if(a.useBlockParams&&!e)throw new g["default"]("must pass block params");if(a.useDepths&&!f)throw new g["default"]("must pass parent depths");return m(d,b,a[b],c,0,e,f)};return f}function m(a,b,c,d,e,f,g){function h(b){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],h=g;if(g&&b!==g[0])h=[b].concat(g);return c(a,b,a.helpers,a.partials,e.data||d,f&&[e.blockParams].concat(f),h)}h=r(c,h,a,g,d,f);h.program=b;h.depth=g?g.length:0;h.blockParams=e||0;return h}function n(a,b,c){if(!a)if("@partial-block"===c.name)a=c.data["partial-block"];else a=c.partials[c.name];else if(!a.call&&!c.name){c.name=a;a=c.partials[a]}return a}function o(a,b,c){c.partial=true;if(c.ids)c.data.contextPath=c.ids[0]||c.data.contextPath;var d=void 0;if(c.fn&&c.fn!==p){c.data=h.createFrame(c.data);d=c.data["partial-block"]=c.fn;if(d.partials)c.partials=e.extend({},c.partials,d.partials)}if(void 0===a&&d)a=d;if(void 0===a)throw new g["default"]("The partial "+c.name+" could not be found");else if(a instanceof Function)return a(b,c)}function p(){return""}function q(a,b){if(!b||!("root"in b)){b=b?h.createFrame(b):{};b.root=a}return b}function r(a,b,c,d,f,g){if(a.decorator){var h={};b=a.decorator(b,h,c,d&&d[0],f,g,d);e.extend(b,h)}return b}},function(a,b){(function(c){"use strict";b.__esModule=true;b["default"]=function(a){
var b="undefined"!==typeof c?c:window,d=b.Handlebars;a.noConflict=function(){if(b.Handlebars===a)b.Handlebars=d;return a}};a.exports=b["default"]}).call(b,function(){return this}())}])});define("globals",[],function(){var a={},b={};a.CM_PAGE_ID="CM_PAGE_ID";a.currentFacetHeight=42;a.setValue=function(a,c){var d=a.split("."),e,f=b,g;for(g=0;g<d.length;g++){e=d[g];if(g===d.length-1)f[e]=c;else{f[e]=f[e]||{};f=f[e]}}};a.getValue=function(a){var c=a.split("."),d=b,e;for(e=0;e<c.length;e++){if(!d){d=void 0;break}d=d[c[e]]}return d};return a});define("logger",[],function(){"use strict";var a=true,b=window.location,c=b.host;if(c.indexOf(".com")!==-1&&c.indexOf(".fds.com")===-1)if(b.search.search("[?&]debug=[^&]+")===-1)a=false;try{if(a&&localStorage.getItem("disableLogger"))a=false;else if(localStorage.getItem("enableLogger"))a=true}catch(d){}function e(b,c){if(a)if("object"===typeof console&&"function"===typeof console[b])console[b].apply(console,c);return true}function f(){return e("error",arguments)}function g(){return e("warn",arguments)}function h(){return e("info",arguments)}function i(){return e("log",arguments)}function j(){return e("dir",arguments)}function k(){return e("time",arguments)}function l(){return e("timeEnd",arguments)}return{error:f,warn:g,info:h,dir:j,log:i,time:k,timeEnd:l}});define("cookie",["commonUtil/Globals","commonUtil/Logger"],function(a,b){var c="3_87_",d="1_92_",e="4_02_",f="/",g=null,h=false,i={};if("undefined"===typeof window.decodeURIComponent)window.decodeURIComponent="undefined"===typeof window.decodeURI?window.unescape:window.decodeURI;if("undefined"===typeof encodeURIComponent)window.encodeURIComponent="undefined"===typeof window.encodeURI?window.escape:window.encodeURI;i.setExpires=function(a){if("undefined"===typeof a)g=(new Date).toString();else g=a;return g};i.parse=function(a){var c,d,e,f={},g,h,i,j;g=a||document.cookie;d=g.split(/;\s/g);e=d.length;for(c=0;c<e;c+=1){h=d[c].match(/([^=]+)=/i);try{if(h instanceof Array){i=decodeURIComponent(h[1]);j=decodeURIComponent(d[c].substring(h[1].length+1))}else{i=decodeURIComponent(d[c]);j=""}f[i.replace(/ /g,"")]=j}catch(k){b.warn("Error happened while parsing cookie string: ",d[c],k)}}return f};i.get=function(a,b){var f,g,h,i,j,k;g=this.parse();if("undefined"!==typeof b){if(g[b]){h=g[b].split(c);i=h.length;for(j=0;j<i;j++){k=h[j].split(d);if(k[0]===a){f=k[1]===e?"":k[1];break}}}}else f=g[a];return f};function j(a,b,e){var f,g,h,j,k,l,m;f=i.get(a);g=b+d+(""===e?c:e);if(!f||null===f)k=g;else if(f.indexOf(b)===-1)k=f+c+g;else{h=f.split(c);l=h.length;for(j=0;j<l;j++){m=h[j].split(d);if(m[0]===b)h[j]=b+d+e}k=h.join(c)}return k}i.formatDomainForCookie=function(b){var c,d,e,f;if("string"===typeof b&&b.length>0)if(b.indexOf(".",b.indexOf(".",0)+1)>1)d=b.indexOf(".",0)>0?b.substring(b.indexOf(".",0)):b;else d="";else{f=a.getValue("props.cookieDomain");if("undefined"===typeof d||null===d)d="undefined"!==typeof f?f:void 0;if("undefined"===typeof d||null===d)d=window.location.hostname.replace(/^www[1]?\./gi,"")}d=d&&d.indexOf(":")!==-1?d.substring(0,d.indexOf(":")):d;return d};i.set=function(a,b,c,d){var k,l,m,n,o,p=a;b="boolean"===typeof b?b.toString():b;if("undefined"===typeof b||null===b){if(!c)return false;b=e}n=b;if(c){p=c;if(""===b)b=e;n=j(c,a,b)}m=encodeURIComponent(p)+"="+encodeURIComponent(n);if(d)if(d.constructor===Date)g=d.toGMTString();else{if(d.expires){g=d.expires;if(g.constructor===Date)g=g.toGMTString()}if(d.path)f=d.path;if(d.secure)h=d.secure}if(g)m+="; expires="+g;m+="; path="+f;o=i.formatDomainForCookie(d?d.domain||"":"");if(o&&o.length)m+="; domain="+o;if(h)m+=";secure="+h;document.cookie=m;g=null;return true};i.remove=function(a,b,e){var f,h,j,k,l,m;if(b){f=this.get(b);if(f&&f.indexOf(a)!==-1){h=f.split(c);j="";for(k=0;k<h.length;k++){m=h[k].split(d);if(m[0]!==a){if(""!==j)j+=c;j+=h[k]}}this.set(b,j,void 0,e)}}else{g=new Date((new Date).getTime()-864e5);i.set(a,"",void 0,e);g=null}};i.getCountryCode=function(){var a;if(void 0===a){a=i.get("shippingCountry");if(!a)a=null}return a};i.getCurrencyCode=function(){var a;if(void 0===a){a=i.get("currency");if(!a)a=null}return a};i.isInternationalMode=function(){var a,b;if(void 0===a){a=false;b=i.getCountryCode();if(b)a="US"!==b}return a};i.getSessionId=function(){var a;if(void 0===a)a=i.get("bloomingdales_online_uid")||i.get("macys_online_uid")||"0000000000";return a};return i});define("stringUtil",["jquery"],function(a){var b=function(a,b,c,d){var e,f="",g=d||"";if(a.length<c)f=a;else for(e=c;e>b;e--)if(","===a.charAt(e-1))f=a.substring(0,e-1)+g;else if(" "===a.charAt(e))f=a.substring(0,e)+g;return f},c=function(a){if(void 0!==a&&null!==a&&""!==a)return true;else return false},d=function(a,b){if(arguments.length>1)for(var c=1;c<arguments.length;c++)a=a.replace("$"+c,arguments[c]);return a},e=function(a,b){var c=b||"US";switch(c.toUpperCase()){default:return/(^\d{5}$)|(^\d{5}-\d{4}$)/.test(a)}},f=function(a){if(a)return null===a||0===a.length||/^\s+$/.test(a);else return true},g=function(a){var b=parseFloat(a);if(isNaN(b))throw new Error("string argument must be parseable with parseFloat()");return"$"+b.toFixed(2)},h=function(a,b){b="undefined"!==typeof b?b:location.search;return decodeURIComponent((new RegExp("[?|&]?"+a+"="+"([^&;]+?)(&|#|;|$)").exec(b)||["",""])[1].replace(/\+/g,"%20"))||null},i=function(a,b){var c=b||location.hash,d=new RegExp("[#|&]"+a+"="+"([^&;]+?)(&|#|;|$)"),e=d.exec(c);return decodeURIComponent((d.exec(c)||["",""])[1].replace(/\+/g,"%20"))||null};function j(b,c,d,e,f){var g,h,i,j=a(b).text(),k=e||j,l=j,m=0,n=[],o="filter-match"+(f?" "+f:"");while(k.substr(m).search(d)>=0){g=k.substr(m).search(d)+m;h=g+c.length;i='<span data-id="highlight" class="'+o+'">'+j.substring(g,h)+"</span>";n[n.length]=j.substring(m,g);n[n.length]=i;m=h}n[n.length]=j.substring(h);a(b).html(n.join(""))}function k(b){a(b+' span[data-id="highlight"]').contents().unwrap()}function l(a){return a.replace(/([()[{*+.$^\\|?])/g,"\\$1")}function m(a){var b=a.charAt(0).toUpperCase()+a.substr(1).toLowerCase();return b}function n(a,b){var c=[];if(!a||"string"!==typeof a||b&&"string"!==typeof b)throw new Error("Incorrect parameters passed.");if(a.length>4){b=b||"*";c[a.length-4]=void 0;return c.join(b)+a.substr(a.length-4,4)}else return a}function o(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"===b?c:3&c|8).toString(16)});return b}!function(){if("function"!==typeof String.prototype.trim)String.prototype.trim=function(){return a.trim(this)};if("function"!==typeof String.prototype.endsWith)String.prototype.endsWith=function(a,b){var c,d=this.toString();if(void 0===b||b>d.length)b=d.length;b-=a.length;c=d.indexOf(a,b);return c!==-1&&c===b};if("function"!==typeof String.prototype.startsWith)String.prototype.startsWith=function(a,b){b=b||0;return this.substr(b,a.length)===a}}();return{generateUuid:o,truncate:b,replaceMultiple:d,validatePostalCode:e,isEmpty:f,isEmptyString:c,toPrice:g,getURLParameter:h,getURLParameterFromHash:i,highlightRemove:k,highlightInsert:j,escapeForRegEx:l,toCapitalize:m,maskCreditCard:n}});define("base",["jquery"],function($){var TOP="top",BOTTOM="bottom",RIGHT="right",LEFT="left",ALIGN_TOP="alignTop",ALIGN_BOTTOM="alignBottom",FLEX_LABEL_PREFIX="flexLabel_",SITE="SITE",REGISTRY="REGISTRY",HTTPS="https://",HTTP="http://",getCurrentChannel=function(a){var b=a||window.location.href,c=!~b.indexOf("registry")?this.SITE:this.REGISTRY;return c},isThirdParty=function(a){var b=a||window.location.host,c="object"===typeof macysConfig;return c},isProduction=function(a){var b=a||window.location.host;return b.indexOf("www.macys.com")>-1||b.indexOf("www1.macys.com")>-1},isNavApp=function(){var a=$("div.globalHiddenDefaultTopNav").length;return 0===a},getProtocol=function(a){var b,c=a||location.href;if(c.indexOf(this.HTTPS)>-1)return this.HTTPS;else if(c.indexOf(this.HTTP)>-1)return this.HTTP;else if(c.indexOf(":")>-1){b=c.indexOf(":");return c.substr(0,b+3)}else return""},isTouch=function(){var a=!!("ontouchstart"in window),b=!!window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>0;return a||b},removePrefix=function(a){var b=a.substr(a.indexOf("_")+1);if(b.match(/[a-zA-Z]+/))throw new Error("base.removePrefix has failed. Invalid id value.");return Number(b)},getSuffixId=function(a){if(!~a.indexOf("_"))throw new Error("Invalid flyout id format, should be flyout_<ID> for flyouts OR "+this.FLEX_LABEL_PREFIX+"<ID> for topnav "+a);else return this.removePrefix(a)},getUserAgent=function(){var a=navigator.userAgent||navigator.vendor||window.opera;return a},getIEVersion=function(userAgentStringTest){var ua=userAgentStringTest||this.getUserAgent(),groups=ua.match(/(MSIE )([0-9\.b]+)/),result=false;if(null!==groups)result=eval(groups[2].substring(0,groups[2].indexOf(".")+2));return result},sign=function(a,b,c){return(a.x-c.x)*(b.y-c.y)-(b.x-c.x)*(a.y-c.y)},pointInTriangle=function(a,b,c,d){if(void 0===a||void 0===b||void 0===c||void 0===d||0===b.x||0===b.y)return false;var e,f,g;e=this.sign(a,b,c)<0;f=this.sign(a,c,d)<0;g=this.sign(a,d,b)<0;return e===f&&f===g},makeIdIfUnknown=function(a){if("string"===typeof a)if("#"!==a.substring(0,1)&&"."!==a.substring(0,1))a="#"+a;return a},removeEndSlash=function(a){return"/"===a.charAt(a.length-1)?a.substr(0,a.length-1):a},getServiceUrl=function(a,b,c,d){var e=c,f=a,g=d||"",h=b,i=f;if(window&&window.location&&window.location.protocol.indexOf("https")!==-1)i=g;if("80"!==h&&"443"!==h&&""!==h)i=removeEndSlash(i)+":"+h;i+=e;i=removeEndSlash(i.replace(/([^:]\/)\/+/g,"$1"));return i},absoluteLinkatize=function(a,b){if(!b)throw new Error("Base.absoluteLinkatize failed. Required host parameter is missing.");else return a.replace(/href=("|')\//g,"href=$1"+b+"/")};return{isProduction:isProduction,getIEVersion:getIEVersion,removePrefix:removePrefix,getSuffixId:getSuffixId,getUserAgent:getUserAgent,getCurrentChannel:getCurrentChannel,pointInTriangle:pointInTriangle,
isThirdParty:isThirdParty,isNavApp:isNavApp,removeEndSlash:removeEndSlash,getServiceUrl:getServiceUrl,absoluteLinkatize:absoluteLinkatize,makeIdIfUnknown:makeIdIfUnknown,isTouch:isTouch,sign:sign,getProtocol:getProtocol,HTTP:HTTP,HTTPS:HTTPS,FLEX_LABEL_PREFIX:FLEX_LABEL_PREFIX,SITE:SITE,REGISTRY:REGISTRY}});define("domReady",[],function(){"use strict";var a,b,c,d="undefined"!==typeof window&&window.document,e=!d,f=d?document:null,g=[];function h(a){var b;for(b=0;b<a.length;b+=1)a[b](f)}function i(){var a=g;if(e)if(a.length){g=[];h(a)}}function j(){if(!e){e=true;if(c)clearInterval(c);i()}}if(d){if(document.addEventListener){document.addEventListener("DOMContentLoaded",j,false);window.addEventListener("load",j,false)}else if(window.attachEvent){window.attachEvent("onload",j);b=document.createElement("div");try{a=null===window.frameElement}catch(k){}if(b.doScroll&&a&&window.external)c=setInterval(function(){try{b.doScroll();j()}catch(a){}},30)}if("complete"===document.readyState)j()}function l(a){if(e)a(f);else g.push(a);return l}l.version="2.0.1";l.load=function(a,b,c,d){if(d.isBuild)c(null);else l(c)};return l});define("async",[],function(){var a="callback",b=0;function c(a){var b,c;b=document.createElement("script");b.type="text/javascript";b.async=true;b.src=a;c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}function d(b,c){var d=/!(.+)/,e=b.replace(d,""),f=d.test(b)?b.replace(/.+!/,""):a;e+=e.indexOf("?")<0?"?":"&";return e+f+"="+c}function e(){b+=1;return"__async_req_"+b+"__"}return{load:function(a,b,f,g){if(g.isBuild)f(null);else{var h=e();window[h]=f;c(d(a,h))}}}});define("pubsub",["jquery"],function(a){var b={};function c(){var b,c;b=a.Callbacks("unique");c={publish:function(a){b.fire(a)},subscribe:b.add,unsubscribe:b.remove,has:b.has,empty:b.empty};return c}function d(a){var c,d;if(a)for(d in b)if(b[a]){c=b[a];break}return c}function e(a){var d;if(a){if(!b[a])b[a]=c();d=b[a]}return d}function f(a){var c=false;if(a&&b[a]){b[a].empty();delete b[a];c=true}return c}return{observe:e,observers:b,removeObserver:f,hasObserver:d}});define("analyticsBase",["commonUtil/PublishSubscribe"],function(a){var b;b={};b.pageViewTag="PAGE_VIEW_TAG";b.productViewTag="PRODUCT_VIEW_TAG";b.orderTag="ORDER_TAG";b.elementTag="ELEMENT_TAG";b.bazaarVoiceTag="BAZAAR_VIEW_TAG";b.shopAction5Tag="SHOP5_ACTION_TAG";b.shopAction9Tag="SHOP9_ACTION_TAG";b.masterMemberTag="MASTER_MEMBER_TAG";b.linkClickTag="LINK_CLICK_TAG";b.conversionEventTag="CONVERSION_EVENT_TAG";b.customTag="CUSTOM_TAG";b.registrationTag="REGISTRATION_TAG";b.addListener=function(b,c){a.observe(b).subscribe(c)};b.removeListener=function(b,c){a.observe(b).unsubscribe(c)};b.fireEvent=function(b,c){a.observe(b).publish(c)};b.fireOnceNow=function(a,c,d){b.addListener(a,c);b.fireEvent(a,d);b.removeListener(a,c)};b.hasListener=function(b,c){var d;d=a.hasObserver(b);if("undefined"!==typeof d&&null!==d&&d)if(d.has&&c)d=d.has(c);return d};return b});define("mapCache",[],function(){var a=this;function b(){var a={},b=function(b){var c,d;if(!Object.keys||b){c=0;for(d in a)if(a.hasOwnProperty(d))c++;return c}else return Object.keys(a).length};this.setItem=function(b,c){a[b]=c;return true};this.getItem=function(b){return a[b]||""};this.clear=function(){a={}};this.removeItem=function(b){delete a[b]};this.getLength=b;this.length=function(){return b()}}return b});define("coremetricsAttributes",[],function(){var a={},b,c=50;b=[];a.convertAttributes=function(b){var c,d=b.length;a.reset();for(c=1;c<d;c+=1)a.addAttribute(b[c],c);return a.attributeToString()};a.reset=function(){b=[]};a.addAttribute=function(a,d){var e,f=d-1;if(d>c)throw new Error("Only 50 attributes are allowed.");if(isNaN(d)||d<1)throw"Invalid index, index must be a number greater than 0!";for(e=0;e<f-1;e+=1)if(!b[e])b[e]="";b[f]=a};a.concatAttribute=function(a,d){var e,f=d-1;if(d>c)throw new Error("Only "+c+" attributes are allowed.");if(isNaN(d)||d<1)throw"Invalid index, index must be a number greater than 0!";for(e=0;e<f-1;e+=1)if(!b[e])b[e]="";if("undefined"!==typeof b[f]&&""!==b[f])b[f]=b[f]+"|"+a;else b[f]=a};a.attributeToString=function(){var a,c;a=b.length;for(c=0;c<a;c+=1)if(!b[c])b[c]="";return b.join("-_-")};a.attributeToArray=function(){return b};return a});define("clientSideStorage",["commonUtil/MapCache"],function(a){"use strict";var b="testKey",c="testValue",d,e,f;function g(a){if(d&&null!==d.getItem(a))return d.getItem(a);else return null}function h(a,b){d.setItem(a,b)}function i(a){d.removeItem(a)}function j(){d.clear()}function k(a){if(e&&null!==e.getItem(a))return e.getItem(a);else return null}function l(a,b){e.setItem(a,b)}function m(a){e.removeItem(a)}function n(){e.clear()}function o(){var a,d=false;if(window.sessionStorage)try{window.sessionStorage.setItem(b,c);a=window.sessionStorage.getItem(b);window.sessionStorage.removeItem(b);d=a===c}catch(e){}return d}function p(){var a,d=false;if(window.localStorage)try{window.localStorage.setItem(b,c);a=window.localStorage.getItem(b);window.localStorage.removeItem(b);d=a===c}catch(e){}return d}function q(){if("boolean"!==typeof f)f=o()&&p();return f}function r(b){if(b||!q()){d=new a;e=new a}else{d=window.sessionStorage;e=window.localStorage}}r();return{getPersistent:k,setPersistent:l,removePersistent:m,getSession:g,setSession:h,removeSession:i,clearSession:j,clearPersistent:n,isStorageAvailable:q,enableKeywordCache:r}});define("userStatus",["commonUtil/Cookie"],function(a){"use strict";var b=30;return{getUserName:function(){return a.get("UserName","GCs")},isSignedIn:function(){return"1"===a.get("SignedIn")},isSoftSignedIn:function(){var c=a.get("last_access_token","SNSGCs");return this.getUserName()&&(!this.isSignedIn()||c&&((new Date).getTime()-parseInt(c,10))/6e4>b)}}});define("mcomAnalytics",["underscore","coremetricsAttributes","clientSideStorage","userStatus"],function(a,b,c,d){var e={};function f(a){if(!a||"[object Array]"!==Object.prototype.toString.call(a))return"";var c,d;b.reset();d=a.length;for(c=0;c<d;c+=1)b.addAttribute(a[c],c+1);return b.attributeToString()}e.productViewTag=function(a){var b=f(a.attributes);if("undefined"!==typeof window.cmCreateProductviewTag)window.cmCreateProductviewTag(a.productID,a.productName,a.categoryID,a.partnerId,"",a.bannerId,"",a.linkShareId,a.macysOnlineCookie,a.bhrfCookie,a.crossSell,"","","","",b)};e.elementTag=function(a){var b=f(a.attributes);if("undefined"!==typeof window.cmCreatePageElementTag)window.cmCreatePageElementTag(a.elementID,a.elementCategory,b)};e.pageViewTag=function(a){g(a.attributes);var b=f(a.attributes);if("undefined"!==typeof window.cmCreatePageviewTag)window.cmCreatePageviewTag(a.pageID,a.categoryID,a.searchString,a.searchResults,a.partnerID,"",a.bannerID,a.productID,a.linkShareID,a.userID,a.refURL,b,a.extraFields)};function g(a){if(!a||"[object Array]"!==Object.prototype.toString.call(a))return"";a[34]=d.isSoftSignedIn()?"Soft Signed-In":d.isSignedIn()?"Signed-In":"Guest"}e.bazaarViewTag=function(a){var b=f(a.attributes);if("undefined"!==typeof window.cmCreateBazaarViewTag)window.cmCreateBazaarViewTag(a.productID,a.productName,a.categoryID)};e.shopAction5Tag=function(a){var b=f(a.attributes);if("undefined"!==typeof window.cmCreatePageElementTag)window.cmCreateShopAction5Tag(a.productID,a.productName,a.productQuantity,a.productPrice,a.categoryID,a.MasterProductID,a.MasterProductName,a.MasterCatID,a.IsMaster,a.cmCrossSell,b);if("undefined"!==typeof window.cmDisplayShop5s)window.cmDisplayShop5s()};e.shopAction9Tag=function(a){var b=f(a.attributes);if("undefined"!==typeof window.cmCreateShopAction9Tag)window.cmCreateShopAction9Tag(a.productID,a.productName,a.productQuantity,a.productPrice,a.customerID,a.orderID,a.orderTotal,a.categoryID,a.MasterProductID,a.MasterProductName,a.MasterCatID,a.IsMaster,a.cmCrossSell,b);if("undefined"!==typeof window.cmDisplayShop9s)window.cmDisplayShop9s()};e.masterMemberTag=function(a){if("undefined"!==typeof window.cmCreateMasterMemberTag)window.cmCreateMasterMemberTag(a.masterProductID,a.masterProductName,a.masterCatID,a.isMaster,a.custID)};e.ConversionEventTag=function(a){var b=f(a.attributes);if("undefined"!==typeof window.cmCreateConversionEventTag)window.cmCreateConversionEventTag(a.conversionTagEventId,a.conversionTagEventActionType,a.conversionTagEventCategoryID,a.conversionTagEventPoints,b)};e.linkClickTag=function(a){if("undefined"!==typeof window.cmCreateManualLinkClickTag)window.cmCreateManualLinkClickTag(a.href,a.name,a.pageID)};e.CustomTag=function(a){if("undefined"!==typeof window.cmCreateUserErrorTag)window.cmCreateUserErrorTag(a.pageID,a.categoryID,a.mMsgCode,a.mMsgType,a.mMsgClass,a.mMsgDesc,a.mServerName,a.mCloneName)};e.RegistrationTag=function(a){window.cmCreateRegistrationTag(a.customerID,a.email,a.city,a.state,a.zipCode,a.customerGender,a.newsletterName,a.subscribe)};e.OrderTag=function(a){var b=f(a.attributes);if("undefined"!==typeof window.cmCreateOrderTag)window.cmCreateOrderTag(a.orderID,a.orderTotal,a.orderShipping,a.customerID,a.customerCity,a.customerState,a.customerZIP,a.custID,b)};e.cmRecRequest=function(a){if("undefined"!==typeof window.cmRecRequest)window.cmRecRequest(a.zoneId,a.productId,a.categoryId,a.randomizeParam,a.searchTermParam)};e.cmDisplayRecs=function(){if("undefined"!==typeof window.cmDisplayRecs)window.cmDisplayRecs()};e.productViewDataToPageViewData=function(b){var c=a.omit(b,"attributes");c.pageID="PRODUCT: "+c.productName+" ("+c.productID+")";return c};e.experimentLinkClickTag=function(b){var d,f,g,h;if(!a.isUndefined(b.expName)&&!a.isUndefined(b.expValue)){d="EXPERIMENT-_-"+b.expName+"-_-"+b.expValue;f=document.location.pathname+"/EXP?cm_sp="+d;g="UNKNOWN";if(!a.isUndefined(window.MACYS)&&!a.isUndefined(window.MACYS.brightTag)&&!a.isUndefined(window.MACYS.brightTag.navigation)&&!a.isUndefined(window.MACYS.brightTag.navigation.pageName&&""!==window.MACYS.brightTag.navigation.pageName))g=window.MACYS.brightTag.navigation.pageName;b=a.defaults(b,{name:"EXPERIMENT_LINK",href:f,pageID:g,sessionBased:false
});h=c.getSession(d);if(!b.sessionBased||null===h){if("undefined"!==typeof e)e.linkClickTag(b);if(b.sessionBased)c.setSession(d,(new Date).toString())}}};return e});!function(a,b){if("function"===typeof define&&define.amd)define("backbonerelational",["exports","backbone","underscore"],b);else if("undefined"!==typeof exports)b(exports,require("backbone"),require("underscore"));else b(a,a.Backbone,a._)}(this,function(a,b,c){"use strict";var d,e,f,g,h;b.Relational={showWarnings:true};b.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable)throw new Error("Max permits acquired");else this._permitsUsed++},release:function(){if(0===this._permitsUsed)throw new Error("All permits released");else this._permitsUsed--},isLocked:function(){return this._permitsUsed>0},setAvailablePermits:function(a){if(this._permitsUsed>a)throw new Error("Available permits cannot be less than used permits");this._permitsAvailable=a}};b.BlockingQueue=function(){this._queue=[]};c.extend(b.BlockingQueue.prototype,b.Semaphore,{_queue:null,add:function(a){if(this.isBlocked())this._queue.push(a);else a()},process:function(){var a=this._queue;this._queue=[];while(a&&a.length)a.shift()()},block:function(){this.acquire()},unblock:function(){this.release();if(!this.isBlocked())this.process()},isBlocked:function(){return this.isLocked()}});b.Relational.eventQueue=new b.BlockingQueue;b.Store=function(){this._collections=[];this._reverseRelations=[];this._orphanRelations=[];this._subModels=[];this._modelScopes=[a]};c.extend(b.Store.prototype,b.Events,{initializeRelation:function(a,d,e){var f,g=!c.isString(d.type)?d.type:b[d.type]||this.getObjectByName(d.type);if(g&&g.prototype instanceof b.Relation)f=new g(a,d,e);else b.Relational.showWarnings&&"undefined"!==typeof console&&console.warn("Relation=%o; missing or invalid relation type!",d)},addModelScope:function(a){this._modelScopes.push(a)},removeModelScope:function(a){this._modelScopes=c.without(this._modelScopes,a)},addSubModels:function(a,b){this._subModels.push({superModelType:b,subModels:a})},setupSuperModel:function(a){c.find(this._subModels,function(b){return c.filter(b.subModels||[],function(c,d){var e=this.getObjectByName(c);if(a===e){b.superModelType._subModels[d]=a;a._superModel=b.superModelType;a._subModelTypeValue=d;a._subModelTypeAttribute=b.superModelType.prototype.subModelTypeAttribute;return true}},this).length},this)},addReverseRelation:function(a){var b=c.any(this._reverseRelations,function(b){return c.all(a||[],function(a,c){return a===b[c]})});if(!b&&a.model&&a.type){this._reverseRelations.push(a);this._addRelation(a.model,a);this.retroFitRelation(a)}},addOrphanRelation:function(a){var b=c.any(this._orphanRelations,function(b){return c.all(a||[],function(a,c){return a===b[c]})});if(!b&&a.model&&a.type)this._orphanRelations.push(a)},processOrphanRelations:function(){c.each(this._orphanRelations.slice(0),function(a){var d=b.Relational.store.getObjectByName(a.relatedModel);if(d){this.initializeRelation(null,a);this._orphanRelations=c.without(this._orphanRelations,a)}},this)},_addRelation:function(a,b){if(!a.prototype.relations)a.prototype.relations=[];a.prototype.relations.push(b);c.each(a._subModels||[],function(a){this._addRelation(a,b)},this)},retroFitRelation:function(a){var b=this.getCollection(a.model,false);b&&b.each(function(b){if(!(b instanceof a.model))return;var c=new a.type(b,a)},this)},getCollection:function(a,d){var e,f;if(a instanceof b.RelationalModel)a=a.constructor;e=a;while(e._superModel)e=e._superModel;f=c.find(this._collections,function(a){return a.model===e});if(!f&&false!==d)f=this._createCollection(e);return f},getObjectByName:function(a){var b=a.split("."),d=null;c.find(this._modelScopes,function(a){d=c.reduce(b||[],function(a,b){return a?a[b]:void 0},a);if(d&&d!==a)return true},this);return d},_createCollection:function(a){var c;if(a instanceof b.RelationalModel)a=a.constructor;if(a.prototype instanceof b.RelationalModel){c=new b.Collection;c.model=a;this._collections.push(c)}return c},resolveIdForItem:function(a,d){var e=c.isString(d)||c.isNumber(d)?d:null;if(null===e)if(d instanceof b.RelationalModel)e=d.id;else if(c.isObject(d))e=d[a.prototype.idAttribute];if(!e&&0!==e)e=null;return e},find:function(a,b){var c,d=this.resolveIdForItem(a,b),e=this.getCollection(a);if(e){c=e.get(d);if(c instanceof a)return c}return null},register:function(a){var b,c=this.getCollection(a);if(c){b=a.collection;c.add(a);a.collection=b}},checkId:function(a,c){var d=this.getCollection(a),e=d&&d.get(c);if(e&&a!==e){if(b.Relational.showWarnings&&"undefined"!==typeof console)console.warn("Duplicate id! Old RelationalModel=%o, new RelationalModel=%o",e,a);throw new Error("Cannot instantiate more than one Backbone.RelationalModel with the same id per type!")}},update:function(a){var b=this.getCollection(a);if(!b.contains(a))this.register(a);b._onModelEvent("change:"+a.idAttribute,a,b);a.trigger("relational:change:id",a,b)},unregister:function(a){var d,e;if(a instanceof b.Model){d=this.getCollection(a);e=[a]}else if(a instanceof b.Collection){d=this.getCollection(a.model);e=c.clone(a.models)}else{d=this.getCollection(a);e=c.clone(d.models)}c.each(e,function(a){this.stopListening(a);c.invoke(a.getRelations(),"stopListening")},this);if(c.contains(this._collections,a))d.reset([]);else c.each(e,function(a){if(d.get(a))d.remove(a);else d.trigger("relational:remove",a,d)},this)},reset:function(){this.stopListening();c.each(this._collections,function(a){this.unregister(a)},this);this._collections=[];this._subModels=[];this._modelScopes=[a]}});b.Relational.store=new b.Store;b.Relation=function(a,d,e){this.instance=a;d=c.isObject(d)?d:{};this.reverseRelation=c.defaults(d.reverseRelation||{},this.options.reverseRelation);this.options=c.defaults(d,this.options,b.Relation.prototype.options);this.reverseRelation.type=!c.isString(this.reverseRelation.type)?this.reverseRelation.type:b[this.reverseRelation.type]||b.Relational.store.getObjectByName(this.reverseRelation.type);this.key=this.options.key;this.keySource=this.options.keySource||this.key;this.keyDestination=this.options.keyDestination||this.keySource||this.key;this.model=this.options.model||this.instance.constructor;this.relatedModel=this.options.relatedModel;if(c.isUndefined(this.relatedModel))this.relatedModel=this.model;if(c.isFunction(this.relatedModel)&&!(this.relatedModel.prototype instanceof b.RelationalModel))this.relatedModel=c.result(this,"relatedModel");if(c.isString(this.relatedModel))this.relatedModel=b.Relational.store.getObjectByName(this.relatedModel);if(!this.checkPreconditions())return;if(!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key)b.Relational.store.addReverseRelation(c.defaults({isAutoRelation:true,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation));if(a){var f=this.keySource;if(f!==this.key&&c.isObject(this.instance.get(this.key)))f=this.key;this.setKeyContents(this.instance.get(f));this.relatedCollection=b.Relational.store.getCollection(this.relatedModel);if(this.keySource!==this.key)delete this.instance.attributes[this.keySource];this.instance._relations[this.key]=this;this.initialize(e);if(this.options.autoFetch)this.instance.getAsync(this.key,c.isObject(this.options.autoFetch)?this.options.autoFetch:{});this.listenTo(this.instance,"destroy",this.destroy).listenTo(this.relatedCollection,"relational:add relational:change:id",this.tryAddRelated).listenTo(this.relatedCollection,"relational:remove",this.removeRelated)}};b.Relation.extend=b.Model.extend;c.extend(b.Relation.prototype,b.Events,b.Semaphore,{options:{createModels:true,includeInJSON:true,isAutoRelation:false,autoFetch:false,parse:false},instance:null,key:null,keyContents:null,relatedModel:null,relatedCollection:null,reverseRelation:null,related:null,checkPreconditions:function(){var a,d=this.instance,e=this.key,f=this.model,g=this.relatedModel,h=b.Relational.showWarnings&&"undefined"!==typeof console;if(!f||!e||!g){h&&console.warn("Relation=%o: missing model, key or relatedModel (%o, %o, %o).",this,f,e,g);return false}if(!(f.prototype instanceof b.RelationalModel)){h&&console.warn("Relation=%o: model does not inherit from Backbone.RelationalModel (%o).",this,d);return false}if(!(g.prototype instanceof b.RelationalModel)){h&&console.warn("Relation=%o: relatedModel does not inherit from Backbone.RelationalModel (%o).",this,g);return false}if(this instanceof b.HasMany&&this.reverseRelation.type===b.HasMany){h&&console.warn("Relation=%o: relation is a HasMany, and the reverseRelation is HasMany as well.",this);return false}if(d&&c.keys(d._relations).length){a=c.find(d._relations,function(a){return a.key===e},this);if(a){h&&console.warn("Cannot create relation=%o on %o for model=%o: already taken by relation=%o.",this,e,d,a);return false}}return true},setRelated:function(a){this.related=a;this.instance.attributes[this.key]=a},_isReverseRelation:function(a){return a.instance instanceof this.relatedModel&&this.reverseRelation.key===a.key&&this.key===a.reverseRelation.key},getReverseRelations:function(a){var b,d,e=[],f=!c.isUndefined(a)?[a]:this.related&&(this.related.models||[this.related]),g=null,h=null;for(b=0;b<(f||[]).length;b++){g=f[b].getRelations()||[];for(d=0;d<g.length;d++){h=g[d];if(this._isReverseRelation(h))e.push(h)}}return e},destroy:function(){this.stopListening();if(this instanceof b.HasOne)this.setRelated(null);else if(this instanceof b.HasMany)this.setRelated(this._prepareCollection());c.each(this.getReverseRelations(),function(a){a.removeRelated(this.instance)},this)}});b.HasOne=b.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(a){this.listenTo(this.instance,"relational:change:"+this.key,this.onChange);var b=this.findRelated(a);this.setRelated(b);c.each(this.getReverseRelations(),function(b){b.addRelated(this.instance,a)},this)},findRelated:function(a){
var b,d=null;a=c.defaults({parse:this.options.parse},a);if(this.keyContents instanceof this.relatedModel)d=this.keyContents;else if(this.keyContents||0===this.keyContents){b=c.defaults({create:this.options.createModels},a);d=this.relatedModel.findOrCreate(this.keyContents,b)}if(d)this.keyId=null;return d},setKeyContents:function(a){this.keyContents=a;this.keyId=b.Relational.store.resolveIdForItem(this.relatedModel,this.keyContents)},onChange:function(a,d,e){var f,g,h,i;if(this.isLocked())return;this.acquire();e=e?c.clone(e):{};f=c.isUndefined(e.__related),g=f?this.related:e.__related;if(f){this.setKeyContents(d);h=this.findRelated(e);this.setRelated(h)}if(g&&this.related!==g)c.each(this.getReverseRelations(g),function(a){a.removeRelated(this.instance,null,e)},this);c.each(this.getReverseRelations(),function(a){a.addRelated(this.instance,e)},this);if(!e.silent&&this.related!==g){i=this;this.changed=true;b.Relational.eventQueue.add(function(){i.instance.trigger("change:"+i.key,i.instance,i.related,e,true);i.changed=false})}this.release()},tryAddRelated:function(a,b,c){if((this.keyId||0===this.keyId)&&a.id===this.keyId){this.addRelated(a,c);this.keyId=null}},addRelated:function(a,b){var d=this;a.queue(function(){if(a!==d.related){var e=d.related||null;d.setRelated(a);d.onChange(d.instance,a,c.defaults({__related:e},b))}})},removeRelated:function(a,b,d){if(!this.related)return;if(a===this.related){var e=this.related||null;this.setRelated(null);this.onChange(this.instance,a,c.defaults({__related:e},d))}}});b.HasMany=b.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},collectionType:b.Collection,collectionKey:true,collectionOptions:{}},initialize:function(a){this.listenTo(this.instance,"relational:change:"+this.key,this.onChange);this.collectionType=this.options.collectionType;if(c.isFunction(this.collectionType)&&this.collectionType!==b.Collection&&!(this.collectionType.prototype instanceof b.Collection))this.collectionType=c.result(this,"collectionType");if(c.isString(this.collectionType))this.collectionType=b.Relational.store.getObjectByName(this.collectionType);if(this.collectionType!==b.Collection&&!(this.collectionType.prototype instanceof b.Collection))throw new Error("`collectionType` must inherit from Backbone.Collection");var d=this.findRelated(a);this.setRelated(d)},_prepareCollection:function(a){var d,e;if(this.related)this.stopListening(this.related);if(!a||!(a instanceof b.Collection)){d=c.isFunction(this.options.collectionOptions)?this.options.collectionOptions(this.instance):this.options.collectionOptions;a=new this.collectionType(null,d)}a.model=this.relatedModel;if(this.options.collectionKey){e=true===this.options.collectionKey?this.options.reverseRelation.key:this.options.collectionKey;if(a[e]&&a[e]!==this.instance){if(b.Relational.showWarnings&&"undefined"!==typeof console)console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,e,this.options.collectionKey)}else if(e)a[e]=this.instance}this.listenTo(a,"relational:add",this.handleAddition).listenTo(a,"relational:remove",this.handleRemoval).listenTo(a,"relational:reset",this.handleReset);return a},findRelated:function(a){var d,e=null;a=c.defaults({parse:this.options.parse},a);if(this.keyContents instanceof b.Collection){this._prepareCollection(this.keyContents);e=this.keyContents}else{d=[];c.each(this.keyContents,function(b){var e=null;if(b instanceof this.relatedModel)e=b;else e=c.isObject(b)&&a.parse&&this.relatedModel.prototype.parse?this.relatedModel.prototype.parse(c.clone(b),a):b;e&&d.push(e)},this);if(this.related instanceof b.Collection)e=this.related;else e=this._prepareCollection();e.set(d,c.defaults({parse:false},a))}this.keyIds=c.difference(this.keyIds,c.pluck(e.models,"id"));return e},setKeyContents:function(a){this.keyContents=a instanceof b.Collection?a:null;this.keyIds=[];if(!this.keyContents&&(a||0===a)){this.keyContents=c.isArray(a)?a:[a];c.each(this.keyContents,function(a){var c=b.Relational.store.resolveIdForItem(this.relatedModel,a);if(c||0===c)this.keyIds.push(c)},this)}},onChange:function(a,d,e){var f,g;e=e?c.clone(e):{};this.setKeyContents(d);this.changed=false;f=this.findRelated(e);this.setRelated(f);if(!e.silent){g=this;b.Relational.eventQueue.add(function(){if(g.changed){g.instance.trigger("change:"+g.key,g.instance,g.related,e,true);g.changed=false}})}},handleAddition:function(a,d,e){e=e?c.clone(e):{};this.changed=true;c.each(this.getReverseRelations(a),function(a){a.addRelated(this.instance,e)},this);var f=this;!e.silent&&b.Relational.eventQueue.add(function(){f.instance.trigger("add:"+f.key,a,f.related,e)})},handleRemoval:function(a,d,e){e=e?c.clone(e):{};this.changed=true;c.each(this.getReverseRelations(a),function(a){a.removeRelated(this.instance,null,e)},this);var f=this;!e.silent&&b.Relational.eventQueue.add(function(){f.instance.trigger("remove:"+f.key,a,f.related,e)})},handleReset:function(a,d){var e=this;d=d?c.clone(d):{};!d.silent&&b.Relational.eventQueue.add(function(){e.instance.trigger("reset:"+e.key,e.related,d)})},tryAddRelated:function(a,b,d){var e=c.contains(this.keyIds,a.id);if(e){this.addRelated(a,d);this.keyIds=c.without(this.keyIds,a.id)}},addRelated:function(a,b){var d=this;a.queue(function(){if(d.related&&!d.related.get(a))d.related.add(a,c.defaults({parse:false},b))})},removeRelated:function(a,b,c){if(this.related.get(a))this.related.remove(a,c)}});b.RelationalModel=b.Model.extend({relations:null,_relations:null,_isInitialized:false,_deferProcessing:false,_queue:null,_attributeChangeFired:false,subModelTypeAttribute:"type",subModelTypes:null,constructor:function(a,d){var e,f,g;if(d&&d.collection){e=this,f=this.collection=d.collection;delete d.collection;this._deferProcessing=true;g=function(a){if(a===e){e._deferProcessing=false;e.processQueue();f.off("relational:add",g)}};f.on("relational:add",g);c.defer(function(){g(e)})}b.Relational.store.processOrphanRelations();b.Relational.store.listenTo(this,"relational:unregister",b.Relational.store.unregister);this._queue=new b.BlockingQueue;this._queue.block();b.Relational.eventQueue.block();try{b.Model.apply(this,arguments)}finally{b.Relational.eventQueue.unblock()}},trigger:function(a){if(a.length>5&&0===a.indexOf("change")){var c=this,d=arguments;if(!b.Relational.eventQueue.isBlocked())b.Model.prototype.trigger.apply(c,d);else b.Relational.eventQueue.add(function(){var e,f,g=true;if("change"===a){g=c.hasChanged()||c._attributeChangeFired;c._attributeChangeFired=false}else{e=a.slice(7),f=c.getRelation(e);if(f){g=true===d[4];if(g)c.changed[e]=d[2];else if(!f.changed)delete c.changed[e]}else if(g)c._attributeChangeFired=true}g&&b.Model.prototype.trigger.apply(c,d)})}else if("destroy"===a){b.Model.prototype.trigger.apply(this,arguments);b.Relational.store.unregister(this)}else b.Model.prototype.trigger.apply(this,arguments);return this},initializeRelations:function(a){this.acquire();this._relations={};c.each(this.relations||[],function(c){b.Relational.store.initializeRelation(this,c,a)},this);this._isInitialized=true;this.release();this.processQueue()},updateRelations:function(a,b){if(this._isInitialized&&!this.isLocked())c.each(this._relations,function(c){if(!a||c.keySource in a||c.key in a){var d=this.attributes[c.keySource]||this.attributes[c.key],e=a&&(a[c.keySource]||a[c.key]);if(c.related!==d||null===d&&null===e)this.trigger("relational:change:"+c.key,this,d,b||{})}if(c.keySource!==c.key)delete this.attributes[c.keySource]},this)},queue:function(a){this._queue.add(a)},processQueue:function(){if(this._isInitialized&&!this._deferProcessing&&this._queue.isBlocked())this._queue.unblock()},getRelation:function(a){return this._relations[a]},getRelations:function(){return c.values(this._relations)},getIdsToFetch:function(a,d){var e,f=a instanceof b.Relation?a:this.getRelation(a),g=f?f.keyIds&&f.keyIds.slice(0)||(f.keyId||0===f.keyId?[f.keyId]:[]):[];if(d){e=f.related&&(f.related.models||[f.related]);c.each(e,function(a){if(a.id||0===a.id)g.push(a.id)})}return g},getAsync:function(a,d){var e,f,g,h,i,j,k,l,m,n,o;d=c.extend({add:true,remove:false,refresh:false},d);e=this,f=[],g=this.getRelation(a),h=g&&this.getIdsToFetch(g,d.refresh),i=g.related instanceof b.Collection?g.related:g.relatedCollection;if(h&&h.length){j=[],k=[],m=function(){j=c.map(h,function(a){var b,c=g.relatedModel.findModel(a);if(!c){b={};b[g.relatedModel.prototype.idAttribute]=a;c=g.relatedModel.findOrCreate(b,d);k.push(c)}return c},this)};if(i instanceof b.Collection&&c.isFunction(i.url)){n=i.url();l=i.url(h);if(l===n){m();l=i.url(j);if(l===n)l=null}}if(l){o=c.defaults({error:function(){c.each(k,function(a){a.trigger("destroy",a,a.collection,d)});d.error&&d.error.apply(j,arguments)},url:l},d);f=[i.fetch(o)]}else{if(!j.length)m();f=c.map(j,function(a){var b=c.defaults({error:function(){if(c.contains(k,a))a.trigger("destroy",a,a.collection,d);d.error&&d.error.apply(j,arguments)}},d);return a.fetch(b)},this)}}return this.deferArray(f).then(function(){return b.Model.prototype.get.call(e,a)})},deferArray:function(a){return b.$.when.apply(null,a)},set:function(a,d,e){var f,g,h,i;b.Relational.eventQueue.block();if(c.isObject(a)||null==a){f=a;e=d}else{f={};f[a]=d}try{h=this.id,i=f&&this.idAttribute in f&&f[this.idAttribute];b.Relational.store.checkId(this,i);g=b.Model.prototype.set.apply(this,arguments);if(!this._isInitialized&&!this.isLocked()){this.constructor.initializeModelHierarchy();if(i||0===i)b.Relational.store.register(this);this.initializeRelations(e)}else if(i&&i!==h)b.Relational.store.update(this);if(f)this.updateRelations(f,e)}finally{b.Relational.eventQueue.unblock()}return g},clone:function(){var a=c.clone(this.attributes);if(!c.isUndefined(a[this.idAttribute]))a[this.idAttribute]=null;c.each(this.getRelations(),function(b){delete a[b.key]});return new this.constructor(a)},toJSON:function(a){if(this.isLocked())return this.id;this.acquire();var d=b.Model.prototype.toJSON.call(this,a);if(this.constructor._superModel&&!(this.constructor._subModelTypeAttribute in d))d[this.constructor._subModelTypeAttribute]=this.constructor._subModelTypeValue;
c.each(this._relations,function(e){var f=d[e.key],g=e.options.includeInJSON,h=null;if(true===g){if(f&&c.isFunction(f.toJSON))h=f.toJSON(a)}else if(c.isString(g)){if(f instanceof b.Collection)h=f.pluck(g);else if(f instanceof b.Model)h=f.get(g);if(g===e.relatedModel.prototype.idAttribute)if(e instanceof b.HasMany)h=h.concat(e.keyIds);else if(e instanceof b.HasOne){h=h||e.keyId;if(!h&&!c.isObject(e.keyContents))h=e.keyContents||null}}else if(c.isArray(g)){if(f instanceof b.Collection){h=[];f.each(function(a){var b={};c.each(g,function(c){b[c]=a.get(c)});h.push(b)})}else if(f instanceof b.Model){h={};c.each(g,function(a){h[a]=f.get(a)})}}else delete d[e.key];if(null===h&&a&&a.wait)h=f;if(g)d[e.keyDestination]=h;if(e.keyDestination!==e.key)delete d[e.key]});this.release();return d}},{setup:function(a){this.prototype.relations=(this.prototype.relations||[]).slice(0);this._subModels={};this._superModel=null;if(this.prototype.hasOwnProperty("subModelTypes"))b.Relational.store.addSubModels(this.prototype.subModelTypes,this);else this.prototype.subModelTypes=null;c.each(this.prototype.relations||[],function(a){var d,e;if(!a.model)a.model=this;if(a.reverseRelation&&a.model===this){d=true;if(c.isString(a.relatedModel)){e=b.Relational.store.getObjectByName(a.relatedModel);d=e&&e.prototype instanceof b.RelationalModel}if(d)b.Relational.store.initializeRelation(null,a);else if(c.isString(a.relatedModel))b.Relational.store.addOrphanRelation(a)}},this);return this},build:function(a,b){this.initializeModelHierarchy();var c=this._findSubModelType(this,a)||this;return new c(a,b)},_findSubModelType:function(a,b){var c,d;if(a._subModels&&a.prototype.subModelTypeAttribute in b){c=b[a.prototype.subModelTypeAttribute];d=a._subModels[c];if(d)return d;else for(c in a._subModels){d=this._findSubModelType(a._subModels[c],b);if(d)return d}}return null},initializeModelHierarchy:function(){var a,d;this.inheritRelations();if(this.prototype.subModelTypes){a=c.keys(this._subModels);d=c.omit(this.prototype.subModelTypes,a);c.each(d,function(a){var c=b.Relational.store.getObjectByName(a);c&&c.initializeModelHierarchy()})}},inheritRelations:function(){if(!c.isUndefined(this._superModel)&&!c.isNull(this._superModel))return;b.Relational.store.setupSuperModel(this);if(this._superModel){this._superModel.inheritRelations();if(this._superModel.prototype.relations){var a=c.filter(this._superModel.prototype.relations||[],function(a){return!c.any(this.prototype.relations||[],function(b){return a.relatedModel===b.relatedModel&&a.key===b.key},this)},this);this.prototype.relations=a.concat(this.prototype.relations)}}else this._superModel=false},findOrCreate:function(a,b){var d,e;b||(b={});d=c.isObject(a)&&b.parse&&this.prototype.parse?this.prototype.parse(c.clone(a),b):a;e=this.findModel(d);if(c.isObject(a))if(e&&false!==b.merge){delete b.collection;delete b.url;e.set(d,b)}else if(!e&&false!==b.create)e=this.build(d,c.defaults({parse:false},b));return e},find:function(a,b){b||(b={});b.create=false;return this.findOrCreate(a,b)},findModel:function(a){return b.Relational.store.find(this,a)}});c.extend(b.RelationalModel.prototype,b.Semaphore);b.Collection.prototype.__prepareModel=b.Collection.prototype._prepareModel;b.Collection.prototype._prepareModel=function(a,d){var e;if(a instanceof b.Model){if(!a.collection)a.collection=this;e=a}else{d=d?c.clone(d):{};d.collection=this;if("undefined"!==typeof this.model.findOrCreate)e=this.model.findOrCreate(a,d);else e=new this.model(a,d);if(e&&e.validationError){this.trigger("invalid",this,a,d);e=false}}return e};d=b.Collection.prototype.__set=b.Collection.prototype.set;b.Collection.prototype.set=function(a,e){var f,g,h,i,j,k;if(!(this.model.prototype instanceof b.RelationalModel))return d.call(this,a,e);if(e&&e.parse)a=this.parse(a,e);f=!c.isArray(a),g=[],h=[],i=null;a=f?a?[a]:[]:c.clone(a);for(j=0;j<a.length;j++){i=a[j];if(!(i instanceof b.Model))i=b.Collection.prototype._prepareModel.call(this,i,e);if(i){h.push(i);if(!(this.get(i)||this.get(i.cid)))g.push(i);else if(null!==i.id&&void 0!==i.id)this._byId[i.id]=i}}h=f?h.length?h[0]:null:h;k=d.call(this,h,c.defaults({merge:false,parse:false},e));for(j=0;j<g.length;j++){i=g[j];if(this.get(i)||this.get(i.cid))this.trigger("relational:add",i,this,e)}return k};e=b.Collection.prototype.___removeModels=b.Collection.prototype._removeModels;b.Collection.prototype._removeModels=function(a,d){var f,g;if(!(this.model.prototype instanceof b.RelationalModel))return e.call(this,a,d);f=[];c.each(a,function(a){a=this.get(a)||a&&this.get(a.cid);a&&f.push(a)},this);g=e.call(this,f,d);c.each(f,function(a){this.trigger("relational:remove",a,this,d)},this);return g};f=b.Collection.prototype.__reset=b.Collection.prototype.reset;b.Collection.prototype.reset=function(a,d){d=c.extend({merge:true},d);var e=f.call(this,a,d);if(this.model.prototype instanceof b.RelationalModel)this.trigger("relational:reset",this,d);return e};g=b.Collection.prototype.__sort=b.Collection.prototype.sort;b.Collection.prototype.sort=function(a){var c=g.call(this,a);if(this.model.prototype instanceof b.RelationalModel)this.trigger("relational:reset",this,a);return c};h=b.Collection.prototype.__trigger=b.Collection.prototype.trigger;b.Collection.prototype.trigger=function(a){if(!(this.model.prototype instanceof b.RelationalModel))return h.apply(this,arguments);if("add"===a||"remove"===a||"reset"===a||"sort"===a){var d=this,e=arguments;if(c.isObject(e[3])){e=c.toArray(e);e[3]=c.clone(e[3])}b.Relational.eventQueue.add(function(){h.apply(d,e)})}else h.apply(this,arguments);return this};b.RelationalModel.extend=function(a,c){var d=b.Model.extend.call(this,a,c);d.setup(this);return d}});!function(){"use strict";var a,b,c,d,e,f;function g(a,c){var d,e,f,h,i;c=c||{};this.trackingClick=false;this.trackingClickStart=0;this.targetElement=null;this.touchStartX=0;this.touchStartY=0;this.lastTouchIdentifier=0;this.touchBoundary=c.touchBoundary||10;this.layer=a;this.tapDelay=c.tapDelay||200;this.tapTimeout=c.tapTimeout||700;if(g.notNeeded(a))return;function j(a,b){return function(){return a.apply(b,arguments)}}e=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"];f=this;for(h=0,i=e.length;h<i;h++)f[e[h]]=j(f[e[h]],f);if(b){a.addEventListener("mouseover",this.onMouse,true);a.addEventListener("mousedown",this.onMouse,true);a.addEventListener("mouseup",this.onMouse,true)}a.addEventListener("click",this.onClick,true);a.addEventListener("touchstart",this.onTouchStart,false);a.addEventListener("touchmove",this.onTouchMove,false);a.addEventListener("touchend",this.onTouchEnd,false);a.addEventListener("touchcancel",this.onTouchCancel,false);if(!Event.prototype.stopImmediatePropagation){a.removeEventListener=function(b,c,d){var e=Node.prototype.removeEventListener;if("click"===b)e.call(a,b,c.hijacked||c,d);else e.call(a,b,c,d)};a.addEventListener=function(b,c,d){var e=Node.prototype.addEventListener;if("click"===b)e.call(a,b,c.hijacked||(c.hijacked=function(a){if(!a.propagationStopped)c(a)}),d);else e.call(a,b,c,d)}}if("function"===typeof a.onclick){d=a.onclick;a.addEventListener("click",function(a){d(a)},false);a.onclick=null}}a=navigator.userAgent.indexOf("Windows Phone")>=0;b=navigator.userAgent.indexOf("Android")>0&&!a;c=/iP(ad|hone|od)/.test(navigator.userAgent)&&!a;d=c&&/OS 4_\d(_\d)?/.test(navigator.userAgent);e=c&&/OS [6-7]_\d/.test(navigator.userAgent);f=navigator.userAgent.indexOf("BB10")>0;g.prototype.needsClick=function(a){switch(a.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(a.disabled)return true;break;case"input":if(c&&"file"===a.type||a.disabled)return true;break;case"label":case"iframe":case"video":return true}return/\bneedsclick\b/.test(a.className)};g.prototype.needsFocus=function(a){switch(a.nodeName.toLowerCase()){case"textarea":return true;case"select":return!b;case"input":switch(a.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return false}return!a.disabled&&!a.readOnly;default:return/\bneedsfocus\b/.test(a.className)}};g.prototype.sendClick=function(a,b){var c,d;if(document.activeElement&&document.activeElement!==a)document.activeElement.blur();d=b.changedTouches[0];c=document.createEvent("MouseEvents");c.initMouseEvent(this.determineEventType(a),true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,false,false,false,false,0,null);c.forwardedTouchEvent=true;a.dispatchEvent(c)};g.prototype.determineEventType=function(a){if(b&&"select"===a.tagName.toLowerCase())return"mousedown";return"click"};g.prototype.focus=function(a){var b;if(c&&a.setSelectionRange&&0!==a.type.indexOf("date")&&"time"!==a.type&&"month"!==a.type){b=a.value.length;a.setSelectionRange(b,b)}else a.focus()};g.prototype.updateScrollParent=function(a){var b,c;b=a.fastClickScrollParent;if(!b||!b.contains(a)){c=a;do{if(c.scrollHeight>c.offsetHeight){b=c;a.fastClickScrollParent=c;break}c=c.parentElement}while(c)}if(b)b.fastClickLastScrollTop=b.scrollTop};g.prototype.getTargetElementFromEventTarget=function(a){if(a.nodeType===Node.TEXT_NODE)return a.parentNode;return a};g.prototype.onTouchStart=function(a){var b,e,f;if(a.targetTouches.length>1)return true;b=this.getTargetElementFromEventTarget(a.target);e=a.targetTouches[0];if(c){f=window.getSelection();if(f.rangeCount&&!f.isCollapsed)return true;if(!d){if(e.identifier&&e.identifier===this.lastTouchIdentifier){a.preventDefault();return false}this.lastTouchIdentifier=e.identifier;this.updateScrollParent(b)}}this.trackingClick=true;this.trackingClickStart=a.timeStamp;this.targetElement=b;this.touchStartX=e.pageX;this.touchStartY=e.pageY;if(a.timeStamp-this.lastClickTime<this.tapDelay)a.preventDefault();return true};g.prototype.touchHasMoved=function(a){var b=a.changedTouches[0],c=this.touchBoundary;if(Math.abs(b.pageX-this.touchStartX)>c||Math.abs(b.pageY-this.touchStartY)>c)return true;return false};g.prototype.onTouchMove=function(a){if(!this.trackingClick)return true;if(this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a)){
this.trackingClick=false;this.targetElement=null}return true};g.prototype.findControl=function(a){if(void 0!==a.control)return a.control;if(a.htmlFor)return document.getElementById(a.htmlFor);return a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};g.prototype.onTouchEnd=function(a){var f,g,h,i,j,k=this.targetElement;if(!this.trackingClick)return true;if(a.timeStamp-this.lastClickTime<this.tapDelay){this.cancelNextClick=true;return true}if(a.timeStamp-this.trackingClickStart>this.tapTimeout)return true;this.cancelNextClick=false;this.lastClickTime=a.timeStamp;g=this.trackingClickStart;this.trackingClick=false;this.trackingClickStart=0;if(e){j=a.changedTouches[0];k=document.elementFromPoint(j.pageX-window.pageXOffset,j.pageY-window.pageYOffset)||k;k.fastClickScrollParent=this.targetElement.fastClickScrollParent}h=k.tagName.toLowerCase();if("label"===h){f=this.findControl(k);if(f){this.focus(k);if(b)return false;k=f}}else if(this.needsFocus(k)){if(a.timeStamp-g>100||c&&window.top!==window&&"input"===h){this.targetElement=null;return false}this.focus(k);this.sendClick(k,a);if(!c||"select"!==h){this.targetElement=null;a.preventDefault()}return false}if(c&&!d){i=k.fastClickScrollParent;if(i&&i.fastClickLastScrollTop!==i.scrollTop)return true}if(!this.needsClick(k)){a.preventDefault();this.sendClick(k,a)}return false};g.prototype.onTouchCancel=function(){this.trackingClick=false;this.targetElement=null};g.prototype.onMouse=function(a){if(!this.targetElement)return true;if(a.forwardedTouchEvent)return true;if(!a.cancelable)return true;if(!this.needsClick(this.targetElement)||this.cancelNextClick){if(a.stopImmediatePropagation)a.stopImmediatePropagation();else a.propagationStopped=true;a.stopPropagation();a.preventDefault();return false}return true};g.prototype.onClick=function(a){var b;if(this.trackingClick){this.targetElement=null;this.trackingClick=false;return true}if("submit"===a.target.type&&0===a.detail)return true;b=this.onMouse(a);if(!b)this.targetElement=null;return b};g.prototype.destroy=function(){var a=this.layer;if(b){a.removeEventListener("mouseover",this.onMouse,true);a.removeEventListener("mousedown",this.onMouse,true);a.removeEventListener("mouseup",this.onMouse,true)}a.removeEventListener("click",this.onClick,true);a.removeEventListener("touchstart",this.onTouchStart,false);a.removeEventListener("touchmove",this.onTouchMove,false);a.removeEventListener("touchend",this.onTouchEnd,false);a.removeEventListener("touchcancel",this.onTouchCancel,false)};g.notNeeded=function(a){var c,d,e,g;if("undefined"===typeof window.ontouchstart)return true;d=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(d)if(b){c=document.querySelector("meta[name=viewport]");if(c){if(c.content.indexOf("user-scalable=no")!==-1)return true;if(d>31&&document.documentElement.scrollWidth<=window.outerWidth)return true}}else return true;if(f){e=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/);if(e[1]>=10&&e[2]>=3){c=document.querySelector("meta[name=viewport]");if(c){if(c.content.indexOf("user-scalable=no")!==-1)return true;if(document.documentElement.scrollWidth<=window.outerWidth)return true}}}if("none"===a.style.msTouchAction||"manipulation"===a.style.touchAction)return true;g=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(g>=27){c=document.querySelector("meta[name=viewport]");if(c&&(c.content.indexOf("user-scalable=no")!==-1||document.documentElement.scrollWidth<=window.outerWidth))return true}if("none"===a.style.touchAction||"manipulation"===a.style.touchAction)return true;return false};g.attach=function(a,b){return new g(a,b)};if("function"===typeof define&&"object"===typeof define.amd&&define.amd)define("fastClick",[],function(){return g});else if("undefined"!==typeof module&&module.exports){module.exports=g.attach;module.exports.FastClick=g}else window.FastClick=g}();!function(a,b,c){var d=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)},e=function(){var d,e={},f=b.createElement("div").style,g=function(){for(var a=["t","webkitT","MozT","msT","OT"],b,c=0,d=a.length;c<d;c++){b=a[c]+"ransform";if(b in f)return a[c].substr(0,a[c].length-1)}return false}();function h(a){if(false===g)return false;if(""===g)return a;return g+a.charAt(0).toUpperCase()+a.substr(1)}e.getTime=Date.now||function i(){return(new Date).getTime()};e.extend=function(a,b){for(var c in b)a[c]=b[c]};e.addEvent=function(a,b,c,d){a.addEventListener(b,c,!!d)};e.removeEvent=function(a,b,c,d){a.removeEventListener(b,c,!!d)};e.prefixPointerEvent=function(b){return a.MSPointerEvent?"MSPointer"+b.charAt(9).toUpperCase()+b.substr(10):b};e.momentum=function(a,b,d,e,f,g){var h=a-b,i=c.abs(h)/d,j,k;g=void 0===g?6e-4:g;j=a+i*i/(2*g)*(h<0?-1:1);k=i/g;if(j<e){j=f?e-f/2.5*(i/8):e;h=c.abs(j-a);k=h/i}else if(j>0){j=f?f/2.5*(i/8):0;h=c.abs(a)+j;k=h/i}return{destination:c.round(j),duration:k}};d=h("transform");e.extend(e,{hasTransform:false!==d,hasPerspective:h("perspective")in f,hasTouch:"ontouchstart"in a,hasPointer:a.PointerEvent||a.MSPointerEvent,hasTransition:h("transition")in f});e.isBadAndroid=/Android /.test(a.navigator.appVersion)&&!/Chrome\/\d/.test(a.navigator.appVersion);e.extend(e.style={},{transform:d,transitionTimingFunction:h("transitionTimingFunction"),transitionDuration:h("transitionDuration"),transitionDelay:h("transitionDelay"),transformOrigin:h("transformOrigin")});e.hasClass=function(a,b){var c=new RegExp("(^|\\s)"+b+"(\\s|$)");return c.test(a.className)};e.addClass=function(a,b){if(e.hasClass(a,b))return;var c=a.className.split(" ");c.push(b);a.className=c.join(" ")};e.removeClass=function(a,b){if(!e.hasClass(a,b))return;var c=new RegExp("(^|\\s)"+b+"(\\s|$)","g");a.className=a.className.replace(c," ")};e.offset=function(a){var b=-a.offsetLeft,c=-a.offsetTop;while(a=a.offsetParent){b-=a.offsetLeft;c-=a.offsetTop}return{left:b,top:c}};e.preventDefaultException=function(a,b){for(var c in b)if(b[c].test(a[c]))return true;return false};e.extend(e.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});e.extend(e.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(a){return a*(2-a)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(a){return c.sqrt(1- --a*a)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(a){var b=4;return(a-=1)*a*((b+1)*a+b)+1}},bounce:{style:"",fn:function(a){if((a/=1)<1/2.75)return 7.5625*a*a;else if(a<2/2.75)return 7.5625*(a-=1.5/2.75)*a+.75;else if(a<2.5/2.75)return 7.5625*(a-=2.25/2.75)*a+.9375;else return 7.5625*(a-=2.625/2.75)*a+.984375}},elastic:{style:"",fn:function(a){var b=.22,d=.4;if(0===a)return 0;if(1==a)return 1;return d*c.pow(2,-10*a)*c.sin((a-b/4)*(2*c.PI)/b)+1}}});e.tap=function(a,c){var d=b.createEvent("Event");d.initEvent(c,true,true);d.pageX=a.pageX;d.pageY=a.pageY;a.target.dispatchEvent(d)};e.click=function(a){var c=a.target,d;if(!/(SELECT|INPUT|TEXTAREA)/i.test(c.tagName)){d=b.createEvent("MouseEvents");d.initMouseEvent("click",true,true,a.view,1,c.screenX,c.screenY,c.clientX,c.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null);d._constructed=true;c.dispatchEvent(d)}};return e}();function f(a,c){this.wrapper="string"==typeof a?b.querySelector(a):a;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.options={resizeScrollbars:true,mouseWheelSpeed:20,snapThreshold:.334,startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true};for(var d in c)this.options[d]=c[d];this.translateZ=this.options.HWCompositing&&e.hasPerspective?" translateZ(0)":"";this.options.useTransition=e.hasTransition&&this.options.useTransition;this.options.useTransform=e.hasTransform&&this.options.useTransform;this.options.eventPassthrough=true===this.options.eventPassthrough?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY="vertical"==this.options.eventPassthrough?false:this.options.scrollY;this.options.scrollX="horizontal"==this.options.eventPassthrough?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing="string"==typeof this.options.bounceEasing?e.ease[this.options.bounceEasing]||e.ease.circular:this.options.bounceEasing;this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling;if(true===this.options.tap)this.options.tap="tap";if("scale"==this.options.shrinkScrollbars)this.options.useTransition=false;this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1;this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable()}f.prototype={version:"5.1.3",_init:function(){this._initEvents();if(this.options.scrollbars||this.options.indicators)this._initIndicators();if(this.options.mouseWheel)this._initWheel();if(this.options.snap)this._initSnap();if(this.options.keyBindings)this._initKeys()},destroy:function(){this._initEvents(true);this._execEvent("destroy")},_transitionEnd:function(a){if(a.target!=this.scroller||!this.isInTransition)return;this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd")}},_start:function(a){if(1!=e.eventType[a.type])if(0!==a.button)return;if(!this.enabled||this.initiated&&e.eventType[a.type]!==this.initiated)return;if(this.options.preventDefault&&!e.isBadAndroid&&!e.preventDefaultException(a.target,this.options.preventDefaultException))a.preventDefault();
var b=a.touches?a.touches[0]:a,d;this.initiated=e.eventType[a.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=e.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;d=this.getComputedPosition();this._translate(c.round(d.x),c.round(d.y));this._execEvent("scrollEnd")}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=b.pageX;this.pointY=b.pageY;this._execEvent("beforeScrollStart")},_move:function(a){if(!this.enabled||e.eventType[a.type]!==this.initiated)return;if(this.options.preventDefault)a.preventDefault();var b=a.touches?a.touches[0]:a,d=b.pageX-this.pointX,f=b.pageY-this.pointY,g=e.getTime(),h,i,j,k;this.pointX=b.pageX;this.pointY=b.pageY;this.distX+=d;this.distY+=f;j=c.abs(this.distX);k=c.abs(this.distY);if(g-this.endTime>300&&j<10&&k<10)return;if(!this.directionLocked&&!this.options.freeScroll)if(j>k+this.options.directionLockThreshold)this.directionLocked="h";else if(k>=j+this.options.directionLockThreshold)this.directionLocked="v";else this.directionLocked="n";if("h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)a.preventDefault();else if("horizontal"==this.options.eventPassthrough){this.initiated=false;return}f=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)a.preventDefault();else if("vertical"==this.options.eventPassthrough){this.initiated=false;return}d=0}d=this.hasHorizontalScroll?d:0;f=this.hasVerticalScroll?f:0;h=this.x+d;i=this.y+f;if(h>0||h<this.maxScrollX)h=this.options.bounce?this.x+d/3:h>0?0:this.maxScrollX;if(i>0||i<this.maxScrollY)i=this.options.bounce?this.y+f/3:i>0?0:this.maxScrollY;this.directionX=d>0?-1:d<0?1:0;this.directionY=f>0?-1:f<0?1:0;if(!this.moved)this._execEvent("scrollStart");this.moved=true;this._translate(h,i);if(g-this.startTime>300){this.startTime=g;this.startX=this.x;this.startY=this.y}},_end:function(a){var b,d,f,g,h,i,j,k,l,m,n;if(!this.enabled||e.eventType[a.type]!==this.initiated)return;if(this.options.preventDefault&&!e.preventDefaultException(a.target,this.options.preventDefaultException))a.preventDefault();b=a.changedTouches?a.changedTouches[0]:a,g=e.getTime()-this.startTime,h=c.round(this.x),i=c.round(this.y),j=c.abs(h-this.startX),k=c.abs(i-this.startY),l=0,m="";this.isInTransition=0;this.initiated=0;this.endTime=e.getTime();if(this.resetPosition(this.options.bounceTime))return;this.scrollTo(h,i);if(!this.moved){if(this.options.tap)e.tap(a,this.options.tap);if(this.options.click)e.click(a);this._execEvent("scrollCancel");return}if(this._events.flick&&g<200&&j<100&&k<100){this._execEvent("flick");return}if(this.options.momentum&&g<300){d=this.hasHorizontalScroll?e.momentum(this.x,this.startX,g,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:h,duration:0};f=this.hasVerticalScroll?e.momentum(this.y,this.startY,g,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:i,duration:0};h=d.destination;i=f.destination;l=c.max(d.duration,f.duration);this.isInTransition=1}if(this.options.snap){n=this._nearestSnap(h,i);this.currentPage=n;l=this.options.snapSpeed||c.max(c.max(c.min(c.abs(h-n.x),1e3),c.min(c.abs(i-n.y),1e3)),300);h=n.x;i=n.y;this.directionX=0;this.directionY=0;m=this.options.bounceEasing}if(h!=this.x||i!=this.y){if(h>0||h<this.maxScrollX||i>0||i<this.maxScrollY)m=e.ease.quadratic;this.scrollTo(h,i,l,m);return}this._execEvent("scrollEnd")},_resize:function(){var a=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){a.refresh()},this.options.resizePolling)},resetPosition:function(a){var b=this.x,c=this.y;a=a||0;if(!this.hasHorizontalScroll||this.x>0)b=0;else if(this.x<this.maxScrollX)b=this.maxScrollX;if(!this.hasVerticalScroll||this.y>0)c=0;else if(this.y<this.maxScrollY)c=this.maxScrollY;if(b==this.x&&c==this.y)return false;this.scrollTo(b,c,a,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){var a=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=e.offset(this.wrapper);this._execEvent("refresh");this.resetPosition()},on:function(a,b){if(!this._events[a])this._events[a]=[];this._events[a].push(b)},off:function(a,b){if(!this._events[a])return;var c=this._events[a].indexOf(b);if(c>-1)this._events[a].splice(c,1)},_execEvent:function(a){if(!this._events[a])return;var b=0,c=this._events[a].length;if(!c)return;for(;b<c;b++)this._events[a][b].apply(this,[].slice.call(arguments,1))},scrollBy:function(a,b,c,d){a=this.x+a;b=this.y+b;c=c||0;this.scrollTo(a,b,c,d)},scrollTo:function(a,b,c,d){d=d||e.ease.circular;this.isInTransition=this.options.useTransition&&c>0;if(!c||this.options.useTransition&&d.style){this._transitionTimingFunction(d.style);this._transitionTime(c);this._translate(a,b)}else this._animate(a,b,c,d.fn)},scrollToElement:function(a,b,d,f,g){a=a.nodeType?a:this.scroller.querySelector(a);if(!a)return;var h=e.offset(a);h.left-=this.wrapperOffset.left;h.top-=this.wrapperOffset.top;if(true===d)d=c.round(a.offsetWidth/2-this.wrapper.offsetWidth/2);if(true===f)f=c.round(a.offsetHeight/2-this.wrapper.offsetHeight/2);h.left-=d||0;h.top-=f||0;h.left=h.left>0?0:h.left<this.maxScrollX?this.maxScrollX:h.left;h.top=h.top>0?0:h.top<this.maxScrollY?this.maxScrollY:h.top;b=void 0===b||null===b||"auto"===b?c.max(c.abs(this.x-h.left),c.abs(this.y-h.top)):b;this.scrollTo(h.left,h.top,b,g)},_transitionTime:function(a){a=a||0;this.scrollerStyle[e.style.transitionDuration]=a+"ms";if(!a&&e.isBadAndroid)this.scrollerStyle[e.style.transitionDuration]="0.001s";if(this.indicators)for(var b=this.indicators.length;b--;)this.indicators[b].transitionTime(a)},_transitionTimingFunction:function(a){this.scrollerStyle[e.style.transitionTimingFunction]=a;if(this.indicators)for(var b=this.indicators.length;b--;)this.indicators[b].transitionTimingFunction(a)},_translate:function(a,b){if(this.options.useTransform)this.scrollerStyle[e.style.transform]="translate("+a+"px,"+b+"px)"+this.translateZ;else{a=c.round(a);b=c.round(b);this.scrollerStyle.left=a+"px";this.scrollerStyle.top=b+"px"}this.x=a;this.y=b;if(this.indicators)for(var d=this.indicators.length;d--;)this.indicators[d].updatePosition()},_initEvents:function(b){var c=b?e.removeEvent:e.addEvent,d=this.options.bindToWrapper?this.wrapper:a;c(a,"orientationchange",this);c(a,"resize",this);if(this.options.click)c(this.wrapper,"click",this,true);if(!this.options.disableMouse){c(this.wrapper,"mousedown",this);c(d,"mousemove",this);c(d,"mousecancel",this);c(d,"mouseup",this)}if(e.hasPointer&&!this.options.disablePointer){c(this.wrapper,e.prefixPointerEvent("pointerdown"),this);c(d,e.prefixPointerEvent("pointermove"),this);c(d,e.prefixPointerEvent("pointercancel"),this);c(d,e.prefixPointerEvent("pointerup"),this)}if(e.hasTouch&&!this.options.disableTouch){c(this.wrapper,"touchstart",this);c(d,"touchmove",this);c(d,"touchcancel",this);c(d,"touchend",this)}c(this.scroller,"transitionend",this);c(this.scroller,"webkitTransitionEnd",this);c(this.scroller,"oTransitionEnd",this);c(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var b=a.getComputedStyle(this.scroller,null),c,d;if(this.options.useTransform){b=b[e.style.transform].split(")")[0].split(", ");c=+(b[12]||b[4]);d=+(b[13]||b[5])}else{c=+b.left.replace(/[^-\d.]/g,"");d=+b.top.replace(/[^-\d.]/g,"")}return{x:c,y:d}},_initIndicators:function(){var a,b,c=this.options.interactiveScrollbars,d="string"!=typeof this.options.scrollbars,e=[],f=this;this.indicators=[];if(this.options.scrollbars){if(this.options.scrollY){a={el:g("v",c,this.options.scrollbars),interactive:c,defaultScrollbars:true,customStyle:d,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:false};this.wrapper.appendChild(a.el);e.push(a)}if(this.options.scrollX){a={el:g("h",c,this.options.scrollbars),interactive:c,defaultScrollbars:true,customStyle:d,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:false};this.wrapper.appendChild(a.el);e.push(a)}}if(this.options.indicators)e=e.concat(this.options.indicators);for(b=e.length;b--;)this.indicators.push(new h(this,e[b]));function i(a){for(var b=f.indicators.length;b--;)a.call(f.indicators[b])}if(this.options.fadeScrollbars){this.on("scrollEnd",function(){i(function(){this.fade()})});this.on("scrollCancel",function(){i(function(){this.fade()})});this.on("scrollStart",function(){i(function(){this.fade(1)})});this.on("beforeScrollStart",function(){i(function(){this.fade(1,true)})})}this.on("refresh",function(){i(function(){this.refresh()})});this.on("destroy",function(){i(function(){this.destroy()});delete this.indicators})},_initWheel:function(){e.addEvent(this.wrapper,"wheel",this);e.addEvent(this.wrapper,"mousewheel",this);e.addEvent(this.wrapper,"DOMMouseScroll",this);this.on("destroy",function(){e.removeEvent(this.wrapper,"wheel",this);e.removeEvent(this.wrapper,"mousewheel",this);e.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(a){if(!this.enabled)return;a.preventDefault();
a.stopPropagation();var b,d,e,f,g=this;if(void 0===this.wheelTimeout)g._execEvent("scrollStart");clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){g._execEvent("scrollEnd");g.wheelTimeout=void 0},400);if("deltaX"in a)if(1===a.deltaMode){b=-a.deltaX*this.options.mouseWheelSpeed;d=-a.deltaY*this.options.mouseWheelSpeed}else{b=-a.deltaX;d=-a.deltaY}else if("wheelDeltaX"in a){b=a.wheelDeltaX/120*this.options.mouseWheelSpeed;d=a.wheelDeltaY/120*this.options.mouseWheelSpeed}else if("wheelDelta"in a)b=d=a.wheelDelta/120*this.options.mouseWheelSpeed;else if("detail"in a)b=d=-a.detail/3*this.options.mouseWheelSpeed;else return;b*=this.options.invertWheelDirection;d*=this.options.invertWheelDirection;if(!this.hasVerticalScroll){b=d;d=0}if(this.options.snap){e=this.currentPage.pageX;f=this.currentPage.pageY;if(b>0)e--;else if(b<0)e++;if(d>0)f--;else if(d<0)f++;this.goToPage(e,f);return}e=this.x+c.round(this.hasHorizontalScroll?b:0);f=this.y+c.round(this.hasVerticalScroll?d:0);if(e>0)e=0;else if(e<this.maxScrollX)e=this.maxScrollX;if(f>0)f=0;else if(f<this.maxScrollY)f=this.maxScrollY;this.scrollTo(e,f,0)},_initSnap:function(){this.currentPage={};if("string"==typeof this.options.snap)this.options.snap=this.scroller.querySelectorAll(this.options.snap);this.on("refresh",function(){var a=0,b,d=0,e,f,g,h=0,i,j=this.options.snapStepX||this.wrapperWidth,k=this.options.snapStepY||this.wrapperHeight,l;this.pages=[];if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight)return;if(true===this.options.snap){f=c.round(j/2);g=c.round(k/2);while(h>-this.scrollerWidth){this.pages[a]=[];b=0;i=0;while(i>-this.scrollerHeight){this.pages[a][b]={x:c.max(h,this.maxScrollX),y:c.max(i,this.maxScrollY),width:j,height:k,cx:h-f,cy:i-g};i-=k;b++}h-=j;a++}}else{l=this.options.snap;b=l.length;e=-1;for(;a<b;a++){if(0===a||l[a].offsetLeft<=l[a-1].offsetLeft){d=0;e++}if(!this.pages[d])this.pages[d]=[];h=c.max(-l[a].offsetLeft,this.maxScrollX);i=c.max(-l[a].offsetTop,this.maxScrollY);f=h-c.round(l[a].offsetWidth/2);g=i-c.round(l[a].offsetHeight/2);this.pages[d][e]={x:h,y:i,width:l[a].offsetWidth,height:l[a].offsetHeight,cx:f,cy:g};if(h>this.maxScrollX)d++}}this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0);if(this.options.snapThreshold%1===0){this.snapThresholdX=this.options.snapThreshold;this.snapThresholdY=this.options.snapThreshold}else{this.snapThresholdX=c.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold);this.snapThresholdY=c.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold)}});this.on("flick",function(){var a=this.options.snapSpeed||c.max(c.max(c.min(c.abs(this.x-this.startX),1e3),c.min(c.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,a)})},_nearestSnap:function(a,b){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var d=0,e=this.pages.length,f=0;if(c.abs(a-this.absStartX)<this.snapThresholdX&&c.abs(b-this.absStartY)<this.snapThresholdY)return this.currentPage;if(a>0)a=0;else if(a<this.maxScrollX)a=this.maxScrollX;if(b>0)b=0;else if(b<this.maxScrollY)b=this.maxScrollY;for(;d<e;d++)if(a>=this.pages[d][0].cx){a=this.pages[d][0].x;break}e=this.pages[d].length;for(;f<e;f++)if(b>=this.pages[0][f].cy){b=this.pages[0][f].y;break}if(d==this.currentPage.pageX){d+=this.directionX;if(d<0)d=0;else if(d>=this.pages.length)d=this.pages.length-1;a=this.pages[d][0].x}if(f==this.currentPage.pageY){f+=this.directionY;if(f<0)f=0;else if(f>=this.pages[0].length)f=this.pages[0].length-1;b=this.pages[0][f].y}return{x:a,y:b,pageX:d,pageY:f}},goToPage:function(a,b,d,e){e=e||this.options.bounceEasing;if(a>=this.pages.length)a=this.pages.length-1;else if(a<0)a=0;if(b>=this.pages[a].length)b=this.pages[a].length-1;else if(b<0)b=0;var f=this.pages[a][b].x,g=this.pages[a][b].y;d=void 0===d?this.options.snapSpeed||c.max(c.max(c.min(c.abs(f-this.x),1e3),c.min(c.abs(g-this.y),1e3)),300):d;this.currentPage={x:f,y:g,pageX:a,pageY:b};this.scrollTo(f,g,d,e)},next:function(a,b){var c=this.currentPage.pageX,d=this.currentPage.pageY;c++;if(c>=this.pages.length&&this.hasVerticalScroll){c=0;d++}this.goToPage(c,d,a,b)},prev:function(a,b){var c=this.currentPage.pageX,d=this.currentPage.pageY;c--;if(c<0&&this.hasVerticalScroll){c=0;d--}this.goToPage(c,d,a,b)},_initKeys:function(b){var c,d={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings){for(c in this.options.keyBindings)if("string"==typeof this.options.keyBindings[c])this.options.keyBindings[c]=this.options.keyBindings[c].toUpperCase().charCodeAt(0)}else this.options.keyBindings={};for(c in d)this.options.keyBindings[c]=this.options.keyBindings[c]||d[c];e.addEvent(a,"keydown",this);this.on("destroy",function(){e.removeEvent(a,"keydown",this)})},_key:function(a){if(!this.enabled)return;var b=this.options.snap,d=b?this.currentPage.pageX:this.x,f=b?this.currentPage.pageY:this.y,g=e.getTime(),h=this.keyTime||0,i=.25,j;if(this.options.useTransition&&this.isInTransition){j=this.getComputedPosition();this._translate(c.round(j.x),c.round(j.y));this.isInTransition=false}this.keyAcceleration=g-h<200?c.min(this.keyAcceleration+i,50):0;switch(a.keyCode){case this.options.keyBindings.pageUp:if(this.hasHorizontalScroll&&!this.hasVerticalScroll)d+=b?1:this.wrapperWidth;else f+=b?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:if(this.hasHorizontalScroll&&!this.hasVerticalScroll)d-=b?1:this.wrapperWidth;else f-=b?1:this.wrapperHeight;break;case this.options.keyBindings.end:d=b?this.pages.length-1:this.maxScrollX;f=b?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:d=0;f=0;break;case this.options.keyBindings.left:d+=b?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:f+=b?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:d-=b?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:f-=b?1:5+this.keyAcceleration>>0;break;default:return}if(b){this.goToPage(d,f);return}if(d>0){d=0;this.keyAcceleration=0}else if(d<this.maxScrollX){d=this.maxScrollX;this.keyAcceleration=0}if(f>0){f=0;this.keyAcceleration=0}else if(f<this.maxScrollY){f=this.maxScrollY;this.keyAcceleration=0}this.scrollTo(d,f,0);this.keyTime=g},_animate:function(a,b,c,f){var g=this,h=this.x,i=this.y,j=e.getTime(),k=j+c;function l(){var m=e.getTime(),n,o,p;if(m>=k){g.isAnimating=false;g._translate(a,b);if(!g.resetPosition(g.options.bounceTime))g._execEvent("scrollEnd");return}m=(m-j)/c;p=f(m);n=(a-h)*p+h;o=(b-i)*p+i;g._translate(n,o);if(g.isAnimating)d(l)}this.isAnimating=true;l()},handleEvent:function(a){switch(a.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(a);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(a);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(a);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(a);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(a);break;case"keydown":this._key(a);break;case"click":if(!a._constructed){a.preventDefault();a.stopPropagation()}}}};function g(a,c,d){var e=b.createElement("div"),f=b.createElement("div");if(true===d){e.style.cssText="position:absolute;z-index:9999";f.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"}f.className="iScrollIndicator";if("h"==a){if(true===d){e.style.cssText+=";height:7px;left:2px;right:2px;bottom:0";f.style.height="100%"}e.className="iScrollHorizontalScrollbar"}else{if(true===d){e.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px";f.style.width="100%"}e.className="iScrollVerticalScrollbar"}e.style.cssText+=";overflow:hidden";if(!c)e.style.pointerEvents="none";e.appendChild(f);return e}function h(c,d){this.wrapper="string"==typeof d.el?b.querySelector(d.el):d.el;this.wrapperStyle=this.wrapper.style;this.indicator=this.wrapper.children[0];this.indicatorStyle=this.indicator.style;this.scroller=c;this.options={listenX:true,listenY:true,interactive:false,resize:true,defaultScrollbars:false,shrink:false,fade:false,speedRatioX:0,speedRatioY:0};for(var f in d)this.options[f]=d[f];this.sizeRatioX=1;this.sizeRatioY=1;this.maxPosX=0;this.maxPosY=0;if(this.options.interactive){if(!this.options.disableTouch){e.addEvent(this.indicator,"touchstart",this);e.addEvent(a,"touchend",this)}if(!this.options.disablePointer){e.addEvent(this.indicator,e.prefixPointerEvent("pointerdown"),this);e.addEvent(a,e.prefixPointerEvent("pointerup"),this)}if(!this.options.disableMouse){e.addEvent(this.indicator,"mousedown",this);e.addEvent(a,"mouseup",this)}}if(this.options.fade){this.wrapperStyle[e.style.transform]=this.scroller.translateZ;this.wrapperStyle[e.style.transitionDuration]=e.isBadAndroid?"0.001s":"0ms";this.wrapperStyle.opacity="0"}}h.prototype={handleEvent:function(a){switch(a.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(a);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(a);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(a)}},destroy:function(){if(this.options.interactive){e.removeEvent(this.indicator,"touchstart",this);e.removeEvent(this.indicator,e.prefixPointerEvent("pointerdown"),this);e.removeEvent(this.indicator,"mousedown",this);e.removeEvent(a,"touchmove",this);e.removeEvent(a,e.prefixPointerEvent("pointermove"),this);e.removeEvent(a,"mousemove",this);e.removeEvent(a,"touchend",this);
e.removeEvent(a,e.prefixPointerEvent("pointerup"),this);e.removeEvent(a,"mouseup",this)}if(this.options.defaultScrollbars)this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(b){var c=b.touches?b.touches[0]:b;b.preventDefault();b.stopPropagation();this.transitionTime();this.initiated=true;this.moved=false;this.lastPointX=c.pageX;this.lastPointY=c.pageY;this.startTime=e.getTime();if(!this.options.disableTouch)e.addEvent(a,"touchmove",this);if(!this.options.disablePointer)e.addEvent(a,e.prefixPointerEvent("pointermove"),this);if(!this.options.disableMouse)e.addEvent(a,"mousemove",this);this.scroller._execEvent("beforeScrollStart")},_move:function(a){var b=a.touches?a.touches[0]:a,c,d,f,g,h=e.getTime();if(!this.moved)this.scroller._execEvent("scrollStart");this.moved=true;c=b.pageX-this.lastPointX;this.lastPointX=b.pageX;d=b.pageY-this.lastPointY;this.lastPointY=b.pageY;f=this.x+c;g=this.y+d;this._pos(f,g);a.preventDefault();a.stopPropagation()},_end:function(b){var d,f;if(!this.initiated)return;this.initiated=false;b.preventDefault();b.stopPropagation();e.removeEvent(a,"touchmove",this);e.removeEvent(a,e.prefixPointerEvent("pointermove"),this);e.removeEvent(a,"mousemove",this);if(this.scroller.options.snap){d=this.scroller._nearestSnap(this.scroller.x,this.scroller.y);f=this.options.snapSpeed||c.max(c.max(c.min(c.abs(this.scroller.x-d.x),1e3),c.min(c.abs(this.scroller.y-d.y),1e3)),300);if(this.scroller.x!=d.x||this.scroller.y!=d.y){this.scroller.directionX=0;this.scroller.directionY=0;this.scroller.currentPage=d;this.scroller.scrollTo(d.x,d.y,f,this.scroller.options.bounceEasing)}}if(this.moved)this.scroller._execEvent("scrollEnd")},transitionTime:function(a){a=a||0;this.indicatorStyle[e.style.transitionDuration]=a+"ms";if(!a&&e.isBadAndroid)this.indicatorStyle[e.style.transitionDuration]="0.001s"},transitionTimingFunction:function(a){this.indicatorStyle[e.style.transitionTimingFunction]=a},refresh:function(){this.transitionTime();if(this.options.listenX&&!this.options.listenY)this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none";else if(this.options.listenY&&!this.options.listenX)this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none";else this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none";if(this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll){e.addClass(this.wrapper,"iScrollBothScrollbars");e.removeClass(this.wrapper,"iScrollLoneScrollbar");if(this.options.defaultScrollbars&&this.options.customStyle)if(this.options.listenX)this.wrapper.style.right="8px";else this.wrapper.style.bottom="8px"}else{e.removeClass(this.wrapper,"iScrollBothScrollbars");e.addClass(this.wrapper,"iScrollLoneScrollbar");if(this.options.defaultScrollbars&&this.options.customStyle)if(this.options.listenX)this.wrapper.style.right="2px";else this.wrapper.style.bottom="2px"}var a=this.wrapper.offsetHeight;if(this.options.listenX){this.wrapperWidth=this.wrapper.clientWidth;if(this.options.resize){this.indicatorWidth=c.max(c.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8);this.indicatorStyle.width=this.indicatorWidth+"px"}else this.indicatorWidth=this.indicator.clientWidth;this.maxPosX=this.wrapperWidth-this.indicatorWidth;if("clip"==this.options.shrink){this.minBoundaryX=-this.indicatorWidth+8;this.maxBoundaryX=this.wrapperWidth-8}else{this.minBoundaryX=0;this.maxBoundaryX=this.maxPosX}this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX}if(this.options.listenY){this.wrapperHeight=this.wrapper.clientHeight;if(this.options.resize){this.indicatorHeight=c.max(c.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8);this.indicatorStyle.height=this.indicatorHeight+"px"}else this.indicatorHeight=this.indicator.clientHeight;this.maxPosY=this.wrapperHeight-this.indicatorHeight;if("clip"==this.options.shrink){this.minBoundaryY=-this.indicatorHeight+8;this.maxBoundaryY=this.wrapperHeight-8}else{this.minBoundaryY=0;this.maxBoundaryY=this.maxPosY}this.maxPosY=this.wrapperHeight-this.indicatorHeight;this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY}this.updatePosition()},updatePosition:function(){var a=this.options.listenX&&c.round(this.sizeRatioX*this.scroller.x)||0,b=this.options.listenY&&c.round(this.sizeRatioY*this.scroller.y)||0;if(!this.options.ignoreBoundaries){if(a<this.minBoundaryX){if("scale"==this.options.shrink){this.width=c.max(this.indicatorWidth+a,8);this.indicatorStyle.width=this.width+"px"}a=this.minBoundaryX}else if(a>this.maxBoundaryX)if("scale"==this.options.shrink){this.width=c.max(this.indicatorWidth-(a-this.maxPosX),8);this.indicatorStyle.width=this.width+"px";a=this.maxPosX+this.indicatorWidth-this.width}else a=this.maxBoundaryX;else if("scale"==this.options.shrink&&this.width!=this.indicatorWidth){this.width=this.indicatorWidth;this.indicatorStyle.width=this.width+"px"}if(b<this.minBoundaryY){if("scale"==this.options.shrink){this.height=c.max(this.indicatorHeight+3*b,8);this.indicatorStyle.height=this.height+"px"}b=this.minBoundaryY}else if(b>this.maxBoundaryY)if("scale"==this.options.shrink){this.height=c.max(this.indicatorHeight-3*(b-this.maxPosY),8);this.indicatorStyle.height=this.height+"px";b=this.maxPosY+this.indicatorHeight-this.height}else b=this.maxBoundaryY;else if("scale"==this.options.shrink&&this.height!=this.indicatorHeight){this.height=this.indicatorHeight;this.indicatorStyle.height=this.height+"px"}}this.x=a;this.y=b;if(this.scroller.options.useTransform)this.indicatorStyle[e.style.transform]="translate("+a+"px,"+b+"px)"+this.scroller.translateZ;else{this.indicatorStyle.left=a+"px";this.indicatorStyle.top=b+"px"}},_pos:function(a,b){if(a<0)a=0;else if(a>this.maxPosX)a=this.maxPosX;if(b<0)b=0;else if(b>this.maxPosY)b=this.maxPosY;a=this.options.listenX?c.round(a/this.sizeRatioX):this.scroller.x;b=this.options.listenY?c.round(b/this.sizeRatioY):this.scroller.y;this.scroller.scrollTo(a,b)},fade:function(a,b){if(b&&!this.visible)return;clearTimeout(this.fadeTimeout);this.fadeTimeout=null;var c=a?250:500,d=a?0:300;a=a?"1":"0";this.wrapperStyle[e.style.transitionDuration]=c+"ms";this.fadeTimeout=setTimeout(function(a){this.wrapperStyle.opacity=a;this.visible=+a}.bind(this,a),d)}};f.utils=e;if("undefined"!=typeof module&&module.exports)module.exports=f;else a.IScroll=f}(window,document,Math);define("segmentation",["jquery","cookie","globals","logger"],function(a,b,c,d){var e={cookieName:"SEGMENT",ajaxTimeout:3e3,service:void 0};e.decode=function(b){var c,d,e={};try{b=a.parseJSON(b).EXPERIMENT;for(c=0,d=b.length;c<d;c++)e[b[c]]=b[c]}catch(f){}return e};e.reset=function(a){b.remove(this.cookieName);this.data=void 0;this.fetch(a)};e.getCookie=function(){var a,c,e=window.location;c=e.search.match(/[?|&]experiment=([^&]+)/)||e.search.match(/[?|&]segment=([^&]+)/);if(c){d.log("Overriding experimentation.");return this.decode('{"EXPERIMENT":['+c[1]+"]}")}a=b.get(this.cookieName);if(a)return this.decode(a)};e.fetch=function(c){var d=this;a.ajax({url:this.service+"/campaign/sync",dataType:"jsonp",cache:true,timeout:this.ajaxTimeout}).always(function(a){var e,f,g;if("undefined"!==typeof a&&"undefined"===typeof a.always){e=JSON.stringify(a);b.set("SEGMENT",e);d.set(d.decode(e))}else d.set(d.getCookie()||{});if(d.queue){for(f=0,g=d.queue.length;f<g;f++)d.queue[f](d.data);delete d.queue}if("function"===typeof c)c(d.data)})};e.set=function(a){this.data=a};e.list=function(a){if(this.queue){if("function"===typeof a)this.queue.push(a);return}if(!this.data)this.set(this.getCookie());if(this.data)return"function"===typeof a&&a(this.data);this.queue=[];this.fetch(a)};e.detect=function(d,f){e.service=c.getValue("props.segmentationHost");var g=b.get("QE_TEST");if(g&&g.includes("mercury1_92_false")){b.remove("SEGMENT");if("function"===typeof f)f();return}e.list(function(b){if("string"===typeof d)d=d.split(/[\s,]+/);if(!a.isArray(d))d=[d];for(var c=0,e=d.length;c<e;c++)if(b[d[c]])return"function"===typeof f&&f(d[c]);if("function"===typeof f)f()})};return{detect:e.detect}});!function(a,b){var c,d;if("function"===typeof define&&define.amd)define("backbone.wreqr",["backbone","underscore"],function(a,c){return b(a,c)});else if("undefined"!==typeof exports){c=require("backbone");d=require("underscore");module.exports=b(c,d)}else b(a.Backbone,a._)}(this,function(a,b){"use strict";var c=a.Wreqr,d=a.Wreqr={};a.Wreqr.VERSION="1.3.5";a.Wreqr.noConflict=function(){a.Wreqr=c;return this};d.Handlers=function(a,b){var c=function(a){this.options=a;this._wreqrHandlers={};if(b.isFunction(this.initialize))this.initialize(a)};c.extend=a.Model.extend;b.extend(c.prototype,a.Events,{setHandlers:function(a){b.each(a,function(a,c){var d=null;if(b.isObject(a)&&!b.isFunction(a)){d=a.context;a=a.callback}this.setHandler(c,a,d)},this)},setHandler:function(a,b,c){var d={callback:b,context:c};this._wreqrHandlers[a]=d;this.trigger("handler:add",a,b,c)},hasHandler:function(a){return!!this._wreqrHandlers[a]},getHandler:function(a){var b=this._wreqrHandlers[a];if(!b)return;return function(){return b.callback.apply(b.context,arguments)}},removeHandler:function(a){delete this._wreqrHandlers[a]},removeAllHandlers:function(){this._wreqrHandlers={}}});return c}(a,b);d.CommandStorage=function(){var c=function(a){this.options=a;this._commands={};if(b.isFunction(this.initialize))this.initialize(a)};b.extend(c.prototype,a.Events,{getCommands:function(a){var b=this._commands[a];if(!b){b={command:a,instances:[]};this._commands[a]=b}return b},addCommand:function(a,b){var c=this.getCommands(a);c.instances.push(b)},clearCommands:function(a){var b=this.getCommands(a);b.instances=[]}});return c}();d.Commands=function(a,b){return a.Handlers.extend({storageType:a.CommandStorage,constructor:function(b){this.options=b||{};this._initializeStorage(this.options);this.on("handler:add",this._executeCommands,this);
a.Handlers.prototype.constructor.apply(this,arguments)},execute:function(a){a=arguments[0];var c=b.rest(arguments);if(this.hasHandler(a))this.getHandler(a).apply(this,c);else this.storage.addCommand(a,c)},_executeCommands:function(a,c,d){var e=this.storage.getCommands(a);b.each(e.instances,function(a){c.apply(d,a)});this.storage.clearCommands(a)},_initializeStorage:function(a){var c,d=a.storageType||this.storageType;if(b.isFunction(d))c=new d;else c=d;this.storage=c}})}(d,b);d.RequestResponse=function(a,b){return a.Handlers.extend({request:function(a){if(this.hasHandler(a))return this.getHandler(a).apply(this,b.rest(arguments))}})}(d,b);d.EventAggregator=function(a,b){var c=function(){};c.extend=a.Model.extend;b.extend(c.prototype,a.Events);return c}(a,b);d.Channel=function(c){var d=function(b){this.vent=new a.Wreqr.EventAggregator;this.reqres=new a.Wreqr.RequestResponse;this.commands=new a.Wreqr.Commands;this.channelName=b};b.extend(d.prototype,{reset:function(){this.vent.off();this.vent.stopListening();this.reqres.removeAllHandlers();this.commands.removeAllHandlers();return this},connectEvents:function(a,b){this._connect("vent",a,b);return this},connectCommands:function(a,b){this._connect("commands",a,b);return this},connectRequests:function(a,b){this._connect("reqres",a,b);return this},_connect:function(a,c,d){if(!c)return;d=d||this;var e="vent"===a?"on":"setHandler";b.each(c,function(c,f){this[a][e](f,b.bind(c,d))},this)}});return d}(d);d.radio=function(a,b){var c,d,e=function(){this._channels={};this.vent={};this.commands={};this.reqres={};this._proxyMethods()};b.extend(e.prototype,{channel:function(a){if(!a)throw new Error("Channel must receive a name");return this._getChannel(a)},_getChannel:function(b){var c=this._channels[b];if(!c){c=new a.Channel(b);this._channels[b]=c}return c},_proxyMethods:function(){b.each(["vent","commands","reqres"],function(a){b.each(c[a],function(b){this[a][b]=d(this,a,b)},this)},this)}});c={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]};d=function(a,c,d){return function(e){var f=a._getChannel(e)[c];return f[d].apply(f,b.rest(arguments))}};return new e}(d,b);return a.Wreqr});!function(a,b){var c,d;if("function"===typeof define&&define.amd)define("backbone.babysitter",["backbone","underscore"],function(a,c){return b(a,c)});else if("undefined"!==typeof exports){c=require("backbone");d=require("underscore");module.exports=b(c,d)}else b(a.Backbone,a._)}(this,function(a,b){"use strict";var c=a.ChildViewContainer;a.ChildViewContainer=function(a,b){var c,d=function(a){this._views={};this._indexByModel={};this._indexByCustom={};this._updateLength();b.each(a,this.add,this)};b.extend(d.prototype,{add:function(a,b){var c=a.cid;this._views[c]=a;if(a.model)this._indexByModel[a.model.cid]=c;if(b)this._indexByCustom[b]=c;this._updateLength();return this},findByModel:function(a){return this.findByModelCid(a.cid)},findByModelCid:function(a){var b=this._indexByModel[a];return this.findByCid(b)},findByCustom:function(a){var b=this._indexByCustom[a];return this.findByCid(b)},findByIndex:function(a){return b.values(this._views)[a]},findByCid:function(a){return this._views[a]},remove:function(a){var c=a.cid;if(a.model)delete this._indexByModel[a.model.cid];b.any(this._indexByCustom,function(a,b){if(a===c){delete this._indexByCustom[b];return true}},this);delete this._views[c];this._updateLength();return this},call:function(a){this.apply(a,b.tail(arguments))},apply:function(a,c){b.each(this._views,function(d){if(b.isFunction(d[a]))d[a].apply(d,c||[])})},_updateLength:function(){this.length=b.size(this._views)}});c=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];b.each(c,function(a){d.prototype[a]=function(){var c=b.values(this._views),d=[c].concat(b.toArray(arguments));return b[a].apply(b,d)}});return d}(a,b);a.ChildViewContainer.VERSION="0.1.10";a.ChildViewContainer.noConflict=function(){a.ChildViewContainer=c;return this};return a.ChildViewContainer});!function(a,b){var c,d,e,f;if("function"===typeof define&&define.amd)define("marionette",["backbone","underscore","backbone.wreqr","backbone.babysitter"],function(c,d){return a.Marionette=a.Mn=b(a,c,d)});else if("undefined"!==typeof exports){c=require("backbone");d=require("underscore");e=require("backbone.wreqr");f=require("backbone.babysitter");module.exports=b(a,c,d)}else a.Marionette=a.Mn=b(a,a.Backbone,a._)}(this,function(a,b,c){"use strict";var d,e,f=a.Marionette,g=a.Mn,h=b.Marionette={};h.VERSION="2.4.4";h.noConflict=function(){a.Marionette=f;a.Mn=g;return this};h.Deferred=b.$.Deferred;h.FEATURES={};h.isEnabled=function(a){return!!h.FEATURES[a]};h.extend=b.Model.extend;h.isNodeAttached=function(a){return b.$.contains(document.documentElement,a)};h.mergeOptions=function(a,b){if(!a)return;c.extend(this,c.pick(a,b))};h.getOption=function(a,b){if(!a||!b)return;if(a.options&&void 0!==a.options[b])return a.options[b];else return a[b]};h.proxyGetOption=function(a){return h.getOption(this,a)};h._getValue=function(a,b,d){if(c.isFunction(a))a=d?a.apply(b,d):a.call(b);return a};h.normalizeMethods=function(a){return c.reduce(a,function(a,b,d){if(!c.isFunction(b))b=this[b];if(b)a[d]=b;return a},{},this)};h.normalizeUIString=function(a,b){return a.replace(/@ui\.[a-zA-Z_$0-9]*/g,function(a){return b[a.slice(4)]})};h.normalizeUIKeys=function(a,b){return c.reduce(a,function(a,c,d){var e=h.normalizeUIString(d,b);a[e]=c;return a},{})};h.normalizeUIValues=function(a,b,d){c.each(a,function(e,f){if(c.isString(e))a[f]=h.normalizeUIString(e,b);else if(c.isObject(e)&&c.isArray(d)){c.extend(e,h.normalizeUIValues(c.pick(e,d),b));c.each(d,function(a){var d=e[a];if(c.isString(d))e[a]=h.normalizeUIString(d,b)})}});return a};h.actAsCollection=function(a,b){var d=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];c.each(d,function(d){a[d]=function(){var a=c.values(c.result(this,b)),e=[a].concat(c.toArray(arguments));return c[d].apply(c,e)}})};d=h.deprecate=function(a,b){if(c.isObject(a))a=a.prev+" is going to be removed in the future. "+"Please use "+a.next+" instead."+(a.url?" See: "+a.url:"");if((void 0===b||!b)&&!d._cache[a]){d._warn("Deprecation warning: "+a);d._cache[a]=true}};d._warn="undefined"!==typeof console&&(console.warn||console.log)||function(){};d._cache={};h._triggerMethod=function(){var a=/(^|:)(\w)/gi;function b(a,b,c){return c.toUpperCase()}return function(d,e,f){var g,h,i,j=arguments.length<3;if(j){f=e;e=f[0]}g="on"+e.replace(a,b);h=d[g];if(c.isFunction(h))i=h.apply(d,j?c.rest(f):f);if(c.isFunction(d.trigger))if(j+f.length>1)d.trigger.apply(d,j?f:[e].concat(c.drop(f,0)));else d.trigger(e);return i}}();h.triggerMethod=function(a){return h._triggerMethod(this,arguments)};h.triggerMethodOn=function(a){var b=c.isFunction(a.triggerMethod)?a.triggerMethod:h.triggerMethod;return b.apply(a,c.rest(arguments))};h.MonitorDOMRefresh=function(a){if(a._isDomRefreshMonitored)return;a._isDomRefreshMonitored=true;function b(){a._isShown=true;d()}function c(){a._isRendered=true;d()}function d(){if(a._isShown&&a._isRendered&&h.isNodeAttached(a.el))h.triggerMethodOn(a,"dom:refresh",a)}a.on({show:b,render:c})};!function(a){function b(b,d,e,f){var g=f.split(/\s+/);c.each(g,function(c){var f=b[c];if(!f)throw new a.Error('Method "'+c+'" was configured as an event handler, but does not exist.');b.listenTo(d,e,f)})}function d(a,b,c,d){a.listenTo(b,c,d)}function e(a,b,d,e){var f=e.split(/\s+/);c.each(f,function(c){var e=a[c];a.stopListening(b,d,e)})}function f(a,b,c,d){a.stopListening(b,c,d)}function g(b,d,e,f,g){if(!d||!e)return;if(!c.isObject(e))throw new a.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});e=a._getValue(e,b);c.each(e,function(a,e){if(c.isFunction(a))f(b,d,e,a);else g(b,d,e,a)})}a.bindEntityEvents=function(a,c,e){g(a,c,e,d,b)};a.unbindEntityEvents=function(a,b,c){g(a,b,c,f,e)};a.proxyBindEntityEvents=function(b,c){return a.bindEntityEvents(this,b,c)};a.proxyUnbindEntityEvents=function(b,c){return a.unbindEntityEvents(this,b,c)}}(h);e=["description","fileName","lineNumber","name","message","number"];h.Error=h.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+h.VERSION+"/",constructor:function(a,b){if(c.isObject(a)){b=a;a=b.message}else if(!b)b={};var d=Error.call(this,a);c.extend(this,c.pick(d,e),c.pick(b,e));this.captureStackTrace();if(b.url)this.url=this.urlRoot+b.url},captureStackTrace:function(){if(Error.captureStackTrace)Error.captureStackTrace(this,h.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}});h.Error.extend=h.extend;h.Callbacks=function(){this._deferred=h.Deferred();this._callbacks=[]};c.extend(h.Callbacks.prototype,{add:function(a,b){var d=c.result(this._deferred,"promise");this._callbacks.push({cb:a,ctx:b});d.then(function(c){if(b)c.context=b;a.call(c.context,c.options)})},run:function(a,b){this._deferred.resolve({options:a,context:b})},reset:function(){var a=this._callbacks;this._deferred=h.Deferred();this._callbacks=[];c.each(a,function(a){this.add(a.cb,a.ctx)},this)}});h.Controller=function(a){this.options=a||{};if(c.isFunction(this.initialize))this.initialize(this.options)};h.Controller.extend=h.extend;c.extend(h.Controller.prototype,b.Events,{destroy:function(){h._triggerMethod(this,"before:destroy",arguments);h._triggerMethod(this,"destroy",arguments);this.stopListening();this.off();return this},triggerMethod:h.triggerMethod,mergeOptions:h.mergeOptions,getOption:h.proxyGetOption});h.Object=function(a){this.options=c.extend({},c.result(this,"options"),a);
this.initialize.apply(this,arguments)};h.Object.extend=h.extend;c.extend(h.Object.prototype,b.Events,{initialize:function(){},destroy:function(a){a=a||{};this.triggerMethod("before:destroy",a);this.triggerMethod("destroy",a);this.stopListening();return this},triggerMethod:h.triggerMethod,mergeOptions:h.mergeOptions,getOption:h.proxyGetOption,bindEntityEvents:h.proxyBindEntityEvents,unbindEntityEvents:h.proxyUnbindEntityEvents});h.Region=h.Object.extend({constructor:function(a){this.options=a||{};this.el=this.getOption("el");this.el=this.el instanceof b.$?this.el[0]:this.el;if(!this.el)throw new h.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el);h.Object.call(this,a)},show:function(a,b){var d,e,f,g,i,j,k,l,m,n;if(!this._ensureElement())return;this._ensureViewIsIntact(a);h.MonitorDOMRefresh(a);d=b||{};e=a!==this.currentView;f=!!d.preventDestroy;g=!!d.forceShow;i=!!this.currentView;j=e&&!f;k=e||g;if(i)this.triggerMethod("before:swapOut",this.currentView,this,b);if(this.currentView)delete this.currentView._parent;if(j)this.empty();else if(i&&k)this.currentView.off("destroy",this.empty,this);if(k){a.once("destroy",this.empty,this);a._parent=this;this._renderView(a);if(i)this.triggerMethod("before:swap",a,this,b);this.triggerMethod("before:show",a,this,b);h.triggerMethodOn(a,"before:show",a,this,b);if(i)this.triggerMethod("swapOut",this.currentView,this,b);l=h.isNodeAttached(this.el);m=[];n=c.extend({triggerBeforeAttach:this.triggerBeforeAttach,triggerAttach:this.triggerAttach},d);if(l&&n.triggerBeforeAttach){m=this._displayedViews(a);this._triggerAttach(m,"before:")}this.attachHtml(a);this.currentView=a;if(l&&n.triggerAttach){m=this._displayedViews(a);this._triggerAttach(m)}if(i)this.triggerMethod("swap",a,this,b);this.triggerMethod("show",a,this,b);h.triggerMethodOn(a,"show",a,this,b);return this}return this},triggerBeforeAttach:true,triggerAttach:true,_triggerAttach:function(a,b){var d=(b||"")+"attach";c.each(a,function(a){h.triggerMethodOn(a,d,a,this)},this)},_displayedViews:function(a){return c.union([a],c.result(a,"_getNestedViews")||[])},_renderView:function(a){if(!a.supportsRenderLifecycle)h.triggerMethodOn(a,"before:render",a);a.render();if(!a.supportsRenderLifecycle)h.triggerMethodOn(a,"render",a)},_ensureElement:function(){if(!c.isObject(this.el)){this.$el=this.getEl(this.el);this.el=this.$el[0]}if(!this.$el||0===this.$el.length)if(this.getOption("allowMissingEl"))return false;else throw new h.Error('An "el" '+this.$el.selector+" must exist in DOM");return true},_ensureViewIsIntact:function(a){if(!a)throw new h.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(a.isDestroyed)throw new h.Error({name:"ViewDestroyedError",message:'View (cid: "'+a.cid+'") has already been destroyed and cannot be used.'})},getEl:function(a){return b.$(a,h._getValue(this.options.parentEl,this))},attachHtml:function(a){this.$el.contents().detach();this.el.appendChild(a.el)},empty:function(a){var b=this.currentView,c=a||{},d=!!c.preventDestroy;if(!b)return this;b.off("destroy",this.empty,this);this.triggerMethod("before:empty",b);if(!d)this._destroyView();this.triggerMethod("empty",b);delete this.currentView;if(d)this.$el.contents().detach();return this},_destroyView:function(){var a=this.currentView;if(a.isDestroyed)return;if(!a.supportsDestroyLifecycle)h.triggerMethodOn(a,"before:destroy",a);if(a.destroy)a.destroy();else{a.remove();a.isDestroyed=true}if(!a.supportsDestroyLifecycle)h.triggerMethodOn(a,"destroy",a)},attachView:function(a){if(this.currentView)delete this.currentView._parent;a._parent=this;this.currentView=a;return this},hasView:function(){return!!this.currentView},reset:function(){this.empty();if(this.$el)this.el=this.$el.selector;delete this.$el;return this}},{buildRegion:function(a,b){if(c.isString(a))return this._buildRegionFromSelector(a,b);if(a.selector||a.el||a.regionClass)return this._buildRegionFromObject(a,b);if(c.isFunction(a))return this._buildRegionFromRegionClass(a);throw new h.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(a,b){return new b({el:a})},_buildRegionFromObject:function(a,b){var d=a.regionClass||b,e=c.omit(a,"selector","regionClass");if(a.selector&&!e.el)e.el=a.selector;return new d(e)},_buildRegionFromRegionClass:function(a){return new a}});h.RegionManager=h.Controller.extend({constructor:function(a){this._regions={};this.length=0;h.Controller.call(this,a);this.addRegions(this.getOption("regions"))},addRegions:function(a,b){a=h._getValue(a,this,arguments);return c.reduce(a,function(a,d,e){if(c.isString(d))d={selector:d};if(d.selector)d=c.defaults({},d,b);a[e]=this.addRegion(e,d);return a},{},this)},addRegion:function(a,b){var c;if(b instanceof h.Region)c=b;else c=h.Region.buildRegion(b,h.Region);this.triggerMethod("before:add:region",a,c);c._parent=this;this._store(a,c);this.triggerMethod("add:region",a,c);return c},get:function(a){return this._regions[a]},getRegions:function(){return c.clone(this._regions)},removeRegion:function(a){var b=this._regions[a];this._remove(a,b);return b},removeRegions:function(){var a=this.getRegions();c.each(this._regions,function(a,b){this._remove(b,a)},this);return a},emptyRegions:function(){var a=this.getRegions();c.invoke(a,"empty");return a},destroy:function(){this.removeRegions();return h.Controller.prototype.destroy.apply(this,arguments)},_store:function(a,b){if(!this._regions[a])this.length++;this._regions[a]=b},_remove:function(a,b){this.triggerMethod("before:remove:region",a,b);b.empty();b.stopListening();delete b._parent;delete this._regions[a];this.length--;this.triggerMethod("remove:region",a,b)}});h.actAsCollection(h.RegionManager.prototype,"_regions");h.TemplateCache=function(a){this.templateId=a};c.extend(h.TemplateCache,{templateCaches:{},get:function(a,b){var c=this.templateCaches[a];if(!c){c=new h.TemplateCache(a);this.templateCaches[a]=c}return c.load(b)},clear:function(){var a,b=c.toArray(arguments),d=b.length;if(d>0)for(a=0;a<d;a++)delete this.templateCaches[b[a]];else this.templateCaches={}}});c.extend(h.TemplateCache.prototype,{load:function(a){if(this.compiledTemplate)return this.compiledTemplate;var b=this.loadTemplate(this.templateId,a);this.compiledTemplate=this.compileTemplate(b,a);return this.compiledTemplate},loadTemplate:function(a,c){var d=b.$(a);if(!d.length)throw new h.Error({name:"NoTemplateError",message:'Could not find template: "'+a+'"'});return d.html()},compileTemplate:function(a,b){return c.template(a,b)}});h.Renderer={render:function(a,b){if(!a)throw new h.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var d=c.isFunction(a)?a:h.TemplateCache.get(a);return d(b)}};h.View=b.View.extend({isDestroyed:false,supportsRenderLifecycle:true,supportsDestroyLifecycle:true,constructor:function(a){this.render=c.bind(this.render,this);a=h._getValue(a,this);this.options=c.extend({},c.result(this,"options"),a);this._behaviors=h.Behaviors(this);b.View.call(this,this.options);h.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(a){return a.toJSON.apply(a,c.rest(arguments))},mixinTemplateHelpers:function(a){a=a||{};var b=this.getOption("templateHelpers");b=h._getValue(b,this);return c.extend(a,b)},normalizeUIKeys:function(a){var b=c.result(this,"_uiBindings");return h.normalizeUIKeys(a,b||c.result(this,"ui"))},normalizeUIValues:function(a,b){var d=c.result(this,"ui"),e=c.result(this,"_uiBindings");return h.normalizeUIValues(a,e||d,b)},configureTriggers:function(){if(!this.triggers)return;var a=this.normalizeUIKeys(c.result(this,"triggers"));return c.reduce(a,function(a,b,c){a[c]=this._buildViewTrigger(b);return a},{},this)},delegateEvents:function(a){this._delegateDOMEvents(a);this.bindEntityEvents(this.model,this.getOption("modelEvents"));this.bindEntityEvents(this.collection,this.getOption("collectionEvents"));c.each(this._behaviors,function(a){a.bindEntityEvents(this.model,a.getOption("modelEvents"));a.bindEntityEvents(this.collection,a.getOption("collectionEvents"))},this);return this},_delegateDOMEvents:function(a){var d,e,f,g,i=h._getValue(a||this.events,this);i=this.normalizeUIKeys(i);if(c.isUndefined(a))this.events=i;d={};e=c.result(this,"behaviorEvents")||{};f=this.configureTriggers();g=c.result(this,"behaviorTriggers")||{};c.extend(d,e,i,f,g);b.View.prototype.delegateEvents.call(this,d)},undelegateEvents:function(){b.View.prototype.undelegateEvents.apply(this,arguments);this.unbindEntityEvents(this.model,this.getOption("modelEvents"));this.unbindEntityEvents(this.collection,this.getOption("collectionEvents"));c.each(this._behaviors,function(a){a.unbindEntityEvents(this.model,a.getOption("modelEvents"));a.unbindEntityEvents(this.collection,a.getOption("collectionEvents"))},this);return this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new h.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this.isDestroyed)return this;var a=c.toArray(arguments);this.triggerMethod.apply(this,["before:destroy"].concat(a));this.isDestroyed=true;this.triggerMethod.apply(this,["destroy"].concat(a));this.unbindUIElements();this.isRendered=false;this.remove();c.invoke(this._behaviors,"destroy",a);return this},bindUIElements:function(){this._bindUIElements();c.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(!this.ui)return;if(!this._uiBindings)this._uiBindings=this.ui;var a=c.result(this,"_uiBindings");this.ui={};c.each(a,function(a,b){this.ui[b]=this.$(a)},this)},unbindUIElements:function(){this._unbindUIElements();c.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){if(!this.ui||!this._uiBindings)return;c.each(this.ui,function(a,b){delete this.ui[b];
},this);this.ui=this._uiBindings;delete this._uiBindings},_buildViewTrigger:function(a){var b=c.defaults({},a,{preventDefault:true,stopPropagation:true}),d=c.isObject(a)?b.event:a;return function(a){if(a){if(a.preventDefault&&b.preventDefault)a.preventDefault();if(a.stopPropagation&&b.stopPropagation)a.stopPropagation()}var c={view:this,model:this.model,collection:this.collection};this.triggerMethod(d,c)}},setElement:function(){var a=b.View.prototype.setElement.apply(this,arguments);c.invoke(this._behaviors,"proxyViewProperties",this);return a},triggerMethod:function(){var a=h._triggerMethod(this,arguments);this._triggerEventOnBehaviors(arguments);this._triggerEventOnParentLayout(arguments[0],c.rest(arguments));return a},_triggerEventOnBehaviors:function(a){var b,c,d=h._triggerMethod,e=this._behaviors;for(b=0,c=e&&e.length;b<c;b++)d(e[b],a)},_triggerEventOnParentLayout:function(a,b){var d,e,f,g,i,j=this._parentLayoutView();if(!j)return;d=h.getOption(j,"childViewEventPrefix");e=d+":"+a;f=[this].concat(b);h._triggerMethod(j,e,f);g=h.getOption(j,"childEvents");g=h._getValue(g,j);i=j.normalizeMethods(g);if(i&&c.isFunction(i[a]))i[a].apply(j,f)},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var a=this._getImmediateChildren();if(!a.length)return a;return c.reduce(a,function(a,b){if(!b._getNestedViews)return a;return a.concat(b._getNestedViews())},a)},_parentLayoutView:function(){var a=this._parent;while(a){if(a instanceof h.LayoutView)return a;a=a._parent}},normalizeMethods:h.normalizeMethods,mergeOptions:h.mergeOptions,getOption:h.proxyGetOption,bindEntityEvents:h.proxyBindEntityEvents,unbindEntityEvents:h.proxyUnbindEntityEvents});h.ItemView=h.View.extend({constructor:function(){h.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var a=[this.model||this.collection];if(arguments.length)a.push.apply(a,arguments);if(this.model)return this.serializeModel.apply(this,a);else return{items:this.serializeCollection.apply(this,a)}},serializeCollection:function(a){return a.toJSON.apply(a,c.rest(arguments))},render:function(){this._ensureViewIsIntact();this.triggerMethod("before:render",this);this._renderTemplate();this.isRendered=true;this.bindUIElements();this.triggerMethod("render",this);return this},_renderTemplate:function(){var a,b,c=this.getTemplate();if(false===c)return;if(!c)throw new h.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});a=this.mixinTemplateHelpers(this.serializeData());b=h.Renderer.render(c,a,this);this.attachElContent(b);return this},attachElContent:function(a){this.$el.html(a);return this}});h.CollectionView=h.View.extend({childViewEventPrefix:"childview",sort:true,constructor:function(a){this.once("render",this._initialEvents);this._initChildViewStorage();h.View.apply(this,arguments);this.on({"before:show":this._onBeforeShowCalled,show:this._onShowCalled,"before:attach":this._onBeforeAttachCalled,attach:this._onAttachCalled});this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer();this.isBuffering=true},endBuffering:function(){var a,b=this._isShown&&h.isNodeAttached(this.el);this.isBuffering=false;if(this._isShown)this._triggerMethodMany(this._bufferedChildren,this,"before:show");if(b&&this._triggerBeforeAttach){a=this._getNestedViews();this._triggerMethodMany(a,this,"before:attach")}this.attachBuffer(this,this._createBuffer());if(b&&this._triggerAttach){a=this._getNestedViews();this._triggerMethodMany(a,this,"attach")}if(this._isShown)this._triggerMethodMany(this._bufferedChildren,this,"show");this.initRenderBuffer()},_triggerMethodMany:function(a,b,d){var e=c.drop(arguments,3);c.each(a,function(a){h.triggerMethodOn.apply(a,[a,d,a,b].concat(e))})},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this._onCollectionAdd);this.listenTo(this.collection,"remove",this._onCollectionRemove);this.listenTo(this.collection,"reset",this.render);if(this.getOption("sort"))this.listenTo(this.collection,"sort",this._sortViews)}},_onCollectionAdd:function(a,b,d){var e,f=void 0!==d.at&&(d.index||b.indexOf(a));if(this.getOption("filter")||false===f)f=c.indexOf(this._filteredSortedModels(f),a);if(this._shouldAddChild(a,f)){this.destroyEmptyView();e=this.getChildView(a);this.addChild(a,e,f)}},_onCollectionRemove:function(a){var b=this.children.findByModel(a);this.removeChildView(b);this.checkEmpty()},_onBeforeShowCalled:function(){this._triggerBeforeAttach=this._triggerAttach=false;this.children.each(function(a){h.triggerMethodOn(a,"before:show",a)})},_onShowCalled:function(){this.children.each(function(a){h.triggerMethodOn(a,"show",a)})},_onBeforeAttachCalled:function(){this._triggerBeforeAttach=true},_onAttachCalled:function(){this._triggerAttach=true},render:function(){this._ensureViewIsIntact();this.triggerMethod("before:render",this);this._renderChildren();this.isRendered=true;this.triggerMethod("render",this);return this},reorder:function(){var a,b,d=this.children,e=this._filteredSortedModels(),f=c.some(e,function(a){return!d.findByModel(a)});if(f)this.render();else{a=c.map(e,function(a,b){var c=d.findByModel(a);c._index=b;return c.el});b=d.filter(function(b){return!c.contains(a,b.el)});this.triggerMethod("before:reorder");this._appendReorderedChildren(a);c.each(b,this.removeChildView,this);this.checkEmpty();this.triggerMethod("reorder")}},resortView:function(){if(h.getOption(this,"reorderOnSort"))this.reorder();else this.render()},_sortViews:function(){var a=this._filteredSortedModels(),b=c.find(a,function(a,b){var c=this.children.findByModel(a);return!c||c._index!==b},this);if(b)this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(a){this.$el.append(a)},_renderChildren:function(){this.destroyEmptyView();this.destroyChildren({checkEmpty:false});if(this.isEmpty(this.collection))this.showEmptyView();else{this.triggerMethod("before:render:collection",this);this.startBuffering();this.showCollection();this.endBuffering();this.triggerMethod("render:collection",this);if(this.children.isEmpty()&&this.getOption("filter"))this.showEmptyView()}},showCollection:function(){var a,b=this._filteredSortedModels();c.each(b,function(b,c){a=this.getChildView(b);this.addChild(b,a,c)},this)},_filteredSortedModels:function(a){var b,d=this.getViewComparator(),e=this.collection.models;a=Math.min(Math.max(a,0),e.length-1);if(d){if(a){b=e[a];e=e.slice(0,a).concat(e.slice(a+1))}e=this._sortModelsBy(e,d);if(b)e.splice(a,0,b)}if(this.getOption("filter"))e=c.filter(e,function(a,b){return this._shouldAddChild(a,b)},this);return e},_sortModelsBy:function(a,b){if("string"===typeof b)return c.sortBy(a,function(a){return a.get(b)},this);else if(1===b.length)return c.sortBy(a,b,this);else return a.sort(c.bind(b,this))},showEmptyView:function(){var a,c=this.getEmptyView();if(c&&!this._showingEmptyView){this.triggerMethod("before:render:empty");this._showingEmptyView=true;a=new b.Model;this.addEmptyView(a,c);this.triggerMethod("render:empty")}},destroyEmptyView:function(){if(this._showingEmptyView){this.triggerMethod("before:remove:empty");this.destroyChildren();delete this._showingEmptyView;this.triggerMethod("remove:empty")}},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(a,b){var d,e,f=this._isShown&&!this.isBuffering&&h.isNodeAttached(this.el),g=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");if(c.isFunction(g))g=g.call(this,a,this._emptyViewIndex);e=this.buildChildView(a,b,g);e._parent=this;this.proxyChildEvents(e);e.once("render",function(){if(this._isShown)h.triggerMethodOn(e,"before:show",e);if(f&&this._triggerBeforeAttach){d=this._getViewAndNested(e);this._triggerMethodMany(d,this,"before:attach")}},this);this.children.add(e);this.renderChildView(e,this._emptyViewIndex);if(f&&this._triggerAttach){d=this._getViewAndNested(e);this._triggerMethodMany(d,this,"attach")}if(this._isShown)h.triggerMethodOn(e,"show",e)},getChildView:function(a){var b=this.getOption("childView");if(!b)throw new h.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return b},addChild:function(a,b,c){var d,e=this.getOption("childViewOptions");e=h._getValue(e,this,[a,c]);d=this.buildChildView(a,b,e);this._updateIndices(d,true,c);this.triggerMethod("before:add:child",d);this._addChildView(d,c);this.triggerMethod("add:child",d);d._parent=this;return d},_updateIndices:function(a,b,c){if(!this.getOption("sort"))return;if(b)a._index=c;this.children.each(function(c){if(c._index>=a._index)c._index+=b?1:-1})},_addChildView:function(a,b){var c,d=this._isShown&&!this.isBuffering&&h.isNodeAttached(this.el);this.proxyChildEvents(a);a.once("render",function(){if(this._isShown&&!this.isBuffering)h.triggerMethodOn(a,"before:show",a);if(d&&this._triggerBeforeAttach){c=this._getViewAndNested(a);this._triggerMethodMany(c,this,"before:attach")}},this);this.children.add(a);this.renderChildView(a,b);if(d&&this._triggerAttach){c=this._getViewAndNested(a);this._triggerMethodMany(c,this,"attach")}if(this._isShown&&!this.isBuffering)h.triggerMethodOn(a,"show",a)},renderChildView:function(a,b){if(!a.supportsRenderLifecycle)h.triggerMethodOn(a,"before:render",a);a.render();if(!a.supportsRenderLifecycle)h.triggerMethodOn(a,"render",a);this.attachHtml(this,a,b);return a},buildChildView:function(a,b,d){var e=c.extend({model:a},d),f=new b(e);h.MonitorDOMRefresh(f);return f},removeChildView:function(a){if(!a)return a;this.triggerMethod("before:remove:child",a);if(!a.supportsDestroyLifecycle)h.triggerMethodOn(a,"before:destroy",a);if(a.destroy)a.destroy();else a.remove();if(!a.supportsDestroyLifecycle)h.triggerMethodOn(a,"destroy",a);delete a._parent;this.stopListening(a);this.children.remove(a);this.triggerMethod("remove:child",a);this._updateIndices(a,false);return a},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){if(this.isEmpty(this.collection))this.showEmptyView();
},attachBuffer:function(a,b){a.$el.append(b)},_createBuffer:function(){var a=document.createDocumentFragment();c.each(this._bufferedChildren,function(b){a.appendChild(b.el)});return a},attachHtml:function(a,b,c){if(a.isBuffering)a._bufferedChildren.splice(c,0,b);else if(!a._insertBefore(b,c))a._insertAfter(b)},_insertBefore:function(a,b){var c,d=this.getOption("sort")&&b<this.children.length-1;if(d)c=this.children.find(function(a){return a._index===b+1});if(c){c.$el.before(a.el);return true}return false},_insertAfter:function(a){this.$el.append(a.el)},_initChildViewStorage:function(){this.children=new b.ChildViewContainer},destroy:function(){if(this.isDestroyed)return this;this.triggerMethod("before:destroy:collection");this.destroyChildren({checkEmpty:false});this.triggerMethod("destroy:collection");return h.View.prototype.destroy.apply(this,arguments)},destroyChildren:function(a){var b=a||{},d=true,e=this.children.map(c.identity);if(!c.isUndefined(b.checkEmpty))d=b.checkEmpty;this.children.each(this.removeChildView,this);if(d)this.checkEmpty();return e},_shouldAddChild:function(a,b){var d=this.getOption("filter");return!c.isFunction(d)||d.call(this,a,b,this.collection)},proxyChildEvents:function(a){var b=this.getOption("childViewEventPrefix");this.listenTo(a,"all",function(){var d=c.toArray(arguments),e=d[0],f=this.normalizeMethods(c.result(this,"childEvents"));d[0]=b+":"+e;d.splice(1,0,a);if("undefined"!==typeof f&&c.isFunction(f[e]))f[e].apply(this,d.slice(1));this.triggerMethod.apply(this,d)})},_getImmediateChildren:function(){return c.values(this.children._views)},_getViewAndNested:function(a){return[a].concat(c.result(a,"_getNestedViews")||[])},getViewComparator:function(){return this.getOption("viewComparator")}});h.CompositeView=h.CollectionView.extend({constructor:function(){h.CollectionView.apply(this,arguments)},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this._onCollectionAdd);this.listenTo(this.collection,"remove",this._onCollectionRemove);this.listenTo(this.collection,"reset",this._renderChildren);if(this.getOption("sort"))this.listenTo(this.collection,"sort",this._sortViews)}},getChildView:function(a){var b=this.getOption("childView")||this.constructor;return b},serializeData:function(){var a={};if(this.model)a=c.partial(this.serializeModel,this.model).apply(this,arguments);return a},render:function(){this._ensureViewIsIntact();this._isRendering=true;this.resetChildViewContainer();this.triggerMethod("before:render",this);this._renderTemplate();this._renderChildren();this._isRendering=false;this.isRendered=true;this.triggerMethod("render",this);return this},_renderChildren:function(){if(this.isRendered||this._isRendering)h.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var a,b,c={};c=this.serializeData();c=this.mixinTemplateHelpers(c);this.triggerMethod("before:render:template");a=this.getTemplate();b=h.Renderer.render(a,c,this);this.attachElContent(b);this.bindUIElements();this.triggerMethod("render:template")},attachElContent:function(a){this.$el.html(a);return this},attachBuffer:function(a,b){var c=this.getChildViewContainer(a);c.append(b)},_insertAfter:function(a){var b=this.getChildViewContainer(this,a);b.append(a.el)},_appendReorderedChildren:function(a){var b=this.getChildViewContainer(this);b.append(a)},getChildViewContainer:function(a,b){var c,d,e;if(!!a.$childViewContainer)return a.$childViewContainer;d=h.getOption(a,"childViewContainer");if(d){e=h._getValue(d,a);if("@"===e.charAt(0)&&a.ui)c=a.ui[e.substr(4)];else c=a.$(e);if(c.length<=0)throw new h.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+a.childViewContainer})}else c=a.$el;a.$childViewContainer=c;return c},resetChildViewContainer:function(){if(this.$childViewContainer)this.$childViewContainer=void 0}});h.LayoutView=h.ItemView.extend({regionClass:h.Region,options:{destroyImmediate:false},childViewEventPrefix:"childview",constructor:function(a){a=a||{};this._firstRender=true;this._initializeRegions(a);h.ItemView.call(this,a)},render:function(){this._ensureViewIsIntact();if(this._firstRender)this._firstRender=false;else this._reInitializeRegions();return h.ItemView.prototype.render.apply(this,arguments)},destroy:function(){if(this.isDestroyed)return this;if(true===this.getOption("destroyImmediate"))this.$el.remove();this.regionManager.destroy();return h.ItemView.prototype.destroy.apply(this,arguments)},showChildView:function(a,b,d){var e=this.getRegion(a);return e.show.apply(e,c.rest(arguments))},getChildView:function(a){return this.getRegion(a).currentView},addRegion:function(a,b){var c={};c[a]=b;return this._buildRegions(c)[a]},addRegions:function(a){this.regions=c.extend({},this.regions,a);return this._buildRegions(a)},removeRegion:function(a){delete this.regions[a];return this.regionManager.removeRegion(a)},getRegion:function(a){return this.regionManager.get(a)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(a){var b={regionClass:this.getOption("regionClass"),parentEl:c.partial(c.result,this,"el")};return this.regionManager.addRegions(a,b)},_initializeRegions:function(a){var b,d;this._initRegionManager();b=h._getValue(this.regions,this,[a])||{};d=this.getOption.call(a,"regions");d=h._getValue(d,this,[a]);c.extend(b,d);b=this.normalizeUIValues(b,["selector","el"]);this.addRegions(b)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new h.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager();this.regionManager._parent=this;this.listenTo(this.regionManager,"before:add:region",function(a){this.triggerMethod("before:add:region",a)});this.listenTo(this.regionManager,"add:region",function(a,b){this[a]=b;this.triggerMethod("add:region",a,b)});this.listenTo(this.regionManager,"before:remove:region",function(a){this.triggerMethod("before:remove:region",a)});this.listenTo(this.regionManager,"remove:region",function(a,b){delete this[a];this.triggerMethod("remove:region",a,b)})},_getImmediateChildren:function(){return c.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}});h.Behavior=h.Object.extend({constructor:function(a,b){this.view=b;this.defaults=c.result(this,"defaults")||{};this.options=c.extend({},this.defaults,a);this.ui=c.extend({},c.result(b,"ui"),c.result(this,"ui"));h.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){this.stopListening();return this},proxyViewProperties:function(a){this.$el=a.$el;this.el=a.el}});h.Behaviors=function(a,b){var c,d=/^(\S+)\s*(.*)$/;function e(a,d){if(!b.isObject(a.behaviors))return{};d=e.parseBehaviors(a,d||b.result(a,"behaviors"));e.wrap(a,d,b.keys(c));return d}c={behaviorTriggers:function(a,b){var c=new f(this,b);return c.buildBehaviorTriggers()},behaviorEvents:function(c,e){var f={};b.each(e,function(c,e){var h,i={},j=b.clone(b.result(c,"events"))||{};j=a.normalizeUIKeys(j,g(c));h=0;b.each(j,function(a,f){var g=f.match(d),j=g[1]+"."+[this.cid,e,h++," "].join(""),k=g[2],l=j+k,m=b.isFunction(a)?a:c[a];i[l]=b.bind(m,c)},this);f=b.extend(f,i)},this);return f}};b.extend(e,{behaviorsLookup:function(){throw new a.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(b,c){if(b.behaviorClass)return b.behaviorClass;return a._getValue(e.behaviorsLookup,this,[b,c])[c]},parseBehaviors:function(a,c){return b.chain(c).map(function(c,d){var f=e.getBehaviorClass(c,d),g=new f(c,a),h=e.parseBehaviors(a,b.result(g,"behaviors"));return[g].concat(h)}).flatten().value()},wrap:function(a,d,e){b.each(e,function(e){a[e]=b.partial(c[e],a[e],d)})}});function f(a,b){this._view=a;this._behaviors=b;this._triggers={}}b.extend(f.prototype,{buildBehaviorTriggers:function(){b.each(this._behaviors,this._buildTriggerHandlersForBehavior,this);return this._triggers},_buildTriggerHandlersForBehavior:function(c,d){var e=b.clone(b.result(c,"triggers"))||{};e=a.normalizeUIKeys(e,g(c));b.each(e,b.bind(this._setHandlerForBehavior,this,c,d))},_setHandlerForBehavior:function(a,b,c,d){var e=d.replace(/^\S+/,function(a){return a+"."+"behaviortriggers"+b});this._triggers[e]=this._view._buildViewTrigger(c)}});function g(a){return a._uiBindings||a.ui}return e}(h,c);h.AppRouter=b.Router.extend({constructor:function(a){var c,d;this.options=a||{};b.Router.apply(this,arguments);c=this.getOption("appRoutes");d=this._getController();this.processAppRoutes(d,c);this.on("route",this._processOnRoute,this)},appRoute:function(a,b){var c=this._getController();this._addAppRoute(c,a,b)},_processOnRoute:function(a,b){if(c.isFunction(this.onRoute)){var d=c.invert(this.getOption("appRoutes"))[a];this.onRoute(a,d,b)}},processAppRoutes:function(a,b){if(!b)return;var d=c.keys(b).reverse();c.each(d,function(c){this._addAppRoute(a,c,b[c])},this)},_getController:function(){return this.getOption("controller")},_addAppRoute:function(a,b,d){var e=a[d];if(!e)throw new h.Error('Method "'+d+'" was not found on the controller');this.route(b,d,c.bind(e,a))},mergeOptions:h.mergeOptions,getOption:h.proxyGetOption,triggerMethod:h.triggerMethod,bindEntityEvents:h.proxyBindEntityEvents,unbindEntityEvents:h.proxyUnbindEntityEvents});h.Application=h.Object.extend({constructor:function(a){this._initializeRegions(a);this._initCallbacks=new h.Callbacks;this.submodules={};c.extend(this,a);this._initChannel();h.Object.apply(this,arguments)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(a){this._initCallbacks.add(a)},start:function(a){this.triggerMethod("before:start",a);this._initCallbacks.run(a,this);this.triggerMethod("start",a)},addRegions:function(a){return this._regionManager.addRegions(a)},emptyRegions:function(){return this._regionManager.emptyRegions();
},removeRegion:function(a){return this._regionManager.removeRegion(a)},getRegion:function(a){return this._regionManager.get(a)},getRegions:function(){return this._regionManager.getRegions()},module:function(a,b){var d=h.Module.getClass(b),e=c.toArray(arguments);e.unshift(this);return d.create.apply(d,e)},getRegionManager:function(){return new h.RegionManager},_initializeRegions:function(a){var b,d=c.isFunction(this.regions)?this.regions(a):this.regions||{};this._initRegionManager();b=h.getOption(a,"regions");if(c.isFunction(b))b=b.call(this,a);c.extend(d,b);this.addRegions(d);return this},_initRegionManager:function(){this._regionManager=this.getRegionManager();this._regionManager._parent=this;this.listenTo(this._regionManager,"before:add:region",function(){h._triggerMethod(this,"before:add:region",arguments)});this.listenTo(this._regionManager,"add:region",function(a,b){this[a]=b;h._triggerMethod(this,"add:region",arguments)});this.listenTo(this._regionManager,"before:remove:region",function(){h._triggerMethod(this,"before:remove:region",arguments)});this.listenTo(this._regionManager,"remove:region",function(a){delete this[a];h._triggerMethod(this,"remove:region",arguments)})},_initChannel:function(){this.channelName=c.result(this,"channelName")||"global";this.channel=c.result(this,"channel")||b.Wreqr.radio.channel(this.channelName);this.vent=c.result(this,"vent")||this.channel.vent;this.commands=c.result(this,"commands")||this.channel.commands;this.reqres=c.result(this,"reqres")||this.channel.reqres}});h.Module=function(a,b,d){this.moduleName=a;this.options=c.extend({},this.options,d);this.initialize=d.initialize||this.initialize;this.submodules={};this._setupInitializersAndFinalizers();this.app=b;if(c.isFunction(this.initialize))this.initialize(a,b,this.options)};h.Module.extend=h.extend;c.extend(h.Module.prototype,b.Events,{startWithParent:true,initialize:function(){},addInitializer:function(a){this._initializerCallbacks.add(a)},addFinalizer:function(a){this._finalizerCallbacks.add(a)},start:function(a){if(this._isInitialized)return;c.each(this.submodules,function(b){if(b.startWithParent)b.start(a)});this.triggerMethod("before:start",a);this._initializerCallbacks.run(a,this);this._isInitialized=true;this.triggerMethod("start",a)},stop:function(){if(!this._isInitialized)return;this._isInitialized=false;this.triggerMethod("before:stop");c.invoke(this.submodules,"stop");this._finalizerCallbacks.run(void 0,this);this._initializerCallbacks.reset();this._finalizerCallbacks.reset();this.triggerMethod("stop")},addDefinition:function(a,b){this._runModuleDefinition(a,b)},_runModuleDefinition:function(a,d){if(!a)return;var e=c.flatten([this,this.app,b,h,b.$,c,d]);a.apply(this,e)},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new h.Callbacks;this._finalizerCallbacks=new h.Callbacks},triggerMethod:h.triggerMethod});c.extend(h.Module,{create:function(a,b,d){var e,f,g=a,h=c.drop(arguments,3);b=b.split(".");e=b.length;f=[];f[e-1]=d;c.each(b,function(b,c){var e=g;g=this._getModule(e,b,a,d);this._addModuleDefinition(e,g,f[c],h)},this);return g},_getModule:function(a,b,d,e,f){var g=c.extend({},e),h=this.getClass(e),i=a[b];if(!i){i=new h(b,d,g);a[b]=i;a.submodules[b]=i}return i},getClass:function(a){var b=h.Module;if(!a)return b;if(a.prototype instanceof b)return a;return a.moduleClass||b},_addModuleDefinition:function(a,b,c,d){var e=this._getDefine(c),f=this._getStartWithParent(c,b);if(e)b.addDefinition(e,d);this._addStartWithParent(a,b,f)},_getStartWithParent:function(a,b){var d;if(c.isFunction(a)&&a.prototype instanceof h.Module){d=b.constructor.prototype.startWithParent;return c.isUndefined(d)?true:d}if(c.isObject(a)){d=a.startWithParent;return c.isUndefined(d)?true:d}return true},_getDefine:function(a){if(c.isFunction(a)&&!(a.prototype instanceof h.Module))return a;if(c.isObject(a))return a.define;return null},_addStartWithParent:function(a,b,c){b.startWithParent=b.startWithParent&&c;if(!b.startWithParent||!!b.startWithParentIsConfigured)return;b.startWithParentIsConfigured=true;a.addInitializer(function(a){if(b.startWithParent)b.start(a)})}});return h});define("mathUtil",[],function(){var a=function(a,b,c){if(void 0===a||void 0===b||void 0===c)throw new Error("toPercent requires three arguments: numerator, denominator, and decimalPlaces");return+(a/b*100).toFixed(c)},b=function(a,b,c){var d=a/b;if(void 0===a||void 0===b||"number"!==typeof a||"number"!==typeof b)throw new Error("divide only accepts numbers for dividend and divisor");if(0===b)throw new Error("divide does not accept 0 as a divisor");if(arguments.length>2&&void 0!==c&&"object"!==typeof c)throw new Error("divide options argument should be an object");if(void 0!==c&&void 0!==c.roundUp&&true===c.roundUp){d=parseInt(d,10);d+=a%b>0?1:0}return d},c=function(a,b){var c,d,e,f,g,h,i=0,j=[];if(void 0===b||""===b)this.pattern="#,###.###";else this.pattern=b;if(isNaN(a))return a;a=parseFloat(a);h=this.pattern.toString().split(".");if(this.pattern.indexOf(".")!==-1)i=h[1].length;if(0===i)a=Math.round(a);else a=a.toFixed(i);if(this.pattern.indexOf(",")===-1)return a;c=h[0];d=c.lastIndexOf(",");e=c.length-(d+1);f=new RegExp("(\\d)(?=(\\d{"+e+"})+(?!\\d))","g");g=a.toString().split(".");g[0]=g[0].replace(f,"$1,");if(i&&1===g.length){j.length=parseInt(i,10)+1;g[1]=j.join("0")}if(i&&2===g.length&&g[1].length>i)g[1]=g[1].substring(0,i);return g.join(".")};function d(a){return!isNaN(a)?+(62137e-8*a):0}return{toPercent:a,divide:b,metersToMiles:d,formatNumber:c}});define("objectUtil",[],function(){function a(a,b){var c=0,d,e,f;if(!a||"object"!==typeof a||!b||"string"!==typeof b)return false;b=b.replace(/^\./,"");d=b.split(".");e=d.length;for(;c<e;c++){f=d[c];if(!a||!a.hasOwnProperty(f))return false;a=a[f]}return true}function b(a,b){var c=0,d,e,f;if(!a||"object"!==typeof a||!b||"string"!==typeof b)return;b=b.replace(/\[(\w+)\]/g,".$1");b=b.replace(/^\./,"");d=b.split(".");e=d.length;for(;c<e;c++){f=d[c];if(f in a)a=a[f];else return}return a}function c(a,b,c){var d=0,e,f,g;c=c||{};if(!b||"string"!==typeof b)return;b=b.replace(/^\./,"");e=b.split(".");f=e.length-1;for(;d<f;d++){g=e[d];if(!(g in c))c[g]={};c=c[g]}c[e[f]]=a;return c}!function(){if(!Object.keys)Object.keys=function(){"use strict";var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!==typeof e&&("function"!==typeof e||null===e))throw new TypeError("Object.keys called on non-object");var f=[],g,h;for(g in e)if(a.call(e,g))f.push(g);if(b)for(h=0;h<d;h++)if(a.call(e,c[h]))f.push(c[h]);return f}}()}();return{hasChildProperty:a,getChildProperty:b,setChildProperty:c}});define("hbsUtils",["handlebars"],function(a){var b={defaultScope:{}};function c(b,c){var d=a.helpers[b];if(!d)throw"Helper '"+b+"' not found.";return d.apply(this,c)}function d(a,b){var c=b.data.errors||{},d,e=b.data.modelAttribute?b.data.modelAttribute+".":"",f=e+a,g;if(!c.errorsHash){c.errorsHash={};if(c.fieldMessages)for(g=0;g<c.fieldMessages.length;g++){d=c.fieldMessages[g];c.errorsHash[d.fieldName]=d}}return c.errorsHash[f]}function e(a,b){if(!a||a.indexOf(".")!==-1)throw"Invalid key "+a;if(!b)return;var c=/([^\[]*)\[([^\]]*)\s*\]/,d=c.exec(a),e,f;if(d){a=d[1];e=d[2].trim()}f=b[a];if(f&&void 0!==e)f=f[e];return f}function f(a,b){if(!a||!b)return;for(var c=a.split("."),d,f=0,g=c.length,h=b;f<g;f++){d=c[f];h=e(d,h)}return h}function g(a,c,d){var e,f,g,h;if(d&&"string"===typeof d){g=d;f={}}else{d=d||{};e=d.hash||{};f=d.data||{};g=e.scope}if(!g)if(f.templateScope)h=f.templateScope;else g="defaultScope";if(!h)h=b[g]||(b[g]={});h[a]=c}function h(a,c){if(!a)return;c=c||{};var d=c.data||{},e,f;if(a.indexOf(".")!==-1){e=a.split(".");f=b[e[0]];return f?f[e[1]]:void 0}return d.templateScope?d.templateScope[a]:b.defaultScope[a]}function i(a){return a.replace(/\[\s*|\s*\]/g,"")}function j(a){var b;if(isNaN(Number(a)))b=/^(['"]).*\1$/.test(a);else b=true;return b}function k(a){if(/^(['"]).*\1$/.test(a))a=a.replace(/^(['"])(.*)\1$/,"$2");else a=Number(a);return a}function l(a,b,c){b=b||{};c=c||{};if(a.indexOf(".")===-1)if(0===a.indexOf("@"))return c.data?c.data[a.substr(1)]:void 0;else if("this"===a)return b;else{a=a.replace(/^\[(.+)\]$/,"$1").trim();return b[a]}else{for(var d=a.split("."),e=0,f=d.length,g=b;e<f;e++){g=l(d[e],g);if(!g)break}return g}}function m(a,b,c){b=b||[];c=c||[];var d=/(?:'(?:[^'\\]|\\\')*')|(?:"(?:[^"\\]|\\\")*")/,e=/\([^\)\(]*\)/,f,g,h={},i=function(a){a=a.replace(/---(\d+)---/,function(a,c){return b[c]}).replace(/%%%(\d+)%%%/g,function(a,b){return c[b]});return a};a=a.trim();if(a.match(/^\([^)(]+\)$/))a=a.replace(/^\((.*)\)$/,"$1").trim();while(null!==(f=d.exec(a))){a=a.replace(d,"%%%"+c.length+"%%%");c.push(f[0])}while(null!==(f=e.exec(a))){a=a.replace(e,"---"+b.length+"---");b.push(f[0])}g=a.split(/\s+/);if(1!==g.length&&3!==g.length)throw"invalid number of arguments "+g;h.arg1=i(g[0]);if(g.length>1){h.arg1=m(h.arg1,b,c);h.operator=g[1];h.arg2=m(i(g[2]),b,c)}return h}function n(a,b,c){switch(b){case"||":return a||c;case"&&":return a&&c;case"==":return a==c;case"===":return a===c;case"!=":return a!=c;case"!==":return a!==c;case"<":return a<c;case"<=":return a<=c;case">":return a>c;case">=":return a>=c;case"%":return a%c;case"+":return a+c;case"-":return a-c;case"/":return a/c;case"*":return a*c;default:throw"Operator '"+b+"' is not implemented."}}function o(a,b,c){var d,e,f=a.operator,g;if(!f){g=a.arg1;switch(g){case"true":case true:return true;case"false":case false:return false;case"undefined":case void 0:return;case"null":case null:return null;default:if(j(g))return k(g);else if("string"===typeof g&&0===g.indexOf("$"))return h(g.substr(1),c);else return l(g,b,c)}}d=o(a.arg1,b,c);e=o(a.arg2,b,c);return n(d,f,e)}function p(a){var b="",c;for(c in a)if(a.hasOwnProperty(c))b+=c+'="'+a[c]+'" ';return" "+b}return{evaluate:function(a,b,c){
return o(m(a),b,c)},get:h,set:g,getValueFromJSON:f,callOtherHelper:c,getIdFromPath:i,getFieldErrors:d,joinAttributes:p}});define("hbsHelpers",["handlebars","hbsUtils","mathUtil","globals","stringUtil","logger"],function(a,b,c,d,e,f){var g="if",h="unless",i="string",j=a.Utils.escapeExpression;a.registerHelper("condition",function(a,c){return b.callOtherHelper.call(this,g,[b.evaluate(a,this,c),c])});a.registerHelper("compare_eq",function(a,b,c){var d=a===b;if(d)return c.fn(this);else return c.inverse(this)});a.registerHelper("compare_neq",function(a,b,c){var d=a!==b;if(d)return c.fn(this);else return c.inverse(this)});a.registerHelper("ifFeatureEnabled",function(a,c){var e=false,f;if(typeof a===i){f=d.getValue("props."+a);if(true===f||typeof f===i&&"true"===f.toLowerCase())e=true}return b.callOtherHelper.call(this,g,[e,c])});a.registerHelper("formatNumber",function(a){return c.formatNumber(a.hash.value,a.hash.pattern)});a.registerHelper("set",function(a){var c=a.hash,d=c["var"],e,f=c.value,g;if(a.fn)f=a.fn(this);if(!d||d.indexOf(".")!==-1)throw"Invalid var '"+d+"'";if(c&&(true===c.evaluate||"true"===c.evaluate))f=b.evaluate(f,a);b.set(d,f,a)});a.registerHelper("get",function(a,c){if("string"!==typeof a)throw"Required attribute 'key' is missing";var d=b.get(a,c);if(d&&typeof d===i)return j(d);return d});a.registerHelper("getGlobalValue",function(a,b){var c="";if(d&&typeof a===i)c=d.getValue(a);return c});a.registerHelper("toLowerCase",function(a,b){var c;if(a&&typeof a===i){c=j(a);return c.toLowerCase()}return""});a.registerHelper("toUpperCase",function(a,b){var c;if(a&&typeof a===i){c=j(a);return c.toUpperCase()}return""});a.registerHelper("baseHost",function(){return d.getValue("props.baseHost")});a.registerHelper("secureHost",function(){return d.getValue("props.secureHost")});a.registerHelper("assetsHost",function(){return d.getValue("props.assetsHost")});a.registerHelper("imageHost",function(){return d.getValue("props.imageHost")});a.registerHelper("bind",function(b){var c,d=b.hash,e,f,g,h,i;if(b.data){c=a.createFrame(b.data);e=d.i18n;if("false"!==String(e))c.i18n=e?e:this.i18n;f=d.scope;if(!c.templateScope&&"false"!==String(f))c.templateScope={};g=d.scope;if(!c.errors&&"false"!==String(g))c.errors=this.errors;for(h in d)if(0===h.indexOf("_"))c[h.substr(1)]=d[h]}return b.fn(this,{data:c})});a.registerHelper("i18n",function(c){var d=j(c),e="???"+d+"???",f=arguments[arguments.length-1],g=f.hash||{},h=this.i18n,i=[];if(!h&&f.data)h=f.data.i18n;if(h)e=b.getValueFromJSON(d,h)||e;if(arguments.length>2){i=Array.prototype.slice.call(arguments,1,arguments.length-1);e=e.replace(/{(\d)}/g,function(a,b){return i[b]})}if(e&&("string"===typeof g.escape&&"false"===g.escape.toLowerCase()||"boolean"===typeof g.escape&&!g.escape))e=new a.SafeString(e);return e});a.registerHelper("getEncodedValue",function(a){return encodeURIComponent(a)});a.registerHelper("forEach",function(b){var c=b.hash||{},d=c.items,e=c.begin||0,g,h=c.step||1,i,j,k=1,l,m,n="",o={ARRAY:"array",MAP:"map",LOOP:"loop"},p;function q(){if(i){var a=j+h;i.index=j;i.count=k;i.first=j===e;i.last=a>g;if(m)i.key=m}}function r(){var a;if(p===o.LOOP)a=j;else if(p===o.ARRAY)a=d[j];else if(p===o.MAP)a=d[l[j]];return a}function s(a){g=c.end||a.length;if(g>a.length-1)g=a.length-1}if(b.data)i=a.createFrame(b.data);try{if(d&&"object"===typeof d)if(Array.isArray(d)){s(d);p=o.ARRAY}else{l=Object.keys(d);s(l);p=o.MAP}else{g=c.end||0;p=o.LOOP}}catch(t){f.error("Caught exception in forEach helper: ",t);return""}e=parseInt(e,10);g=parseInt(g,10);h=parseInt(h,10);if(isNaN(e))throw new Error("begin must be an integer");if(isNaN(g))throw new Error("end must be an integer");if(isNaN(h))throw new Error("step must be an integer");if(e<0)throw new Error("begin must be 0 or greater");if(h<0)throw new Error("step must be a positive integer");for(j=e;j<=g;j+=h,k++){if(p===o.MAP)m=l[j];q();n+=b.fn(r(),{data:i})}if(j===e)n=b.inverse(this);return n});a.registerHelper("formatPhone",function(a){var b,c;if(a){c=a.match(/\d/g);c=c?c.join(""):c;if(c&&10===c.length)b="("+c.slice(0,3)+") "+c.slice(3,6)+"-"+c.slice(6);else b=a}return b});return a});define("loader",["jquery","globals"],function(a,b){var c="tagName",d="INPUT",e="class",f="margin",g="width",h="aria-busy",i="originalclasses",j="loader-container",k="wrap-loader";function l(b,e){var g=30,i,l,m,n,o,p,q=false,r=false,s;if(b){b=a(b);q="BODY"===b.prop(c);r=b.prop(c)===d;i=b.outerWidth();l=b.outerHeight();l=0===l?g:l;o=parseInt(b.css("padding-left"),10)+parseInt(b.css("border-left-width"),10);p=parseInt(b.css("padding-top"),10)+parseInt(b.css("border-top-width"),10);m=a("<div class='"+j+"'>");n=a("<div class='loader'>Loading...</div>");if("BUTTON"===b.prop(c)||!r&&b.hasClass("button")){m.css({width:i-2+"px",height:25+"px"});a(b).css({color:"transparent",opacity:.8});a(b).attr(h,"true")}else if(r){s=b.prop("style").margin;m.addClass(k).css(f,b.css(f));b.css(f,"0");b.replaceWith(m);m.append(b);b.attr(h,"true");if(s)b.data("originalmargin",s)}else{m.css({width:i+"px",height:l+"px","margin-left":-o,"margin-top":-p});if(q)n.css({position:"fixed",top:"50%",left:"50%"});else n.css({margin:(m.height()/2).toString()+"px auto"})}if(void 0!==e&&e.hasOwnProperty("className"))n.addClass(e.className);if(!r)m.append(n).prependTo(b)}}function m(b,c){if(b){b=a(b);var d=b.children("."+j);if(0===d.length)this._initiate(b,c);else{b.css({color:"transparent",opacity:.8});b.attr("aria-busy","true");d.show()}}}function n(b){if(b){b=a(b);b.attr(h,"false");if(b.prop(c)===d)p(b);else{b.css({color:"",opacity:""});b.children("."+j).hide()}}}function o(b){if(b){b=a(b);b.attr(h,"false");if(b.prop(c)===d)p(b);else{b.css({color:"",opacity:""});b.children("."+j).remove()}}}function p(a){if(!a.parent().hasClass(k))return;if(a.data("originalmargin"))a.css(f,a.data("originalmargin"));else a.css(f,"");a.unwrap()}return{show:m,hide:n,destroy:o,_initiate:l}});require.config({bundles:{"/js/mcom/base/McomBase":["underscore","backbone","handlebars","cookie","stringUtil","logger","base","domReady","async","pubsub","analyticsBase","mapCache","mcomAnalytics","backbonerelational","fastClick","iscroll","globals","segmentation","marionette","mathUtil","objectUtil","hbsHelpers","hbsUtils","loader"]}});define("iscroll",function(){return IScroll});define("underscore",function(){return _});define("backbone",function(){return Backbone});define("marionette",function(){return Marionette});define("handlebars",function(){return Handlebars});define("backbonerelational",function(){return Backbone.RelationalModel});if("undefined"!==typeof jQuery)define("jquery",function(){return jQuery});TotalCookieSize=document.cookie.length;TotalCookieCount=document.cookie.split(/; /).length;