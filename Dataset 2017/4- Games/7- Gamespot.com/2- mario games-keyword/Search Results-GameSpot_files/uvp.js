(function(e){"use strict";var r=e.Phoenix,t;if(!r){e.Phoenix=r={}}t=r.VideoPlayer=r.VideoPlayer||{};var i=typeof athenaPlayerMode!=="undefined"?athenaPlayerMode:"standard",o=false,a=false,n=false,f=[],l=[],u=200;var s=t.log=function(){var e=f.push;if(!!e.apply){e.apply(f,[arguments])}else{e(Array.prototype.slice.call([arguments]))}if(n&&arguments.length===3){throw arguments[2]}};if(true===a){window.addEventListener("error",function(e){if(e.error){s("Uncaught Exception: ",{error:e.error.toString(),stack:e.error.stack})}else{s("Uncaught Exception: ",e)}})}var c=t.getLogLines=function(e){var r=e||u;var t=l.slice(Math.max(l.length-r,1));var i=[];_.each(t,function(e){var r=[];_.each(e,function(e){if(_.isObject(e)){r.push(_.mapObject(e,function(e,r){if(_.isObject(e)){return e.toString()}return e}))}else{r.push(e)}});i.push(r)});return i};var p=location.search,h="debug_video_player";if(p.indexOf(h+"=0")>=0){$.removeCookie(h,{path:"/"})}else if(p.indexOf(h+"=1")>=0||$.cookie(h)){o=true;a=true;n=true}else if(p.indexOf(h+"=cookie")>=0){o=true;a=true;n=true;$.cookie(h,1,{path:"/",expires:1})}if(!o){return}var d=function(){var r=e.console||{},t=f,i;o=true;a=true;n=true;if(!!r.log){f={push:function(){var e=r.debug||r.log,t="",i="",a=arguments[0],n=a[0];if(o){l.push(a);if(l.length>u){l.shift()}}if("error"===n||"warn"===n||"info"===n){t=n;if(!!r[t]){e=r[t]}else{i=t.toUpperCase()+": "}a[0]=i}a[0]="[VP] "+a[0];if(!!e.apply){e.apply(r,a)}else{e(Array.prototype.slice.call(a))}}};s("Enable video player js logging");for(i=0;i<t.length;i++){f.push(t[i])}}};if(true===o){d()}})(this);
(function(e){"use strict";var i=e.Phoenix,s,t;if(!i){e.Phoenix=i={}}s=i.VideoPlayer=i.VideoPlayer||{};s.Models=s.Models||{};t=s.Models.VideoStatus=Backbone.Model.extend({options:{cookie:false,server:false,takeLargestValue:true,saveTimeExpires:5,minSaveThreshold:5,saveThrottleLocal:1,saveThrottleServer:30},timestamps:{},value:null,id:null,api:null,settingName:null,videoJSON:null,fetchCalls:[],saveCalls:[],deleteCalls:[],initialize:function(e){var i=this;if(typeof e==="undefined"||!e.videoJSON||e.settingName){throw"Video Status Exception: Not enough arguments"}i.videoJSON=e.videoJSON;if(!i.videoJSON){return}i.id=i.videoJSON.id;if(i.videoJSON.savePosition){i.savePosition=i.videoJSON.savePosition;i.api=i.savePosition.api;i.settingName=i.savePosition.cookieName}else{i.settingName="uvp:savedPosition:"+i.videoJSON.guid}$.extend(i.options,e.options);if(i.options.cookie){i.fetchCalls.push(_.bind(i.fetchCookie,i));i.saveCalls.push(_.bind(i.saveCookie,i));i.deleteCalls.push(_.bind(i.deleteCookie,i))}if(i.options.server&&i.api){i.fetchCalls.push(_.bind(i.fetchServer,i));i.saveCalls.push(_.bind(i.saveServer,i));i.deleteCalls.push(_.bind(i.deleteServer,i))}},fetch:function(e){var i=this;e=e||{};var t=e.success||function(e){s.log("Fetched:"+i.settingName+":"+e)};i.value=0;var o=0;var a=i.fetchCalls.length;var n=function(e){if(!i.options.takeLargestValue||i.value<e){i.value=e}if(++o===a){t(i.value)}};_.each(i.fetchCalls,function(e){e({success:n})})},fetchCookie:function(e){var i=this;e.success($.cookie(i.settingName))},fetchServer:function(e){var i=this;e.success(i.savePosition.savedTime)},save:function(e,i){var t=this;if(e<t.options.minSaveThreshold){return}i=i||{};i.success=i.success||function(){s.log("Saved:"+t.settingName+":"+e)};i.force=!!i.force;_.each(t.saveCalls,function(s){s(e,i)});t.value=e},saveCookie:function(e,i){var s=this;var t=i.force?1:s.options.saveThrottleLocal;s.throttleSave("cookie",t,function(){$.cookie(s.settingName,e,{expires:s.saveTimeExpires});if(i.success){i.success()}})},saveServer:function(e,i){var s=this;if(!s.api){return}var t=i.force?1:s.options.saveThrottleServer;s.throttleSave("server",t,function(){$.ajax({type:"POST",url:s.api.setSavedTime,data:{video_id:s.id,time_to_save:e},success:function(){if(i.success){i.success()}}})})},throttleSave:function(e,i,s){var t=this;var o=(new Date).getTime();if(!t.timestamps[e]){t.timestamps[e]=o}if(t.timestamps[e]+i*1e3<o){s();t.timestamps[e]=o}},delete:function(){var e=this;_.each(e.deleteCalls,function(e){e()})},deleteCookie:function(){var e=this;$.removeCookie(e.settingName)},deleteServer:function(){}})})(this);
(function(n){"use strict";var e=n.Phoenix,t,i;if(!e){n.Phoenix=e={}}t=e.VideoPlayer=e.VideoPlayer||{};i=t.Views=t.Views||{};var u=t.log;i.AbstractApiInterface=Backbone.View.extend({name:"",initialized:false,playerReady:false,contentLoading:false,ApiInterfaceManager:null,initialize:function(n){},initApi:function(){},checkHasSource:function(){return true},checkContentExists:function(n){if(typeof n==="function"){n(true)}},play:function(){},pause:function(){},resume:function(){},seekTo:function(){},stop:function(){},setVolume:function(n){},mute:function(){},unMute:function(){},fullscreen:function(n){},getCurrentTime:function(){return 0},getDuration:function(){return 0},getVolume:function(){return 0}})})(this);
(function(e){"use strict";var a=e.Phoenix,t=$(document),r,n,i,u,o;if(!a){e.Phoenix=a={}}r=a.VideoPlayer=a.VideoPlayer||{};n=r.Views=r.Views||{};u=n.AbstractApiInterface;i=r.ApiInterfaces=r.ApiInterfaces||{};var d=r.log;var l=JSON.stringify;var c="[UVPJS] ";var v;var p=[];var f={skin:false};var y;var g=false;var m={category:"internal",name:"UVPJSDebug",enabled:true,params:[{name:"SkinManager",value:true},{name:"CVI_Model",value:true},{name:"EventsManager",value:true},{name:"ResourceProvider",value:true},{name:"videoManager",value:true},{name:"VideoControlInterface",value:true},{name:"CoreVideoInstance",value:true},{name:"ResourcePlaylistManager",value:true},{name:"ResourceConfigObject",value:true},{name:"TrackingManager",value:false},{name:"showTimestamps",value:true},{name:"showClockTime",value:false}]};var A={category:"model",name:"AdSettings",enabled:true,params:[{name:"ignoreAdLoadErrors",value:true}]};var E=function(e){return e.$el.attr("id")};var T=function(e){d(c+"cbsiVideoManager.createVideoPlayer start");var a=L(e);d(a);v.createVideoPlayer(E(e),function(t){d(c+"Video Control Interface ready");t.setPageContextMetadata(a);e.PlayerApi=t;C(e);e.states.ready=true;e.trigger("ready");e.ApiInterfaceManager.trigger("ready")},f);d(c+"cbsiVideoManager.createVideoPlayer complete");t.trigger("phoenix_cbsi_video_manager_setup_done")};var P=function(){var e;var a=function(){if(!p.length){return}$.each(p,function(e,a){T(a)})};return function(){if(typeof s!="undefined"){a()}else{if(!e){t.one("tracking_initialized",e=function(){d(c+"tracking NOT ready, initing player(s) momentarily");a()})}}}}();var I=function(){var e=false,a=false;return function(t,r){p.push(t);if(a){return}if(e){h(t);return}a=true;if(!!r.uvpHi5Ima){V()}d(c+"Load uvpjs: "+r.uvpjs);$.ajax({url:r.uvpjs,dataType:"script",async:true,cache:false,success:function(){e=true;a=false;o=window.uvpjs;h()}})}}();var V=function(){var e=false;return function(){if(e){return}d(c+"Load IMA js");if(g){$.ajax({url:"//imasdk.googleapis.com/js/sdkloader/ima3_debug.js",dataType:"script",cache:true,error:function(){d(c+"IMA debug script failed to load")},success:function(){d(c+"IMA debug script successfully loaded")}})}else{$.ajax({url:"//imasdk.googleapis.com/js/sdkloader/ima3.js",dataType:"script",cache:true,error:function(){d(c+"IMA script failed to load")},success:function(){d(c+"IMA script successfully loaded")}})}}}();var h=function(){var e=false,a=false;return function(t){if(a){return}if(e){P();return}a=true;v=new o.VideoManager;d(c+"Initialize cbsiVideoManager");v.initialize(y,function(){d(c+"cbsiVideoManager initialized");e=true;a=false;P()})}}();var C=function(a){var t=a.ApiInterfaceManager,r=a.PlayerApi,n="."+E(a)+".phoenix",i=e.uvpjs;var s=function(e){t.trigger(e.type,e.payload)};d(c+"Init VCI event listeners");r.addEventListener(i.EventType.AD_BLOCKED+n,s);r.addEventListener(i.EventType.AD_END+n,s);r.addEventListener(i.EventType.AD_SLOT_END+n,s);r.addEventListener(i.EventType.AD_START+n,s);r.addEventListener(i.EventType.AD_SLOT_START+n,s);r.addEventListener(i.EventType.CONTENT_DATA_LOADED+n,s);r.addEventListener(i.EventType.CONTENT_START+n,s);r.addEventListener(i.EventType.CONTENT_END+n,s);r.addEventListener(i.EventType.NO_AD_CONTENT+n,s);r.addEventListener(i.EventType.RESOURCE_START+n,s);r.addEventListener(i.EventType.VIDEO_DONE+n,s);r.addEventListener(i.EventType.VIDEO_ERROR+n,s);r.addEventListener(i.EventType.VIDEO_STATE_CHANGE+n,s);var u=0;r.addEventListener(i.EventType.VIDEO_PROGRESS+n,s)};var _=function(e){if(y){return}y={partner:e.partner,uvpc:{modules:e.tracking},usesIMA:!!e.uvpHi5Ima,cms:e.cms};y.uvpc.modules.push(A);if(g){y.uvpc.modules.push(m)}};var L=function(e){var a=e.ApiInterfaceManager,t=a.getVideoJson(),r=s.eVar69>0,n={videoAutoPlay:!!t.autoplay?"on":"off",deviceType:!!t.isDevice?"mobile":"desktop",dwAnonId:$.cookie(t.trackingCookie),pageType:s.eVar10,pageUrl:document.location.href,pageViewGuid:s.eVar24,siteCode:t.trackingSiteCode,sitePrimaryRsid:t.trackingPrimaryId,siteRsids:t.trackingAccount,siteSection:s.channel,siteHier:s.eVar6,siteType:t.siteType,userId:s.eVar69,userState:r?"authenticated":"not authenticated",userType:r?"registered":"anon",videoAssetSource:t.videoAssetSource};return n};var M=function(e){var a=e.$el,t=a.attr("id");a.append($('<div id="'+"content_"+t+'"/>'),$('<div id="'+"ad_"+t+'" class="js-vid-ima-ad av-video-player-hold av-ima-ad" />'))};var S=function(){var e=c+"[AD CALL] ";var t=function(t){var r=a.CampaignParams&&a.CampaignParams.getParams&&a.CampaignParams.getParams()||null;if(t&&r){d(e+"campaignParams: ",l(r));t=$.extend(t,r);d(e+"updated custParams: ",l(t))}return t};return function(a){var r=a.ApiInterfaceManager,n=r.getPlayerState("adPlayed"),i=r.getAdCallUrl(),s=r.getVideoJson(),u={},o={},c,v;if(!k(a)){return}d(e+"Get adCallUrl");i=decodeURIComponent(i);d(e+"Initial adCallUrl: ",i);c=i.split("?");if(c.length>1){i=c[0];u=$.deparam(c[1]);if(u.cust_params){o=$.deparam(u.cust_params);d(e+"custParams: ",l(o))}}v=$.cookie("AD_SESSION");if(!!v){if(o.session){o.session=v}else{o=$.extend({session:v},o)}}o=t(o);if(!$.isEmptyObject(o)){u.cust_params=$.param(o)}if(!$.isEmptyObject(u)){i=i+"?"+$.param(u)}return i}}();var R=function(e,a){var t=e.ApiInterfaceManager,r=t.getVideoUrl(),n=t.getVideoJson();var i={type:o.mediaCapabilities.RP_URL,mediaId:n.id,cmsRefGuid:n.guid,videoTitle:decodeURIComponent(n.title),assetURL:r,duration:n.lengthSeconds};if(!a){i.vidContId=E(e)}d(c+"RCO for video: ",i);return i};var O=function(a){var t=e.uvpjs,r;r=R(a,true);r.type=t.mediaCapabilities.RP_IMA;r.adCall=S(a);d(c+"getResoucesWithAdCall: ",r);return[r]};var k=function(e){var a=e.ApiInterfaceManager;return a.shouldPlayAd()};var D=function(e){var a=e.PlayerApi;a.onPreviewButton(function(){d(c+"Load new resource(s) and play");if(k(e)){a.addResourcesToPlaylist(O(e))}else{a.loadAndPlayResource(R(e))}e.states.resourceLoaded=true})};i.uvpjs=u.extend({name:"uvpjs",states:{ready:false,playing:false,resourceLoaded:false,shouldPlayAd:false},ApiInterfaceManager:null,PlayerApi:null,initialize:function(e){var a=this,t=a.ApiInterfaceManager=e.ApiInterfaceManager,r=e.videoJSON;M(a);_(r);I(a,r)},play:function(e){var a=this;d(c+"play video");if(e||!a.states.resourceLoaded){D(a)}else if(!a.states.playing){a.PlayerApi.playVideo()}a.states.playing=true},pause:function(){var e=this;d(c+"pause video");if(e.states.playing){e.PlayerApi.pauseVideo();e.states.playing=false}},resume:function(){var e=this;if(!e.states.resourceLoaded||e.states.playing){return}d(c+"resume video");e.PlayerApi.playVideo();e.states.playing=true},seekTo:function(e){var a=this;if(!a.states.resourceLoaded){return}d(c+"resume video");a.PlayerApi.seekTo(e)},stop:function(){var e=this;d(c+"stop video");e.PlayerApi.stopVideo();e.states.playing=false},setVolume:function(e){var a=this;d(c+"set volume to "+e);a.PlayerApi.setVolume(e)},mute:function(){var e=this;d(c+"mute");e.PlayerApi.mute()},unMute:function(){var e=this;d(c+"unMute");e.PlayerApi.unMute()},fullscreen:function(e){var a=this;d(c+"fullscreen");a.PlayerApi.fullscreen(e)},getCurrentTime:function(){var e=this.PlayerApi,a=e.getCurrentPlaybackState();return a.currentTime},getDuration:function(){var e=this.PlayerApi,a=e.getCurrentPlaybackState();return a.duration},getVolume:function(){var e=this.PlayerApi;return e.getVolume()}})})(this);
(function(e){"use strict";var t=e.Phoenix,a,r,n,i;if(!t){e.Phoenix=t={}}a=t.VideoPlayer=t.VideoPlayer||{};r=a.Views=a.Views||{};i=r.AbstractApiInterface;n=a.ApiInterfaces=a.ApiInterfaces||{};var o=a.log;var u=JSON.stringify;var s="[UVPJS-YT]";var f;var c;var l;var v='<iframe  frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen/>';var d="http://www.youtube.com/embed/";var p={wmode:"transparent",autoplay:"1"};var y="https://www.googleapis.com/youtube/v3/videos?part=id&id=",g="&key=",b=".js-vid-youtube";var I=function(e){var t;if(!e){return}t=d+e+"?"+$.param(p,true);o("youtube embed url: ",t);return t};var h=function(){if(undefined===f){f=$(v)}return f};var w=function(e){o(s+"Load new resource(s) and play");var t=e.ApiInterfaceManager.getPlayerState("currentTime")+"";if(t){p.start=t.split(".")[0]}var a=h();var r=I(l);a.attr("src",r);c.append(a);e.states.resourceLoaded=true};n.youtube=i.extend({name:"youtube",states:{ready:false,playing:false,resourceLoaded:false},videoJSON:null,ApiInterfaceManager:null,initialize:function(e){var t=this,a=t.ApiInterfaceManager=e.ApiInterfaceManager,r=t.videoJSON=e.videoJSON;c=t.$el;if(r){l=r.youtubeID}},checkHasSource:function(){var e=this,t=e.videoJSON;return t&&t.youtubeID},checkContentExists:function(e){if(typeof e!=="function"){return}var t=this.videoJSON,a=t.youtubeID,r=t.youtubeKey,n;if(!a){e(false)}else{n={url:y+a+g+r,beforeSend:function(){o("Checking youtubeID "+a+" against API")},error:function(t,r){o("Error checking youtubeID "+a,[t,r]);e(false)},success:function(t){if(t.pageInfo.totalResults>=1){e(true)}else{e(false)}}};$.ajax(n)}},play:function(e){var t=this;o(s+"play video");if(e||!t.states.resourceLoaded){w(t)}t.states.playing=true;t.ApiInterfaceManager.trigger("onContentStart")},pause:function(){var e=this;c.empty();e.states.playing=false}})})(this);
(function(e){"use strict";var a=e.Phoenix,t,r,i,n;if(!a){e.Phoenix=a={}}t=a.VideoPlayer=a.VideoPlayer||{};r=t.Views=t.Views||{};n=r.AbstractApiInterface;i=t.ApiInterfaces=t.ApiInterfaces||{};var s=t.log;var o=JSON.stringify;var c="[UVPJS-Chromecast]";var u;var d;var l=function(e){s(c+"Load new resource(s) and play");var a=e.ApiInterfaceManager.getPlayerState("currentTime")+"";if(a){youtubeBaseEmbedParams.start=a.split(".")[0]}var t=getPlayer();var r=getVideoEmbedUrl(d);t.attr("src",r);u.append(t);e.states.resourceLoaded=true};i.chromecast=n.extend({name:"chromecast",states:{ready:false,playing:false,resourceLoaded:false},Media:null,Session:null,timingInterval:null,videoJSON:null,ApiInterfaceManager:null,initialize:function(e){var a=this,t=a.ApiInterfaceManager=e.ApiInterfaceManager,r=a.videoJSON=e.videoJSON;u=a.$el},setMedia:function(e){var a=this;a.Media=e;a.timingInterval=setInterval(_.bind(a.mediaStatusUpdate,a),1e3)},setSession:function(e){var a=this;a.Session=e},mediaStatusUpdate:function(){var e=this;var a=e.getCurrentTime();e.ApiInterfaceManager.trigger("onVideoProgress",{currentTime:a})},play:function(e){var a=this;s(c+"play video");a.Media.play();a.states.playing=true;a.ApiInterfaceManager.trigger("onContentStart")},resume:function(){var e=this;s(c+"resume video");e.Media.play()},pause:function(){var e=this;s(c+"pause video");e.Media.pause()},stop:function(){var e=this;s(c+"stop casting video");e.Media.stop();e.Session.stop();clearInterval(e.timingInterval)},seekTo:function(e){var a=this;a.ApiInterfaceManager.trigger("onVideoProgress",{currentTime:e});var t=new chrome.cast.media.SeekRequest;t.currentTime=parseInt(e);a.Media.seek(t)},getCurrentTime:function(){var e=this;return e.Media.getEstimatedTime()}})})(this);
(function(e){"use strict";var r=e.Phoenix,n,t;if(!r){e.Phoenix=r={}}n=r.VideoPlayer=r.VideoPlayer||{};t=n.Views=n.Views||{};var i=n.log;t.AbstractPreference=Backbone.View.extend({name:"",disabled:false,controlType:"preference",els:{},states:{},preferences:{},Player:null,Preferences:null,initialize:function(e){var r=this;r.Player=e.Player;r.Preferences=e.Preferences;r.name=e.name},choosePreference:function(e){var r=this,n=$(e.currentTarget),t;e.preventDefault();if(r.disabled){return}t=r.setPreference(n);r.savePreferences(t)},getValue:function(e){return e.data("cmd-value")},savePreferences:function(e){var r=this;if(e){r.trigger("change",e)}},loadPreference:function(e){return true},setPreference:function(e){},disable:function(e){this.disabled=e}})})(this);
(function(e){"use strict";var a=e.Phoenix,s,r,t;if(!a){e.Phoenix=a={}}s=a.VideoPlayer=a.VideoPlayer||{};r=s.Views=s.Views||{};t=s.Controls=s.Controls||{};var l=s.log;var i={$modal:".js-vid-modal-share",$toggle:".js-vid-share",$shareTypes:".js-vid-share-type",$shareTypesBody:".js-vid-share-types-body",$shareTypeOptions:".js-vid-share-type-options",$sizeOptions:".js-vid-share-sizes",$shareMarkupData:".js-vid-share-markup-data",$shareMarkup:".js-vid-share-markup",$shareEmbedUrl:".js-share-embed-url",$shareLinkUrl:".js-share-link-url",$startCbx:".js-start-checkbox",$endCbx:".js-end-checkbox",$startTime:".js-start-time",$endTime:".js-end-time",$autoplayCbx:".js-autoplay-checkbox",$loopCbx:".js-loop-checkbox",$typeSelect:".js-share-type-select",$embedOptions:".js-embed-modal",$shareText:".js-vid-share-markup"};var n="[EMBED] ";var o="dn",h="av-ctrl-on";var d=function(e){e.toggleClass(o,true)};var c=function(e){e.toggleClass(o,false)};var u=function(e){$.each(i,function(a,s){e.els[a]=e.$(s)})};var p=function(e){var a="";var s=e.split(":");var r=0;var t=0;if(s.length===2){r=parseInt(s[0]);r=isNaN(r)?0:r;t=parseInt(s[1]);t=isNaN(t)?0:t;if(t>=60){r+=Math.floor(t/60);t=t%60}}else{t=parseInt(s[0]);t=isNaN(t)?0:t}return(r>0?r+"m":"")+t+"s"};var v=function(e){var a=e.sizeMarkupMap={},s;u(e);if(!e.els.$modal.length){return}e.defaultSize=e.els.$sizeOptions.find("option:eq(0)").val();e.changeShareModalCode()};var m=function(e){var a=e.Player,s=e.els.$modal,r,t=e.shareType,l="";if(t==="embed"){r=e.els.$sizeOptions.find("option:selected");e.currentSize=r.val()||e.defaultSize;var i=e.els.$shareMarkupData.filter("[data-embed-size="+e.currentSize+"]");var n=$(i.html());n.attr("src",e.getUrlWithParams("embed"));l=n.prop("outerHTML").replace(/&amp;/g,"&")}else{l=e.getUrlWithParams("link")}e.els.$shareMarkup.val(l)};t.Share=Backbone.View.extend({name:"share",defaultSize:null,sizeMarkupMap:null,hasStartFocused:false,shareType:null,els:{$modal:null,$toggle:null,$sizeOptions:null,$sizeMarkupElements:null},events:{"click .js-vid-share":"toggleShare","keydown .js-end-time, .js-start-time, .js-vid-share-markup":"timeKeydown","keyup .js-end-time, .js-start-time":"changeShareModalCode","click .js-vid-share-markup":"selectMarkup","change .js-refresh-share-code":"changeShareModalCode","change .js-share-type-select":"changeShareType","click .js-vid-share-type":"setShareType"},Player:null,initialize:function(e){var a=this,s;s=a.Player=e.Player;s.on("videoProgress",function(e){a.updateTime(e)});v(a)},updateTime:function(e){var a=this;if(a.els.$startTime.is(":focus")||a.els.$shareMarkup.is(":focus")){a.hasStartFocused=true}if(a.hasStartFocused){return}var s=Math.floor(e.currentTime);var r=Math.floor(s/60);var t=s%60;a.els.$startTime.val(r+":"+(t<10?"0"+t:t));a.els.$startTime.change()},toggleShare:function(e){var a=this,s=a.Player,r=s.states,t=!r.share;e.preventDefault();s.setStates({share:t});if(t){$(e.currentTarget).trigger("customEventTracking")}a.els.$toggle.toggleClass(h,t)},selectMarkup:function(e){$(e.currentTarget).select()},changeShareType:function(e){var a=this;a.els.$embedOptions.toggleClass("hide")},setShareType:function(e){var a=this,s=$(e.currentTarget),r=s.data("share-type"),t=a.els.$shareTypeOptions;a.els.$shareTypes.removeClass("av-ctrl-on");a.els.$shareTypesBody.removeClass("av-share-types-body--"+a.shareType).addClass("av-share-types-body--"+r);s.addClass("av-ctrl-on");t.each(function(){var e=$(this);e.toggleClass("hide",e.data("share-type")!==r)});a.shareType=r;m(a)},getUrlWithParams:function(e){var a=this,s=a.els;var r=e==="link"?s.$shareLinkUrl.attr("value"):s.$shareEmbedUrl.attr("value");var t="";if(s.$startCbx.is(":checked")){t+="?t="+p(s.$startTime.val())}if(s.$endCbx.is(":checked")&&s.$endTime.val()){t+=t.length===0?"?":"&";t+="e="+p(s.$endTime.val())}if(s.$autoplayCbx.is(":checked")){t+=t.length===0?"?":"&";t+="autoplay=1"}if(s.$loopCbx.is(":checked")){t+=t.length===0?"?":"&";t+="loop=1"}return r+t},changeShareModalCode:function(e){var a=this,s=a.Player,r=a.els.$modal,t,l="";m(a)},timeKeydown:function(e){e.stopPropagation()}})})(this);
(function(e){"use strict";var l=e.Phoenix,i,a,r;if(!l){e.Phoenix=l={}}i=l.VideoPlayer=l.VideoPlayer||{};a=i.Views=i.Views||{};r=i.Controls=i.Controls||{};r.PlayPause=Backbone.View.extend({events:{"click .js-vid-play-pause":"togglePlay","click .js-vid-play":"togglePlay","click .js-vid-player-holder":"togglePlay",keypress:"keypressHandler"},Player:null,initialize:function(e){var l=this,i;i=l.Player=e.Player},togglePlay:function(e){var l=this,i=l.Player,a=i.states;e.preventDefault();if(a.playing){return i.pause()}else if(a.started){return i.resume()}else{return i.play()}},keypressHandler:function(e){if(e.which===32||e.which===107){return this.togglePlay(e)}}})})(this);
(function(e){"use strict";var t=e.Phoenix,l,o,u;if(!t){e.Phoenix=t={}}l=t.VideoPlayer=t.VideoPlayer||{};o=l.Views=l.Views||{};u=l.Controls=l.Controls||{};u.Volume=o.AbstractPreference.extend({events:{"mousedown .js-vid-volume":"volumeChange","touchstart .js-vid-volume":"volumeChange","mousedown.volumeSlide":"volumeSlideStart","mouseup.volumeSlide":"volumeSlideStop","touchstart.volumeSlide":"volumeSlideStart","touchend.volumeSlide":"volumeSlideStop","click .js-vid-mute":"toggleMute",keydown:"hotkeyHandler"},els:{$handle:null,$volume:null,$bar:null,$mute:null},states:{mute:false,volume:1},mousemoveEvent:"mousemove.volumeSlide",touchmoveEvent:"touchmove.volumeSlide",Player:null,Preferences:null,initialize:function(e){var t=this,l;o.AbstractPreference.prototype.initialize.call(t,e);l=t.Player=e.Player;t.els.$volume=t.$el.find(".js-vid-volume");t.els.$handle=t.$el.find(".js-vid-volume-handle");t.els.$level=t.$el.find(".js-vid-volume-level");t.els.$bar=t.$el.find(".js-vid-volume-bar");t.els.$mute=t.$el.find(".js-vid-mute");l.on("setVolume",function(e){t.moveVolumeHandle(e)});l.on("contentStart",function(){if(l.states.mute){l.mute()}})},loadPreference:function(e){var t=this,l=t.Player,o=l.states;if(e&&typeof e.volume!==undefined){t.setVolume(e.volume,true);t.states.volume=e.volume}if(e&&typeof e.mute!==undefined){t.setMute(e.mute,true);t.states.mute=e.mute}},setPreference:function(e){var t=this,l=t.Player,o=l.states;var u={};if(e===t.els.$volume){t.states.volume=u.volume=o.volume}else if(e===t.els.$mute){t.states.mute=u.mute=o.mute}t.savePreferences(u);return u},moveVolumeHandle:function(e){var t=this;var o=l.ratioToPercentString(e);t.els.$level.css("width",o);t.els.$handle.css("left",o)},setMute:function(e,t){var l=this,o=l.Player,u=o.states;if(e){o.mute();l.moveVolumeHandle(0)}else{if(u.volume>0){o.unMute();l.moveVolumeHandle(u.volume)}}if(!t){l.setPreference(l.els.$mute)}},setVolume:function(e,t){var l=this,o=l.Player,u=o.states;l.setMute(e<=0,t);o.setVolume(e);if(!t){l.setPreference(l.els.$volume)}},toggleMute:function(e){var t=this,l=t.Player,o=l.states;t.setMute(!o.mute)},volumeChange:function(e){var t=this,o=t.Player;var u=l.getEventInContainerRatio(e,t.els.$volume);t.setVolume(u)},volumeSlideStart:function(e){var t=this;var l=e.type==="mousedown"?t.mousemoveEvent:t.touchmoveEvent;t.els.$volume.on(l,function(e){t.volumeChange(e)})},volumeSlideStop:function(e){var t=this;var l=e.type==="mouseup"?t.mousemoveEvent:t.touchmoveEvent;t.els.$volume.off(l)},hotkeyHandler:function(e){var t=this,l=t.Player;if(e.which===38){var o=l.getVolume()+.05;t.setVolume(o<1?o:1);e.preventDefault()}else if(e.which===40){var o=l.getVolume()-.05;t.setVolume(o>0?o:0);e.preventDefault()}else if(e.which===77){t.toggleMute();e.preventDefault()}}})})(this);
(function(e){"use strict";var l=e.Phoenix,n,r,s;if(!l){e.Phoenix=l={}}n=l.VideoPlayer=l.VideoPlayer||{};r=n.Views=n.Views||{};s=n.Controls=n.Controls||{};var t=function(e){var l=$("<video></video>")[0];if(e.requestFullscreen||e.msRequestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||l.webkitEnterFullscreen){return true}return false};s.Fullscreen=Backbone.View.extend({events:{"click .js-vid-fullscreen":"toggleFullscreen","click .js-vid-fillbrowser":"toggleFillBrowser","dblclick .js-vid-player-holder":"toggleFullscreen",keyup:"keypressHandler"},Player:null,enteringFullscreen:false,$docRoot:$("html, body"),initialize:function(e){var l=this,n,r=l.$(".js-vid-fullscreen"),s,i=l.$(".js-vid-fillbrowser"),u=false;n=l.Player=e.Player;if(!t(n.el)){s=l.$(".js-vid-fullscreen-wrap");s.remove();r.remove();u=true}$(window).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(e){l.fullscreenChange()});n.on("initControlsComplete",function(e){if(e.embiggen){return}var n=l.$(".js-vid-fillbrowser-only-wrap");if(n.length){n.removeClass("av-option-alt")}})},toggleFullscreen:function(e){var l=this,n=l.Player,r=n.states;e.preventDefault();l.setWindowed(false);if(r.fullscreen){return l.exitFullscreen()}else{return l.enterFullscreen()}$(window).trigger("resize")},toggleFillBrowser:function(e){var l=this,n=l.Player,r=n.states;l.setWindowed(!r.windowed);$(window).trigger("resize")},fullscreenChange:function(e){var l=this,n=l.Player;var r=l.isFullscreen();if(r){if(l.enteringFullscreen){l.enteringFullscreen=false}else{return}l.$docRoot.addClass("body-fullscreen")}else{l.$docRoot.removeClass("body-fullscreen")}n.setStates({fullscreen:r});n.trigger("fullscreen",r);$(window).trigger("resize");$(window).trigger("mouseMove");n.$el.focus()},isFullscreen:function(){var e=false;if(document.msFullscreenElement){e=document.msFullscreenEnabled}else if(document.mozFullScreenElement){e=document.mozFullScreenEnabled}else if(document.webkitFullscreenElement){e=document.webkitFullscreenEnabled}else if(document.fullscreenElement){e=document.fullscreenEnabled}return e},enterFullscreen:function(){var e=this,l=e.Player,n=l.el,r=l.$el.find("video")[0];e.enteringFullscreen=true;if(l.states.disabled){return false}if(n.requestFullscreen){n.requestFullscreen()}else if(n.msRequestFullscreen){n.msRequestFullscreen()}else if(n.mozRequestFullScreen){n.mozRequestFullScreen()}else if(n.webkitRequestFullscreen){n.webkitRequestFullscreen()}else if(r&&r.webkitEnterFullscreen){r.webkitEnterFullscreen();$(r).off("webkitendfullscreen");$(r).on("webkitendfullscreen",function(){if(r.paused){l.pause()}})}return true},exitFullscreen:function(){var e=this,l=e.Player,n=l.$el[0];if(l.states.disabled){return false}if(document.exitFullscreen){document.exitFullscreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}return true},setWindowed:function(e){var l=this,n=l.Player,r=n.states;if(e){l.$docRoot.addClass("body-fauxscreen");l.Player.el.focus()}else{l.$docRoot.removeClass("body-fauxscreen")}n.setStates({windowed:e})},keypressHandler:function(e){var l=this,n=l.Player;if(e.which===70){l.enterFullscreen()}else if(e.which===71){l.setWindowed(true)}else if(e.which===27){l.exitFullscreen();l.setWindowed(false);$(window).trigger("resize")}}})})(this);
(function(e){"use strict";var a=e.Phoenix,t,i,l;if(!a){e.Phoenix=a={}}t=a.VideoPlayer=a.VideoPlayer||{};i=t.Views=t.Views||{};l=t.Controls=t.Controls||{};var r=t.log;var n="[CONTROL] ";var s="dn",u="av-ctrl-on";var c=[{selector:".js-vid-h264",modernizrProp:"h264"},{selector:".js-vid-m3u8-wrapped",modernizrProp:"h264"},{selector:".js-vid-m3u8:not(.js-vid-m3u8-wrapped)",modernizrProp:"hls"}];var o=function(e){var a=e.els,t=e.Player,i=t.ApiInterfaceManager,l=a.$playbackOptions,s=a.$qualityOptions,u={},c={},o,d=false,v=false,p=[];r(n+"initPlaybackQualities");if(s){r(n+"$qualities: ",s);s.each(function(){var a=$(this),t=e.getValue(a);if(y(a)){if(!c[t]){c[t]=[]}c[t].push(this)}})}else{r("error",n+"No qualities defined!");l=undefined}if(!!l){r(n+"$playbacks: ",l);l.each(function(){var a=$(this),t=e.getValue(a),l=a.data("player"),s=i.getInterface(l),y=f(a),d=s&&s.checkHasSource(),b=y&&d,h=a.data("qualities").split(","),P=[],g,q=[];if(u[t]){return}for(o=0;o<h.length;o++){g=h[o];if(c[g]){$.merge(q,c[g]);P.push(g)}}if(b&&$.inArray(l,p)<0){p.push(l)}if(P.length>0){v=true}u[t]={isAvailable:b,playerType:l,qualities:P,$button:a,$qualities:$(q)};if(!b){k(a)}else{s.checkContentExists(function(e){if(!e){k(a)}})}r(n+"Playback Quality Elements for ["+t+"]: ",u[t])});if(p.length>0){e.playbacks=u;d=true}}return d&&v};var f=function(e){return!!e&&e.length>0&&e.closest("html").length>0&&!e.hasClass(s)};var y=function(e){var a=true;if(typeof Modernizr!=="undefined"&&Modernizr.video){$.each(c,function(t,i){if(e.is(i.selector)&&!Modernizr.video[i.modernizrProp]){a=false;return false}})}return a};var d=function(e){return!!e&&e.hasClass(u)};var v=function(e,a){return e.data("cmd-value")===a};var p=function(e){var a=e.filter(".js-vid-default"),t;a=a.not("."+s);t=a.first();if(t.length<1||t.closest("body").length<1){t=e.first()}return t};var b=function(e,a){var t=e.filter(function(){var e=$(this);return true===f(e)&&true===v(e,a)});return t};var h=function(e,a,t){if(!e||0===e.length){return}if(true===a){e.addClass(t)}else if(false===a){e.removeClass(t)}};var k=function(e){r("hideControls: ",e);q(e);h(e,true,s);h(e.closest(".js-vid-quality-wrap"),true,s)};var P=function(e){h(e,false,s);h(e.closest(".js-vid-quality-wrap"),false,s)};var g=function(e){h(e,true,u)};var q=function(e){h(e,false,u)};var m=function(e){var a=e.$(".js-vid-playbacks"),t;if(!a.length){return}t=a.find(".js-vid-menu");e.els.$menu=t};var C=function(){var e="av-menu-disabled";return function(a){var t=a.els.$menu;if(!t){return}t.toggleClass(e,a.disabled)}}();l.PlaybackQuality=i.AbstractPreference.extend({name:"playbackQuality",els:{},states:{playback:null,quality:null},playback:{},qualities:{},events:{"click .js-vid-playback":"choosePreference","click .js-vid-quality":"choosePreference"},Player:null,Preferences:null,initialize:function(e){var a=this,t,l;i.AbstractPreference.prototype.initialize.call(this,e);t=a.Player;t.on("adStart",function(){if(!a.disabled){a.disable(true)}});t.on("contentStart",function(){if(a.disabled){a.disable(false)}});a.els.$qualityOptions=a.$(".js-vid-quality");a.els.$playbackOptions=a.$(".js-vid-playback");l=o(a);if(!l){a.$(".js-vid-invalid-playbacks").show()}m(a);a.on("saved",function(){a.qualityChanged()});r(n+"hasPlaybacks? ",l)},choosePreference:function(e){var a=$(e.currentTarget);if(!this.disabled&&a.hasClass("js-vid-playback")){e.stopPropagation()}i.AbstractPreference.prototype.choosePreference.call(this,e)},loadPreference:function(e){var a=this,t=false,i,l,s,u,c,o,f,y=a.els.$playbackOptions,d=a.els.$qualityOptions;i=e.playback;f=e.quality;if(i){u=b(y,i);if(0===u.length){i=undefined}else{s=a.playbacks[i]||{};l=!!s.isAvailable;if(l){o=s.qualities}}a.setPlayback(i)}if(f){c=b(d,f);o=$.map(d,function(e){return $(e).data("cmd-value")});if(0===c.length){f=undefined}a.setQuality(c.data("cmd-value"))}if(!i){u=p(y);i=a.getValue(u);s=a.playbacks[i];o=s.qualities;if(e.playback){r(n+"playback ["+e.playback+"] is invalid -- use default playback ["+i+"]");if(null===l){t=true;delete e.playback}}a.setPlayback(i)}if(!f){var v=p(a.els.$qualityOptions);f=a.getValue(v);a.setQuality(v.data("cmd-value"))}f=e.quality;if(f&&0>$.inArray(f,o)){t=true;delete e.quality}return t},setPreference:function(e){var a=this,t=a.getValue(e),i,l;if(e.hasClass("js-vid-quality")){i=a.setQuality}else if(e.hasClass("js-vid-playback")){i=a.setPlayback}if(!i){return}l=i.call(a,t);r(n+"setPreference changeSet: ",l);return l},disable:function(e){var a=this;i.AbstractPreference.prototype.disable.call(a,e);C(a)},setControl:function(e,a){var t=false,i;i=b(e,a);if(i.length>0&&false===d(i)){r(n+"New Value Control for ["+a+"]: ",i);t=true;g(i);q(e.not(i))}return t},setQuality:function(e,a,t){var i=this,l=i.Player,s=i.els.$qualityOptions,u=i.setControl(s,e),c;if(true===u){r(n+"setQuality newValue: "+e);l.setStates({quality:e});i.states.quality=e;c={quality:e}}return c},qualityChanged:function(e){var a=this,t=a.Player;return t.updateQuality()},setPlayback:function(e){var a=this,t=a.els,i=t.$qualityOptions,l=a.setControl(t.$playbackOptions,e),s,u,c,o,f=a.Preferences.getPreference("quality"),y=a.Player,d,v;var b=a.playbacks[e];if(true===l){r(n+"setPlayback to: ",e);d=b.playerType;y.setStates({playback:e,playerType:d});a.states.playback=e;v={playback:e};u=b["$qualities"];c=i.not(u);k(c);P(u);s=b["qualities"];r(n+"> available qualities for playback: ",s);r(n+"> current activeQuality: ",f);if(!f||0>$.inArray(f,s)){r(n+"> activeQuality not found for playback");o=p(u);f=a.getValue(o);r(n+"> set activeQuality to: ",f)}a.setQuality(f,true);y.trigger("updatePlayback",y)}return v}})})(this);
(function(e){"use strict";var r=e.Phoenix,t,i,o;if(!r){e.Phoenix=r={}}t=r.VideoPlayer=r.VideoPlayer||{};i=t.Views=t.Views||{};o=t.Controls=t.Controls||{};o.Report=Backbone.View.extend({events:{"click .js-vid-report-suck":"reportSuck"},els:{$reportSuckData:null},Player:null,initialize:function(e){var r=this,t;t=r.Player=e.Player;r.els.$reportSuckData=$(".js-vid-report-suck-data")},reportSuck:function(e){var r=this,i=r.Player;e.preventDefault();if(!confirm("This will send us a report that we will use to diagnose\n"+"video playback issues. Are you sure you want to send us a report?\n"+"\r\rPLEASE only do this if you are experiencing issues with the video player.")){return}var o=r.els.$reportSuckData;var a="NONE";try{var s=t.getLogLines();a=JSON.stringify(s)}catch(e){a="ERROR: "+e.toString()}$.ajax({type:"POST",url:"/videos/report/suck",data:{uniqueKey:o.data("unique-key"),videoId:o.data("video-id"),trace:a}}).done(function(e){alert("Thanks, we're sorry you're having problems. This report will help us fix them. Please only send one report per video")})}})})(this);
(function(e){"use strict";var t=e.Phoenix,i,n,s;if(!t){e.Phoenix=t={}}i=t.VideoPlayer=t.VideoPlayer||{};n=i.Views=i.Views||{};s=i.Controls=i.Controls||{};var r=i.log;var a="sticky";var c={zIndex:5000050,noStop:true,unstickyOnAjax:false};var l=function(e,t){var i=false,n=e.Player,s=e.els,r=s.$stickyContainer,a=n.states.stickied||false;if($.sticky&&r&&a!==t){i=true;if(true===t){$.sticky(r,c,function(){o(e,true)},function(){o(e,false)})}else{$.destroySticky(r);o(e,false)}n.setStates({stickied:t});e.setPreference()}return i};var o=function(e,t){var i=e.els.$stickyContainer,n=e.els.$videoSpacer,s=!!n.length;if(e.disabled){return}if(t){r("add sticky");i.addClass(a);if(s){n.height(i.outerHeight(true))}}else{r("remove sticky");i.removeClass(a);if(s){n.height("auto")}}};s.Pin=n.AbstractPreference.extend({name:"pin",events:{"click .js-vid-pin-wrap":"toggleSticky"},els:{$videoSpacer:null,$stickyContainer:null,$stickyPinButtonContainer:null,$stickyPinButton:null},Player:null,stickyClassName:"sticky",stickySettings:{zIndex:5000050,noStop:true,unstickyOnAjax:false},initialize:function(e){var t=this,i,s=t.els,r=true;n.AbstractPreference.prototype.initialize.call(t,e);i=t.Player=e.Player;s.$videoSpacer=$("#video-spacer");s.$stickyContainer=t.$el.closest(".js-video-sticky");s.$stickyPinButtonContainer=t.$el.find(".js-vid-pin-wrap");s.$stickyPinButton=t.$el.find(".js-vid-pin");if(!s.$stickyPinButton.length){r=false}if(r&&!s.$stickyContainer.length){r=false;s.$stickyPinButton.remove();if(s.$stickyPinButtonContainer.length){s.$stickyPinButtonContainer.remove()}}if(!r){t.disable(true);t.stopListening()}},loadPreference:function(e){var t=this;if(t.disabled){return}if(e&&e.stickied===true){l(t,e.stickied)}},setPreference:function(){var e=this,t=e.Player,i=t.states;if(e.disabled){return}var n={stickied:i.stickied};e.savePreferences(n);return n},toggleSticky:function(e){var t=this,i=t.Player,n=i.states;if(t.disabled){return}r("toggle sticky!");l(t,!n.stickied)}})})(this);
(function(e){"use strict";var a=e.Phoenix,t,s,r;if(!a){e.Phoenix=a={}}t=a.VideoPlayer=a.VideoPlayer||{};s=t.Views=t.Views||{};r=t.Controls=t.Controls||{};var i=t.log;var o="[Chromecast] ";r.Chromecast=Backbone.View.extend({name:"chromecast",events:{"click .js-vid-chromecast":"chromecastBroadcast"},els:{$chromecastWrap:null,$chromecastButton:null},Player:null,Media:null,Session:null,PreviousStates:{},startTime:0,initialize:function(e){var a=this,t,s=a.els;t=a.Player=e.Player;s.$chromecastWrap=a.$el.find(".js-vid-chromecast-wrap");s.$chromecastButton=a.$el.find(".js-vid-chromecast");window["__onGCastApiAvailable"]=function(e,t){if(e){var s=new chrome.cast.SessionRequest(chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID);var r=new chrome.cast.ApiConfig(s,_.bind(a.sessionListener,a),_.bind(a.receiverListener,a));chrome.cast.initialize(r,_.bind(a.onInitSuccess,a),_.bind(a.onError,a))}else{i("Error",t)}}},sessionListener:function(e){i(o+"Session Established",e)},receiverListener:function(e){var a=this,t,s=a.els;if(e===chrome.cast.ReceiverAvailability.AVAILABLE){$(s.$chromecastWrap).removeClass("hide")}},onInitSuccess:function(e){i(o+"Chromecast Initialized",e)},onRequestSessionSuccess:function(e){var a=this,t=a.Player,s=t.ApiInterfaceManager;a.PreviousStates.playback=t.states.playback;a.PreviousStates.playerType=t.states.playerType;t.setStates({playback:"chromecast",playerType:"chromecast"});t.trigger("updatePlayback",t);var r=e;a.Session=r;var i=new chrome.cast.media.MediaInfo(s.getVideoUrl(true));var o=new chrome.cast.media.LoadRequest(i);r.addUpdateListener(_.bind(a.onSessionStatusUpdate,a));r.loadMedia(o,a.onMediaDiscovered.bind(a,"loadMedia"),a.onMediaError)},onMediaDiscovered:function(e,a){var t=this,s=t.Player,r=s.ApiInterfaceManager;var i=r.getActiveInterface(a);t.Media=a;i.setMedia(t.Media);i.setSession(t.Session);t.Media.addUpdateListener(_.bind(t.onMediaStatusUpdate,t));if(t.startTime>0){s.setStates({customStartTime:t.startTime})}s.play();s.setStates({chromecast:true,played:false})},onMediaStatusUpdate:function(e){i(o+"Media error",e)},onSessionStatusUpdate:function(e){var a=this;i(o+"Chromecast status update",e);if(a.Session.status!==chrome.cast.SessionStatus.CONNECTED){a.resetPlayback()}},onMediaError:function(e){i(o+"Media error",e)},onError:function(e){i(o+"General error",e)},onLaunchError:function(e){i(o+"Launch error",e)},chromecastBroadcast:function(e){var a=this,t=a.Player,s=t.states;if(a.disabled){return}a.startTime=t.getCurrentTime();if(s.chromecast){a.resetPlayback()}else{i(o+"Broadcast");chrome.cast.requestSession(_.bind(a.onRequestSessionSuccess,a),_.bind(a.onLaunchError,a))}},resetPlayback:function(){var e=this,a=e.Player;i(o+"Reset playback");if(!a.states.chromecast){return}var t=a.getCurrentTime();a.stop();a.setStates({chromecast:false,playback:e.PreviousStates.playback,playerType:e.PreviousStates.playerType,customStartTime:t});a.trigger("updatePlayback",a);a.play(true)}})})(this);
(function(e){"use strict";var i=e.Phoenix,n,g,t;if(!i){e.Phoenix=i={}}n=i.VideoPlayer=i.VideoPlayer||{};g=n.Views=n.Views||{};t=n.Controls=n.Controls||{};var r=n.log;var a=function(e,i){var n=false,g=e.els,t=e.Player,r=g.$embiggenContainer,a=g.$embiggenButton,s=g.$embiggenVidSize,l=a.data("cmd-value")||false,o=s.data("embiggen-class"),m=s.data("debiggen-class");if(l!==i){n=true;if(true===i){s.removeClass(m).addClass(o);r.addClass("large").removeClass("small medium");t.trigger("embiggen")}else{s.removeClass(o).addClass(m);r.addClass("small").removeClass("medium large");t.trigger("debiggen")}$(window).trigger("resize");a.data("cmd-value",i);t.setStates({embiggened:i})}return n};t.Embiggen=g.AbstractPreference.extend({name:"embiggen",events:{"click .js-vid-embiggen":"toggleEmbiggen"},Player:null,els:{$embiggenContainer:null,$embiggenVidSize:null,$embiggenButtonContainer:null,$embiggenButton:null},initialize:function(e){var i=this,n=i.$el,t=i.els,r,a=true;g.AbstractPreference.prototype.initialize.call(i,e);r=i.Player=e.Player;t.$embiggenContainer=r.$el.closest(".js-video-embiggen");t.$embiggenVidSize=r.$el.closest(".js-video-size");t.$embiggenButtonContainer=i.$(".js-vid-embiggen-wrap");t.$embiggenButton=i.$(".js-vid-embiggen");if(!t.$embiggenButton.length){a=false}if(a&&(!t.$embiggenVidSize.length||!t.$embiggenContainer.length)){a=false;t.$embiggenButton.remove();if(t.$embiggenButtonContainer.length){t.$embiggenButtonContainer.remove()}}if(!a){i.stopListening()}},loadPreference:function(e){var i=this;if(i.disabled){return}if(e&&e.embiggened===true){a(i,true)}},setPreference:function(){var e=this,i=e.Player,n=i.states;if(e.disabled){return}var g={embiggened:n.embiggened};e.savePreferences(g);return g},toggleEmbiggen:function(e){var i=this,n=i.Player,g=n.states;if(i.disabled){return}r("toggle embiggen!");a(i,!g.embiggened);i.setPreference()}})})(this);
(function(e){"use strict";var t=e.Phoenix;if(!t){e.Phoenix=t={}}var a=t.VideoPlayer=t.VideoPlayer||{};var i=a.Views=a.Views||{};var s=a.log;var l="[AD CALLS] ";i.AdUtilities=Backbone.View.extend({Player:null,initialize:function(e){var t=this;t.Player=e.Player;t.$infoMessage=$(".js-player-message");s(l+"AdUtilities");t.Player.on("adStart",function(){t.$infoMessage.html("Your content will start shortly...");t.Player.setStates({adPlaying:true,adPlayed:true,isSeekDisabled:true})});t.Player.on("contentStart",function(){t.$infoMessage.html("");t.Player.setStates({adPlaying:false,contentStarted:true,isSeekDisabled:false})})}})})(this);
(function(e){"use strict";var a=e.Phoenix,t,i;if(!a){e.Phoenix=a={}}t=a.VideoPlayer=a.VideoPlayer||{};i=t.Views=t.Views||{};var s=t.log;var r={$ageDate:".js-vid-age-gate-date",$ageDay:".js-vid-age-gate-day",$ageMonth:".js-vid-age-gate-month",$ageYear:".js-vid-age-gate-year"};var o="[AGE GATE] ";var g=function(e){$.each(r,function(a,t){e.els[a]=e.$(t)})};i.AgeGate=Backbone.View.extend({els:{},initialize:function(e){var a=this;g(a)},hasAgeGate:function(e){var a=this,t=a.$el,i=e.contentRating,r=true;if(!t||!i||true===a.isOfAge(e)){s(o+"no gate");r=false}else{s(o+"has gate")}return r},isAgeGated:function(e){var a=this,t=a.els,i=a.$el,r=t.$ageYear,g=e.videoJSON,n=g.ageGateCookieName,f,l,u,h,v=false;s(o+"Checking...");if(true===a.hasAgeGate(g)){if(false===a.isOfAge(g)){v=true}else if(false===e.states.showAgeGate){v="prompt"}else{h=r.val();s(o+"Year selected: "+h);if("year"===h){s("warning",o+"missing year value");v="Please select a year value to validate your age!"}else{u=t.$ageMonth.val();l=t.$ageDay.val();f=[h,u,l].join("-");if(!!n){$.cookie(n,f,{path:"/",expires:2e3})}if(!a.isOfAge(g,f)){s(o+"User is not old enough");v=true}}}}if(false===v){s(o+"User is old enough");e.setStates({hasGate:false,showAgeGate:false});if(!!i&&i.length>0){i.remove();delete t.$ageGate}}if(true===v){a.gate(e)}else if("prompt"===v){a.promptAgeGate(e)}else if("string"===typeof v){alert(v)}return v},isOfAge:function(e,a){var t=e.contentRating,i;if(!t){i=true}else{if(!a){a=$.cookie(e.ageGateCookieName)}if(a){var r=new Date,g=a.split("-"),n,f;try{n=new Date(g[0],g[1],g[2]);if(isNaN(n.getTime())){n=r}}catch(e){n=r}f=Math.floor((r-n)/31536e6);if(f>=t){i=true}else{i=false}}}s(o+"isOfAge? ",i);return i},gate:function(e){if(e){s(o+"Gate Video Player");e.setStates({gated:true});e.disable()}},promptAgeGate:function(e){if(e){e.setStates({showAgeGate:true})}}})})(this);
(function(e){"use strict";var t=e.Phoenix,r,a;if(!t){e.Phoenix=t={}}r=t.VideoPlayer=t.VideoPlayer||{};a=r.Views=r.Views||{};var n=r.log;var i="[MANAGER] ";var o={};var u={pause:function(){var e=l(this);e.pause()},stop:function(){var e=l(this);e.stop()},play:function(e,t){var r=l(this);r.play(t)},resume:function(){var e=l(this);e.resume()},seekTo:function(e,t){var r=l(this);r.seekTo(t)},setVolume:function(e,t){var r=l(this);r.setVolume(t)},mute:function(){var e=l(this);e.mute()},unMute:function(){var e=l(this);e.unMute()},fullscreen:function(e,t){var r=l(this);r.fullscreen(t)},updatePlayback:function(e,t){var r=t.states,a=r.playerType,o;y(t,a);if(r.started){n(i+"Play with new playback: ",r.playback);o=l(this);o.pause()}p(this.playerId,a);h(a);t.trigger("playbackUpdated")},updateQuality:function(e,t,r){var a=t.states,o;if(a.started&&!r){n(i+"Play with new quality: ",a.quality);o=l(this);o.pause();o.play(true)}t.trigger("qualityUpdated")}};var l=function(e){var t=s(e);if(t){return t.activeInterface}};var s=function(e){return o[e.playerId]};var f=function(e){var t=s(e);if(t){return t.Player}};var c=function(){var e;var t=function(){if(!e){e=$('<div class="js-vid-player-type-holder av-player-type-holder hide"/>')}return e.clone()};return function(e,r,a){var n=t();n.attr("id","js-vid-player-"+r+a);n.addClass("av-"+r+"-player-holder js-"+r+"-player-holder");n.appendTo(e);return n}}();var d=function(e,t){var a=t.playerId,u=[],l={},s;if(o[a]){return}$.each(r.ApiInterfaces,function(r,o){var f=o.prototype.name,d,v;n(i+"Initialize ApiInterface "+r);v=c(e.$el,f,a);d=new o({el:v,ApiInterfaceManager:e,videoJSON:t.videoJSON});if(!s){s=d}l[f]=d;u.push(f)});o[a]={Player:t,activeInterface:s,apiInterfaces:l,count:u.length};return u};var v=function(e,t){var r=o[e];if(r){return r.apiInterfaces[t]}return null};var p=function(e,t){var r=o[e],a;if(r){a=r.apiInterfaces[t]}if(a){n(i+"Set ApiInterface to "+t);r.activeInterface=a;return true}n(i+"Requested ApiInterface ["+t+"] is unavailable");return false};var y=function(e,t){var r=e.$el.find(".js-vid-player-type-holder");var a=e.$el.find(".js-"+t+"-player-holder");r.addClass("hide");a.removeClass("hide")};var h=function(e){var t=$(document);t.trigger("pre_page_event",["pageLoad",{om:{video_player_type:e}},true]);t.trigger("remove_page_event")};a.ApiInterfaceManager=Backbone.View.extend({els:{apiPlayerContainers:{}},playerId:null,eventMap:{onContentEnd:{name:"contentEnd"},onVideoProgress:{name:"videoProgress"},onResourceStart:{name:"resourceStart"},onAdStart:{name:"adStart"},onContentStart:{name:"contentStart"},onStateChange:{name:"stateChange"},onAdBlocked:{name:"adBlocked"}},initialize:function(e){var t=this,r=e.Player;t.playerId=r.playerId;var a=d(t,r);if(a){n(i+"Player type"+(a.length!=1?"s":"")+" loaded: ",a.join(", "))}r.on("all",function(e){if(u[e]){if(Function.prototype.apply){u[e].apply(t,arguments)}else{u[e].call(t,Array.prototype.slice.call([arguments]))}}});r.ApiInterfaceManager=t;t.on("all",function(e,a){var n=t.eventMap[e];if(n){r.trigger(n.name,a)}});n(i+"Initialized")},getActiveInterface:function(){return l(this)},getInterface:function(e){return v(this.playerId,e)},getAdCallUrl:function(){var e=this.getVideoJson();return e.adCall},shouldPlayAd:function(){var e=this,t=e.getPlayerState("adPlayed"),r=e.getAdCallUrl();if(!r||true===t){return false}return true},getVideoJson:function(){var e=this,t=f(e);return t.videoJSON},getVideoUrl:function(e){var t=this,r=f(t),a=r.Preferences,o=t.playerId,u=r.videoJSON,l;l=a.getPreference("quality",o);if(e){l="m3u8_stream"}n(i+"getVideoUrl for ["+l+"] from videoStreams: ",u.videoStreams);return u.videoStreams[l]},getCurrentTime:function(){var e=l(this);if(!e||!e.getCurrentTime){return 0}return e.getCurrentTime()},getDuration:function(){var e=this,t=l(e),r,a;if(!t||!t.getDuration){return 0}a=t.getDuration();if(!a){r=f(e);a=r.videoJSON.lengthSeconds}return a},getVolume:function(){var e=l(this);if(!e||!e.getVolume){return 0}return e.getVolume()},getPlayerState:function(e){var t=f(this);return t.states[e]}})})(this);
(function(e){"use strict";var t=e.Phoenix,a,r,n;if(!t){e.Phoenix=t={}}a=t.VideoPlayer=t.VideoPlayer||{};r=a.Views=a.Views||{};n=a.Controls=a.Controls||{};var i=a.log;var s={start:{fn:"start",params:["options"]},getPlayerInfo:{fn:"getPlayerInfo"},play:{fn:"play",params:["videoId"]},pause:{fn:"pause",params:["videoId"]},resume:{fn:"resume",params:["videoId"]},isPlaying:{fn:"isPlaying",params:["videoId"]},getCurrentTimeStamp:{fn:"getCurrentTimeStamp",params:["videoId"]},setCurrentTimeStamp:{fn:"setCurrentTimeStamp",params:["videoId","timestamp"]},ended:{fn:"ended",async:true,params:["videoId","wait"]}};var o=function(e){return function(t,a){if(a){e.ports[0].postMessage({result:"error",data:a})}else{e.ports[0].postMessage({result:"ok",data:t})}}};var u="[iFrame API] ";n.IframeAPI=Backbone.View.extend({Player:null,contentEndCallback:null,initialize:function(e){var t=this;t.Player=e.Player;var a=e.Player.ApiInterfaceManager;if(window.addEventListener){addEventListener("message",_.bind(t.receiveMessage,t),false)}else{attachEvent("onmessage",_.bind(t.receiveMessage,t))}t.Player.on("contentEnd",function(){if(t.contentEndCallback!==null){t.contentEndCallback()}})},start:function(e){if(typeof e!=="undefined"&&e.disableStartTime===true){this.Player.setStates({customStartTimeDisabled:true})}var t={apiVersion:"0.02",userLoggedIn:$("meta[name=userAuthState]").attr("content")=="loggedIn",userIsPremium:$("meta[name=userIsPremium]").attr("content")=="premium"};i(u+"Initialize embed api",t);return t},getPlayerInfo:function(){var e=this,t=e.Player,a=t.videoJSON;var r={id:a.id,title:a.title,premium:a.premium};i(u+"Get player info",r);return[r]},play:function(){this.Player.play()},pause:function(){this.Player.pause()},resume:function(){this.Player.resume()},isPlaying:function(){return this.Player.states.playing},getCurrentTimeStamp:function(){return this.Player.getCurrentTime()},setCurrentTimeStamp:function(e,t){return this.Player.seekTo(t)},ended:function(e,t,a,r){var n=!this.Player.states.playing&&Math.ceil(this.Player.getCurrentTime())>=this.Player.getDuration();if(t&&!n){this.contentEndCallback=a}else{a(n)}},receiveMessage:function(e){var t=this,a=t.Player,r=a.videoJSON;i(u+"Recieve message",e);if(e==="who-are-you"){return"athena"}var n=e.data.request;if(!n){return}if(!s.hasOwnProperty(n)){e.ports[0].postMessage({msg:"error",info:"unknown request"});return}var l=null;function m(e){l=e}var d=[];if(s[n].params){s[n].params.some(function(t){if(!e.data.hasOwnProperty(t)){l="Missing param "+t;return true}d.push(e.data[t])})}if(s[n].async){d.push(o(e))}d.push(m);var p=null;if(!l){var f=s[n].fn;i(u+"Calling embed function",[f,d]);p=t[f].apply(this,d)}if(!s[n].async||l){if(l){e.ports[0].postMessage({result:"error",data:l})}else{e.ports[0].postMessage({result:"ok",data:p})}}}})})(this);
(function(e){"use strict";var t=e.Phoenix,o,r;if(!t){e.Phoenix=t={}}o=t.VideoPlayer=t.VideoPlayer||{};r=o.Views=o.Views||{};var i=5e3;var n=2e3;var l=function(e,t){if(t.clientX===e.previousClientX&&t.clientY===e.previousClientY){return false}e.previousClientX=t.clientX;e.previousClientY=t.clientY;return true};var u=function(e,t){e.setStates({showControls:t});if(t){e.trigger("showControlChrome")}else{e.trigger("hideControlChrome")}};r.ControlChrome=Backbone.View.extend({untapTimeout:null,hoverTimeout:null,previousClientX:null,previousClientY:null,keepAlive:false,events:{"touchend .js-vid-player-holder, .js-vid-play":"touchPlayer","mousemove .js-vid-player-holder, .js-vid-play":"hoverPlayer","mouseenter .js-vid-box":"enterControlChrome","mouseleave .js-vid-box":"leaveControlChrome","touchend .js-vid-player-chrome":"touchInteract"},Player:null,initialize:function(e){var t=this,o;o=t.Player=e.Player},hoverPlayer:function(e){var t=this,o=t.Player,r=o.states;if(!l(t,e)||!(r.fullscreen||r.windowed)){return}u(o,true);clearTimeout(t.hoverTimeout);if(!t.keepAlive){t.hoverTimeout=setTimeout(function(){u(o,false)},n)}},enterControlChrome:function(e){var t=this;t.keepAlive=true;clearTimeout(t.hoverTimeout)},leaveControlChrome:function(e){var t=this;t.keepAlive=false},touchPlayer:function(e){var t=this,o=t.Player,r=o.states;if(!r.started){return}e.preventDefault();u(o,!r.showControls);t.touchInteract(e);return false},touchInteract:function(e){var t=this,o=t.Player,r=o.states;clearTimeout(t.untapTimeout);if(r.showControls){t.untapTimeout=setTimeout(function(){u(o,false)},i)}}})})(this);
(function(e){"use strict";var a=e.Phoenix;if(!a){e.Phoenix=a={}}var i=a.VideoPlayer=a.VideoPlayer||{};var n=i.Views=i.Views||{};var r=i.log;var s='<div class="container"></div>';var l=false,t="pod-recirc--horizontal",c=["align-vertical--child","align-vertical--contain"],o,d,f,u=[];var v={played:"video-active",playing:"video-playing"};var k="no-sticky";var g=".container";var b="[KUBRICK] ";var h=function(e){var a=e.els,i=a.$kubrickInfo,n=a.$videoSpacer;if(e.states.embiggened){return}e.states.embiggened=true;if(!!i){i.children().wrap(s);i.addClass(k);if(!!n){n.after(i)}}m(e,true)};var p=function(e){var a=e.els,i=a.$kubrickInfo,n=a.$kubrickInfoParent,r,s;if(!e.states.embiggened){return}e.states.embiggened=false;if(!!i){s=i.find(g);r=s.children();if(s.length>0){r.unwrap()}i.removeClass(k);n.prepend(i)}m(e,false)};var m=function(e,a){var i=e.els,n=i.$kubrickRelated;if(!n){return}if(false===l){l=true;o=n.data("embiggen-class");d=n.data("debiggen-class");f=n.find(".pod");$.each(c,function(e,a){u.push(f.find("."+a))})}if(a){n.addClass(o).removeClass(d);f.addClass(t);$.each(u,function(e,a){a.removeClass(c[e])})}else{n.addClass(d).removeClass(o);f.removeClass(t);$.each(u,function(e,a){a.addClass(c[e])})}};var C=function(e){var a=e.Player,i=a.states,n=e.states,r=[],s=[];$.each(n,function(e,a){var l=i[e],t;if(a!=l){n[e]=l;t=v[e];if(t){if(l){r.push(t)}else{s.push(t)}}}});if(r.length){e.$el.addClass(r.join(" "))}if(s.length){e.$el.removeClass(s.join(" "))}};n.Kubrick=Backbone.View.extend({Player:null,els:{$kubrickInfo:null,$kubrickInfoParent:null,$kubrickRelated:null,$videoSpacer:null},states:{embiggened:false,played:false,playing:false},initialize:function(e){var a=this,i=a.els,n=a.Player=e.Player;i.$kubrickInfo=a.$(".kubrick-info");i.$kubrickInfoParent=a.$(".row");i.$videoSpacer=$("#video-spacer");i.$kubrickRelated=a.$("#js-kubrick-pod");n.on("all",function(e){switch(e){case"embiggen":h(a);break;case"debiggen":p(a);break}C(a)})}})})(this);
(function(e){"use strict";var l=e.Phoenix,n,o;if(!l){e.Phoenix=l={}}n=l.VideoPlayer=l.VideoPlayer||{};o=n.Views=n.Views||{};var i=n.log;var s=l.jQuery?l.jQuery.getBody():$(document.body);var r="av-menu-open";var a="av-menu-ctrl-on";var t="[MENU] ";var c=function(e){if(e.closeHandler){s.off("click.closeMenu",e.closeHandler);e.closeHandler=null}};var u=function(e){if(!e.closeHandler){s.on("click.closeMenu",e.closeHandler=function(){e.close()})}};o.Menu=Backbone.View.extend({els:{$menuHit:null},closeHandler:null,events:{"click .js-vid-menu-hit":"toggle"},Player:null,initialize:function(e){var l=this;l.Player=e.Player;l.els=e.els;l.Player.on("hideControlChrome",function(){l.close()})},close:function(){var e=this;e.$el.removeClass(r);e.els.$menuHit.removeClass(a);c(e);e.trigger("close")},toggle:function(e){var l=this,n=!l.$el.hasClass(r);l.$el.toggleClass(r,n);l.els.$menuHit.toggleClass(a,n);e.stopPropagation();if(n){u(l);l.trigger("open")}else{c(l);l.trigger("close")}}})})(this);
(function(e){"use strict";var t=e.Phoenix;if(!t){e.Phoenix=t={}}var i=t.VideoPlayer=t.VideoPlayer||{};var s=i.Views=i.Views||{};var a=i.log;var r;if(t.jQuery&&t.jQuery.getDocument){r=t.jQuery.getDocument()}else{r=$(document)}var n=JSON.stringify;var l={contentLoading:"is-vid-content-loading",contentStarted:"is-vid-content-started",played:"is-vid-played",started:"is-vid-started",ended:"is-vid-ended",adPlaying:"is-vid-ad-playing",counting:"has-vid-countdown",disabled:"is-vid-disabled",loading:"is-vid-loading",playing:"is-vid-playing",paused:"is-vid-paused",gated:"has-vid-invalid-age",hasGate:"has-vid-age-gated",showAgeGate:"is-vid-age-gate",postPlay:"is-vid-postplay",embiggened:"is-vid-embiggened",mute:"is-vid-muted",share:"has-vid-share",stickied:"is-vid-stickied",chromecast:"is-vid-chromecasting",fullscreen:"is-vid-fullscreen",windowed:"is-vid-windowed",isLive:"is-vid-live",isOffAir:"is-vid-offair",isRewound:"is-vid-rewound",isSeekDisabled:"is-vid-noseek",showControls:"is-vid-show-controls"};var d="[UI] ";var u=function(e,t){var i=e.$el,s=[],a=[],r,n;$.each(t,function(t,i){r=l[t];if(t==="playerType"&&i!==e.states[t]){r="is-vid-"+i+"-player";if(e.states[t]){n="is-vid-"+e.states[t]+"-player";if(n){a.push(n)}}i=true}if(undefined!==r){if(true===i){s.push(r)}else{a.push(r)}}});$.extend(e.states,t);i.data("states",e.states);if(s.length>0){s=s.join(" ");i.addClass(s)}if(a.length>0){a=a.join(" ");i.removeClass(a)}};var o=function(e){var t=this,i=e.$el,s=e.els.$playerContainer,a=16/9,r="100%",n="width",l,d;s.css(n,r);l=i.height();d=s.height();if(l<d){r=a*l}s.css(n,r)};s.Player=Backbone.View.extend({els:{$playerChrome:null,$playerContainer:null,$video:null},$docRoot:$("html, body"),playerId:null,videoJSON:null,events:{},states:{videoId:null,playback:null,playerType:null,quality:null,switchingSource:false,adPlayed:false,contentLoading:false,contentStarted:false,played:false,started:false,ended:false,contentEndTimeoutId:null,adPlaying:false,counting:false,disabled:false,loading:true,playing:false,paused:false,volume:1,gated:false,hasGate:false,showAgeGate:false,embiggened:false,mute:false,share:false,stickied:false,chromecast:false,fullscreen:false,windowed:false,currentTime:0,duration:0,hasTimeChange:false,isAtEndTime:false,isLive:false,isOffAir:false,isRewound:false,isSeekDisabled:true,customStartTime:0,liveStartTime:0,liveSeekDelay:10,liveSeekDelayLeft:null,stowControls:false},AgeGate:null,ApiInterfaceManager:null,Preferences:null,initialize:function(e){var t=this,s=t.states,r=e.AgeGate,n=e.Preferences,l=e.videoJSON;t.els=e.els;t.playerId=e.playerId;t.videoJSON=l;s.videoId=l.id;t.trigger("init",[t]);if(false===r.isOfAge(t.videoJSON)){r.gate(t);return}t.AgeGate=r;t.Preferences=n;o(t);$(window).on("resize",function(){o(t)});t.on("initComplete",function(){a(d+"Initialization complete");t.off("initComplete");t.setStates({loading:false});var e=i.query("autoplay");if(t.videoJSON.autoplay||(e==="1"||e==="true")){setTimeout(function(){t.autoplay()},0)}});t.on("contentEnd",function(){if(!t.states.switchingSource){t.setStates({playing:false,started:false,ended:true,isSeekDisabled:true})}});t.on("all",function(e,i){if(e==="contentEnd"&&t.states.switchingSource){return}t.$el.trigger(e,i)})},play:function(e){var t=this,i=t.states,s=t.$el;if(i.disabled){return false}if(t.AgeGate&&t.AgeGate.isAgeGated(t)){return false}if(!e){t.trigger("beforePlay")}if(false===i.playing){a(d+"video is not playing > play")}if(false===i.started){s.trigger("videoStart")}if(true===i.ended){s.trigger("videoReplay");e=true}t.setStates({played:true,playing:true,paused:false,started:true,ended:false});r.trigger("video_play");this.trigger("play",e);return true},autoplay:function(){var e=this;var t=function(){if(!e.states.started&&!e.states.ended){return e.play()}return false};if(document.hidden){var i=function(){t()};window.onfocus=i;try{if(window.parent){window.parent.onfocus=i}}catch(e){}return false}else{return t()}},pause:function(){var e=this;if(e.states.disabled){return false}e.trigger("beforePause");e.setStates({paused:true,playing:false});a(d+"Pause video player");e.$el.trigger("contentPause");e.trigger("pause");return true},stop:function(){var e=this;if(e.states.disabled){return false}e.trigger("beforeStop");e.setStates({stopped:true,playing:false});a(d+"Stop video player");e.$el.trigger("contentStop");e.trigger("stop");return true},resume:function(){var e=this;if(e.states.disabled){return false}e.setStates({paused:false,playing:true});e.$el.trigger("contentResume");e.trigger("resume");return true},updateQuality:function(){var e=this;if(e.states.started){var t=e.getCurrentTime();e.setStates({playing:false,started:false,ended:false,customStartTime:t,switchingSource:true});return e.play(true)}return false},disable:function(){var e=this;e.setStates({disabled:true});e.trigger("disable");e.off();e.$el.off()},enable:function(){var e=this;e.setStates({disabled:false});e.trigger("enable")},seekTo:function(e){var t=this;if(t.states.disabled){return false}t.trigger("videoProgress",$.extend({},t.states,{currentTime:e}));this.setStates({currentTime:e});t.trigger("seekTo",e);if(t.states.switchingSource){t.setStates({switchingSource:false})}return true},jump:function(e){var t=this.states.currentTime+e;t=t>this.states.duration?this.states.duration-1:t;t=t<0?0:t;return this.seekTo(t)},setVolume:function(e){var t=this;if(t.states.disabled){return false}t.setStates({volume:e,mute:e===0});t.trigger("setVolume",e);return true},mute:function(){var e=this;if(e.states.disabled){return false}e.setStates({mute:true});e.trigger("mute");return true},unMute:function(){var e=this;if(e.states.disabled){return false}e.setStates({mute:false});e.trigger("unMute");return true},getCurrentTime:function(){return this.ApiInterfaceManager.getCurrentTime()},getDuration:function(){return this.ApiInterfaceManager.getDuration()},getVolume:function(){return this.ApiInterfaceManager.getVolume()},setStates:function(e){var t=this;if(t.states.disabled){return}u(t,e)}})})(this);
(function(e){"use strict";var r=e.Phoenix;if(!r){e.Phoenix=r={}}var n=r.VideoPlayer=r.VideoPlayer||{};var a=n.Views=n.Views||{};var t=n.log;var i=JSON.stringify;var o="[PREFS] ";var f="__gamesVideoPlayer";var c=["sticky","embiggen"];var v="frontdoor";var s={};var u={};var d={};var l={};var S=function(e,r){return e+r.slice(0,1).toUpperCase()+r.slice(1)};var h=function(){return location.pathname==="/"};var P=function(){var e=$.cookie(f),r;if(e){r=$.parseJSON(e)}return r};var g=function(e){if(0<=$.inArray(e,c)&&true===h()){e=S(v,e)}return e};var p=function(e){var r=$.extend({},e);t(o+"convertSavedStatesToPreferences stateJSON: ",e);if(h()){$.each(c,function(e,n){var a=S(v,n),t=r[a];if(t){r[n]=r[a];delete r[a]}else if(r[n]){delete r[n]}})}t(o+"convertSavedStatesToPreferences savedStates: ",r);return r};var x=function(){$.each(u,function(e,r){s[g(e)]=r})};var y=function(){var e=i(s);t(o+"Save state cookie value: "+e);$.cookie(f,e,{path:"/",expires:30})};var V=function(e,r){if($.isEmptyObject(d)){return}$.each(d,function(n,a){$.each(a,function(n,a){if(r!==a){a.loadPreference(e)}})})};a.Preferences=Backbone.View.extend({loaded:false,initialize:function(e){},getPreference:function(e,r){var n=u[e],a;if(!n&&r){a=l[r];if(l[r]){n=l[r][e].states[e]}}return n},load:function(){if(self.loaded){return}var e=P();t(o+"[SAVED STATES]: ",e);if(e){s=e;u=p(e)}V(u);u=$.extend({},u);t(o+"[LOADED STATES]:",u);self.loaded=true},register:function(e,r){var n=this,a=e.name;if(!d[a]){d[a]={}}if(!d[a][r]){d[a][r]=e;e.on("change",function(r){n.save(e,r)});$.each(e.states,function(n){if(!l[r]){l[r]={}}l[r][n]=e})}},save:function(e,r){t(o+"save preferences for "+e.name+": ",r);$.extend(u,r);V(u,e);x();y();e.trigger("saved")}})})(this);
(function(e){"use strict";var t=e.Phoenix,i,r;if(!t){e.Phoenix=t={}}i=t.VideoPlayer=t.VideoPlayer||{};r=i.Views=i.Views||{};var s=i.log;var a="[PROGRESS] ";var o=30;var n=function(){var e={$progress:".js-vid-position",$buffer:".js-vid-buffer",$timeDisplay:".js-vid-controls .js-vid-time",$seekDisplay:".js-vid-seek-display",$seekText:".js-vid-seek-text",$loader:".js-vid-loaded"};return function(t){$.each(e,function(e,i){t.els[e]=t.$(i)})}}();var u=function(e){var t=e.contentEndTimeoutId;if(t){s(a+"clear confirmContentEnd timeout");clearTimeout(t);e.contentEndTimeoutId=null}};var l=function(){var e=60,t=60,i=3600,r="0",s=":";return function(a){var o,n,u,l="",f="",d="";if(!a){a=0}if(a<0||isNaN(a)){a=0}o=Math.floor(a%e);n=Math.floor(a/e%t);u=Math.floor(a/i);if(o<10){l=r}if(n<10){f=r}d=f+n.toString()+s+l+o.toString();if(a>=i){d=u.toString()+s+d}return d}}();var f=function(){var e=o*1e3,t=true,i=false,r=null;return function(s){if(!i){t=r!==s;setTimeout(function(){i=false},e);r=s;i=true}return t}}();var d=function(e,t){var i=e.states,r=false,s=false,a=false,n=t.currentTime,u=t.duration,l=i.liveSeekDelay,d=i.liveSeekDelayLeft,c,v;if(!e.videoJSON.isLiveStream){return}if(i.duration===0){return}if(i.currentTime===n){return}c=f(u);if(true===c){if(n<u-o){a=true}else{s=true}}else{r=true}if(i.isOffAir!==r){t.isOffAir=r}if(i.isLive!==s){t.isLive=s}if(i.isRewound!==a){t.isRewound=a}};var c=function(e){try{var t=i.query(e);if(t===null){return null}var r=new RegExp(/((\d+)h)?((\d+)m)?((\d+)s?)?/);var s=r.exec(t);var a=parseInt(s[1]||0);var o=parseInt(s[4]||0);var n=parseInt(s[6]||0);return n+o*60+a*3600}catch(e){return null}};var v=function(e){if(e.videoProgressHandler){return}e.Player.on("videoProgress",e.videoProgressHandler=function(t){e.videoProgress(t)})};r.Progress=Backbone.View.extend({events:{"click .js-vid-seektolive":"seekToLive","click .js-vid-buffer":"seekToChange","mousemove .js-vid-buffer":"updateSeekDisplay",keydown:"hotkeyHandler"},Player:null,els:{$progress:null,$buffer:null,$timeDisplay:null,$seekDisplay:null,$seekText:null,$loader:null},ProgressStatus:null,StartTime:null,EndTime:null,Loop:false,videoProgressHandler:null,initialize:function(e){var t=this,r=false;t.Player=e.Player;var s=t.Player.ApiInterfaceManager;n(t);t.Player.on("adStart",function(){t.resourceStart=true;t.Player.setStates({adPlaying:true,contentStarted:false});v(t)});t.Player.on("contentStart",function(){t.resourceStart=true;v(t);t.Player.setStates({adPlaying:false,contentStarted:true})});t.Player.on("stateChange",function(e){t.videoStateChange(e)});t.Player.on("saveProgress",function(){t.saveVideoStatus()});t.Player.on("pause",function(){t.saveVideoStatus(null,true)});t.Player.on("contentEnd",function(){t.deleteVideoStatus()});t.Player.on("initComplete",function(){t.loadVideoStatus()});t.StartTime=c("t");t.EndTime=c("e");t.Loop=!!i.query("loop");if(t.StartTime===null||t.StartTime>t.EndTime){t.EndTime=null}},videoProgress:function(e){var t=this,r=t.Player,o=r.states,n=o.adPlaying,f=o.started,c=r.videoJSON.isLiveStream,v=i.ratioToPercentString(0),S=v,h=v,m="",g,T,P,y,p,k,w;var D=false;if(!e.duration){e.duration=r.getDuration()}u(o);if(false===n){if(true===r.videoJSON.isLiveStream){d(r,e)}else{if(false!==o.isSeekDisabled){e.isSeekDisabled=false}var $=0;if(r.states.customStartTime&&e.currentTime>$){t.seekToCustomStartTime(r)}}if(Math.floor(e.currentTime)!==Math.floor(o.currentTime)){D=true}e.hasTimeChange=D;if(D){r.setStates(e);r.$el.trigger("contentProgress",o)}}if(!D){return}g=Math.floor(e.currentTime);T=Math.floor(e.duration);P=e.bytesLoaded||0;y=e.bytesTotal||0;p=o.isLive;k=o.isOffAir;w=o.isRewound;if(true===n){s(a+"Ad progress");m=r.adMessagePrefix+l(T-g)}else if(true===f){m=l(g);S=i.ratioToPercentString(g/T);if(0<=P&&0<y){h=i.ratioToPercentString(P/y)}if(!p){m+=" / "+l(T)}if(true===c){if(!p&&!k&&!w){m="Loading stream data";for(var M=0;M<=(g+1)%3;M++){m+="."}S=v}if(p){S=i.ratioToPercentString(1)}}}r.trigger("saveProgress");t.setVideoProgress(m,S,h);if(t.EndTime!==null&&e.currentTime>t.EndTime){if(t.Loop){t.seekTo(t.StartTime,true)}else{r.pause();t.EndTime=null;i.showSuccessMessage("End of video clip")}}else if(t.Loop&&e.currentTime>=e.duration-1){t.seekTo(t.StartTime||0,true)}},videoStateChange:function(e){var t=this,i=t.Player,r={contentLoading:false};switch(e.newState){case 3:r.contentLoading=true;break}i.setStates(r)},setVideoProgress:function(e,t,i){var r=this,s=r.els.$timeDisplay,a=r.els.$progress,o=r.els.$loader,n,u,l;if(s){n=s.data("progress-msg");if(n!==e){s.html(e);s.data("progress-msg",e)}}if(undefined!==t&&a){u=a.data("width");if(u!==t){a.css("width",t);a.data("width",t)}}if(i&&o){l=o.data("width");if(l!==i){o.css("width",i);o.data("width",i)}}},seekToCustomStartTime:function(){var e=this,t=e.Player,r=t.states,a=r.customStartTime,o=t.videoJSON,n,u=true;if(!r.customStartTimeDisabled&&!r.adPlaying&&r.contentStarted&&0<a){n=t.getDuration();if(undefined===n||0===n||true===isNaN(n)){s("wait until we have a legit duration");return}t.setStates({customStartTime:0});if(Math.floor(a)<Math.floor(n)){u=!t.states.switchingSource;t.seekTo(a);if(u){i.showSuccessMessage("Resuming video from saved position")}}}},loadVideoStatus:function(){var e=this,t=e.Player;if(!e.ProgressStatus){e.ProgressStatus=new i.Models.VideoStatus({name:"progress",videoJSON:t.videoJSON,options:{cookie:true,server:true}})}if(e.StartTime>0){t.setStates({customStartTime:e.StartTime})}else{e.ProgressStatus.fetch({success:function(e){if(e>0){t.setStates({customStartTime:e})}}})}},saveVideoStatus:function(e,t){var i=this,r=i.Player;e=e?e:r.getCurrentTime();if(r.states.ended){i.ProgressStatus.delete()}else{i.ProgressStatus.save(e,{force:!!t})}},deleteVideoStatus:function(){var e=this;e.ProgressStatus.delete()},seekToRatio:function(e){var t=this,i=t.Player,r=i.getDuration();t.seekTo(r*e)},seekTo:function(e,t){var i=this,r=i.Player,s=r.states,a=r.videoJSON,o=r.getDuration();if(!t){i.StartTime=null;i.EndTime=null;i.Loop=false}if(Math.floor(e)<Math.floor(o)){r.seekTo(e);i.saveVideoStatus(e,true);r.setStates({customStartTime:0})}},jump:function(e){var t=this,i=t.Player,r=i.states,s=i.videoJSON,a=i.getDuration();if(Math.floor(e)<Math.floor(a)){i.jump(e);t.saveVideoStatus(e)}},seekToLive:function(e){var t=this,i=t.Player;t.seekTo(i.getDuration()-2);i.setStates({isRewound:false})},seekToChange:function(e){var t=this,r=t.Player;var s=i.getEventInContainerRatio(e,t.els.$buffer);t.seekToRatio(s)},updateSeekDisplay:function(e){var t=this,r=t.Player;var s=i.getEventInContainerRatio(e,t.els.$buffer);var a=i.ratioToPercentString(s);var o=r.getDuration()*s;t.els.$seekDisplay.css("left",a);t.els.$seekText.text(l(o))},hotkeyHandler:function(e){var t=this,i=t.Player;if(e.metaKey||e.ctrlKey||e.shiftKey||e.altKey){return}if(e.which===35){t.seekTo(i.getDuration()-5)}else if(e.which===36){t.seekTo(0)}else if(e.which===188){t.jump(-.1)}else if(e.which===190){t.jump(.1)}else if(e.which===37){t.jump(-5)}else if(e.which===39){t.jump(5)}else if(e.which===74){t.jump(-10)}else if(e.which===76){t.jump(10)}else if(e.which>=48&&e.which<=57){var r=(e.which-48)*.1;var s=Math.floor(i.getDuration()*r);t.seekTo(s)}}})})(this);
(function(e){"use strict";var i=".js-video-player-new";var r=$(i);if(!r||r.length<1){return}var a=e.Phoenix||{},n=a.VideoPlayer,t=n.log,o;var l=JSON.stringify;if(!e.Phoenix){e.Phoenix=a}if(!n||!Backbone){return}o=n.Views;var s;var c="[INIT] ";var f=function(){var e=n.ApiInterfaces,i=$(".js-vid-playback"),r=i.length,a;i.each(function(){var i=$(this),a=i.data("player"),n;if(!e[a]){i.remove();r--}});if(r===1){a=$(".js-vid-playbacks");a.removeClass("has-vid-multiple-playbacks").addClass("has-vid-single-playback")}};var d=function(e){var i;if(!o.AdUtilities){return}try{i=new o.AdUtilities({Player:e})}catch(e){t("error",c+"AdUtilities failed to initialize: ",e)}return i};var u=function(e){I(e);v(e);g(e);y(e);p(e);h(e);P(e);var i=e.videoJSON;if(!!i.uvpHi5Ima){d(e)}w(e)};var v=function(e){try{var i=new o.ApiInterfaceManager({el:e.$(".js-vid-player-holder"),Player:e})}catch(e){t("error",c+"failed to initialize api interface manager: ",e)}};var y=function(e){t(c+"Initialize Player Control Chrome");var i;try{i=new o.ControlChrome({el:e.el,Player:e})}catch(e){t("error",c+"failed to initialize control chrome: ",e)}};var p=function(e){t(c+"Initialize Player Controls: ",n.Controls);if(!n.Controls){t(c+"There are no controls to initialize");return}var i={};$.each(n.Controls,function(r,a){var n;try{n=new a({name:r,el:e.el,Player:e,Preferences:s});t(c+r+" initialized");i[r.toLowerCase()]=!n.disabled}catch(e){t("error",c+r+" failed to initialize: ",e)}if(n&&n.controlType==="preference"&&!n.disabled){s.register(n,e.playerId)}});e.trigger("initControlsComplete",i)};var h=function(e){var i=e.$(".js-vid-menu-hit"),r=null;i.each(function(){var a=$(this).closest(".js-vid-menu-set"),n;if(!a.length){return}n=new o.Menu({Player:e,el:a,els:{$menuHit:i}});n.on("open",function(){if(r){r.close()}r=n});n.on("close",function(){if(r===n){r=null}})})};var g=function(e){var i;if(!o.Progress){return}try{i=new o.Progress({el:e.el,Player:e})}catch(e){t("error",c+"Progress failed to initialize: ",e)}};var P=function(e){if(!e.$el.hasClass("av-mobile-player")){e.$(".js-vid-tooltip").tooltip({animation:false,delay:0,template:'<div class="av-vid-tooltip" role="tooltip"><div class="av-vid-tooltip-arrow tooltip-arrow"></div><div class="av-vid-tooltip-inner tooltip-inner"></div></div>'})}};var I=function(){var e=function(e){var i=e.watchedCookieName,r;if(!i){return}r=$.parseJSON($.cookie(i));if(!r){r=[]}return r};var i=function(i){var r=i.id,a=i.watchedCookieName,n=i.watchedCookieDays,t=e(i);if(undefined===t){return}if(0>$.inArray(r,t)){t.push(r)}$.cookie(a,l(t),{path:"/",expires:n})};var r=function(e){var r=!!$("#VideoDisableTracking").attr("content"),a=e.id;t(c+"Disable Tracking? ",r);if(r||!a){return}$.ajax({url:"/api/video/played/"+a+"/",type:"GET",success:function(e){if(e.success===0){t(c+"Error logging view")}else if(e.success===1){t(c+"View logged successfully")}}});i(e)};return function(e){e.on("beforePlay",function(){var i=e.videoJSON;if(e.states.played&&i.id){t(c+"video has not played > log view");r(i)}})}}();var w=function(e){var i=e.$el.closest("#kubrick-lead"),r;if(i.length){try{r=new o.Kubrick({el:i,Player:e})}catch(e){t("error",c+"Kubrick failed to initialize: ",e)}}};var m=function(e){var i;try{i=new o.AgeGate({el:e.find(".js-vid-age-gate")});t(c+"AgeGate initialized: ",i)}catch(e){t("error",c+"AgeGate failed to initialize: ",e)}return i};var C=function(e){var i,r,a,n;a=e.data("id");if(!a){t("error",c+"$videoPlayer is missing playerId");return}n=e.data("video");t(c+"videoJSON:\n",$.extend({},n));if(!n){t("error",c+"Video JSON missing for: ",e);return}i=m(e);try{r=new o.Player({el:e,els:{$playerChrome:e.find(".js-vid-player-chrome"),$playerContainer:e.find(".js-vid-max-width")},playerId:a,videoJSON:n,AgeGate:i,Preferences:s});if(r.states.disabled){t(c+"Player disabled");return}t(c+"Player initialized")}catch(e){t("error",c+"Player failed to initialize: ",e)}if(!r){return}u(r);return r};var A={};var E=function(){var e=0;return function(i){if(!i){return}try{A["player"+i.playerId]=i;e++}catch(e){t("error",e)}}}();n.getInstance=function(e){return A[e]};n.getAllInstances=function(){return A};n.initialize=function(){t("========== INITIALIZE VIDEO PLAYER APP ==========");f();s=new o.Preferences;t("========== INITIALIZE VIDEO PLAYERS ==========");var e=null;r.each(function(){var i=$(this);e=C(i);E(e)});$.each(A,function(i,r){if(e&&e.ApiInterfaceManager){r.ApiInterfaceManager.on("ready",function(){t("========== LOAD PREFERENCES ==========");s.load();t("========== ENABLE VIDEO PLAYERS ==========");r.trigger("initComplete")})}});t(c+"Video Player Instances",A)};n.ratioToPercentString=function(e){var i=(100*e).toFixed(2),r=i.indexOf(".00");if(r>0){i=i.substr(0,r)}return i+"%"};n.getEventInContainerRatio=function(e,i){if(!e||!i){return}var r=0,a=i.width(),n=i.offset(),t=e.pageX||e.originalEvent.touches[0].pageX,o=t-n.left,l;if(o<r){o=r}else if(o>a){o=a}l=o/a;return l};n.showSuccessMessage=function(e){if(!!a.Ui&&!!a.Ui.showSuccessMessage){a.Ui.showSuccessMessage(e)}};n.query=function(e){e=e.replace(/[*+?^$.\[\]{}()|\\\/]/g,"\\$&");var i=location.search.match(new RegExp("[?&]"+e+"=([^&]+)(&|$)"));return i&&decodeURIComponent(i[1].replace(/\+/g," "))};n.initialize()})(this);