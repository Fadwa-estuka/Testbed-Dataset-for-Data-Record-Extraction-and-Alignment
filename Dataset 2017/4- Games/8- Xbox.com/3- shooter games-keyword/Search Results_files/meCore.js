(function(n){function o(r){function tt(){var n=o.authenticatedState;w=n==u.SignedIn||n==u.SignedInIdp}function it(){var n;return n=o.enabled?w?"statussignedin":"statussignedout":"statusunavailable",t.getString(n)}function d(n){n.preventDefault(),n.stopPropagation(),o.enabled&&r.onSwitchUser&&r.onSwitchUser()}function g(i){i.preventDefault(),i.stopPropagation(),c.hide(),y.show(),p.text(t.getString(w?"statussigningout":"statusremoving")),o.onSignOutUser&&o.onSignOutUser(function(){n(l).trigger("remove")},function(){c.show(),y.hide(),p.text(t.getString(w?"statussignoutfailed":"statusremovingfailed"))})}function nt(n,t){t&&n&&n.which===13&&t(n)}var l=this,a=!1,v=!1,o=r,k="msame_ai"+e++,h=null,s=null,b=null,y=null,c=null,p=null,w=null;l.render=function(){var n=i.PictureLoaderCache.isCached(o.tileUrl)?o.tileUrl:"";return t.format(f,k,n,t.encodeHtml(o.displayName),t.encodeHtml(o.memberName),t.encodeHtml(it()),t.getString(o.authenticatedState==u.SignedInIdp?"signoutremovetip":"removetip",!0),o.removeImgUrl)},l.activate=function(){if(!a&&!v){a=!0,s=n("#"+k),c=n(".msame_Drop_AI_remove",s),y=n(".msame_Drop_AI_prog",s),b=n(".msame_Drop_AI_piccont img",s),p=n(".msame_Drop_AI_status",s),s.toggleClass("disabled",!o.enabled),s.toggleClass("switch",o.enabled),h=new i.PictureLoader(b,o.tileUrl,o.errorImgUrl),setTimeout(h.activate,0);s.on("click",d);s.on("keydown",function(n){nt(n,d)});c.on("click",g);c.on("keydown",function(n){nt(n,g)})}},l.deactivate=function(){a&&!v&&(a=!1,h&&h.deactivate(),c.off())},l.dispose=function(){v||(l.deactivate(),h&&h.dispose(),s.remove(),o=r=h=null,s=c=b=y=p=null,v=!0)},tt()}var r=window;r.MSA=r.MSA||{};var i=r.MSA.MeControl=r.MSA.MeControl||{},t=i.Strings,s=i.IDP,u=i.AuthState,f='<div id="{0}" class="msame_Drop_AI switch" tabIndex="0"><div class="msame_Drop_AI_pic"><div class="msame_Drop_AI_piccont"><div class="msame_Drop_AI_picframe"><img role="presentation" src="{1}"><\/div><\/div><\/div><div class="msame_Drop_AI_right"><div class="msame_TxtTrunc msame_Drop_AI_name">{2}<\/div><div class="msame_TxtTrunc msame_Drop_AI_email">{3}<\/div><div class="msame_TxtTrunc msame_Drop_AI_status">{4}<\/div><\/div><div class="msame_Drop_AI_remove" tabIndex="0"><img alt="{5}" src="{6}" /><\/div><div class="msame_Drop_AI_prog" style="display:none;"><\/div><\/div>',e=0;i.AccountItemControl=o})(window.MejQuery),function(n){function f(t,f){function v(){if(c)for(var n=0;n<c.length;n++)e.push(new i.AccountItemControl(f.getAccountItemData(c[n])))}function y(t){var i=e.indexOf(t);t.dispose(),e.splice(i,1),n(t).off("remove"),e.length===0&&n(o).trigger("empty")}var o=this,s=!1,h=!1,p=!1,a=t||{},c=a.userList,e=[],l=null;o.render=function(){for(var t="",n=0;n<e.length;n++)t+=e[n].render();return r.format(u,t)},o.activate=function(){if(!s&&!h){s=!0,l=n(".msame_Drop_AL");for(var t=0;t<e.length;t++){e[t].activate();n(e[t]).on("remove",function(n){return function(){y(n)}}(e[t]))}}},o.deactivate=function(){if(s&&!h){s=!1;for(var t=0;t<e.length;t++)e[t].deactivate(),n(e[t]).off("remove")}},o.dispose=function(){if(!h){o.deactivate();for(var n=0;n<e.length;n++)e[n].dispose();l.remove(),a=t=e=null,l=null,h=!0}},v()}var t=window;t.MSA=t.MSA||{};var i=t.MSA.MeControl=t.MSA.MeControl||{},r=i.Strings,u='<div class="msame_Drop_AL"><div class="msame_Drop_ALItems">{0}<\/div><\/div>';i.AccountsListControl=f}(window.MejQuery),function(n){function o(t){function v(n){i.id&&u.logEvent(i.id+"Clicked");var t=i.onClick&&i.onClick();t&&(n.preventDefault(),n.stopPropagation())}var o=this,h=!1,c=!1,i=t,a="msame_si"+e++,l=null,s=null;i.label=i.label||i.string,o.focus=function(){s&&s.focus()},o.render=function(){return r.format(f,a,r.encodeHtml(i.label),r.encodeHtml(i.url||"#"),i.openInNewTab?"_blank":"")},o.activate=function(){if(!h&&!c){h=!0,l=n("#"+a),s=n("a",l);s.on("click",v)}},o.deactivate=function(){h&&!c&&(h=!1,s.off())},o.dispose=function(){c||(o.deactivate(),i=t=null,l=s=null,c=!0)}}var t=window;t.MSA=t.MSA||{};var i=t.MSA.MeControl=t.MSA.MeControl||{},r=i.Strings,u=i.Log,f='<div id="{0}" class="msame_Drop_SI"><a href="{2}" target="{3}" class="msame_TxtTrunc">{1}<\/a><\/div>',e=0;i.SectionItemControl=o}(window.MejQuery),function(n){function l(l){function g(n){n.preventDefault(),n.stopPropagation(),i.location.href=a.getEditPictureUrl()}var y=this,p=!1,w=!1,a=l,v=null,b=null,k=null,d=null;y.setUserPicture=function(n){v&&v.reset(n)},y.render=function(){var y=r.PictureLoaderCache.isCached(a.tileUrl)?a.tileUrl:"",n="",i=u,v;return l.idp!==r.IDP.MSA||a.nickName?n=a.roleName&&(a.orgName||a.nickName)?t.format(e,t.encodeHtml(a.displayName),t.encodeHtml(a.roleName),t.encodeHtml(a.orgName||a.nickName),t.encodeHtml(a.memberName)):t.format(o,t.encodeHtml(a.displayName),t.encodeHtml(a.roleName||a.orgName||a.nickName),t.encodeHtml(a.memberName)):(n=t.format(s,t.encodeHtml(a.displayName),t.encodeHtml(a.memberName)),i=l.isCustomTileUrl?u:c),v=t.format(i,t.format(h,t.encodeHtml(y)),t.encodeHtml(t.getString("updatephoto"))),t.format(f,v,n)},y.activate=function(){if(!p&&!w){p=!0,b=n(".msame_Drop_active"),k=n(".msame_Drop_active_piccont img",b),d=n(".msame_Drop_active_piccont a",b);d.on("click",g);v=new r.PictureLoader(k,a.tileUrl,a.errorImgUrl),setTimeout(v.activate,0)}},y.deactivate=function(){p&&!w&&(p=!1,v&&v.deactivate(),d.off())},y.dispose=function(){w||(y.deactivate(),v&&(v.dispose(),v=null),a=l=null,k=b=null,w=!0)}}var i=window;i.MSA=i.MSA||{};var r=i.MSA.MeControl=i.MSA.MeControl||{},t=r.Strings,f='<div class="msame_Drop_active_pic"><div class="msame_Drop_active_piccont"><div class="msame_Drop_active_picframe">{0}<\/div><\/div><\/div><div class="msame_Drop_active_right">{1}<\/div>',e='<div class="msame_TxtTrunc msame_Drop_active_name">{0}<\/div><div class="msame_TxtTrunc msame_Drop_active_email">{1}<\/div><div class="msame_TxtTrunc msame_Drop_active_email">{2}<\/div><div class="msame_TxtTrunc msame_Drop_active_email">{3}<\/div>',o='<div class="msame_TxtTrunc msame_Drop_active_name">{0}<\/div><div class="msame_TxtTrunc msame_Drop_active_email">{1}<\/div><div class="msame_TxtTrunc msame_Drop_active_email">{2}<\/div>',s='<div class="msame_TxtTrunc msame_Drop_active_name">{0}<\/div><div class="msame_TxtTrunc msame_Drop_active_email">{1}<\/div>',h='<img role="presentation" src="{0}">',u='<div class="msame_Drop_active_picborder">{0}<\/div>',c='<a href="#" title="{1}">{0}<\/a>';r.ActiveAccountControl=l}(window.MejQuery),function(n){function p(y,p){function ii(){var n,i;ni&&(ft=new t.ActiveAccountControl(y.activeAccountData()),k.push(ft),n=y.authStateModel().getIdpInfo().accountSettingsUrl,n&&(i=t.Config.msTxt?"microsoftaccount":"viewaccount",et=new t.SectionItemControl({label:u.getString(i),onClick:function(){return f.logEvent("ViewAccount",{idp:y.userData().idp}),!1},url:n,openInNewTab:y.options.openLinksInNewTab}),k.push(et)),ot=new t.SectionItemControl({label:u.getString("signout"),onClick:function(){return y.signOut(),!0}}),k.push(ot)),!y.isReady()||!y.authStateModel().canSignInOtherAccount()||y.options.events&&y.options.events.onSignIn||(st=new t.SectionItemControl({label:u.getString("signinotheraccount"),onClick:function(){return y.signIn(),!0}}),k.push(st)),y.rewardsStateModel().getRewardsItemData(function(n){!g&&n&&n.enabled&&(n.onClick=function(){return f.logEvent("Rewards",{url:n.url}),!1},n.openInNewTab=y.options.openLinksInNewTab,rt=new t.SectionItemControl(n),k.push(rt),nt&&(lt.html(rt.render()),lt.show(),rt.activate()))})}function ri(n){var f=n[0],r=typeof i.pageXOffset===s?e.scrollLeft:i.pageXOffset,u=typeof i.pageYOffset===s?e.scrollTop:i.pageYOffset,t=f.getBoundingClientRect();return{top:u+t.top,left:r+t.left,right:r+t.right,bottom:u+t.bottom,width:n.width(),height:n.height()}}function kt(){nt&&!g&&w.toggleClass("msame_Mobile",vt)}function ui(n){w.toggleClass("msame_ClickStart",!n)}function dt(){if(ht){for(var n=0;n<ht.length;n++)ht[n].dispose();ht=null}}function fi(n){if(!g){var t=w.height();w.css({top:"-="+c,height:t/2,opacity:"0",display:""}),w.animate({top:"+="+c,height:t+"px"},{duration:v,easing:"easeOutQuintPartial",queue:!1,complete:function(){g||(w.css("height",""),n&&n())}}),w.animate({opacity:"1"},{duration:l,queue:!1,easing:"linear"})}}function ei(){if(!wt&&(wt=!0,!ct&&y.isReady()&&(ct=y.authStateModel()),ct)){var i=Date.now();ct.getUserState(function(r){var u,e;if(!g){if(r&&r.length>0){d=new t.AccountsListControl({userList:r},y);n(d).on("empty",oi);k.push(d),u=n(".msame_Drop_accts_list",w),u.html(d.render()),d.activate(),e=n(".msame_Drop_accts",w),e.show(),ct.canSignInOtherAccount()||n(".msame_Drop_signIn").hide()}f.logEvent("AccountListReady",{duration:Date.now()-i,count:r&&r.length})}},function(){})}}function oi(){var t,i;d&&(t=n(".msame_Drop_accts",w),t.slideUp("fast"),d.dispose(),i=k.indexOf(d),k.splice(i,1),n(d).off("empty"),d=null)}function gt(n,t){try{for(var i=t;i&&i!==n&&i!==ut[0];)i=i.parentNode;return i===n}catch(r){return!1}}function at(n){g||!tt||!it||n.type==="mousewheel"||n.target===it[0]||gt(it[0],n.target)||gt(w[0],n.target)||(n.preventDefault(),n.stopPropagation(),b.hide())}function si(n){tt&&n.which===27&&b.hide(!0)}var b=this,nt=!1,g=!1,tt=!1,ni=y.hasActiveUser(),wt=!1,vt=y.mobileState()===t.MobileState.Mobile,k=[],ft=null,d=null,et=null,ot=null,st=null,rt=null,ht=null,ct=y.authStateModel(),ti,w=null,lt=null,yt=null,pt=null,bt=null,it=p&&p.anchor,ut=n(document),hi=n(document.body);b.setMobileState=function(n){vt=n===t.MobileState.Mobile,kt()},b.setUserPicture=function(n){ft&&ft.setUserPicture(n)},b.updateExtensibleLinks=function(){var n,i,r;if(yt.hide(),pt.html(""),n=y.extensibleLinks(),n&&n.length>0)for(dt(),ht=[],yt.show(),i=0;i<n.length;i++)r=new t.SectionItemControl(n[i]),pt.append(r.render()),r.activate(),ht.push(r)},b.render=function(){return u.format(a,ft?ft.render():"",et?et.render():"",st?st.render():"",ot?ot.render():"")},b.activate=function(){var f,u;if(!nt&&!g){if(f=n("#meControlDropdown"),f.length>0){nt=!0,w=f,yt=n(".msame_Drop_links",w),pt=n(".msame_Drop_links_list",w),bt=n(".msame_Drop_topb",w),lt=n(".msame_Drop_rewards",w),t.Browser.ie8&&w.addClass("msaie8");ut.on("click"+r,at);ut.on("mousedown"+r,at);ut.on("touchend"+r,at);ut.on("mousewheel"+r,at);ut.on("keyup"+r,si);n(i).on("resize"+r,at);for(rt&&(lt.html(rt.render()),lt.show()),u=0;u<k.length;u++)k[u].activate();ei()}kt(),b.updateExtensibleLinks()}},b.deactivate=function(){if(nt&&!g){nt=!1,ut.off(r),n(i).off(r),d&&n(d).off("empty");for(var t=0;t<k.length;t++)k[t].deactivate()}},b.toggle=function(n){nt&&(ui(n),tt?b.hide():b.show())},b.show=function(){if(nt&&!tt){if(tt=!0,f.logEvent("DropdownOpen"),it){var i=ri(it);w.css({top:i.top+i.height,left:t.Loc.rtl?i.left:i.right-w.width()-h}),bt.css("width",w.width()-it.outerWidth()+h+"px")}fi(function(){var t=vt?(w[0].clientWidth-108).toString():"";n(".msame_Drop_AI_right",w).css("width",t),rt?rt.focus():et?et.focus():st?st.focus():ot&&ot.focus()}),n(b).trigger(o,{visible:tt})}},b.hide=function(t){nt&&tt&&(tt=!1,w.fadeOut(l,function(){t&&it&&it.focus(),n(b).trigger(o,{visible:tt})}))},b.dispose=function(){if(!g){b.deactivate(),dt();for(var n=0;n<k.length;n++)k[n].dispose();w.remove(),y=ti=ct=k=null,w=it=ut=lt=null,g=!0}},ii()}var i=window;i.MSA=i.MSA||{};var t=i.MSA.MeControl=i.MSA.MeControl||{},u=t.Strings,f=t.Log,e=document.documentElement,o="visible",r=".msame",s="undefined",a='<div id="meControlDropdown" class="msame_Drop_root" style="display: none;"><div class="msame_Drop_topb"><\/div><div class="msame_Drop_content"><div class="msame_Drop_active">{0}<\/div><div class="msame_Drop_rewards" style="display: none;"><\/div><div class="msame_Drop_account">{1}<\/div><div class="msame_Drop_links" style="display: none;"><div class="msame_Drop_links_list"><\/div><\/div><div class="msame_Drop_signIn">{2}<\/div><div class="msame_Drop_signOut">{3}<\/div><div class="msame_Drop_accts" style="display: none;"><div class="msame_Drop_sep"><\/div><div class="msame_Drop_accts_list"><\/div><\/div><\/div><\/div>',h=2,c=60,v=833,l=100,y=.2;n.extend(n.easing,{easeOutQuintPartial:function(n){return n+=y*(1-n),Math.pow(n-1,5)+1}}),t.MeDropdownControl=p}(window.MejQuery),function(n){function u(){function l(t,i,r){var h,v;if(!e&&t){var y=Date.now(),l="mecontrol_iframe_index_"+s++,a=n('<iframe style="display:none"><\/iframe>').attr("id",l).attr("src",t);a.appendTo("body"),i&&(h=f.getDomainFromUrl(t),u[h]||(u[h]={}),v=setTimeout(function(){c(h,l)},o),u[h][l]={callback:i,iframe:a[0],start:y,timeoutId:v,timeoutCallback:r})}}function h(t){var i=t.originalEvent;i&&u[i.origin]&&n.each(u[i.origin],function(t,f){if(i.source==f.iframe.contentWindow){r.logQos("IFrameCtrl",!0,Date.now()-f.start,"",{src:f.iframe.src});var e=f.callback(i);e?(clearTimeout(f.timeoutId),n(f.iframe).remove(),delete u[i.origin][t]):(clearTimeout(f.timeoutId),f.timeoutId=setTimeout(function(){c(i.origin,t)},o))}})}function c(t,i){if(!e&&u&&u[t]){var r=u[t][i];r&&(r.timeoutCallback&&r.timeoutCallback(),n(r.iframe).remove(),delete u[t][i])}}var o=3e4,f=this,e=!0,s,u;f.init=function(){if(e){u={},s=0,e=!1;n(t).on("message",h)}},f.getDomainFromUrl=function(n){var t=document.createElement("a"),i;return t.href=n,i=t.protocol+"//"+t.hostname,t.port!==null&&t.port!==""&&t.port!=="443"&&t.port!=="80"&&t.port!=="0"&&(i+=":"+t.port),i},f.openIFrame=function(n,t,r,u){u&&(n=i.Util.appendQueryParams(n,u)),l(n,t,r)},f.dispose=function(){var r,i;if(!e){n(t).off("message",h);for(r in u)for(i in r)clearTimeout(i.timeoutId),n(i.iframe).remove();u=null,e=!0}},f.init();n(t).on("unload.msame",f.dispose)}var t=window,i=t.MSA.MeControl,r=i.Log;i.IFrameControl=new u}(window.MejQuery),function(n){function g(g,nt,tt){function ti(){if(ut.isIdpEnabled(t.AAD)){var n=rt.aadInfo;n.meUrl||(n.meUrl=o.format(p,s,encodeURIComponent(n.appId),encodeURIComponent(n.siteUrl))),n.signInUrl||(n.signInUrl=o.format(w,s,encodeURIComponent(n.appId),encodeURIComponent(gt()),encodeURIComponent(n.siteUrl))),n.blockMsaFed&&(n.signInUrl=i.appendQueryParams(n.signInUrl,{msafed:"0"}))}}function bt(){var r,n,i;if(ft&&et){for(r=[],n=0;n<ft.length;n++)i=!0,ii(et,ft[n])&&(i=!1,(et.idp===t.AAD||et.idp===t.MSA_FED)&&(et.sessionId=ft[n].sessionId)),ft[n].idp===t.ORG_ID&&(i=!1),i&&r.push(ft[n]);ft=r}}function ii(n,i){return!n||!i||n.idp!==i.idp?!1:n.idp===t.MSA?n.cid===i.cid:n.memberName&&i.memberName&&n.memberName.toLowerCase()===i.memberName.toLowerCase()}function vt(i){var e,s,u,r,o;return ct&&(e=rt.msaInfo.meTrustedOrigin&&i.origin===rt.msaInfo.meTrustedOrigin,s=rt.aadInfo.meTrustedOrigin&&i.origin===rt.aadInfo.meTrustedOrigin,(e||s)&&typeof i.data=="string"&&(st--,u={currentIdp:e?t.MSA:t.AAD,messagesMissing:st},r=n.parseJSON(i.data),r&&r.userList&&r.userList.length>0?ot.push.apply(ot,r.userList):(o="InvalidIdpData",r&&r.error&&(u.IDPError=r.error,o="IDPError"),f.logQos("UserStatePartial",!1,Date.now()-at,o,u)),st===0))?(ot&&ot.length>0?ht(!0):ht(!1,"NoIdpData",u),!0):!1}function ht(n,t,i){var r,u;for(ft=ot||[],bt(),i=i||{},i.userCount=ft.length,f.logQos("UserState",n,Date.now()-at,t,i),r=0;r<lt.length;r++)u=lt[r],n?u.success(ft):u.failure&&u.failure();ri()}function yt(){ct&&(st-=1,st===0&&(ot&&ot.length>0?ht(!0,"",{timeout:!0,messagesMissing:st}):ht(!1,"Timeout")))}function ri(){st=0,ct=!1,at=0,ot=[],lt=[]}function ui(){for(var i=ut.currentState(),n=0;n<i.length;n++)if(i[n].idp===t.MSA)return!0;return!1}function fi(){var n=rt.msaInfo;return ut.isIdpEnabled(t.MSA)&&n.signInUrl.indexOf("login.srf")>=0}function kt(){var n=rt.msaInfo;return ut.isIdpEnabled(t.MSA)&&(!pt()&&!ui()||i.hasQueryParam(n.signOutUrl,"ru")&&i.hasQueryParam(n.signInUrl,"wreply"))}function dt(){var n=rt.aadInfo;return ut.isIdpEnabled(t.AAD)&&(n.allowNonAadUrls||i.hasQueryParam(n.signInUrl,"client_id")&&i.hasQueryParam(n.signInUrl,"redirect_uri"))}function gt(){return rt.aadInfo.nonce||f.id}function pt(){return et&&et.authenticatedState==r.AuthState.SignedIn}function ei(n,t){var r=n.signInUrl,u;return n.generateSignInReturnUrl&&(u=n.generateSignInReturnUrl(),r=i.setQueryParam(r,b,encodeURIComponent(u))),r=i.setQueryParam(r,"pcexp",t?"false":"true"),pt()&&kt()&&(r=ni(n.signOutUrl,encodeURIComponent(r),l)),r}function oi(n){var t=n.signInUrl,r;return n.generateSignInReturnUrl&&(r=n.generateSignInReturnUrl(),t=i.setQueryParam(t,k,encodeURIComponent(r))),!n.allowNonAadUrls&&n.state&&(t=i.setQueryParam(t,"state",encodeURIComponent(n.state))),pt()&&dt()&&(t=i.setQueryParam(t,"prompt","select_account")),t}function si(n){var t=n.signOutUrl,i;return n.generateSignOutReturnUrl&&(i=n.generateSignOutReturnUrl(),t=ni(t,encodeURIComponent(i),l)),t}function hi(n){var t=n.signOutUrl,r;return n.generateSignOutReturnUrl&&(r=n.generateSignOutReturnUrl(),t=i.setQueryParam(t,d,encodeURIComponent(r))),t}function ni(n,t,r){for(var u=0;u<r.length;u++)i.hasQueryParam(n,r[u])&&(n=i.setQueryParam(n,r[u],t));return n}var ut=this,wt=!1,rt=g,et=null,ot=[],ft=null,lt=[],st=0,ct=!1,at;ut.setActiveUser=function(n){et=n,bt()},ut.currentState=function(){return ft||[]},ut.getUserState=function(n,i){if(ft){n(ft);return}if(lt.push({success:n,failure:i}),!ct){if(ft=null,at=Date.now(),r.TestData){ot=r.TestData,ht(!0);return}if(!e.postMessage){ht(!1,"PostMessageNotSupported");return}if(location.protocol!=="https:"){ht(!1,"HttpNotSupported");return}ct=!0,st=nt?2:1;var o={uaid:f.id,partnerId:r.Config.ptn};rt&&rt.msaInfo&&rt.aadInfo?ut.isIdpEnabled(t.MSA)?(rt.msaInfo.meTrustedOrigin=u.getDomainFromUrl(rt.msaInfo.meUrl),ut.isIdpEnabled(t.AAD)?(rt.aadInfo.meTrustedOrigin=u.getDomainFromUrl(rt.aadInfo.meUrl),u.openIFrame(rt.msaInfo.meUrl,vt,yt,o),nt&&(o.appId=rt.aadInfo.appId,u.openIFrame(rt.aadInfo.meUrl,vt,yt,o))):(tt&&(o.idpflag=c),u.openIFrame(rt.msaInfo.meUrl,vt,yt,o))):ut.isIdpEnabled(t.AAD)&&nt&&(rt.aadInfo.meTrustedOrigin=u.getDomainFromUrl(rt.aadInfo.meUrl),tt&&(o.idpflag=c),o.appId=rt.aadInfo.appId,u.openIFrame(rt.aadInfo.meUrl,vt,yt,o)):ht(!1,"InvalidRpData")}},ut.getIdpInfo=function(n){n=n||et&&et.idp;var i;switch(n){case t.MSA:i=rt.msaInfo;break;case t.AAD:i=rt.aadInfo;break;case t.MSA_FED:i=rt.aadInfo}return i||{}},ut.isIdpEnabled=function(n){if(!n)return!1;var i=ut.getIdpInfo(n);return!!(i&&(i.meUrl||n==t.AAD&&i.appId))},ut.dispose=function(){wt||(wt=!0)},ut.getSignInUrl=function(n,i){n=n||pt()&&et.idp||rt.preferredIdp||t.MSA;var f=n===t.AAD||n===t.MSA_FED,r=f?rt.aadInfo:rt.msaInfo,u=r.signInUrl;return u=f?oi(r):ei(r,i)},ut.canSignInOtherAccount=function(){return dt()||kt()},ut.getSignOutUrl=function(n){var f=n?n.idp:rt.preferredIdp||t.MSA,e=f===t.AAD||f===t.MSA_FED,r=e?rt.aadInfo:rt.msaInfo,u=r.signOutUrl;return u=e?hi(r):si(r),i.appendContextParam(u)},ut.signOutUser=function(i,r,h){var p,w,c,l;i.idp===t.AAD||i.idp===t.MSA_FED?(p=i,w=rt.aadInfo,c=ut.isIdpEnabled(t.AAD)?o.format(y,s,encodeURIComponent(w.appId),encodeURIComponent(p.sessionId),encodeURIComponent(w.siteUrl)):o.format(v,a,encodeURIComponent(p.sessionId),encodeURIComponent(u.getDomainFromUrl(e.location.href))),l=Date.now(),u.openIFrame(c,function(t){var e=u.getDomainFromUrl(c),i;return t.origin!==e?!1:(i=n.parseJSON(t.data),i&&i.signoutStatus&&i.signoutStatus.toString()==="true"?(f.logQos("SignOutUser",!0,Date.now()-l),r()):(f.logQos("SignOutUser",!1,Date.now()-l,i.error||""),h()),!0)},function(){h(),f.logQos("SignOutUser",!1,Date.now()-l,"Timeout")})):i.idp===t.MSA&&ut.isIdpEnabled(t.MSA)?e.location.href=ut.getSignOutUrl(i):h&&h()},ut.getSwitchToUrl=function(n){var u,r;return n.idp===t.MSA?(u=ut.getSignInUrl(n.idp),fi()?i.appendQueryParams(u,{username:n.memberName}):u):n.idp===t.AAD||n.idp===t.MSA_FED?(r=ut.getSignInUrl(n.idp),i.hasQueryParam(r,h)&&(r=i.setQueryParam(r,h,"")),rt.aadInfo.allowNonAadUrls||(r=i.setQueryParam(r,"nonce",encodeURIComponent(gt()))),i.setQueryParam(r,"login_hint",encodeURIComponent(n.memberName))):""},ti()}var e=window,r=e.MSA.MeControl,u=r.IFrameControl,f=r.Log,t=r.IDP,i=r.Util,o=r.Strings,h="prompt",c="proxy",s="https://login.microsoftonline.com",a="https://login.live.com",v="{0}/logout.srf?aadsession={1}&idpflag=proxy&ru={2}",y="{0}/uxlogout?appid={1}&sessionId={2}&wreply={3}&shouldForgetUser=true&isIframe=true&slice=TestSlice",p="{0}/savedusers?appid={1}&wreply={2}",w="{0}/common/oauth2/authorize?response_type=id_token&client_id={1}&scope=openid&nonce={2}&response_mode=form_post&redirect_uri={3}",b="wreply",k="redirect_uri",l=["ru","lru"],d="wreply";r.AuthStateModel=g}(window.MejQuery),function(n){function a(i,f,a){function nt(){if(y=Date.now(),p=!a,a){var n=r.format(c,s);e.openIFrame(n,tt,it,{partnerId:i,language:f})}}function g(){var n=v||{MessageType:u};return n.MessageType===u?{enabled:!1,label:"",url:""}:{enabled:!0,label:n.MessageType===o?l:r.format(r.getString("rewardsbalance"),n.Balance+""),url:h+n.Url}}function d(){p=!0;for(var n=0;n<k.length;n++)setTimeout(k[n](g()),0)}function tt(i){if(!w&&!p){if(i&&typeof i.data=="string")try{var r=n.parseJSON(i.data);r&&r.MessageType?(v=r,t.logQos("RewardsApi",!v.Error,Date.now()-y,v.ErrorDetail?v.ErrorDetail.ErrorCode+":"+v.ErrorDetail.Message:v.Error)):t.logQos("RewardsApi",!1,Date.now()-y,"InvalidJson")}catch(i){t.logQos("RewardsApi",!1,Date.now()-y,"JsonParsingError: "+(i&&i.toString()))}else t.logQos("RewardsApi",!1,Date.now()-y,"BadResponse");d()}return!0}function it(){w||p||(d(),t.logQos("RewardsApi",!1,Date.now()-y,"Timeout"))}var b=this,w,v,k=[],p,y;b.getRewardsItemData=function(n){p?n(g()):k.push(n)},b.dispose=function(){w||(w=!0)},b.setState=function(n){v=n,d()},nt()}var f=window,i=f.MSA.MeControl,e=i.IFrameControl,t=i.Log,r=i.Strings,o="Upsell",v="Balance",u="None",s="https://www.bing.com",h="https://account.microsoft.com",c="{0}/msrewards/api/v1/getuserinfo?pid=mecontrol&channel=membercenter&client=web&sso=true",l="Join Microsoft Rewards";i.RewardsStateModel=a}(window.MejQuery);(function(){var ME=window.MSA.MeControl;ME.Loc={rtl:false,lf:false};ME.Strings.addStrings({
"editdone":"Done",
"rewardsbalance":"Rewards \u0028\u007b0\u007d\u0029",
"statussigningout":"Signing out",
"microsoftaccount":"Microsoft account",
"viewaccount":"View account",
"signinotheraccount":"Sign in with another account",
"statusremoving":"Removing from list",
"statussignoutfailed":"Sign-out failed",
"removetip":"Remove from list",
"updatephoto":"Update your photo",
"statussignedin":"Signed in",
"signoutremovetip":"Sign out and remove from list",
"statusunavailable":"Not available",
"editlist":"Edit list",
"account":"Account",
"statusremovingfailed":"Removal failed",
"statussignedout":"Signed out"});ME.CssmeCore='.msame_open .msame_Header\x7bborder-color\x3a\x23e6e6e6\x3bbackground-color\x3a\x23fff\x7d.msame_open .msame_Header.msame_Mobile\x7bborder-color\x3atransparent\x3bbackground-color\x3atransparent\x7d.msame_ClickStart.msame_Drop_root .msame_Drop_AI\x3afocus,.msame_ClickStart.msame_Drop_root .msame_Drop_AI_remove\x3afocus,.msame_ClickStart.msame_Drop_root a\x3afocus\x7boutline-style\x3anone\x7d.msame_Drop_root a,.msame_Drop_root a\x3aactive,.msame_Drop_root a\x3afocus,.msame_Drop_root a\x3ahover,.msame_Drop_root a\x3avisited\x7btext-decoration\x3anone\x7d.msame_Drop_topb\x7bborder-top-color\x3a\x23e6e6e6\x3bborder-top-style\x3asolid\x3bborder-top-width\x3a1px\x7d.msame_Mobile .msame_Drop_topb\x7bwidth\x3a100\x25\x21important\x7d.msame_Drop_active\x7bpadding-bottom\x3a8px\x7d.msame_Drop_AI_picframe\x7bwidth\x3a44px\x3bheight\x3a44px\x3bborder-radius\x3a50\x25\x3boverflow\x3ahidden\x7d.msame_Drop_AI_piccont img\x7bwidth\x3a44px\x3bheight\x3a44px\x7d.msame_Drop_root\x7bborder-width\x3a1px\x3bborder-color\x3a\x23e6e6e6\x3bborder-style\x3asolid\x3bborder-top-style\x3anone\x3bposition\x3aabsolute\x3bwidth\x3a360px\x3bz-index\x3a3000000\x3bbackground-color\x3a\x23fff\x3bfont-size\x3a14px\x7d.msame_Drop_sep\x7bborder-top-width\x3a1px\x3bborder-top-color\x3a\x23e6e6e6\x3bborder-top-style\x3asolid\x3bwidth\x3a100\x25\x3bheight\x3a0\x3bdisplay\x3ablock\x7d.msame_Mobile.msame_Drop_root\x7bleft\x3a0\x21important\x3bright\x3a0\x3bbottom\x3a0\x3bwidth\x3a100\x25\x3bborder-right-width\x3a0\x3bborder-left-width\x3a0\x7d.msame_Mobile .msame_Drop_content\x7boverflow-y\x3aauto\x3bposition\x3aabsolute\x3bleft\x3a0\x3bright\x3a0\x3bbottom\x3a0\x3btop\x3a0\x7d.msame_Drop_root a\x7btext-decoration\x3anone\x7d.msame_Drop_content\x7boverflow\x3ahidden\x7d.msame_Mobile .msame_Drop_active\x7bdisplay\x3anone\x7d.msame_Drop_AI\x7bcursor\x3apointer\x7d.disabled .msame_Drop_AI_pic,.disabled .msame_Drop_AI_right\x7bopacity\x3a.4\x3bcursor\x3adefault\x7d.disabled .msame_Drop_AI_email,.disabled .msame_Drop_AI_name,.disabled .msame_Drop_AI_status\x7bcolor\x3a\x23000\x7d.msame_Drop_active_piccont\x7bpadding\x3a5px\x7d.msame_Drop_AI_piccont\x7bpadding\x3a10px\x7d.msame_Drop_active_picframe\x7bwidth\x3a74px\x3bheight\x3a74px\x3bborder-radius\x3a50\x25\x3boverflow\x3ahidden\x7d.msame_Drop_active_picborder,.msame_Drop_active_piccont a\x7bdisplay\x3ablock\x3bpadding\x3a4px\x3bborder\x3a1px dotted transparent\x3bborder-radius\x3a50\x25\x7d.msame_Drop_active_piccont a\x3afocus\x7bborder\x3a1px dotted \x23000\x7d.msame_Drop_active_piccont img\x7bwidth\x3a64px\x3bheight\x3a64px\x3bborder-radius\x3a50\x25\x7d.msame_Drop_active_name\x7bdisplay\x3ablock\x3bline-height\x3a1.3\x3bfont-size\x3a150\x25\x3bcolor\x3a\x23000\x3bfont-family\x3a\x22Segoe UI Light\x22,\x22Segoe UI Web Light\x22,\x22Segoe UI Web Regular\x22,\x22Segoe UI\x22,\x22Segoe UI Symbol\x22,HelveticaNeue-Light,\x22Helvetica Neue\x22,Arial,sans-serif\x7d.msame_Drop_active_email\x7bdisplay\x3ablock\x3bline-height\x3a1.42857\x3bfont-size\x3a100\x25\x3bcolor\x3argba\x280,0,0,.54\x29\x3bfont-family\x3a\x22Segoe UI\x22,\x22Segoe UI Web Regular\x22,\x22Segoe UI Symbol\x22,\x22Helvetica Neue\x22,\x22BBAlpha Sans\x22,\x22S60 Sans\x22,Arial,sans-serif\x7d.msame_Drop_active_right\x7bdisplay\x3ainline-block\x3bwidth\x3a216px\x3bvertical-align\x3atop\x3bpadding-top\x3a12px\x3bpadding-right\x3a12px\x3bpadding-left\x3a12px\x7d.msame_Drop_SI a\x7bline-height\x3a2\x3bfont-size\x3a114\x25\x3bfont-family\x3a\x22Segoe UI\x22,\x22Segoe UI Web Regular\x22,\x22Segoe UI Symbol\x22,\x22Helvetica Neue\x22,\x22BBAlpha Sans\x22,\x22S60 Sans\x22,Arial,sans-serif\x3bpadding-left\x3a12px\x3bpadding-right\x3a12px\x3bdisplay\x3ablock\x3bcolor\x3a\x23000\x7d.msame_Mobile .msame_Drop_SI a\x7bline-height\x3a2.75\x7d.msame_Drop_AI.switch\x3ahover,.msame_Drop_AI_remove\x3ahover,.msame_Drop_SI a\x3ahover\x7bcolor\x3a\x23000\x3bbackground-color\x3argba\x280,0,0,.12\x29\x7d.msame_Drop_AI.switch\x3aactive,.msame_Drop_AI.switch\x3aactive div,.msame_Drop_AI_remove\x3aactive,.msame_Drop_SI a\x3aactive\x7bcolor\x3a\x23fff\x21important\x3bbackground-color\x3a\x23000\x7d.msame_Drop_SI a\x3alink,.msame_Drop_SI a\x3avisited\x7bcolor\x3a\x23000\x7d.msame_Drop_active_link a,.msame_Drop_active_link a\x3aactive,.msame_Drop_active_link a\x3ahover,.msame_Drop_active_link a\x3alink,.msame_Drop_active_link a\x3avisited\x7bline-height\x3a1.333333\x3bfont-size\x3a86\x25\x3bfont-family\x3a\x22Segoe UI\x22,\x22Segoe UI Web Regular\x22,\x22Segoe UI Symbol\x22,\x22Helvetica Neue\x22,\x22BBAlpha Sans\x22,\x22S60 Sans\x22,Arial,sans-serif\x3bcolor\x3a\x230078d7\x7d.msame_Drop_AL\x7bpadding-bottom\x3a24px\x7d.msame_Drop_AI_right\x7bdisplay\x3ainline-block\x3bwidth\x3a252px\x3bvertical-align\x3atop\x3bpadding-left\x3a8px\x3bpadding-top\x3a5px\x7d.msame_Mobile .msame_Drop_AI_right\x7bwidth\x3a100px\x7d.msame_Drop_AI_name\x7bfont-family\x3a\x22Segoe UI\x22,\x22Segoe UI Web Regular\x22,\x22Segoe UI Symbol\x22,\x22Helvetica Neue\x22,\x22BBAlpha Sans\x22,\x22S60 Sans\x22,Arial,sans-serif\x3bfont-size\x3a114\x25\x3bcolor\x3a\x23000\x3bline-height\x3a1.25\x7d.msame_Drop_AI_remove\x7bfloat\x3aright\x3bmargin-top\x3a6px\x3bpadding-top\x3a12px\x3bpadding-bottom\x3a12px\x3bpadding-left\x3a12px\x3bpadding-right\x3a12px\x3btext-align\x3acenter\x3bcursor\x3apointer\x7d.msame_Drop_AI_remove img\x7bdisplay\x3ablock\x7d.msame_auto_frame\x7bdisplay\x3anone\x3bposition\x3aabsolute\x3btop\x3a0\x3bleft\x3a-4000px\x3bwidth\x3a0\x7d\x0a';ME.Loader.scriptLoaded('meCore');})();