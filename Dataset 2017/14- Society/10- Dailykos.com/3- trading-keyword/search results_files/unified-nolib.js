/* @preserve
// SpryTabbedPanels.js - version 0.6 - Spry Pre-Release 1.6.1
//
// Copyright (c) 2006. Adobe Systems Incorporated.
// All rights reserved.
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are met:
//
//   * Redistributions of source code must retain the above copyright notice,
//     this list of conditions and the following disclaimer.
//   * Redistributions in binary form must reproduce the above copyright notice,
//     this list of conditions and the following disclaimer in the documentation
//     and/or other materials provided with the distribution.
//   * Neither the name of Adobe Systems Incorporated nor the names of its
//     contributors may be used to endorse or promote products derived from this
//     software without specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
// CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
// POSSIBILITY OF SUCH DAMAGE.
*/
var Spry;if(!Spry){Spry={}}if(!Spry.Widget){Spry.Widget={}}Spry.Widget.TabbedPanels=function(a,c){this.element=this.getElement(a);this.defaultTab=0;this.tabSelectedClass="TabbedPanelsTabSelected";this.tabHoverClass="TabbedPanelsTabHover";this.tabFocusedClass="TabbedPanelsTabFocused";this.panelVisibleClass="TabbedPanelsContentVisible";this.focusElement=null;this.hasFocus=false;this.currentTabIndex=0;this.enableKeyboardNavigation=true;this.nextPanelKeyCode=Spry.Widget.TabbedPanels.KEY_RIGHT;this.previousPanelKeyCode=Spry.Widget.TabbedPanels.KEY_LEFT;Spry.Widget.TabbedPanels.setOptions(this,c);if(typeof(this.defaultTab)=="number"){if(this.defaultTab<0){this.defaultTab=0}else{var b=this.getTabbedPanelCount();if(this.defaultTab>=b){this.defaultTab=(b>1)?(b-1):0}}this.defaultTab=this.getTabs()[this.defaultTab]}if(this.defaultTab){this.defaultTab=this.getElement(this.defaultTab)}this.attachBehaviors()};Spry.Widget.TabbedPanels.prototype.getElement=function(a){if(a&&typeof a=="string"){return document.getElementById(a)}return a};Spry.Widget.TabbedPanels.prototype.getElementChildren=function(b){var a=[];var c=b.firstChild;while(c){if(c.nodeType==1){a.push(c)}c=c.nextSibling}return a};Spry.Widget.TabbedPanels.prototype.addClassName=function(b,a){if(!b||!a||(b.className&&b.className.search(new RegExp("\\b"+a+"\\b"))!=-1)){return}b.className+=(b.className?" ":"")+a};Spry.Widget.TabbedPanels.prototype.removeClassName=function(b,a){if(!b||!a||(b.className&&b.className.search(new RegExp("\\b"+a+"\\b"))==-1)){return}b.className=b.className.replace(new RegExp("\\s*\\b"+a+"\\b","g"),"")};Spry.Widget.TabbedPanels.setOptions=function(e,c,a){if(!c){return}for(var b in c){if(a&&c[b]==undefined){continue}e[b]=c[b]}};Spry.Widget.TabbedPanels.prototype.getTabGroup=function(){if(this.element){var a=this.getElementChildren(this.element);if(a.length){return a[0]}}return null};Spry.Widget.TabbedPanels.prototype.getTabs=function(){var a=[];var b=this.getTabGroup();if(b){a=this.getElementChildren(b)}return a};Spry.Widget.TabbedPanels.prototype.getContentPanelGroup=function(){if(this.element){var a=this.getElementChildren(this.element);if(a.length>1){return a[1]}}return null};Spry.Widget.TabbedPanels.prototype.getContentPanels=function(){var a=[];var b=this.getContentPanelGroup();if(b){a=this.getElementChildren(b)}return a};Spry.Widget.TabbedPanels.prototype.getIndex=function(c,a){c=this.getElement(c);if(c&&a&&a.length){for(var b=0;b<a.length;b++){if(c==a[b]){return b}}}return -1};Spry.Widget.TabbedPanels.prototype.getTabIndex=function(b){var a=this.getIndex(b,this.getTabs());if(a<0){a=this.getIndex(b,this.getContentPanels())}return a};Spry.Widget.TabbedPanels.prototype.getCurrentTabIndex=function(){return this.currentTabIndex};Spry.Widget.TabbedPanels.prototype.getTabbedPanelCount=function(a){return Math.min(this.getTabs().length,this.getContentPanels().length)};Spry.Widget.TabbedPanels.addEventListener=function(c,b,f,a){try{if(c.addEventListener){c.addEventListener(b,f,a)}else{if(c.attachEvent){c.attachEvent("on"+b,f)}}}catch(g){}};Spry.Widget.TabbedPanels.prototype.cancelEvent=function(a){if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}return false};Spry.Widget.TabbedPanels.prototype.onTabClick=function(b,a){this.showPanel(a);return this.cancelEvent(b)};Spry.Widget.TabbedPanels.prototype.onTabMouseOver=function(b,a){this.addClassName(a,this.tabHoverClass);return false};Spry.Widget.TabbedPanels.prototype.onTabMouseOut=function(b,a){this.removeClassName(a,this.tabHoverClass);return false};Spry.Widget.TabbedPanels.prototype.onTabFocus=function(b,a){this.hasFocus=true;this.addClassName(a,this.tabFocusedClass);return false};Spry.Widget.TabbedPanels.prototype.onTabBlur=function(b,a){this.hasFocus=false;this.removeClassName(a,this.tabFocusedClass);return false};Spry.Widget.TabbedPanels.KEY_UP=38;Spry.Widget.TabbedPanels.KEY_DOWN=40;Spry.Widget.TabbedPanels.KEY_LEFT=37;Spry.Widget.TabbedPanels.KEY_RIGHT=39;Spry.Widget.TabbedPanels.prototype.onTabKeyDown=function(h,g){var c=h.keyCode;if(!this.hasFocus||(c!=this.previousPanelKeyCode&&c!=this.nextPanelKeyCode)){return true}var b=this.getTabs();for(var a=0;a<b.length;a++){if(b[a]==g){var f=false;if(c==this.previousPanelKeyCode&&a>0){f=b[a-1]}else{if(c==this.nextPanelKeyCode&&a<b.length-1){f=b[a+1]}}if(f){this.showPanel(f);f.focus();break}}}return this.cancelEvent(h)};Spry.Widget.TabbedPanels.prototype.preorderTraversal=function(a,b){var f=false;if(a){f=b(a);if(a.hasChildNodes()){var g=a.firstChild;while(!f&&g){f=this.preorderTraversal(g,b);try{g=g.nextSibling}catch(c){g=null}}}}return f};Spry.Widget.TabbedPanels.prototype.addPanelEventListeners=function(e,b){var c=this;Spry.Widget.TabbedPanels.addEventListener(e,"click",function(g){return c.onTabClick(g,e)},false);Spry.Widget.TabbedPanels.addEventListener(e,"mouseover",function(g){return c.onTabMouseOver(g,e)},false);Spry.Widget.TabbedPanels.addEventListener(e,"mouseout",function(g){return c.onTabMouseOut(g,e)},false);if(this.enableKeyboardNavigation){var f=null;var a=null;this.preorderTraversal(e,function(g){if(g.nodeType==1){var h=e.attributes.getNamedItem("tabindex");if(h){f=g;return true}if(!a&&g.nodeName.toLowerCase()=="a"){a=g}}return false});if(f){this.focusElement=f}else{if(a){this.focusElement=a}}if(this.focusElement){Spry.Widget.TabbedPanels.addEventListener(this.focusElement,"focus",function(g){return c.onTabFocus(g,e)},false);Spry.Widget.TabbedPanels.addEventListener(this.focusElement,"blur",function(g){return c.onTabBlur(g,e)},false);Spry.Widget.TabbedPanels.addEventListener(this.focusElement,"keydown",function(g){return c.onTabKeyDown(g,e)},false)}}};Spry.Widget.TabbedPanels.prototype.showPanel=function(b){var g=-1;if(typeof b=="number"){g=b}else{g=this.getTabIndex(b)}if(!g<0||g>=this.getTabbedPanelCount()){return}var f=this.getTabs();var c=this.getContentPanels();var a=Math.max(f.length,c.length);for(var e=0;e<a;e++){if(e!=g){if(f[e]){this.removeClassName(f[e],this.tabSelectedClass)}if(c[e]){this.removeClassName(c[e],this.panelVisibleClass);c[e].style.display="none"}}}this.addClassName(f[g],this.tabSelectedClass);this.addClassName(c[g],this.panelVisibleClass);c[g].style.display="block";this.currentTabIndex=g};Spry.Widget.TabbedPanels.prototype.attachBehaviors=function(e){var c=this.getTabs();var a=this.getContentPanels();var f=this.getTabbedPanelCount();for(var b=0;b<f;b++){this.addPanelEventListeners(c[b],a[b])}this.showPanel(this.defaultTab)};
/* @preserve
 * jQuery BBQ: Back Button & Query Library - v1.2.1 - 2/17/2010
 * http://benalman.com/projects/jquery-bbq-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(F,V){var ad,Y=Array.prototype.slice,R=decodeURIComponent,al=F.param,aj,Z,K,ak=F.bbq=F.bbq||{},T,L,ac,ah=F.event.special,ai="hashchange",U="querystring",P="fragment",H="elemUrlAttr",af="location",ab="href",N="src",I=/^.*\?|#.*$/g,J=/^.*\#/,ae,Q={};function M(a){return typeof a==="string"}function S(a){var b=Y.call(arguments,1);return function(){return a.apply(this,b.concat(Y.call(arguments)))}}function X(a){return a.replace(/^[^#]*#?(.*)$/,"$1")}function W(a){return a.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function ag(j,c,l,h,k){var a,e,f,b,g;if(h!==ad){f=l.match(j?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);g=f[3]||"";if(k===2&&M(h)){e=h.replace(j?J:I,"")}else{b=Z(f[2]);h=M(h)?Z[j?P:U](h):h;e=k===2?h:k===1?F.extend({},h,b):F.extend({},b,h);e=al(e);if(j){e=e.replace(ae,R)}}a=f[1]+(j?"#":e||!f[1]?"?":"")+e+g}else{a=c(l!==ad?l:V[af][ab])}return a}al[U]=S(ag,0,W);al[P]=aj=S(ag,1,X);aj.noEscape=function(a){a=a||"";var b=F.map(a.split(""),encodeURIComponent);ae=new RegExp(b.join("|"),"g")};aj.noEscape(",/");F.deparam=Z=function(a,e){var b={},c={"true":!0,"false":!1,"null":null};F.each(a.replace(/\+/g," ").split("&"),function(n,g){var o=g.split("="),h=R(o[0]),p,j=b,l=0,f=h.split("]["),k=f.length-1;if(/\[/.test(f[0])&&/\]$/.test(f[k])){f[k]=f[k].replace(/\]$/,"");f=f.shift().split("[").concat(f);k=f.length-1}else{k=0}if(o.length===2){p=R(o[1]);if(e){p=p&&!isNaN(p)?+p:p==="undefined"?ad:c[p]!==ad?c[p]:p}if(k){for(;l<=k;l++){h=f[l]===""?j.length:f[l];j=j[h]=l<k?j[h]||(f[l+1]&&isNaN(f[l+1])?{}:[]):p}}else{if(F.isArray(b[h])){b[h].push(p)}else{if(b[h]!==ad){b[h]=[b[h],p]}else{b[h]=p}}}}else{if(h){b[h]=e?ad:""}}});return b};function G(a,c,b){if(c===ad||typeof c==="boolean"){b=c;c=al[a?P:U]()}else{c=M(c)?c.replace(a?J:I,""):c}return Z(c,b)}Z[U]=S(G,0);Z[P]=K=S(G,1);F[H]||(F[H]=function(a){return F.extend(Q,a)})({a:ab,base:ab,iframe:N,img:N,input:N,form:"action",link:ab,script:N});ac=F[H];function O(a,c,b,e){if(!M(b)&&typeof b!=="object"){e=b;b=c;c=ad}return this.each(function(){var f=F(this),h=c||ac()[(this.nodeName||"").toLowerCase()]||"",g=h&&f.attr(h)||"";f.attr(h,al[a](g,b,e))})}F.fn[U]=S(O,U);F.fn[P]=S(O,P);ak.pushState=T=function(a,e){if(M(a)&&/^#/.test(a)&&e===ad){e=2}var b=a!==ad,c=aj(V[af][ab],b?a:{},b?e:2);V[af][ab]=c+(/#/.test(c)?"":"#")};ak.getState=L=function(b,a){return b===ad||typeof b==="boolean"?K(b):K(a)[b]};ak.removeState=function(b){var a={};if(b!==ad){a=L();F.each(F.isArray(b)?b:arguments,function(c,e){delete a[e]})}T(a,2)};ah[ai]=F.extend(ah[ai],{add:function(c){var a;function b(e){var f=e[P]=aj();e.getState=function(h,g){return h===ad||typeof h==="boolean"?Z(f,h):Z(f,g)[h]};a.apply(this,arguments)}if(F.isFunction(c)){a=c;return b}else{a=c.handler;c.handler=b}}})})(jQuery,this);(function(q,r,z){var p,o=q.event.special,x="location",w="hashchange",n="href",u=q.browser,t=document.documentMode,s=u.msie&&(t===z||t<8),v="on"+w in r&&!s;function A(a){a=a||r[x][n];return a.replace(/^[^#]*#?(.*)$/,"$1")}q[w+"Delay"]=100;o[w]=q.extend(o[w],{setup:function(){if(v){return false}q(p.start)},teardown:function(){if(v){return false}q(p.stop)}});p=(function(){var a={},b,g,f,c;function e(){f=c=function(h){return h};if(s){g=q('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;c=function(){return A(g.document[x][n])};f=function(h,k){if(h!==k){var j=g.document;j.open().close();j[x].hash="#"+h}};f(A())}}a.start=function(){if(b){return}var h=A();f||e();(function j(){var k=A(),l=c(h);if(k!==h){f(h=k,l);q(r).trigger(w)}else{if(l!==h){r[x][n]=r[x][n].replace(/#.*/,"")+"#"+l}}b=setTimeout(j,q[w+"Delay"])})()};a.stop=function(){if(!g){b&&clearTimeout(b);b=0}};return a})()})(jQuery,this);
/** @preserve
 * jGrowl 1.2.4
 *
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Written by Stan Lemon <stosh1985@gmail.com>
 * Last updated: 2009.12.13
 *
 * jGrowl is a jQuery plugin implementing unobtrusive userland notifications.  These 
 * notifications function similarly to the Growl Framework available for
 * Mac OS X (http://growl.info).
 *
 * To Do:
 * - Move library settings to containers and allow them to be changed per container
 *
 * Changes in 1.2.4
 * - Fixed IE bug with the close-all button
 * - Fixed IE bug with the filter CSS attribute (special thanks to gotwic)
 * - Update IE opacity CSS
 * - Changed font sizes to use "em", and only set the base style
 *
 * Changes in 1.2.3
 * - The callbacks no longer use the container as context, instead they use the actual notification
 * - The callbacks now receive the container as a parameter after the options parameter
 * - beforeOpen and beforeClose now check the return value, if it's false - the notification does
 *   not continue.  The open callback will also halt execution if it returns false.
 * - Fixed bug where containers would get confused
 * - Expanded the pause functionality to pause an entire container.
 *
 * Changes in 1.2.2
 * - Notification can now be theme rolled for jQuery UI, special thanks to Jeff Chan!
 *
 * Changes in 1.2.1
 * - Fixed instance where the interval would fire the close method multiple times.
 * - Added CSS to hide from print media
 * - Fixed issue with closer button when div { position: relative } is set
 * - Fixed leaking issue with multiple containers.  Special thanks to Matthew Hanlon!
 *
 * Changes in 1.2.0
 * - Added message pooling to limit the number of messages appearing at a given time.
 * - Closing a notification is now bound to the notification object and triggered by the close button.
 *
 * Changes in 1.1.2
 * - Added iPhone styled example
 * - Fixed possible IE7 bug when determining if the ie6 class shoudl be applied.
 * - Added template for the close button, so that it's content could be customized.
 *
 * Changes in 1.1.1
 * - Fixed CSS styling bug for ie6 caused by a mispelling
 * - Changes height restriction on default notifications to min-height
 * - Added skinned examples using a variety of images
 * - Added the ability to customize the content of the [close all] box
 * - Added jTweet, an example of using jGrowl + Twitter
 *
 * Changes in 1.1.0
 * - Multiple container and instances.
 * - Standard $.jGrowl() now wraps $.fn.jGrowl() by first establishing a generic jGrowl container.
 * - Instance methods of a jGrowl container can be called by $.fn.jGrowl(methodName)
 * - Added glue preferenced, which allows notifications to be inserted before or after nodes in the container
 * - Added new log callback which is called before anything is done for the notification
 * - Corner's attribute are now applied on an individual notification basis.
 *
 * Changes in 1.0.4
 * - Various CSS fixes so that jGrowl renders correctly in IE6.
 *
 * Changes in 1.0.3
 * - Fixed bug with options persisting across notifications
 * - Fixed theme application bug
 * - Simplified some selectors and manipulations.
 * - Added beforeOpen and beforeClose callbacks
 * - Reorganized some lines of code to be more readable
 * - Removed unnecessary this.defaults context
 * - If corners plugin is present, it's now customizable.
 * - Customizable open animation.
 * - Customizable close animation.
 * - Customizable animation easing.
 * - Added customizable positioning (top-left, top-right, bottom-left, bottom-right, center)
 *
 * Changes in 1.0.2
 * - All CSS styling is now external.
 * - Added a theme parameter which specifies a secondary class for styling, such
 *   that notifications can be customized in appearance on a per message basis.
 * - Notification life span is now customizable on a per message basis.
 * - Added the ability to disable the global closer, enabled by default.
 * - Added callbacks for when a notification is opened or closed.
 * - Added callback for the global closer.
 * - Customizable animation speed.
 * - jGrowl now set itself up and tears itself down.
 *
 * Changes in 1.0.1:
 * - Removed dependency on metadata plugin in favor of .data()
 * - Namespaced all events
 */
(function(a){a.jGrowl=function(b,c){if(a("#jGrowl").size()==0){a('<div id="jGrowl"></div>').addClass(a.jGrowl.defaults.position).appendTo("body")}a("#jGrowl").jGrowl(b,c)};a.fn.jGrowl=function(b,e){if(a.isFunction(this.each)){var c=arguments;return this.each(function(){var f=this;if(a(this).data("jGrowl.instance")==undefined){a(this).data("jGrowl.instance",a.extend(new a.fn.jGrowl(),{notifications:[],element:null,interval:null}));a(this).data("jGrowl.instance").startup(this)}if(a.isFunction(a(this).data("jGrowl.instance")[b])){a(this).data("jGrowl.instance")[b].apply(a(this).data("jGrowl.instance"),a.makeArray(c).slice(1))}else{a(this).data("jGrowl.instance").create(b,e)}})}};a.extend(a.fn.jGrowl.prototype,{defaults:{pool:0,header:"",group:"",sticky:false,position:"top-right",glue:"after",theme:"default",corners:"10px",check:250,life:3000,speed:"normal",easing:"swing",closer:true,closeTemplate:"&times;",closerTemplate:"<div>[ close all ]</div>",log:function(c,b,f){},beforeOpen:function(c,b,f){},open:function(c,b,f){},beforeClose:function(c,b,f){},close:function(c,b,f){},animateOpen:{opacity:"show"},animateClose:{opacity:"hide"}},notifications:[],element:null,interval:null,create:function(b,c){var c=a.extend({},this.defaults,c);this.notifications.push({message:b,options:c});c.log.apply(this.element,[this.element,b,c])},render:function(e){var b=this;var c=e.message;var f=e.options;var e=a('<div class="jGrowl-notification ui-state-highlight ui-corner-all'+((f.group!=undefined&&f.group!="")?" "+f.group:"")+'"><div class="close">'+f.closeTemplate+'</div><div class="header">'+f.header+'</div><div class="message">'+c+"</div></div>").data("jGrowl",f).addClass(f.theme).children("div.close").bind("click.jGrowl",function(){a(this).parent().trigger("jGrowl.close")}).parent();a(e).bind("mouseover.jGrowl",function(){a("div.jGrowl-notification",b.element).data("jGrowl.pause",true)}).bind("mouseout.jGrowl",function(){a("div.jGrowl-notification",b.element).data("jGrowl.pause",false)}).bind("jGrowl.beforeOpen",function(){if(f.beforeOpen.apply(e,[e,c,f,b.element])!=false){a(this).trigger("jGrowl.open")}}).bind("jGrowl.open",function(){if(f.open.apply(e,[e,c,f,b.element])!=false){if(f.glue=="after"){a("div.jGrowl-notification:last",b.element).after(e)}else{a("div.jGrowl-notification:first",b.element).before(e)}a(this).animate(f.animateOpen,f.speed,f.easing,function(){if(a.browser.msie&&(parseInt(a(this).css("opacity"),10)===1||parseInt(a(this).css("opacity"),10)===0)){this.style.removeAttribute("filter")}a(this).data("jGrowl").created=new Date()})}}).bind("jGrowl.beforeClose",function(){if(f.beforeClose.apply(e,[e,c,f,b.element])!=false){a(this).trigger("jGrowl.close")}}).bind("jGrowl.close",function(){a(this).data("jGrowl.pause",true);a(this).animate(f.animateClose,f.speed,f.easing,function(){a(this).remove();var g=f.close.apply(e,[e,c,f,b.element]);if(a.isFunction(g)){g.apply(e,[e,c,f,b.element])}})}).trigger("jGrowl.beforeOpen");if(a.fn.corner!=undefined){a(e).corner(f.corners)}if(a("div.jGrowl-notification:parent",b.element).size()>1&&a("div.jGrowl-closer",b.element).size()==0&&this.defaults.closer!=false){a(this.defaults.closerTemplate).addClass("jGrowl-closer ui-state-highlight ui-corner-all").addClass(this.defaults.theme).appendTo(b.element).animate(this.defaults.animateOpen,this.defaults.speed,this.defaults.easing).bind("click.jGrowl",function(){a(this).siblings().children("div.close").trigger("click.jGrowl");if(a.isFunction(b.defaults.closer)){b.defaults.closer.apply(a(this).parent()[0],[a(this).parent()[0]])}})}},update:function(){a(this.element).find("div.jGrowl-notification:parent").each(function(){if(a(this).data("jGrowl")!=undefined&&a(this).data("jGrowl").created!=undefined&&(a(this).data("jGrowl").created.getTime()+a(this).data("jGrowl").life)<(new Date()).getTime()&&a(this).data("jGrowl").sticky!=true&&(a(this).data("jGrowl.pause")==undefined||a(this).data("jGrowl.pause")!=true)){a(this).trigger("jGrowl.beforeClose")}});if(this.notifications.length>0&&(this.defaults.pool==0||a(this.element).find("div.jGrowl-notification:parent").size()<this.defaults.pool)){this.render(this.notifications.shift())}if(a(this.element).find("div.jGrowl-notification:parent").size()<2){a(this.element).find("div.jGrowl-closer").animate(this.defaults.animateClose,this.defaults.speed,this.defaults.easing,function(){a(this).remove()})}},startup:function(b){this.element=a(b).addClass("jGrowl").append('<div class="jGrowl-notification"></div>');this.interval=setInterval(function(){a(b).data("jGrowl.instance").update()},this.defaults.check);if(a.browser.msie&&parseInt(a.browser.version)<7&&!window.XMLHttpRequest){a(this.element).addClass("ie6")}},shutdown:function(){a(this.element).removeClass("jGrowl").find("div.jGrowl-notification").remove();clearInterval(this.interval)},close:function(){a(this.element).find("div.jGrowl-notification").each(function(){a(this).trigger("jGrowl.beforeClose")})}});a.jGrowl.defaults=a.fn.jGrowl.prototype.defaults})(jQuery);(function(n){var o=[],f=[],h=activeItem=null,b=n('<div class="menu-div outerbox" style="position:absolute;top:0;left:0;display:none;"><div class="shadowbox1"></div><div class="shadowbox2"></div><div class="shadowbox3"></div></div>')[0],c=n('<ul class="menu-ul innerbox"></ul>')[0],g=n('<li style="position:relative;"><div class="menu-item"></div></li>')[0],j=n('<img class="menu-item-arrow" />')[0],k=n('<div id="root-menu-div" style="position:absolute;top:0;left:0;"></div>'),a={showDelay:200,hideDelay:200,hoverOpenDelay:0,offsetTop:0,offsetLeft:0,minWidth:0,onOpen:null,onClose:null,onClick:null,arrowSrc:null,addExpando:false,copyClassAttr:false};n(function(){k.appendTo("body")});n.extend({MenuCollection:function(p){this.menus=[];this.init(p)}});n.extend(n.MenuCollection,{prototype:{init:function(q){if(q&&q.length){for(var p=0;p<q.length;p++){this.addMenu(q[p]);q[p].menuCollection=this}}},addMenu:function(p){if(p instanceof n.Menu){this.menus.push(p)}p.menuCollection=this;var q=this;n(p.target).hover(function(){if(p.visible){return}for(var r=0;r<q.menus.length;r++){if(q.menus[r].visible){q.menus[r].hide();p.show();return}}},function(){})}}});n.extend({Menu:function(p,r,q){this.menuItems=[];this.subMenus=[];this.visible=false;this.active=false;this.parentMenuItem=null;this.settings=n.extend({},a,q);this.target=p;this.$eDIV=null;this.$eUL=null;this.timer=null;this.menuCollection=null;this.openTimer=null;this.init();if(r&&r.constructor==Array){this.addItems(r)}}});n.extend(n.Menu,{checkMouse:function(p){var q=p.target;if(f.length&&q==f[0].target){return}while(q.parentNode&&q.parentNode!=k[0]){q=q.parentNode}if(!n(f).filter(function(){return this.$eDIV[0]==q}).length){n.Menu.closeAll()}},checkKey:function(q){switch(q.keyCode){case 13:if(activeItem){activeItem.click(q,activeItem.$eLI[0])}break;case 27:n.Menu.closeAll();break;case 37:if(!h){h=f[0]}var u=h;if(u&&u.parentMenuItem){var s=u.parentMenuItem;s.$eLI.unbind("mouseout").unbind("mouseover");u.hide();s.hoverIn(true);setTimeout(function(){s.bindHover()})}else{if(u&&u.menuCollection){var p,t=u.menuCollection.menus;if((p=n.inArray(u,t))>-1){if(--p<0){p=t.length-1}n.Menu.closeAll();t[p].show();t[p].setActive();if(t[p].menuItems.length){t[p].menuItems[0].hoverIn(true)}}}}break;case 38:if(h){h.selectNextItem(-1)}break;case 39:if(!h){h=f[0]}var v,u=h,r=activeItem?activeItem.subMenu:null;if(u){if(r&&r.menuItems.length){r.show();r.menuItems[0].hoverIn()}else{if((u=u.inMenuCollection())){var p,t=u.menuCollection.menus;if((p=n.inArray(u,t))>-1){if(++p>=t.length){p=0}n.Menu.closeAll();t[p].show();t[p].setActive();if(t[p].menuItems.length){t[p].menuItems[0].hoverIn(true)}}}}}break;case 40:if(!h){if(f.length&&f[0].menuItems.length){f[0].menuItems[0].hoverIn()}}else{h.selectNextItem()}break}if(q.keyCode>36&&q.keyCode<41){return false}},closeAll:function(){while(f.length){f[0].hide()}},setDefaults:function(p){n.extend(a,p)},prototype:{init:function(){var p=this;if(!this.target){return}else{if(this.target instanceof n.MenuItem){this.parentMenuItem=this.target;this.target.addSubMenu(this);this.target=this.target.$eLI}}o.push(this);this.$eDIV=n(b.cloneNode(1));this.$eUL=n(c.cloneNode(1));this.$eDIV[0].appendChild(this.$eUL[0]);k[0].appendChild(this.$eDIV[0]);if(!this.parentMenuItem){n(this.target).click(function(q){p.onClick(q)}).hover(function(q){p.setActive();if(p.settings.hoverOpenDelay){p.openTimer=setTimeout(function(){if(!p.visible){p.onClick(q)}},p.settings.hoverOpenDelay)}},function(){if(!p.visible){n(this).removeClass("activetarget")}if(p.openTimer){clearTimeout(p.openTimer)}})}else{this.$eDIV.hover(function(){p.setActive()},function(){})}},setActive:function(){if(!this.parentMenuItem){n(this.target).addClass("activetarget")}else{this.active=true}},addItem:function(p){if(p instanceof n.MenuItem){if(n.inArray(p,this.menuItems)==-1){this.$eUL.append(p.$eLI);this.menuItems.push(p);p.parentMenu=this;if(p.subMenu){this.subMenus.push(p.subMenu)}}}else{this.addItem(new n.MenuItem(p,this.settings))}},addItems:function(q){for(var p=0;p<q.length;p++){this.addItem(q[p])}},removeItem:function(q){var p=n.inArray(q,this.menuItems);if(p>-1){this.menuItems.splice(p,1)}q.parentMenu=null},hide:function(){if(!this.visible){return}var q,p=n.inArray(this,f);this.$eDIV.hide();if(p>=0){f.splice(p,1)}this.visible=this.active=false;n(this.target).removeClass("activetarget");for(q=0;q<this.subMenus.length;q++){this.subMenus[q].hide()}for(q=0;q<this.menuItems.length;q++){if(this.menuItems[q].active){this.menuItems[q].setInactive()}}if(!f.length){n(document).unbind("mousedown",n.Menu.checkMouse).unbind("keydown",n.Menu.checkKey)}if(h==this){h=null}if(this.settings.onClose){this.settings.onClose.call(this)}},show:function(p){if(this.visible){return}var q,r=this.parentMenuItem;if(this.menuItems.length){if(r){q=parseInt(r.parentMenu.$eDIV.css("z-index"));this.$eDIV.css("z-index",(isNaN(q)?1:q+1))}this.$eDIV.css({visibility:"hidden",display:"block"});if(this.settings.minWidth){if(this.$eDIV.width()<this.settings.minWidth){this.$eDIV.css("width",this.settings.minWidth)}}this.setPosition();this.$eDIV.css({display:"none",visibility:""}).show();if(n.browser.msie){this.$eUL.css("width",parseInt(n.browser.version)==6?this.$eDIV.width()-7:this.$eUL.width())}if(this.settings.onOpen){this.settings.onOpen.call(this)}}if(f.length==0){n(document).bind("mousedown",n.Menu.checkMouse).bind("keydown",n.Menu.checkKey)}this.visible=true;f.push(this)},setPosition:function(){var v,x,A,C,s,r,w,u=n(window).width(),B=n(window).height(),q=this.parentMenuItem,p=this.$eDIV[0].clientHeight,z=this.$eDIV[0].clientWidth,t;if(q){x=q.$eLI.offset();A=x.left+q.$eLI.width();C=x.top}else{v=n(this.target);x=v.offset();A=x.left+this.settings.offsetLeft;C=x.top+v.height()+this.settings.offsetTop}if(n.fn.scrollTop){r=n(window).scrollTop();if(B<p){C=r}else{if(B+r<C+p){if(q){s=q.parentMenu.$eDIV.offset();t=q.parentMenu.$eDIV[0].clientHeight;if(p<=t){C=s.top+t-p}else{C=s.top}if(B+r<C+p){C-=C+p-(B+r)}}else{C-=C+p-(B+r)}}}}if(n.fn.scrollLeft){w=n(window).scrollLeft();if(u+w<A+z){if(q){A-=q.$eLI.width()+z;if(A<w){A=w}}else{A-=A+z-(u+w)}}}this.$eDIV.css({left:A,top:C})},onClick:function(p){if(this.visible){this.hide();this.setActive()}else{n.Menu.closeAll();this.show(p)}},addTimer:function(p,q){var r=this;this.timer=setTimeout(function(){p.call(r);r.timer=null},q)},removeTimer:function(){if(this.timer){clearTimeout(this.timer);this.timer=null}},selectNextItem:function(q){var t,p=0,s=this.menuItems.length,r=q||1;for(t=0;t<s;t++){if(this.menuItems[t].active){p=t;break}}this.menuItems[p].hoverOut();do{p+=r;if(p>=s){p=0}else{if(p<0){p=s-1}}}while(this.menuItems[p].separator);this.menuItems[p].hoverIn(true)},inMenuCollection:function(){var p=this;while(p.parentMenuItem){p=p.parentMenuItem.parentMenu}return p.menuCollection?p:null},destroy:function(){var p,q;this.hide();if(!this.parentMenuItem){n(this.target).unbind("click").unbind("mouseover").unbind("mouseout")}else{this.$eDIV.unbind("mouseover").unbind("mouseout")}while(this.menuItems.length){q=this.menuItems[0];q.destroy();delete q}if((p=n.inArray(this,o))>-1){o.splice(p,1)}if(this.menuCollection){if((p=n.inArray(this,this.menuCollection.menus))>-1){this.menuCollection.menus.splice(p,1)}}this.$eDIV.remove()}}});n.extend({MenuItem:function(p,q){if(typeof p=="string"){p={src:p}}this.src=p.src||"";this.url=p.url||null;this.urlTarget=p.target||null;this.addClass=p.addClass||null;this.data=p.data||null;this.$eLI=null;this.parentMenu=null;this.subMenu=null;this.settings=n.extend({},a,q);this.active=false;this.enabled=true;this.separator=false;this.init();if(p.subMenu){new n.Menu(this,p.subMenu,q)}}});n.extend(n.MenuItem,{prototype:{init:function(){var q,r,p=this.src,s=this;this.$eLI=n(g.cloneNode(1));if(this.addClass){this.$eLI[0].setAttribute("class",this.addClass)}if(this.settings.addExpando&&this.data){this.$eLI[0].menuData=this.data}if(p==""){this.$eLI.addClass("menu-separator");this.separator=true}else{r=typeof p=="string";if(r&&this.url){p=n('<a href="'+this.url+'"'+(this.urlTarget?'target="'+this.urlTarget+'"':"")+">"+p+"</a>")}else{if(r||!p.length){p=[p]}}for(q=0;q<p.length;q++){if(typeof p[q]=="string"){elem=document.createElement("span");elem.innerHTML=p[q];this.$eLI[0].firstChild.appendChild(elem)}else{this.$eLI[0].firstChild.appendChild(p[q].cloneNode(1))}}}this.$eLI.click(function(t){s.click(t,this)});this.bindHover()},click:function(p,q){if(this.enabled&&this.settings.onClick){this.settings.onClick.call(q,p,this)}},bindHover:function(){var p=this;this.$eLI.hover(function(){p.hoverIn()},function(){p.hoverOut()})},hoverIn:function(s){this.removeTimer();var r,p=this.parentMenu.subMenus,q=this.parentMenu.menuItems,t=this;if(this.parentMenu.timer){this.parentMenu.removeTimer()}if(!this.enabled){return}for(r=0;r<q.length;r++){if(q[r].active){q[r].setInactive()}}this.setActive();h=this.parentMenu;for(r=0;r<p.length;r++){if(p[r].visible&&p[r]!=this.subMenu&&!p[r].timer){p[r].addTimer(function(){this.hide()},p[r].settings.hideDelay)}}if(this.subMenu&&!s){this.subMenu.addTimer(function(){this.show()},this.subMenu.settings.showDelay)}},hoverOut:function(){this.removeTimer();if(!this.enabled){return}if(!this.subMenu||!this.subMenu.visible){this.setInactive()}},removeTimer:function(){if(this.subMenu){this.subMenu.removeTimer()}},setActive:function(){this.active=true;this.$eLI.addClass("active");var p=this.parentMenu.parentMenuItem;if(p&&!p.active){p.setActive()}activeItem=this},setInactive:function(){this.active=false;this.$eLI.removeClass("active");if(this==activeItem){activeItem=null}},enable:function(){this.$eLI.removeClass("disabled");this.enabled=true},disable:function(){this.$eLI.addClass("disabled");this.enabled=false},destroy:function(){this.removeTimer();this.$eLI.remove();this.$eLI.unbind("mouseover").unbind("mouseout").unbind("click");if(this.subMenu){this.subMenu.destroy();delete this.subMenu}this.parentMenu.removeItem(this)},addSubMenu:function(p){if(this.subMenu){return}this.subMenu=p;if(this.parentMenu&&n.inArray(p,this.parentMenu.subMenus)==-1){this.parentMenu.subMenus.push(p)}if(this.settings.arrowSrc){var q=j.cloneNode(0);q.setAttribute("src",this.settings.arrowSrc);this.$eLI[0].firstChild.appendChild(q)}}}});n.extend(n.fn,{menuFromElement:function(r,p,q){var s=function(v){var A=[],x,B,E,u,z,t,C,w,D=null;E=l(v,"LI");for(z=0;z<E.length;z++){x=[];if(!E[z].childNodes.length){A.push(new n.MenuItem("",r));continue}if((t=e(E[z],"UL"))){x=s(t);n(t).remove()}u=n(E[z]);if(u[0].childNodes.length==1&&u[0].childNodes[0].nodeType==3){w=u[0].childNodes[0].nodeValue}else{w=u[0].childNodes}if(r&&r.copyClassAttr){D=u.attr("class")}B=new n.MenuItem({src:w,addClass:D},r);A.push(B);if(x.length){new n.Menu(B,x,r)}}return A};return this.each(function(){var t,u;if(p||(t=e(this,"UL"))){t=p?n(p).clone(true)[0]:t;menuItems=s(t);if(menuItems.length){u=new n.Menu(this,menuItems,r);if(q){q.addMenu(u)}}n(t).hide()}})},menuBarFromUL:function(p){return this.each(function(){var q,r=l(this,"LI");if(r.length){bar=new n.MenuCollection();for(q=0;q<r.length;q++){n(r[q]).menuFromElement(p,null,bar)}}})},menu:function(p,q){return this.each(function(){if(q&&q.constructor==Array){new n.Menu(this,q,p)}else{if(this.nodeName.toUpperCase()=="UL"){n(this).menuBarFromUL(p)}else{n(this).menuFromElement(p,q)}}})}});var e=function(q,r){if(!q){return null}var p=q.firstChild;for(;p;p=p.nextSibling){if(p.nodeType==1&&p.nodeName.toUpperCase()==r){return p}}return null};var l=function(q,s){if(!q){return[]}var r=[],p=q.firstChild;for(;p;p=p.nextSibling){if(p.nodeType==1&&p.nodeName.toUpperCase()==s){r[r.length]=p}}return r}})(jQuery);
/* @preserve
 * jquery.qtip. The jQuery tooltip plugin
 *
 * Copyright (c) 2009 Craig Thompson
 * http://craigsworks.com
 *
 * Licensed under MIT
 * http://www.opensource.org/licenses/mit-license.php
 *
 * Launch  : February 2009
 * Version : 1.0.0-rc3
 * Released: Tuesday 12th May, 2009 - 00:00
 * Debug: jquery.qtip.debug.js
 */
(function(g){g.fn.qtip=function(E,w){var B,v,D,u,A,z,x,C;if(typeof E=="string"){if(typeof g(this).data("qtip")!=="object"){g.fn.qtip.log.error.call(self,1,g.fn.qtip.constants.NO_TOOLTIP_PRESENT,false)}if(E=="api"){return g(this).data("qtip").interfaces[g(this).data("qtip").current]}else{if(E=="interfaces"){return g(this).data("qtip").interfaces}}}else{if(!E){E={}}if(typeof E.content!=="object"||(E.content.jquery&&E.content.length>0)){E.content={text:E.content}}if(typeof E.content.title!=="object"){E.content.title={text:E.content.title}}if(typeof E.position!=="object"){E.position={corner:E.position}}if(typeof E.position.corner!=="object"){E.position.corner={target:E.position.corner,tooltip:E.position.corner}}if(typeof E.show!=="object"){E.show={when:E.show}}if(typeof E.show.when!=="object"){E.show.when={event:E.show.when}}if(typeof E.show.effect!=="object"){E.show.effect={type:E.show.effect}}if(typeof E.hide!=="object"){E.hide={when:E.hide}}if(typeof E.hide.when!=="object"){E.hide.when={event:E.hide.when}}if(typeof E.hide.effect!=="object"){E.hide.effect={type:E.hide.effect}}if(typeof E.style!=="object"){E.style={name:E.style}}E.style=c(E.style);u=g.extend(true,{},g.fn.qtip.defaults,E);u.style=a.call({options:u},u.style);u.user=g.extend(true,{},E)}return g(this).each(function(){if(typeof E=="string"){z=E.toLowerCase();D=g(this).qtip("interfaces");if(typeof D=="object"){if(w===true&&z=="destroy"){while(D.length>0){D[D.length-1].destroy()}}else{if(w!==true){D=[g(this).qtip("api")]}for(B=0;B<D.length;B++){if(z=="destroy"){D[B].destroy()}else{if(D[B].status.rendered===true){if(z=="show"){D[B].show()}else{if(z=="hide"){D[B].hide()}else{if(z=="focus"){D[B].focus()}else{if(z=="disable"){D[B].disable(true)}else{if(z=="enable"){D[B].disable(false)}}}}}}}}}}}else{x=g.extend(true,{},u);x.hide.effect.length=u.hide.effect.length;x.show.effect.length=u.show.effect.length;if(x.position.container===false){x.position.container=g(document.body)}if(x.position.target===false){x.position.target=g(this)}if(x.show.when.target===false){x.show.when.target=g(this)}if(x.hide.when.target===false){x.hide.when.target=g(this)}v=g.fn.qtip.interfaces.length;for(B=0;B<v;B++){if(typeof g.fn.qtip.interfaces[B]=="undefined"){v=B;break}}A=new e(g(this),x,v);g.fn.qtip.interfaces[v]=A;if(typeof g(this).data("qtip")==="object"&&g(this).data("qtip")){if(typeof g(this).attr("qtip")==="undefined"){g(this).data("qtip").current=g(this).data("qtip").interfaces.length}g(this).data("qtip").interfaces.push(A)}else{g(this).data("qtip",{current:0,interfaces:[A]})}if(x.content.prerender===false&&x.show.when.event!==false&&x.show.ready!==true){x.show.when.target.bind(x.show.when.event+".qtip-"+v+"-create",{qtip:v},function(F){C=g.fn.qtip.interfaces[F.data.qtip];C.options.show.when.target.unbind(C.options.show.when.event+".qtip-"+F.data.qtip+"-create");C.cache.mouse={x:F.pageX,y:F.pageY};r.call(C);C.options.show.when.target.trigger(C.options.show.when.event)})}else{A.cache.mouse={x:x.show.when.target.offset().left,y:x.show.when.target.offset().top};r.call(A)}}})};function e(w,v,x){var u=this;u.id=x;u.options=v;u.status={animated:false,rendered:false,disabled:false,focused:false};u.elements={target:w.addClass(u.options.style.classes.target),tooltip:null,wrapper:null,content:null,contentWrapper:null,title:null,button:null,tip:null,bgiframe:null};u.cache={mouse:{},position:{},toggle:0};u.timers={};g.extend(u,u.options.api,{show:function(B){var A,C;if(!u.status.rendered){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.TOOLTIP_NOT_RENDERED,"show")}if(u.elements.tooltip.css("display")!=="none"){return u}u.elements.tooltip.stop(true,false);A=u.beforeShow.call(u,B);if(A===false){return u}function z(){if(u.options.position.type!=="static"){u.focus()}u.onShow.call(u,B);if(g.browser.msie){u.elements.tooltip.get(0).style.removeAttribute("filter")}}u.cache.toggle=1;if(u.options.position.type!=="static"){u.updatePosition(B,(u.options.show.effect.length>0))}if(typeof u.options.show.solo=="object"){C=g(u.options.show.solo)}else{if(u.options.show.solo===true){C=g("div.qtip").not(u.elements.tooltip)}}if(C){C.each(function(){if(g(this).qtip("api").status.rendered===true){g(this).qtip("api").hide()}})}if(typeof u.options.show.effect.type=="function"){u.options.show.effect.type.call(u.elements.tooltip,u.options.show.effect.length);u.elements.tooltip.queue(function(){z();g(this).dequeue()})}else{switch(u.options.show.effect.type.toLowerCase()){case"fade":u.elements.tooltip.fadeIn(u.options.show.effect.length,z);break;case"slide":u.elements.tooltip.slideDown(u.options.show.effect.length,function(){z();if(u.options.position.type!=="static"){u.updatePosition(B,true)}});break;case"grow":u.elements.tooltip.show(u.options.show.effect.length,z);break;default:u.elements.tooltip.show(null,z);break}u.elements.tooltip.addClass(u.options.style.classes.active)}return g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.EVENT_SHOWN,"show")},hide:function(B){var A;if(!u.status.rendered){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.TOOLTIP_NOT_RENDERED,"hide")}else{if(u.elements.tooltip.css("display")==="none"){return u}}clearTimeout(u.timers.show);u.elements.tooltip.stop(true,false);A=u.beforeHide.call(u,B);if(A===false){return u}function z(){u.onHide.call(u,B)}u.cache.toggle=0;if(typeof u.options.hide.effect.type=="function"){u.options.hide.effect.type.call(u.elements.tooltip,u.options.hide.effect.length);u.elements.tooltip.queue(function(){z();g(this).dequeue()})}else{switch(u.options.hide.effect.type.toLowerCase()){case"fade":u.elements.tooltip.fadeOut(u.options.hide.effect.length,z);break;case"slide":u.elements.tooltip.slideUp(u.options.hide.effect.length,z);break;case"grow":u.elements.tooltip.hide(u.options.hide.effect.length,z);break;default:u.elements.tooltip.hide(null,z);break}u.elements.tooltip.removeClass(u.options.style.classes.active)}return g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.EVENT_HIDDEN,"hide")},updatePosition:function(z,A){var F,J,O,M,K,H,B,L,E,G,N,D,I,C;if(!u.status.rendered){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.TOOLTIP_NOT_RENDERED,"updatePosition")}else{if(u.options.position.type=="static"){return g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.CANNOT_POSITION_STATIC,"updatePosition")}}J={position:{left:0,top:0},dimensions:{height:0,width:0},corner:u.options.position.corner.target};O={position:u.getPosition(),dimensions:u.getDimensions(),corner:u.options.position.corner.tooltip};if(u.options.position.target!=="mouse"){if(u.options.position.target.get(0).nodeName.toLowerCase()=="area"){M=u.options.position.target.attr("coords").split(",");for(F=0;F<M.length;F++){M[F]=parseInt(M[F])}K=u.options.position.target.parent("map").attr("name");H=g('img[usemap="#'+K+'"]:first').offset();J.position={left:Math.floor(H.left+M[0]),top:Math.floor(H.top+M[1])};switch(u.options.position.target.attr("shape").toLowerCase()){case"rect":J.dimensions={width:Math.ceil(Math.abs(M[2]-M[0])),height:Math.ceil(Math.abs(M[3]-M[1]))};break;case"circle":J.dimensions={width:M[2]+1,height:M[2]+1};break;case"poly":J.dimensions={width:M[0],height:M[1]};for(F=0;F<M.length;F++){if(F%2==0){if(M[F]>J.dimensions.width){J.dimensions.width=M[F]}if(M[F]<M[0]){J.position.left=Math.floor(H.left+M[F])}}else{if(M[F]>J.dimensions.height){J.dimensions.height=M[F]}if(M[F]<M[1]){J.position.top=Math.floor(H.top+M[F])}}}J.dimensions.width=J.dimensions.width-(J.position.left-H.left);J.dimensions.height=J.dimensions.height-(J.position.top-H.top);break;default:return g.fn.qtip.log.error.call(u,4,g.fn.qtip.constants.INVALID_AREA_SHAPE,"updatePosition");break}J.dimensions.width-=2;J.dimensions.height-=2}else{if(u.options.position.target.add(document.body).length===1){J.position={left:g(document).scrollLeft(),top:g(document).scrollTop()};J.dimensions={height:g(window).height(),width:g(window).width()}}else{if(typeof u.options.position.target.attr("qtip")!=="undefined"){J.position=u.options.position.target.qtip("api").cache.position}else{J.position=u.options.position.target.offset()}J.dimensions={height:u.options.position.target.outerHeight(),width:u.options.position.target.outerWidth()}}}B=g.extend({},J.position);if(J.corner.search(/right/i)!==-1){B.left+=J.dimensions.width}if(J.corner.search(/bottom/i)!==-1){B.top+=J.dimensions.height}if(J.corner.search(/((top|bottom)Middle)|center/)!==-1){B.left+=(J.dimensions.width/2)}if(J.corner.search(/((left|right)Middle)|center/)!==-1){B.top+=(J.dimensions.height/2)}}else{J.position=B={left:u.cache.mouse.x,top:u.cache.mouse.y};J.dimensions={height:1,width:1}}if(O.corner.search(/right/i)!==-1){B.left-=O.dimensions.width}if(O.corner.search(/bottom/i)!==-1){B.top-=O.dimensions.height}if(O.corner.search(/((top|bottom)Middle)|center/)!==-1){B.left-=(O.dimensions.width/2)}if(O.corner.search(/((left|right)Middle)|center/)!==-1){B.top-=(O.dimensions.height/2)}L=(g.browser.msie)?1:0;E=(g.browser.msie&&parseInt(g.browser.version.charAt(0))===6)?1:0;if(u.options.style.border.radius>0){if(O.corner.search(/Left/)!==-1){B.left-=u.options.style.border.radius}else{if(O.corner.search(/Right/)!==-1){B.left+=u.options.style.border.radius}}if(O.corner.search(/Top/)!==-1){B.top-=u.options.style.border.radius}else{if(O.corner.search(/Bottom/)!==-1){B.top+=u.options.style.border.radius}}}if(L){if(O.corner.search(/top/)!==-1){B.top-=L}else{if(O.corner.search(/bottom/)!==-1){B.top+=L}}if(O.corner.search(/left/)!==-1){B.left-=L}else{if(O.corner.search(/right/)!==-1){B.left+=L}}if(O.corner.search(/leftMiddle|rightMiddle/)!==-1){B.top-=1}}if(u.options.position.adjust.screen===true){B=q.call(u,B,J,O)}if(u.options.position.target==="mouse"&&u.options.position.adjust.mouse===true){if(u.options.position.adjust.screen===true&&u.elements.tip){N=u.elements.tip.attr("rel")}else{N=u.options.position.corner.tooltip}B.left+=(N.search(/right/i)!==-1)?-6:6;B.top+=(N.search(/bottom/i)!==-1)?-6:6}if(!u.elements.bgiframe&&g.browser.msie&&parseInt(g.browser.version.charAt(0))==6){g("select, object").each(function(){D=g(this).offset();D.bottom=D.top+g(this).height();D.right=D.left+g(this).width();if(B.top+O.dimensions.height>=D.top&&B.left+O.dimensions.width>=D.left){l.call(u)}})}B.left+=u.options.position.adjust.x;B.top+=u.options.position.adjust.y;I=u.getPosition();if(B.left!=I.left||B.top!=I.top){C=u.beforePositionUpdate.call(u,z);if(C===false){return u}u.cache.position=B;if(A===true){u.status.animated=true;u.elements.tooltip.animate(B,200,"swing",function(){u.status.animated=false})}else{u.elements.tooltip.css(B)}u.onPositionUpdate.call(u,z);if(typeof z!=="undefined"&&z.type&&z.type!=="mousemove"){g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.EVENT_POSITION_UPDATED,"updatePosition")}}return u},updateWidth:function(z){var A;if(!u.status.rendered){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.TOOLTIP_NOT_RENDERED,"updateWidth")}else{if(z&&typeof z!=="number"){return g.fn.qtip.log.error.call(u,2,"newWidth must be of type number","updateWidth")}}A=u.elements.contentWrapper.siblings().add(u.elements.tip).add(u.elements.button);if(!z){if(typeof u.options.style.width.value=="number"){z=u.options.style.width.value}else{u.elements.tooltip.css({width:"auto"});A.hide();if(g.browser.msie){u.elements.wrapper.add(u.elements.contentWrapper.children()).css({zoom:"normal"})}z=u.getDimensions().width+1;if(!u.options.style.width.value){if(z>u.options.style.width.max){z=u.options.style.width.max}if(z<u.options.style.width.min){z=u.options.style.width.min}}}}if(z%2!==0){z-=1}u.elements.tooltip.width(z);A.show();if(u.options.style.border.radius){u.elements.tooltip.find(".qtip-betweenCorners").each(function(B){g(this).width(z-(u.options.style.border.radius*2))})}if(g.browser.msie){u.elements.wrapper.add(u.elements.contentWrapper.children()).css({zoom:"1"});u.elements.wrapper.width(z);if(u.elements.bgiframe){u.elements.bgiframe.width(z).height(u.getDimensions.height)}}return g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.EVENT_WIDTH_UPDATED,"updateWidth")},updateStyle:function(z){var C,D,A,B,E;if(!u.status.rendered){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.TOOLTIP_NOT_RENDERED,"updateStyle")}else{if(typeof z!=="string"||!g.fn.qtip.styles[z]){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.STYLE_NOT_DEFINED,"updateStyle")}}u.options.style=a.call(u,g.fn.qtip.styles[z],u.options.user.style);u.elements.content.css(s(u.options.style));if(u.options.content.title.text!==false){u.elements.title.css(s(u.options.style.title,true))}u.elements.contentWrapper.css({borderColor:u.options.style.border.color});if(u.options.style.tip.corner!==false){if(g("<canvas>").get(0).getContext){C=u.elements.tooltip.find(".qtip-tip canvas:first");A=C.get(0).getContext("2d");A.clearRect(0,0,300,300);B=C.parent("div[rel]:first").attr("rel");E=b(B,u.options.style.tip.size.width,u.options.style.tip.size.height);j.call(u,C,E,u.options.style.tip.color||u.options.style.border.color)}else{if(g.browser.msie){C=u.elements.tooltip.find('.qtip-tip [nodeName="shape"]');C.attr("fillcolor",u.options.style.tip.color||u.options.style.border.color)}}}if(u.options.style.border.radius>0){u.elements.tooltip.find(".qtip-betweenCorners").css({backgroundColor:u.options.style.border.color});if(g("<canvas>").get(0).getContext){D=h(u.options.style.border.radius);u.elements.tooltip.find(".qtip-wrapper canvas").each(function(){A=g(this).get(0).getContext("2d");A.clearRect(0,0,300,300);B=g(this).parent("div[rel]:first").attr("rel");t.call(u,g(this),D[B],u.options.style.border.radius,u.options.style.border.color)})}else{if(g.browser.msie){u.elements.tooltip.find('.qtip-wrapper [nodeName="arc"]').each(function(){g(this).attr("fillcolor",u.options.style.border.color)})}}}return g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.EVENT_STYLE_UPDATED,"updateStyle")},updateContent:function(D,B){var C,A,z;if(!u.status.rendered){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.TOOLTIP_NOT_RENDERED,"updateContent")}else{if(!D){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.NO_CONTENT_PROVIDED,"updateContent")}}C=u.beforeContentUpdate.call(u,D);if(typeof C=="string"){D=C}else{if(C===false){return}}if(g.browser.msie){u.elements.contentWrapper.children().css({zoom:"normal"})}if(D.jquery&&D.length>0){D.clone(true).appendTo(u.elements.content).show()}else{u.elements.content.html(D)}A=u.elements.content.find("img[complete=false]");if(A.length>0){z=0;A.each(function(F){g('<img src="'+g(this).attr("src")+'" />').load(function(){if(++z==A.length){E()}})})}else{E()}function E(){u.updateWidth();if(B!==false){if(u.options.position.type!=="static"){u.updatePosition(u.elements.tooltip.is(":visible"),true)}if(u.options.style.tip.corner!==false){p.call(u)}}}u.onContentUpdate.call(u);return g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.EVENT_CONTENT_UPDATED,"loadContent")},loadContent:function(z,C,D){var B;if(!u.status.rendered){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.TOOLTIP_NOT_RENDERED,"loadContent")}B=u.beforeContentLoad.call(u);if(B===false){return u}if(D=="post"){g.post(z,C,A)}else{g.get(z,C,A)}function A(E){u.onContentLoad.call(u);g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.EVENT_CONTENT_LOADED,"loadContent");u.updateContent(E)}return u},updateTitle:function(z){if(!u.status.rendered){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.TOOLTIP_NOT_RENDERED,"updateTitle")}else{if(!z){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.NO_CONTENT_PROVIDED,"updateTitle")}}returned=u.beforeTitleUpdate.call(u);if(returned===false){return u}if(u.elements.button){u.elements.button=u.elements.button.clone(true)}u.elements.title.html(z);if(u.elements.button){u.elements.title.prepend(u.elements.button)}u.onTitleUpdate.call(u);return g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.EVENT_TITLE_UPDATED,"updateTitle")},focus:function(D){var B,A,z,C;if(!u.status.rendered){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.TOOLTIP_NOT_RENDERED,"focus")}else{if(u.options.position.type=="static"){return g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.CANNOT_FOCUS_STATIC,"focus")}}B=parseInt(u.elements.tooltip.css("z-index"));A=6000+g("div.qtip[qtip]").length-1;if(!u.status.focused&&B!==A){C=u.beforeFocus.call(u,D);if(C===false){return u}g("div.qtip[qtip]").not(u.elements.tooltip).each(function(){if(g(this).qtip("api").status.rendered===true){z=parseInt(g(this).css("z-index"));if(typeof z=="number"&&z>-1){g(this).css({zIndex:parseInt(g(this).css("z-index"))-1})}g(this).qtip("api").status.focused=false}});u.elements.tooltip.css({zIndex:A});u.status.focused=true;u.onFocus.call(u,D);g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.EVENT_FOCUSED,"focus")}return u},disable:function(z){if(!u.status.rendered){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.TOOLTIP_NOT_RENDERED,"disable")}if(z){if(!u.status.disabled){u.status.disabled=true;g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.EVENT_DISABLED,"disable")}else{g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.TOOLTIP_ALREADY_DISABLED,"disable")}}else{if(u.status.disabled){u.status.disabled=false;g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.EVENT_ENABLED,"disable")}else{g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.TOOLTIP_ALREADY_ENABLED,"disable")}}return u},destroy:function(){var z,A,B;A=u.beforeDestroy.call(u);if(A===false){return u}if(u.status.rendered){u.options.show.when.target.unbind("mousemove.qtip",u.updatePosition);u.options.show.when.target.unbind("mouseout.qtip",u.hide);u.options.show.when.target.unbind(u.options.show.when.event+".qtip");u.options.hide.when.target.unbind(u.options.hide.when.event+".qtip");u.elements.tooltip.unbind(u.options.hide.when.event+".qtip");u.elements.tooltip.unbind("mouseover.qtip",u.focus);u.elements.tooltip.remove()}else{u.options.show.when.target.unbind(u.options.show.when.event+".qtip-create")}if(typeof u.elements.target.data("qtip")=="object"){B=u.elements.target.data("qtip").interfaces;if(typeof B=="object"&&B.length>0){for(z=0;z<B.length-1;z++){if(B[z].id==u.id){B.splice(z,1)}}}}delete g.fn.qtip.interfaces[u.id];if(typeof B=="object"&&B.length>0){u.elements.target.data("qtip").current=B.length-1}else{u.elements.target.removeData("qtip")}u.onDestroy.call(u);g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.EVENT_DESTROYED,"destroy");return u.elements.target},getPosition:function(){var z,A;if(!u.status.rendered){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.TOOLTIP_NOT_RENDERED,"getPosition")}z=(u.elements.tooltip.css("display")!=="none")?false:true;if(z){u.elements.tooltip.css({visiblity:"hidden"}).show()}A=u.elements.tooltip.offset();if(z){u.elements.tooltip.css({visiblity:"visible"}).hide()}return A},getDimensions:function(){var z,A;if(!u.status.rendered){return g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.TOOLTIP_NOT_RENDERED,"getDimensions")}z=(!u.elements.tooltip.is(":visible"))?true:false;if(z){u.elements.tooltip.css({visiblity:"hidden"}).show()}A={height:u.elements.tooltip.outerHeight(),width:u.elements.tooltip.outerWidth()};if(z){u.elements.tooltip.css({visiblity:"visible"}).hide()}return A}})}function r(){var u,z,w,v,x,B,A;u=this;u.beforeRender.call(u);u.status.rendered=true;u.elements.tooltip='<div qtip="'+u.id+'" class="qtip '+(u.options.style.classes.tooltip||u.options.style)+'"style="display:none; -moz-border-radius:0; -webkit-border-radius:0; border-radius:0;position:'+u.options.position.type+';">  <div class="qtip-wrapper" style="position:relative; overflow:hidden; text-align:left;">    <div class="qtip-contentWrapper" style="overflow:hidden;">       <div class="qtip-content '+u.options.style.classes.content+'"></div></div></div></div>';u.elements.tooltip=g(u.elements.tooltip);u.elements.tooltip.appendTo(u.options.position.container);u.elements.tooltip.data("qtip",{current:0,interfaces:[u]});u.elements.wrapper=u.elements.tooltip.children("div:first");u.elements.contentWrapper=u.elements.wrapper.children("div:first").css({background:u.options.style.background});u.elements.content=u.elements.contentWrapper.children("div:first").css(s(u.options.style));if(g.browser.msie){u.elements.wrapper.add(u.elements.content).css({zoom:1})}if(u.options.hide.when.event=="unfocus"){u.elements.tooltip.attr("unfocus",true)}if(typeof u.options.style.width.value=="number"){u.updateWidth()}if(g("<canvas>").get(0).getContext||g.browser.msie){if(u.options.style.border.radius>0){o.call(u)}else{u.elements.contentWrapper.css({border:u.options.style.border.width+"px solid "+u.options.style.border.color})}if(u.options.style.tip.corner!==false){f.call(u)}}else{u.elements.contentWrapper.css({border:u.options.style.border.width+"px solid "+u.options.style.border.color});u.options.style.border.radius=0;u.options.style.tip.corner=false;g.fn.qtip.log.error.call(u,2,g.fn.qtip.constants.CANVAS_VML_NOT_SUPPORTED,"render")}if((typeof u.options.content.text=="string"&&u.options.content.text.length>0)||(u.options.content.text.jquery&&u.options.content.text.length>0)){w=u.options.content.text}else{if(typeof u.elements.target.attr("title")=="string"&&u.elements.target.attr("title").length>0){w=u.elements.target.attr("title").replace("\\n","<br />");u.elements.target.attr("title","")}else{if(typeof u.elements.target.attr("alt")=="string"&&u.elements.target.attr("alt").length>0){w=u.elements.target.attr("alt").replace("\\n","<br />");u.elements.target.attr("alt","")}else{w=" ";g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.NO_VALID_CONTENT,"render")}}}if(u.options.content.title.text!==false){k.call(u)}u.updateContent(w);n.call(u);if(u.options.show.ready===true){u.show()}if(u.options.content.url!==false){v=u.options.content.url;x=u.options.content.data;B=u.options.content.method||"get";u.loadContent(v,x,B)}u.onRender.call(u);g.fn.qtip.log.error.call(u,1,g.fn.qtip.constants.EVENT_RENDERED,"render")}function o(){var I,C,v,E,A,H,w,J,G,B,z,F,D,u,x;I=this;I.elements.wrapper.find(".qtip-borderBottom, .qtip-borderTop").remove();v=I.options.style.border.width;E=I.options.style.border.radius;A=I.options.style.border.color||I.options.style.tip.color;H=h(E);w={};for(C in H){w[C]='<div rel="'+C+'" style="'+((C.search(/Left/)!==-1)?"left":"right")+":0; position:absolute; height:"+E+"px; width:"+E+'px; overflow:hidden; line-height:0.1px; font-size:1px">';if(g("<canvas>").get(0).getContext){w[C]+='<canvas height="'+E+'" width="'+E+'" style="vertical-align: top"></canvas>'}else{if(g.browser.msie){J=E*2+3;w[C]+='<v:arc stroked="false" fillcolor="'+A+'" startangle="'+H[C][0]+'" endangle="'+H[C][1]+'" style="width:'+J+"px; height:"+J+"px; margin-top:"+((C.search(/bottom/)!==-1)?-2:-1)+"px; margin-left:"+((C.search(/Right/)!==-1)?H[C][2]-3.5:-1)+'px; vertical-align:top; display:inline-block; behavior:url(#default#VML)"></v:arc>'}}w[C]+="</div>"}G=I.getDimensions().width-(Math.max(v,E)*2);B='<div class="qtip-betweenCorners" style="height:'+E+"px; width:"+G+"px; overflow:hidden; background-color:"+A+'; line-height:0.1px; font-size:1px;">';z='<div class="qtip-borderTop" dir="ltr" style="height:'+E+"px; margin-left:"+E+'px; line-height:0.1px; font-size:1px; padding:0;">'+w.topLeft+w.topRight+B;I.elements.wrapper.prepend(z);F='<div class="qtip-borderBottom" dir="ltr" style="height:'+E+"px; margin-left:"+E+'px; line-height:0.1px; font-size:1px; padding:0;">'+w.bottomLeft+w.bottomRight+B;I.elements.wrapper.append(F);if(g("<canvas>").get(0).getContext){I.elements.wrapper.find("canvas").each(function(){D=H[g(this).parent("[rel]:first").attr("rel")];t.call(I,g(this),D,E,A)})}else{if(g.browser.msie){I.elements.tooltip.append('<v:image style="behavior:url(#default#VML);"></v:image>')}}u=Math.max(E,(E+(v-E)));x=Math.max(v-E,0);I.elements.contentWrapper.css({border:"0px solid "+A,borderWidth:x+"px "+u+"px"})}function t(w,z,u,v){var x=w.get(0).getContext("2d");x.fillStyle=v;x.beginPath();x.arc(z[0],z[1],u,0,Math.PI*2,false);x.fill()}function f(x){var v,u,A,w,z;v=this;if(v.elements.tip!==null){v.elements.tip.remove()}u=v.options.style.tip.color||v.options.style.border.color;if(v.options.style.tip.corner===false){return}else{if(!x){x=v.options.style.tip.corner}}A=b(x,v.options.style.tip.size.width,v.options.style.tip.size.height);v.elements.tip='<div class="'+v.options.style.classes.tip+'" dir="ltr" rel="'+x+'" style="position:absolute; height:'+v.options.style.tip.size.height+"px; width:"+v.options.style.tip.size.width+'px; margin:0 auto; line-height:0.1px; font-size:1px;">';if(g("<canvas>").get(0).getContext){v.elements.tip+='<canvas height="'+v.options.style.tip.size.height+'" width="'+v.options.style.tip.size.width+'"></canvas>'}else{if(g.browser.msie){w=v.options.style.tip.size.width+","+v.options.style.tip.size.height;z="m"+A[0][0]+","+A[0][1];z+=" l"+A[1][0]+","+A[1][1];z+=" "+A[2][0]+","+A[2][1];z+=" xe";v.elements.tip+='<v:shape fillcolor="'+u+'" stroked="false" filled="true" path="'+z+'" coordsize="'+w+'" style="width:'+v.options.style.tip.size.width+"px; height:"+v.options.style.tip.size.height+"px; line-height:0.1px; display:inline-block; behavior:url(#default#VML); vertical-align:"+((x.search(/top/)!==-1)?"bottom":"top")+'"></v:shape>';v.elements.tip+='<v:image style="behavior:url(#default#VML);"></v:image>';v.elements.contentWrapper.css("position","relative")}}v.elements.tooltip.prepend(v.elements.tip+"</div>");v.elements.tip=v.elements.tooltip.find("."+v.options.style.classes.tip).eq(0);if(g("<canvas>").get(0).getContext){j.call(v,v.elements.tip.find("canvas:first"),A,u)}if(x.search(/top/)!==-1&&g.browser.msie&&parseInt(g.browser.version.charAt(0))===6){v.elements.tip.css({marginTop:-4})}p.call(v,x)}function j(v,x,u){var w=v.get(0).getContext("2d");w.fillStyle=u;w.beginPath();w.moveTo(x[0][0],x[0][1]);w.lineTo(x[1][0],x[1][1]);w.lineTo(x[2][0],x[2][1]);w.fill()}function p(w){var v,z,u,A,x;v=this;if(v.options.style.tip.corner===false||!v.elements.tip){return}if(!w){w=v.elements.tip.attr("rel")}z=positionAdjust=(g.browser.msie)?1:0;v.elements.tip.css(w.match(/left|right|top|bottom/)[0],0);if(w.search(/top|bottom/)!==-1){if(g.browser.msie){if(parseInt(g.browser.version.charAt(0))===6){positionAdjust=(w.search(/top/)!==-1)?-3:1}else{positionAdjust=(w.search(/top/)!==-1)?1:2}}if(w.search(/Middle/)!==-1){v.elements.tip.css({left:"50%",marginLeft:-(v.options.style.tip.size.width/2)})}else{if(w.search(/Left/)!==-1){v.elements.tip.css({left:v.options.style.border.radius-z})}else{if(w.search(/Right/)!==-1){v.elements.tip.css({right:v.options.style.border.radius+z})}}}if(w.search(/top/)!==-1){v.elements.tip.css({top:-positionAdjust})}else{v.elements.tip.css({bottom:positionAdjust})}}else{if(w.search(/left|right/)!==-1){if(g.browser.msie){positionAdjust=(parseInt(g.browser.version.charAt(0))===6)?1:((w.search(/left/)!==-1)?1:2)}if(w.search(/Middle/)!==-1){v.elements.tip.css({top:"50%",marginTop:-(v.options.style.tip.size.height/2)})}else{if(w.search(/Top/)!==-1){v.elements.tip.css({top:v.options.style.border.radius-z})}else{if(w.search(/Bottom/)!==-1){v.elements.tip.css({bottom:v.options.style.border.radius+z})}}}if(w.search(/left/)!==-1){v.elements.tip.css({left:-positionAdjust})}else{v.elements.tip.css({right:positionAdjust})}}}u="padding-"+w.match(/left|right|top|bottom/)[0];A=v.options.style.tip.size[(u.search(/left|right/)!==-1)?"width":"height"];v.elements.tooltip.css("padding",0);v.elements.tooltip.css(u,A);if(g.browser.msie&&parseInt(g.browser.version.charAt(0))==6){x=parseInt(v.elements.tip.css("margin-top"))||0;x+=parseInt(v.elements.content.css("margin-top"))||0;v.elements.tip.css({marginTop:x})}}function k(){var u=this;if(u.elements.title!==null){u.elements.title.remove()}u.elements.title=g('<div class="'+u.options.style.classes.title+'">').css(s(u.options.style.title,true)).css({zoom:(g.browser.msie)?1:0}).prependTo(u.elements.contentWrapper);if(u.options.content.title.text){u.updateTitle.call(u,u.options.content.title.text)}if(u.options.content.title.button!==false&&typeof u.options.content.title.button=="string"){u.elements.button=g('<a class="'+u.options.style.classes.button+'" style="float:right; position: relative"></a>').css(s(u.options.style.button,true)).html(u.options.content.title.button).prependTo(u.elements.title).click(function(v){if(!u.status.disabled){u.hide(v)}})}}function n(){var v,x,w,u;v=this;x=v.options.show.when.target;w=v.options.hide.when.target;if(v.options.hide.fixed){w=w.add(v.elements.tooltip)}if(v.options.hide.when.event=="inactive"){u=["click","dblclick","mousedown","mouseup","mousemove","mouseout","mouseenter","mouseleave","mouseover"];function B(C){if(v.status.disabled===true){return}clearTimeout(v.timers.inactive);v.timers.inactive=setTimeout(function(){g(u).each(function(){w.unbind(this+".qtip-inactive");v.elements.content.unbind(this+".qtip-inactive")});v.hide(C)},v.options.hide.delay)}}else{if(v.options.hide.fixed===true){v.elements.tooltip.bind("mouseover.qtip",function(){if(v.status.disabled===true){return}clearTimeout(v.timers.hide)})}}function A(C){if(v.status.disabled===true){return}if(v.options.hide.when.event=="inactive"){g(u).each(function(){w.bind(this+".qtip-inactive",B);v.elements.content.bind(this+".qtip-inactive",B)});B()}clearTimeout(v.timers.show);clearTimeout(v.timers.hide);v.timers.show=setTimeout(function(){v.show(C)},v.options.show.delay)}function z(C){if(v.status.disabled===true){return}if(v.options.hide.fixed===true&&v.options.hide.when.event.search(/mouse(out|leave)/i)!==-1&&g(C.relatedTarget).parents("div.qtip[qtip]").length>0){C.stopPropagation();C.preventDefault();clearTimeout(v.timers.hide);return false}clearTimeout(v.timers.show);clearTimeout(v.timers.hide);v.elements.tooltip.stop(true,true);v.timers.hide=setTimeout(function(){v.hide(C)},v.options.hide.delay)}if((v.options.show.when.target.add(v.options.hide.when.target).length===1&&v.options.show.when.event==v.options.hide.when.event&&v.options.hide.when.event!=="inactive")||v.options.hide.when.event=="unfocus"){v.cache.toggle=0;x.bind(v.options.show.when.event+".qtip",function(C){if(v.cache.toggle==0){A(C)}else{z(C)}})}else{x.bind(v.options.show.when.event+".qtip",A);if(v.options.hide.when.event!=="inactive"){w.bind(v.options.hide.when.event+".qtip",z)}}if(v.options.position.type.search(/(fixed|absolute)/)!==-1){v.elements.tooltip.bind("mouseover.qtip",v.focus)}if(v.options.position.target==="mouse"&&v.options.position.type!=="static"){x.bind("mousemove.qtip",function(C){v.cache.mouse={x:C.pageX,y:C.pageY};if(v.status.disabled===false&&v.options.position.adjust.mouse===true&&v.options.position.type!=="static"&&v.elements.tooltip.css("display")!=="none"){v.updatePosition(C)}})}}function q(w,x,D){var C,u,A,B,v,z;C=this;if(D.corner=="center"){return x.position}u=g.extend({},w);B={x:false,y:false};v={left:(u.left<g.fn.qtip.cache.screen.scroll.left),right:(u.left+D.dimensions.width+2>=g.fn.qtip.cache.screen.width+g.fn.qtip.cache.screen.scroll.left),top:(u.top<g.fn.qtip.cache.screen.scroll.top),bottom:(u.top+D.dimensions.height+2>=g.fn.qtip.cache.screen.height+g.fn.qtip.cache.screen.scroll.top)};A={left:(v.left&&(D.corner.search(/right/i)!=-1||(D.corner.search(/right/i)==-1&&!v.right))),right:(v.right&&(D.corner.search(/left/i)!=-1||(D.corner.search(/left/i)==-1&&!v.left))),top:(v.top&&D.corner.search(/top/i)==-1),bottom:(v.bottom&&D.corner.search(/bottom/i)==-1)};if(A.left){if(C.options.position.target!=="mouse"){u.left=x.position.left+x.dimensions.width}else{u.left=C.cache.mouse.x}B.x="Left"}else{if(A.right){if(C.options.position.target!=="mouse"){u.left=x.position.left-D.dimensions.width}else{u.left=C.cache.mouse.x-D.dimensions.width}B.x="Right"}}if(A.top){if(C.options.position.target!=="mouse"){u.top=x.position.top+x.dimensions.height}else{u.top=C.cache.mouse.y}B.y="top"}else{if(A.bottom){if(C.options.position.target!=="mouse"){u.top=x.position.top-D.dimensions.height}else{u.top=C.cache.mouse.y-D.dimensions.height}B.y="bottom"}}if(u.left<0){u.left=w.left;B.x=false}if(u.top<0){u.top=w.top;B.y=false}if(C.options.style.tip.corner!==false){u.corner=new String(D.corner);if(B.x!==false){u.corner=u.corner.replace(/Left|Right|Middle/,B.x)}if(B.y!==false){u.corner=u.corner.replace(/top|bottom/,B.y)}if(u.corner!==C.elements.tip.attr("rel")){f.call(C,u.corner)}}return u}function s(w,v){var x,u;x=g.extend(true,{},w);for(u in x){if(v===true&&u.search(/(tip|classes)/i)!==-1){delete x[u]}else{if(!v&&u.search(/(width|border|tip|title|classes|user)/i)!==-1){delete x[u]}}}return x}function c(u){if(typeof u.tip!=="object"){u.tip={corner:u.tip}}if(typeof u.tip.size!=="object"){u.tip.size={width:u.tip.size,height:u.tip.size}}if(typeof u.border!=="object"){u.border={width:u.border}}if(typeof u.width!=="object"){u.width={value:u.width}}if(typeof u.width.max=="string"){u.width.max=parseInt(u.width.max.replace(/([0-9]+)/i,"$1"))}if(typeof u.width.min=="string"){u.width.min=parseInt(u.width.min.replace(/([0-9]+)/i,"$1"))}if(typeof u.tip.size.x=="number"){u.tip.size.width=u.tip.size.x;delete u.tip.size.x}if(typeof u.tip.size.y=="number"){u.tip.size.height=u.tip.size.y;delete u.tip.size.y}return u}function a(){var u,v,w,A,x,z;u=this;w=[true,{}];for(v=0;v<arguments.length;v++){w.push(arguments[v])}A=[g.extend.apply(g,w)];while(typeof A[0].name=="string"){A.unshift(c(g.fn.qtip.styles[A[0].name]))}A.unshift(true,{classes:{tooltip:"qtip-"+(arguments[0].name||"defaults")}},g.fn.qtip.styles.defaults);x=g.extend.apply(g,A);z=(g.browser.msie)?1:0;x.tip.size.width+=z;x.tip.size.height+=z;if(x.tip.size.width%2>0){x.tip.size.width+=1}if(x.tip.size.height%2>0){x.tip.size.height+=1}if(x.tip.corner===true){x.tip.corner=(u.options.position.corner.tooltip==="center")?false:u.options.position.corner.tooltip}return x}function b(x,w,v){var u={bottomRight:[[0,0],[w,v],[w,0]],bottomLeft:[[0,0],[w,0],[0,v]],topRight:[[0,v],[w,0],[w,v]],topLeft:[[0,0],[0,v],[w,v]],topMiddle:[[0,v],[w/2,0],[w,v]],bottomMiddle:[[0,0],[w,0],[w/2,v]],rightMiddle:[[0,0],[w,v/2],[0,v]],leftMiddle:[[w,0],[w,v],[0,v/2]]};u.leftTop=u.bottomRight;u.rightTop=u.bottomLeft;u.leftBottom=u.topRight;u.rightBottom=u.topLeft;return u[x]}function h(u){var v;if(g("<canvas>").get(0).getContext){v={topLeft:[u,u],topRight:[0,u],bottomLeft:[u,0],bottomRight:[0,0]}}else{if(g.browser.msie){v={topLeft:[-90,90,0],topRight:[-90,90,-u],bottomLeft:[90,270,0],bottomRight:[90,270,-u]}}}return v}function l(){var u,v,w;u=this;w=u.getDimensions();v='<iframe class="qtip-bgiframe" frameborder="0" tabindex="-1" src="javascript:false" style="display:block; position:absolute; z-index:-1; filter:alpha(opacity=\'0\'); border: 1px solid red; height:'+w.height+"px; width:"+w.width+'px" />';u.elements.bgiframe=u.elements.wrapper.prepend(v).children(".qtip-bgiframe:first")}g(document).ready(function(){g.fn.qtip.cache={screen:{scroll:{left:g(window).scrollLeft(),top:g(window).scrollTop()},width:g(window).width(),height:g(window).height()}};var u;g(window).bind("resize scroll",function(v){clearTimeout(u);u=setTimeout(function(){if(v.type==="scroll"){g.fn.qtip.cache.screen.scroll={left:g(window).scrollLeft(),top:g(window).scrollTop()}}else{g.fn.qtip.cache.screen.width=g(window).width();g.fn.qtip.cache.screen.height=g(window).height()}for(i=0;i<g.fn.qtip.interfaces.length;i++){var w=g.fn.qtip.interfaces[i];if(w.status.rendered===true&&(w.options.position.type!=="static"||w.options.position.adjust.scroll&&v.type==="scroll"||w.options.position.adjust.resize&&v.type==="resize")){w.updatePosition(v,true)}}},100)});g(document).bind("mousedown.qtip",function(v){if(g(v.target).parents("div.qtip").length===0){g(".qtip[unfocus]").each(function(){var w=g(this).qtip("api");if(g(this).is(":visible")&&!w.status.disabled&&g(v.target).add(w.elements.target).length>1){w.hide(v)}})}})});g.fn.qtip.interfaces=[];g.fn.qtip.log={error:function(){return this}};g.fn.qtip.constants={};g.fn.qtip.defaults={content:{prerender:false,text:false,url:false,data:null,title:{text:false,button:false}},position:{target:false,corner:{target:"bottomRight",tooltip:"topLeft"},adjust:{x:0,y:0,mouse:true,screen:false,scroll:true,resize:true},type:"absolute",container:false},show:{when:{target:false,event:"mouseover"},effect:{type:"fade",length:100},delay:140,solo:false,ready:false},hide:{when:{target:false,event:"mouseout"},effect:{type:"fade",length:100},delay:0,fixed:false},api:{beforeRender:function(){},onRender:function(){},beforePositionUpdate:function(){},onPositionUpdate:function(){},beforeShow:function(){},onShow:function(){},beforeHide:function(){},onHide:function(){},beforeContentUpdate:function(){},onContentUpdate:function(){},beforeContentLoad:function(){},onContentLoad:function(){},beforeTitleUpdate:function(){},onTitleUpdate:function(){},beforeDestroy:function(){},onDestroy:function(){},beforeFocus:function(){},onFocus:function(){}}};g.fn.qtip.styles={defaults:{background:"white",color:"#111",overflow:"hidden",textAlign:"left",width:{min:0,max:250},padding:"5px 9px",border:{width:1,radius:0,color:"#d3d3d3"},tip:{corner:false,color:false,size:{width:13,height:13},opacity:1},title:{background:"#e1e1e1",fontWeight:"bold",padding:"7px 12px"},button:{cursor:"pointer"},classes:{target:"",tip:"qtip-tip",title:"qtip-title",button:"qtip-button",content:"qtip-content",active:"qtip-active"}},cream:{border:{width:3,radius:0,color:"#F9E98E"},title:{background:"#F0DE7D",color:"#A27D35"},background:"#FBF7AA",color:"#A27D35",classes:{tooltip:"qtip-cream"}},light:{border:{width:3,radius:0,color:"#E2E2E2"},title:{background:"#f1f1f1",color:"#454545"},background:"white",color:"#454545",classes:{tooltip:"qtip-light"}},dark:{border:{width:3,radius:0,color:"#303030"},title:{background:"#404040",color:"#f3f3f3"},background:"#505050",color:"#f3f3f3",classes:{tooltip:"qtip-dark"}},red:{border:{width:3,radius:0,color:"#CE6F6F"},title:{background:"#f28279",color:"#9C2F2F"},background:"#F79992",color:"#9C2F2F",classes:{tooltip:"qtip-red"}},green:{border:{width:3,radius:0,color:"#A9DB66"},title:{background:"#b9db8c",color:"#58792E"},background:"#CDE6AC",color:"#58792E",classes:{tooltip:"qtip-green"}},blue:{border:{width:3,radius:0,color:"#ADD9ED"},title:{background:"#D0E9F5",color:"#5E99BD"},background:"#E5F6FE",color:"#4D9FBF",classes:{tooltip:"qtip-blue"}}}})(jQuery);(function(a){a.fn.jshowoff=function(c){var b={animatePause:true,autoPlay:true,changeSpeed:600,controls:true,controlText:{play:"Play",pause:"Pause",next:"Next",previous:"Previous"},effect:"fade",hoverPause:true,links:true,speed:3000};if(c){a.extend(true,b,c)}if(b.speed<(b.changeSpeed+20)){alert("jShowOff: Make speed at least 20ms longer than changeSpeed; the fades aren't always right on time.");return this}this.each(function(v){var n=a(this);var e=a(this).children().remove();var r="";var q=0;var u=[];var k=a(".jshowoff").length+1;var o="jshowoff-"+k;var p=b.cssClass!=undefined?b.cssClass:"";n.css("position","relative").wrap('<div class="jshowoff '+o+'" />');var s=a("."+o);s.css("position","relative").addClass(p);a(e[0]).clone().appendTo(n);l();if(b.controls){x();if(b.autoPlay==false){a("."+o+"-play").addClass(o+"-paused jshowoff-paused").text(b.controlText.play)}}if(b.links){w();a("."+o+"-slidelinks a").eq(0).addClass(o+"-active jshowoff-active")}if(b.hoverPause){n.hover(function(){if(h()){j("hover")}},function(){if(h()){A("hover")}})}if(b.autoPlay&&e.length>1){r=setInterval(function(){A()},b.speed)}if(e.length<1){a("."+o).append("<p>For jShowOff to work, the container element must have child elements.</p>")}function f(D,F){var C=q;if((q>=D.length)||(F>=D.length)){q=0;var H=true}else{if((q<0)||(F<0)){q=D.length-1;var E=true}else{q=F}}if(b.effect=="slideLeft"){var I,J;function G(K){I=K=="right"?"left":"right";J=K=="left"?"left":"right"}q>=C?G("left"):G("right");a(D[q]).clone().appendTo(n).slideIt({direction:I,changeSpeed:b.changeSpeed});if(n.children().length>1){n.children().eq(0).css("position","absolute").slideIt({direction:J,showHide:"hide",changeSpeed:b.changeSpeed},function(){a(this).remove()})}}else{if(b.effect=="fade"){a(D[q]).clone().appendTo(n).hide().fadeIn(b.changeSpeed,function(){if(a.browser.msie){this.style.removeAttribute("filter")}});if(n.children().length>1){n.children().eq(0).css("position","absolute").fadeOut(b.changeSpeed,function(){a(this).remove()})}}else{if(b.effect=="none"){a(D[q]).clone().appendTo(n);if(n.children().length>1){n.children().eq(0).css("position","absolute").remove()}}}}if(b.links){a("."+o+"-active").removeClass(o+"-active jshowoff-active");a("."+o+"-slidelinks a").eq(q).addClass(o+"-active jshowoff-active")}}function h(){return a("."+o+"-play").hasClass("jshowoff-paused")?false:true}function A(C){if(!B()){q++;f(e,q);if(C=="hover"||!h()){r=setInterval(function(){A()},b.speed)}if(!h()){a("."+o+"-play").text(b.controlText.pause).removeClass("jshowoff-paused "+o+"-paused")}}}function j(C){clearInterval(r);if(!C||C=="playBtn"){a("."+o+"-play").text(b.controlText.play).addClass("jshowoff-paused "+o+"-paused")}if(b.animatePause&&C=="playBtn"){a('<p class="'+o+'-pausetext jshowoff-pausetext">'+b.controlText.pause+"</p>").css({fontSize:"62%",textAlign:"center",position:"absolute",top:"40%",lineHeight:"100%",width:"100%"}).appendTo(s).addClass(o+"pauseText").animate({fontSize:"600%",top:"30%",opacity:0},{duration:500,complete:function(){a(this).remove()}})}}function t(){z(q+1)}function g(){z(q-1)}function B(){return n.children().length>1?true:false}function z(C){n.children().stop(true,true);if((q!=C)||((q==C)&&B())){if(B()){n.children().eq(0).remove()}f(e,C);j()}}function l(){a(e).each(function(C){a(this).find("img").each(function(D){u[D]=a("<img>").attr("src",a(this).attr("src"))})})}function x(){s.append('<p class="jshowoff-controls '+o+'-controls"><a class="jshowoff-play '+o+'-play" href="#null">'+b.controlText.pause+'</a> <a class="jshowoff-prev '+o+'-prev" href="#null">'+b.controlText.previous+'</a> <a class="jshowoff-next '+o+'-next" href="#null">'+b.controlText.next+"</a></p>");a("."+o+"-controls a").each(function(){if(a(this).hasClass("jshowoff-play")){a(this).click(function(){h()?j("playBtn"):A();return false})}if(a(this).hasClass("jshowoff-prev")){a(this).click(function(){g();return false})}if(a(this).hasClass("jshowoff-next")){a(this).click(function(){t();return false})}})}function w(){s.append('<p class="jshowoff-slidelinks '+o+'-slidelinks"></p>');a.each(e,function(C,E){var D=a(this).attr("title")!=""?a(this).attr("title"):C+1;a('<a class="jshowoff-slidelink-'+C+" "+o+"-slidelink-"+C+'" href="#null">'+D+"</a>").bind("click",{index:C},function(F){z(F.data.index);return false}).appendTo("."+o+"-slidelinks")})}});return this}})(jQuery);(function(a){a.fn.slideIt=function(c,e){var b={direction:"left",showHide:"show",changeSpeed:600};if(c){a.extend(b,c)}this.each(function(g){a(this).css({left:"auto",right:"auto",top:"auto",bottom:"auto"});var h=(b.direction=="left")||(b.direction=="right")?a(this).outerWidth():a(this).outerHeight();var f={};f.position=a(this).css("position")=="static"?"relative":a(this).css("position");f[b.direction]=(b.showHide=="show")?"-"+h+"px":0;var j={};j[b.direction]=b.showHide=="show"?0:"-"+h+"px";a(this).css(f).animate(j,b.changeSpeed,e)});return this}})(jQuery);(function(c){function b(){this._disabledInputs=[];this.regional=[];this.regional[""]={show24Hours:false,separator:":",ampmPrefix:"",ampmNames:["AM","PM"],spinnerTexts:["Now","Previous field","Next field","Increment","Decrement"]};this._defaults={appendText:"",showSeconds:false,timeSteps:[1,1,1],initialField:0,useMouseWheel:true,defaultTime:null,minTime:null,maxTime:null,spinnerImage:"http://images.dailykos.com/i/admin/spinnerDefault.png",spinnerSize:[20,20,8],spinnerBigImage:"",spinnerBigSize:[40,40,16],spinnerIncDecOnly:false,spinnerRepeat:[500,250],beforeShow:null,beforeSetTime:null};c.extend(this._defaults,this.regional[""])}var e="timeEntry";c.extend(b.prototype,{markerClassName:"hasTimeEntry",setDefaults:function(f){a(this._defaults,f||{});return this},_connectTimeEntry:function(j,p){var n=c(j);if(n.hasClass(this.markerClassName)){return}var h={};h.options=c.extend({},p);h._selectedHour=0;h._selectedMinute=0;h._selectedSecond=0;h._field=0;h.input=c(j);c.data(j,e,h);var f=this._get(h,"spinnerImage");var k=this._get(h,"spinnerText");var l=this._get(h,"spinnerSize");var g=this._get(h,"appendText");var o=(!f?null:c('<span class="timeEntry_control" style="display: inline-block; background: url(\''+f+"') 0 0 no-repeat; width: "+l[0]+"px; height: "+l[1]+"px;"+(c.browser.mozilla&&c.browser.version<"1.9"?" padding-left: "+l[0]+"px; padding-bottom: "+(l[1]-18)+"px;":"")+'"></span>'));n.wrap('<span class="timeEntry_wrap"></span>').after(g?'<span class="timeEntry_append">'+g+"</span>":"").after(o||"");n.addClass(this.markerClassName).bind("focus.timeEntry",this._doFocus).bind("blur.timeEntry",this._doBlur).bind("click.timeEntry",this._doClick).bind("keydown.timeEntry",this._doKeyDown).bind("keypress.timeEntry",this._doKeyPress);if(c.browser.mozilla){n.bind("input.timeEntry",function(q){c.timeentry._parseTime(h)})}if(c.browser.msie){n.bind("paste.timeEntry",function(q){setTimeout(function(){c.timeentry._parseTime(h)},1)})}if(this._get(h,"useMouseWheel")&&c.fn.mousewheel){n.mousewheel(this._doMouseWheel)}if(o){o.mousedown(this._handleSpinner).mouseup(this._endSpinner).mouseover(this._expandSpinner).mouseout(this._endSpinner).mousemove(this._describeSpinner)}},_enableTimeEntry:function(f){this._enableDisable(f,false)},_disableTimeEntry:function(f){this._enableDisable(f,true)},_enableDisable:function(f,g){var h=c.data(f,e);if(!h){return}f.disabled=g;if(f.nextSibling&&f.nextSibling.nodeName.toLowerCase()=="span"){c.timeEntry._changeSpinner(h,f.nextSibling,(g?5:-1))}c.timeEntry._disabledInputs=c.map(c.timeEntry._disabledInputs,function(j){return(j==f?null:j)});if(g){c.timeEntry._disabledInputs.push(f)}},_isDisabledTimeEntry:function(f){return c.inArray(f,this._disabledInputs)>-1},_changeTimeEntry:function(f,g){var j=c.data(f,e);if(j){var h=this._extractTime(j);a(j.options,g||{});if(h){this._setTime(j,new Date(0,0,0,h[0],h[1],h[2]))}}c.data(f,e,j)},_destroyTimeEntry:function(f){$input=c(f);if(!$input.hasClass(this.markerClassName)){return}$input.removeClass(this.markerClassName).unbind(".timeEntry");if(c.fn.mousewheel){$input.unmousewheel()}this._disabledInputs=c.map(this._disabledInputs,function(g){return(g==f?null:g)});$input.parent().replaceWith($input);c.removeData(f,e)},_setTimeTimeEntry:function(f,h){var g=c.data(f,e);if(g){this._setTime(g,h?(typeof h=="object"?new Date(h.getTime()):h):null)}},_getTimeTimeEntry:function(f){var h=c.data(f,e);var g=(h?this._extractTime(h):null);return(!g?null:new Date(0,0,0,g[0],g[1],g[2]))},_doFocus:function(h){var f=(h.nodeName&&h.nodeName.toLowerCase()=="input"?h:this);if(c.timeEntry._lastInput==f||c.timeEntry._isDisabledTimeEntry(f)){c.timeEntry._focussed=false;return}var g=c.data(f,e);c.timeEntry._focussed=true;c.timeEntry._lastInput=f;c.timeEntry._blurredInput=null;var j=c.timeEntry._get(g,"beforeShow");a(g.options,(j?j.apply(f,[f]):{}));c.data(f,e,g);c.timeEntry._parseTime(g);setTimeout(function(){c.timeEntry._showField(g)},10)},_doBlur:function(f){c.timeEntry._blurredInput=c.timeEntry._lastInput;c.timeEntry._lastInput=null},_doClick:function(g){var p=g.target;var k=c.data(p,e);if(!c.timeEntry._focussed){var q=c.timeEntry._get(k,"separator").length+2;k._field=0;if(p.selectionStart!=null){for(var o=0;o<=Math.max(1,k._secondField,k._ampmField);o++){var h=(o!=k._ampmField?(o*q)+2:(k._ampmField*q)+c.timeEntry._get(k,"ampmPrefix").length+c.timeEntry._get(k,"ampmNames")[0].length);k._field=o;if(p.selectionStart<h){break}}}else{if(p.createTextRange){var f=c(g.srcElement);var l=p.createTextRange();var n=function(r){return{thin:2,medium:4,thick:6}[r]||r};var j=g.clientX+document.documentElement.scrollLeft-(f.offset().left+parseInt(n(f.css("border-left-width")),10))-l.offsetLeft;for(var o=0;o<=Math.max(1,k._secondField,k._ampmField);o++){var h=(o!=k._ampmField?(o*q)+2:(k._ampmField*q)+c.timeEntry._get(k,"ampmPrefix").length+c.timeEntry._get(k,"ampmNames")[0].length);l.collapse();l.moveEnd("character",h);k._field=o;if(j<l.boundingWidth){break}}}}}c.data(p,e,k);c.timeEntry._showField(k);c.timeEntry._focussed=false},_doKeyDown:function(f){if(f.keyCode>=48){return true}var g=c.data(f.target,e);switch(f.keyCode){case 9:return(f.shiftKey?c.timeEntry._changeField(g,-1,true):c.timeEntry._changeField(g,+1,true));case 35:if(f.ctrlKey){c.timeEntry._setValue(g,"")}else{g._field=Math.max(1,g._secondField,g._ampmField);c.timeEntry._adjustField(g,0)}break;case 36:if(f.ctrlKey){c.timeEntry._setTime(g)}else{g._field=0;c.timeEntry._adjustField(g,0)}break;case 37:c.timeEntry._changeField(g,-1,false);break;case 38:c.timeEntry._adjustField(g,+1);break;case 39:c.timeEntry._changeField(g,+1,false);break;case 40:c.timeEntry._adjustField(g,-1);break;case 46:c.timeEntry._setValue(g,"");break}return false},_doKeyPress:function(g){var f=String.fromCharCode(g.charCode==undefined?g.keyCode:g.charCode);if(f<" "){return true}var h=c.data(g.target,e);c.timeEntry._handleKeyPress(h,f);return false},_doMouseWheel:function(f,h){if(c.timeEntry._isDisabledTimeEntry(f.target)){return}h=(c.browser.opera?-h/Math.abs(h):(c.browser.safari?h/Math.abs(h):h));var g=c.data(f.target,e);g.input.focus();if(!g.input.val()){c.timeEntry._parseTime(g)}c.timeEntry._adjustField(g,h);f.preventDefault()},_expandSpinner:function(j){var o=c.timeEntry._getSpinnerTarget(j);var l=c.data(c.timeEntry._getInput(o),e);var h=c.timeEntry._get(l,"spinnerBigImage");if(h){l._expanded=true;var n=c(o).offset();var k=null;c(o).parents().each(function(){var p=c(this);if(p.css("position")=="relative"||p.css("position")=="absolute"){k=p.offset()}return !k});var g=c.timeEntry._get(l,"spinnerSize");var f=c.timeEntry._get(l,"spinnerBigSize");c('<div class="timeEntry_expand" style="position: absolute; left: '+(n.left-(f[0]-g[0])/2-(k?k.left:0))+"px; top: "+(n.top-(f[1]-g[1])/2-(k?k.top:0))+"px; width: "+f[0]+"px; height: "+f[1]+"px; background: transparent url("+h+') no-repeat 0px 0px; z-index: 10;"></div>').mousedown(c.timeEntry._handleSpinner).mouseup(c.timeEntry._endSpinner).mouseout(c.timeEntry._endExpand).mousemove(c.timeEntry._describeSpinner).insertAfter(o)}},_getInput:function(f){return c(f).siblings("."+c.timeEntry.markerClassName)[0]},_describeSpinner:function(f){var h=c.timeEntry._getSpinnerTarget(f);var g=c.data(c.timeEntry._getInput(h),e);h.title=c.timeEntry._get(g,"spinnerTexts")[c.timeEntry._getSpinnerRegion(g,f)]},_handleSpinner:function(g){var l=c.timeEntry._getSpinnerTarget(g);var f=c.timeEntry._getInput(l);if(c.timeEntry._isDisabledTimeEntry(f)){return}if(f==c.timeEntry._blurredInput){c.timeEntry._lastInput=f;c.timeEntry._blurredInput=null}var j=c.data(f,e);c.timeEntry._doFocus(f);var k=c.timeEntry._getSpinnerRegion(j,g);c.timeEntry._changeSpinner(j,l,k);c.timeEntry._actionSpinner(j,k);c.timeEntry._timer=null;c.timeEntry._handlingSpinner=true;var h=c.timeEntry._get(j,"spinnerRepeat");if(k>=3&&h[0]){c.timeEntry._timer=setTimeout(function(){c.timeEntry._repeatSpinner(j,k)},h[0]);c(l).one("mouseout",c.timeEntry._releaseSpinner).one("mouseup",c.timeEntry._releaseSpinner)}},_actionSpinner:function(f,g){if(!f.input.val()){c.timeEntry._parseTime(f)}switch(g){case 0:this._setTime(f);break;case 1:this._changeField(f,-1,false);break;case 2:this._changeField(f,+1,false);break;case 3:this._adjustField(f,+1);break;case 4:this._adjustField(f,-1);break}},_repeatSpinner:function(f,g){if(!c.timeEntry._timer){return}c.timeEntry._lastInput=c.timeEntry._blurredInput;this._actionSpinner(f,g);this._timer=setTimeout(function(){c.timeEntry._repeatSpinner(f,g)},this._get(f,"spinnerRepeat")[1])},_releaseSpinner:function(f){clearTimeout(c.timeEntry._timer);c.timeEntry._timer=null},_endExpand:function(g){c.timeEntry._timer=null;var j=c.timeEntry._getSpinnerTarget(g);var f=c.timeEntry._getInput(j);var h=c.data(f,e);c(j).remove();h._expanded=false},_endSpinner:function(g){c.timeEntry._timer=null;var j=c.timeEntry._getSpinnerTarget(g);var f=c.timeEntry._getInput(j);var h=c.data(f,e);if(!c.timeEntry._isDisabledTimeEntry(f)){c.timeEntry._changeSpinner(h,j,-1)}if(c.timeEntry._handlingSpinner){c.timeEntry._lastInput=c.timeEntry._blurredInput}if(c.timeEntry._lastInput&&c.timeEntry._handlingSpinner){c.timeEntry._showField(h)}c.timeEntry._handlingSpinner=false},_getSpinnerTarget:function(f){return f.target||f.srcElement},_getSpinnerRegion:function(n,h){var s=this._getSpinnerTarget(h);var p=(c.browser.opera||c.browser.safari?c.timeEntry._findPos(s):c(s).offset());var j=(c.browser.safari?c.timeEntry._findScroll(s):[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop]);var g=this._get(n,"spinnerIncDecOnly");var k=(g?99:h.clientX+j[0]-p.left-(c.browser.msie?2:0));var q=h.clientY+j[1]-p.top-(c.browser.msie?2:0);var o=this._get(n,(n._expanded?"spinnerBigSize":"spinnerSize"));var r=(g?99:o[0]-1-k);var f=o[1]-1-q;if(o[2]>0&&Math.abs(k-r)<=o[2]&&Math.abs(q-f)<=o[2]){return 0}var l=Math.min(k,q,r,f);return(l==k?1:(l==r?2:(l==q?3:4)))},_changeSpinner:function(f,h,g){c(h).css("background-position","-"+((g+1)*this._get(f,(f._expanded?"spinnerBigSize":"spinnerSize"))[0])+"px 0px")},_findPos:function(h){var g=curTop=0;if(h.offsetParent){g=h.offsetLeft;curTop=h.offsetTop;while(h=h.offsetParent){var f=g;g+=h.offsetLeft;if(g<0){g=f}curTop+=h.offsetTop}}return{left:g,top:curTop}},_findScroll:function(h){var g=false;c(h).parents().each(function(){g|=c(this).css("position")=="fixed"});if(g){return[0,0]}var j=h.scrollLeft;var f=h.scrollTop;while(h=h.parentNode){j+=h.scrollLeft||0;f+=h.scrollTop||0}return[j,f]},_get:function(g,f){return(g.options[f]!=null?g.options[f]:c.timeEntry._defaults[f])},_parseTime:function(j){var h=this._extractTime(j);var g=this._get(j,"showSeconds");if(h){j._selectedHour=h[0];j._selectedMinute=h[1];j._selectedSecond=h[2]}else{var f=this._constrainTime(j);j._selectedHour=f[0];j._selectedMinute=f[1];j._selectedSecond=(g?f[2]:0)}j._secondField=(g?2:-1);j._ampmField=(this._get(j,"show24Hours")?-1:(g?3:2));j._lastChr="";j._field=Math.max(0,Math.min(Math.max(1,j._secondField,j._ampmField),this._get(j,"initialField")));if(j.input.val()!=""){this._showTime(j)}},_extractTime:function(o){var r=o.input.val();var n=this._get(o,"separator");var g=r.split(n);if(n==""&&r!=""){g[0]=r.substring(0,2);g[1]=r.substring(2,4);g[2]=r.substring(4,6)}var f=this._get(o,"ampmNames");var q=this._get(o,"show24Hours");if(g.length>=2){var p=!q&&(r.indexOf(f[0])>-1);var l=!q&&(r.indexOf(f[1])>-1);var k=parseInt(g[0],10);k=(isNaN(k)?0:k);k=((p||l)&&k==12?0:k)+(l?12:0);var j=parseInt(g[1],10);j=(isNaN(j)?0:j);var h=(g.length>=3?parseInt(g[2],10):0);h=(isNaN(h)||!this._get(o,"showSeconds")?0:h);return this._constrainTime(o,[k,j,h])}return null},_constrainTime:function(n,g){var l=(g!=null);if(!l){var h=this._determineTime(this._get(n,"defaultTime"))||new Date();g=[h.getHours(),h.getMinutes(),h.getSeconds()]}var k=false;var f=this._get(n,"timeSteps");for(var j=0;j<f.length;j++){if(k){g[j]=0}else{if(f[j]>1){g[j]=Math.round(g[j]/f[j])*f[j];k=true}}}return g},_showTime:function(h){var f=this._get(h,"show24Hours");var j=this._get(h,"separator");var g=(this._formatNumber(f?h._selectedHour:((h._selectedHour+11)%12)+1)+j+this._formatNumber(h._selectedMinute)+(this._get(h,"showSeconds")?j+this._formatNumber(h._selectedSecond):"")+(f?"":this._get(h,"ampmPrefix")+this._get(h,"ampmNames")[(h._selectedHour<12?0:1)]));this._setValue(h,g);this._showField(h)},_showField:function(k){var j=k.input[0];if(k.input.is(":hidden")||c.timeEntry._lastInput!=j){return}var l=this._get(k,"separator");var f=l.length+2;var n=(k._field!=k._ampmField?(k._field*f):(k._ampmField*f)-l.length+this._get(k,"ampmPrefix").length);var g=n+(k._field!=k._ampmField?2:this._get(k,"ampmNames")[0].length);if(j.setSelectionRange){j.setSelectionRange(n,g)}else{if(j.createTextRange){var h=j.createTextRange();h.moveStart("character",n);h.moveEnd("character",g-k.input.val().length);h.select()}}if(!j.disabled){j.focus()}},_formatNumber:function(f){return(f<10?"0":"")+f},_setValue:function(g,f){if(f!=g.input.val()){g.input.val(f).trigger("change")}},_changeField:function(g,j,h){var f=(g.input.val()==""||g._field==(j==-1?0:Math.max(1,g._secondField,g._ampmField)));if(!f){g._field+=j}this._showField(g);g._lastChr="";c.data(g.input[0],e,g);return(f&&h)},_adjustField:function(g,h){if(g.input.val()==""){h=0}var f=this._get(g,"timeSteps");this._setTime(g,new Date(0,0,0,g._selectedHour+(g._field==0?h*f[0]:0)+(g._field==g._ampmField?h*12:0),g._selectedMinute+(g._field==1?h*f[1]:0),g._selectedSecond+(g._field==g._secondField?h*f[2]:0)))},_setTime:function(k,l){l=this._determineTime(l);var f=this._constrainTime(k,l?[l.getHours(),l.getMinutes(),l.getSeconds()]:null);l=new Date(0,0,0,f[0],f[1],f[2]);var l=this._normaliseTime(l);var g=this._normaliseTime(this._determineTime(this._get(k,"minTime")));var j=this._normaliseTime(this._determineTime(this._get(k,"maxTime")));l=(g&&l<g?g:(j&&l>j?j:l));var h=this._get(k,"beforeSetTime");if(h){l=h.apply(k.input[0],[this._getTimeTimeEntry(k.input[0]),l,g,j])}k._selectedHour=l.getHours();k._selectedMinute=l.getMinutes();k._selectedSecond=l.getSeconds();this._showTime(k);c.data(k.input[0],e,k)},_determineTime:function(h){var g=function(k){var j=new Date();j.setTime(j.getTime()+k*1000);return j};var f=function(q){var o=new Date();var j=o.getHours();var p=o.getMinutes();var k=o.getSeconds();var n=/([+-]?[0-9]+)\s*(s|S|m|M|h|H)?/g;var l=n.exec(q);while(l){switch(l[2]||"s"){case"s":case"S":k+=parseInt(l[1],10);break;case"m":case"M":p+=parseInt(l[1],10);break;case"h":case"H":j+=parseInt(l[1],10);break}l=n.exec(q)}o=new Date(0,0,10,j,p,k,0);if(/^!/.test(q)){if(o.getDate()>10){o=new Date(0,0,10,23,59,59)}else{if(o.getDate()<10){o=new Date(0,0,10,0,0,0)}}}return o};return(h?(typeof h=="string"?f(h):(typeof h=="number"?g(h):h)):null)},_normaliseTime:function(f){if(!f){return null}f.setFullYear(1900);f.setMonth(0);f.setDate(0);return f},_handleKeyPress:function(l,k){if(k==this._get(l,"separator")){this._changeField(l,+1,false)}else{if(k>="0"&&k<="9"){var q=parseInt(k,10);var p=parseInt(l._lastChr+k,10);var o=this._get(l,"show24Hours");var j=(l._field!=0?l._selectedHour:(o?(p<24?p:q):(p>=1&&p<=12?p:(q>0?q:l._selectedHour))%12+(l._selectedHour>=12?12:0)));var h=(l._field!=1?l._selectedMinute:(p<60?p:q));var g=(l._field!=l._secondField?l._selectedSecond:(p<60?p:q));var n=this._constrainTime(l,[j,h,g]);this._setTime(l,new Date(0,0,0,n[0],n[1],n[2]));l._lastChr=k}else{if(!this._get(l,"show24Hours")){var f=this._get(l,"ampmNames");if((k==f[0].substring(0,1).toLowerCase()&&l._selectedHour>=12)||(k==f[1].substring(0,1).toLowerCase()&&l._selectedHour<12)){var r=l._field;l._field=l._ampmField;this._adjustField(l,+1);l._field=r;this._showField(l)}}}}}});function a(h,g){c.extend(h,g);for(var f in g){if(g[f]==null){h[f]=null}}return h}c.fn.timeEntry=function(g){var f=Array.prototype.slice.call(arguments,1);if(typeof g=="string"&&(g=="isDisabled"||g=="getTime")){return c.timeEntry["_"+g+"TimeEntry"].apply(c.timeEntry,[this[0]].concat(f))}return this.each(function(){var j=this.nodeName.toLowerCase();if(j=="input"){if(typeof g=="string"){c.timeEntry["_"+g+"TimeEntry"].apply(c.timeEntry,[this].concat(f))}else{var h=(c.fn.metadata?c(this).metadata():{});c.timeEntry._connectTimeEntry(this,c.extend(h,g))}}})};c.timeEntry=new b()})(jQuery);(function(c){var f="datepick";function e(){this._uuid=new Date().getTime();this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this.regional=[];this.regional[""]={clearText:"Clear",clearStatus:"Erase the current date",closeText:"Close",closeStatus:"Close without change",prevText:"&#x3c;Prev",prevStatus:"Show the previous month",prevBigText:"&#x3c;&#x3c;",prevBigStatus:"Show the previous year",nextText:"Next&#x3e;",nextStatus:"Show the next month",nextBigText:"&#x3e;&#x3e;",nextBigStatus:"Show the next year",currentText:"Today",currentStatus:"Show the current month",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthStatus:"Show a different month",yearStatus:"Show a different year",weekHeader:"Wk",weekStatus:"Week of the year",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],dayStatus:"Set DD as first week day",dateStatus:"Select DD, M d",dateFormat:"mm/dd/yy",firstDay:0,initStatus:"Select a date",isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={useThemeRoller:false,showOn:"focus",showAnim:"show",showOptions:{},duration:"normal",buttonText:"...",buttonImage:"",buttonImageOnly:false,alignment:"bottom",autoSize:false,defaultDate:null,showDefault:false,appendText:"",closeAtTop:true,mandatory:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,showBigPrevNext:false,stepMonths:1,stepBigMonths:12,gotoCurrent:false,changeMonth:true,changeYear:true,yearRange:"c-10:c+10",changeFirstDay:false,showOtherMonths:false,selectOtherMonths:false,highlightWeek:false,showWeeks:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",showStatus:false,statusForDate:this.dateStatus,minDate:null,maxDate:null,numberOfMonths:1,showCurrentAtPos:0,rangeSelect:false,rangeSeparator:" - ",multiSelect:0,multiSeparator:",",beforeShow:null,beforeShowDay:null,onChangeMonthYear:null,onHover:null,onSelect:null,onClose:null,altField:"",altFormat:"",constrainInput:true};c.extend(this._defaults,this.regional[""]);this.dpDiv=c('<div style="display: none;"></div>')}c.extend(e.prototype,{version:"3.7.3",markerClassName:"hasDatepick",_mainDivId:["datepick-div","ui-datepicker-div"],_mainDivClass:["","ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"],_inlineClass:["datepick-inline","ui-datepicker-inline ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"],_multiClass:["datepick-multi","ui-datepicker-multi"],_rtlClass:["datepick-rtl","ui-datepicker-rtl"],_appendClass:["datepick-append","ui-datepicker-append"],_triggerClass:["datepick-trigger","ui-datepicker-trigger"],_dialogClass:["datepick-dialog","ui-datepicker-dialog"],_promptClass:["datepick-prompt","ui-datepicker-prompt"],_disableClass:["datepick-disabled","ui-datepicker-disabled"],_controlClass:["datepick-control","ui-datepicker-header ui-widget-header ui-helper-clearfix ui-corner-all"],_clearClass:["datepick-clear","ui-datepicker-clear"],_closeClass:["datepick-close","ui-datepicker-close"],_linksClass:["datepick-links","ui-datepicker-header ui-widget-header ui-helper-clearfix ui-corner-all"],_prevClass:["datepick-prev","ui-datepicker-prev"],_nextClass:["datepick-next","ui-datepicker-next"],_currentClass:["datepick-current","ui-datepicker-current"],_oneMonthClass:["datepick-one-month","ui-datepicker-group"],_newRowClass:["datepick-new-row","ui-datepicker-row-break"],_monthYearClass:["datepick-header","ui-datepicker-header ui-widget-header ui-helper-clearfix ui-corner-all"],_monthSelectClass:["datepick-new-month","ui-datepicker-month"],_monthClass:["","ui-datepicker-month"],_yearSelectClass:["datepick-new-year","ui-datepicker-year"],_yearClass:["","ui-datepicker-year"],_tableClass:["datepick","ui-datepicker-calendar"],_tableHeaderClass:["datepick-title-row",""],_weekColClass:["datepick-week-col","ui-datepicker-week-col"],_weekRowClass:["datepick-days-row",""],_weekendClass:["datepick-week-end-cell","ui-datepicker-week-end"],_dayClass:["datepick-days-cell",""],_otherMonthClass:["datepick-other-month","ui-datepicker-other-month"],_todayClass:["datepick-today","ui-state-highlight"],_selectableClass:["","ui-state-default"],_unselectableClass:["datepick-unselectable","ui-datepicker-unselectable ui-state-disabled"],_selectedClass:["datepick-current-day","ui-state-active"],_dayOverClass:["datepick-days-cell-over","ui-state-hover"],_weekOverClass:["datepick-week-over","ui-state-hover"],_statusClass:["datepick-status","ui-datepicker-status"],_statusId:["datepick-status-","ui-datepicker-status-"],_coverClass:["datepick-cover","ui-datepicker-cover"],setDefaults:function(g){b(this._defaults,g||{});return this},_attachDatepick:function(k,h){if(!k.id){k.id="dp"+(++this._uuid)}var l=k.nodeName.toLowerCase();var j=this._newInst(c(k),(l=="div"||l=="span"));var g=(c.fn.metadata?c(k).metadata():{});j.settings=c.extend({},h||{},g||{});if(j.inline){j.dpDiv.addClass(this._inlineClass[this._get(j,"useThemeRoller")?1:0]);this._inlineDatepick(k,j)}else{this._connectDatepick(k,j)}},_newInst:function(h,g){var j=h[0].id.replace(/([^A-Za-z0-9_])/g,"\\\\$1");return{id:j,input:h,cursorDate:this._daylightSavingAdjust(new Date()),drawMonth:0,drawYear:0,dates:[],inline:g,dpDiv:(!g?this.dpDiv:c("<div></div>")),siblings:c([])}},_connectDatepick:function(n,l){var o=c(n);if(o.hasClass(this.markerClassName)){return}var k=this._get(l,"appendText");var g=this._get(l,"isRTL");var s=this._get(l,"useThemeRoller")?1:0;if(k){var h=c('<span class="'+this._appendClass[s]+'">'+k+"</span>");o[g?"before":"after"](h);l.siblings=l.siblings.add(h)}var q=this._get(l,"showOn");if(q=="focus"||q=="both"){o.focus(this._showDatepick)}if(q=="button"||q=="both"){var p=this._get(l,"buttonText");var r=this._get(l,"buttonImage");var j=c(this._get(l,"buttonImageOnly")?c("<img/>").addClass(this._triggerClass[s]).attr({src:r,alt:p,title:p}):c('<button type="button"></button>').addClass(this._triggerClass[s]).html(r==""?p:c("<img/>").attr({src:r,alt:p,title:p})));o[g?"before":"after"](j);l.siblings=l.siblings.add(j);j.click(function(){if(c.datepick._datepickerShowing&&c.datepick._lastInput==n){c.datepick._hideDatepick()}else{c.datepick._showDatepick(n)}return false})}o.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp);if(this._get(l,"showDefault")&&!l.input.val()){l.dates=[this._getDefaultDate(l)];this._showDate(l)}this._autoSize(l);c.data(n,f,l)},_autoSize:function(k){if(this._get(k,"autoSize")&&!k.inline){var j=new Date(2009,12-1,20);var g=this._get(k,"dateFormat");if(g.match(/[DM]/)){var h=function(p){var l=0;var n=0;for(var o=0;o<p.length;o++){if(p[o].length>l){l=p[o].length;n=o}}return n};j.setMonth(h(this._get(k,(g.match(/MM/)?"monthNames":"monthNamesShort"))));j.setDate(h(this._get(k,(g.match(/DD/)?"dayNames":"dayNamesShort")))+20-j.getDay())}k.input.attr("size",this._formatDate(k,j).length)}},_inlineDatepick:function(h,g){var j=c(h);if(j.hasClass(this.markerClassName)){return}j.addClass(this.markerClassName);c.data(h,f,g);g.cursorDate=this._getDefaultDate(g);g.drawMonth=g.cursorDate.getMonth();g.drawYear=g.cursorDate.getFullYear();if(this._get(g,"showDefault")){g.dates=[this._getDefaultDate(g)]}c("body").append(g.dpDiv);this._updateDatepick(g);g.dpDiv.width(this._getNumberOfMonths(g)[1]*c("."+this._oneMonthClass[this._get(g,"useThemeRoller")?1:0],g.dpDiv)[0].offsetWidth);j.append(g.dpDiv);this._updateAlternate(g)},_dialogDatepick:function(o,h,l,j,n){var k=this._dialogInst;if(!k){var g="dp"+(++this._uuid);this._dialogInput=c('<input type="text" id="'+g+'" style="position: absolute; width: 1px; z-index: -1"/>');this._dialogInput.keydown(this._doKeyDown);c("body").append(this._dialogInput);k=this._dialogInst=this._newInst(this._dialogInput,false);k.settings={};c.data(this._dialogInput[0],f,k)}b(k.settings,j||{});h=(h&&h.constructor==Date?this._formatDate(k,h):h);this._dialogInput.val(h);this._pos=(n?(a(n)?n:[n.pageX,n.pageY]):null);if(!this._pos){var q=document.documentElement.scrollLeft||document.body.scrollLeft;var p=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(document.documentElement.clientWidth/2)-100+q,(document.documentElement.clientHeight/2)-150+p]}this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");k.settings.onSelect=l;this._inDialog=true;this.dpDiv.addClass(this._dialogClass[this._get(k,"useThemeRoller")?1:0]);this._showDatepick(this._dialogInput[0]);if(c.blockUI){c.blockUI(this.dpDiv)}c.data(this._dialogInput[0],f,k)},_destroyDatepick:function(j){var g=c(j);if(!g.hasClass(this.markerClassName)){return}var h=c.data(j,f);c.removeData(j,f);if(h.inline){g.removeClass(this.markerClassName).empty()}else{c(h.siblings).remove();g.removeClass(this.markerClassName).unbind("focus",this._showDatepick).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}},_enableDatepick:function(k){var g=c(k);if(!g.hasClass(this.markerClassName)){return}var j=c.data(k,f);var h=this._get(j,"useThemeRoller")?1:0;if(j.inline){g.children("."+this._disableClass[h]).remove().end().find("select").attr("disabled","").end().find("a").attr("href","javascript:void(0)")}else{k.disabled=false;j.siblings.filter("button."+this._triggerClass[h]).each(function(){this.disabled=false}).end().filter("img."+this._triggerClass[h]).css({opacity:"1.0",cursor:""})}this._disabledInputs=c.map(this._disabledInputs,function(l){return(l==k?null:l)})},_disableDatepick:function(l){var g=c(l);if(!g.hasClass(this.markerClassName)){return}var j=c.data(l,f);var h=this._get(j,"useThemeRoller")?1:0;if(j.inline){var k=g.children("."+this._inlineClass[h]);var o=k.offset();var n={left:0,top:0};k.parents().each(function(){if(c(this).css("position")=="relative"){n=c(this).offset();return false}});g.prepend('<div class="'+this._disableClass[h]+'" style="width: '+k.outerWidth()+"px; height: "+k.outerHeight()+"px; left: "+(o.left-n.left)+"px; top: "+(o.top-n.top)+'px;"></div>').find("select").attr("disabled","disabled").end().find("a").removeAttr("href")}else{l.disabled=true;j.siblings.filter("button."+this._triggerClass[h]).each(function(){this.disabled=true}).end().filter("img."+this._triggerClass[h]).css({opacity:"0.5",cursor:"default"})}this._disabledInputs=c.map(this._disabledInputs,function(p){return(p==l?null:p)});this._disabledInputs.push(l)},_isDisabledDatepick:function(g){return(!g?false:c.inArray(g,this._disabledInputs)>-1)},_getInst:function(h){try{return c.data(h,f)}catch(g){throw"Missing instance data for this datepicker"}},_optionDatepick:function(o,g,l){var k=this._getInst(o);if(arguments.length==2&&typeof g=="string"){return(g=="defaults"?c.extend({},c.datepick._defaults):(k?(g=="all"?c.extend({},k.settings):this._get(k,g)):null))}var j=g||{};if(typeof g=="string"){j={};j[g]=l}if(k){if(this._curInst==k){this._hideDatepick(null,true)}var n=this._getDateDatepick(o);b(k.settings,j);this._autoSize(k);b(k,{dates:[]});var p=(!n||a(n));if(a(n)){for(var h=0;h<n.length;h++){if(n[h]){p=false;break}}}if(!p){this._setDateDatepick(o,n)}if(k.inline){c(o).children("div").removeClass(this._inlineClass.join(" ")).addClass(this._inlineClass[this._get(k,"useThemeRoller")?1:0])}this._updateDatepick(k)}},_changeDatepick:function(j,g,h){this._optionDatepick(j,g,h)},_refreshDatepick:function(h){var g=this._getInst(h);if(g){this._updateDatepick(g)}},_setDateDatepick:function(k,g,j){var h=this._getInst(k);if(h){this._setDate(h,g,j);this._updateDatepick(h);this._updateAlternate(h)}},_getDateDatepick:function(h){var g=this._getInst(h);if(g&&!g.inline){this._setDateFromField(g)}return(g?this._getDate(g):null)},_doKeyDown:function(j){var l=c.datepick._getInst(j.target);l.keyEvent=true;var n=true;var g=c.datepick._get(l,"isRTL");var h=c.datepick._get(l,"useThemeRoller")?1:0;if(c.datepick._datepickerShowing){switch(j.keyCode){case 9:c.datepick._hideDatepick();n=false;break;case 13:var k=c("td."+c.datepick._dayOverClass[h],l.dpDiv);if(k.length==0){k=c("td."+c.datepick._selectedClass[h]+":first",l.dpDiv)}if(k[0]){c.datepick._selectDay(k[0],j.target,l.cursorDate.getTime())}else{c.datepick._hideDatepick()}break;case 27:c.datepick._hideDatepick();break;case 33:c.datepick._adjustDate(j.target,(j.ctrlKey?-c.datepick._get(l,"stepBigMonths"):-c.datepick._get(l,"stepMonths")),"M");break;case 34:c.datepick._adjustDate(j.target,(j.ctrlKey?+c.datepick._get(l,"stepBigMonths"):+c.datepick._get(l,"stepMonths")),"M");break;case 35:if(j.ctrlKey||j.metaKey){c.datepick._clearDate(j.target)}n=j.ctrlKey||j.metaKey;break;case 36:if(j.ctrlKey||j.metaKey){c.datepick._gotoToday(j.target)}n=j.ctrlKey||j.metaKey;break;case 37:if(j.ctrlKey||j.metaKey){c.datepick._adjustDate(j.target,(g?+1:-1),"D")}n=j.ctrlKey||j.metaKey;if(j.originalEvent.altKey){c.datepick._adjustDate(j.target,(j.ctrlKey?-c.datepick._get(l,"stepBigMonths"):-c.datepick._get(l,"stepMonths")),"M")}break;case 38:if(j.ctrlKey||j.metaKey){c.datepick._adjustDate(j.target,-7,"D")}n=j.ctrlKey||j.metaKey;break;case 39:if(j.ctrlKey||j.metaKey){c.datepick._adjustDate(j.target,(g?-1:+1),"D")}n=j.ctrlKey||j.metaKey;if(j.originalEvent.altKey){c.datepick._adjustDate(j.target,(j.ctrlKey?+c.datepick._get(l,"stepBigMonths"):+c.datepick._get(l,"stepMonths")),"M")}break;case 40:if(j.ctrlKey||j.metaKey){c.datepick._adjustDate(j.target,+7,"D")}n=j.ctrlKey||j.metaKey;break;default:n=false}}else{if(j.keyCode==36&&j.ctrlKey){c.datepick._showDatepick(this)}else{n=false}}if(n){j.preventDefault();j.stopPropagation()}l.ctrlKey=(j.keyCode<48);return !n},_doKeyPress:function(j){var k=c.datepick._getInst(j.target);if(c.datepick._get(k,"constrainInput")){var h=c.datepick._possibleChars(k);var g=String.fromCharCode(j.keyCode||j.charCode);return k.ctrlKey||(g<" "||!h||h.indexOf(g)>-1)}},_doKeyUp:function(j){var k=c.datepick._getInst(j.target);if(k.input.val()!=k.lastVal){try{var n=(c.datepick._get(k,"rangeSelect")?c.datepick._get(k,"rangeSeparator"):(c.datepick._get(k,"multiSelect")?c.datepick._get(k,"multiSeparator"):""));var l=(k.input?k.input.val():"");l=(n?l.split(n):[l]);var h=true;for(var g=0;g<l.length;g++){if(!c.datepick.parseDate(c.datepick._get(k,"dateFormat"),l[g],c.datepick._getFormatConfig(k))){h=false;break}}if(h){c.datepick._setDateFromField(k);c.datepick._updateAlternate(k);c.datepick._updateDatepick(k)}}catch(j){}}return true},_possibleChars:function(n){var g=c.datepick._get(n,"dateFormat");var l=(c.datepick._get(n,"rangeSelect")?c.datepick._get(n,"rangeSeparator"):(c.datepick._get(n,"multiSelect")?c.datepick._get(n,"multiSeparator"):""));var j=false;var h=function(o){var p=(k+1<format.length&&format.charAt(k+1)==o);if(p){k++}return p};for(var k=0;k<g.length;k++){if(j){if(g.charAt(k)=="'"&&!h("'")){j=false}else{l+=g.charAt(k)}}else{switch(g.charAt(k)){case"d":case"m":case"y":case"@":l+="0123456789";break;case"D":case"M":return null;case"'":if(h("'")){l+="'"}else{j=true}break;default:l+=g.charAt(k)}}}return l},_doMouseOver:function(o,n,l){var k=c.datepick._getInst(c("#"+n)[0]);var j=c.datepick._get(k,"useThemeRoller")?1:0;c(o).parents(".datepick-one-month").parent().find("td").removeClass(c.datepick._dayOverClass[j]);c(o).addClass(c.datepick._dayOverClass[j]);if(c.datepick._get(k,"highlightWeek")){c(o).parent().parent().find("tr").removeClass(c.datepick._weekOverClass[j]).end().end().addClass(c.datepick._weekOverClass[j])}if(c(o).text()){var h=new Date(l);if(c.datepick._get(k,"showStatus")){var g=(c.datepick._get(k,"statusForDate").apply((k.input?k.input[0]:null),[h,k])||c.datepick._get(k,"initStatus"));c("#"+c.datepick._statusId[j]+n).html(g)}if(c.datepick._get(k,"onHover")){c.datepick._doHover(o,"#"+n,h.getFullYear(),h.getMonth())}}},_doMouseOut:function(k,j){var h=c.datepick._getInst(c("#"+j)[0]);var g=c.datepick._get(h,"useThemeRoller")?1:0;c(k).removeClass(c.datepick._dayOverClass[g]).removeClass(c.datepick._weekOverClass[g]);if(c.datepick._get(h,"showStatus")){c("#"+c.datepick._statusId[g]+j).html(c.datepick._get(h,"initStatus"))}if(c.datepick._get(h,"onHover")){c.datepick._doHover(k,"#"+j)}},_doHover:function(p,o,j,n){var k=this._getInst(c(o)[0]);var h=c.datepick._get(k,"useThemeRoller")?1:0;if(c(p).hasClass(this._unselectableClass[h])){return}var l=this._get(k,"onHover");var g=(j?this._daylightSavingAdjust(new Date(j,n,c(p).text())):null);l.apply((k.input?k.input[0]:null),[(g?this._formatDate(k,g):""),g,k])},_showDatepick:function(p){p=p.target||p;if(c.datepick._isDisabledDatepick(p)||c.datepick._lastInput==p){return}var o=c.datepick._getInst(p);if(c.datepick._curInst&&c.datepick._curInst!=o){c.datepick._curInst.dpDiv.stop(true,true)}var k=c.datepick._get(o,"beforeShow");var q=c.datepick._get(o,"useThemeRoller")?1:0;b(o.settings,(k?k.apply(p,[p,o]):{}));c.datepick._datepickerShowing=true;c.datepick._lastInput=p;c.datepick._setDateFromField(o);if(c.datepick._inDialog){p.value=""}if(!c.datepick._pos){c.datepick._pos=c.datepick._findPos(p);c.datepick._pos[1]+=p.offsetHeight}var j=false;c(p).parents().each(function(){j|=c(this).css("position")=="fixed";return !j});if(j&&c.browser.opera){c.datepick._pos[0]-=document.documentElement.scrollLeft;c.datepick._pos[1]-=document.documentElement.scrollTop}var n={left:c.datepick._pos[0],top:c.datepick._pos[1]};c.datepick._pos=null;o.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});c.datepick._updateDatepick(o);o.dpDiv.width(c.datepick._getNumberOfMonths(o)[1]*c("."+c.datepick._oneMonthClass[q],o.dpDiv).width());n=c.datepick._checkOffset(o,n,j);o.dpDiv.css({position:(c.datepick._inDialog&&c.blockUI?"static":(j?"fixed":"absolute")),display:"none",left:n.left+"px",top:n.top+"px"});if(!o.inline){var g=c.datepick._get(o,"showAnim");var l=c.datepick._get(o,"duration");var h=function(){var r=c.datepick._getBorders(o.dpDiv);o.dpDiv.find("iframe."+c.datepick._coverClass[q]).css({left:-r[0],top:-r[1],width:o.dpDiv.outerWidth(),height:o.dpDiv.outerHeight()})};if(c.effects&&c.effects[g]){o.dpDiv.show(g,c.datepick._get(o,"showOptions"),l,h)}else{o.dpDiv[g||"show"](g?l:"",h)}if(!g){h()}if(o.input[0].type!="hidden"){o.input.focus()}c.datepick._curInst=o}},_updateDatepick:function(j){var k=this._getBorders(j.dpDiv);var h=this._get(j,"useThemeRoller")?1:0;j.dpDiv.empty().append(this._generateHTML(j)).find("iframe."+this._coverClass[h]).css({left:-k[0],top:-k[1],width:j.dpDiv.outerWidth(),height:j.dpDiv.outerHeight()});var g=this._getNumberOfMonths(j);if(!j.inline){j.dpDiv.attr("id",this._mainDivId[h])}j.dpDiv.removeClass(this._mainDivClass[1-h]).addClass(this._mainDivClass[h]).removeClass(this._multiClass.join(" ")).addClass(g[0]!=1||g[1]!=1?this._multiClass[h]:"").removeClass(this._rtlClass.join(" ")).addClass(this._get(j,"isRTL")?this._rtlClass[h]:"");if(j.input&&j.input[0].type!="hidden"&&j==c.datepick._curInst){c(j.input).focus()}},_getBorders:function(g){var h=function(k){var j=(c.browser.msie?1:0);return{thin:1+j,medium:3+j,thick:5+j}[k]||k};return[parseFloat(h(g.css("border-left-width"))),parseFloat(h(g.css("border-top-width")))]},_checkOffset:function(n,l,j){var r=this._get(n,"alignment");var h=this._get(n,"isRTL");var s=n.input?this._findPos(n.input[0]):null;var x=document.documentElement.clientWidth;var o=document.documentElement.clientHeight;if(x==0){return l}var w=document.documentElement.scrollLeft||document.body.scrollLeft;var v=document.documentElement.scrollTop||document.body.scrollTop;var q=s[1]-(this._inDialog?0:n.dpDiv.outerHeight())-(j&&c.browser.opera?document.documentElement.scrollTop:0);var u=l.top;var t=l.left;var p=s[0]+(n.input?n.input.outerWidth():0)-n.dpDiv.outerWidth()-(j&&c.browser.opera?document.documentElement.scrollLeft:0);var k=(l.left+n.dpDiv.outerWidth()-w)>x;var g=(l.top+n.dpDiv.outerHeight()-v)>o;if(r=="topLeft"){l={left:t,top:q}}else{if(r=="topRight"){l={left:p,top:q}}else{if(r=="bottomLeft"){l={left:t,top:u}}else{if(r=="bottomRight"){l={left:p,top:u}}else{if(r=="top"){l={left:(h||k?p:t),top:q}}else{l={left:(h||k?p:t),top:(g?q:u)}}}}}}l.left=Math.max((j?0:w),l.left-(j?w:0));l.top=Math.max((j?0:v),l.top-(j?v:0));return l},_findPos:function(h){while(h&&(h.type=="hidden"||h.nodeType!=1)){h=h.nextSibling}var g=c(h).offset();return[g.left,g.top]},_hideDatepick:function(l,k){var o=this._curInst;if(!o||(l&&o!=c.data(l,f))){return false}var j=this._get(o,"rangeSelect");if(j&&o.stayOpen){this._updateInput("#"+o.id)}o.stayOpen=false;if(this._datepickerShowing){var h=(k?"":this._get(o,"showAnim"));var p=this._get(o,"duration");var n=function(){c.datepick._tidyDialog(o);c.datepick._curInst=null};if(c.effects&&c.effects[h]){o.dpDiv.hide(h,c.datepick._get(o,"showOptions"),p,n)}else{o.dpDiv[(h=="slideDown"?"slideUp":(h=="fadeIn"?"fadeOut":"hide"))](h?p:"",n)}if(p==""){n()}var g=this._get(o,"onClose");if(g){g.apply((o.input?o.input[0]:null),[(o.input?o.input.val():""),this._getDate(o),o])}this._datepickerShowing=false;this._lastInput=null;o.settings.prompt=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});this.dpDiv.removeClass(this._dialogClass[this._get(o,"useThemeRoller")?1:0]);if(c.blockUI){c.unblockUI();c("body").append(this.dpDiv)}}this._inDialog=false}return false},_tidyDialog:function(h){var g=this._get(h,"useThemeRoller")?1:0;h.dpDiv.removeClass(this._dialogClass[g]).unbind(".datepick");c("."+this._promptClass[g],h.dpDiv).remove()},_checkExternalClick:function(j){if(!c.datepick._curInst){return}var g=c(j.target);var h=c.datepick._get(c.datepick._curInst,"useThemeRoller")?1:0;if(!g.parents().andSelf().is("#"+c.datepick._mainDivId[h])&&!g.hasClass(c.datepick.markerClassName)&&!g.parents().andSelf().hasClass(c.datepick._triggerClass[h])&&c.datepick._datepickerShowing&&!(c.datepick._inDialog&&c.blockUI)){c.datepick._hideDatepick()}},_adjustDate:function(k,j,h){var g=this._getInst(c(k)[0]);this._adjustInstDate(g,j,h);this._updateDatepick(g);return false},_gotoToday:function(j){var h=c(j);var g=this._getInst(h[0]);if(this._get(g,"gotoCurrent")&&g.dates[0]){g.cursorDate=new Date(g.dates[0].getTime())}else{g.cursorDate=this._daylightSavingAdjust(new Date())}g.drawMonth=g.cursorDate.getMonth();g.drawYear=g.cursorDate.getFullYear();this._notifyChange(g);this._adjustDate(h);return false},_selectMonthYear:function(n,g,l){var k=c(n);var j=this._getInst(k[0]);j.selectingMonthYear=false;var h=parseInt(g.options[g.selectedIndex].value,10);j.drawMonth-=c.datepick._get(j,"showCurrentAtPos");if(j.drawMonth<0){j.drawMonth+=12;j.drawYear--}j["selected"+(l=="M"?"Month":"Year")]=j["draw"+(l=="M"?"Month":"Year")]=h;j.cursorDate.setDate(Math.min(j.cursorDate.getDate(),c.datepick._getDaysInMonth(j.drawYear,j.drawMonth)));j.cursorDate["set"+(l=="M"?"Month":"FullYear")](h);this._notifyChange(j);this._adjustDate(k)},_clickMonthYear:function(h){var g=this._getInst(c(h)[0]);if(g.input&&g.selectingMonthYear&&!c.browser.msie){g.input.focus()}g.selectingMonthYear=!g.selectingMonthYear},_changeFirstDay:function(j,g){var h=this._getInst(c(j)[0]);h.settings.firstDay=g;this._updateDatepick(h);return false},_selectDay:function(k,g,o){var n=this._getInst(c(g)[0]);var r=this._get(n,"useThemeRoller")?1:0;if(c(k).hasClass(this._unselectableClass[r])){return false}var q=this._get(n,"rangeSelect");var h=this._get(n,"multiSelect");if(q){n.stayOpen=!n.stayOpen}else{if(h){n.stayOpen=true}}if(n.stayOpen){c(".datepick td",n.dpDiv).removeClass(this._selectedClass[r]);c(k).addClass(this._selectedClass[r])}n.cursorDate=this._daylightSavingAdjust(new Date(o));var j=new Date(n.cursorDate.getTime());if(q&&!n.stayOpen){n.dates[1]=j}else{if(h){var p=-1;for(var l=0;l<n.dates.length;l++){if(n.dates[l]&&j.getTime()==n.dates[l].getTime()){p=l;break}}if(p>-1){n.dates.splice(p,1)}else{if(n.dates.length<h){if(n.dates[0]){n.dates.push(j)}else{n.dates=[j]}n.stayOpen=(n.dates.length!=h)}}}else{n.dates=[j]}}this._updateInput(g,true);if(n.stayOpen||n.inline){this._updateDatepick(n)}return false},_clearDate:function(j){var h=c(j);var g=this._getInst(h[0]);if(this._get(g,"mandatory")){return false}g.stayOpen=false;g.dates=(this._get(g,"showDefault")?[this._getDefaultDate(g)]:[]);this._updateInput(h);return false},_updateInput:function(l,j){var k=this._getInst(c(l)[0]);var g=this._showDate(k);this._updateAlternate(k);var h=this._get(k,"onSelect");if(h){h.apply((k.input?k.input[0]:null),[g,this._getDate(k),k])}else{if(k.input){k.input.trigger("change")}}if(k.inline&&!j){this._updateDatepick(k)}else{if(!k.stayOpen){this._hideDatepick();this._lastInput=k.input[0];if(typeof(k.input[0])!="object"){k.input.focus()}this._lastInput=null}}return false},_showDate:function(j){var g="";if(j.input){g=(j.dates.length==0?"":this._formatDate(j,j.dates[0]));if(g){if(this._get(j,"rangeSelect")){g+=this._get(j,"rangeSeparator")+this._formatDate(j,j.dates[1]||j.dates[0])}else{if(this._get(j,"multiSelect")){for(var h=1;h<j.dates.length;h++){g+=this._get(j,"multiSeparator")+this._formatDate(j,j.dates[h])}}}}j.input.val(g)}return g},_updateAlternate:function(n){var h=this._get(n,"altField");if(h){var l=this._get(n,"altFormat")||this._get(n,"dateFormat");var k=this._getFormatConfig(n);var g=this.formatDate(l,n.dates[0],k);if(g&&this._get(n,"rangeSelect")){g+=this._get(n,"rangeSeparator")+this.formatDate(l,n.dates[1]||n.dates[0],k)}else{if(this._get(n,"multiSelect")){for(var j=1;j<n.dates.length;j++){g+=this._get(n,"multiSeparator")+this.formatDate(l,n.dates[j],k)}}}c(h).val(g)}},noWeekends:function(g){return[(g.getDay()||7)<6,""]},iso8601Week:function(g){var j=new Date(g.getTime());j.setDate(j.getDate()+4-(j.getDay()||7));var h=j.getTime();j.setMonth(0);j.setDate(1);return Math.floor(Math.round((h-j)/86400000)/7)+1},dateStatus:function(g,h){return c.datepick.formatDate(c.datepick._get(h,"dateStatus"),g,c.datepick._getFormatConfig(h))},parseDate:function(x,r,z){if(x==null||r==null){throw"Invalid arguments"}r=(typeof r=="object"?r.toString():r+"");if(r==""){return null}z=z||{};var h=z.shortYearCutoff||this._defaults.shortYearCutoff;h=(typeof h!="string"?h:new Date().getFullYear()%100+parseInt(h,10));var p=z.dayNamesShort||this._defaults.dayNamesShort;var B=z.dayNames||this._defaults.dayNames;var g=z.monthNamesShort||this._defaults.monthNamesShort;var k=z.monthNames||this._defaults.monthNames;var l=-1;var C=-1;var v=-1;var n=-1;var u=false;var q=function(E){var F=(j+1<x.length&&x.charAt(j+1)==E);if(F){j++}return F};var D=function(F){q(F);var G=(F=="@"?14:(F=="!"?20:(F=="y"?4:(F=="o"?3:2))));var H=new RegExp("^\\d{1,"+G+"}");var E=r.substring(w).match(H);if(!E){throw"Missing number at position "+w}w+=E[0].length;return parseInt(E[0],10)};var o=function(E,G,I){var H=(q(E)?I:G);for(var F=0;F<H.length;F++){if(r.substr(w,H[F].length)==H[F]){w+=H[F].length;return F+1}}throw"Unknown name at position "+w};var t=function(){if(r.charAt(w)!=x.charAt(j)){throw"Unexpected literal at position "+w}w++};var w=0;for(var j=0;j<x.length;j++){if(u){if(x.charAt(j)=="'"&&!q("'")){u=false}else{t()}}else{switch(x.charAt(j)){case"d":v=D("d");break;case"D":o("D",p,B);break;case"o":n=D("o");break;case"w":D("w");break;case"m":C=D("m");break;case"M":C=o("M",g,k);break;case"y":l=D("y");break;case"@":var A=new Date(D("@"));l=A.getFullYear();C=A.getMonth()+1;v=A.getDate();break;case"!":var A=new Date((D("!")-this._ticksTo1970)/10000);l=A.getFullYear();C=A.getMonth()+1;v=A.getDate();break;case"'":if(q("'")){t()}else{u=true}break;default:t()}}}if(w<r.length){throw"Additional text found at end"}if(l==-1){l=new Date().getFullYear()}else{if(l<100){l+=(h==-1?1900:new Date().getFullYear()-new Date().getFullYear()%100-(l<=h?0:100))}}if(n>-1){C=1;v=n;do{var s=this._getDaysInMonth(l,C-1);if(v<=s){break}C++;v-=s}while(true)}var A=this._daylightSavingAdjust(new Date(l,C-1,v));if(A.getFullYear()!=l||A.getMonth()+1!=C||A.getDate()!=v){throw"Invalid date"}return A},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(s,l,n){if(!l){return""}n=n||{};var v=n.dayNamesShort||this._defaults.dayNamesShort;var h=n.dayNames||this._defaults.dayNames;var q=n.monthNamesShort||this._defaults.monthNamesShort;var o=n.monthNames||this._defaults.monthNames;var j=n.calculateWeek||this._defaults.calculateWeek;var t=function(w){var x=(u+1<s.length&&s.charAt(u+1)==w);if(x){u++}return x};var g=function(z,A,w){var x=""+A;if(t(z)){while(x.length<w){x="0"+x}}return x};var p=function(w,z,x,A){return(t(w)?A[z]:x[z])};var k="";var r=false;if(l){for(var u=0;u<s.length;u++){if(r){if(s.charAt(u)=="'"&&!t("'")){r=false}else{k+=s.charAt(u)}}else{switch(s.charAt(u)){case"d":k+=g("d",l.getDate(),2);break;case"D":k+=p("D",l.getDay(),v,h);break;case"o":k+=g("o",(l.getTime()-new Date(l.getFullYear(),0,0).getTime())/86400000,3);break;case"w":k+=g("w",j(l),2);break;case"m":k+=g("m",l.getMonth()+1,2);break;case"M":k+=p("M",l.getMonth(),q,o);break;case"y":k+=(t("y")?l.getFullYear():(l.getFullYear()%100<10?"0":"")+l.getFullYear()%100);break;case"@":k+=l.getTime();break;case"!":k+=l.getTime()*10000+this._ticksTo1970;break;case"'":if(t("'")){k+="'"}else{r=true}break;default:k+=s.charAt(u)}}}}return k},_get:function(h,g){return h.settings[g]!==undefined?h.settings[g]:this._defaults[g]},_setDateFromField:function(n){var g=this._get(n,"dateFormat");var h=this._get(n,"rangeSelect");var p=this._get(n,"multiSelect");n.lastVal=(n.input?n.input.val():"");var o=n.lastVal;o=(h?o.split(this._get(n,"rangeSeparator")):(p?o.split(this._get(n,"multiSeparator")):[o]));n.dates=[];var k=this._getFormatConfig(n);for(var j=0;j<o.length;j++){try{n.dates[j]=this.parseDate(g,o[j],k)}catch(l){n.dates[j]=null}}for(var j=n.dates.length-1;j>=0;j--){if(!n.dates[j]){n.dates.splice(j,1)}}if(h&&n.dates.length<2){n.dates[1]=n.dates[0]}if(p&&n.dates.length>p){n.dates.splice(p,n.dates.length)}n.cursorDate=new Date((n.dates[0]||this._getDefaultDate(n)).getTime());n.drawMonth=n.cursorDate.getMonth();n.drawYear=n.cursorDate.getFullYear();this._adjustInstDate(n)},_getDefaultDate:function(g){return this._restrictMinMax(g,this._determineDate(g,this._get(g,"defaultDate"),new Date()))},_determineDate:function(k,g,l){var j=function(o){var n=new Date();n.setDate(n.getDate()+o);return n};var h=function(u){try{return c.datepick.parseDate(c.datepick._get(k,"dateFormat"),u,c.datepick._getFormatConfig(k))}catch(t){}var o=(u.toLowerCase().match(/^c/)?c.datepick._getDate(k):null)||new Date();var p=o.getFullYear();var s=o.getMonth();var n=o.getDate();var r=/([+-]?[0-9]+)\s*(d|w|m|y)?/g;var q=r.exec(u.toLowerCase());while(q){switch(q[2]||"d"){case"d":n+=parseInt(q[1],10);break;case"w":n+=parseInt(q[1],10)*7;break;case"m":s+=parseInt(q[1],10);n=Math.min(n,c.datepick._getDaysInMonth(p,s));break;case"y":p+=parseInt(q[1],10);n=Math.min(n,c.datepick._getDaysInMonth(p,s));break}q=r.exec(u.toLowerCase())}return new Date(p,s,n)};g=(g==null?l:(typeof g=="string"?h(g):(typeof g=="number"?(isNaN(g)||g==Infinity||g==-Infinity?l:j(g)):g)));g=(g&&(g.toString()=="Invalid Date"||g.toString()=="NaN")?l:g);if(g){g.setHours(0);g.setMinutes(0);g.setSeconds(0);g.setMilliseconds(0)}return this._daylightSavingAdjust(g)},_daylightSavingAdjust:function(g){if(!g){return null}g.setHours(g.getHours()>12?g.getHours()+2:0);return g},_setDate:function(l,h,n){h=(!h?[]:(a(h)?h:[h]));if(n){h.push(n)}var g=l.cursorDate.getMonth();var k=l.cursorDate.getFullYear();l.dates=(h.length==0?[]:[this._restrictMinMax(l,this._determineDate(l,h[0],new Date()))]);l.cursorDate=(h.length==0?new Date():new Date(l.dates[0].getTime()));l.drawMonth=l.cursorDate.getMonth();l.drawYear=l.cursorDate.getFullYear();if(this._get(l,"rangeSelect")){if(h.length>0){l.dates[1]=(h.length<1?l.dates[0]:this._restrictMinMax(l,this._determineDate(l,h[1],null)))}}else{if(this._get(l,"multiSelect")){for(var j=1;j<h.length;j++){l.dates[j]=this._restrictMinMax(l,this._determineDate(l,h[j],null))}}}if(g!=l.cursorDate.getMonth()||k!=l.cursorDate.getFullYear()){this._notifyChange(l)}this._adjustInstDate(l);this._showDate(l)},_getDate:function(h){var g=(!h.inline&&h.input&&h.input.val()==""?null:(h.dates.length?h.dates[0]:null));if(this._get(h,"rangeSelect")){return(g?[h.dates[0],h.dates[1]||h.dates[0]]:[null,null])}else{if(this._get(h,"multiSelect")){return h.dates.slice(0,h.dates.length)}else{return g}}},_generateHTML:function(af){var E=new Date();E=this._daylightSavingAdjust(new Date(E.getFullYear(),E.getMonth(),E.getDate()));var A=this._get(af,"showStatus");var B=this._get(af,"initStatus")||"&#xa0;";var an=this._get(af,"isRTL");var w=this._get(af,"useThemeRoller")?1:0;var ah=(this._get(af,"mandatory")?"":'<div class="'+this._clearClass[w]+'"><a href="javascript:void(0)" onclick="jQuery.datepick._clearDate(\'#'+af.id+"');\""+this._addStatus(w,A,af.id,this._get(af,"clearStatus"),B)+">"+this._get(af,"clearText")+"</a></div>");var T='<div class="'+this._controlClass[w]+'">'+(an?"":ah)+'<div class="'+this._closeClass[w]+'"><a href="javascript:void(0)" onclick="jQuery.datepick._hideDatepick();"'+this._addStatus(w,A,af.id,this._get(af,"closeStatus"),B)+">"+this._get(af,"closeText")+"</a></div>"+(an?ah:"")+"</div>";var ao=this._get(af,"prompt");var K=this._get(af,"closeAtTop");var Z=this._get(af,"hideIfNoPrevNext");var J=this._get(af,"navigationAsDateFormat");var au=this._get(af,"showBigPrevNext");var x=this._getNumberOfMonths(af);var o=this._get(af,"showCurrentAtPos");var M=this._get(af,"stepMonths");var av=this._get(af,"stepBigMonths");var H=(x[0]!=1||x[1]!=1);var p=this._getMinMaxDate(af,"min",true);var z=this._getMinMaxDate(af,"max");var h=af.drawMonth-o;var ab=af.drawYear;if(h<0){h+=12;ab--}if(z){var D=this._daylightSavingAdjust(new Date(z.getFullYear(),z.getMonth()-(x[0]*x[1])+1,z.getDate()));D=(p&&D<p?p:D);while(this._daylightSavingAdjust(new Date(ab,h,1))>D){h--;if(h<0){h=11;ab--}}}af.drawMonth=h+o;af.drawYear=ab;if(af.drawMonth>11){af.drawMonth-=12;af.drawYear++}var C=this._get(af,"prevText");C=(!J?C:this.formatDate(C,this._daylightSavingAdjust(new Date(ab,h-M,1)),this._getFormatConfig(af)));var N=(au?this._get(af,"prevBigText"):"");N=(!J?N:this.formatDate(N,this._daylightSavingAdjust(new Date(ab,h-av,1)),this._getFormatConfig(af)));var Y='<div class="'+this._prevClass[w]+'">'+(this._canAdjustMonth(af,-1,ab,h)?(au?'<a href="javascript:void(0)" onclick="jQuery.datepick._adjustDate(\'#'+af.id+"', -"+av+", 'M');\""+this._addStatus(w,A,af.id,this._get(af,"prevBigStatus"),B)+">"+N+"</a>":"")+'<a href="javascript:void(0)" onclick="jQuery.datepick._adjustDate(\'#'+af.id+"', -"+M+", 'M');\""+this._addStatus(w,A,af.id,this._get(af,"prevStatus"),B)+">"+C+"</a>":(Z?"&#xa0;":(au?"<label>"+N+"</label>":"")+"<label>"+C+"</label>"))+"</div>";var O=this._get(af,"nextText");O=(!J?O:this.formatDate(O,this._daylightSavingAdjust(new Date(ab,h+M,1)),this._getFormatConfig(af)));var aq=(au?this._get(af,"nextBigText"):"");aq=(!J?aq:this.formatDate(aq,this._daylightSavingAdjust(new Date(ab,h+av,1)),this._getFormatConfig(af)));var l='<div class="'+this._nextClass[w]+'">'+(this._canAdjustMonth(af,+1,ab,h)?'<a href="javascript:void(0)" onclick="jQuery.datepick._adjustDate(\'#'+af.id+"', +"+M+", 'M');\""+this._addStatus(w,A,af.id,this._get(af,"nextStatus"),B)+">"+O+"</a>"+(au?'<a href="javascript:void(0)" onclick="jQuery.datepick._adjustDate(\'#'+af.id+"', +"+av+", 'M');\""+this._addStatus(w,A,af.id,this._get(af,"nextBigStatus"),B)+">"+aq+"</a>":""):(Z?"&#xa0;":"<label>"+O+"</label>"+(au?"<label>"+aq+"</label>":"")))+"</div>";var ak=this._get(af,"currentText");var ae=(this._get(af,"gotoCurrent")&&af.dates[0]?af.dates[0]:E);ak=(!J?ak:this.formatDate(ak,ae,this._getFormatConfig(af)));var W=(K&&!af.inline?T:"")+'<div class="'+this._linksClass[w]+'">'+(an?l:Y)+'<div class="'+this._currentClass[w]+'">'+(this._isInRange(af,ae)?'<a href="javascript:void(0)" onclick="jQuery.datepick._gotoToday(\'#'+af.id+"');\""+this._addStatus(w,A,af.id,this._get(af,"currentStatus"),B)+">"+ak+"</a>":(Z?"&#xa0;":"<label>"+ak+"</label>"))+"</div>"+(an?Y:l)+"</div>"+(ao?'<div class="'+this._promptClass[w]+'"><span>'+ao+"</span></div>":"");var L=parseInt(this._get(af,"firstDay"),10);L=(isNaN(L)?0:L);var am=this._get(af,"changeFirstDay");var t=this._get(af,"dayNames");var V=this._get(af,"dayNamesShort");var u=this._get(af,"dayNamesMin");var s=this._get(af,"monthNames");var aj=this._get(af,"beforeShowDay");var q=this._get(af,"showOtherMonths");var G=this._get(af,"selectOtherMonths");var ag=this._get(af,"showWeeks");var j=this._get(af,"calculateWeek")||this.iso8601Week;var aw=this._get(af,"weekStatus");var ac=(A?this._get(af,"dayStatus")||B:"");var S=this._get(af,"statusForDate")||this.dateStatus;var al=this._getDefaultDate(af);for(var F=0;F<x[0];F++){for(var r=0;r<x[1];r++){var P=this._daylightSavingAdjust(new Date(ab,h,af.cursorDate.getDate()));W+='<div class="'+this._oneMonthClass[w]+(r==0&&!w?" "+this._newRowClass[w]:"")+'">'+this._generateMonthYearHeader(af,h,ab,p,z,P,F>0||r>0,w,A,B,s)+'<table class="'+this._tableClass[w]+'" cellpadding="0" cellspacing="0"><thead><tr class="'+this._tableHeaderClass[w]+'">'+(ag?"<th"+this._addStatus(w,A,af.id,aw,B)+">"+this._get(af,"weekHeader")+"</th>":"");for(var at=0;at<7;at++){var R=(at+L)%7;var X=(!A||!am?"":ac.replace(/DD/,t[R]).replace(/D/,V[R]));W+="<th"+((at+L+6)%7<5?"":' class="'+this._weekendClass[w]+'"')+">"+(!am?"<span"+this._addStatus(w,A,af.id,t[R],B):'<a href="javascript:void(0)" onclick="jQuery.datepick._changeFirstDay(\'#'+af.id+"', "+R+');"'+this._addStatus(w,A,af.id,X,B))+' title="'+t[R]+'">'+u[R]+(am?"</a>":"</span>")+"</th>"}W+="</tr></thead><tbody>";var n=this._getDaysInMonth(ab,h);if(ab==af.cursorDate.getFullYear()&&h==af.cursorDate.getMonth()){af.cursorDate.setDate(Math.min(af.cursorDate.getDate(),n))}var I=(this._getFirstDayOfMonth(ab,h)-L+7)%7;var ad=(H?6:Math.ceil((I+n)/7));var ai=this._daylightSavingAdjust(new Date(ab,h,1-I));for(var k=0;k<ad;k++){W+='<tr class="'+this._weekRowClass[w]+'">'+(ag?'<td class="'+this._weekColClass[w]+'"'+this._addStatus(w,A,af.id,aw,B)+">"+j(ai)+"</td>":"");for(var at=0;at<7;at++){var ap=(aj?aj.apply((af.input?af.input[0]:null),[ai]):[true,""]);var Q=(ai.getMonth()!=h);var v=(Q&&!G)||!ap[0]||(p&&ai<p)||(z&&ai>z);var U=(this._get(af,"rangeSelect")&&af.dates[0]&&ai.getTime()>=af.dates[0].getTime()&&ai.getTime()<=(af.dates[1]||af.dates[0]).getTime());for(var ar=0;ar<af.dates.length;ar++){U=U||(af.dates[ar]&&ai.getTime()==af.dates[ar].getTime())}var g=Q&&!q;W+='<td class="'+this._dayClass[w]+((at+L+6)%7>=5?" "+this._weekendClass[w]:"")+(Q?" "+this._otherMonthClass[w]:"")+((ai.getTime()==P.getTime()&&h==af.cursorDate.getMonth()&&af.keyEvent)||(al.getTime()==ai.getTime()&&al.getTime()==P.getTime())?" "+c.datepick._dayOverClass[w]:"")+(v?" "+this._unselectableClass[w]:" "+this._selectableClass[w])+(g?"":" "+ap[1]+(U?" "+this._selectedClass[w]:"")+(ai.getTime()==E.getTime()?" "+this._todayClass[w]:""))+'"'+(!g&&ap[2]?' title="'+ap[2]+'"':"")+(v?"":" onmouseover=\"jQuery.datepick._doMouseOver(this,'"+af.id+"',"+ai.getTime()+')" onmouseout="jQuery.datepick._doMouseOut(this,\''+af.id+"')\" onclick=\"jQuery.datepick._selectDay(this,'#"+af.id+"',"+ai.getTime()+')"')+">"+(g?"&#xa0;":(v?ai.getDate():'<a href="javascript:void(0)">'+ai.getDate()+"</a>"))+"</td>";ai.setDate(ai.getDate()+1);ai=this._daylightSavingAdjust(ai)}W+="</tr>"}h++;if(h>11){h=0;ab++}W+="</tbody></table></div>"}if(w){W+='<div class="'+this._newRowClass[w]+'"></div>'}}W+=(A?'<div style="clear: both;"></div><div id="'+this._statusId[w]+af.id+'" class="'+this._statusClass[w]+'">'+B+"</div>":"")+(!K&&!af.inline?T:"")+'<div style="clear: both;"></div>'+(c.browser.msie&&parseInt(c.browser.version,10)<7&&!af.inline?'<iframe src="javascript:false;" class="'+this._coverClass[w]+'"></iframe>':"");af.keyEvent=false;return W},_generateMonthYearHeader:function(l,j,x,o,v,p,z,h,s,r,t){var C=this._daylightSavingAdjust(new Date(x,j,1));o=(o&&C<o?C:o);var k=this._get(l,"changeMonth");var G=this._get(l,"changeYear");var H=this._get(l,"showMonthAfterYear");var u='<div class="'+this._monthYearClass[h]+'">';var D="";if(z||!k){D+='<span class="'+this._monthClass[h]+'">'+t[j]+"</span>"}else{var E=(o&&o.getFullYear()==x);var g=(v&&v.getFullYear()==x);D+='<select class="'+this._monthSelectClass[h]+'" onchange="jQuery.datepick._selectMonthYear(\'#'+l.id+"', this, 'M');\" onclick=\"jQuery.datepick._clickMonthYear('#"+l.id+"');\""+this._addStatus(h,s,l.id,this._get(l,"monthStatus"),r)+">";for(var F=0;F<12;F++){if((!E||F>=o.getMonth())&&(!g||F<=v.getMonth())){D+='<option value="'+F+'"'+(F==j?' selected="selected"':"")+">"+t[F]+"</option>"}}D+="</select>"}if(!H){u+=D+(z||!k||!G?"&#xa0;":"")}if(z||!G){u+='<span class="'+this._yearClass[h]+'">'+x+"</span>"}else{var B=this._get(l,"yearRange").split(":");var n=new Date().getFullYear();var A=function(J){var I=(J.match(/c[+-].*/)?x+parseInt(J.substring(1),10):(J.match(/[+-].*/)?n+parseInt(J,10):parseInt(J,10)));return(isNaN(I)?n:I)};var w=A(B[0]);var q=Math.max(w,A(B[1]||""));w=(o?Math.max(w,o.getFullYear()):w);q=(v?Math.min(q,v.getFullYear()):q);u+='<select class="'+this._yearSelectClass[h]+'" onchange="jQuery.datepick._selectMonthYear(\'#'+l.id+"', this, 'Y');\" onclick=\"jQuery.datepick._clickMonthYear('#"+l.id+"');\""+this._addStatus(h,s,l.id,this._get(l,"yearStatus"),r)+">";for(;w<=q;w++){u+='<option value="'+w+'"'+(w==x?' selected="selected"':"")+">"+w+"</option>"}u+="</select>"}u+=this._get(l,"yearSuffix");if(H){u+=(z||!k||!G?"&#xa0;":"")+D}u+="</div>";return u},_addStatus:function(h,k,l,j,g){return(k?" onmouseover=\"jQuery('#"+this._statusId[h]+l+"').html('"+(j||g)+"');\" onmouseout=\"jQuery('#"+this._statusId[h]+l+"').html('"+g+"');\"":"")},_adjustInstDate:function(k,o,n){var g=k.drawYear+"/"+k.drawMonth;var j=k.drawYear+(n=="Y"?o:0);var l=k.drawMonth+(n=="M"?o:0);var h=Math.min(k.cursorDate.getDate(),this._getDaysInMonth(j,l))+(n=="D"?o:0);k.cursorDate=this._restrictMinMax(k,this._daylightSavingAdjust(new Date(j,l,h)));k.drawMonth=k.cursorDate.getMonth();k.drawYear=k.cursorDate.getFullYear();if(g!=k.drawYear+"/"+k.drawMonth){this._notifyChange(k)}},_restrictMinMax:function(j,g){var h=this._getMinMaxDate(j,"min",true);var k=this._getMinMaxDate(j,"max");g=(h&&g<h?new Date(h.getTime()):g);g=(k&&g>k?new Date(k.getTime()):g);return g},_notifyChange:function(h){var g=this._get(h,"onChangeMonthYear");if(g){g.apply((h.input?h.input[0]:null),[h.cursorDate.getFullYear(),h.cursorDate.getMonth()+1,this._daylightSavingAdjust(new Date(h.cursorDate.getFullYear(),h.cursorDate.getMonth(),1)),h])}},_getNumberOfMonths:function(h){var g=this._get(h,"numberOfMonths");return(g==null?[1,1]:(typeof g=="number"?[1,g]:g))},_getMinMaxDate:function(k,h,g){var j=this._determineDate(k,this._get(k,h+"Date"),null);var l=this._getRangeMin(k);return(g&&l&&(!j||l>j)?l:j)},_getRangeMin:function(g){return(this._get(g,"rangeSelect")&&g.dates[0]&&!g.dates[1]?g.dates[0]:null)},_getDaysInMonth:function(g,h){return 32-new Date(g,h,32).getDate()},_getFirstDayOfMonth:function(g,h){return new Date(g,h,1).getDay()},_canAdjustMonth:function(k,n,j,l){var g=this._getNumberOfMonths(k);var h=this._daylightSavingAdjust(new Date(j,l+(n<0?n:g[0]*g[1]),1));if(n<0){h.setDate(this._getDaysInMonth(h.getFullYear(),h.getMonth()))}return this._isInRange(k,h)},_isInRange:function(j,g){var h=this._getRangeMin(j)||this._getMinMaxDate(j,"min");var k=this._getMinMaxDate(j,"max");return((!h||g>=h)&&(!k||g<=k))},_getFormatConfig:function(g){return{shortYearCutoff:this._get(g,"shortYearCutoff"),dayNamesShort:this._get(g,"dayNamesShort"),dayNames:this._get(g,"dayNames"),monthNamesShort:this._get(g,"monthNamesShort"),monthNames:this._get(g,"monthNames")}},_formatDate:function(k,j,l,g){if(!j){k.dates[0]=new Date(k.cursorDate.getTime())}var h=(j?(typeof j=="object"?j:this._daylightSavingAdjust(new Date(j,l,g))):k.dates[0]);return this.formatDate(this._get(k,"dateFormat"),h,this._getFormatConfig(k))}});function b(j,h){c.extend(j,h);for(var g in h){if(h[g]==null||h[g]==undefined){j[g]=h[g]}}return j}function a(g){return(g&&g.constructor==Array)}c.fn.datepick=function(h){var g=Array.prototype.slice.call(arguments,1);if(typeof h=="string"&&(h=="isDisabled"||h=="getDate"||h=="settings")){return c.datepick["_"+h+"Datepick"].apply(c.datepick,[this[0]].concat(g))}if(h=="option"&&arguments.length==2&&typeof arguments[1]=="string"){return c.datepick["_"+h+"Datepick"].apply(c.datepick,[this[0]].concat(g))}return this.each(function(){typeof h=="string"?c.datepick["_"+h+"Datepick"].apply(c.datepick,[this].concat(g)):c.datepick._attachDatepick(this,h)})};c.datepick=new e();c(function(){c(document).mousedown(c.datepick._checkExternalClick).find("body").append(c.datepick.dpDiv)})})(jQuery);
/*
 * jQuery Form Plugin
 * version: 2.69 (06-APR-2011)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(b){b.fn.ajaxSubmit=function(x){if(!this.length){a("ajaxSubmit: skipping submit process - no element selected");return this}if(typeof x=="function"){x={success:x}}var j=this.attr("action");var e=(typeof j==="string")?b.trim(j):"";if(e){e=(e.match(/^([^#]+)/)||[])[1]}e=e||window.location.href||"";x=b.extend(true,{url:e,success:b.ajaxSettings.success,type:this[0].getAttribute("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},x);var z={};this.trigger("form-pre-serialize",[this,x,z]);if(z.veto){a("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(x.beforeSerialize&&x.beforeSerialize(this,x)===false){a("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var g,t,r=this.formToArray(x.semantic);if(x.data){x.extraData=x.data;for(g in x.data){if(x.data[g] instanceof Array){for(var l in x.data[g]){r.push({name:g,value:x.data[g][l]})}}else{t=x.data[g];t=b.isFunction(t)?t():t;r.push({name:g,value:t})}}}if(x.beforeSubmit&&x.beforeSubmit(r,this,x)===false){a("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[r,this,x,z]);if(z.veto){a("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var c=b.param(r);if(x.type.toUpperCase()=="GET"){x.url+=(x.url.indexOf("?")>=0?"&":"?")+c;x.data=null}else{x.data=c}var w=this,p=[];if(x.resetForm){p.push(function(){w.resetForm()})}if(x.clearForm){p.push(function(){w.clearForm()})}if(!x.dataType&&x.target){var u=x.success||function(){};p.push(function(n){var k=x.replaceTarget?"replaceWith":"html";b(x.target)[k](n).each(u,arguments)})}else{if(x.success){p.push(x.success)}}x.success=function(A,n,B){var v=x.context||x;for(var q=0,k=p.length;q<k;q++){p[q].apply(v,[A,n,B||w,w])}};var h=b("input:file",this).length>0;var f="multipart/form-data";var o=(w.attr("enctype")==f||w.attr("encoding")==f);if(x.iframe!==false&&(h||x.iframe||o)){if(x.closeKeepAlive){b.get(x.closeKeepAlive,s)}else{s()}}else{b.ajax(x)}this.trigger("form-submit-notify",[this,x]);return this;function s(){var v=w[0];if(b(":input[name=submit],:input[id=submit]",v).length){alert('Error: Form elements must not have name or id of "submit".');return}var F=b.extend(true,{},b.ajaxSettings,x);F.context=F.context||F;var I="jqFormIO"+(new Date().getTime()),D="_"+I;var A=b('<iframe id="'+I+'" name="'+I+'" src="'+F.iframeSrc+'" />');var E=A[0];A.css({position:"absolute",top:"-1000px",left:"-1000px"});var B={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){a("aborting upload...");var n="aborted";this.aborted=1;A.attr("src",F.iframeSrc);B.error=n;F.error&&F.error.call(F.context,B,"error",n);M&&b.event.trigger("ajaxError",[B,F,n]);F.complete&&F.complete.call(F.context,B,"error")}};var M=F.global;if(M&&!b.active++){b.event.trigger("ajaxStart")}if(M){b.event.trigger("ajaxSend",[B,F])}if(F.beforeSend&&F.beforeSend.call(F.context,B,F)===false){if(F.global){b.active--}return}if(B.aborted){return}var L=0;var C=v.clk;if(C){var J=C.name;if(J&&!C.disabled){F.extraData=F.extraData||{};F.extraData[J]=C.value;if(C.type=="image"){F.extraData[J+".x"]=v.clk_x;F.extraData[J+".y"]=v.clk_y}}}function K(){var S=w.attr("target"),Q=w.attr("action");v.setAttribute("target",I);if(v.getAttribute("method")!="POST"){v.setAttribute("method","POST")}if(v.getAttribute("action")!=F.url){v.setAttribute("action",F.url)}if(!F.skipEncodingOverride){w.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(F.timeout){setTimeout(function(){L=true;H()},F.timeout)}var R=[];try{if(F.extraData){for(var T in F.extraData){R.push(b('<input type="hidden" name="'+T+'" value="'+F.extraData[T]+'" />').appendTo(v)[0])}}A.appendTo("body");E.attachEvent?E.attachEvent("onload",H):E.addEventListener("load",H,false);v.submit()}finally{v.setAttribute("action",Q);if(S){v.setAttribute("target",S)}else{w.removeAttr("target")}b(R).remove()}}if(F.forceSync){K()}else{setTimeout(K,10)}var O,P,N=50;function H(){if(B.aborted){return}var V=E.contentWindow?E.contentWindow.document:E.contentDocument?E.contentDocument:E.document;if(!V||V.location.href==F.iframeSrc){if(!L){return}}E.detachEvent?E.detachEvent("onload",H):E.removeEventListener("load",H,false);var R=true;try{if(L){throw"timeout"}var W=F.dataType=="xml"||V.XMLDocument||b.isXMLDoc(V);a("isXml="+W);if(!W&&window.opera&&(V.body==null||V.body.innerHTML=="")){if(--N){a("requeing onLoad callback, DOM not available");setTimeout(H,250);return}}B.responseText=V.body?V.body.innerHTML:V.documentElement?V.documentElement.innerHTML:null;B.responseXML=V.XMLDocument?V.XMLDocument:V;B.getResponseHeader=function(Y){var X={"content-type":F.dataType};return X[Y]};var U=/(json|script)/.test(F.dataType);if(U||F.textarea){var Q=V.getElementsByTagName("textarea")[0];if(Q){B.responseText=Q.value}else{if(U){var T=V.getElementsByTagName("pre")[0];var n=V.getElementsByTagName("body")[0];if(T){B.responseText=T.textContent}else{if(n){B.responseText=n.innerHTML}}}}}else{if(F.dataType=="xml"&&!B.responseXML&&B.responseText!=null){B.responseXML=G(B.responseText)}}O=k(B,F.dataType,F)}catch(S){a("error caught:",S);R=false;B.error=S;F.error&&F.error.call(F.context,B,"error",S);M&&b.event.trigger("ajaxError",[B,F,S])}if(B.aborted){a("upload aborted");R=false}if(R){F.success&&F.success.call(F.context,O,"success",B);M&&b.event.trigger("ajaxSuccess",[B,F])}M&&b.event.trigger("ajaxComplete",[B,F]);if(M&&!--b.active){b.event.trigger("ajaxStop")}F.complete&&F.complete.call(F.context,B,R?"success":"error");setTimeout(function(){A.removeData("form-plugin-onload");A.remove();B.responseXML=null},100)}var G=b.parseXML||function(n,Q){if(window.ActiveXObject){Q=new ActiveXObject("Microsoft.XMLDOM");Q.async="false";Q.loadXML(n)}else{Q=(new DOMParser()).parseFromString(n,"text/xml")}return(Q&&Q.documentElement&&Q.documentElement.nodeName!="parsererror")?Q:null};var q=b.parseJSON||function(n){return window["eval"]("("+n+")")};var k=function(U,S,R){var Q=U.getResponseHeader("content-type")||"",n=S==="xml"||!S&&Q.indexOf("xml")>=0,T=n?U.responseXML:U.responseText;if(n&&T.documentElement.nodeName==="parsererror"){b.error&&b.error("parsererror")}if(R&&R.dataFilter){T=R.dataFilter(T,S)}if(typeof T==="string"){if(S==="json"||!S&&Q.indexOf("json")>=0){T=q(T)}else{if(S==="script"||!S&&Q.indexOf("javascript")>=0){b.globalEval(T)}}}return T}}};b.fn.ajaxForm=function(c){if(this.length===0){var e={s:this.selector,c:this.context};if(!b.isReady&&e.s){a("DOM not ready, queuing ajaxForm");b(function(){b(e.s,e.c).ajaxForm(c)});return this}a("terminating; zero elements found by selector"+(b.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(f){if(!f.isDefaultPrevented()){f.preventDefault();b(this).ajaxSubmit(c)}}).bind("click.form-plugin",function(k){var j=k.target;var g=b(j);if(!(g.is(":submit,input:image"))){var f=g.closest(":submit");if(f.length==0){return}j=f[0]}var h=this;h.clk=j;if(j.type=="image"){if(k.offsetX!=undefined){h.clk_x=k.offsetX;h.clk_y=k.offsetY}else{if(typeof b.fn.offset=="function"){var l=g.offset();h.clk_x=k.pageX-l.left;h.clk_y=k.pageY-l.top}else{h.clk_x=k.pageX-j.offsetLeft;h.clk_y=k.pageY-j.offsetTop}}}setTimeout(function(){h.clk=h.clk_x=h.clk_y=null},100)})};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};b.fn.formToArray=function(s){var r=[];if(this.length===0){return r}var e=this[0];var h=s?e.getElementsByTagName("*"):e.elements;if(!h){return r}var l,k,g,t,f,p,c;for(l=0,p=h.length;l<p;l++){f=h[l];g=f.name;if(!g){continue}if(s&&e.clk&&f.type=="image"){if(!f.disabled&&e.clk==f){r.push({name:g,value:b(f).val()});r.push({name:g+".x",value:e.clk_x},{name:g+".y",value:e.clk_y})}continue}t=b.fieldValue(f,true);if(t&&t.constructor==Array){for(k=0,c=t.length;k<c;k++){r.push({name:g,value:t[k]})}}else{if(t!==null&&typeof t!="undefined"){r.push({name:g,value:t})}}}if(!s&&e.clk){var o=b(e.clk),q=o[0];g=q.name;if(g&&!q.disabled&&q.type=="image"){r.push({name:g,value:o.val()});r.push({name:g+".x",value:e.clk_x},{name:g+".y",value:e.clk_y})}}return r};b.fn.formSerialize=function(c){return b.param(this.formToArray(c))};b.fn.fieldSerialize=function(e){var c=[];this.each(function(){var j=this.name;if(!j){return}var g=b.fieldValue(this,e);if(g&&g.constructor==Array){for(var h=0,f=g.length;h<f;h++){c.push({name:j,value:g[h]})}}else{if(g!==null&&typeof g!="undefined"){c.push({name:this.name,value:g})}}});return b.param(c)};b.fn.fieldValue=function(j){for(var h=[],f=0,c=this.length;f<c;f++){var g=this[f];var e=b.fieldValue(g,j);if(e===null||typeof e=="undefined"||(e.constructor==Array&&!e.length)){continue}e.constructor==Array?b.merge(h,e):h.push(e)}return h};b.fieldValue=function(c,k){var f=c.name,r=c.type,s=c.tagName.toLowerCase();if(k===undefined){k=true}if(k&&(!f||c.disabled||r=="reset"||r=="button"||(r=="checkbox"||r=="radio")&&!c.checked||(r=="submit"||r=="image")&&c.form&&c.form.clk!=c||s=="select"&&c.selectedIndex==-1)){return null}if(s=="select"){var l=c.selectedIndex;if(l<0){return null}var p=[],e=c.options;var h=(r=="select-one");var o=(h?l+1:e.length);for(var g=(h?l:0);g<o;g++){var j=e[g];if(j.selected){var q=j.value;if(!q){q=(j.attributes&&j.attributes.value&&!(j.attributes.value.specified))?j.text:j.value}if(h){return q}p.push(q)}}return p}return b(c).val()};b.fn.clearForm=function(){return this.each(function(){b("input,select,textarea",this).clearFields()})};b.fn.clearFields=b.fn.clearInputs=function(){return this.each(function(){var e=this.type,c=this.tagName.toLowerCase();if(e=="text"||e=="password"||c=="textarea"){this.value=""}else{if(e=="checkbox"||e=="radio"){this.checked=false}else{if(c=="select"){this.selectedIndex=-1}}}})};b.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};b.fn.enable=function(c){if(c===undefined){c=true}return this.each(function(){this.disabled=!c})};b.fn.selected=function(c){if(c===undefined){c=true}return this.each(function(){var e=this.type;if(e=="checkbox"||e=="radio"){this.checked=c}else{if(this.tagName.toLowerCase()=="option"){var f=b(this).parent("select");if(c&&f[0]&&f[0].type=="select-one"){f.find("option").selected(false)}this.selected=c}}})};function a(){if(b.fn.ajaxSubmit.debug){var c="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(c)}else{if(window.opera&&window.opera.postError){window.opera.postError(c)}}}}})(jQuery);(function(ac){var T=ac(window),ae,au,S=-1,al,ab,U,ad,Z,M,ah,am=!window.XMLHttpRequest,ag=[],an=document.documentElement,ao={},af=new Image(),O=new Image(),Q,az,at,aj,P,aw,R,ax,X,N;ac(function(){ac("body").append(ac([Q=ac('<div id="lbOverlay" />')[0],az=ac('<div id="lbCenter" />')[0],R=ac('<div id="lbBottomContainer" />')[0]]).css("display","none"));at=ac('<div id="lbImage" />').appendTo(az).append(aj=ac('<div style="position: relative;" />').append([P=ac('<a id="lbPrevLink" href="#" />').click(W)[0],aw=ac('<a id="lbNextLink" href="#" />').click(av)[0]])[0])[0];ax=ac('<div id="lbBottom" />').appendTo(R).append([ac('<a id="lbCloseLink" href="#" />').add(Q).click(V)[0],X=ac('<div id="lbCaption" />')[0],N=ac('<div id="lbNumber" />')[0],ac('<div style="clear: both;" />')[0]])[0]});ac.slimbox=function(a,b,c){ae=ac.extend({loop:false,overlayOpacity:0.8,overlayFadeDuration:400,resizeDuration:400,resizeEasing:"swing",initialWidth:250,initialHeight:250,imageFadeDuration:400,captionAnimationDuration:400,counterText:"Image {x} of {y}",closeKeys:[27,88,67],previousKeys:[37,80],nextKeys:[39,78]},c);if(typeof a=="string"){a=[[a,b]];b=0}Z=T.scrollTop()+(T.height()/2);M=ae.initialWidth;ah=ae.initialHeight;ac(az).css({top:Math.max(0,Z-(ah/2)),width:M,height:ah,marginLeft:-M/2}).show();ad=am||(Q.currentStyle&&(Q.currentStyle.position!="fixed"));if(ad){Q.style.position="absolute"}ac(Q).css("opacity",ae.overlayOpacity).fadeIn(ae.overlayFadeDuration);Y();ap(1);au=a;ae.loop=ae.loop&&(au.length>1);return ay(b)};ac.fn.slimbox=function(e,a,b){a=a||function(f){return[f.href,f.title]};b=b||function(){return true};var c=this;return c.unbind("click").click(function(){var h=this,f=0,g,k=0,j;g=ac.grep(c,function(l,n){return b.call(h,l,n)});for(j=g.length;k<j;++k){if(g[k]==h){f=k}g[k]=a(g[k],k)}return ac.slimbox(g,f,e)})};function Y(){var a=T.scrollLeft(),b=T.width();ac([az,R]).css("left",a+(b/2));if(ad){ac(Q).css({left:a,top:T.scrollTop(),width:b,height:T.height()})}}function ap(b){if(b){ac("object").add(am?"select":"embed").each(function(e,c){ag[e]=[c,c.style.visibility];c.style.visibility="hidden"})}else{ac.each(ag,function(e,c){c[0].style.visibility=c[1]});ag=[]}var a=b?"bind":"unbind";T[a]("scroll resize",Y);ac(document)[a]("keydown",ak)}function ak(a){var b=a.keyCode,c=ac.inArray;return(c(b,ae.closeKeys)>=0)?V():(c(b,ae.nextKeys)>=0)?av():(c(b,ae.previousKeys)>=0)?W():false}function W(){return ay(ab)}function av(){return ay(U)}function ay(a){if(a>=0){S=a;al=au[S][0];ab=(S||(ae.loop?au.length:0))-1;U=((S+1)%au.length)||(ae.loop?0:-1);ai();az.className="lbLoading";ao=new Image();ao.onload=aq;ao.src=al}return false}function aq(){az.className="";ac(at).css({backgroundImage:"url("+al+")",visibility:"hidden",display:""});ac(aj).width(ao.width);ac([aj,P,aw]).height(ao.height);ac(X).html(au[S][1]||"");ac(N).html((((au.length>1)&&ae.counterText)||"").replace(/{x}/,S+1).replace(/{y}/,au.length));if(ab>=0){af.src=au[ab][0]}if(U>=0){O.src=au[U][0]}M=at.offsetWidth;ah=at.offsetHeight;var a=Math.max(0,Z-(ah/2));if(az.offsetHeight!=ah){ac(az).animate({height:ah,top:a},ae.resizeDuration,ae.resizeEasing)}if(az.offsetWidth!=M){ac(az).animate({width:M,marginLeft:-M/2},ae.resizeDuration,ae.resizeEasing)}ac(az).queue(function(){ac(R).css({width:M,top:a+ah,marginLeft:-M/2,visibility:"hidden",display:""});ac(at).css({display:"none",visibility:"",opacity:""}).fadeIn(ae.imageFadeDuration,ar)})}function ar(){if(ab>=0){ac(P).show()}if(U>=0){ac(aw).show()}ac(ax).css("marginTop",-ax.offsetHeight).animate({marginTop:0},ae.captionAnimationDuration);R.style.visibility=""}function ai(){ao.onload=null;ao.src=af.src=O.src=al;ac([az,at,ax]).stop(true);ac([P,aw,at,R]).hide()}function V(){if(S>=0){ai();S=ab=U=-1;ac(az).hide();ac(Q).stop().fadeOut(ae.overlayFadeDuration,ap)}return false}})(jQuery);if(!/android|iphone|ipod|series60|symbian|windows ce|blackberry/i.test(navigator.userAgent)){jQuery(function(a){a("a[rel^='lightbox']").slimbox({resizeDuration:1,captionAnimationDuration:1,overlayFadeDuration:200,imageFadeDuration:200},null,function(b){return(this==b)||((this.rel.length>8)&&(this.rel==b.rel))})})}var App={};App.tmp_ajax_params=undefined;if(!window.console){window.console={}}if(!window.console.firebug){var names=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];for(var i=0;i<names.length;++i){if(!window.console[names[i]]){window.console[names[i]]=function(){}}}}App.initOnReady=function(){for(var a in App.QTipStyles){$.fn.qtip.styles[a]=App.QTipStyles[a]}App.initCallbacks()};App.initCallbacks=function(a){if(a==undefined){a=$("body")}a.find("#menuone").menu({minWidth:120,arrowSrc:"/i/menu/arrow_right.gif",copyClassAttr:true,hoverOpenDelay:100});a.find(".dk4-radio-buttons input[type=radio]").prettyCheckboxes({display:"inline"});a.find(".dk4-checkboxes input[type=checkbox]").prettyCheckboxes();a.find("#feature_slides").css("visibility","visible");a.find("#feature_slides").jshowoff({speed:25000,links:true,controls:false,hover:true});a.find(".show-on-load").removeClass("show-on-load");a.find("a.ajax").removeClass("ajax").addClass("ajaxON");a.find("a.ajax-popup").removeClass("ajax-popup").addClass("ajaxON-popup");a.find("div.ajax-tabbed > ul.navigation > li > a").click(App.onAjaxButtonTab);a.find("div.ajax-form-tabbed input.ajax-form-tab-button").change(App.onAjaxButtonFormTab);a.find(".ajax-radio-panel input.ajax-radio-panel-button").change(App.onAjaxButtonRadioTab);a.find(".ajax-radio-panel-group input.ajax-radio-panel-button:first").each(function(){App.onAjaxButtonRadioTab.call(this)});a.find("form.ajax-form").submit(App.onAjaxButtonFormSubmit);a.find("form.ajax-form-selector").submit(App.onAjaxPopupClick);a.find("a.collapsor").click(App.onAjaxButtonCollapse);a.find("a.ajaxON").click(App.onAjaxButtonClick);a.find("a.ajaxON-popup").click(App.onAjaxPopupClick);a.find("#postdate, .ajax-datepick").datepicker();a.find("#posttime, .ajax-timepick").timeEntry();a.find("#uplink").click(function(){$("#updiv").slideToggle("fast");return false});a.find("#upload_image_file").ajaxForm({dataType:"xml",success:function(b){var c=$("#upcode");var e=c.clone();e.html($(b).find("rcode").text());c.replaceWith(e)}});$("h2").click(function(){var b=window.location.host.toString().replace(/^.*?dailykos/,"dailykos").replace("/","");$(this).next().toggle();if(!$(this).next().is(":visible")){$.cookie(this.id,true,{expires:7,path:"/",domain:b})}else{$.cookie(this.id,null,{expires:-1,path:"/",domain:b})}});$(".queue_headers").each(function(){if($.cookie(this.id)){$(this).next().toggle()}});App.initTooltips(a);return a};App.unSchedule=function(a){$("#postdate").attr("value","");$("#posttime").attr("value","")};App.hideAllTooltips=function(){console.log("hideAllTooltips ["+this+"]");$(".hasTooltip").qtip("hide");$(".altTooltip").qtip("hide");return false};App.initTooltips=function(a){a.find(".hasTooltip").each(function(){if(!$.browser.mobile){var b=$(this).next(".tooltipContents");$(this).qtip({content:b,show:"mouseover",hide:"mouseout",effect:{type:"slide"},position:App.QTipPositions[App.findClassType(b,"qtip-pos-")[1]||"bl"],style:App.findClassType(b,"qtip-style-")[1]||"dk4"})}});a.find(".altTooltip").each(function(){$(this).qtip({content:$(this).attr("alt"),show:"mouseover",hide:"mouseout",effect:{type:"slide"},position:App.QTipPositions.bm,style:"dk4_alt"})});return a};App.QTipStyles={dk4:{background:"#F8F5EF",fontSize:"11px",fontFamily:"Verdana",padding:10,border:{width:1,radius:0,color:"#E3D7B3"}},dk4_alt:{name:"dk4",padding:2},dk4_large:{name:"dk4",width:500}};App.QTipPositions={bm:{corner:{target:"bottomMiddle",tooltip:"topMiddle"}},bl:{corner:{target:"bottomLeft",tooltip:"topLeft"}},br:{corner:{target:"bottomRight",tooltip:"topRight"}}};App.onAjaxPopupClick=function(){console.log("onAjaxPopupClick ["+this+"]");var b;var a;var e;var c=$(this);if(c.attr("href")){a=c;e=App.splitURL(a.attr("href"))[1]||{};e._inner=1}else{b=c;a=b.find("input.ajax-form-submit").first();e=b.serializeArray();e.push({name:"_inner",value:1})}var h=App.getAjaxButtonFamily(a);var f=App.findClassType(a,"type-")[1];var g=App.findClassType(a,"do-")[1];var k=App.findClassType(a,"popup-")[0]||("popup-"+(f?f+"_":"")+g);var j=$("#"+k);console.log("onAjaxPopupClick found family ["+h.family+"]");console.log("onAjaxPopupClick found popup ["+k+"]");console.log("onAjaxPopupClick found popup ["+j+"]");if(h&&h["on-popup-verify"]){if(!h["on-popup-verify"].call(a)){App.onAjaxPopupClose.call(j);return false}}j.data("elButton",a).data("params",e).data("btnFamily",h);App.reinitAjaxPopupData(j);App.setAjaxPopupState(j,null);App.setAjaxPopupStatus(j,"");App.onAjaxPopupLoad(j);return false};App.reinitAjaxPopupData=function(a){console.log("reinitAjaxPopupData ["+a.attr("id")+"]");a.data("elForm",a.find("form").first()).data("elStatus",a.find(".status-bar").first()).data("elInfo",a.find(".info-bar").first()).data("elOK",a.parent().find("div.ui-dialog-buttonpane .ui-button-text").first()).data("action",a.find("form").attr("action"));return a};App.onAjaxPopupLoad=function(a){App.setAjaxPopupState(a,"is-load");var e=a.data("btnFamily");var b=a.data("elForm");var f=a.data("params");var c=App.classToURL(App.findClassType(b,"on-popup-load-")[1])||(b.hasClass("on-popup-do-reload")&&("/part/"+e.btn_target+"/popup/"+e.btn_event))||b.find("input[name=ajax-is-load]").val()||e["ajax-is-load"];if(c){console.log("onAjaxPopupLoad found loader url ["+c+"]");$.ajax({type:"POST",url:c,data:f,dataType:"html",timeout:20000,context:this,cache:false,success:function(g,h,j){App.onAjaxPopupLoadSuccess.apply(this,[a,g,h,j])},error:function(j,h,g){App.onAjaxPopupLoadFailure.apply(this,[a,j,h,g])}})}else{App.onAjaxPopupFill(a)}};App.onAjaxPopupLoadSuccess=function(a,c,b,f){console.log("onAjaxPopupLoadSuccess []["+b+"]["+f+"]");var e=App.parseAjaxResponse(c);if(e.error_code){App.onAjaxPopupLoadFailure.call(this,f,b,undefined,e);return}a.data("elForm").html(e.html_response);App.reinitAjaxPopupData(a);App.onAjaxPopupFill(a)};App.onAjaxPopupLoadFailure=function(a,f,b,c,g){console.log("onAjaxPopupLoadFailure ["+f+"]["+b+"]["+c+"]");var e=g||App.parseAjaxResponse(f.responseText);if(e&&e.error_code){console.log("onAjaxPopupLoadFailure found error_code: ["+e.error_code+"]["+e.error_message+"]")}};App.onAjaxPopupFill=function(a){App.setAjaxPopupState(a,"is-fill");var e=a.data("btnFamily");var b=a.data("elForm");var f=a.data("params");var c=App.classToURL(App.findClassType(b,"on-popup-fill-")[1])||b.find("input[name=ajax-is-fill]").attr("value")||e["ajax-is-fill"];if(c){console.log("onAjaxPopupFill found filler url ["+c+"]");$.ajax({type:"POST",url:c,data:f,dataType:"json",timeout:20000,context:this,cache:false,success:function(g,h,j){App.onAjaxPopupFillSuccess.apply(this,[a,g,h,j])},error:function(j,h,g){App.onAjaxPopupFillFailure.apply(this,[a,j,h,g])}})}else{App.onAjaxPopupInit(a)}};App.onAjaxPopupFillSuccess=function(a,c,b,f){console.log("onAjaxPopupFillSuccess ["+c+"]["+b+"]["+f+"]");var e=App.parseAjaxResponse(c);if(e.error_code){App.onAjaxPopupFillFailure.call(this,f,b,undefined,e);return}$.extend(a.data("params"),e.html_response);App.onAjaxPopupInit(a)};App.onAjaxPopupFillFailure=function(a,f,b,c,g){console.log("onAjaxPopupFillFailure ["+f+"]["+b+"]["+c+"]");var e=g||App.parseAjaxResponse(f.responseText);if(e&&e.error_code){console.log("onAjaxPopupFillFailure found error_code: ["+e.error_code+"]["+e.error_message+"]")}};App.onAjaxPopupInit=function(a){App.setAjaxPopupState(a,"is-init");App.initForm(a.data("params"),a.data("elForm"),a);App.initCallbacks(a);App.setAjaxPopupState(a,"is-display");a.dialog("open")};App.onAjaxPopupClose=function(){console.log("onAjaxPopupClose ["+this+"]");var a=$(this);App.setAjaxPopupState(a,null);App.unsetAjaxPopupBusy(a);return true};App.onAjaxPopupCancel=function(){console.log("onAjaxPopupCancel ["+this+"]");$(this).dialog("close")};App.onAjaxPopupSubmit=function(){console.log("onAjaxPopupSubmit ["+this+"]");var a=$(this);var b=a.data("elForm");if(!b){App.onAjaxPopupSuccess()}if(App.validateForm(b,a)){return}if(b.attr("action").match(/publish(H|N)ow/)&&DailyKos.Metrics!==undefined){DailyKos.Metrics.track("Published Story")}App.setAjaxPopupState(a,"is-busy");App.setAjaxPopupBusy(a);$.ajax({type:"POST",url:b.attr("action"),data:b.serializeArray(),dataType:"html",timeout:20000,context:this,cache:false,success:App.onAjaxPopupSuccess,error:App.onAjaxPopupFailure,complete:App.onAjaxPopupComplete})};App.onAjaxPopupSuccess=function(c,b,g){console.log("onAjaxPopupSuccess ["+b+"]["+g+"]");var a=$(this);var f=App.parseAjaxResponse(c);if(f&&f.error_code){App.onAjaxPopupFailure.call(this,g,b,undefined,f);return}App.setAjaxPopupState(a,"is-success",f,b,g);App.unsetAjaxPopupBusy(a);a.dialog("close");var e=App.getAjaxButtonFamily(a);if(e&&e["on-popup-success"]){e["on-popup-success"].call(this,f,b,g)}return};App.onAjaxPopupFailure=function(f,b,c,g){console.log("onAjaxPopupFailure ["+f+"]["+b+"]["+c+"]");var a=$(this);var e=g||App.parseAjaxResponse(f.responseText);if(e&&e.error_code){console.log("onAjaxPopupFailure found error_code: ["+e.error_code+"]["+e.error_message+"]")}App.setAjaxPopupState(a,"is-failure",f,b,c,e);App.unsetAjaxPopupBusy(a);App.setAjaxPopupStatus(a,'<div class="error">'+((e&&e.error_message)||c)+"</div>");return};App.setAjaxPopupBusy=function(a){var b=a.data("elOK");if(!b){return}b.data("orig_html",b.html());b.html("...")};App.unsetAjaxPopupBusy=function(b){var c=b.data("elOK");if(!c){return}var a=c.data("orig_html");if(a){c.html(a)}c.data("orig_html",undefined)};App.setAjaxPopupStatus=function(a,b,e){var c=a.data("elStatus");if(!c){return}c.html(b);if(e){c.addClass("ui-state-highlight");setTimeout(function(){c.removeClass("ui-state-highlight",1500)},500)}};App.addAjaxPopupStatus=function(a,b){var c=a.data("elStatus");if(!c){return}c.html(c.html()+" "+b)};App.onAjaxButtonTab=function(){console.log("clicked [onAjaxButtonTab]");var a=$(this);a.closest("div.ajax-tabbed").find(".ajax-tab-panel").removeClass("on").addClass("off");a.parent().removeClass("off").addClass("on");a.blur();return false};App.onAjaxButtonCollapse=function(){console.log("clicked [onAjaxButtonCollapse]");var a=$(this);a.parent("div.collapsable-panel").toggleClass("collapsed");a.blur();kck.set_coll_pref(a.parent());return false};App.onAjaxButtonFormTab=function(){console.log("clicked [onAjaxButtonFormTab]");var a=$(this);a.closest("div.ajax-form-tabbed").children(".ajax-tab-panel").hide();a.blur();var b=$(a.val());App.reloadAjaxPanel(b,null);return false};App.onAjaxButtonFormSubmit=function(){console.log("clicked [onAjaxButtonFormSubmit]");var a=$(this);a.blur();var b=a.closest("div.ajax-form-panel").children("div.ajax-form-results").first();App.reloadAjaxPanel(b,null,a);return false};App.onAjaxButtonRadioTab=function(){console.log("clicked [onAjaxButtonRadioTab]");var a=$(this).closest(".ajax-radio-panel");$(this).closest(".ajax-radio-panel-group").find(".ajax-radio-panel").not(a).find(".ajax-radio-panel-content").fadeTo("slow",0.5).find("input:enabled:not(.ajax-radio-panel-button),select").attr("disabled","disabled");a.find(".ajax-radio-panel-content").fadeTo("fast",1).find("input:disabled:not(.ajax-radio-panel-button),select").removeAttr("disabled");return true};App.reloadAjaxPanel=function(a,e,b,f){console.log("reloadAjaxPanel");console.log("reloadAjaxPanel ["+a+"]["+e+"]["+b+"]["+f+"]");App.hideAllTooltips();if(a&&a.hasClass("ajax-delay-load")&&(e=e||a.children("a.ajaxON.do-delay-load")||a.find("a.ajaxON.do-delay-load"))&&e.attr("href")){console.log("do-delay-load href is ["+e.attr("href")+"]");var c=a.height();a.html('<div style="height:'+(c||f||70)+'px"><center><img src="/i/ajax-loader.gif"/></center></div>').append(e.hide()).height(c||"auto").show();if(b){e.data("force_params",b.serializeArray())}console.log("calling click method for do-delay-load...");App.onAjaxButtonClick.call(e.get(0))}else{console.log("no do-delay-load link found for panel, aborting");a.fadeIn(400)}return false};App.reloadAjaxPanelWithHref=function(k,a,j,l,e){console.log("reloadAjaxPanelWithHref");console.log("reloadAjaxPanelWithHref ["+k+"]["+a+"]["+j+"]");App.hideAllTooltips();console.log("href is ["+a+"]");var b=App.splitURL(a);var f=b[0];var c=b[1];k.data("old_html",k.html());var g=k.height();k.html('<div style="height:'+(g||j||70)+'px"><center><img src="/i/ajax-loader.gif"/></center></div>').height(g||"auto").show();$.ajax({type:"POST",url:f,data:c,dataType:"html",timeout:20000,context:k,cache:false,success:l||App.onAjaxReloadSuccess,error:e||App.onAjaxReloadFailure});return false};App.onAjaxReloadSuccess=function(c,b,f){console.log("onAjaxReloadSuccess ["+b+"]");var a=$(this);var e=App.parseAjaxResponse(c);if(e&&e.error_code){App.onAjaxReloadFailure.call(this,f,b,undefined,e);return}a.hide().html($("<div />").append(e.html_response).html()).height("auto").fadeIn(400);App.initCallbacks(a);return a};App.onAjaxReloadFailure=function(f,b,c,g){console.log("onAjaxReloadFailure ["+b+"]["+c+"]");var e=g||App.parseAjaxResponse(f.responseText);if(e&&e.error_code){console.log("onAjaxReloadFailure found error_code: ["+e.error_code+"]["+e.error_message+"]");$(App.formatAjaxErrorResponse(f,b,c,e)).dialog({title:"Error",width:500,buttons:{OK:function(){$(this).dialog("close")}}})}var a=$(this);a.html(a.data("old_html"));return a};App.onAjaxButtonHover=function(){var a=$(this)};App.onAjaxButtonClick=function(){console.log("onAjaxButtonClick ["+this+"]");var a=$(this);var b=App.getAjaxButtonFamily(a);App.setAjaxButtonState(a,"is-busy");a.blur();App.setAjaxButtonBusy(a);var e=App.splitURL(a.attr("href"));var c=e[0];if(/^#$/.test(c)){c=undefined}var f=e[1];if(!c){c=b.action}var g=a.data("force_params");if(g){f=g;a.data("force_params",undefined)}a.data("action",c);a.data("params",f);if(c&&c=="NOOP"){App.unsetAjaxButtonBusy(a);App.setAjaxButtonState(a,"is-success")}else{if(c){$.ajax({type:"POST",url:c,data:f,dataType:"html",timeout:20000,context:this,cache:false,success:App.onAjaxButtonSuccess,error:App.onAjaxButtonFailure})}}return false};App.onAjaxButtonSuccess=function(b,a,e){console.log("onAjaxButtonSuccess ["+a+"]");var c=App.parseAjaxResponse(b);if(c&&c.error_code){App.onAjaxButtonFailure.call(this,e,a,undefined,c);return}App.unsetAjaxButtonBusy($(this));App.setAjaxButtonState($(this),"is-success",c,a,e)};App.onAjaxButtonFailure=function(e,a,b,f){console.log("onAjaxButtonFailure ["+a+"]["+b+"]");var c=f||App.parseAjaxResponse(e.responseText);if(c&&c.error_code){console.log("onAjaxButtonFailure found error_code: ["+c.error_code+"]["+c.error_message+"]");$(App.formatAjaxErrorResponse(e,a,b,c)).dialog({title:"Error",width:500,buttons:{OK:function(){$(this).dialog("close")}}})}App.unsetAjaxButtonBusy($(this));App.setAjaxButtonState($(this),"is-failure",e,a,b,c)};App.setAjaxButtonBusy=function(b){console.log("setAjaxButtonBusy ["+b+"]");var a=$("#dk4-busybox");if(!a.length){$("#main").append('<img id="dk4-busybox" class="busybox" src="/i/ajax-loader.gif" />');a=$("#dk4-busybox").offset({top:0,right:0}).hide()}b.fadeTo("fast",0.3);a.height(b.height()+0).width(b.height()+0).fadeTo("fast",0.9).offset(b.offset())};App.unsetAjaxButtonBusy=function(a){console.log("unsetAjaxButtonBusy ["+a+"]");$("#dk4-busybox").hide();a.fadeTo("fast",1)};App.onAjaxRescueSuccess=function(c,h,j,a,e){console.log("onAjaxRescueSuccess ["+h+"]["+a+"]");var g=el.data("btnFamily");if(!g){return el}var b=g.param_key;var f=el.data("params")[b];$("a.popup.do-rescue[href*='"+b+"="+f+"']").each(function(){console.log("swapping popup-rescue class for "+this);$(this).toggleClass("ajaxON popup off",false).toggleClass("go on",true).attr("href","/group/rescue").data("btnFamily",null)});return c};App.onAjaxPagerSuccess=function(c,f,g,b,e){console.log("onAjaxPagerSuccess ["+f+"]["+b+"]");App.hideAllTooltips();var a=c.closest("div.ajax-paged");if(a){a.hide().html($("<div />").append(g.html_response).find("div.ajax-paged").html()).height("auto").fadeIn(400);App.initCallbacks(a)}return c};App.onAjaxLoaderSuccess=function(c,f,g,b,e){console.log("onAjaxLoaderSuccess ["+f+"]["+b+"]");App.hideAllTooltips();var a=c.closest("div.ajax-delay-load");if(a){console.log("attempting to load panel: "+a);a.hide().html($("<div />").append(g.html_response).html()).append(c.clone().hide()).height("auto").fadeIn(400);App.initCallbacks(a)}return c};App.onAjaxStoryPreviewSuccess=function(b,c,a,j,h){var k=b.closest("div.ajax-delay-load");var e=$("#doLoadPreview");if(k&&e){console.log("attempting to reload panel: "+k+":"+e);App.reloadAjaxPanelWithHref(k,e.attr("href"),undefined,function(o,n,p){console.log("onAjaxStoryPreviewSuccess ["+n+"]");var l=App.onAjaxReloadSuccess.call(k.get(0),o,n,p);$("#main").attr("class","previewing");$("#sub").attr("class","previewing");return l})}var g=$("#main").offset().left;var f=$("#main").offset().top;window.scroll(g,f);setTimeout(function(){$("a[rel^='lightbox']").slimbox({resizeDuration:1,captionAnimationDuration:1,overlayFadeDuration:200,imageFadeDuration:200},null,function(l){return(this==l)||((this.rel.length>8)&&(this.rel==l.rel))})},1500);return b};App.onAjaxStoryEditSuccess=function(b,c,a,j,h){var k=b.closest("div.ajax-delay-load");var e=$("#doLoadEdit");if(k&&e){console.log("attempting to reload panel: "+k+":"+e);App.reloadAjaxPanelWithHref(k,e.attr("href"),undefined,function(o,n,p){var l=App.onAjaxReloadSuccess.call(k.get(0),o,n,p);var q=window.frames.image_queue;if(q){setTimeout(function(){DailyKos.ImageQueueResizer.init();DailyKos.ImageQueueResizer.setPosition();DailyKos.ImageQueueResizer.resizeQueue()},500)}$("#main").attr("class","editing");$("#sub").attr("class","editing");return l})}var g=$("#main").offset().left;var f=$("#main").offset().top;window.scroll(g,f);setTimeout(function(){$("a[rel^='lightbox']").slimbox({resizeDuration:1,captionAnimationDuration:1,overlayFadeDuration:200,imageFadeDuration:200},null,function(l){return(this==l)||((this.rel.length>8)&&(this.rel==l.rel))})},1500);return b};App.onAjaxStoryPublishSuccess=function(c,f,h,a,e){console.log("RESPONSE WAS: ");console.dir(h);var b=h&&h.request_params&&h.request_params.where;console.log("where: "+b);var g=(b=="group")?("/group/bid:"+h.request_params.blog_id):(b=="schedule")?("/user/uid:"+h.request_params.user_id+"/drafts"):("/blog/uid:"+h.request_params.user_id);console.log("redirecting to: "+g);window.location.href=g;return c};App.onAjaxStoryDeleteSuccess=function(b,c,a,j,h){var k=a&&a.request_params&&a.request_params.where;console.log("where: "+k);var l=(k=="unpublish")?"#doLoadUnpublished":"#doLoadDeleted";var e=$(l);var n=e.closest("div.ajax-delay-load");if(n&&e){console.log("attempting to reload panel: "+n+":"+e);App.reloadAjaxPanelWithHref(n,e.attr("href"));$("#main").attr("class","deleted")}var g=$("#main").offset().left;var f=$("#main").offset().top;window.scroll(g,f);return b};App.onAjaxStoryBumpSuccess=function(b,e,g,a,c){console.log("RESPONSE WAS: ");console.dir(g);var f=("/blog/bid:"+g.request_params.blog_id);console.log("redirecting to: "+f);window.location.href=f;return b};App.verifyStoryTags=function(a){console.log("attempting verifyStoryTags");if(!$("#tagInput").val()){console.log("verifyStoryTags: no tags found");App.popupAlert("You must enter at least one tag before publishing this diary.");return false}return true};App.onAjaxButtonError=function(c,f,e,a,b,g){console.log("onAjaxButtonError ["+f+"]["+a+"]["+b+"]");return c};App.setAjaxButtonState=function(e,b){console.log("setAjaxButtonState ["+e+"]["+b+"]");App.resetClassType(e,"is-",b);if(!b){return e}var g=App.getAjaxButtonFamily(e);if(!g){return e}var h=g["msg-"+b];if(h){App.setStatusMessage(h,e)}var f=g["err-"+b];if(f){App.setErrorMessage(f,e)}var a=g["on-"+b];if(a){console.log("setAjaxButtonState calling "+b+" callback")}if(a){a.apply(this,arguments)}var a=g["update-"+b];if(a){console.log("setAjaxButtonState trying to update "+a)}if(a){App.reloadAjaxPanel($(a))}var c=g["dur-"+b];if(c){setTimeout(function(){App.setAjaxButtonState(e,null)},c)}return e};App.setAjaxPopupState=function(k,c){console.log("setAjaxPopupState ["+k+"]["+c+"]");App.resetClassType(k,"is-",c);var a=k.data("elButton");if(!c){App.resetClassType(a,"is-",null);return k}var e=App.getAjaxButtonFamily(k);if(!e){return k}var g=e["btn-"+c];if(g){App.resetClassType(a,"is-",g)}var f=e["msg-"+c];if(f&&k.data("elStatus")){k.data("elStatus").html(f);App.setStatusMessage(f,a)}var h=e["err-"+c];if(h){App.setErrorMessage(h,k)}var j=e["on-"+c];if(j){console.log("setAjaxPopupState calling "+c+" callback")}if(j){j.apply(this,arguments)}var j=e["update-"+c];if(j){console.log("setAjaxButtonState trying to update "+j)}if(j){App.reloadAjaxPanel($(j))}var b=e["dur-"+c];if(b){setTimeout(function(){App.setAjaxPopupState(k,null);App.resetClassType(a,"is-",null)},b)}return k};App.toggleAjaxButtonFamily=function(f){console.log("toggleAjaxButtonFamily ["+f+"]");var e=f.data("btnFamily");if(!e){return f}var b=new App.AjaxButtonFamily(f,e.toggle_family);if(!b){return f}var p=e.family;var k=e.btn_type;var r=e.btn_target;var n=e.btn_event;var j=e.action;var c=e.flag_cls;var o=e.content;var h=f.data("params")||{};var a=e.param_key;var l=h[a];var q="[href*='"+a+"="+l+"']";var g="/ajax/"+b.btn_target+"/"+b.btn_event;console.log("toggleAjaxButtonFamily using family ["+e.family+"] --> ["+e.toggle_family+"]");console.log("...will swap ["+k+"] --> ["+b.btn_type+"]");console.log("...will swap [do-"+n+"] --> [do-"+b.btn_event+"]");console.log("...will swap ["+c+"] --> ["+b.flag_cls+"]");console.log("...will swap ["+j+"] --> ["+g+"]");console.log("Content: "+o);$("a.ajaxON."+(r?"type-"+r+".":"")+"do-"+n+"."+q+", a.ajaxON-popup."+(r?"type-"+r+".":"")+"do-"+n+"."+q).each(function(){console.log("swapping button class (type/do based) for "+this);var s=$(this);s.removeClass("do-"+n).addClass("do-"+b.btn_event).removeClass(c).addClass(b.flag_cls).attr("href",$.param.querystring(g,s.attr("href"))).data("btnFamily",null);if(b.btn_type){s.removeClass(k).addClass(b.btn_type).unbind("click");if(s.hasClass("ajaxON")){s.click(App.onAjaxButtonClick)}else{if(s.hasClass("ajaxON-popup")){s.click(App.onAjaxPopupClick)}}}console.log(s.attr("class"));if(s.hasClass("do-updateContent")){s.html(o)}});return f};App.refreshOnSuccess=function(a){console.log("refreshOnSuccess");window.location.reload(true);return a};App.AjaxButtonFamily=function(a,e,b){console.log("AjaxButtonFamily ["+a+"]["+a.attr("href")+"]");if(!b){b={}}var c=App.splitURL(a.attr("href"));if(/^#$/.test(c[0])){c[0]=undefined}if(!b.action){b.action=c[0]}if(!b.params){b.params=c[1]}var f=App.getAjaxButtonFamilyNameFromString(a,b,e)||App.getAjaxButtonFamilyNameFromAction(a,b)||App.getAjaxButtonFamilyNameFromID(a,b)||App.getAjaxButtonFamilyNameFromClass(a,b);console.log("AjaxButtonFamily using name ["+f+"]");$.extend(this,ajaxButtonFamilyDefaults,(ajaxButtonFamilies[f]||{}),b);if(!this.family){this.family=f}if(!this.action){this.action="/ajax/"+this.btn_target+"/"+this.btn_event}if(!this.params){this.params={}}if(!this.param_key){this.param_key=this.btn_target+"_id"}};App.getAjaxButtonFamilyNameFromString=function(b,c,e){if(!e){return undefined}console.log("getAjaxButtonFamilyNameFromString ["+b+"]["+c+"]["+e+"]");var a=e.match(/^([a-zA-Z0-9]+)_([a-zA-Z0-9\\-\\_]+)$/)||[];if(!c.btn_target){c.btn_target=a[1]}if(!c.btn_event){c.btn_event=a[2]}return e};App.getAjaxButtonFamilyNameFromID=function(a,b){console.log("getAjaxButtonFamilyNameFromID ["+a+"]["+b+"]");var c=App.findIDType(a,"popup-")[1]||App.findIDType(a,"do-")[1];return App.getAjaxButtonFamilyNameFromString(a,b,c)};App.getAjaxButtonFamilyNameFromAction=function(b,c){console.log("getAjaxButtonFamilyNameFromAction ["+b+"]["+c+"]");if(!c.action){return undefined}var a=c.action.match(/^\/ajax\/([a-zA-Z0-9]+)\/([a-zA-Z0-9\\-\\_]+)$/)||[];if(!c.btn_target){c.btn_target=a[1]}if(!c.btn_event){c.btn_event=a[2]}if(!c.btn_event){return undefined}if(!c.btn_target){return c.btn_event}return c.btn_target+"_"+c.btn_event};App.getAjaxButtonFamilyNameFromClass=function(a,b){console.log("getAjaxButtonFamilyNameFromClass ["+a+"]["+b+"]");if(!b.btn_target){b.btn_target=App.findClassType(a,"type-")[1]}if(!b.btn_event){b.btn_event=App.findClassType(a,"do-")[1]}if(!b.btn_event){return undefined}if(!b.btn_target){return b.btn_event}return b.btn_target+"_"+b.btn_event};App.getAjaxButtonFamily=function(a,e,c){console.log("getAjaxButtonFamily ["+a+"]["+e+"]");var b=a.data("btnFamily");if(!b){b=new App.AjaxButtonFamily(a,e,c);a.data("btnFamily",b)}return b};var ajaxButtonFamilyDefaults={family:undefined,btn_type:undefined,btn_target:undefined,btn_event:undefined,param_key:undefined,flag_cls:undefined,toggle_family:undefined,"msg-is-busy":"Working...","msg-is-success":"Action complete","msg-is-failure":"An error occurred","msg-is-timeout":"An error when connecting to the server","dur-is-success":1000,"dur-is-failure":5000,"title-is-display":undefined,"info-is-display":undefined,"msg-is-display":undefined,"ajax-is-load":undefined,"ajax-is-fill":undefined,"on-is-init":undefined,"on-is-busy":undefined,"on-is-success":undefined,"on-is-failure":App.onAjaxButtonError,"update-is-success":undefined,"btn-is-load":"is-busy","btn-is-fill":"is-busy","btn-is-init":"is-busy","btn-is-display":"is-disabled","btn-is-success":"is-success","btn-is-failure":"is-failure","btn-is-timeout":"is-timeout",debug:true};var ajaxButtonFamilies={"page-prev":{action:undefined,"msg-is-hover":"Prev Page","on-is-success":App.onAjaxPagerSuccess},"page-next":{action:undefined,"msg-is-hover":"Next Page","on-is-success":App.onAjaxPagerSuccess},"page-load":{action:undefined,"msg-is-hover":"Reload","on-is-success":App.onAjaxPagerSuccess},"delay-load":{action:undefined,"msg-is-hover":"Load","on-is-success":App.onAjaxLoaderSuccess},story_preview:{action:"NOOP","msg-is-hover":"Preview Diary",toggle_family:"story_edit",param_key:"story_id",flag_cls:"off",btn_type:"ajaxON","on-is-success":function(a){console.log("attempting story_preview");kst.preview_diary();return a}},story_edit:{action:"NOOP","msg-is-hover":"Edit Diary",toggle_family:"story_preview",param_key:"story_id",flag_cls:"off",btn_type:"ajaxON","on-is-success":function(a){console.log("attempting story_edit");kst.edit_diary();return a}},story_addRating:{"ajax-is-load":"/part/story/popup/addRating",action:"/ajax/story/addRating","on-is-success":App.toggleAjaxButtonFamily,"update-is-success":"#users-recommending",toggle_family:"story_removeRating",param_key:"story_id",flag_cls:"off",btn_type:"ajaxON","msg-is-hover":"Recommend this diary","msg-is-busy":"Recommending this diary...","msg-is-success":"You have recommended this diary"},story_removeRating:{"ajax-is-load":"/part/story/popup/removeRating",action:"/ajax/story/removeRating","on-is-success":App.toggleAjaxButtonFamily,"update-is-success":"#users-recommending",toggle_family:"story_addRating",param_key:"story_id",flag_cls:"on",btn_type:"ajaxON-popup","msg-is-hover":"Unrecommend this diary","msg-is-busy":"Unrecommending this diary...","msg-is-success":"You have unrecommended this diary"},story_hotlist:{"ajax-is-load":"/part/story/popup/hotlist",action:"/ajax/story/hotlist","on-is-success":App.toggleAjaxButtonFamily,toggle_family:"story_unHotlist",param_key:"story_id",flag_cls:"off","msg-is-hover":"Add the story to your hotlist","msg-is-busy":"Adding the story to your hotlist...","msg-is-success":"The story has been added to your hotlist"},story_unHotlist:{"ajax-is-load":"/part/story/popup/unHotlist",action:"/ajax/story/unHotlist","on-is-success":App.toggleAjaxButtonFamily,"update-is-success":"#fav-stories",toggle_family:"story_hotlist",param_key:"story_id",flag_cls:"on","msg-is-hover":"Remove the story from your hotlist","msg-is-busy":"Removing the story from your hotlist...","msg-is-success":"The story has been removed from your hotlist"},story_addNote:{"ajax-is-load":"/part/story/popup/addNote",action:"/ajax/story/addNote",param_key:"story_id","update-is-success":"#fav-stories, #blog-queue","msg-is-hover":"Add a note to this diary","msg-is-busy":"Adding note...","msg-is-success":"You have added a note to this diary"},story_update:{"ajax-is-load":"/part/story/popup/update",action:"/ajax/story/update","update-is-success":"#storyWrapper","msg-is-hover":"Update this diary","msg-is-busy":"Updating story...","msg-is-success":"You have updated this diary"},story_delete:{"ajax-is-load":"/part/story/popup/delete",action:"/ajax/story/delete","update-is-success":"#blog-queue","msg-is-hover":"Delete this diary","msg-is-busy":"Deleting story...","msg-is-success":"You have deleted this diary"},story_deleteHow:{"ajax-is-load":"/part/story/popup/deleteHow",action:"/ajax/story/deleteHow","on-is-success":App.onAjaxStoryDeleteSuccess,"msg-is-hover":"Delete this diary","msg-is-busy":"Deleting story...","msg-is-success":"You have deleted this diary"},story_bumpHow:{"ajax-is-load":"/part/story/popup/bumpHow",action:"/ajax/story/bumpHow","on-is-success":App.onAjaxStoryBumpSuccess,"msg-is-hover":"Update timestamp for this diary","msg-is-busy":"Updating timestamp...","msg-is-success":"You have updated the timestamp for this diary"},story_tagVersions:{"ajax-is-load":"/part/story/popup/tagVersions","msg-is-hover":"Show all versions of tags since diary publish"},story_rescue:{"ajax-is-load":"/part/story/popup/rescue",action:"/ajax/story/rescue",toggle_family:"story_unRescue",param_key:"story_id",flag_cls:"off","msg-is-hover":"Rescue this diary","msg-is-busy":"Rescuing story...","msg-is-success":"You have rescued this diary"},story_unRescue:{"ajax-is-load":"/part/story/popup/unRescue",action:"/ajax/story/unRescue",toggle_family:"story_rescue",param_key:"story_id",flag_cls:"on","msg-is-hover":"Unrescue this diary","msg-is-busy":"Unrescuing story...","msg-is-success":"You have unrescued this diary"},story_addBlogQueue:{"ajax-is-load":"/part/story/popup/addBlogQueue",action:"/ajax/story/addBlogQueue","on-popup-success":function(c,a,b){App.popupAlert('The diary has been added to the group\'s queue. <a style="color:#E5721E;font-weight:bold" href="/group/bid:'+c.request_params.blog_id+'">Go to the queue</a> to publish or schedule a time for the diary to appear.');return false},"msg-is-hover":"Republish this diary","msg-is-busy":"Republishing this diary...","msg-is-success":"You have republished this diary"},story_setPriority:{"ajax-is-load":"/part/story/popup/setPriority",action:"/ajax/story/setPriority",param_key:"story_id","update-is-success":"#blog-queue","msg-is-hover":"Alter the queue priority for this diary","msg-is-busy":"Changing priority...","msg-is-success":"You changed the queue priority for this diary"},story_schedule:{"ajax-is-load":"/part/story/popup/schedule",action:"/ajax/story/schedule","update-is-success":"#blog-queue","msg-is-hover":"Schedule this diary","msg-is-busy":"Scheduling this diary...","msg-is-success":"You have scheduled this diary for publication"},story_publish:{"ajax-is-load":"/part/story/popup/publish",action:"/ajax/story/publish","msg-is-hover":"Publish this diary","msg-is-busy":"Publishing this diary...","msg-is-success":"You have republished this diary"},story_publishHow:{"ajax-is-load":"/part/story/popup/publishHow",action:"/ajax/story/publishHow","on-popup-verify":App.verifyStoryTags,"on-is-success":App.onAjaxStoryPublishSuccess,"msg-is-hover":"Publish this diary","msg-is-busy":"Publishing story...","msg-is-success":"You have published this diary"},story_publishChanges:{"ajax-is-load":"/part/story/popup/publishChanges",action:"/ajax/story/edit","on-is-success":App.onAjaxStoryPublishSuccess,"msg-is-hover":"Publish changes","msg-is-busy":"Publishing changes...","msg-is-success":"You have published your changes to this diary"},story_publishNow:{"ajax-is-load":"/part/story/popup/publishNow",action:"/ajax/story/publishNow","update-is-success":"#blog-queue","msg-is-hover":"Publish this diary","msg-is-busy":"Publishing story...","msg-is-success":"You have published this diary"},story_removeFromBlog:{"ajax-is-load":"/part/story/popup/removeFromBlog",action:"/ajax/story/removeFromBlog","update-is-success":"#blog-queue","msg-is-hover":"Remove this diary from this blog","msg-is-busy":"Removing story...","msg-is-success":"You have removed this diary"},story_addQueueNote:{"ajax-is-load":"/part/story/popup/addQueueNote",action:"/ajax/story/addQueueNote","update-is-success":"#blog-queue","msg-is-hover":"Add a queue note to this story","msg-is-busy":"Adding queue note...","msg-is-success":"You have added this queue note"},story_setSticky:{"ajax-is-load":"/part/story/popup/setSticky",action:"/ajax/story/setSticky","update-is-success":"#blog-queue","msg-is-hover":"Set stickiness of this feature","msg-is-busy":"Setting stickiness...","msg-is-success":"Action complete"},story_setStickyQueue:{"ajax-is-load":"/part/story/popup/setStickyQueue",action:"/ajax/story/setStickyQueue","update-is-success":"#blog-queue","msg-is-hover":"Set stickiness of this diary","msg-is-busy":"Setting stickiness...","msg-is-success":"Action complete"},story_setTags:{"ajax-is-load":"/part/story/popup/setTags",action:"/ajax/story/setTags","msg-is-hover":"Set tags for this diary","msg-is-busy":"Editing tags...","msg-is-success":"Tags edited"},comment_addRating:{"ajax-is-load":"/part/comment/popup/addRating",action:"/ajax/comment/addRating","on-is-success":App.toggleAjaxButtonFamily,toggle_family:"comment_removeRating",param_key:"comment_id",flag_cls:"off","msg-is-hover":"Recommend this comment","msg-is-busy":"Recommending this comment...","msg-is-success":"You have recommended this comment"},comment_removeRating:{"ajax-is-load":"/part/comment/popup/removeRating",action:"/ajax/comment/removeRating","on-is-success":App.toggleAjaxButtonFamily,toggle_family:"comment_addRating",param_key:"comment_id",flag_cls:"on","msg-is-hover":"Unrecommend this comment","msg-is-busy":"Unrecommending this comment...","msg-is-success":"You have unrecommended this comment"},comment_hotlist:{"ajax-is-load":"/part/comment/popup/hotlist",action:"/ajax/comment/hotlist","on-is-success":App.toggleAjaxButtonFamily,toggle_family:"comment_unHotlist",param_key:"comment_id",flag_cls:"off","msg-is-hover":"Add the comment to your hotlist","msg-is-busy":"Adding the comment to your hotlist...","msg-is-success":"The comment has been added to your hotlist"},comment_unHotlist:{"ajax-is-load":"/part/comment/popup/unHotlist",action:"/ajax/comment/unHotlist","on-is-success":App.toggleAjaxButtonFamily,"update-is-success":"#fav-comments",toggle_family:"comment_hotlist",param_key:"comment_id",flag_cls:"on","msg-is-hover":"Remove the comment from your hotlist","msg-is-busy":"Removing the comment from your hotlist...","msg-is-success":"The comment has been removed from your hotlist"},comment_addNote:{"ajax-is-load":"/part/comment/popup/addNote",action:"/ajax/comment/addNote","update-is-success":"#fav-comments","msg-is-hover":"Add a note to this comment","msg-is-busy":"Adding note...","msg-is-success":"You have added a note to this comment"},comment_delete:{"ajax-is-load":"/part/comment/popup/delete",action:"/ajax/comment/delete","msg-is-hover":"Delete this comment","msg-is-busy":"Deleting comment...","msg-is-success":"You have deleted this comment"},tag_hotlist:{"ajax-is-load":"/part/tag/popup/hotlist",action:"/ajax/tag/hotlist","on-is-success":App.toggleAjaxButtonFamily,toggle_family:"tag_unHotlist",param_key:"tag_id",flag_cls:"off","msg-is-hover":"Add the tag to your hotlist","msg-is-busy":"Adding the tag to your hotlist...","msg-is-success":"The tag has been added to your hotlist"},tag_unHotlist:{"ajax-is-load":"/part/tag/popup/unHotlist",action:"/ajax/tag/unHotlist","on-is-success":App.toggleAjaxButtonFamily,"update-is-success":"#fav-tags",toggle_family:"tag_hotlist",param_key:"tag_id",flag_cls:"on","msg-is-hover":"Remove the tag from your hotlist","msg-is-busy":"Removing the tag from your hotlist...","msg-is-success":"The tag has been removed from your hotlist"},tag_hotlistMany:{"ajax-is-load":"/part/tag/popup/hotlistMany",action:"/ajax/tag/hotlistMany","update-is-success":"#fav-tags","msg-is-hover":"Add these tags to your hotlist","msg-is-busy":"Adding tags to your hotlist...","msg-is-success":"The tags have been added to your hotlist"},tag_addNote:{"ajax-is-load":"/part/tag/popup/addNote",action:"/ajax/tag/addNote","update-is-success":"#fav-tags","msg-is-hover":"Add a note to this tag","msg-is-busy":"Adding note...","msg-is-success":"You have added a note to this tag"},tag_delete:{"ajax-is-load":"/part/tag/popup/delete",action:"/ajax/tag/delete","msg-is-hover":"Delete this tag","msg-is-busy":"Deleting tag...","msg-is-success":"You have deleted this tag"},tag_addBlog:{"ajax-is-load":"/part/tag/popup/addBlog",action:"/ajax/tag/addBlog","msg-is-hover":"Stream this tag","msg-is-busy":"Streaming this tag...","msg-is-success":"Now streaming this tag"},user_hotlist:{"ajax-is-load":"/part/user/popup/hotlist",action:"/ajax/user/hotlist","on-is-success":App.toggleAjaxButtonFamily,toggle_family:"user_unHotlist",param_key:"friend_id",flag_cls:"off",content:"Unfollow","msg-is-hover":"Add the user to your hotlist","msg-is-busy":"Adding the user to your hotlist...","msg-is-success":"The user has been added to your hotlist"},user_unHotlist:{"ajax-is-load":"/part/user/popup/unHotlist",action:"/ajax/user/unHotlist","on-is-success":App.toggleAjaxButtonFamily,"update-is-success":"#fav-users",toggle_family:"user_hotlist",param_key:"friend_id",flag_cls:"on",content:"Follow","msg-is-hover":"Remove the user from your hotlist","msg-is-busy":"Removing the user from your hotlist...","msg-is-success":"The user has been removed from your hotlist"},user_hotlistMany:{"ajax-is-load":"/part/user/popup/hotlistMany",action:"/ajax/user/hotlistMany","update-is-success":"#fav-users","msg-is-hover":"Add these authors to your hotlist","msg-is-busy":"Adding authors to your hotlist...","msg-is-success":"The authors have been added to your hotlist"},user_addNote:{"ajax-is-load":"/part/user/popup/addNote",action:"/ajax/user/addNote","update-is-success":"#fav-users","msg-is-hover":"Add a note to this user","msg-is-busy":"Adding note...","msg-is-success":"You have added a note to this user"},user_login:{"ajax-is-load":"/part/user/popup/login",action:"/ajax/user/login","on-is-success":function(){location.reload()},"msg-is-hover":"Log In","msg-is-busy":"Logging in...","msg-is-success":"You have logged in"},user_ban:{"ajax-is-load":"/part/user/popup/ban",action:"/ajax/user/ban","msg-is-hover":"Ban this user","msg-is-busy":"Banning user...","msg-is-success":"You have banned this user"},user_addBlog:{"ajax-is-load":"/part/user/popup/addBlog",action:"/ajax/user/addBlog","msg-is-hover":"Stream this user","msg-is-busy":"Streaming this user...","msg-is-success":"Now streaming this user"},group_hotlist:{"ajax-is-load":"/part/group/popup/hotlist",action:"/ajax/blog/hotlist","on-is-success":App.toggleAjaxButtonFamily,toggle_family:"group_unHotlist",param_key:"friend_id",flag_cls:"off","msg-is-hover":"Add the group to your hotlist","msg-is-busy":"Adding the group to your hotlist...","msg-is-success":"The group has been added to your hotlist"},group_unHotlist:{"ajax-is-load":"/part/group/popup/unHotlist",action:"/ajax/blog/unHotlist","on-is-success":App.toggleAjaxButtonFamily,"update-is-success":"#fav-groups, #fav-blogs",toggle_family:"group_hotlist",param_key:"friend_id",flag_cls:"on","msg-is-hover":"Remove the group from your hotlist","msg-is-busy":"Removing the group from your hotlist...","msg-is-success":"The group has been removed from your hotlist"},group_hotlistMany:{"ajax-is-load":"/part/group/popup/hotlistMany",action:"/ajax/blog/hotlistMany","update-is-success":"#fav-groups, #fav-blogs","msg-is-hover":"Add these groups to your hotlist","msg-is-busy":"Adding groups to your hotlist...","msg-is-success":"The groups have been added to your hotlist"},group_addNote:{"ajax-is-load":"/part/group/popup/addNote",action:"/ajax/blog/addNote","update-is-success":"#fav-groups, #fav-blogs","msg-is-hover":"Add a note to this group","msg-is-busy":"Adding note...","msg-is-success":"You have added a note to this group"},group_invite:{"ajax-is-load":"/part/group/popup/invite",action:"/ajax/group/invite"},group_inviteAccept:{"ajax-is-load":"/part/group/popup/inviteAccept",action:"/ajax/group/addUser","msg-is-hover":"Accept the invitation to join this group blog","msg-is-busy":"Accepting invitation...","msg-is-success":"You are now a member of this group"},group_inviteDecline:{"ajax-is-load":"/part/group/popup/inviteDecline",action:"/ajax/group/declineInvite","msg-is-hover":"Decline the invitation to join this group blog","msg-is-busy":"Declining invitation...","msg-is-success":"The invitation has been declined"},group_inviteReply:{"ajax-is-load":"/part/group/popup/inviteReply",action:"/ajax/group/inviteReply","update-is-success":"#group-memberships","msg-is-hover":"Reply to this invitation","msg-is-busy":"Sending reply...","msg-is-success":"Your reply has been sent"},group_setRole:{"ajax-is-load":"/part/group/popup/setRole",action:"/ajax/group/setRole","update-is-success":"#group-members","msg-is-hover":"Change this user's role for this group"},group_removeUser:{"ajax-is-load":"/part/group/popup/removeUser",action:"/ajax/group/removeUser","update-is-success":"#group-members","msg-is-hover":"Remove this user from the group"},group_removeSelf:{"ajax-is-load":"/part/group/popup/removeSelf",action:"/ajax/group/removeSelf","update-is-success":"#group-memberships","msg-is-hover":"Remove yourself from the group"},blog_hotlist:{"ajax-is-load":"/part/blog/popup/hotlist",action:"/ajax/blog/hotlist","on-is-success":App.toggleAjaxButtonFamily,"update-is-success":"#fav-groups, #fav-blogs",toggle_family:"blog_unHotlist",param_key:"blog_id",flag_cls:"off",content:"Unfollow","msg-is-hover":"Add the blog to your hotlist","msg-is-busy":"Adding the blog to your hotlist...","msg-is-success":"The blog has been added to your hotlist"},blog_unHotlist:{"ajax-is-load":"/part/blog/popup/unHotlist",action:"/ajax/blog/unHotlist","on-is-success":App.toggleAjaxButtonFamily,"update-is-success":"#fav-groups, #fav-blogs",toggle_family:"blog_hotlist",param_key:"blog_id",flag_cls:"on",content:"Follow","msg-is-hover":"Remove the blog from your hotlist","msg-is-busy":"Removing the blog from your hotlist...","msg-is-success":"The blog has been removed from your hotlist"},blog_addNote:{"ajax-is-load":"/part/blog/popup/addNote",action:"/ajax/blog/addNote","update-is-success":"#fav-groups, #fav-blogs","msg-is-hover":"Add a note to this blog","msg-is-busy":"Adding note...","msg-is-success":"You have added a note to this blog"}};App.initForm=function(g,c,a){console.log("initForm: ["+g+"]["+c+"]["+a+"]");console.dir(g);c.each(function(){this.reset()});for(var f in g){console.log("initForm found param ["+f+"] = ["+g[f]+"]");var b=c.find(":input[name="+f+"]").first();if(b){b.val(g[f])}}};App.validateForm=function(b,a){if(!b){return false}var c=false;var e=[];App.setAjaxPopupStatus(a,"");b.children(".is-validated").each(function(g){console.log("elField = ["+this+"]");var h=$(this);var f=undefined;$.each(h.attr("class").match(/\bvtype\-(\w+)\b/g),function(j){var k=this.replace(/^vtype\-/,"vtype_");console.log("vtype = ["+k+"]");f=f||App[k].apply(h,[b,a])});if(f){c=true;h.addClass("ui-state-error");App.addAjaxPopupStatus(a,'<div class="error">'+f+"</div>");e.push(f)}});return c};App.vtype_required=function(b,a){console.log("vtype_required ["+this+"]["+b+"]["+a+"]");if(!(this.val().length>0)){return(this.attr("name")+" is required")}return null};App.vtype_text=function(b,a){console.log("vtype_required ["+this+"]["+b+"]["+a+"]");return null};App.vtype_email=function(b,a){console.log("vtype_required ["+this+"]["+b+"]["+a+"]");if(!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(this.val())){return(this.attr("name")+" must be a valid email address")}return null};App.vtype_int=function(b,a){console.log("vtype_required ["+this+"]["+b+"]["+a+"]");if(!/^\d*$/.test(this.val())){return(this.attr("name")+" must be a number")}return null};App.vtype_pint=function(b,a){console.log("vtype_required ["+this+"]["+b+"]["+a+"]");if(!(/^\d*$/.test(this.val())&&this.val()>1)){return(this.attr("name")+" must be a number")}return null};App.popupAlert=function(b){console.log("popupAlert");var a=$("#DK4-ALERT");if(!a.size()){console.log("popupAlert: no alert found");$("#main").append('<div class="is-popup" id="DK4-ALERT" title="Alert"><div class="info-bar">&nbsp;</div><div class="status-bar">'+b+'</div><div class="content-bar"></div><div class="response-bar"></div></div>');$("#DK4-ALERT").dialog({autoOpen:true,width:400,position:"center",close:function(){App.onAjaxPopupClose();$("#DK4-ALERT").remove()},buttons:{OK:App.onAjaxPopupCancel}})}};App.parseAjaxResponse=function(a){console.log("parseAjaxResponse");if(!a){return undefined}if(!a.match(/ajax_response_type/)){return({response_raw:a,response_type:"ERROR",error_code:"UNKNOWN",error_message:"An unknown error occurred when contacting the server."})}var b=$("<div />").append(a);return({response_raw:a,response_type:b.find(".ajax_response_type").html(),error_code:b.find(".ajax_error_code").html(),error_message:b.find(".ajax_error_message").html(),html_response:b.find(".ajax_html_response").html(),json_response:$.parseJSON(b.find(".ajax_json_response").html()),request_params:App.tmp_ajax_params})};App.formatAjaxErrorResponse=function(c,a,b,e){return('<div><div class="error-bar">Error: '+e.error_message+"</div></div>")};App.splitURL=function(a){console.log("splitURL ["+a+"]");if(!a){return[undefined,{}]}else{if(a.match(/\?/)){return[(a.match(/^(.+)\?/))[1],$.deparam.querystring(a)||{}]}else{return[a,{}]}}};App.findClassType=function(a,b){if(!a||!a.attr("class")){return[]}return(a.attr("class").match(new RegExp("\\b"+b+"([a-zA-Z0-9\\-\\_]+)\\b"))||[])};App.findIDType=function(a,b){console.log("findIDType ["+a+"]["+b+"]");if(!a||!a.attr("id")){return[]}return(a.attr("id").match(new RegExp("\\b"+b+"([a-zA-Z0-9\\-\\_]+)\\b"))||[])};App.resetClassType=function(b,c,e){var a=App.findClassType(b,c)[0];if(a){b.removeClass(a)}if(e){b.addClass(e)}return b};App.toggleClass=function(b,a,c){if(b.hasClass(c)){b.removeClass(c);b.addClass(a)}else{b.removeClass(a);b.addClass(c)}return b};App.swapClass=function(b,a,c){if(b.hasClass(c)){b.removeClass(c);b.addClass(a)}else{if(b.hasClass(a)){b.removeClass(a);b.addClass(c)}}return b};App.classToURL=function(a){if(a){return("/"+a.replace(/\-/g,"/"))}return null};App.setStatusMessage=function(b,a){console.log(b);window.status=b};App.setErrorMessage=function(b,a){console.log(b.msg);window.status=b.msg};function doDefaultFocus(a){if(a.value==a.defaultValue){a.value=""}}function doDefaultBlur(a){if(a.value==""){a.value=a.defaultValue}}jQuery.fn.prettyCheckboxes=function(a){a=jQuery.extend({checkboxWidth:17,checkboxHeight:17,className:"prettyCheckbox",display:"list"},a);$(this).each(function(){$label=$('label[for="'+$(this).attr("id")+'"]');$label.prepend("<span class='holderWrap'><span class='holder'></span></span>");if($(this).is(":checked")){$label.addClass("checked")}$label.addClass(a.className).addClass($(this).attr("type")).addClass(a.display);$label.find("span.holderWrap").width(a.checkboxWidth).height(a.checkboxHeight);$label.find("span.holder").width(a.checkboxWidth);$(this).addClass("hiddenCheckbox");$label.bind("click",function(){$("input#"+$(this).attr("for")).triggerHandler("click");if($("input#"+$(this).attr("for")).is(":checkbox")){$(this).toggleClass("checked");$("input#"+$(this).attr("for")).checked=true;$(this).find("span.holder").css("top",0)}else{$toCheck=$("input#"+$(this).attr("for"));$('input[name="'+$toCheck.attr("name")+'"]').each(function(){$('label[for="'+$(this).attr("id")+'"]').removeClass("checked")});$(this).addClass("checked");$toCheck.checked=true}});$("input#"+$label.attr("for")).bind("keypress",function(b){if(b.keyCode==32){if($.browser.msie){$('label[for="'+$(this).attr("id")+'"]').toggleClass("checked")}else{$(this).trigger("click")}return false}})})};checkAllPrettyCheckboxes=function(b,a){if($(b).is(":checked")){$(a).find("input[type=checkbox]:not(:checked)").each(function(){$('label[for="'+$(this).attr("id")+'"]').trigger("click");if($.browser.msie){$(this).attr("checked","checked")}else{$(this).trigger("click")}})}else{$(a).find("input[type=checkbox]:checked").each(function(){$('label[for="'+$(this).attr("id")+'"]').trigger("click");if($.browser.msie){$(this).attr("checked","")}else{$(this).trigger("click")}})}};$(document).ready(function(){$("#main").delegate("a.post-comment","click",function(){var a=$("#comments").children("#rateAllForm").children("ul.cm.i0");if($(this).attr("id")=="postBot"){a.append($("#e"))}else{a.prepend($("#e"))}$("#e").slideToggle("fast");$("#eSubject").focus();return false});$("#comments").delegate("a.post-reply","click",function(){$(this).parent().after($("#e"));$("#e").slideToggle("fast");$("#eP").hide();$("#previewSubject").html("");$("#previewComment").html("");$("#eSubject").val("");$("#eComment").val("");$("#eSubject").focus();return false});$("#eCancelButton").live("click",function(){if($("#eSubject").val()||$("#eComment").val()){if(!confirm("Are you sure you want to abandon this comment?")){return false}}kos.cancel_comment();return false});$("#eHelpButton").live("click",function(){$("#eHelp").load("/help/commentEditorHelp.html");$("#eHelp").slideToggle("fast");return false});$("#comments").delegate("a.de","click",function(b){var a=$(this).parent().parent().parent();kos.shrink_comment(a,b)});$("#comments").delegate("a.dc","click",function(b){var a=$(this).parent().parent().parent();kos.expand_comment(a,b);return false});$("#eBold").click(function(){kos.format_button("#eComment","bold");return false});$("#eItalic").click(function(){kos.format_button("#eComment","italic");return false});$("#eBlockquote").click(function(){kos.format_button("#eComment","blockquote");return false});$("#eLinkButton").click(function(){$("#eLink").toggle();$("#eLinkLabel").val(kos.get_selected_text("#eComment"));return false});$("#eAddLink").click(function(){kos.format_button("#eComment","link");$("#eLink").css("display","none");$("#eLinkImage").removeAttr("checked");return false});$("#ePButton").click(function(){if(kos.str_chk($("#eComment").val(),kos.C_STRING_MAXLENGTH)){return false}var e=$("#eP");kos.enable_preview();$("#e").before(e);e.slideDown("fast");e.attr("display","block");var f=e.children();f.attr("style","display: block");var h=$("#previewConfirm");h.attr("style","display: block;");var j=$("#e").parent().parent().attr("id");var g;var c;if(j=="comments"||j=="rateAllForm"){g=0;c=0}else{g=j.substr(2);c=$("#eP").parent().parent().parent().attr("id").substr(1)}$("#previewComment").before('<span class="busy" id="preBusy" title="We\'re talking to the server. You don\'t need to wait for us to finish." style="display: none;"></span>');setTimeout(function(){if($("#preBusy").length){$("#preBusy").html('<span class="bbi"><img src="'+kos.IMAGE_HOST+'/i/ajax-loader.gif" /></span><span class="bbc">Previewing...</span>');$("#preBusy").fadeIn()}},500);kos.kojax_post("/comment/"+kos.story_id+"/"+g+"/preview.json",{subject:$("#eSubject").val(),comment:$("#eComment").val(),story_id:kos.story_id,parent_id:g,pid:c,sid:kos.sid,posttype:"html"},function(k){$("#previewSubject").html(k.pre_comment.subject);$("#previewComment").html(k.pre_comment.comment_text);$("#preBusy").fadeOut();$("#preBusy").remove()},"json",function(o){kos.disable_preview();var n="";kos.disable_preview();if(o.status>=500&&o.getResponseHeader("content-type")=="text/html"){n="Server has gone away. This is a transient error, so just try previewing your comment again in a moment."}else{var l=$.parseJSON(o.responseText);n=l.error}if(n){kos.dialog_box("There was an error previewing your comment:\n"+n,"Ooops")}else{kos.dialog_box("Oh no! Something went wrong trying to preview your comment. Don't worry though; it's probably a transient error. Please try again.","Ooops")}$("#preBusy").fadeOut();$("#preBusy").remove()});if($("#previewComment").html()){var b=$("#eP").offset().left;var a=$("#eP").offset().top;window.scroll(b,a)}return false});$("#eComment").keypress(function(){kos.disable_preview()});$("#eSubject").keypress(function(){kos.disable_preview()});$("#ePostButton").click(function(){if(kos.str_chk($("#eComment").val(),kos.C_STRING_MAXLENGTH)){return false}var g=$("#e").parent().parent().attr("id");var f;var b;if(g=="comments"||g=="rateAllForm"){f=0;b=0}else{f=g.substr(2);b=$("#eP").parent().parent().parent().attr("id").substr(1)}var e=kos.story_id;var a=kos.sid;var c=$("#eSubject").val();var h=$("#eComment").val();$("#ePostButton").attr("disabled","disabled");$("#eP").slideUp("fast");$("#e").slideUp("fast");$("#e").before('<span id="addComm" class="busy" title="We are talking to the server. You don\'t need to worry about anything."><span class="bbi"><img src="'+kos.IMAGE_HOST+'/i/ajax-loader.gif" /></span><span class="bbc">Posting comment...</span></span>');kos.kojax_post("/ajax/comment/addComment",{subject:c,comment_text:h,story_id:e,parent_id:f,pid:b,sid:a,posttype:"html"},kos.comment_success,kos.comment_fail);return false});kos.USE_AUTOREFRESH=kos.use_auto_refresh();$("#autoRefresh").click(function(){kos.USE_AUTOREFRESH=kos.use_auto_refresh();if(kos.USE_AUTOREFRESH){setTimeout(function(){kos.refresh_page()},500)}var a=(kos.USE_AUTOREFRESH)?"on":"off";var b=$("#autoRefresh").siblings("label").after('<span class="busy" id="busy" title="We\'re talking to the server. You don\'t need to wait for us to finish."><span class="bbi"><img src="'+kos.IMAGE_HOST+'/i/ajax-loader.gif" /></span><span class="bbc">Saving...</span></span>');$.get("/ajax/user/addPref",{pref_id:13,pref_value:a},function(c){$("#autoRefresh").parent().children("span.busy").fadeOut();$("#autoRefresh").parent().children("span.busy").remove()})});$("input:radio[name=visibility]").click(function(){kos.COMMENT_VISIBILITY=$("input:radio[name=visibility]:checked").val();if(kos.COMMENT_VISIBILITY=="hide"){$("#comments").css("display","none")}else{$("#comments").css("display","block");var c;var a;var e;var b;if(kos.COMMENT_VISIBILITY=="shrink"){c="block";a="none";e="div.cx";b="div.csx"}else{if(kos.COMMENT_VISIBILITY=="expand"){a="block";c="none";e="div.csx";b="div.cx"}}if(kos.top_com){kos.refresh_page(e,kos.top_com,undefined,1,undefined,b)}else{kos.refresh_page(e,undefined,undefined,1,undefined,b)}$(b).css("display","block")}});$("input:radio[name=layout]").click(function(){kos.LAYOUT=$("input:radio[name=layout]:checked").val();var a=kos.LAYOUT;$.get("/ajax/user/addPref",{pref_id:15,pref_value:a},function(b){})});if($("span.cct").length!=0){kos.CNUM=$("span.cct")[0].innerHTML}if(kos.USE_AUTOREFRESH){setTimeout(function(){kos.refresh_page()},kos.REFRESH_INTERVAL)}if($("input:radio[name=visibility]:checked").val()){kos.COMMENT_VISIBILITY=$("input:radio[name=visibility]:checked").val()}if($("input:radio[name=layout]:checked").val()){kos.LAYOUT=$("input:radio[name=visibility]:checked").val()}$.jGrowl.defaults.position="bottom-right";$.jGrowl.defaults.life=kos.REFRESH_TIME;kos.init_rate();$("span.crd.ntb").children("a").click(function(){var a=$(this).closest("li");a.find(".crs").slideToggle();return false});$("#tagEdit").click(function(){$("#tagEditor").slideToggle();return false});$("#tagSubmit").click(function(){kos.save_tags();return false});$("#comments").delegate("input.ratinate","keypress",function(){return false});$("#comment-prefs").delegate('input[type="radio"]',"keypress",function(){return false});$("a.show_graph_embed").click(function(){$(this).parent().children("span.embed_display").toggle(500);$("#graph_embed").select();return false});if($.browser.mobile){$("a.skipmobile").show()}});var kos={USE_AUTOREFRESH:false,REFRESH_INTERVAL:60000,REFRESH_TIMEOUT_TIME:30000,COMMENT_VISIBILITY:"expand",LAYOUT:"nested",OVERFLOW_AT:300,FORCE_SHRINK:500,CNUM:0,REFRESH_TIME:15000,IMAGE_HOST:"http://images.dailykos.com",C_STRING_MAXLENGTH:64*1024,S_STRING_MAXLENGTH:128*1024,comment_success:function(b){$("#previewSubject").html("");$("#previewComment").html("");$("#eSubject").val("");$("#eComment").val("");$("#eP").attr("display","none");preCx=$("#eP").children();preCx.attr("style","display:none");$("#ePostButton").removeAttr("disabled");var a=App.parseAjaxResponse(b);setTimeout(function(){kos.refresh_page(undefined,a.json_response._json,undefined,1)},1000)},comment_fail:function(b){$("#eP").slideDown("fast");$("#e").slideDown("fast");$("#addComm").remove();var a=App.parseAjaxResponse(b.responseText);$("#e").before('<div id="post_err" class="post_err"><strong>We\'re sorry</strong>, there was an error posting your comment: '+a.error_message+" Please try again in a moment.</div>");$("#ePostButton").attr("disabled","disabled");setTimeout(function(){$("#post_err").remove();$("#ePostButton").removeAttr("disabled")},3000);return false},create_summary:function(e){var k=e.children("h5").children("span.cu").html();var j=e.children("div.cf").children("p.cb").children("a");var a=j[1].href;var f=j[0].firstChild.nodeValue;var b=j[1].firstChild.nodeValue;var h=e.children("h5").children("span.crd").children().html();var g="";var l=e.attr("id").substr(2);var c=$('<div class="csx" id="csx'+l+'"></div>');c.css("display","none");c.html('<h5><a class="dc" href="'+a+'">'+g+'<span class="cu">'+k+"</span></a> by "+f+", "+b+' <span class="crd ntb">(<span class="csr">'+h+"</span>)</span></h5>");return c},create_full:function(b){var e=$('<div class="cx" id="cx'+b.id+'"></div>');e.css("display","none");var c=b.n_recrates||0;var j=b.n_trollrates||0;var p=b.user_sig||"";var g="";if(kos.LAST_SEEN!=undefined&&+b.cid>+kos.LAST_SEEN){g='<span class="nw">* [new] </span>'}var f="";if(b.recrates_text||b.trollrates_text){f="<dl><dt>Recommended by:</dt><dd>"+b.recrates_text+"</dd>"+((b.trollrates_text)?"<dt>Hidden by:</dt><dd>"+b.trollrates_text+"</dd>":"")+"</dl>"}var l="";if(b.can_rate){var k;var a;if(b.rated=="r"){k='checked = "checked" waschecked="waschecked"'}else{if(b.rated=="t"){a='checked = "checked" waschecked="waschecked"'}}if(b.can_rate==2){l='<input id="rc'+b.id+'" type="radio" value="4" name="r'+b.id+'" class="ratinate" '+k+'/> <label for="rc'+b.id+'">Recommend</label> <input id="t'+b.id+'" type="radio" value="0" name="r'+b.id+'" title="You have 5 Hide ratings left today." class="ratinate" '+a+'/> <label for="t'+b.id+'">Hide</label> <input class="rab" type="submit" value="Rate All" name="rate" />'}else{l='<input id="rc'+b.id+'" type="checkbox" value="4" name="r'+b.id+'" class="ratinate" '+k+'/> <label for="rc'+b.id+'">Recommend</label> <input class="rab" type="submit" value="Rate All" name="rate" />'}}var o=(b.can_reply||(!b.can_reply&&b.cid==1&&kos.can_comment)||b.parent_id!=0)?true:false;var n=(b.d)?' <a href="/comment/'+b.story_id+"/"+b.id+'/delete">delete</a>':"";var h=(b.user_ip_address)?' <a href="/reports/user/'+b.user_name+'">*</a>':"";e.html('<h5> <a class="de">&nbsp;</a>'+g+' <span class="cu">'+b.subject+'</span> <span class="crd ntb">(<a href="/comments/'+kos.story_id+"/"+b.id+"#c"+b.cid+"?mode=alone;showrate=1#c"+b.cid+'">'+c+"+ / "+j+'-</a>)</span> </h5><div class="crs">'+f+'</div><div class="ct">'+b.comment_text+'</div><div class="cf"> <p class="sig">'+p+'</p> <p class="cb">by <a href="/user/uid:'+b.user_id+'">'+b.user_name+'</a> on <a href="/comments/'+kos.story_id+"/"+b.id+"#c"+b.cid+'">'+b.ftime+'</a> </p> <p class="cl"> '+((o)?"[ ":"")+((b.parent_id!=0)?'<a href="/comment/'+kos.story_id+"/"+b.parent_id+'">Parent</a> '+((b.can_reply)?" | ":""):"")+((b.can_reply)?' <a href="/comments/'+kos.story_id+"/"+b.id+'/post#here" class="post-reply">Reply to this</a>':((b.cid==1&&kos.can_comment)?"No Reply to This":""))+((o)?" ] ":" ")+l+h+n+" </p></div>");e.children("h5").children("span.crd.ntb").children("a").click(function(){$(this).parent().parent().siblings("div.crs").slideToggle();return false});e.children("div.cf").children("p.cl").children("input.rab").css("display","none");e.children("div.cf").children("p.cl").children("input.rab").attr("disabled","disabled");return e},create_summary_json:function(b){var f=$('<div class="csx" id="csx'+b.id+'"></div>');var a="";if(kos.LAST_SEEN!=undefined&&+b.cid>+kos.LAST_SEEN){a='<span class="nw">* [new] </span>'}var e=b.n_recrates||0;var c=b.n_trollrates||0;f.html('<h5><a class="dc" href="/comments/'+kos.story_id+"/"+b.id+"#c"+b.cid+'">'+a+'<span class="cu">'+b.subject+"</span></a> by "+b.user_name+", "+b.ftime+' <span class="crd ntb">(<span class="csr">'+e+"+ / "+c+"-</span>)</span></h5>");return f},insert_comment:function(c,h){h=h||"s";var b=$("#c"+c.cid);var g=false;var f;var j;var a;if(b.length==0){b=$('<li id="c'+c.cid+'"></li>');g=true}if(h=="f"){cx=kos.create_full(c);f=cx;j="cx";a="csx";if(!g){kos.repos_post_form(cx,j)}b.prepend(cx);cx.css("display","block")}else{csx=kos.create_summary_json(c);f=csx;j="csx";a="cx";if($("#"+a+c.id).length!=0&&$("#"+a+c.id).is(":visible")){csx.hide()}b.append(csx);if(!g){kos.repos_post_form(csx,j)}}if(g){if(c.parent_id==0){kos.repos_post_form(b);$("#comments").children("#rateAllForm").children("ul.cm.i0").append(b)}else{var e=$("#k"+c.parent_id);if(e.length==0){e=$('<ul id="k'+c.parent_id+'" class="cm i1"></ul>');$("#c"+c.pid).after(e)}e.append(b);kos.repos_post_form(f,j)}}return false},refresh_page:function(k,j,h,g,a,e){if(kos.COMMENT_VISIBILITY=="hide"||kos.top_com==-1){return false}if($("#e").is(":visible")){if(kos.USE_AUTOREFRESH&&kos.pub_status!="unpublished"&&!g){setTimeout(function(){kos.refresh_page()},kos.REFRESH_INTERVAL)}return false}var b=kos.COMMENT_VISIBILITY;if(kos.top_com){j=kos.top_com}if(j){b="expand"}if(k){$("#comments").prepend('<span class="busy" id="busy" title="We\'re talking to the server. You don\'t need to wait for us to finish."><span class="bbi"><img src="'+kos.IMAGE_HOST+'/i/ajax-loader.gif" /></span><span class="bbc">Switching comment mode...</span></span>')}var f=(j)?"/comments/"+kos.story_id+"/"+j+"/index.json?"+((a)?"mode=alone&":""):"/story/"+kos.story_id+"/index.json?";kos.kojax_get(f,{detail:b,serial:(k)?undefined:kos.serial,update_time:kos.updated},function(r){var s;if(r.noupdate=="OK"){return false}kos.trcount=r.trcount;kos.trremain=r.trremain;if(r.story!=undefined){kos.serial=r.story.serial;kos.updated=r.story.updated;if(kos.pub_status!="unpublished"&&r.story.version!=kos.version){$("p.date").html(r.story.ftime);$("#intro").html(r.story.introtext);$("#body").html(r.story.bodytext);kos.version=r.story.version}kos.CNUM=r.story.n_comments;$("span.cct")[0].innerHTML=kos.CNUM;$.each($("a.total"),function(q){$("a.total")[q].innerHTML=kos.CNUM+" <span>Comments</span>"});kos.LAST_SEEN=DailyKos.CommentCount.getReadCommentCount(kos.story_id);$.each($("a.new"),function(q){var z=kos.CNUM-kos.LAST_SEEN;$("a.new")[q].innerHTML=z+" <span>New</span>"});if(h){var D="/story/"+r.story.url;if($("#titleHref").attr("href")!=D){kos.dialog_box("Redirecting to new url...");document.location.href=D}}else{$("#titleHref").attr("href","/story/"+r.story.url)}$("a.plink").each(function(){$(this).attr("href","/story/"+r.story.url)})}var u=[];var n=[];var A=(r.story!=undefined)?r.story.comments:r.comments;if(A==undefined){A=[]}var l=undefined;if(A.length){l=A[A.length-1].cid}$("#addComm").remove();var x=A.length;for(var t=0;t<x;t++){var w=A[t];var v=(b=="shrink")?"s":"f";var p=(b=="shrink")?"csx":"cx";var c=(b=="shrink")?"cx":"csx";if($("#"+p+w.id).length==0){if(kos.LAST_SEEN!=undefined&&+w.cid>+kos.LAST_SEEN&&$("#"+c+w.id).length==0){u.push(' <a href="#c'+w.cid+'">'+w.user_name+"</a>");if(w.is_reply){n.push(' <a href="#c'+w.cid+'">'+w.user_name+"</a>")}}kos.insert_comment(w,v)}var B=w.n_recrates+"+ / "+w.n_trollrates+"-";if($("#cx"+w.id).length!=0){$("#cx"+w.id).children("h5").children("span.crd.ntb").children("a").text(B);if(w.recrates_text||w.trollrates_text){var o=$("#cx"+w.id).children("div.crs");if(o.length==0){$("#cx"+w.id).children("h5").after('<div class="crs"></div>');o=$("#cx"+w.id).children("div.crs")}var C="<dl><dt>Recommended by:</dt><dd>"+w.recrates_text+"</dd>"+((w.trollrates_text)?"<dt>Hidden by:</dt><dd>"+w.trollrates_text+"</dd>":"")+"</dl>";o.html(C)}else{var o=$("#cx"+w.id).children("div.crs");if(o.length!=0){o.remove()}}$('input[name="r'+w.id+'"]').removeAttr("checked");if(w.rated=="r"){$("#rc"+w.id).attr("checked","checked")}else{if(w.rated=="t"){$("#t"+w.id).attr("checked","checked")}}}if($("#csx"+w.id).length!=0){$("#csx"+w.id).children("h5").children("span.crd.ntb").children("span.csr").text(B)}if(w.points!=null&&w.points<1&&(kos.hidingchoice=="no"||(kos.hidingchoice=="untilhide"&&w.hred))){$("#c"+w.cid).hide();$("#k"+w.id).hide()}}if(l){kos.LAST_SEEN=l}if(k){$("#comments").children("span.busy").fadeOut("slow");$("#comments").children("span.busy").remove();$(k).css("display","none")}kos.notify_update(s,u.join(", "),n.join(", "))},"json",function(){if(k){$("#comments").children("span.busy").after('<span id="switchFail" class="switchFail">Switching comment mode FAILED</span>');$("#comments").children("span.busy").remove();setTimeout(function(){$("#switchFail").remove()},3000)}return false}).done(function(){if(e){$(e).show()}});if(kos.USE_AUTOREFRESH&&kos.pub_status!="unpublished"&&!g){setTimeout(function(){kos.refresh_page()},kos.REFRESH_INTERVAL)}return false},summary_clickable:function(c){var a=c.parent().children("div.cx");if(a.length==0){var b=c.after('<span class="busy" id="busy" title="We\'re talking to the server. You don\'t need to wait for us to finish."><span class="bbi"><img src="'+kos.IMAGE_HOST+'/i/ajax-loader.gif" /></span><span class="bbc">Submitting...</span></span>');$.getJSON("/story/"+kos.story_id+"/index.json",function(e){$.each(e.story.comments,function(j,g){var k=e.story.comments[j];var h=kos.create_full(k);var f=$("#csx"+k.id);if($("#cx"+k.id).length==0){f.before(h)}});a=c.parent().children("div.cx");c.parent().children("span.busy").fateOut();c.parent().children("span.busy").remove()})}c.css("display","none");a.slideToggle("fast");return false},unix_time:function(){return Math.round(new Date().getTime()/1000)},use_auto_refresh:function(){return $("#autoRefresh").attr("checked")},is_modified_click:function(a){a=a||window.event;return(a.altKey||a.ctrlKey||a.metaKey||a.shiftKey)},expand_comment:function(l,g){g=g||window.event;var b=l.children("div.csx");var c=l.children("div.cx");var k=b.attr("id").substr(3);if(c.length==0){var h=b.after('<span class="busy" id="busy" title="We\'re talking to the server. You don\'t need to wait for us to finish."><span class="bbi"><img src="'+kos.IMAGE_HOST+'/i/ajax-loader.gif" /></span><span class="bbc">Submitting...</span></span>');var j=(+kos.CNUM<kos.OVERFLOW_AT&&kos.is_modified_click(g))?"":"mode=alone&";var f=(+kos.CNUM<kos.OVERFLOW_AT)?"/story/"+kos.story_id+"/index.json?":"/comments/"+kos.story_id+"/"+k+"/index.json?"+j;var a=$.getJSON(f+kos.unix_time()+"&detail=f",function(r){var e=(r.story==undefined)?r.comments:r.story.comments;var q=e.length;for(var p=0;p<q;p++){var s=e[p];var o=kos.create_full(s);var n=$("#csx"+s.id);if($("#cx"+s.id).length==0){n.before(o)}}c=l.children("div.cx");l.children("span.busy").fadeOut();l.children("span.busy").remove();b.css("display","none");c.slideDown("fast");b.children("h5").children("a.dc").children("span.nw").remove();c.children("h5").children("span.nw").remove();if($("#k"+k).length!=0&&kos.is_modified_click(g)){$("#k"+k).children("li").each(function(t){kos.expand_comment($(this),g)})}})}else{b.css("display","none");c.slideDown("fast");b.children("h5").children("a.dc").children("span.nw").remove();c.children("h5").children("span.nw").remove();if($("#k"+k).length!=0&&kos.is_modified_click(g)){$("#k"+k).children("li").each(function(e){kos.expand_comment($(this),g)})}}return false},shrink_comment:function(b,f){f=f||window.event;var a=b.children("div.cx");var g=b.children("div.csx");if(g.length==0){g=kos.create_summary(a);a.after(g)}a.slideUp("fast");g.fadeIn();g.children("h5").children("a.dc").children("span.nw").remove();a.children("h5").children("span.nw").remove();var c=a.attr("id").substr(2);if($("#k"+c).length!=0&&kos.is_modified_click(f)){$("#k"+c).children("li").each(function(e){kos.shrink_comment($(this),f)})}},notify_update:function(e,c,b){var a;if(e){$.jGrowl("<p><strong>Story Updated</strong></p>")}if(b){$.jGrowl("<p><strong>Replies:</strong> "+b+"</p>")}if(c){$.jGrowl("<p><strong>New Comments:</strong> "+c+"</p>")}return false},init_rate:function(){$("input.rab").css("display","none");$("input.rab").attr("disabled","disabled");$("#comments").delegate("input.ratinate","click",kos.rate_button)},rate_button:function(){var c=$(this).attr("name").substr(1);$("input[name="+$(this).attr("name")+"]").attr("disabled","disabled");setTimeout(function(){$("input[name=r"+c+"]").removeAttr("disabled");return false},500);if($(this).attr("waschecked")){$(this).attr("checked",false);$(this).removeAttr("waschecked")}else{$("input[name="+$(this).attr("name")+"]").removeAttr("waschecked");$(this).attr("waschecked",true)}var b=$("input[name="+$(this).attr("name")+"]:checked").val();if(b==undefined){b=-1}var e;if(b==4){e="addRating"}else{if(b==0){e="addTrollRating"}else{e="removeRating"}}if(b==0&&kos.trremain!=999&&kos.trremain>0){var a="Are you SURE you want to hide this comment? Community guidelines allow for hide rating only when the comment is so disruptive or damaging to the community that it should be deleted from the discussion. Hide rating merely out of disagreement is inappropriate. You may also only hide rate a particular user once in a 24 hour period. If you abuse your ratings privilege, you may lose it. Do you want to proceed?\n\nYou have "+kos.trremain+" hide ratings left for today.";if(!confirm(a)){$(this).attr("checked",false);return false}kos.trremain--;kos.trcount++}else{if(b==0&&kos.trremain<=0){alert("Sorry, you've used all your hide ratings for the day.");$(this).attr("checked",false);return false}}$("#cx"+c).children("div.cf").children("p.cl").append('<span class="ratebusy" id="ratebusy" title="We\'re talking to the server. You don\'t need to wait for us to finish."><span class="bbi"><em>&nbsp;&nbsp;Rating...</em></span></span>');$("#cx"+c).children("h5").children("span.nw").remove();kos.kojax_post("/ajax/comment/"+e,{comment_id:c},function(f){$("#ratebusy").html("<span><em>&nbsp;&nbsp;Complete!</em></span>");setTimeout(function(){$("#ratebusy").fadeOut();$("#ratebusy").remove()},600);setTimeout(function(){kos.refresh_page(0,c,undefined,1,1)},400)},function(g){$("span.ratebusy").after('<span id="ratefail">&nbsp;&nbsp;FAILED</span>');$("span.ratebusy").remove();if(g&&g.responseText){var f=$("<div />").append(g.responseText);if(f.find(".ajax_error_message").html()){kos.dialog_box(f.find(".ajax_error_message").html(),"Sorry.")}}setTimeout(function(){$("#ratefail").remove()},1000);return false})},format_button:function(g,k){var o;var n;var h=$(g)[0].value.length;var e=kos.get_start_end($(g));var b=e.start;var f=e.end;var c=$(g)[0].value.substring(b,f);if(k=="bold"){o="<strong>";n="</strong>"}else{if(k=="italic"){o="<em>";n="</em>"}else{if(k=="blockquote"){o="<blockquote>";n="</blockquote>"}else{if(k=="link"){var a=g.substr(1,1);if(a!="e"){a=a+"e"}b=kos.Maluk;f=kos.Balan;kos.Maluk=kos.Balan=undefined;c=kos.add_link(a)}}}}var l=(k!="link")?o+c+n:c;var j=$(g).scrollTop();$(g).val($(g)[0].value.substring(0,b)+l+$(g)[0].value.substring(f,h));$(g).scrollTop(j)},get_selected_text:function(e){var a=kos.get_start_end($(e));var f=a.start;var b=a.end;kos.Maluk=f;kos.Balan=b;var c=$(e)[0].value.substring(f,b);return c},get_start_end:function(f){var b=f[0];var a=0,c=0,j,g,k,h,e;if(typeof b.selectionStart=="number"&&typeof b.selectionEnd=="number"){a=b.selectionStart;c=b.selectionEnd}else{b.focus();g=document.selection.createRange();if(g&&g.parentElement()==b){h=b.value.length;j=b.value.replace(/\r\n/g,"\n");k=b.createTextRange();k.moveToBookmark(g.getBookmark());e=b.createTextRange();e.collapse(false);if(k.compareEndPoints("StartToEnd",e)>-1){a=c=h}else{a=-k.moveStart("character",-h);a+=j.slice(0,a).split("\n").length-1;if(k.compareEndPoints("EndToEnd",e)>-1){c=h}else{c=-k.moveEnd("character",-h);c+=j.slice(0,c).split("\n").length-1}}}}return{start:a,end:c}},add_link:function(e){var g=$("#"+e+"LinkUrl").val();g=g.replace(/http:\/\/http(s?):\/\//,"http$1://");var b=$("#"+e+"LinkImage").attr("checked");var c=(b)?g:$("#"+e+"LinkLabel").val();var a=(b)?'<img src="'+c+'" />':c;var f='<a href="'+g+'">'+a+"</a>";$("#"+e+"LinkUrl").val("http://");$("#"+e+"LinkLabel").val("");$("#"+e+"LinkImage").removeAttr("checked");return f},kojax_post:function(a,e,f,b,c){if($.isFunction(e)){b=b||f;f=e;e={}}if($.isFunction(b)){c=b;b=undefined}return $.ajax({type:"POST",url:a,data:e,success:f,dataType:b,error:c})},kojax_get:function(a,e,f,b,c){if($.isFunction(e)){b=b||f;f=e;e={}}if($.isFunction(b)){c=b;b=undefined}return $.ajax({type:"GET",url:a,data:e,success:f,dataType:b,error:c})},save_tags:function(){if(!$("#tagInput").val()){$("#tagErrorMessage").show();return false}var a=$("#tagInput").val().split(/\s*[,;]\s*/);kos.kojax_post("/ajax/story/setTags",{story_id:kos.story_id,tag_array:a},function(){$.each(a,function(b){a[b]='<li><a href="/news/'+a[b]+'">'+a[b]+"</a></li>"});$("div.tags").children("ul").html(a.join(" "));$("#tagErrorMessage").hide();$("#tagEditor").hide();return false},function(b){if(b.status>=500&&b.getResponseHeader("content-type")=="text/html"){kos.dialog_box("Server has gone away. This is a transient error, so just try previewing your comment again in a moment.")}else{kos.dialog_box("There was a problem saving the tags. It may be that a new tag is invalid. Only letters, numbers and (&$. -') are allowed.")}return false});return false},dialog_box:function(b,a){$("#dbox_msg").text(b);a=a||"Action Complete";$("#dbox_close").click(function(){$("#dbox").dialog("close");return false});$("#dbox").dialog({title:a,modal:true})},disable_preview:function(){$("#ePostButton").attr("disabled","disabled");$("#eP").fadeTo(0,0.5)},enable_preview:function(){$("#ePostButton").removeAttr("disabled");$("#eP").fadeTo(0,1)},cancel_comment:function(){$("#previewSubject").html("");$("#previewComment").html("");$("#eSubject").val("");$("#eComment").val("");$("#eP").hide();preCx=$("#eP").children();preCx.hide();$("#e").slideUp("fast");return false},max_string:function(b,a){if(b.length>a){return true}return false},str_chk:function(b,a){if(kos.max_string(b,a)){kos.dialog_box("Sorry, that text is too long. Please try shortening it.","Error");return true}return false},repos_post_form:function(c,a){return false;var b;if($("#e").is(":visible")&&$("#e").offset().top>c.offset().top){if(a=="csx"){b=c.children("h5")}else{b=c}$(window).scrollTop($(window).scrollTop()+b.outerHeight(1)-6)}return false},populate_new:function(){for(i=kos.LAST_SEEN+1;i<=+kos.CNUM;i++){$("#c"+i).children().children("h5").children("a").prepend('<span class="nw">* [new] </span>')}}};$(document).ready(function(){if(kos.pub_status=="queued"){$("#movQueue").val("Remove from all Queues")}else{if(kos.pub_status!="unpublished"){$("#movQueue").attr("disabled","disabled");$("#movSpan").css("display","none");$("#adminDiaryPublish").val("Save Changes")}}if($("#main").attr("class")=="editing"||$("#main").attr("class")=="previewing"){$("#tagSubmit").attr("disabled","disabled")}$("a.do-editStory").live("click",function(){if($("#main").attr("class")=="editing"){if(kos.pub_status=="published"){$("#main").attr("class","published");$("#tagSubmit").removeAttr("disabled")}else{$("#main").removeAttr("class")}}else{$("#main").attr("class","editing");$("#tagSubmit").attr("disabled","disabled");$("#ie").css("display","block");$("#be").css("display","block");window.scroll(0,0)}return false});$("#previewButton").live("click",function(){kst.preview_diary();return false});$("#editDiaryButton").live("click",function(){kst.edit_diary();return false});$("#iePButton").live("click",function(){kst.preview_diary();return false});$("#bePButton").live("click",function(){kst.preview_diary();return false});$("#ieBold").live("click",function(){kos.format_button("#ieText","bold");return false});$("#ieItalic").live("click",function(){kos.format_button("#ieText","italic");return false});$("#ieBlockquote").live("click",function(){kos.format_button("#ieText","blockquote");return false});$("#ieLinkButton").live("click",function(){$("#ieLink").toggle();$("#ieLinkLabel").val(kos.get_selected_text("#ieText"));return false});$("#ieAddLink").live("click",function(){kos.format_button("#ieText","link");$("#ieLink").css("display","none");$("#ieLinkImage").removeAttr("checked");return false});$("#beBold").live("click",function(){kos.format_button("#beText","bold");return false});$("#beItalic").live("click",function(){kos.format_button("#beText","italic");return false});$("#beBlockquote").live("click",function(){kos.format_button("#beText","blockquote");return false});$("#beLinkButton").live("click",function(){$("#beLink").toggle();$("#beLinkLabel").val(kos.get_selected_text("#beText"));return false});$("#beAddLink").live("click",function(){kos.format_button("#beText","link");$("#beLink").css("display","none");$("#beLinkImage").removeAttr("checked");return false});$("#ieHelpButton").live("click",function(){kst.show_help("#ieHelp")});$("#beHelpButton").live("click",function(){kst.show_help("#beHelp")});$("#tagInput").live("click",function(){if($("#tagErrorMessage").attr("style")=="display: block; "){$("#tagErrorMessage").slideUp("fast")}});$("#draftButton").live("click",function(){kst.save_draft(true);return false});$("#adminDiaryPublish").live("click",function(){kst.publish_diary("publish");return false});$("#publishButton").live("click",function(){kst.publish_diary("publish");return false});$("#saveStory").live("click",function(){kst.publish_diary("save");return false});$("#movQueue").live("click",function(){var a=($("#movQueue").val()=="Remove from all Queues")?"dequeue":"queue";kst.publish_diary(a);return false});$("#scheduleDiary").live("click",function(){if(!$("#posttime").val()||!$("#postdate").val()){kos.dialog_box("Please enter a time and date for scheduling this story.","Scheduling Error");return false}kst.publish_diary("schedule");return false});$("#deleteDiaryButton").live("click",function(){if(!confirm("Are you sure you want to delete this diary?")){return false}kst.delete_diary();return false});$("#obliterateDiaryButton").live("click",function(){if(!confirm("Are you absolutely sure you want to do this? There's absolutely no going back.")){return false}kst.obliterate_diary();return false});$("#unpublishDiaryButton").live("click",function(){kst.publish_diary("unpublish");return false});$("#ieText").live("click",function(){kst.draft_enable();return false});$("#beText").live("click",function(){kst.draft_enable();return false});$("#titleInput").live("click",function(){kst.draft_enable();return false});$("#addPoll").live("click",function(){kst.poll_prep("add");return false});$("#rmvPoll").live("click",function(){kst.poll_prep("remove");return false});$("input.pollSubmit").attr("disabled","disabled");$("input.aid").live("click",function(){$("input.pollSubmit").removeAttr("disabled")});$("input.pollSubmit").live("click",function(){var e=this.parentNode.parentNode.parentNode.parentNode.parentNode.id;var b=$("div#"+e);var a;b.find("input.aid").each(function(){if($(this).attr("checked")){a=$(this).val()}});var f=this.parentNode.parentNode.parentNode.parentNode.parentNode.id.substr(1);var c=this.parentNode.parentNode.parentNode.parentNode.action;var g=new Array();g.poll_id=f;g["po_"+f]=a;$.post(c,{poll_id:f,pans:a},function(j){var h=b.find("span.vtotal").html();b.find("span.vtotal").html(++h);b.find("input.aid").hide();b.find("tr.pr").each(function(l){var o=$(this).children("td.pt").children("span.vct").html().replace(" votes","");if((l+1)==a){o++}var n=parseInt(o/h*100);var k=-400+(o/h*400);$(this).children("td.pperc").html(n+"%");$(this).children("td.pt").children("span.vct").html(o+" votes");$(this).children("td.pt").attr("style","background-position: "+k+"px 0;")});b.find("tr.pr").children().show()});return false});$("a.pollResult").live("click",function(){$(this).parent().parent().children("span.pvi").children("input.pollSubmit").hide();$(this).parent().parent().children("span.pvr").hide();$(this).parent().parent().children("span.pva").show();var a=$(this).attr("href").split("/")[2];var b="#tb"+a;$(b).children("tbody").children("tr.po").children("td").children("input.aid").hide();$(b).children("tbody").children("tr.pr").children().fadeIn();return false});$("a.pollVoteR").live("click",function(){$(this).parent().parent().children("span.pvi").children("input.pollSubmit").show();$(this).parent().parent().children("span.pvr").show();$(this).parent().parent().children("span.pva").hide();var a=$(this).attr("href").split("/")[2];var b="#tb"+a;$(b).children("tbody").children("tr.po").children("td").children("input.aid").show();$(b).children("tbody").children("tr.pr").children().fadeOut();return false})});var kst={DRAFT_DISABLE:true,unpub:[],pubbed:[],preview_diary_err:function(b){var a=$.parseJSON(b.responseText);if(a.error){kos.dialog_box("There was an error saving your story:\n"+a.error,"Ooops")}else{kos.dialog_box("Oh no! Something went wrong trying to preview your story. Don't worry though; it's probably a transient error. Please try again.","Ooops")}},preview_diary:function(){var e=$("#ieText");var h=$("#beText");var f=$("#tagInput").val().split(/\s*[,;]\s*/);if(!$("#titleInput").val()||($("#titleInput").val()=="untitled diary")){$("#titleErrorMessage").slideDown("fast");var c=$("#titleErrorMessage").offset().left;var a=$("#titleErrorMessage").offset().top;window.scroll(c,a);return false}if(kos.str_chk(e.val(),kos.S_STRING_MAXLENGTH)||kos.str_chk(h.val(),kos.S_STRING_MAXLENGTH)){return false}if(1){var g;var b=[];if($("div.poll").length!=0){if($("input[name=answer]").length!=0){g=$("div.poll").attr("id").substr(1);$("input[name=answer]").each(function(j){if($(this).val()){b.push($(this).val())}})}}kos.kojax_post("/ajax/story/saveDraftHow",{where:"draft",introtext:$("#ieText").val(),bodytext:$("#beText").val(),tag_draft:$("#tagInput").val(),title:$("#titleInput").val(),story_id:kos.story_id,image_url:"",poll_id:g,question:$("#piq").val(),answer:b},function(){App.onAjaxStoryPreviewSuccess($(".ajaxON.type-story.do-preview"))},kst.story_error);return false}$.each(f,function(j){f[j]="<li><a href=/news/"+$.trim(f[j])+'">'+$.trim(f[j])+"</a></li>"});$("div.tags").children("ul").html(f.join(" "));if($("#piq").val()){kst.poll_prep("pub")}App.onAjaxStoryPreviewSuccess($(".ajaxON.type-story.do-preview"));return false},edit_diary:function(){$("#ie").css("display","block");$("#be").css("display","block");$("#main").attr("class","editing");window.scroll(0,0);if($("#piq").val()){kst.poll_prep("add")}App.onAjaxStoryEditSuccess($(".ajaxON.type-story.do-edit"));return false},show_help:function(a){$(a).load("/help/diaryEditorHelp.html");$(a).slideToggle();return false},save_draft:function(a){if(kos.str_chk($("#ieText").val(),kos.S_STRING_MAXLENGTH)||kos.str_chk($("#beText").val(),kos.S_STRING_MAXLENGTH)){return false}if(a){kos.kojax_post("/ajax/story/saveDraft",{introtext:$("#ieText").val(),bodytext:$("#beText").val(),tag_draft:$("#tagInput").val(),title:$("#titleInput").val(),story_id:kos.story_id,image_url:""},function(b){kos.dialog_box("draft saved","Draft Saved")},kst.story_error)}else{kos.kojax_post("/ajax/story/saveDraft",{introtext:$("#ieText").val(),bodytext:$("#beText").val(),tag_draft:$("#tagInput").val(),title:$("#titleInput").val(),story_id:kos.story_id,image_url:""},function(){$.noop()},kst.story_error)}kst.poll_save("draft");kst.draft_disable();return false},draft_enable:function(){if(kst.DRAFT_DISABLE){$("#draftButton").removeAttr("disabled");kst.DRAFT_DISABLE=false}return false},draft_disable:function(){$("#draftButton").attr("disabled","true");kst.DRAFT_DISABLE=true;return false},delete_diary:function(){kos.kojax_post("/ajax/story/delete",{story_id:kos.story_id},function(a){kos.dialog_box("Your story has been deleted. Redirecting to the front page...");window.location.replace("/")},function(){kos.dialog_box("There was a problem deleting your story.","We're Sorry")});return false},obliterate_diary:function(){kos.kojax_post("/ajax/story/obliterate",{story_id:kos.story_id},function(a){kos.dialog_box("The story has been utterly removed. Redirecting to the front page...");window.location.replace("/")},function(){kos.dialog_box("There was a problem deleting your story.","We're Sorry")});return false},publish_diary:function(e){var s=$("#ieText").val();var p=$("#beText").val();var t=$("#tagInput").val();if(kos.str_chk(s,kos.S_STRING_MAXLENGTH)||kos.str_chk(p,kos.S_STRING_MAXLENGTH)){return false}if(!t){$("#tagErrorMessage").slideDown("fast");var f=$("#tagErrorMessage").offset().left;var c=$("#tagErrorMessage").offset().top;window.scroll(f,c);return false}var r=$("#titleInput").val();var k=undefined;var h=$("#displaystatus").html();var q;if($("#priority").length){q=$("#priority").val()}var j;if($("#commentstatus").length){j=$("#commentstatus").val()}var o=$("#posttime").val();var n=$("#postdate").val();var l=$("#timestamp").attr("checked");if(e=="unpublish"){if(!confirm("You're about to unpublish this story. Proceed?")){return false}else{kos.kojax_post("/ajax/story/removeFromAllBlogs",{story_id:kos.story_id},function(){$.noop()},function(){kos.dialog_box("There was a problem unpublishing your story","We're Sorry")});kos.dialog_box("Story unpublished.")}}else{if(e=="dequeue"){kos.kojax_post("/ajax/story/removeFromAllBlogs",{story_id:kos.story_id},function(){$.noop()},function(u){kos.dialog_box("There was a problem unqueueing your story","We're Sorry")});kst.pubbed=[];kst.unpub=[];$("select[name=blog_id] option:selected").removeAttr("selected")}}var b;var g;var a=[];$("select[name=blog_id] option:selected").each(function(){if($(this).attr("selected")&&$(this).val()){a.push($(this).val())}});if(!kst.poll_verify()){return false}if(e=="publish"){b="/ajax/story/publishNow";g="Your story has been published.";kst.preview_diary();$("#main").attr("class","published");kst.save_draft();kos.pub_status="published";kst.add_save();$("#tagSubmit").removeAttr("disabled");$("#tagErrorMessage").slideUp("fast")}else{if(e=="save"){b="/ajax/story/edit";g="Your changes have been saved.";kst.preview_diary();$("#main").attr("class","published")}else{if(e=="queue"){o=n=undefined;$("#posttime").val(undefined);$("#postdate").val(undefined);b="/ajax/story/publishLater";kst.save_draft();kst.add_save();g="This story has been queued.";if(kos.pub_status=="unpublished"){kos.pub_status="queued"}}else{if(e=="dequeue"){o=n=undefined;$("#posttime").val(undefined);$("#postdate").val(undefined);b="/ajax/story/edit";kst.save_draft();g="This story has been removed from the queue.";if(kos.pub_status=="queued"){h=kos.pub_status="unpublished"}$("#movQueue").val("Move to Queue");$("#posttime").val("");$("#postdate").val("")}else{if(e=="schedule"){b="/ajax/story/publishLater";kst.save_draft();kst.add_save();g="Your story has been scheduled for publication.";if(kos.pub_status=="unpublished"){kos.pub_status="queued"}}else{if(e=="unpublish"){b="/ajax/story/unPublish";kst.save_draft();kst.add_save();g="The story has been unpublished";kos.pub_status="unpublished"}else{kos.dialog_box("SAY WHAT?");return false}}}}}}kos.kojax_post(b,{story_id:kos.story_id,introtext:s,bodytext:p,tag_draft:t,title:r,image_url:k,displaystatus:h,commentstatus:j,posttime:o,postdate:n,blog_ids:a,timestamp:l},function(v){if(g){kos.dialog_box(g)}$("#displaystatus").html(kos.pub_status);$.getJSON("/story/"+kos.story_id+"/schedinfo.json",function(w){$("#schedList").html("");$.each(w,function(x){if(x==0){$("#schedList").append('<p id="sqlist">Queued to: '+w[x].join(", ")+"</p>")}else{$("#schedList").append('<p class="sslist">Scheduled to: '+w[x].join(", ")+" at "+x+"</p>")}});return false});if(e=="publish"||e=="save"){kst.pubbed=[];kos.refresh_page(0,0,1)}if(kos.pub_status=="published"){$("#movQueue").attr("disabled","disabled");$("#movSpan").css("display","none");$("#adminDiaryPublish").val("Save Changes");$("select[name=blog_id]").attr("disabled","disabled")}else{if(e=="queue"||e=="schedule"&&kos.pub_status=="published"){$("#movQueue").val("Remove from all Queues");$("select[name=blog_id]").attr("disabled","disabled")}else{if(e=="dequeue"){$("#movQueue").val("Move to Queue");$("select[name=blog_id]").removeAttr("disabled")}else{if(e=="unpublish"){$("select[name=blog_id]").removeAttr("selected");$("select[name=blog_id]").removeAttr("disabled");$("#posttime").val("");$("#postdate").val("")}}}}if($("#piq").val()){var u=(e=="publish"||e=="save")?"pub":"draft";kst.poll_save(u)}kst.unpub=[]},kst.story_error);return false},add_save:function(){if($("#saveStory").length==0){$("#edbSpan").after('<span id="saveSpan"><input id="saveStory" type="submit" value="Save Changes" tabindex="125" /> | </span>')}},poll_prep:function(f){var e;var c;if(f=="add"){c="block";e="none";$("input[name=answer]").show();$("tr.pr").children().hide();$("tr.po").show()}else{if(f=="pub"){$("p.pollQuery").css("display","block");$("p.pollQuery").html($("#piq").val());c="none";e="block";$("#pollGuide").css("display",c);$("#pollQueryInput").css("display",c);$("table.polltb").css("display",e);$("#rmvPollP").css("display",c);$("#addPollP").css("display",c);$("input[name=answer]").hide();$("tr.pr").children().show();$("input[name=answer]").each(function(){if(!$(this).val()){var a=$(this).parent().parent();a.hide();a.next().hide();$(this).next().html("")}else{$(this).next().html($(this).val())}});return false}else{c="none";e="block";$("#piq").val("");$("p.pollQuery").html("");$("input[name=answer]").val("");$("#pollErrorMessage").css("display","none")}}$("#pollGuide").css("display",c);$("#pollQueryInput").css("display",c);$("table.polltb").css("display",c);$("#rmvPollP").css("display",c);$("#addPollP").css("display",e);return false},poll_save:function(a){if($("div.poll").length==0){return false}if($("input[name=answer]").length==0){return false}var c=$("div.poll").attr("id").substr(1);var b=[];$("input[name=answer]").each(function(e){if($(this).val()){b.push($(this).val())}});kos.kojax_post("/ajax/poll/edit",{poll_id:c,id:c,question:$("#piq").val(),answer:b},function(e){if(a=="pub"){kos.kojax_post("/ajax/poll/publish",{poll_id:c,id:c,question:$("#piq").val(),answer:b},function(){kst.poll_prep("pub");$("p.pollControls").show();$("div.poll").children("form").attr("class","vote");$.each(b,function(g){var f=g+1;$("#a"+f).html(b[g])})},function(){kos.dialog_box("There was a problem saving your poll.","We're Sorry")})}},function(){kos.dialog_box("There was a problem saving your poll.","We're Sorry")})},poll_verify:function(){if(!$("#piq").val()&&$("input[name=answer]").val()){$("#pollErrorMessage").slideDown("fast");return false}return true},story_error:function(b){var a=App.parseAjaxResponse(b.responseText);var c="There was a problem saving your story: "+a.error_message;kos.dialog_box(c,"We're Sorry");return false}};$(document).ready(function(){$("#markRead").live("click",function(){kpm.pm_action("markRead");return false});$("#markUnread").live("click",function(){kpm.pm_action("markAsUnseen");return false});$("#delMsg").live("click",function(){kpm.pm_action("thrHide");return false})});var kpm={pm_action:function(a){$("input[name=mesgdel]:checked").each(function(){var c=$(this);var b="#pm"+$(this).val();kos.kojax_post("/ajax/pmThread/"+a,{pm_thread_id:$(this).val()},function(){var f=c.parent().parent();if(a=="thrHide"){f.hide()}else{if(a=="markRead"){f.removeClass("unread");f.children().children("span").remove()}else{if(a=="markAsUnseen"){var e=f.children()[4].innerText;f.children()[4].innerHTML=e+' <span id="pm'+$(this).val()+'">/ '+e+" new</span>";f.addClass("unread")}}}return false},function(){kos.dialog_box("Sorry, that operation could not be performed.","We're sorry");return false})});return false}};$(document).ready(function(){var a=kck.get_hash();$.each(a,function(c,b){if(b=="collapsed"){$("#"+c).addClass("collapsed")}else{$("#"+c).removeClass("collapsed")}})});var kck={SIDEBAR_COOKIE:"sidebar",get_domain:function(){return"."+document.domain.split(".").slice(-2).join(".")},get_hash:function(){var a=$.cookie(kck.SIDEBAR_COOKIE);return(a)?jQuery.parseJSON(a):{}},write_hash:function(a){$.cookie(kck.SIDEBAR_COOKIE,JSON.stringify(a),{domain:kck.get_domain(),path:"/",expires:365});return false},set_val:function(a,b){var e=kck.get_hash();e[a]=b;kck.write_hash(e);return false},set_coll_pref:function(a){kck.set_val(a.attr("id"),(a.hasClass("collapsed"))?"collapsed":"open");return false}};var stIsIE=
/*@cc_on!@*/
false;sorttable={init:function(){if(arguments.callee.done){return}arguments.callee.done=true;if(_timer){clearInterval(_timer)}if(!document.createElement||!document.getElementsByTagName){return}sorttable.DATE_RE=/^(\d\d?)[\/\.-](\d\d?)[\/\.-]((\d\d)?\d\d)$/;forEach(document.getElementsByTagName("table"),function(a){if(a.className.search(/\bsortable\b/)!=-1){sorttable.makeSortable(a)}})},makeSortable:function(b){if(b.getElementsByTagName("thead").length==0){the=document.createElement("thead");the.appendChild(b.rows[0]);b.insertBefore(the,b.firstChild)}if(b.tHead==null){b.tHead=b.getElementsByTagName("thead")[0]}if(b.tHead.rows.length!=1){return}sortbottomrows=[];for(var a=0;a<b.rows.length;a++){if(b.rows[a].className.search(/\bsortbottom\b/)!=-1){sortbottomrows[sortbottomrows.length]=b.rows[a]}}if(sortbottomrows){if(b.tFoot==null){tfo=document.createElement("tfoot");b.appendChild(tfo)}for(var a=0;a<sortbottomrows.length;a++){tfo.appendChild(sortbottomrows[a])}delete sortbottomrows}headrow=b.tHead.rows[0].cells;for(var a=0;a<headrow.length;a++){if(!headrow[a].className.match(/\bsorttable_nosort\b/)){mtch=headrow[a].className.match(/\bsorttable_([a-z0-9]+)\b/);if(mtch){override=mtch[1]}if(mtch&&typeof sorttable["sort_"+override]=="function"){headrow[a].sorttable_sortfunction=sorttable["sort_"+override]}else{headrow[a].sorttable_sortfunction=sorttable.guessType(b,a)}headrow[a].sorttable_columnindex=a;headrow[a].sorttable_tbody=b.tBodies[0];dean_addEvent(headrow[a],"click",function(f){if(this.className.search(/\bsorttable_sorted\b/)!=-1){sorttable.reverse(this.sorttable_tbody);this.className=this.className.replace("sorttable_sorted","sorttable_sorted_reverse");this.removeChild(document.getElementById("sorttable_sortfwdind"));sortrevind=document.createElement("span");sortrevind.id="sorttable_sortrevind";sortrevind.innerHTML=stIsIE?'&nbsp<font face="webdings">5</font>':"&nbsp;&#x25B4;";this.appendChild(sortrevind);return}if(this.className.search(/\bsorttable_sorted_reverse\b/)!=-1){sorttable.reverse(this.sorttable_tbody);this.className=this.className.replace("sorttable_sorted_reverse","sorttable_sorted");this.removeChild(document.getElementById("sorttable_sortrevind"));sortfwdind=document.createElement("span");sortfwdind.id="sorttable_sortfwdind";sortfwdind.innerHTML=stIsIE?'&nbsp<font face="webdings">6</font>':"&nbsp;&#x25BE;";this.appendChild(sortfwdind);return}theadrow=this.parentNode;forEach(theadrow.childNodes,function(e){if(e.nodeType==1){e.className=e.className.replace("sorttable_sorted_reverse","");e.className=e.className.replace("sorttable_sorted","")}});sortfwdind=document.getElementById("sorttable_sortfwdind");if(sortfwdind){sortfwdind.parentNode.removeChild(sortfwdind)}sortrevind=document.getElementById("sorttable_sortrevind");if(sortrevind){sortrevind.parentNode.removeChild(sortrevind)}this.className+=" sorttable_sorted";sortfwdind=document.createElement("span");sortfwdind.id="sorttable_sortfwdind";sortfwdind.innerHTML=stIsIE?'&nbsp<font face="webdings">6</font>':"&nbsp;&#x25BE;";this.appendChild(sortfwdind);row_array=[];col=this.sorttable_columnindex;rows=this.sorttable_tbody.rows;for(var c=0;c<rows.length;c++){row_array[row_array.length]=[sorttable.getInnerText(rows[c].cells[col]),rows[c]]}row_array.sort(this.sorttable_sortfunction);tb=this.sorttable_tbody;for(var c=0;c<row_array.length;c++){tb.appendChild(row_array[c][1])}delete row_array})}}},guessType:function(c,b){sortfn=sorttable.sort_alpha;for(var a=0;a<c.tBodies[0].rows.length;a++){text=sorttable.getInnerText(c.tBodies[0].rows[a].cells[b]);if(text!=""){if(text.match(/^-?[£$¤]?[\d,.]+%?$/)){return sorttable.sort_numeric}possdate=text.match(sorttable.DATE_RE);if(possdate){first=parseInt(possdate[1]);second=parseInt(possdate[2]);if(first>12){return sorttable.sort_ddmm}else{if(second>12){return sorttable.sort_mmdd}else{sortfn=sorttable.sort_ddmm}}}}}return sortfn},getInnerText:function(b){hasInputs=(typeof b.getElementsByTagName=="function")&&b.getElementsByTagName("input").length;if(b.getAttribute("sorttable_customkey")!=null){return b.getAttribute("sorttable_customkey")}else{if(typeof b.textContent!="undefined"&&!hasInputs){return b.textContent.replace(/^\s+|\s+$/g,"")}else{if(typeof b.innerText!="undefined"&&!hasInputs){return b.innerText.replace(/^\s+|\s+$/g,"")}else{if(typeof b.text!="undefined"&&!hasInputs){return b.text.replace(/^\s+|\s+$/g,"")}else{switch(b.nodeType){case 3:if(b.nodeName.toLowerCase()=="input"){return b.value.replace(/^\s+|\s+$/g,"")}case 4:return b.nodeValue.replace(/^\s+|\s+$/g,"");break;case 1:case 11:var c="";for(var a=0;a<b.childNodes.length;a++){c+=sorttable.getInnerText(b.childNodes[a])}return c.replace(/^\s+|\s+$/g,"");break;default:return""}}}}}},reverse:function(a){newrows=[];for(var b=0;b<a.rows.length;b++){newrows[newrows.length]=a.rows[b]}for(var b=newrows.length-1;b>=0;b--){a.appendChild(newrows[b])}delete newrows},sort_numeric:function(e,c){aa=parseFloat(e[0].replace(/[^0-9.-]/g,""));if(isNaN(aa)){aa=0}bb=parseFloat(c[0].replace(/[^0-9.-]/g,""));if(isNaN(bb)){bb=0}return aa-bb},sort_alpha:function(e,c){if(e[0]==c[0]){return 0}if(e[0]<c[0]){return -1}return 1},sort_ddmm:function(e,c){mtch=e[0].match(sorttable.DATE_RE);y=mtch[3];m=mtch[2];d=mtch[1];if(m.length==1){m="0"+m}if(d.length==1){d="0"+d}dt1=y+m+d;mtch=c[0].match(sorttable.DATE_RE);y=mtch[3];m=mtch[2];d=mtch[1];if(m.length==1){m="0"+m}if(d.length==1){d="0"+d}dt2=y+m+d;if(dt1==dt2){return 0}if(dt1<dt2){return -1}return 1},sort_mmdd:function(e,c){mtch=e[0].match(sorttable.DATE_RE);y=mtch[3];d=mtch[2];m=mtch[1];if(m.length==1){m="0"+m}if(d.length==1){d="0"+d}dt1=y+m+d;mtch=c[0].match(sorttable.DATE_RE);y=mtch[3];d=mtch[2];m=mtch[1];if(m.length==1){m="0"+m}if(d.length==1){d="0"+d}dt2=y+m+d;if(dt1==dt2){return 0}if(dt1<dt2){return -1}return 1},shaker_sort:function(h,f){var a=0;var e=h.length-1;var j=true;while(j){j=false;for(var c=a;c<e;++c){if(f(h[c],h[c+1])>0){var g=h[c];h[c]=h[c+1];h[c+1]=g;j=true}}e--;if(!j){break}for(var c=e;c>a;--c){if(f(h[c],h[c-1])<0){var g=h[c];h[c]=h[c-1];h[c-1]=g;j=true}}a++}}};if(document.addEventListener){document.addEventListener("DOMContentLoaded",sorttable.init,false);
/*@cc_on @*/
/*@if (@_win32)
    document.write("<script id=__ie_onload defer src=javascript:void(0)><\/script>");
    var script = document.getElementById("__ie_onload");
    script.onreadystatechange = function() {
        if (this.readyState == "complete") {
            sorttable.init(); // call the onload handler
        }
    };
/*@end @*/
}if(/WebKit/i.test(navigator.userAgent)){var _timer=setInterval(function(){if(/loaded|complete/.test(document.readyState)){sorttable.init()}},10)}window.onload=sorttable.init;function dean_addEvent(b,e,c){if(b.addEventListener){b.addEventListener(e,c,false)}else{if(!c.$$guid){c.$$guid=dean_addEvent.guid++}if(!b.events){b.events={}}var a=b.events[e];if(!a){a=b.events[e]={};if(b["on"+e]){a[0]=b["on"+e]}}a[c.$$guid]=c;b["on"+e]=handleEvent}}dean_addEvent.guid=1;function removeEvent(a,c,b){if(a.removeEventListener){a.removeEventListener(c,b,false)}else{if(a.events&&a.events[c]){delete a.events[c][b.$$guid]}}}function handleEvent(e){var c=true;e=e||fixEvent(((this.ownerDocument||this.document||this).parentWindow||window).event);var a=this.events[e.type];for(var b in a){this.$$handleEvent=a[b];if(this.$$handleEvent(e)===false){c=false}}return c}function fixEvent(a){a.preventDefault=fixEvent.preventDefault;a.stopPropagation=fixEvent.stopPropagation;return a}fixEvent.preventDefault=function(){this.returnValue=false};fixEvent.stopPropagation=function(){this.cancelBubble=true};if(!Array.forEach){Array.forEach=function(e,c,b){for(var a=0;a<e.length;a++){c.call(b,e[a],a,e)}}}Function.prototype.forEach=function(a,e,c){for(var b in a){if(typeof this.prototype[b]=="undefined"){e.call(c,a[b],b,a)}}};String.forEach=function(a,c,b){Array.forEach(a.split(""),function(f,e){c.call(b,f,e,a)})};var forEach=function(a,e,b){if(a){var c=Object;if(a instanceof Function){c=Function}else{if(a.forEach instanceof Function){a.forEach(e,b);return}else{if(typeof a=="string"){c=String}else{if(typeof a.length=="number"){c=Array}}}}c.forEach(a,e,b)}};jQuery.cookie=function(e,f,b){if(arguments.length>1&&String(f)!=="[object Object]"){b=jQuery.extend({},b);if(f===null||f===undefined){b.expires=-1}if(typeof b.expires==="number"){var h=b.expires,c=b.expires=new Date();c.setDate(c.getDate()+h)}f=String(f);return(document.cookie=[encodeURIComponent(e),"=",b.raw?f:encodeURIComponent(f),b.expires?"; expires="+b.expires.toUTCString():"",b.path?"; path="+b.path:"",b.domain?"; domain="+b.domain:"",b.secure?"; secure":""].join(""))}b=f||{};var a,g=b.raw?function(j){return j}:decodeURIComponent;return(a=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?g(a[1]):null};(function(b){jQuery.browser.mobile=/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(b.substr(0,4))})(navigator.userAgent||navigator.vendor||window.opera);if(typeof(DailyKos)=="undefined"){window.DailyKos={}}DailyKos.Notifications=(function(){var g;var e;var j=function(l){return(new Date(l)).toString()};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var a=_.template("<p>A message has been issued from site admin at <%= time %>: <div class='warning'><pre><%= warning %></pre></div><% if(warntype == 'ratings') { %>   <p>Your rating privileges have been suspended.</p> <% } else if(warntype == 'trusted') { %>     <p>Your trusted user privileges have been suspended.</p><% } %> <% if(isTimeout) { %>  <p>Your privileges will be restored at <%= reinstate_at %>.</p><% } %><form action='/warnings/<%= id %>.json' id='edit_warning_<%= id %>' data-warning_id=<%= id %> class='acknowledge_warning' method='post'>  <input name='_method' type='hidden' value='put' />  <div><p>I acknowledge receipt of this message:    <input name='warning[acknowledged]' type='hidden' value='0' />    <input type='checkbox' id='warning_acknowledged' name='warning[acknowledged]' value='1' />			 (Posting is not allowed until the message is acknowledged.)</p>  </div> <div><input type='submit' class='submit' id='acknowledge' value='Acknowledge' /></div></form></p>");var c=function(){if($("#notifications:visible").length==0){$("#notifications").show();$("#notifications_close").click(c)}if(e.length>0){b()}else{if(g.length>0){h()}else{$("#notifications").hide()}}};var k=function(){var l={};$.each($(".acknowledge_warning").serializeArray(),function(n,o){l[o.name]=o.value});$.ajax({data:{_method:"PUT",warning:{acknowledged:l["warning[acknowledged]"]},},url:"/warnings/"+$(".acknowledge_warning").data("warning_id"),type:"POST",success:function(n){if(n.status=="success"){c()}else{alert(n.message)}}});return false};var b=function(){var l=_(e).first();e=_(e).rest();if(l){l.time=j(l.time);l.isTimeout=!!l.reinstate_at;l.reinstate_at=j(l.reinstate_at);$("#notifications_div").html(a(l));$(".acknowledge_warning").submit(k)}};var h=function(){var l=_(g).first();g=_(g).rest();$("#notifications_div").html("<p>"+l.message+"</p>")};var f=function(l){$.getJSON("/notifications.json",function(n){g=n.notifications;e=n.warnings;console.log(n);c()})};return{notify:function(){if($("#notifications").length){f()}}}})();$(document).ready(DailyKos.Notifications.notify);(function(g){g.fn.jqm=function(f){var e={overlay:50,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:p,ajaxText:"",target:p,modal:p,toTop:p,onShow:p,onHide:p,onLoad:p};return this.each(function(){if(this._jqm){return o[this._jqm].c=g.extend({},o[this._jqm].c,f)}q++;this._jqm=q;o[q]={c:g.extend(e,g.jqm.params,f),a:p,w:g(this).addClass("jqmID"+q),s:q};if(e.trigger){g(this).jqmAddTrigger(e.trigger)}})};g.fn.jqmAddClose=function(f){return n(this,f,"jqmHide")};g.fn.jqmAddTrigger=function(f){return n(this,f,"jqmShow")};g.fn.jqmShow=function(e){return this.each(function(){e=e||window.event;g.jqm.open(this._jqm,e)})};g.fn.jqmHide=function(e){return this.each(function(){e=e||window.event;g.jqm.close(this._jqm,e)})};g.jqm={hash:{},open:function(E,D){var w=o[E],x=w.c,v="."+x.closeClass,A=(parseInt(w.w.css("z-index"))),A=(A>0)?A:3000,f=g("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":A-1,opacity:x.overlay/100});if(w.a){return p}w.t=D;w.a=true;w.w.css("z-index",A);if(x.modal){if(!a[0]){l("bind")}a.push(E)}else{if(x.overlay>0){w.w.jqmAddClose(f)}else{f=p}}w.o=(f)?f.addClass(x.overlayClass).prependTo("body"):p;if(c){g("html,body").css({height:"100%",width:"100%"});if(f){f=f.css({position:"absolute"})[0];for(var B in {Top:1,Left:1}){f.style.setExpression(B.toLowerCase(),"(_=(document.documentElement.scroll"+B+" || document.body.scroll"+B+"))+'px'")}}}if(x.ajax){var e=x.target||w.w,C=x.ajax,e=(typeof e=="string")?g(e,w.w):g(e),C=(C.substr(0,1)=="@")?g(D).attr(C.substring(1)):C;e.html(x.ajaxText).load(C,function(){if(x.onLoad){x.onLoad.call(this,w)}if(v){w.w.jqmAddClose(g(v,w.w))}k(w)})}else{if(v){w.w.jqmAddClose(g(v,w.w))}}if(x.toTop&&w.o){w.w.before('<span id="jqmP'+w.w[0]._jqm+'"></span>').insertAfter(w.o)}(x.onShow)?x.onShow(w):w.w.show();k(w);return p},close:function(f){var e=o[f];if(!e.a){return p}e.a=p;if(a[0]){a.pop();if(!a[0]){l("unbind")}}if(e.c.toTop&&e.o){g("#jqmP"+e.w[0]._jqm).after(e.w).remove()}if(e.c.onHide){e.c.onHide(e)}else{e.w.hide();if(e.o){e.o.remove()}}return p},params:{}};var q=0,o=g.jqm.hash,a=[],c=g.browser.msie&&(g.browser.version=="6.0"),p=false,h=g('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0}),k=function(e){if(c){if(e.o){e.o.html('<p style="width:100%;height:100%"/>').prepend(h)}else{if(!g("iframe.jqm",e.w)[0]){e.w.prepend(h)}}}j(e)},j=function(f){try{g(":input:visible",f.w)[0].focus()}catch(e){}},l=function(e){g()[e]("keypress",b)[e]("keydown",b)[e]("mousedown",b)},b=function(t){var f=o[a[a.length-1]],s=(!g(t.target).parents(".jqmID"+f.s)[0]);if(s){j(f)}return !s},n=function(e,f,r){return e.each(function(){var t=this._jqm;g(f).each(function(){if(!this[r]){this[r]=[];g(this).click(function(){for(var u in {jqmShow:1,jqmHide:1}){for(var v in this[u]){if(o[this[u][v]]){o[this[u][v]].w[u](this)}}}return p})}this[r].push(t)})})}})(jQuery);if(!DailyKos){var DailyKos={}}DailyKos.AvatarLoader=(function(){var a=function(c){if(c.origin.match("dailykos")){if(c.data.match(/avatar|logo/i)){var f=new Date();$("#avatar, #avatarPreview").attr("src",c.data+"?"+f.getTime());$("#avatar_form_container").jqmHide()}else{if(c.data.match(/height:/i)){$("#avatar_form").height(c.data.slice(8))}}}};var b=function(e,f,c){document.getElementById("avatar_form").contentWindow.location="/"+e+"/"+f+"/edit";window.parent.postMessage(("height: "+c),"*");$("#avatar_form_container").jqmHide()};return{init:function(){$("#avatar_form_container").jqm()},avatarListener:a,cancelButton:b}}());DailyKos.PasswordLoader=(function(){var b=function(c){if(c.origin.match("dailykos")){if(c.data.match(/password|logo/i)){var f=new Date();$("#password, #passwordPreview").attr("src",c.data+"?"+f.getTime());$("#password_form_container").jqmHide()}else{if(c.data.match(/height:/i)){$("#password_form").height(c.data.slice(8))}}}};var a=function(e,f,c){document.getElementById("password_form").contentWindow.location="/"+e+"/"+f+"/edit";window.parent.postMessage(("height: "+c),"*");$("#password_form_container").jqmHide()};return{init:function(){$("#password_form_container").jqm()},passwordListener:b,cancelButton:a}}());$(document).ready(function(){if($("#avatar_form_container").length>0){DailyKos.AvatarLoader.init();window.addEventListener("message",DailyKos.AvatarLoader.avatarListener,false)}if($("#password_form_container").length>0){DailyKos.PasswordLoader.init();window.addEventListener("message",DailyKos.PasswordLoader.passwordListener,false)}});if(!DailyKos){var DailyKos={}}DailyKos.ImageQueueResizer=(function(){var c,e,b;var a=function(){if($(window).scrollTop()>e){$("#image_queue_div").css({position:"absolute",bottom:$("#footer").height()+32,top:"auto"})}else{if($(window).scrollTop()>c){$("#image_queue_div").css({position:"fixed",top:10})}else{$("#image_queue_div").css({position:"static"})}}};return{init:function(){if(b){return}else{b=true}this.setPosition();$("#image_queue").load(this.resizeQueue);$(window).resize(this.resizeQueue);$(window).scroll(a);window.setTimeout(this.resizeQueue,500)},setPosition:function(){c=$("#authenticated-container").offset().top+$("#authenticated-container").height()+12;e=$("#footer").offset().top-$(window).height()+9},resizeQueue:function(){$("#image_queue").css("height",$(window).height()-20);$("#image_queue").contents().find("#image_list").css("height",$(window).height()-131);e=$("#footer").offset().top-$(window).height()+9}}}());$(document).ready(function(){if($("#image_queue").length>0){DailyKos.ImageQueueResizer.init()}});$(document).ready(function(){$("a.open_library").click(function(){$("body").append('<div id="image_library_embed" class="clearfix jqmWindow"><iframe id="image_library_iframe" height="479" width="810" frameborder="0" src="/images/library"></iframe></div>');$("body").css("overflow","hidden");$("#image_library_embed").jqm({onHide:function(a){$("body").css("overflow","auto");a.o.remove();$("#image_library_embed").remove()}}).jqmShow()})});$(document).ready(function(){var a;$(".image_container img").mouseover(function(){if($(this).data("has_attribution")){$(this).siblings(".attribution").show("slide",{direction:"down"},400)}else{var b=this;a=setTimeout(function(){$(b).data("has_attribution",true);var c=$("<div class='attribution'></div>");c.css({width:$(b).width()-10,left:$(b).position().left+24,top:$(b).position().top+$(b).height()-8});$(b).parent().append(c);$(b).siblings(".attribution").show("slide",{direction:"down"},400);var e=$(b).attr("src").match(/\/images\/(\d*)\//)[1];$.get("/images/"+e+"/attribution.json",function(g){var f="None Specified";if(g){f=g}c.text("attribution: "+f)})},300)}}).mouseout(function(){clearTimeout(a);$(this).siblings(".attribution:visible").hide("slide",{direction:"down"},400)})});if(!DailyKos){var DailyKos={}}DailyKos.CommentCount=function(){var h="read_comments_count:";function c(){try{return"localStorage" in window&&window.localStorage!==null}catch(j){return false}}function f(o,n,l){var k=localStorage[h+o]||0;var j=n-k;var p=n;if(l){p=p+"/"+j+" New"}else{p=p+" Comments / "+j+" New"}return p}function b(k,j){localStorage[h+k]=j}function a(j){return parseInt(localStorage[h+j]||0)}function g(){$(".comment_count_with_new").each(function(){$(this).html(f($(this).data("story_id"),$(this).data("comment_count"),$(this).hasClass("compact")))})}function e(){return(kos.story_id&&!kos.top_com)}return{init:function(){$(document).ready(function(){if(c()){g();if(e()&&kos.hidingchoice!="hide"){b(kos.story_id,kos.CNUM);kos.populate_new()}}})},setReadCommentCount:b,getReadCommentCount:a}}();DailyKos.CommentCount.init();if(!DailyKos){var DailyKos={}}DailyKos.ShareTools=function(){var c=function(){$("#share_email_popup").jqm({onHide:function(g){g.w.hide();g.o.remove();$("#share_email_popup .success").hide();$("#share_email_popup form")[0].reset();$("#share_email_popup").find(".submit").removeAttr("disabled").html("Send");$("#share_email_popup form input, #share_email_popup form textarea").removeClass("error");$(".error_message").hide()}});$(".front-page-share .email").click(function(g){g.preventDefault();$("#share_email_popup form").attr("action","/stories/"+$(this).parents(".article").data("story_id")+"/email_share.json");$("#share_email_popup").jqmShow();$("#share_email_popup input, #share_email_popup textarea").blur();$("#share_email_popup .success").css("height",$("#share_email_popup form").height())})};var a=function(){$(".meta:not(.share-expanded)").each(function(){var g=$(this).parent(".article").data("story_url");var h=$(this).parent(".article").data("story_title");$(this).addClass("share-expanded");$(this).find(".front-page-share .facebook").replaceWith('<div class="fb-like" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false" data-href="'+g+'"></div>');FB.XFBML.parse($(this).find(".front-page.share")[0]);$(this).find(".front-page-share .twitter").replaceWith('<a href="https://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="dailykos" data-related="markos" data-text="Daily Kos: '+h+'" data-url="'+g+'">Tweet</a>');twttr.widgets.load();$(this).find(".front-page-share .email_container").css({marginLeft:0})})};var f=function(){$("#share_email_popup input, #share_email_popup textarea").focus(function(){if($(this).data("default_value")==$(this).val()){$(this).val("");$(this).addClass("has_text")}}).blur(function(){if($(this).val()==""){$(this).val($(this).data("default_value"));$(this).removeClass("has_text")}});$("#share_email_popup input").change(function(){$(this).removeClass("error");$(this).prev().children(".error_message").fadeOut()}).keydown(function(){$(this).change()}).keyup(function(){$(this).change()});$("#share_email_popup form").submit(function(g){g.preventDefault();e();b()})};var e=function(){$("#share_email_popup").find("input").each(function(){if($(this).val()==""||$(this).val()==$(this).data("default_value")){$(this).addClass("error");$(this).prev().children(".error_message").show()}});if($("#share_email_popup").children("form").children("input[name=to]").val().split(",").length>3){$("#share_email_popup").children("form").children("input[name=to]").addClass("error");$("#share_email_popup").children("form").children("input[name=to]").prev().children(".error_message").show()}var g=/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i;$.each(["to","from"],function(h,j){$.each($("#share_email_popup").children("form").children("input[name="+j+"]").val().split(/\s*,\s*/),function(l,k){if(!g.test(k)){$("#share_email_popup").children("form").children("input[name="+j+"]").addClass("error");$("#share_email_popup").children("form").children("input[name="+j+"]").prev().children(".error_message").show()}})})};var b=function(){if(!$("#share_email_popup").find("input").hasClass("error")){$("#share_email_popup").find(".submit").attr("disabled","disabled").html("Sending...");if($("#share_email_popup .message").val()==$("#share_email_popup .message").data("default_value")){$("#share_email_popup .message").val("")}$.ajax({type:"POST",url:$("#share_email_popup form").attr("action"),data:$("#share_email_popup form").serialize(),success:function(){$("#share_email_popup .success").show()},})}};return{init:function(){c();f()}}}();$(document).ready(function(){DailyKos.ShareTools.init()});