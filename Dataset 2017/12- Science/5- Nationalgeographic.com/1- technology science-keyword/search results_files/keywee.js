!function(e){var t=window.location.pathname,n=function(e){for(var t=2166136261,n=t,o=0;o<e.length;++o)n^=e.charCodeAt(o),n+=(n<<1)+(n<<4)+(n<<7)+(n<<8)+(n<<24)
return n>>>0},o=function(e){return+(Math.round(e+"e+2")+"e-2")},i=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
return e},r=function(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},a=function(e){var t=new Array
for(var n in e)e.hasOwnProperty(n)&&t.push(e[n])
return t},c=n(t),s=null,l=null,u=null,d=null,g={},f=function(e,t,n){g.pcid&&(n.product_catalog_id=g.pcid),window.fbq&&fbq(e,t,n)},w=function(){f("track","ViewContent",{content_category:s,content_ids:[c],content_type:"product",value:1,currency:"USD"})},h=function(e){var t=e.getFullYear().toString(),n=(e.getMonth()+1).toString(),o=e.getDate().toString()
return t+(n[1]?n:"0"+n[0])+(o[1]?o:"0"+o[0])},p=new Date,v=0,m=h(p),_=h(new Date((new Date).setDate(p.getDate()-30))),y=h(new Date((new Date).setDate(p.getDate()-180))),k=h(new Date(p.getFullYear(),p.getMonth(),1)),S=document.title,E=window.location.href.indexOf("kwp_4=")>0,b=0,D=null,C=function(){return localStorage&&localStorage.keyweeHistory?JSON.parse(localStorage.keyweeHistory):{}},q=function(e){localStorage&&(localStorage.keyweeHistory=JSON.stringify(e))},T=function(e){var t=C(),n=t[e]
return n||{date:e}},H=function(e,t){var n=C()
n[e]=t,q(n)},N=function(e){var t,n=T(e||m),i=o((new Date-p)/6e4),r=I()
return r>b&&(b=r),n.categories||(n.categories={}),n.categories[s]||(n.categories[s]={articles_read:0,keywee_articles_read:0,time_spent:0,category:s}),t=n.categories[s],t.last_visited_article!=S&&(t.articles_read++,E&&t.keywee_articles_read++,t.last_visited_article=S),t.time_spent=t.time_spent-v+i,v=i,H(e||m,n),n},O=function(e,t,n){return Object.keys(e).filter(function(e){return e>=t&&(!n||n>=e)})},K=function(e,t){var n=C()
return O(n,e,t).map(function(e){return n[e]})},P=function(){var e=null
return localStorage&&localStorage.keywee_oldest_visit_date&&(e=localStorage.keywee_oldest_visit_date),e},x=function(){var e=C(),t=O(e,y,_),n=P()
return y>n&&(n=null),t.length>0&&(n=t.sort()[t.length-1]),localStorage&&(n?(localStorage.keywee_oldest_visit_date=n,e[n]&&(localStorage.keywee_oldest_visit_data=JSON.stringify(e[n]))):(localStorage.removeItem("keywee_oldest_visit_date"),localStorage.removeItem("keywee_oldest_visit_data"))),n},A=function(e){var t,n=_,o={}
n>k&&(n=k),e&&(n=e),t=K(n),t.forEach(function(e){o[e.date]=e}),q(o)},V=function(e){return s&&(e["cat-"+s]=1,e.category=s),l&&(e["sect-"+l]=1,e.section=l),u&&(e["sub-sect-"+u]=1,e.sub_section=u),e},M=function(){var e={tsop:v,lop:b}
return V(e)},W=function(e){this.customizations.isCore?this.customizations.isCore.bind(this)(e):e.lov&&e.noad30>=2&&(e.core=1)},B=function(){var e=K(_),t=K(k),n=function(e){return 1==e.length?a(e[0].categories):e.reduce(function(e,t){return e.concat(a(t.categories))},[])},r=function(e,t){return 1==e.length?e[0][t]:e.reduce(function(e,n){return e+n[t]},0)},c=function(e){return e.split("_").map(function(e){return e[0]}).join("")},l=["articles_read","keywee_articles_read","time_spent"],u=n(e),g=n(t),f=u.filter(function(e){return e.category==s}),w=g.filter(function(e){return e.category==s}),h=e.length,p=t.length,v={noad30:[3,5,10],noadic30:[3,5,10],ar30d:[3,5,10],kar30d:[3,5,10],ts30d:[30,60,180]},m={noad30:h,noadic30:f.length,noadiccm:w.length,noadcm:p}
return m=V(m),d&&(m.lov=d),l.forEach(function(e){var t=c(e),n=t+"30d",i=t+"cm",a=t+"ic30d",s=t+"iccm",l=[[n,u],[i,g],[a,f],[s,w]]
l.forEach(function(t){var n=t[0],i=t[1],a=r(i,e)
m[n]=o(a)})}),Object.keys(v).forEach(function(e){for(var t=v[e],n=0,o=t.length-1;o>=0;o--)if(n=t[o-1],m[e]>=n){m["met-"+e+"_gr"+n]=1
break}}),this.customEventData&&(m=i(m,this.customEventData)),this.updateIsCoreAudience(m),m},I=function(){var e=null,t=window.pageYOffset||document.documentElement.scrollTop,n=document.body,i=document.documentElement,r=Math.max(n.scrollHeight,n.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight),a=window.innerHeight
return g.getArticleContainerHeight&&(e=g.getArticleContainerHeight()),e&&(r=e),o(Math.min(100,t/(r-a)*100))},j=function(){var e=I(),t=null,n=e!=D,i=o((new Date-p)/6e4),r=i>30
n&&!r&&(N(),t=this.getPeriodicEventToSend(),f("trackCustom","KWCEPA",t),D=e)},L=function(){var e=null
N(),e=this.getEventToSend(),f("trackCustom","KWCEPV",e),window.fbq&&fbq("track","PageView"),window.snowplowKW&&window.snowplowKW("trackPageView")},F=3,z=function(e){var t=this
if(e.waitFor&&!e.waitFor()&&F>0)return F-=1,void setTimeout(this.init,5e3,e)
try{this.customizations=e,this.customEventData={},g=e,x(),d=P(),g.getCategories&&(this.categories=g.getCategories(),this.categories.length>0&&(s=r(this.categories[0])),this.categories.length>1&&(l=r(this.categories[1])),this.categories.length>2&&(u=r(this.categories[2]))),g.eventListners&&g.eventListners.forEach(function(e){e.bind(t)()}),s&&(w(),A(),this.sendPageViewEvent(),setInterval(j.bind(this),3e4))}catch(n){console.log("Exception:"+n),console.log(n.stack)}},G={}
return window[e]=G,G.last_30_days_date_str=_,G.getDataBetweensDates=K,G.updateIsCoreAudience=W,G.getKeyweeHistory=C,G.updateData=N,G.today_str=m,G.getEventToSend=B,G.getPeriodicEventToSend=M,G.cleanOldData=A,G.sendPeriodicEvent=j,G.sendPageViewEvent=L,G.sendViewContentEvent=w,G.getLatestOldVisit=P,G.setLatestOldVisit=x,G.sendEvent=f,G.product_id=c,G.init=z,G}("Keywee"),function(){!function(e,t,n,o,i,r,a){e.fbq||(i=e.fbq=function(){i.callMethod?i.callMethod.apply(i,arguments):i.queue.push(arguments)},e._fbq||(e._fbq=i),i.push=i,i.loaded=!0,i.version="2.0",i.queue=[],r=t.createElement(n),r.async=!0,r.src=o,a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(r,a))}(window,document,"script","//connect.facebook.net/en_US/fbevents.js"),fbq("init","948912858484145")}(),function(e,t,n,o,i,r,a){e[i]||(e.GlobalSnowplowNamespace=e.GlobalSnowplowNamespace||[],e.GlobalSnowplowNamespace.push(i),e[i]=function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].q=e[i].q||[],r=t.createElement(n),a=t.getElementsByTagName(n)[0],r.async=1,r.src=o,a.parentNode.insertBefore(r,a))}(window,document,"script","//dc8xl0ndzn2cb.cloudfront.net/sp.js","snowplowKW"),function(){function e(){var e=function(e,t,n,o){var i,r
if(n){var a=new Date
a.setTime(a.getTime()+24*n*60*60*1e3),i="; expires="+a.toGMTString()}else i=""
r=e+"="+t+i+"; path=/;",o&&(r=r+" Domain="+o),document.cookie=r},n="kwp_4",o="keywee."+n,i=new RegExp(n+"=([^&#]*)","i").exec(window.location.href),r=i&&unescape(i[1])||""
""!=r&&e(o,r,30,t),window.snowplowKW("setUserIdFromCookie",o)}var t=".nationalgeographic.com"
window.snowplowKW("newTracker","cf","pixel.keywee.co",{appId:"37",cookieDomain:t}),e(),window.snowplowKW("enableActivityTracking",30,30)}(),function(){var e=function(){var e=[],t=document.getElementsByName("tax:source"),n=document.getElementsByName("tax:firstSubjectAncestor")
if(t.length>0&&t[0].content&&(e.push(t[0].content),n.length>0&&n[0].content&&e.push(n[0].content)),0==e.length){var o=window.location.host,i=o.split("."),r=i[0]
e.push(r)}return e}
Keywee.init({getCategories:e,pcid:978470302248265,eventListners:[]})}()
